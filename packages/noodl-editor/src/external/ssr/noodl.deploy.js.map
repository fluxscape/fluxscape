{"version":3,"file":"noodl.deploy.js","mappings":"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","sources":["webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/foreach.jsx","webpack://@noodl/noodl-viewer-react/../../node_modules/bezier-easing/index.js","webpack://@noodl/noodl-viewer-react/../../node_modules/clsx/dist/clsx.m.js","webpack://@noodl/noodl-viewer-react/../../node_modules/events/events.js","webpack://@noodl/noodl-viewer-react/../../node_modules/lodash.difference/index.js","webpack://@noodl/noodl-viewer-react/../../node_modules/lodash.isequal/index.js","webpack://@noodl/noodl-viewer-react/../../node_modules/prop-types/factoryWithThrowingShims.js","webpack://@noodl/noodl-viewer-react/../../node_modules/prop-types/index.js","webpack://@noodl/noodl-viewer-react/../../node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack://@noodl/noodl-viewer-react/../../node_modules/react-draggable/build/cjs/Draggable.js","webpack://@noodl/noodl-viewer-react/../../node_modules/react-draggable/build/cjs/DraggableCore.js","webpack://@noodl/noodl-viewer-react/../../node_modules/react-draggable/build/cjs/cjs.js","webpack://@noodl/noodl-viewer-react/../../node_modules/react-draggable/build/cjs/utils/domFns.js","webpack://@noodl/noodl-viewer-react/../../node_modules/react-draggable/build/cjs/utils/getPrefix.js","webpack://@noodl/noodl-viewer-react/../../node_modules/react-draggable/build/cjs/utils/log.js","webpack://@noodl/noodl-viewer-react/../../node_modules/react-draggable/build/cjs/utils/positionFns.js","webpack://@noodl/noodl-viewer-react/../../node_modules/react-draggable/build/cjs/utils/shims.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/router-handler.ts","webpack://@noodl/noodl-viewer-react/../../node_modules/webfontloader/webfontloader.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/noodl-runtime.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/api/cloudfile.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/api/cloudstore.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/api/configservice.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/api/queryutils.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/api/records.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/async-pool.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/collection.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/edgetriggeredinput.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/editorconnection.activewarnings.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/editorconnection.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/editormodeleventshandler.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/events.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/eventsender.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/guid.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/javascriptnodeparser.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/model.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/models/componentmodel.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/models/graphmodel.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/models/nodemodel.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/node.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodecontext.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodedefinition.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodelibraryexport.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/noderegister.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/componentinputs.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/componentinstance.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/componentoutputs.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/and.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/booleantostring.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/condition.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/counter.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/cloudfilenode.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbcollectionnode2.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbconfig.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbmodelcrudbase.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbmodelnode-addrelation.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbmodelnode-removerelation.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbmodelnode2.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/deletedbmodelpropertiesnode.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/filterdbmodelsnode.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/modelcrudbase.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/modelnode2.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/newdbmodelpropertiesnode.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/newmodelnode.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/restnode.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/setdbmodelpropertiesnode.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/setmodelpropertiesnode.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/datetostring.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/expression.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/inverter.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/or.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/runtasks.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/simplejavascript.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/stringformat.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/stringmapper.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/substring.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/uniqueid.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/user/setuserproperties.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/user/user.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/variables/boolean.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/variables/number.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/variables/string.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/variables/variablebase.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodescope.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/outputproperty.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/projectsettings.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/services/services.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/timerscheduler.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/utils.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/variants.js","webpack://@noodl/noodl-viewer-react/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://@noodl/noodl-viewer-react/./src/api/cloudfunctions.js","webpack://@noodl/noodl-viewer-react/./src/api/files.js","webpack://@noodl/noodl-viewer-react/./src/api/navigation.js","webpack://@noodl/noodl-viewer-react/./src/api/users.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Group/scroll-plugins/patched-momentum-scroll.js","webpack://@noodl/noodl-viewer-react/./src/easecurves.js","webpack://@noodl/noodl-viewer-react/./src/fontloader.js","webpack://@noodl/noodl-viewer-react/./src/guid.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/animation.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/componentstate.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/data/collectionnode.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/data/dbcollectionnode.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/data/dbmodelnode.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/data/modelnode.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/data/variablenode.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/globals.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/gyroscope.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/numberblend.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/parentcomponentstate.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/scriptdownloader.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/signaltoindex.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/stringselector.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/std-library/transition.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/closepopup.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/navigate-back.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/navigate-to-path.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/navigate.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/navigation-handler.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/page-inputs.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/router-navigate.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/showpopup.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/transitions.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/transitions/none-transition.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/transitions/popup-transition.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/transitions/push-transition.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/transitions/transition.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/animate-to-value.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/colorblend.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/componentutils/base.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/componentutils/componentobject.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/componentutils/parentcomponentobject.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/componentutils/setcomponentobjectproperties.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/componentutils/setparentcomponentobjectproperties.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/cloudfunction.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/cloudfunction2.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/collectionnode-clear","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/collectionnode-insert.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/collectionnode-new.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/collectionnode-remove.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/collectionnode2.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/filtercollectionnode.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/foreachactions.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/mapcollectionnode.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/setvariablenode.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/staticdata.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/variablenode2.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/eventreceiver.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/eventsender.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/javascript.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/numberremapper.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/openfilepicker.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/screenresolution.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/states.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/switch.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/timer.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/uploadfile.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/login.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/logout.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/requestpasswordreset.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/resetpassword.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/sendemailverification.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/signup.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/userservice.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/verifyemail.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/valuechanged.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/variables/color.js","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/css-definition.js","webpack://@noodl/noodl-viewer-react/external var \"React\"","webpack://@noodl/noodl-viewer-react/external var \"ReactDOM\"","webpack://@noodl/noodl-viewer-react/webpack/bootstrap","webpack://@noodl/noodl-viewer-react/webpack/runtime/compat get default export","webpack://@noodl/noodl-viewer-react/webpack/runtime/define property getters","webpack://@noodl/noodl-viewer-react/webpack/runtime/global","webpack://@noodl/noodl-viewer-react/webpack/runtime/hasOwnProperty shorthand","webpack://@noodl/noodl-viewer-react/webpack/runtime/make namespace object","webpack://@noodl/noodl-viewer-react/webpack/runtime/node module decorator","webpack://@noodl/noodl-viewer-react/webpack/runtime/nonce","webpack://@noodl/noodl-viewer-react/./src/graph-warnings.js","webpack://@noodl/noodl-viewer-react/./src/highlighter.js","webpack://@noodl/noodl-viewer-react/./src/inspector.js","webpack://@noodl/noodl-viewer-react/./src/api/seo.ts","webpack://@noodl/noodl-viewer-react/./src/noodl-js-api.js","webpack://@noodl/noodl-viewer-react/./src/project-settings.js","webpack://@noodl/noodl-viewer-react/./src/dom-boundingbox-oberver.js","webpack://@noodl/noodl-viewer-react/./src/layout.js","webpack://@noodl/noodl-viewer-react/./src/mergedeep.js","webpack://@noodl/noodl-viewer-react/./src/tooltips.js","webpack://@noodl/noodl-viewer-react/./src/node-shared-port-definitions.js","webpack://@noodl/noodl-viewer-react/./src/node-transitions.js","webpack://@noodl/noodl-viewer-react/./src/react-component-node.js","webpack://@noodl/noodl-viewer-react/./src/pointerlisteners.js","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/utils.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/Button/Button.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/button.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/Checkbox/Checkbox.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/checkbox.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/Select/Select.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/options.ts","webpack://@noodl/noodl-viewer-react/./src/contexts/radiobuttoncontext.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/RadioButton/RadioButton.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/radiobutton.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/RadioButtonGroup/RadioButtonGroup.tsx","webpack://@noodl/noodl-viewer-react/./src/constants/flex.js","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/radiobuttongroup.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/Slider/Slider.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/slider.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/TextInput/TextInput.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/text-input.ts","webpack://@noodl/noodl-viewer-react/./src/async-queue.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/navigation-stack.jsx","webpack://@noodl/noodl-viewer-react/./src/components/navigation/Page/Page.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/page.js","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/router.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/externallink.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Circle/Circle.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/circle.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Columns/Columns.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/columns.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Drag/Drag.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/drag.js","webpack://@noodl/noodl-viewer-react/../../node_modules/@better-scroll/core/dist/core.esm.js","webpack://@noodl/noodl-viewer-react/../../node_modules/@better-scroll/mouse-wheel/dist/mouse-wheel.esm.js","webpack://@noodl/noodl-viewer-react/../../node_modules/@better-scroll/scroll-bar/dist/scroll-bar.esm.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Group/scroll-plugins/nested-scroll-plugin.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Group/scroll-plugins/slide-scroll-plugin.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Group/Group.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/group.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Icon/Icon.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/icon.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Image/Image.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/image.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Text/Text.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/text.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Video/Video.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/video.js","webpack://@noodl/noodl-viewer-react/./src/assets/style.css?76bd","webpack://@noodl/noodl-viewer-react/./src/assets/style.css","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/controls/utils.js","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/controls/button.jsx","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/controls/checkbox.jsx","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/controls/fieldset.jsx","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/controls/form.jsx","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/controls/label.jsx","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/controls/options.jsx","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/controls/radiobutton.jsx","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/controls/range.jsx","webpack://@noodl/noodl-viewer-react/./src/nodes-deprecated/controls/text-input.jsx","webpack://@noodl/noodl-viewer-react/./src/register-nodes.js","webpack://@noodl/noodl-viewer-react/./src/styles.ts","webpack://@noodl/noodl-viewer-react/./src/viewer.jsx","webpack://@noodl/noodl-viewer-react/./src/components/common/NoHomeError/NoHomeError.tsx","webpack://@noodl/noodl-viewer-react/./noodl-viewer-react.js","webpack://@noodl/noodl-viewer-react/./src/polyfills.js","webpack://@noodl/noodl-viewer-react/./index.ssr.js"],"sourcesContent":["const { Node } = require('@noodl/runtime');\r\nconst guid = require('../../../guid');\r\nconst Collection = require('@noodl/runtime/src/collection');\r\n\r\nconst React = require('react');\r\nconst NoodlRuntime = require('@noodl/runtime');\r\nconst { useEffect } = React;\r\n\r\nfunction ForEachComponent(props) {\r\n  const { didMount, willUnmount } = props;\r\n\r\n  useEffect(() => {\r\n    didMount();\r\n    return () => {\r\n      willUnmount();\r\n    };\r\n  }, []);\r\n\r\n  return null;\r\n}\r\n\r\nconst defaultDynamicScript =\r\n  \"// Set the 'component' variable to the name of the desired component for this item.\\n\" +\r\n  \"// Component name must start with a '/'.\\n\" +\r\n  \"// A component in a sheet is referred to by '/#Sheet Name/Comopnent Name'.\\n\" +\r\n  \"// The data for each item is available in a variable called 'item'\\n\" +\r\n  \"component = '/MyComponent';\";\r\n\r\nconst ForEachDefinition = {\r\n  name: 'For Each',\r\n  displayNodeName: 'Repeater',\r\n  docs: 'https://docs.noodl.net/nodes/ui-controls/repeater',\r\n  color: 'visual',\r\n  category: 'Visual',\r\n  dynamicports: [\r\n    {\r\n      name: 'conditionalports/extended',\r\n      condition: 'templateType = explicit OR templateType NOT SET',\r\n      inputs: ['template']\r\n    },\r\n    {\r\n      name: 'conditionalports/extended',\r\n      condition: 'templateType = dynamic',\r\n      inputs: ['templateScript']\r\n    }\r\n  ],\r\n  initialize() {\r\n    this._internal.itemNodes = [];\r\n    this._internal.itemOutputSignals = {};\r\n    this._internal.itemOutputs = {};\r\n    this._internal.collection = Collection.get(); // We keep an internal collection so we don't have to refresh all content if the input items collection changes\r\n    this._internal.queuedOperations = [];\r\n    this._internal.mountedOperations = [];\r\n\r\n    // Add an item\r\n    this._internal.collection.on('add', async (args) => {\r\n      if (!this._internal.target) return;\r\n\r\n      this._queueOperation(async () => {\r\n        const baseIndex = this._internal.target.getChildren().indexOf(this) + 1;\r\n        await this.addItem(args.item, baseIndex + args.index);\r\n      });\r\n    });\r\n\r\n    // Remove an item\r\n    this._internal.collection.on('remove', (args) => {\r\n      this._queueOperation(() => {\r\n        this.removeItem(args.item);\r\n      });\r\n    });\r\n\r\n    // On collection changed\r\n    this._internal.onItemsCollectionChanged = () => {\r\n      const repeaterDisabledWhenUnmounted = NoodlRuntime.instance.getProjectSettings().repeaterDisabledWhenUnmounted;\r\n\r\n      if (repeaterDisabledWhenUnmounted && !this.isMounted) {\r\n        this._internal.mountedOperations.push(() => {\r\n          this._internal.collection.set(this._internal.items);\r\n        });\r\n      } else {\r\n        this._queueOperation(() => {\r\n          this._internal.collection.set(this._internal.items);\r\n        });\r\n      }\r\n    };\r\n\r\n    this.addDeleteListener(() => {\r\n      this._deleteAllItemNodes();\r\n    });\r\n  },\r\n  inputs: {\r\n    items: {\r\n      group: 'Data',\r\n      displayName: 'Items',\r\n      type: 'array',\r\n      set: function (value) {\r\n        if (!value) return;\r\n        if (value === this._internal.items) return;\r\n        this.bindCollection(value);\r\n        //this.scheduleRefresh();\r\n      }\r\n    },\r\n    templateType: {\r\n      group: 'Appearance',\r\n      displayName: 'Template Type',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Explicit', value: 'explicit' },\r\n          { label: 'Dynamic', value: 'dynamic' }\r\n        ]\r\n      },\r\n      default: 'explicit',\r\n      set: function (value) {\r\n        this._internal.templateType = value;\r\n        this.scheduleRefresh();\r\n      }\r\n    },\r\n    template: {\r\n      type: 'component',\r\n      displayName: 'Template',\r\n      group: 'Appearance',\r\n      set: function (value) {\r\n        this._internal.template = value;\r\n        this.scheduleRefresh();\r\n      }\r\n    },\r\n    templateScript: {\r\n      type: { name: 'string', codeeditor: 'javascript', allowEditOnly: true },\r\n      displayName: 'Script',\r\n      group: 'Appearance',\r\n      default: defaultDynamicScript,\r\n      set: function (value) {\r\n        try {\r\n          this._internal.templateFunction = new Function('item', 'var component;' + value + ';return component;');\r\n        } catch (e) {\r\n          console.log(e);\r\n          if (this.context.editorConnection) {\r\n            this.context.editorConnection.sendWarning(\r\n              this.nodeScope.componentOwner.name,\r\n              this.id,\r\n              'foreach-syntax-warning',\r\n              { message: '<strong>Syntax</strong>: ' + e.message }\r\n            );\r\n          }\r\n        }\r\n        this.scheduleRefresh();\r\n      }\r\n    },\r\n    refresh: {\r\n      group: 'Appearance',\r\n      displayName: 'Refresh',\r\n      type: 'signal',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleRefresh();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    itemActionItemId: {\r\n      type: 'string',\r\n      group: 'Actions',\r\n      displayName: 'Item Id',\r\n      getter: function () {\r\n        return this._internal.itemActionItemId;\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    updateTarget: function (targetId) {\r\n      this._internal.target = targetId ? this.nodeScope.getNodeWithId(targetId) : undefined;\r\n      this.scheduleRefresh();\r\n    },\r\n    setNodeModel: function (nodeModel) {\r\n      Node.prototype.setNodeModel.call(this, nodeModel);\r\n      if (nodeModel.parent) {\r\n        this.updateTarget(nodeModel.parent.id);\r\n      }\r\n      var self = this;\r\n      nodeModel.on(\r\n        'parentUpdated',\r\n        function (newParent) {\r\n          self.updateTarget(newParent ? newParent.id : undefined);\r\n        },\r\n        this\r\n      );\r\n    },\r\n    scheduleRefresh: function () {\r\n      var _this = this;\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledRefresh) {\r\n        internal.hasScheduledRefresh = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          this._queueOperation(() => {\r\n            this.refresh();\r\n          });\r\n        });\r\n      }\r\n    },\r\n    unbindCurrentCollection: function () {\r\n      var collection = this._internal.items;\r\n      if (!collection) return;\r\n\r\n      Collection.instanceOf(collection) && collection.off('change', this._internal.onItemsCollectionChanged);\r\n      this._internal.items = undefined;\r\n    },\r\n    bindCollection: function (collection) {\r\n      var internal = this._internal;\r\n\r\n      this.unbindCurrentCollection();\r\n\r\n      Collection.instanceOf(collection) && collection.on('change', this._internal.onItemsCollectionChanged);\r\n\r\n      internal.items = collection;\r\n      this.scheduleCopyItems();\r\n    },\r\n    getTemplateForModel: function (model) {\r\n      var internal = this._internal;\r\n      if (internal.templateType === undefined || internal.templateType === 'explicit') return internal.template;\r\n\r\n      if (!internal.templateFunction) return;\r\n      try {\r\n        var template = internal.templateFunction(model);\r\n      } catch (e) {\r\n        console.log(e);\r\n        if (this.context.editorConnection) {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            'foreach-dynamic-warning',\r\n            { message: '<strong>Dynamic template</strong>: ' + e.message }\r\n          );\r\n        }\r\n      }\r\n\r\n      //simple (and limited) way to support ./ and ../ at the start of component template names\r\n      if (template) {\r\n        if (template.startsWith('./')) {\r\n          template = this.model.component.name + template.substring(1);\r\n        }\r\n\r\n        if (template.startsWith('../')) {\r\n          const pathParts = this.model.component.name.split('/');\r\n          const parentPath = pathParts.slice(0, pathParts.length - 1).join('/');\r\n          template = parentPath + template.substring(2);\r\n        }\r\n      }\r\n\r\n      return template;\r\n    },\r\n    _mapInputs: function (itemNode, model) {\r\n      if (this._internal.inputMapFunc !== undefined) {\r\n        // We have a mapping function, run the function and use the mapped values\r\n        // as inputs\r\n        this._internal.inputMapFunc(function (mappings) {\r\n          for (var key in mappings) {\r\n            if (itemNode.hasInput(key)) {\r\n              if (typeof mappings[key] === 'function') {\r\n                itemNode.setInputValue(key, mappings[key](model));\r\n              } else if (typeof mappings[key] === 'string') {\r\n                itemNode.setInputValue(key, model.get(mappings[key]));\r\n              }\r\n            }\r\n          }\r\n        }, model);\r\n      }\r\n    },\r\n    addItem: async function (model, index) {\r\n      var internal = this._internal;\r\n\r\n      // Create a new component for this item\r\n      var template = this.getTemplateForModel(model);\r\n      if (!template) return;\r\n\r\n      var itemNode = await this.nodeScope.createNode(template, guid(), {\r\n        _forEachModel: model,\r\n        _forEachNode: this\r\n      });\r\n\r\n      // Set input values for all model data, and track changes\r\n      if (this._internal.inputMapFunc === undefined) {\r\n        //set component inputs with values from model\r\n        if (itemNode.hasInput('Id')) {\r\n          itemNode.setInputValue('Id', model.getId());\r\n        }\r\n        if (itemNode.hasInput('id')) {\r\n          itemNode.setInputValue('id', model.getId());\r\n        }\r\n\r\n        for (var inputKey in itemNode._inputs) {\r\n          if (model.data[inputKey] !== undefined) itemNode.setInputValue(inputKey, model.data[inputKey]);\r\n        }\r\n\r\n        //listen to changes on model\r\n        itemNode._forEachModelChangeListener = function (ev) {\r\n          if (itemNode._inputs[ev.name]) itemNode.setInputValue(ev.name, ev.value);\r\n        };\r\n        model.on('change', itemNode._forEachModelChangeListener);\r\n\r\n        //listen to changes to the component inputs\r\n        itemNode.componentModel.on(\r\n          'inputPortAdded',\r\n          (port) => {\r\n            if (port.name === 'id') itemNode.setInputValue('id', model.getId());\r\n            if (port.name === 'Id') itemNode.setInputValue('Id', model.getId());\r\n\r\n            if (model.data[port.name] !== undefined) {\r\n              itemNode.setInputValue(port.name, model.data[port.name]);\r\n            }\r\n          },\r\n          this\r\n        );\r\n      } else {\r\n        // If there is a map script, then use it\r\n        this._mapInputs(itemNode, model);\r\n        itemNode._forEachModelChangeListener = () => this._mapInputs(itemNode, model);\r\n        model.on('change', itemNode._forEachModelChangeListener);\r\n      }\r\n\r\n      // Create connections for all item output signals that we should forward\r\n      itemNode._internal.creatorCallbacks = {\r\n        onOutputChanged: (name, value, oldValue) => {\r\n          if ((oldValue === false || oldValue === undefined) && value === true && internal.itemOutputSignals[name]) {\r\n            this.itemOutputSignalTriggered(name, model, itemNode);\r\n          }\r\n        }\r\n      };\r\n\r\n      // Connect all model nodes of the component that have id type = instance\r\n      /*var itemScopes = itemNode.nodeScope.getNodesWithType('Model')\r\n      if(itemScopes && itemScopes.length>0) {\r\n        for(var j = 0; j < itemScopes.length; j++) {\r\n          itemScopes[j].hasInstanceIDType()&&itemScopes[j].setModel(model);\r\n        }\r\n      }*/\r\n\r\n      // If there is a for each actions node, signal that the item has been added\r\n      var forEachActions = itemNode.nodeScope.getNodesWithType('For Each Actions');\r\n      for (var j = 0; j < forEachActions.length; j++) {\r\n        forEachActions[j].signalAdded();\r\n      }\r\n\r\n      internal.itemNodes.push(itemNode);\r\n      internal.target.addChild(itemNode, index);\r\n    },\r\n    removeItem: function (model) {\r\n      var internal = this._internal;\r\n      if (!internal.target) return;\r\n\r\n      function findChild() {\r\n        var children = internal.target.getChildren();\r\n        for (var i in children) {\r\n          var c = children[i];\r\n          if (c._forEachModel === model && !c._forEachRemoveInProgress) return c;\r\n        }\r\n      }\r\n      var child = findChild();\r\n      if (!child) return;\r\n\r\n      var forEachActions = child.nodeScope.getNodesWithType('For Each Actions');\r\n      if (forEachActions && forEachActions.length > 0) {\r\n        // Run a try remove on the for each actions, remove the child when completed\r\n        child._forEachRemoveInProgress = true;\r\n        forEachActions[0].tryRemove(() => this._deleteItem(child));\r\n      } else {\r\n        // There are no for each actions, just remove the item\r\n        this._deleteItem(child);\r\n      }\r\n\r\n      var idx = internal.itemNodes.indexOf(child);\r\n      idx !== -1 && internal.itemNodes.splice(idx, 1);\r\n    },\r\n    _deleteItem(item) {\r\n      item._forEachModel.off('change', item._forEachModelChangeListener);\r\n\r\n      item.model && item.model.removeListenersWithRef(this);\r\n      item.componentModel && item.componentModel.removeListenersWithRef(this);\r\n\r\n      const parent = item.parent;\r\n      if (item._deleted || !parent) return;\r\n\r\n      parent.removeChild(item);\r\n      this.nodeScope.deleteNode(item);\r\n    },\r\n    _deleteAllItemNodes: function () {\r\n      if (!this._internal.itemNodes) return;\r\n\r\n      for (const itemNode of this._internal.itemNodes) {\r\n        this._deleteItem(itemNode);\r\n      }\r\n\r\n      this._internal.itemNodes = [];\r\n    },\r\n    refresh: async function () {\r\n      var internal = this._internal;\r\n      internal.hasScheduledRefresh = false;\r\n      if (!(internal.template || internal.templateFunction) || !internal.items) return;\r\n\r\n      this._deleteAllItemNodes();\r\n\r\n      //check if we have a target to add nodes to\r\n      if (!internal.target) return;\r\n\r\n      // figure out our index in our target\r\n      const baseIndex = this._internal.target.getChildren().indexOf(this) + 1;\r\n\r\n      // Iterate over all models and create items\r\n      for (var i = 0; i < internal.collection.size(); i++) {\r\n        var model = internal.collection.get(i);\r\n\r\n        await this.addItem(model, baseIndex + i);\r\n      }\r\n    },\r\n    _queueOperation(op) {\r\n      this._internal.queuedOperations.push(op);\r\n      this._runQueueOperations();\r\n    },\r\n    async _runQueueOperations() {\r\n      if (this.runningOperations) {\r\n        return;\r\n      }\r\n      this.runningOperations = true;\r\n\r\n      const repeaterCreateComponentsAsync = NoodlRuntime.instance.getProjectSettings().repeaterCreateComponentsAsync;\r\n\r\n      if (repeaterCreateComponentsAsync) {\r\n        //create items in chunks of roughly 25ms at a time\r\n        //so basically trying to keep ~30 fps\r\n        const runOps = async () => {\r\n          const start = performance.now();\r\n\r\n          while (this._internal.queuedOperations.length && performance.now() - start < 25) {\r\n            const op = this._internal.queuedOperations.shift();\r\n            await op();\r\n          }\r\n\r\n          if (this._internal.queuedOperations.length) {\r\n            setTimeout(runOps, 0);\r\n          } else {\r\n            this.runningOperations = false;\r\n          }\r\n        };\r\n\r\n        runOps();\r\n      } else {\r\n        while (this._internal.queuedOperations.length) {\r\n          const op = this._internal.queuedOperations.shift();\r\n          await op();\r\n        }\r\n\r\n        this.runningOperations = false;\r\n      }\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this._internal.queuedOperations.length = 0; //delete all queued operations\r\n      this.unbindCurrentCollection();\r\n    },\r\n    render() {\r\n      return <ForEachComponent key={this.id} didMount={() => this.didMount()} willUnmount={() => this.willUnmount()} />;\r\n    },\r\n    didMount() {\r\n      this.isMounted = true;\r\n\r\n      for (const op of this._internal.mountedOperations) {\r\n        this._queueOperation(op);\r\n      }\r\n      this._internal.mountedOperations = [];\r\n    },\r\n    willUnmount() {\r\n      this.isMounted = false;\r\n    },\r\n    getItemActionParameter: function (name) {\r\n      if (!this._internal.itemActionParameters) return;\r\n      return this._internal.itemActionParameters[name];\r\n    },\r\n    scheduleCopyItems: function () {\r\n      if (this._internal.hasScheduledCopyItems) return;\r\n      this._internal.hasScheduledCopyItems = true;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this._internal.hasScheduledCopyItems = false;\r\n\r\n        if (this._internal.items === undefined) return;\r\n\r\n        const repeaterDisabledWhenUnmounted = NoodlRuntime.instance.getProjectSettings().repeaterDisabledWhenUnmounted;\r\n\r\n        if (repeaterDisabledWhenUnmounted && !this.isMounted) {\r\n          this._internal.mountedOperations.push(() => {\r\n            this._internal.collection.set(this._internal.items);\r\n          });\r\n        } else {\r\n          this._internal.collection.set(this._internal.items);\r\n        }\r\n      });\r\n    },\r\n    itemOutputSignalTriggered: function (name, model, itemNode) {\r\n      this._internal.itemActionItemId = model.getId();\r\n      this._internal.itemActionSignal = name;\r\n      this.flagOutputDirty('itemActionItemId');\r\n\r\n      // Send signal and update item outputs after they have been correctly updated\r\n      if (!this._internal.hasScheduledTriggerItemOutputSignal) {\r\n        this._internal.hasScheduledTriggerItemOutputSignal = true;\r\n        this.context.scheduleAfterUpdate(() => {\r\n          this._internal.hasScheduledTriggerItemOutputSignal = false;\r\n          for (var key in itemNode._outputs) {\r\n            var _output = 'itemOutput-' + key;\r\n            if (this.hasOutput(_output)) {\r\n              this._internal.itemOutputs[key] = itemNode._outputs[key].value;\r\n              this.flagOutputDirty(_output);\r\n            }\r\n          }\r\n          this.sendSignalOnOutput('itemOutputSignal-' + this._internal.itemActionSignal);\r\n        });\r\n      }\r\n    },\r\n    getItemOutput: function (name) {\r\n      return this._internal.itemOutputs[name];\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('itemOutputSignal-')) {\r\n        this._internal.itemOutputSignals[name.substring('itemOutputSignal-'.length)] = true;\r\n        this.registerOutput(name, {\r\n          getter: function () {\r\n            /** No needed for signals */\r\n          }\r\n        });\r\n      } else if (name.startsWith('itemOutput-'))\r\n        this.registerOutput(name, {\r\n          getter: this.getItemOutput.bind(this, name.substring('itemOutput-'.length))\r\n        });\r\n    },\r\n    setInputMappingScript: function (value) {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          'foreach-inputmapping-warning'\r\n        );\r\n      }\r\n\r\n      this._internal.inputMappingScript = value;\r\n\r\n      if (this._internal.inputMappingScript) {\r\n        try {\r\n          this._internal.inputMapFunc = new Function('map', 'object', this._internal.inputMappingScript);\r\n        } catch (e) {\r\n          this._internal.inputMapFunc = undefined;\r\n          if (this.context.editorConnection) {\r\n            this.context.editorConnection.sendWarning(\r\n              this.nodeScope.componentOwner.name,\r\n              this.id,\r\n              'foreach-inputmapping-warning',\r\n              { message: '<strong>Input mapping</strong>: ' + e.message }\r\n            );\r\n          }\r\n        }\r\n      } else {\r\n        this._internal.inputMapFunc = undefined;\r\n      }\r\n\r\n      this.scheduleRefresh();\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'inputMappingScript')\r\n        return this.registerInput(name, {\r\n          set: this.setInputMappingScript.bind(this)\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nfunction _typeName(t) {\r\n  if (typeof t === 'object') return t.name;\r\n  else return t;\r\n}\r\n\r\nconst defaultMapCode =\r\n  '// Here you add mappings between the properties of the item objects and the inputs of the components.\\n' +\r\n  \"// 'myComponentInput': 'myObjectProperty',\\n\" +\r\n  \"// 'anotherComponentInput': function () { return object.get('someProperty') + ' ' + object.get('otherProp') }\\n\" +\r\n  '// These are the default mappings based on the selected template component.\\n' +\r\n  'map({\\n' +\r\n  '{{#mappings}}' +\r\n  '})\\n';\r\n\r\nmodule.exports = {\r\n  ForEachComponent: ForEachComponent,\r\n  node: ForEachDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _collectPortsInTemplateComponent() {\r\n        var templateComponentName = node.parameters.template;\r\n        if (templateComponentName === undefined) return;\r\n\r\n        var ports = [];\r\n        var c = graphModel.components[templateComponentName];\r\n        if (c === undefined) return;\r\n\r\n        // Collect item outputs and signals\r\n        for (var outputName in c.outputPorts) {\r\n          var o = c.outputPorts[outputName];\r\n          if (_typeName(o.type) === 'signal') {\r\n            ports.push({\r\n              name: 'itemOutputSignal-' + outputName,\r\n              displayName: outputName,\r\n              type: 'signal',\r\n              plug: 'output',\r\n              group: 'Item Signals'\r\n            });\r\n          } else {\r\n            ports.push({\r\n              name: 'itemOutput-' + outputName,\r\n              displayName: outputName,\r\n              type: o.type,\r\n              plug: 'output',\r\n              group: 'Item Outputs'\r\n            });\r\n          }\r\n        }\r\n\r\n        // Collect default mappigs for template component inputs\r\n        var defaultMappings = '';\r\n        for (var inputName in c.inputPorts) {\r\n          var o = c.inputPorts[inputName];\r\n          if (_typeName(o.type) !== 'signal') {\r\n            defaultMappings += \"\\t'\" + inputName + \"': '\" + inputName + \"',\\n\";\r\n          }\r\n        }\r\n\r\n        ports.push({\r\n          name: 'inputMappingScript',\r\n          type: { name: 'string', codeeditor: 'javascript' },\r\n          displayName: 'Script',\r\n          group: 'Input Mapping',\r\n          default: defaultMapCode.replace('{{#mappings}}', defaultMappings),\r\n          plug: 'input'\r\n        });\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports, {\r\n          detectRenamed: {\r\n            plug: 'output',\r\n            prefix: 'itemOutput'\r\n          }\r\n        });\r\n      }\r\n\r\n      function _trackComponentOutputs(componentName) {\r\n        if (componentName === undefined) return;\r\n        var c = graphModel.components[componentName];\r\n        if (c === undefined) return;\r\n\r\n        c.on('outputPortAdded', _collectPortsInTemplateComponent);\r\n        c.on('outputPortRemoved', _collectPortsInTemplateComponent);\r\n        c.on('outputPortTypesUpdated', _collectPortsInTemplateComponent);\r\n\r\n        c.on('inputPortTypesUpdated', _collectPortsInTemplateComponent);\r\n        c.on('inputPortAdded', _collectPortsInTemplateComponent);\r\n        c.on('inputPortRemoved', _collectPortsInTemplateComponent);\r\n      }\r\n\r\n      _collectPortsInTemplateComponent();\r\n      _trackComponentOutputs(node.parameters.template);\r\n      node.on('parameterUpdated', function (event) {\r\n        if (event.name === 'template') {\r\n          _collectPortsInTemplateComponent();\r\n          _trackComponentOutputs(node.parameters.template);\r\n        }\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.For Each', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('For Each')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","/**\n * BezierEasing - use bezier curve for transition easing function\n * by Gaëtan Renaudeau 2014 - 2015 – MIT License\n *\n * Credits: is based on Firefox's nsSMILKeySpline.cpp\n * Usage:\n * var spline = BezierEasing([ 0.25, 0.1, 0.25, 1.0 ])\n * spline.get(x) => returns the easing value | x must be in [0, 1] range\n *\n */\n\n// These values are established by empiricism with tests (tradeoff: performance VS precision)\nvar NEWTON_ITERATIONS = 4;\nvar NEWTON_MIN_SLOPE = 0.001;\nvar SUBDIVISION_PRECISION = 0.0000001;\nvar SUBDIVISION_MAX_ITERATIONS = 10;\n\nvar kSplineTableSize = 11;\nvar kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\nvar float32ArraySupported = typeof Float32Array === \"function\";\n\nfunction A (aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1; }\nfunction B (aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1; }\nfunction C (aA1)      { return 3.0 * aA1; }\n\n// Returns x(t) given t, x1, and x2, or y(t) given t, y1, and y2.\nfunction calcBezier (aT, aA1, aA2) {\n  return ((A(aA1, aA2)*aT + B(aA1, aA2))*aT + C(aA1))*aT;\n}\n\n// Returns dx/dt given t, x1, and x2, or dy/dt given t, y1, and y2.\nfunction getSlope (aT, aA1, aA2) {\n  return 3.0 * A(aA1, aA2)*aT*aT + 2.0 * B(aA1, aA2) * aT + C(aA1);\n}\n\nfunction binarySubdivide (aX, aA, aB, mX1, mX2) {\n  var currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2.0;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0.0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (Math.abs(currentX) > SUBDIVISION_PRECISION && ++i < SUBDIVISION_MAX_ITERATIONS);\n  return currentT;\n}\n\nfunction newtonRaphsonIterate (aX, aGuessT, mX1, mX2) {\n  for (var i = 0; i < NEWTON_ITERATIONS; ++i) {\n    var currentSlope = getSlope(aGuessT, mX1, mX2);\n    if (currentSlope === 0.0) return aGuessT;\n    var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n    aGuessT -= currentX / currentSlope;\n  }\n  return aGuessT;\n}\n\n/**\n * points is an array of [ mX1, mY1, mX2, mY2 ]\n */\nfunction BezierEasing (points, b, c, d) {\n  if (arguments.length === 4) {\n    return new BezierEasing([ points, b, c, d ]);\n  }\n  if (!(this instanceof BezierEasing)) return new BezierEasing(points);\n\n  if (!points || points.length !== 4) {\n    throw new Error(\"BezierEasing: points must contains 4 values\");\n  }\n  for (var i=0; i<4; ++i) {\n    if (typeof points[i] !== \"number\" || isNaN(points[i]) || !isFinite(points[i])) {\n      throw new Error(\"BezierEasing: points should be integers.\");\n    }\n  }\n  if (points[0] < 0 || points[0] > 1 || points[2] < 0 || points[2] > 1) {\n    throw new Error(\"BezierEasing x values must be in [0, 1] range.\");\n  }\n\n  this._str = \"BezierEasing(\"+points+\")\";\n  this._css = \"cubic-bezier(\"+points+\")\";\n  this._p = points;\n  this._mSampleValues = float32ArraySupported ? new Float32Array(kSplineTableSize) : new Array(kSplineTableSize);\n  this._precomputed = false;\n\n  this.get = this.get.bind(this);\n}\n\nBezierEasing.prototype = {\n\n  get: function (x) {\n    var mX1 = this._p[0],\n      mY1 = this._p[1],\n      mX2 = this._p[2],\n      mY2 = this._p[3];\n    if (!this._precomputed) this._precompute();\n    if (mX1 === mY1 && mX2 === mY2) return x; // linear\n    // Because JavaScript number are imprecise, we should guarantee the extremes are right.\n    if (x === 0) return 0;\n    if (x === 1) return 1;\n    return calcBezier(this._getTForX(x), mY1, mY2);\n  },\n\n  getPoints: function() {\n    return this._p;\n  },\n\n  toString: function () {\n    return this._str;\n  },\n\n  toCSS: function () {\n    return this._css;\n  },\n\n  // Private part\n\n  _precompute: function () {\n    var mX1 = this._p[0],\n      mY1 = this._p[1],\n      mX2 = this._p[2],\n      mY2 = this._p[3];\n    this._precomputed = true;\n    if (mX1 !== mY1 || mX2 !== mY2)\n      this._calcSampleValues();\n  },\n\n  _calcSampleValues: function () {\n    var mX1 = this._p[0],\n      mX2 = this._p[2];\n    for (var i = 0; i < kSplineTableSize; ++i) {\n      this._mSampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n    }\n  },\n\n  /**\n   * getTForX chose the fastest heuristic to determine the percentage value precisely from a given X projection.\n   */\n  _getTForX: function (aX) {\n    var mX1 = this._p[0],\n      mX2 = this._p[2],\n      mSampleValues = this._mSampleValues;\n\n    var intervalStart = 0.0;\n    var currentSample = 1;\n    var lastSample = kSplineTableSize - 1;\n\n    for (; currentSample !== lastSample && mSampleValues[currentSample] <= aX; ++currentSample) {\n      intervalStart += kSampleStepSize;\n    }\n    --currentSample;\n\n    // Interpolate to provide an initial guess for t\n    var dist = (aX - mSampleValues[currentSample]) / (mSampleValues[currentSample+1] - mSampleValues[currentSample]);\n    var guessForT = intervalStart + dist * kSampleStepSize;\n\n    var initialSlope = getSlope(guessForT, mX1, mX2);\n    if (initialSlope >= NEWTON_MIN_SLOPE) {\n      return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n    } else if (initialSlope === 0.0) {\n      return guessForT;\n    } else {\n      return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n    }\n  }\n};\n\n// CSS mapping\nBezierEasing.css = {\n  \"ease\":        BezierEasing.ease      = BezierEasing(0.25, 0.1, 0.25, 1.0),\n  \"linear\":      BezierEasing.linear    = BezierEasing(0.00, 0.0, 1.00, 1.0),\n  \"ease-in\":     BezierEasing.easeIn    = BezierEasing(0.42, 0.0, 1.00, 1.0),\n  \"ease-out\":    BezierEasing.easeOut   = BezierEasing(0.00, 0.0, 0.58, 1.0),\n  \"ease-in-out\": BezierEasing.easeInOut = BezierEasing(0.42, 0.0, 0.58, 1.0)\n};\n\nmodule.exports = BezierEasing;\n","function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f);else for(t in e)e[t]&&(n&&(n+=\" \"),n+=t);return n}export function clsx(){for(var e,t,f=0,n=\"\";f<arguments.length;)(e=arguments[f++])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array ? array.length : 0;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\n/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array ? array.length : 0;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array ? array.length : 0,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\n/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\n/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  if (value !== value) {\n    return baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\n/**\n * Checks if a cache value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    splice = arrayProto.splice,\n    spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map'),\n    nativeCreate = getNative(Object, 'create');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values ? values.length : 0;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = array;\n    return apply(func, this, otherArgs);\n  };\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Creates an array of `array` values not included in the other given arrays\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons. The order of result values is determined by the\n * order they occur in the first array.\n *\n * **Note:** Unlike `_.pullAll`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {...Array} [values] The values to exclude.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.without, _.xor\n * @example\n *\n * _.difference([2, 1], [2, 3]);\n * // => [1]\n */\nvar difference = baseRest(function(array, values) {\n  return isArrayLikeObject(array)\n    ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))\n    : [];\n});\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nfunction isArguments(value) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&\n    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\nmodule.exports = difference;\n","/**\n * Lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright JS Foundation and other contributors <https://js.foundation/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    asyncTag = '[object AsyncFunction]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    nullTag = '[object Null]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    proxyTag = '[object Proxy]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    undefinedTag = '[object Undefined]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\n/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\n/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\n/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    Symbol = root.Symbol,\n    Uint8Array = root.Uint8Array,\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    splice = arrayProto.splice,\n    symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols,\n    nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,\n    nativeKeys = overArg(Object.keys, Object);\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView'),\n    Map = getNative(root, 'Map'),\n    Promise = getNative(root, 'Promise'),\n    Set = getNative(root, 'Set'),\n    WeakMap = getNative(root, 'WeakMap'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\n/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\n/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\n/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\n/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = isEqual;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"DraggableCore\", {\n  enumerable: true,\n  get: function get() {\n    return _DraggableCore.default;\n  }\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactDom = _interopRequireDefault(require(\"react-dom\"));\n\nvar _clsx2 = _interopRequireDefault(require(\"clsx\"));\n\nvar _domFns = require(\"./utils/domFns\");\n\nvar _positionFns = require(\"./utils/positionFns\");\n\nvar _shims = require(\"./utils/shims\");\n\nvar _DraggableCore = _interopRequireDefault(require(\"./DraggableCore\"));\n\nvar _log = _interopRequireDefault(require(\"./utils/log\"));\n\nvar _excluded = [\"axis\", \"bounds\", \"children\", \"defaultPosition\", \"defaultClassName\", \"defaultClassNameDragging\", \"defaultClassNameDragged\", \"position\", \"positionOffset\", \"scale\"];\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n// Define <Draggable>\n//\nvar Draggable = /*#__PURE__*/function (_React$Component) {\n  _inherits(Draggable, _React$Component);\n\n  var _super = _createSuper(Draggable);\n\n  function Draggable(props\n  /*: DraggableProps*/\n  ) {\n    var _this;\n\n    _classCallCheck(this, Draggable);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"onDragStart\", function (e, coreData) {\n      (0, _log.default)('Draggable: onDragStart: %j', coreData); // Short-circuit if user's callback killed it.\n\n      var shouldStart = _this.props.onStart(e, (0, _positionFns.createDraggableData)(_assertThisInitialized(_this), coreData)); // Kills start event on core as well, so move handlers are never bound.\n\n\n      if (shouldStart === false) return false;\n\n      _this.setState({\n        dragging: true,\n        dragged: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onDrag\", function (e, coreData) {\n      if (!_this.state.dragging) return false;\n      (0, _log.default)('Draggable: onDrag: %j', coreData);\n      var uiData = (0, _positionFns.createDraggableData)(_assertThisInitialized(_this), coreData);\n      var newState\n      /*: $Shape<DraggableState>*/\n      = {\n        x: uiData.x,\n        y: uiData.y\n      }; // Keep within bounds.\n\n      if (_this.props.bounds) {\n        // Save original x and y.\n        var x = newState.x,\n            y = newState.y; // Add slack to the values used to calculate bound position. This will ensure that if\n        // we start removing slack, the element won't react to it right away until it's been\n        // completely removed.\n\n        newState.x += _this.state.slackX;\n        newState.y += _this.state.slackY; // Get bound position. This will ceil/floor the x and y within the boundaries.\n\n        var _getBoundPosition = (0, _positionFns.getBoundPosition)(_assertThisInitialized(_this), newState.x, newState.y),\n            _getBoundPosition2 = _slicedToArray(_getBoundPosition, 2),\n            newStateX = _getBoundPosition2[0],\n            newStateY = _getBoundPosition2[1];\n\n        newState.x = newStateX;\n        newState.y = newStateY; // Recalculate slack by noting how much was shaved by the boundPosition handler.\n\n        newState.slackX = _this.state.slackX + (x - newState.x);\n        newState.slackY = _this.state.slackY + (y - newState.y); // Update the event we fire to reflect what really happened after bounds took effect.\n\n        uiData.x = newState.x;\n        uiData.y = newState.y;\n        uiData.deltaX = newState.x - _this.state.x;\n        uiData.deltaY = newState.y - _this.state.y;\n      } // Short-circuit if user's callback killed it.\n\n\n      var shouldUpdate = _this.props.onDrag(e, uiData);\n\n      if (shouldUpdate === false) return false;\n\n      _this.setState(newState);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onDragStop\", function (e, coreData) {\n      if (!_this.state.dragging) return false; // Short-circuit if user's callback killed it.\n\n      var shouldContinue = _this.props.onStop(e, (0, _positionFns.createDraggableData)(_assertThisInitialized(_this), coreData));\n\n      if (shouldContinue === false) return false;\n      (0, _log.default)('Draggable: onDragStop: %j', coreData);\n      var newState\n      /*: $Shape<DraggableState>*/\n      = {\n        dragging: false,\n        slackX: 0,\n        slackY: 0\n      }; // If this is a controlled component, the result of this operation will be to\n      // revert back to the old position. We expect a handler on `onDragStop`, at the least.\n\n      var controlled = Boolean(_this.props.position);\n\n      if (controlled) {\n        var _this$props$position = _this.props.position,\n            x = _this$props$position.x,\n            y = _this$props$position.y;\n        newState.x = x;\n        newState.y = y;\n      }\n\n      _this.setState(newState);\n    });\n\n    _this.state = {\n      // Whether or not we are currently dragging.\n      dragging: false,\n      // Whether or not we have been dragged before.\n      dragged: false,\n      // Current transform x and y.\n      x: props.position ? props.position.x : props.defaultPosition.x,\n      y: props.position ? props.position.y : props.defaultPosition.y,\n      prevPropsPosition: _objectSpread({}, props.position),\n      // Used for compensating for out-of-bounds drags\n      slackX: 0,\n      slackY: 0,\n      // Can only determine if SVG after mounting\n      isElementSVG: false\n    };\n\n    if (props.position && !(props.onDrag || props.onStop)) {\n      // eslint-disable-next-line no-console\n      console.warn('A `position` was applied to this <Draggable>, without drag handlers. This will make this ' + 'component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the ' + '`position` of this element.');\n    }\n\n    return _this;\n  }\n\n  _createClass(Draggable, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // Check to see if the element passed is an instanceof SVGElement\n      if (typeof window.SVGElement !== 'undefined' && this.findDOMNode() instanceof window.SVGElement) {\n        this.setState({\n          isElementSVG: true\n        });\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.setState({\n        dragging: false\n      }); // prevents invariant if unmounted while dragging\n    } // React Strict Mode compatibility: if `nodeRef` is passed, we will use it instead of trying to find\n    // the underlying DOM node ourselves. See the README for more information.\n\n  }, {\n    key: \"findDOMNode\",\n    value: function findDOMNode()\n    /*: ?HTMLElement*/\n    {\n      var _this$props$nodeRef$c, _this$props, _this$props$nodeRef;\n\n      return (_this$props$nodeRef$c = (_this$props = this.props) === null || _this$props === void 0 ? void 0 : (_this$props$nodeRef = _this$props.nodeRef) === null || _this$props$nodeRef === void 0 ? void 0 : _this$props$nodeRef.current) !== null && _this$props$nodeRef$c !== void 0 ? _this$props$nodeRef$c : _reactDom.default.findDOMNode(this);\n    }\n  }, {\n    key: \"render\",\n    value: function render()\n    /*: ReactElement<any>*/\n    {\n      var _clsx;\n\n      var _this$props2 = this.props,\n          axis = _this$props2.axis,\n          bounds = _this$props2.bounds,\n          children = _this$props2.children,\n          defaultPosition = _this$props2.defaultPosition,\n          defaultClassName = _this$props2.defaultClassName,\n          defaultClassNameDragging = _this$props2.defaultClassNameDragging,\n          defaultClassNameDragged = _this$props2.defaultClassNameDragged,\n          position = _this$props2.position,\n          positionOffset = _this$props2.positionOffset,\n          scale = _this$props2.scale,\n          draggableCoreProps = _objectWithoutProperties(_this$props2, _excluded);\n\n      var style = {};\n      var svgTransform = null; // If this is controlled, we don't want to move it - unless it's dragging.\n\n      var controlled = Boolean(position);\n      var draggable = !controlled || this.state.dragging;\n      var validPosition = position || defaultPosition;\n      var transformOpts = {\n        // Set left if horizontal drag is enabled\n        x: (0, _positionFns.canDragX)(this) && draggable ? this.state.x : validPosition.x,\n        // Set top if vertical drag is enabled\n        y: (0, _positionFns.canDragY)(this) && draggable ? this.state.y : validPosition.y\n      }; // If this element was SVG, we use the `transform` attribute.\n\n      if (this.state.isElementSVG) {\n        svgTransform = (0, _domFns.createSVGTransform)(transformOpts, positionOffset);\n      } else {\n        // Add a CSS transform to move the element around. This allows us to move the element around\n        // without worrying about whether or not it is relatively or absolutely positioned.\n        // If the item you are dragging already has a transform set, wrap it in a <span> so <Draggable>\n        // has a clean slate.\n        style = (0, _domFns.createCSSTransform)(transformOpts, positionOffset);\n      } // Mark with class while dragging\n\n\n      var className = (0, _clsx2.default)(children.props.className || '', defaultClassName, (_clsx = {}, _defineProperty(_clsx, defaultClassNameDragging, this.state.dragging), _defineProperty(_clsx, defaultClassNameDragged, this.state.dragged), _clsx)); // Reuse the child provided\n      // This makes it flexible to use whatever element is wanted (div, ul, etc)\n\n      return /*#__PURE__*/React.createElement(_DraggableCore.default, _extends({}, draggableCoreProps, {\n        onStart: this.onDragStart,\n        onDrag: this.onDrag,\n        onStop: this.onDragStop\n      }), /*#__PURE__*/React.cloneElement(React.Children.only(children), {\n        className: className,\n        style: _objectSpread(_objectSpread({}, children.props.style), style),\n        transform: svgTransform\n      }));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: // React 16.3+\n    // Arity (props, state)\n    function getDerivedStateFromProps(_ref, _ref2)\n    /*: ?$Shape<DraggableState>*/\n    {\n      var position = _ref.position;\n      var prevPropsPosition = _ref2.prevPropsPosition;\n\n      // Set x/y if a new position is provided in props that is different than the previous.\n      if (position && (!prevPropsPosition || position.x !== prevPropsPosition.x || position.y !== prevPropsPosition.y)) {\n        (0, _log.default)('Draggable: getDerivedStateFromProps %j', {\n          position: position,\n          prevPropsPosition: prevPropsPosition\n        });\n        return {\n          x: position.x,\n          y: position.y,\n          prevPropsPosition: _objectSpread({}, position)\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  return Draggable;\n}(React.Component);\n\nexports.default = Draggable;\n\n_defineProperty(Draggable, \"displayName\", 'Draggable');\n\n_defineProperty(Draggable, \"propTypes\", _objectSpread(_objectSpread({}, _DraggableCore.default.propTypes), {}, {\n  /**\n   * `axis` determines which axis the draggable can move.\n   *\n   *  Note that all callbacks will still return data as normal. This only\n   *  controls flushing to the DOM.\n   *\n   * 'both' allows movement horizontally and vertically.\n   * 'x' limits movement to horizontal axis.\n   * 'y' limits movement to vertical axis.\n   * 'none' limits all movement.\n   *\n   * Defaults to 'both'.\n   */\n  axis: _propTypes.default.oneOf(['both', 'x', 'y', 'none']),\n\n  /**\n   * `bounds` determines the range of movement available to the element.\n   * Available values are:\n   *\n   * 'parent' restricts movement within the Draggable's parent node.\n   *\n   * Alternatively, pass an object with the following properties, all of which are optional:\n   *\n   * {left: LEFT_BOUND, right: RIGHT_BOUND, bottom: BOTTOM_BOUND, top: TOP_BOUND}\n   *\n   * All values are in px.\n   *\n   * Example:\n   *\n   * ```jsx\n   *   let App = React.createClass({\n   *       render: function () {\n   *         return (\n   *            <Draggable bounds={{right: 300, bottom: 300}}>\n   *              <div>Content</div>\n   *           </Draggable>\n   *         );\n   *       }\n   *   });\n   * ```\n   */\n  bounds: _propTypes.default.oneOfType([_propTypes.default.shape({\n    left: _propTypes.default.number,\n    right: _propTypes.default.number,\n    top: _propTypes.default.number,\n    bottom: _propTypes.default.number\n  }), _propTypes.default.string, _propTypes.default.oneOf([false])]),\n  defaultClassName: _propTypes.default.string,\n  defaultClassNameDragging: _propTypes.default.string,\n  defaultClassNameDragged: _propTypes.default.string,\n\n  /**\n   * `defaultPosition` specifies the x and y that the dragged item should start at\n   *\n   * Example:\n   *\n   * ```jsx\n   *      let App = React.createClass({\n   *          render: function () {\n   *              return (\n   *                  <Draggable defaultPosition={{x: 25, y: 25}}>\n   *                      <div>I start with transformX: 25px and transformY: 25px;</div>\n   *                  </Draggable>\n   *              );\n   *          }\n   *      });\n   * ```\n   */\n  defaultPosition: _propTypes.default.shape({\n    x: _propTypes.default.number,\n    y: _propTypes.default.number\n  }),\n  positionOffset: _propTypes.default.shape({\n    x: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string]),\n    y: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string])\n  }),\n\n  /**\n   * `position`, if present, defines the current position of the element.\n   *\n   *  This is similar to how form elements in React work - if no `position` is supplied, the component\n   *  is uncontrolled.\n   *\n   * Example:\n   *\n   * ```jsx\n   *      let App = React.createClass({\n   *          render: function () {\n   *              return (\n   *                  <Draggable position={{x: 25, y: 25}}>\n   *                      <div>I start with transformX: 25px and transformY: 25px;</div>\n   *                  </Draggable>\n   *              );\n   *          }\n   *      });\n   * ```\n   */\n  position: _propTypes.default.shape({\n    x: _propTypes.default.number,\n    y: _propTypes.default.number\n  }),\n\n  /**\n   * These properties should be defined on the child, not here.\n   */\n  className: _shims.dontSetMe,\n  style: _shims.dontSetMe,\n  transform: _shims.dontSetMe\n}));\n\n_defineProperty(Draggable, \"defaultProps\", _objectSpread(_objectSpread({}, _DraggableCore.default.defaultProps), {}, {\n  axis: 'both',\n  bounds: false,\n  defaultClassName: 'react-draggable',\n  defaultClassNameDragging: 'react-draggable-dragging',\n  defaultClassNameDragged: 'react-draggable-dragged',\n  defaultPosition: {\n    x: 0,\n    y: 0\n  },\n  scale: 1\n}));","\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactDom = _interopRequireDefault(require(\"react-dom\"));\n\nvar _domFns = require(\"./utils/domFns\");\n\nvar _positionFns = require(\"./utils/positionFns\");\n\nvar _shims = require(\"./utils/shims\");\n\nvar _log = _interopRequireDefault(require(\"./utils/log\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// Simple abstraction for dragging events names.\nvar eventsFor = {\n  touch: {\n    start: 'touchstart',\n    move: 'touchmove',\n    stop: 'touchend'\n  },\n  mouse: {\n    start: 'mousedown',\n    move: 'mousemove',\n    stop: 'mouseup'\n  }\n}; // Default to mouse events.\n\nvar dragEventFor = eventsFor.mouse;\n/*:: type DraggableCoreState = {\n  dragging: boolean,\n  lastX: number,\n  lastY: number,\n  touchIdentifier: ?number\n};*/\n\n/*:: export type DraggableData = {\n  node: HTMLElement,\n  x: number, y: number,\n  deltaX: number, deltaY: number,\n  lastX: number, lastY: number,\n};*/\n\n/*:: export type DraggableEventHandler = (e: MouseEvent, data: DraggableData) => void | false;*/\n\n/*:: export type ControlPosition = {x: number, y: number};*/\n\n/*:: export type PositionOffsetControlPosition = {x: number|string, y: number|string};*/\n\n/*:: export type DraggableCoreDefaultProps = {\n  allowAnyClick: boolean,\n  disabled: boolean,\n  enableUserSelectHack: boolean,\n  onStart: DraggableEventHandler,\n  onDrag: DraggableEventHandler,\n  onStop: DraggableEventHandler,\n  onMouseDown: (e: MouseEvent) => void,\n  scale: number,\n};*/\n\n/*:: export type DraggableCoreProps = {\n  ...DraggableCoreDefaultProps,\n  cancel: string,\n  children: ReactElement<any>,\n  offsetParent: HTMLElement,\n  grid: [number, number],\n  handle: string,\n  nodeRef?: ?React.ElementRef<any>,\n};*/\n\n//\n// Define <DraggableCore>.\n//\n// <DraggableCore> is for advanced usage of <Draggable>. It maintains minimal internal state so it can\n// work well with libraries that require more control over the element.\n//\nvar DraggableCore = /*#__PURE__*/function (_React$Component) {\n  _inherits(DraggableCore, _React$Component);\n\n  var _super = _createSuper(DraggableCore);\n\n  function DraggableCore() {\n    var _this;\n\n    _classCallCheck(this, DraggableCore);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      dragging: false,\n      // Used while dragging to determine deltas.\n      lastX: NaN,\n      lastY: NaN,\n      touchIdentifier: null\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"mounted\", false);\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDragStart\", function (e) {\n      // Make it possible to attach event handlers on top of this one.\n      _this.props.onMouseDown(e); // Only accept left-clicks.\n\n\n      if (!_this.props.allowAnyClick && typeof e.button === 'number' && e.button !== 0) return false; // Get nodes. Be sure to grab relative document (could be iframed)\n\n      var thisNode = _this.findDOMNode();\n\n      if (!thisNode || !thisNode.ownerDocument || !thisNode.ownerDocument.body) {\n        throw new Error('<DraggableCore> not mounted on DragStart!');\n      }\n\n      var ownerDocument = thisNode.ownerDocument; // Short circuit if handle or cancel prop was provided and selector doesn't match.\n\n      if (_this.props.disabled || !(e.target instanceof ownerDocument.defaultView.Node) || _this.props.handle && !(0, _domFns.matchesSelectorAndParentsTo)(e.target, _this.props.handle, thisNode) || _this.props.cancel && (0, _domFns.matchesSelectorAndParentsTo)(e.target, _this.props.cancel, thisNode)) {\n        return;\n      } // Prevent scrolling on mobile devices, like ipad/iphone.\n      // Important that this is after handle/cancel.\n\n\n      if (e.type === 'touchstart') e.preventDefault(); // Set touch identifier in component state if this is a touch event. This allows us to\n      // distinguish between individual touches on multitouch screens by identifying which\n      // touchpoint was set to this element.\n\n      var touchIdentifier = (0, _domFns.getTouchIdentifier)(e);\n\n      _this.setState({\n        touchIdentifier: touchIdentifier\n      }); // Get the current drag point from the event. This is used as the offset.\n\n\n      var position = (0, _positionFns.getControlPosition)(e, touchIdentifier, _assertThisInitialized(_this));\n      if (position == null) return; // not possible but satisfies flow\n\n      var x = position.x,\n          y = position.y; // Create an event object with all the data parents need to make a decision here.\n\n      var coreEvent = (0, _positionFns.createCoreData)(_assertThisInitialized(_this), x, y);\n      (0, _log.default)('DraggableCore: handleDragStart: %j', coreEvent); // Call event handler. If it returns explicit false, cancel.\n\n      (0, _log.default)('calling', _this.props.onStart);\n\n      var shouldUpdate = _this.props.onStart(e, coreEvent);\n\n      if (shouldUpdate === false || _this.mounted === false) return; // Add a style to the body to disable user-select. This prevents text from\n      // being selected all over the page.\n\n      if (_this.props.enableUserSelectHack) (0, _domFns.addUserSelectStyles)(ownerDocument); // Initiate dragging. Set the current x and y as offsets\n      // so we know how much we've moved during the drag. This allows us\n      // to drag elements around even if they have been moved, without issue.\n\n      _this.setState({\n        dragging: true,\n        lastX: x,\n        lastY: y\n      }); // Add events to the document directly so we catch when the user's mouse/touch moves outside of\n      // this element. We use different events depending on whether or not we have detected that this\n      // is a touch-capable device.\n\n\n      (0, _domFns.addEvent)(ownerDocument, dragEventFor.move, _this.handleDrag);\n      (0, _domFns.addEvent)(ownerDocument, dragEventFor.stop, _this.handleDragStop);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDrag\", function (e) {\n      // Get the current drag point from the event. This is used as the offset.\n      var position = (0, _positionFns.getControlPosition)(e, _this.state.touchIdentifier, _assertThisInitialized(_this));\n      if (position == null) return;\n      var x = position.x,\n          y = position.y; // Snap to grid if prop has been provided\n\n      if (Array.isArray(_this.props.grid)) {\n        var deltaX = x - _this.state.lastX,\n            deltaY = y - _this.state.lastY;\n\n        var _snapToGrid = (0, _positionFns.snapToGrid)(_this.props.grid, deltaX, deltaY);\n\n        var _snapToGrid2 = _slicedToArray(_snapToGrid, 2);\n\n        deltaX = _snapToGrid2[0];\n        deltaY = _snapToGrid2[1];\n        if (!deltaX && !deltaY) return; // skip useless drag\n\n        x = _this.state.lastX + deltaX, y = _this.state.lastY + deltaY;\n      }\n\n      var coreEvent = (0, _positionFns.createCoreData)(_assertThisInitialized(_this), x, y);\n      (0, _log.default)('DraggableCore: handleDrag: %j', coreEvent); // Call event handler. If it returns explicit false, trigger end.\n\n      var shouldUpdate = _this.props.onDrag(e, coreEvent);\n\n      if (shouldUpdate === false || _this.mounted === false) {\n        try {\n          // $FlowIgnore\n          _this.handleDragStop(new MouseEvent('mouseup'));\n        } catch (err) {\n          // Old browsers\n          var event = ((document.createEvent('MouseEvents')\n          /*: any*/\n          )\n          /*: MouseTouchEvent*/\n          ); // I see why this insanity was deprecated\n          // $FlowIgnore\n\n          event.initMouseEvent('mouseup', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n\n          _this.handleDragStop(event);\n        }\n\n        return;\n      }\n\n      _this.setState({\n        lastX: x,\n        lastY: y\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDragStop\", function (e) {\n      if (!_this.state.dragging) return;\n      var position = (0, _positionFns.getControlPosition)(e, _this.state.touchIdentifier, _assertThisInitialized(_this));\n      if (position == null) return;\n      var x = position.x,\n          y = position.y; // Snap to grid if prop has been provided\n\n      if (Array.isArray(_this.props.grid)) {\n        var deltaX = x - _this.state.lastX || 0;\n        var deltaY = y - _this.state.lastY || 0;\n\n        var _snapToGrid3 = (0, _positionFns.snapToGrid)(_this.props.grid, deltaX, deltaY);\n\n        var _snapToGrid4 = _slicedToArray(_snapToGrid3, 2);\n\n        deltaX = _snapToGrid4[0];\n        deltaY = _snapToGrid4[1];\n        x = _this.state.lastX + deltaX, y = _this.state.lastY + deltaY;\n      }\n\n      var coreEvent = (0, _positionFns.createCoreData)(_assertThisInitialized(_this), x, y); // Call event handler\n\n      var shouldContinue = _this.props.onStop(e, coreEvent);\n\n      if (shouldContinue === false || _this.mounted === false) return false;\n\n      var thisNode = _this.findDOMNode();\n\n      if (thisNode) {\n        // Remove user-select hack\n        if (_this.props.enableUserSelectHack) (0, _domFns.removeUserSelectStyles)(thisNode.ownerDocument);\n      }\n\n      (0, _log.default)('DraggableCore: handleDragStop: %j', coreEvent); // Reset the el.\n\n      _this.setState({\n        dragging: false,\n        lastX: NaN,\n        lastY: NaN\n      });\n\n      if (thisNode) {\n        // Remove event handlers\n        (0, _log.default)('DraggableCore: Removing handlers');\n        (0, _domFns.removeEvent)(thisNode.ownerDocument, dragEventFor.move, _this.handleDrag);\n        (0, _domFns.removeEvent)(thisNode.ownerDocument, dragEventFor.stop, _this.handleDragStop);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onMouseDown\", function (e) {\n      dragEventFor = eventsFor.mouse; // on touchscreen laptops we could switch back to mouse\n\n      return _this.handleDragStart(e);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onMouseUp\", function (e) {\n      dragEventFor = eventsFor.mouse;\n      return _this.handleDragStop(e);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onTouchStart\", function (e) {\n      // We're on a touch device now, so change the event handlers\n      dragEventFor = eventsFor.touch;\n      return _this.handleDragStart(e);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onTouchEnd\", function (e) {\n      // We're on a touch device now, so change the event handlers\n      dragEventFor = eventsFor.touch;\n      return _this.handleDragStop(e);\n    });\n\n    return _this;\n  }\n\n  _createClass(DraggableCore, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.mounted = true; // Touch handlers must be added with {passive: false} to be cancelable.\n      // https://developers.google.com/web/updates/2017/01/scrolling-intervention\n\n      var thisNode = this.findDOMNode();\n\n      if (thisNode) {\n        (0, _domFns.addEvent)(thisNode, eventsFor.touch.start, this.onTouchStart, {\n          passive: false\n        });\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.mounted = false; // Remove any leftover event handlers. Remove both touch and mouse handlers in case\n      // some browser quirk caused a touch event to fire during a mouse move, or vice versa.\n\n      var thisNode = this.findDOMNode();\n\n      if (thisNode) {\n        var ownerDocument = thisNode.ownerDocument;\n        (0, _domFns.removeEvent)(ownerDocument, eventsFor.mouse.move, this.handleDrag);\n        (0, _domFns.removeEvent)(ownerDocument, eventsFor.touch.move, this.handleDrag);\n        (0, _domFns.removeEvent)(ownerDocument, eventsFor.mouse.stop, this.handleDragStop);\n        (0, _domFns.removeEvent)(ownerDocument, eventsFor.touch.stop, this.handleDragStop);\n        (0, _domFns.removeEvent)(thisNode, eventsFor.touch.start, this.onTouchStart, {\n          passive: false\n        });\n        if (this.props.enableUserSelectHack) (0, _domFns.removeUserSelectStyles)(ownerDocument);\n      }\n    } // React Strict Mode compatibility: if `nodeRef` is passed, we will use it instead of trying to find\n    // the underlying DOM node ourselves. See the README for more information.\n\n  }, {\n    key: \"findDOMNode\",\n    value: function findDOMNode()\n    /*: ?HTMLElement*/\n    {\n      var _this$props, _this$props2, _this$props2$nodeRef;\n\n      return (_this$props = this.props) !== null && _this$props !== void 0 && _this$props.nodeRef ? (_this$props2 = this.props) === null || _this$props2 === void 0 ? void 0 : (_this$props2$nodeRef = _this$props2.nodeRef) === null || _this$props2$nodeRef === void 0 ? void 0 : _this$props2$nodeRef.current : _reactDom.default.findDOMNode(this);\n    }\n  }, {\n    key: \"render\",\n    value: function render()\n    /*: React.Element<any>*/\n    {\n      // Reuse the child provided\n      // This makes it flexible to use whatever element is wanted (div, ul, etc)\n      return /*#__PURE__*/React.cloneElement(React.Children.only(this.props.children), {\n        // Note: mouseMove handler is attached to document so it will still function\n        // when the user drags quickly and leaves the bounds of the element.\n        onMouseDown: this.onMouseDown,\n        onMouseUp: this.onMouseUp,\n        // onTouchStart is added on `componentDidMount` so they can be added with\n        // {passive: false}, which allows it to cancel. See\n        // https://developers.google.com/web/updates/2017/01/scrolling-intervention\n        onTouchEnd: this.onTouchEnd\n      });\n    }\n  }]);\n\n  return DraggableCore;\n}(React.Component);\n\nexports.default = DraggableCore;\n\n_defineProperty(DraggableCore, \"displayName\", 'DraggableCore');\n\n_defineProperty(DraggableCore, \"propTypes\", {\n  /**\n   * `allowAnyClick` allows dragging using any mouse button.\n   * By default, we only accept the left button.\n   *\n   * Defaults to `false`.\n   */\n  allowAnyClick: _propTypes.default.bool,\n\n  /**\n   * `disabled`, if true, stops the <Draggable> from dragging. All handlers,\n   * with the exception of `onMouseDown`, will not fire.\n   */\n  disabled: _propTypes.default.bool,\n\n  /**\n   * By default, we add 'user-select:none' attributes to the document body\n   * to prevent ugly text selection during drag. If this is causing problems\n   * for your app, set this to `false`.\n   */\n  enableUserSelectHack: _propTypes.default.bool,\n\n  /**\n   * `offsetParent`, if set, uses the passed DOM node to compute drag offsets\n   * instead of using the parent node.\n   */\n  offsetParent: function offsetParent(props\n  /*: DraggableCoreProps*/\n  , propName\n  /*: $Keys<DraggableCoreProps>*/\n  ) {\n    if (props[propName] && props[propName].nodeType !== 1) {\n      throw new Error('Draggable\\'s offsetParent must be a DOM Node.');\n    }\n  },\n\n  /**\n   * `grid` specifies the x and y that dragging should snap to.\n   */\n  grid: _propTypes.default.arrayOf(_propTypes.default.number),\n\n  /**\n   * `handle` specifies a selector to be used as the handle that initiates drag.\n   *\n   * Example:\n   *\n   * ```jsx\n   *   let App = React.createClass({\n   *       render: function () {\n   *         return (\n   *            <Draggable handle=\".handle\">\n   *              <div>\n   *                  <div className=\"handle\">Click me to drag</div>\n   *                  <div>This is some other content</div>\n   *              </div>\n   *           </Draggable>\n   *         );\n   *       }\n   *   });\n   * ```\n   */\n  handle: _propTypes.default.string,\n\n  /**\n   * `cancel` specifies a selector to be used to prevent drag initialization.\n   *\n   * Example:\n   *\n   * ```jsx\n   *   let App = React.createClass({\n   *       render: function () {\n   *           return(\n   *               <Draggable cancel=\".cancel\">\n   *                   <div>\n   *                     <div className=\"cancel\">You can't drag from here</div>\n   *                     <div>Dragging here works fine</div>\n   *                   </div>\n   *               </Draggable>\n   *           );\n   *       }\n   *   });\n   * ```\n   */\n  cancel: _propTypes.default.string,\n\n  /* If running in React Strict mode, ReactDOM.findDOMNode() is deprecated.\n   * Unfortunately, in order for <Draggable> to work properly, we need raw access\n   * to the underlying DOM node. If you want to avoid the warning, pass a `nodeRef`\n   * as in this example:\n   *\n   * function MyComponent() {\n   *   const nodeRef = React.useRef(null);\n   *   return (\n   *     <Draggable nodeRef={nodeRef}>\n   *       <div ref={nodeRef}>Example Target</div>\n   *     </Draggable>\n   *   );\n   * }\n   *\n   * This can be used for arbitrarily nested components, so long as the ref ends up\n   * pointing to the actual child DOM node and not a custom component.\n   */\n  nodeRef: _propTypes.default.object,\n\n  /**\n   * Called when dragging starts.\n   * If this function returns the boolean false, dragging will be canceled.\n   */\n  onStart: _propTypes.default.func,\n\n  /**\n   * Called while dragging.\n   * If this function returns the boolean false, dragging will be canceled.\n   */\n  onDrag: _propTypes.default.func,\n\n  /**\n   * Called when dragging stops.\n   * If this function returns the boolean false, the drag will remain active.\n   */\n  onStop: _propTypes.default.func,\n\n  /**\n   * A workaround option which can be passed if onMouseDown needs to be accessed,\n   * since it'll always be blocked (as there is internal use of onMouseDown)\n   */\n  onMouseDown: _propTypes.default.func,\n\n  /**\n   * `scale`, if set, applies scaling while dragging an element\n   */\n  scale: _propTypes.default.number,\n\n  /**\n   * These properties should be defined on the child, not here.\n   */\n  className: _shims.dontSetMe,\n  style: _shims.dontSetMe,\n  transform: _shims.dontSetMe\n});\n\n_defineProperty(DraggableCore, \"defaultProps\", {\n  allowAnyClick: false,\n  // by default only accept left click\n  disabled: false,\n  enableUserSelectHack: true,\n  onStart: function onStart() {},\n  onDrag: function onDrag() {},\n  onStop: function onStop() {},\n  onMouseDown: function onMouseDown() {},\n  scale: 1\n});","\"use strict\";\n\nvar _require = require('./Draggable'),\n    Draggable = _require.default,\n    DraggableCore = _require.DraggableCore; // Previous versions of this lib exported <Draggable> as the root export. As to no-// them, or TypeScript, we export *both* as the root and as 'default'.\n// See https://github.com/mzabriskie/react-draggable/pull/254\n// and https://github.com/mzabriskie/react-draggable/issues/266\n\n\nmodule.exports = Draggable;\nmodule.exports.default = Draggable;\nmodule.exports.DraggableCore = DraggableCore;","\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.addClassName = addClassName;\nexports.addEvent = addEvent;\nexports.addUserSelectStyles = addUserSelectStyles;\nexports.createCSSTransform = createCSSTransform;\nexports.createSVGTransform = createSVGTransform;\nexports.getTouch = getTouch;\nexports.getTouchIdentifier = getTouchIdentifier;\nexports.getTranslation = getTranslation;\nexports.innerHeight = innerHeight;\nexports.innerWidth = innerWidth;\nexports.matchesSelector = matchesSelector;\nexports.matchesSelectorAndParentsTo = matchesSelectorAndParentsTo;\nexports.offsetXYFromParent = offsetXYFromParent;\nexports.outerHeight = outerHeight;\nexports.outerWidth = outerWidth;\nexports.removeClassName = removeClassName;\nexports.removeEvent = removeEvent;\nexports.removeUserSelectStyles = removeUserSelectStyles;\n\nvar _shims = require(\"./shims\");\n\nvar _getPrefix = _interopRequireWildcard(require(\"./getPrefix\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar matchesSelectorFunc = '';\n\nfunction matchesSelector(el\n/*: Node*/\n, selector\n/*: string*/\n)\n/*: boolean*/\n{\n  if (!matchesSelectorFunc) {\n    matchesSelectorFunc = (0, _shims.findInArray)(['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'], function (method) {\n      // $FlowIgnore: Doesn't think elements are indexable\n      return (0, _shims.isFunction)(el[method]);\n    });\n  } // Might not be found entirely (not an Element?) - in that case, bail\n  // $FlowIgnore: Doesn't think elements are indexable\n\n\n  if (!(0, _shims.isFunction)(el[matchesSelectorFunc])) return false; // $FlowIgnore: Doesn't think elements are indexable\n\n  return el[matchesSelectorFunc](selector);\n} // Works up the tree to the draggable itself attempting to match selector.\n\n\nfunction matchesSelectorAndParentsTo(el\n/*: Node*/\n, selector\n/*: string*/\n, baseNode\n/*: Node*/\n)\n/*: boolean*/\n{\n  var node = el;\n\n  do {\n    if (matchesSelector(node, selector)) return true;\n    if (node === baseNode) return false;\n    node = node.parentNode;\n  } while (node);\n\n  return false;\n}\n\nfunction addEvent(el\n/*: ?Node*/\n, event\n/*: string*/\n, handler\n/*: Function*/\n, inputOptions\n/*: Object*/\n)\n/*: void*/\n{\n  if (!el) return;\n\n  var options = _objectSpread({\n    capture: true\n  }, inputOptions); // $FlowIgnore[method-unbinding]\n\n\n  if (el.addEventListener) {\n    el.addEventListener(event, handler, options);\n  } else if (el.attachEvent) {\n    el.attachEvent('on' + event, handler);\n  } else {\n    // $FlowIgnore: Doesn't think elements are indexable\n    el['on' + event] = handler;\n  }\n}\n\nfunction removeEvent(el\n/*: ?Node*/\n, event\n/*: string*/\n, handler\n/*: Function*/\n, inputOptions\n/*: Object*/\n)\n/*: void*/\n{\n  if (!el) return;\n\n  var options = _objectSpread({\n    capture: true\n  }, inputOptions); // $FlowIgnore[method-unbinding]\n\n\n  if (el.removeEventListener) {\n    el.removeEventListener(event, handler, options);\n  } else if (el.detachEvent) {\n    el.detachEvent('on' + event, handler);\n  } else {\n    // $FlowIgnore: Doesn't think elements are indexable\n    el['on' + event] = null;\n  }\n}\n\nfunction outerHeight(node\n/*: HTMLElement*/\n)\n/*: number*/\n{\n  // This is deliberately excluding margin for our calculations, since we are using\n  // offsetTop which is including margin. See getBoundPosition\n  var height = node.clientHeight;\n  var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n  height += (0, _shims.int)(computedStyle.borderTopWidth);\n  height += (0, _shims.int)(computedStyle.borderBottomWidth);\n  return height;\n}\n\nfunction outerWidth(node\n/*: HTMLElement*/\n)\n/*: number*/\n{\n  // This is deliberately excluding margin for our calculations, since we are using\n  // offsetLeft which is including margin. See getBoundPosition\n  var width = node.clientWidth;\n  var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n  width += (0, _shims.int)(computedStyle.borderLeftWidth);\n  width += (0, _shims.int)(computedStyle.borderRightWidth);\n  return width;\n}\n\nfunction innerHeight(node\n/*: HTMLElement*/\n)\n/*: number*/\n{\n  var height = node.clientHeight;\n  var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n  height -= (0, _shims.int)(computedStyle.paddingTop);\n  height -= (0, _shims.int)(computedStyle.paddingBottom);\n  return height;\n}\n\nfunction innerWidth(node\n/*: HTMLElement*/\n)\n/*: number*/\n{\n  var width = node.clientWidth;\n  var computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n  width -= (0, _shims.int)(computedStyle.paddingLeft);\n  width -= (0, _shims.int)(computedStyle.paddingRight);\n  return width;\n}\n/*:: interface EventWithOffset {\n  clientX: number, clientY: number\n}*/\n\n\n// Get from offsetParent\nfunction offsetXYFromParent(evt\n/*: EventWithOffset*/\n, offsetParent\n/*: HTMLElement*/\n, scale\n/*: number*/\n)\n/*: ControlPosition*/\n{\n  var isBody = offsetParent === offsetParent.ownerDocument.body;\n  var offsetParentRect = isBody ? {\n    left: 0,\n    top: 0\n  } : offsetParent.getBoundingClientRect();\n  var x = (evt.clientX + offsetParent.scrollLeft - offsetParentRect.left) / scale;\n  var y = (evt.clientY + offsetParent.scrollTop - offsetParentRect.top) / scale;\n  return {\n    x: x,\n    y: y\n  };\n}\n\nfunction createCSSTransform(controlPos\n/*: ControlPosition*/\n, positionOffset\n/*: PositionOffsetControlPosition*/\n)\n/*: Object*/\n{\n  var translation = getTranslation(controlPos, positionOffset, 'px');\n  return _defineProperty({}, (0, _getPrefix.browserPrefixToKey)('transform', _getPrefix.default), translation);\n}\n\nfunction createSVGTransform(controlPos\n/*: ControlPosition*/\n, positionOffset\n/*: PositionOffsetControlPosition*/\n)\n/*: string*/\n{\n  var translation = getTranslation(controlPos, positionOffset, '');\n  return translation;\n}\n\nfunction getTranslation(_ref2, positionOffset\n/*: PositionOffsetControlPosition*/\n, unitSuffix\n/*: string*/\n)\n/*: string*/\n{\n  var x = _ref2.x,\n      y = _ref2.y;\n  var translation = \"translate(\".concat(x).concat(unitSuffix, \",\").concat(y).concat(unitSuffix, \")\");\n\n  if (positionOffset) {\n    var defaultX = \"\".concat(typeof positionOffset.x === 'string' ? positionOffset.x : positionOffset.x + unitSuffix);\n    var defaultY = \"\".concat(typeof positionOffset.y === 'string' ? positionOffset.y : positionOffset.y + unitSuffix);\n    translation = \"translate(\".concat(defaultX, \", \").concat(defaultY, \")\") + translation;\n  }\n\n  return translation;\n}\n\nfunction getTouch(e\n/*: MouseTouchEvent*/\n, identifier\n/*: number*/\n)\n/*: ?{clientX: number, clientY: number}*/\n{\n  return e.targetTouches && (0, _shims.findInArray)(e.targetTouches, function (t) {\n    return identifier === t.identifier;\n  }) || e.changedTouches && (0, _shims.findInArray)(e.changedTouches, function (t) {\n    return identifier === t.identifier;\n  });\n}\n\nfunction getTouchIdentifier(e\n/*: MouseTouchEvent*/\n)\n/*: ?number*/\n{\n  if (e.targetTouches && e.targetTouches[0]) return e.targetTouches[0].identifier;\n  if (e.changedTouches && e.changedTouches[0]) return e.changedTouches[0].identifier;\n} // User-select Hacks:\n//\n// Useful for preventing blue highlights all over everything when dragging.\n// Note we're passing `document` b/c we could be iframed\n\n\nfunction addUserSelectStyles(doc\n/*: ?Document*/\n) {\n  if (!doc) return;\n  var styleEl = doc.getElementById('react-draggable-style-el');\n\n  if (!styleEl) {\n    styleEl = doc.createElement('style');\n    styleEl.type = 'text/css';\n    styleEl.id = 'react-draggable-style-el';\n    styleEl.innerHTML = '.react-draggable-transparent-selection *::-moz-selection {all: inherit;}\\n';\n    styleEl.innerHTML += '.react-draggable-transparent-selection *::selection {all: inherit;}\\n';\n    doc.getElementsByTagName('head')[0].appendChild(styleEl);\n  }\n\n  if (doc.body) addClassName(doc.body, 'react-draggable-transparent-selection');\n}\n\nfunction removeUserSelectStyles(doc\n/*: ?Document*/\n) {\n  if (!doc) return;\n\n  try {\n    if (doc.body) removeClassName(doc.body, 'react-draggable-transparent-selection'); // $FlowIgnore: IE\n\n    if (doc.selection) {\n      // $FlowIgnore: IE\n      doc.selection.empty();\n    } else {\n      // Remove selection caused by scroll, unless it's a focused input\n      // (we use doc.defaultView in case we're in an iframe)\n      var selection = (doc.defaultView || window).getSelection();\n\n      if (selection && selection.type !== 'Caret') {\n        selection.removeAllRanges();\n      }\n    }\n  } catch (e) {// probably IE\n  }\n}\n\nfunction addClassName(el\n/*: HTMLElement*/\n, className\n/*: string*/\n) {\n  if (el.classList) {\n    el.classList.add(className);\n  } else {\n    if (!el.className.match(new RegExp(\"(?:^|\\\\s)\".concat(className, \"(?!\\\\S)\")))) {\n      el.className += \" \".concat(className);\n    }\n  }\n}\n\nfunction removeClassName(el\n/*: HTMLElement*/\n, className\n/*: string*/\n) {\n  if (el.classList) {\n    el.classList.remove(className);\n  } else {\n    el.className = el.className.replace(new RegExp(\"(?:^|\\\\s)\".concat(className, \"(?!\\\\S)\"), 'g'), '');\n  }\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.browserPrefixToKey = browserPrefixToKey;\nexports.browserPrefixToStyle = browserPrefixToStyle;\nexports.default = void 0;\nexports.getPrefix = getPrefix;\nvar prefixes = ['Moz', 'Webkit', 'O', 'ms'];\n\nfunction getPrefix()\n/*: string*/\n{\n  var _window$document, _window$document$docu;\n\n  var prop\n  /*: string*/\n  = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'transform';\n  // Ensure we're running in an environment where there is actually a global\n  // `window` obj\n  if (typeof window === 'undefined') return ''; // If we're in a pseudo-browser server-side environment, this access\n  // path may not exist, so bail out if it doesn't.\n\n  var style = (_window$document = window.document) === null || _window$document === void 0 ? void 0 : (_window$document$docu = _window$document.documentElement) === null || _window$document$docu === void 0 ? void 0 : _window$document$docu.style;\n  if (!style) return '';\n  if (prop in style) return '';\n\n  for (var i = 0; i < prefixes.length; i++) {\n    if (browserPrefixToKey(prop, prefixes[i]) in style) return prefixes[i];\n  }\n\n  return '';\n}\n\nfunction browserPrefixToKey(prop\n/*: string*/\n, prefix\n/*: string*/\n)\n/*: string*/\n{\n  return prefix ? \"\".concat(prefix).concat(kebabToTitleCase(prop)) : prop;\n}\n\nfunction browserPrefixToStyle(prop\n/*: string*/\n, prefix\n/*: string*/\n)\n/*: string*/\n{\n  return prefix ? \"-\".concat(prefix.toLowerCase(), \"-\").concat(prop) : prop;\n}\n\nfunction kebabToTitleCase(str\n/*: string*/\n)\n/*: string*/\n{\n  var out = '';\n  var shouldCapitalize = true;\n\n  for (var i = 0; i < str.length; i++) {\n    if (shouldCapitalize) {\n      out += str[i].toUpperCase();\n      shouldCapitalize = false;\n    } else if (str[i] === '-') {\n      shouldCapitalize = true;\n    } else {\n      out += str[i];\n    }\n  }\n\n  return out;\n} // Default export is the prefix itself, like 'Moz', 'Webkit', etc\n// Note that you may have to re-test for certain things; for instance, Chrome 50\n// can handle unprefixed `transform`, but not unprefixed `user-select`\n\n\nvar _default = (getPrefix()\n/*: string*/\n);\n\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = log;\n\n/*eslint no-console:0*/\nfunction log() {\n  var _console;\n\n  if (undefined) (_console = console).log.apply(_console, arguments);\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.canDragX = canDragX;\nexports.canDragY = canDragY;\nexports.createCoreData = createCoreData;\nexports.createDraggableData = createDraggableData;\nexports.getBoundPosition = getBoundPosition;\nexports.getControlPosition = getControlPosition;\nexports.snapToGrid = snapToGrid;\n\nvar _shims = require(\"./shims\");\n\nvar _domFns = require(\"./domFns\");\n\nfunction getBoundPosition(draggable\n/*: Draggable*/\n, x\n/*: number*/\n, y\n/*: number*/\n)\n/*: [number, number]*/\n{\n  // If no bounds, short-circuit and move on\n  if (!draggable.props.bounds) return [x, y]; // Clone new bounds\n\n  var bounds = draggable.props.bounds;\n  bounds = typeof bounds === 'string' ? bounds : cloneBounds(bounds);\n  var node = findDOMNode(draggable);\n\n  if (typeof bounds === 'string') {\n    var ownerDocument = node.ownerDocument;\n    var ownerWindow = ownerDocument.defaultView;\n    var boundNode;\n\n    if (bounds === 'parent') {\n      boundNode = node.parentNode;\n    } else {\n      boundNode = ownerDocument.querySelector(bounds);\n    }\n\n    if (!(boundNode instanceof ownerWindow.HTMLElement)) {\n      throw new Error('Bounds selector \"' + bounds + '\" could not find an element.');\n    }\n\n    var boundNodeEl\n    /*: HTMLElement*/\n    = boundNode; // for Flow, can't seem to refine correctly\n\n    var nodeStyle = ownerWindow.getComputedStyle(node);\n    var boundNodeStyle = ownerWindow.getComputedStyle(boundNodeEl); // Compute bounds. This is a pain with padding and offsets but this gets it exactly right.\n\n    bounds = {\n      left: -node.offsetLeft + (0, _shims.int)(boundNodeStyle.paddingLeft) + (0, _shims.int)(nodeStyle.marginLeft),\n      top: -node.offsetTop + (0, _shims.int)(boundNodeStyle.paddingTop) + (0, _shims.int)(nodeStyle.marginTop),\n      right: (0, _domFns.innerWidth)(boundNodeEl) - (0, _domFns.outerWidth)(node) - node.offsetLeft + (0, _shims.int)(boundNodeStyle.paddingRight) - (0, _shims.int)(nodeStyle.marginRight),\n      bottom: (0, _domFns.innerHeight)(boundNodeEl) - (0, _domFns.outerHeight)(node) - node.offsetTop + (0, _shims.int)(boundNodeStyle.paddingBottom) - (0, _shims.int)(nodeStyle.marginBottom)\n    };\n  } // Keep x and y below right and bottom limits...\n\n\n  if ((0, _shims.isNum)(bounds.right)) x = Math.min(x, bounds.right);\n  if ((0, _shims.isNum)(bounds.bottom)) y = Math.min(y, bounds.bottom); // But above left and top limits.\n\n  if ((0, _shims.isNum)(bounds.left)) x = Math.max(x, bounds.left);\n  if ((0, _shims.isNum)(bounds.top)) y = Math.max(y, bounds.top);\n  return [x, y];\n}\n\nfunction snapToGrid(grid\n/*: [number, number]*/\n, pendingX\n/*: number*/\n, pendingY\n/*: number*/\n)\n/*: [number, number]*/\n{\n  var x = Math.round(pendingX / grid[0]) * grid[0];\n  var y = Math.round(pendingY / grid[1]) * grid[1];\n  return [x, y];\n}\n\nfunction canDragX(draggable\n/*: Draggable*/\n)\n/*: boolean*/\n{\n  return draggable.props.axis === 'both' || draggable.props.axis === 'x';\n}\n\nfunction canDragY(draggable\n/*: Draggable*/\n)\n/*: boolean*/\n{\n  return draggable.props.axis === 'both' || draggable.props.axis === 'y';\n} // Get {x, y} positions from event.\n\n\nfunction getControlPosition(e\n/*: MouseTouchEvent*/\n, touchIdentifier\n/*: ?number*/\n, draggableCore\n/*: DraggableCore*/\n)\n/*: ?ControlPosition*/\n{\n  var touchObj = typeof touchIdentifier === 'number' ? (0, _domFns.getTouch)(e, touchIdentifier) : null;\n  if (typeof touchIdentifier === 'number' && !touchObj) return null; // not the right touch\n\n  var node = findDOMNode(draggableCore); // User can provide an offsetParent if desired.\n\n  var offsetParent = draggableCore.props.offsetParent || node.offsetParent || node.ownerDocument.body;\n  return (0, _domFns.offsetXYFromParent)(touchObj || e, offsetParent, draggableCore.props.scale);\n} // Create an data object exposed by <DraggableCore>'s events\n\n\nfunction createCoreData(draggable\n/*: DraggableCore*/\n, x\n/*: number*/\n, y\n/*: number*/\n)\n/*: DraggableData*/\n{\n  var state = draggable.state;\n  var isStart = !(0, _shims.isNum)(state.lastX);\n  var node = findDOMNode(draggable);\n\n  if (isStart) {\n    // If this is our first move, use the x and y as last coords.\n    return {\n      node: node,\n      deltaX: 0,\n      deltaY: 0,\n      lastX: x,\n      lastY: y,\n      x: x,\n      y: y\n    };\n  } else {\n    // Otherwise calculate proper values.\n    return {\n      node: node,\n      deltaX: x - state.lastX,\n      deltaY: y - state.lastY,\n      lastX: state.lastX,\n      lastY: state.lastY,\n      x: x,\n      y: y\n    };\n  }\n} // Create an data exposed by <Draggable>'s events\n\n\nfunction createDraggableData(draggable\n/*: Draggable*/\n, coreData\n/*: DraggableData*/\n)\n/*: DraggableData*/\n{\n  var scale = draggable.props.scale;\n  return {\n    node: coreData.node,\n    x: draggable.state.x + coreData.deltaX / scale,\n    y: draggable.state.y + coreData.deltaY / scale,\n    deltaX: coreData.deltaX / scale,\n    deltaY: coreData.deltaY / scale,\n    lastX: draggable.state.x,\n    lastY: draggable.state.y\n  };\n} // A lot faster than stringify/parse\n\n\nfunction cloneBounds(bounds\n/*: Bounds*/\n)\n/*: Bounds*/\n{\n  return {\n    left: bounds.left,\n    top: bounds.top,\n    right: bounds.right,\n    bottom: bounds.bottom\n  };\n}\n\nfunction findDOMNode(draggable\n/*: Draggable | DraggableCore*/\n)\n/*: HTMLElement*/\n{\n  var node = draggable.findDOMNode();\n\n  if (!node) {\n    throw new Error('<DraggableCore>: Unmounted during event!');\n  } // $FlowIgnore we can't assert on HTMLElement due to tests... FIXME\n\n\n  return node;\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.dontSetMe = dontSetMe;\nexports.findInArray = findInArray;\nexports.int = int;\nexports.isFunction = isFunction;\nexports.isNum = isNum;\n\n// @credits https://gist.github.com/rogozhnikoff/a43cfed27c41e4e68cdc\nfunction findInArray(array\n/*: Array<any> | TouchList*/\n, callback\n/*: Function*/\n)\n/*: any*/\n{\n  for (var i = 0, length = array.length; i < length; i++) {\n    if (callback.apply(callback, [array[i], i, array])) return array[i];\n  }\n}\n\nfunction isFunction(func\n/*: any*/\n)\n/*: boolean %checks*/\n{\n  // $FlowIgnore[method-unbinding]\n  return typeof func === 'function' || Object.prototype.toString.call(func) === '[object Function]';\n}\n\nfunction isNum(num\n/*: any*/\n)\n/*: boolean %checks*/\n{\n  return typeof num === 'number' && !isNaN(num);\n}\n\nfunction int(a\n/*: string*/\n)\n/*: number*/\n{\n  return parseInt(a, 10);\n}\n\nfunction dontSetMe(props\n/*: Object*/\n, propName\n/*: string*/\n, componentName\n/*: string*/\n)\n/*: ?Error*/\n{\n  if (props[propName]) {\n    return new Error(\"Invalid prop \".concat(propName, \" passed to \").concat(componentName, \" - do not set this, set it on the child.\"));\n  }\n}","import NoodlRuntime from '@noodl/runtime';\r\n\r\nimport type { NodeConstructor } from '../../../typings/global';\r\n\r\nexport type NavigateArgs = {\r\n  target: string;\r\n  params: Record<string, string | number | boolean>;\r\n  openInNewTab?: boolean;\r\n  hasNavigated: () => void;\r\n};\r\n\r\nexport type ComponentPageInfo = {\r\n  path: string;\r\n  title: string;\r\n  component: string;\r\n};\r\n\r\nexport class RouterHandler {\r\n  static instance = new RouterHandler();\r\n\r\n  _routers: Record<string, any>;\r\n  _navigationQueue: any[];\r\n\r\n  constructor() {\r\n    this._routers = {};\r\n    this._navigationQueue = [];\r\n  }\r\n\r\n  navigate(name: string, args: NavigateArgs) {\r\n    //add a 1ms timeout so other nodes have a chance to run before the page is destroyed.\r\n    setTimeout(() => {\r\n      const routerNames = Object.keys(this._routers);\r\n      if (routerNames.length === 1) {\r\n        name = routerNames[0];\r\n      }\r\n\r\n      if (this._routers[name]) {\r\n        for (const router of this._routers[name]) {\r\n          router.navigate(args);\r\n        }\r\n      } else {\r\n        this._navigationQueue.push({ name, args });\r\n      }\r\n    }, 1);\r\n  }\r\n\r\n  registerRouter(name: string, router: NodeConstructor) {\r\n    name = name || 'Main';\r\n    if (!this._routers[name]) {\r\n      this._routers[name] = [];\r\n    }\r\n\r\n    this._routers[name].push(router);\r\n\r\n    let hasNavigated = false;\r\n\r\n    let i = 0;\r\n    while (i < this._navigationQueue.length) {\r\n      const e = this._navigationQueue[i];\r\n      if (e.name === name) {\r\n        router.navigate(e.args);\r\n        hasNavigated = true;\r\n        this._navigationQueue.splice(i, 1);\r\n      } else {\r\n        i++;\r\n      }\r\n    }\r\n\r\n    if (!hasNavigated) {\r\n      router.reset(); //no navigation has happened, call reset() so the start page is created\r\n    }\r\n  }\r\n\r\n  deregisterRouter(name: string, router: NodeConstructor) {\r\n    name = name || 'Main';\r\n\r\n    if (!this._routers[name]) {\r\n      return;\r\n    }\r\n\r\n    const index = this._routers[name].indexOf(router);\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n\r\n    this._routers[name].splice(index, 1);\r\n    if (this._routers[name].length === 0) {\r\n      delete this._routers[name];\r\n    }\r\n  }\r\n\r\n  getPagesForRouter(name) {\r\n    const routerIndex = NoodlRuntime.instance.graphModel.routerIndex;\r\n    const routers = routerIndex.routers;\r\n\r\n    if (routers === undefined || routers.length === 0) return [];\r\n\r\n    const matchingRouters = name === undefined ? [routers[0]] : routers.filter((r) => r.name === name);\r\n\r\n    const pageComponents = new Set();\r\n    matchingRouters.forEach((r) => {\r\n      const pages = r.pages;\r\n      if (pages !== undefined && pages.routes !== undefined) {\r\n        pages.routes.forEach((r) => {\r\n          pageComponents.add(r);\r\n        });\r\n      }\r\n    });\r\n\r\n    return Array.from(pageComponents)\r\n      .map((c) => this.getPageInfoForComponent(String(c)))\r\n      .filter((item) => !!item);\r\n  }\r\n\r\n  getPageInfoForComponent(componentName: string): ComponentPageInfo | undefined {\r\n    const routerIndex = NoodlRuntime.instance.graphModel.routerIndex;\r\n    const page = routerIndex.pages.find((p) => p.component === componentName);\r\n    return page;\r\n  }\r\n\r\n  /**\r\n   * Occurs when the Router navigates to a new page.\r\n   *\r\n   * @param routerName\r\n   * @param page\r\n   */\r\n  onNavigated(routerName: string, page: ComponentPageInfo) {\r\n    // @ts-expect-error window.Noodl is not defined\r\n    window.Noodl.Events.emit('NoodlApp_Navigated', {\r\n      routerName,\r\n      ...page\r\n    });\r\n  }\r\n}\r\n","/* Web Font Loader v1.6.28 - (c) Adobe Systems, Google. License: Apache 2.0 */(function(){function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?aa:ba;return p.apply(null,arguments)}var q=Date.now||function(){return+new Date};function ca(a,b){this.a=a;this.o=b||a;this.c=this.o.document}var da=!!window.FontFace;function t(a,b,c,d){b=a.c.createElement(b);if(c)for(var e in c)c.hasOwnProperty(e)&&(\"style\"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));d&&b.appendChild(a.c.createTextNode(d));return b}function u(a,b,c){a=a.c.getElementsByTagName(b)[0];a||(a=document.documentElement);a.insertBefore(c,a.lastChild)}function v(a){a.parentNode&&a.parentNode.removeChild(a)}\nfunction w(a,b,c){b=b||[];c=c||[];for(var d=a.className.split(/\\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}b=[];for(e=0;e<d.length;e+=1){f=!1;for(g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(\" \").replace(/\\s+/g,\" \").replace(/^\\s+|\\s+$/,\"\")}function y(a,b){for(var c=a.className.split(/\\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}\nfunction ea(a){return a.o.location.hostname||a.a.location.hostname}function z(a,b,c){function d(){m&&e&&f&&(m(g),m=null)}b=t(a,\"link\",{rel:\"stylesheet\",href:b,media:\"all\"});var e=!1,f=!0,g=null,m=c||null;da?(b.onload=function(){e=!0;d()},b.onerror=function(){e=!0;g=Error(\"Stylesheet failed to load\");d()}):setTimeout(function(){e=!0;d()},0);u(a,\"head\",b)}\nfunction A(a,b,c,d){var e=a.c.getElementsByTagName(\"head\")[0];if(e){var f=t(a,\"script\",{src:b}),g=!1;f.onload=f.onreadystatechange=function(){g||this.readyState&&\"loaded\"!=this.readyState&&\"complete\"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,\"HEAD\"==f.parentNode.tagName&&e.removeChild(f))};e.appendChild(f);setTimeout(function(){g||(g=!0,c&&c(Error(\"Script load timeout\")))},d||5E3);return f}return null};function B(){this.a=0;this.c=null}function C(a){a.a++;return function(){a.a--;D(a)}}function E(a,b){a.c=b;D(a)}function D(a){0==a.a&&a.c&&(a.c(),a.c=null)};function F(a){this.a=a||\"-\"}F.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\\W_]+/g,\"\").toLowerCase());return b.join(this.a)};function G(a,b){this.c=a;this.f=4;this.a=\"n\";var c=(b||\"n4\").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function fa(a){return H(a)+\" \"+(a.f+\"00\")+\" 300px \"+I(a.c)}function I(a){var b=[];a=a.split(/,\\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['\"]/g,\"\");-1!=d.indexOf(\" \")||/^\\d/.test(d)?b.push(\"'\"+d+\"'\"):b.push(d)}return b.join(\",\")}function J(a){return a.a+a.f}function H(a){var b=\"normal\";\"o\"===a.a?b=\"oblique\":\"i\"===a.a&&(b=\"italic\");return b}\nfunction ga(a){var b=4,c=\"n\",d=null;a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10))));return c+b};function ha(a,b){this.c=a;this.f=a.o.document.documentElement;this.h=b;this.a=new F(\"-\");this.j=!1!==b.events;this.g=!1!==b.classes}function ia(a){a.g&&w(a.f,[a.a.c(\"wf\",\"loading\")]);K(a,\"loading\")}function L(a){if(a.g){var b=y(a.f,a.a.c(\"wf\",\"active\")),c=[],d=[a.a.c(\"wf\",\"loading\")];b||c.push(a.a.c(\"wf\",\"inactive\"));w(a.f,c,d)}K(a,\"inactive\")}function K(a,b,c){if(a.j&&a.h[b])if(c)a.h[b](c.c,J(c));else a.h[b]()};function ja(){this.c={}}function ka(a,b,c){var d=[],e;for(e in b)if(b.hasOwnProperty(e)){var f=a.c[e];f&&d.push(f(b[e],c))}return d};function M(a,b){this.c=a;this.f=b;this.a=t(this.c,\"span\",{\"aria-hidden\":\"true\"},this.f)}function N(a){u(a.c,\"body\",a.a)}function O(a){return\"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:\"+I(a.c)+\";\"+(\"font-style:\"+H(a)+\";font-weight:\"+(a.f+\"00\")+\";\")};function P(a,b,c,d,e,f){this.g=a;this.j=b;this.a=d;this.c=c;this.f=e||3E3;this.h=f||void 0}P.prototype.start=function(){var a=this.c.o.document,b=this,c=q(),d=new Promise(function(d,e){function f(){q()-c>=b.f?e():a.fonts.load(fa(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(f,25)},function(){e()})}f()}),e=null,f=new Promise(function(a,d){e=setTimeout(d,b.f)});Promise.race([f,d]).then(function(){e&&(clearTimeout(e),e=null);b.g(b.a)},function(){b.j(b.a)})};function Q(a,b,c,d,e,f,g){this.v=a;this.B=b;this.c=c;this.a=d;this.s=g||\"BESbswy\";this.f={};this.w=e||3E3;this.u=f||null;this.m=this.j=this.h=this.g=null;this.g=new M(this.c,this.s);this.h=new M(this.c,this.s);this.j=new M(this.c,this.s);this.m=new M(this.c,this.s);a=new G(this.a.c+\",serif\",J(this.a));a=O(a);this.g.a.style.cssText=a;a=new G(this.a.c+\",sans-serif\",J(this.a));a=O(a);this.h.a.style.cssText=a;a=new G(\"serif\",J(this.a));a=O(a);this.j.a.style.cssText=a;a=new G(\"sans-serif\",J(this.a));a=\nO(a);this.m.a.style.cssText=a;N(this.g);N(this.h);N(this.j);N(this.m)}var R={D:\"serif\",C:\"sans-serif\"},S=null;function T(){if(null===S){var a=/AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))/.exec(window.navigator.userAgent);S=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return S}Q.prototype.start=function(){this.f.serif=this.j.a.offsetWidth;this.f[\"sans-serif\"]=this.m.a.offsetWidth;this.A=q();U(this)};\nfunction la(a,b,c){for(var d in R)if(R.hasOwnProperty(d)&&b===a.f[R[d]]&&c===a.f[R[d]])return!0;return!1}function U(a){var b=a.g.a.offsetWidth,c=a.h.a.offsetWidth,d;(d=b===a.f.serif&&c===a.f[\"sans-serif\"])||(d=T()&&la(a,b,c));d?q()-a.A>=a.w?T()&&la(a,b,c)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?V(a,a.v):V(a,a.B):ma(a):V(a,a.v)}function ma(a){setTimeout(p(function(){U(this)},a),50)}function V(a,b){setTimeout(p(function(){v(this.g.a);v(this.h.a);v(this.j.a);v(this.m.a);b(this.a)},a),0)};function W(a,b,c){this.c=a;this.a=b;this.f=0;this.m=this.j=!1;this.s=c}var X=null;W.prototype.g=function(a){var b=this.a;b.g&&w(b.f,[b.a.c(\"wf\",a.c,J(a).toString(),\"active\")],[b.a.c(\"wf\",a.c,J(a).toString(),\"loading\"),b.a.c(\"wf\",a.c,J(a).toString(),\"inactive\")]);K(b,\"fontactive\",a);this.m=!0;na(this)};\nW.prototype.h=function(a){var b=this.a;if(b.g){var c=y(b.f,b.a.c(\"wf\",a.c,J(a).toString(),\"active\")),d=[],e=[b.a.c(\"wf\",a.c,J(a).toString(),\"loading\")];c||d.push(b.a.c(\"wf\",a.c,J(a).toString(),\"inactive\"));w(b.f,d,e)}K(b,\"fontinactive\",a);na(this)};function na(a){0==--a.f&&a.j&&(a.m?(a=a.a,a.g&&w(a.f,[a.a.c(\"wf\",\"active\")],[a.a.c(\"wf\",\"loading\"),a.a.c(\"wf\",\"inactive\")]),K(a,\"active\")):L(a.a))};function oa(a){this.j=a;this.a=new ja;this.h=0;this.f=this.g=!0}oa.prototype.load=function(a){this.c=new ca(this.j,a.context||this.j);this.g=!1!==a.events;this.f=!1!==a.classes;pa(this,new ha(this.c,a),a)};\nfunction qa(a,b,c,d,e){var f=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=e||null,m=d||null||{};if(0===c.length&&f)L(b.a);else{b.f+=c.length;f&&(b.j=f);var h,l=[];for(h=0;h<c.length;h++){var k=c[h],n=m[k.c],r=b.a,x=k;r.g&&w(r.f,[r.a.c(\"wf\",x.c,J(x).toString(),\"loading\")]);K(r,\"fontloading\",x);r=null;if(null===X)if(window.FontFace){var x=/Gecko.*Firefox\\/(\\d+)/.exec(window.navigator.userAgent),xa=/OS X.*Version\\/10\\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);\nX=x?42<parseInt(x[1],10):xa?!1:!0}else X=!1;X?r=new P(p(b.g,b),p(b.h,b),b.c,k,b.s,n):r=new Q(p(b.g,b),p(b.h,b),b.c,k,b.s,a,n);l.push(r)}for(h=0;h<l.length;h++)l[h].start()}},0)}function pa(a,b,c){var d=[],e=c.timeout;ia(b);var d=ka(a.a,c,a.c),f=new W(a.c,b,e);a.h=d.length;b=0;for(c=d.length;b<c;b++)d[b].load(function(b,d,c){qa(a,f,b,d,c)})};function ra(a,b){this.c=a;this.a=b}\nra.prototype.load=function(a){function b(){if(f[\"__mti_fntLst\"+d]){var c=f[\"__mti_fntLst\"+d](),e=[],h;if(c)for(var l=0;l<c.length;l++){var k=c[l].fontfamily;void 0!=c[l].fontStyle&&void 0!=c[l].fontWeight?(h=c[l].fontStyle+c[l].fontWeight,e.push(new G(k,h))):e.push(new G(k))}a(e)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.o;A(this.c,(c.a.api||\"https://fast.fonts.net/jsapi\")+\"/\"+d+\".js\"+(e?\"?v=\"+e:\"\"),function(e){e?a([]):(f[\"__MonotypeConfiguration__\"+\nd]=function(){return c.a},b())}).id=\"__MonotypeAPIScript__\"+d}else a([])};function sa(a,b){this.c=a;this.a=b}sa.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new B;b=0;for(c=d.length;b<c;b++)z(this.c,d[b],C(g));var m=[];b=0;for(c=e.length;b<c;b++)if(d=e[b].split(\":\"),d[1])for(var h=d[1].split(\",\"),l=0;l<h.length;l+=1)m.push(new G(d[0],h[l]));else m.push(new G(d[0]));E(g,function(){a(m,f)})};function ta(a,b){a?this.c=a:this.c=ua;this.a=[];this.f=[];this.g=b||\"\"}var ua=\"https://fonts.googleapis.com/css\";function va(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(\":\");3==e.length&&a.f.push(e.pop());var f=\"\";2==e.length&&\"\"!=e[1]&&(f=\":\");a.a.push(e.join(f))}}\nfunction wa(a){if(0==a.a.length)throw Error(\"No fonts to load!\");if(-1!=a.c.indexOf(\"kit=\"))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,\"+\"));b=a.c+\"?family=\"+c.join(\"%7C\");0<a.f.length&&(b+=\"&subset=\"+a.f.join(\",\"));0<a.g.length&&(b+=\"&text=\"+encodeURIComponent(a.g));return b};function ya(a){this.f=a;this.a=[];this.c={}}\nvar za={latin:\"BESbswy\",\"latin-ext\":\"\\u00e7\\u00f6\\u00fc\\u011f\\u015f\",cyrillic:\"\\u0439\\u044f\\u0416\",greek:\"\\u03b1\\u03b2\\u03a3\",khmer:\"\\u1780\\u1781\\u1782\",Hanuman:\"\\u1780\\u1781\\u1782\"},Aa={thin:\"1\",extralight:\"2\",\"extra-light\":\"2\",ultralight:\"2\",\"ultra-light\":\"2\",light:\"3\",regular:\"4\",book:\"4\",medium:\"5\",\"semi-bold\":\"6\",semibold:\"6\",\"demi-bold\":\"6\",demibold:\"6\",bold:\"7\",\"extra-bold\":\"8\",extrabold:\"8\",\"ultra-bold\":\"8\",ultrabold:\"8\",black:\"9\",heavy:\"9\",l:\"3\",r:\"4\",b:\"7\"},Ba={i:\"i\",italic:\"i\",n:\"n\",normal:\"n\"},\nCa=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;\nfunction Da(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(\":\"),e=d[0].replace(/\\+/g,\" \"),f=[\"n4\"];if(2<=d.length){var g;var m=d[1];g=[];if(m)for(var m=m.split(\",\"),h=m.length,l=0;l<h;l++){var k;k=m[l];if(k.match(/^[\\w-]+$/)){var n=Ca.exec(k.toLowerCase());if(null==n)k=\"\";else{k=n[2];k=null==k||\"\"==k?\"n\":Ba[k];n=n[1];if(null==n||\"\"==n)n=\"4\";else var r=Aa[n],n=r?r:isNaN(n)?\"4\":n.substr(0,1);k=[k,n].join(\"\")}}else k=\"\";k&&g.push(k)}0<g.length&&(f=g);3==d.length&&(d=d[2],g=[],d=d?d.split(\",\"):\ng,0<d.length&&(d=za[d[0]])&&(a.c[e]=d))}a.c[e]||(d=za[e])&&(a.c[e]=d);for(d=0;d<f.length;d+=1)a.a.push(new G(e,f[d]))}};function Ea(a,b){this.c=a;this.a=b}var Fa={Arimo:!0,Cousine:!0,Tinos:!0};Ea.prototype.load=function(a){var b=new B,c=this.c,d=new ta(this.a.api,this.a.text),e=this.a.families;va(d,e);var f=new ya(e);Da(f);z(c,wa(d),C(b));E(b,function(){a(f.a,f.c,Fa)})};function Ga(a,b){this.c=a;this.a=b}Ga.prototype.load=function(a){var b=this.a.id,c=this.c.o;b?A(this.c,(this.a.api||\"https://use.typekit.net\")+\"/\"+b+\".js\",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var e=[],f=0;f<b.length;f+=2)for(var g=b[f],m=b[f+1],h=0;h<m.length;h++)e.push(new G(g,m[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(l){}a(e)}},2E3):a([])};function Ha(a,b){this.c=a;this.f=b;this.a=[]}Ha.prototype.load=function(a){var b=this.f.id,c=this.c.o,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var g=0,m=c.fonts.length;g<m;++g){var h=c.fonts[g];d.a.push(new G(h.name,ga(\"font-weight:\"+h.weight+\";font-style:\"+h.style)))}a(d.a)},A(this.c,(this.f.api||\"https://f.fontdeck.com/s/css/js/\")+ea(this.c)+\"/\"+b+\".js\",function(b){b&&a([])})):a([])};var Y=new oa(window);Y.a.c.custom=function(a,b){return new sa(b,a)};Y.a.c.fontdeck=function(a,b){return new Ha(b,a)};Y.a.c.monotype=function(a,b){return new ra(b,a)};Y.a.c.typekit=function(a,b){return new Ga(b,a)};Y.a.c.google=function(a,b){return new Ea(b,a)};var Z={load:p(Y.load,Y)};\"function\"===typeof define&&define.amd?define(function(){return Z}):\"undefined\"!==typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig));}());\n","'use strict';\r\n\r\nconst NodeContext = require('./src/nodecontext');\r\nconst EditorConnection = require('./src/editorconnection');\r\nconst generateNodeLibrary = require('./src/nodelibraryexport');\r\nconst ProjectSettings = require('./src/projectsettings');\r\nconst GraphModel = require('./src/models/graphmodel');\r\nconst NodeDefinition = require('./src/nodedefinition');\r\nconst Node = require('./src/node');\r\nconst EditorModelEventsHandler = require('./src/editormodeleventshandler');\r\nconst Services = require('./src/services/services');\r\nconst EdgeTriggeredInput = require('./src/edgetriggeredinput');\r\n\r\nconst EventEmitter = require('./src/events');\r\nconst asyncPool = require('./src/async-pool');\r\n\r\nfunction registerNodes(noodlRuntime) {\r\n  [\r\n    require('./src/nodes/componentinputs'),\r\n    require('./src/nodes/componentoutputs'),\r\n\r\n    require('./src/nodes/std-library/runtasks'),\r\n\r\n    // Data\r\n    require('./src/nodes/std-library/data/restnode'),\r\n\r\n    // Custom code\r\n    require('./src/nodes/std-library/expression'),\r\n    require('./src/nodes/std-library/simplejavascript'),\r\n\r\n    // Records\r\n    require('./src/nodes/std-library/data/dbcollectionnode2'),\r\n    require('./src/nodes/std-library/data/dbmodelnode2'),\r\n    require('./src/nodes/std-library/data/setdbmodelpropertiesnode'),\r\n    require('./src/nodes/std-library/data/deletedbmodelpropertiesnode'),\r\n    require('./src/nodes/std-library/data/newdbmodelpropertiesnode'),\r\n    require('./src/nodes/std-library/data/dbmodelnode-addrelation'),\r\n    require('./src/nodes/std-library/data/dbmodelnode-removerelation'),\r\n    require('./src/nodes/std-library/data/filterdbmodelsnode'),\r\n\r\n    // Object\r\n    require('./src/nodes/std-library/data/modelnode2'),\r\n    require('./src/nodes/std-library/data/setmodelpropertiesnode'),\r\n    require('./src/nodes/std-library/data/newmodelnode'),\r\n\r\n    // Cloud\r\n    require('./src/nodes/std-library/data/cloudfilenode'),\r\n    require('./src/nodes/std-library/data/dbconfig'),\r\n\r\n    // Variables\r\n    require('./src/nodes/std-library/variables/number'),\r\n    require('./src/nodes/std-library/variables/string'),\r\n    require('./src/nodes/std-library/variables/boolean'),\r\n\r\n    // Utils\r\n    require('./src/nodes/std-library/condition'),\r\n    require('./src/nodes/std-library/and'),\r\n    require('./src/nodes/std-library/or'),\r\n    require('./src/nodes/std-library/booleantostring'),\r\n    require('./src/nodes/std-library/datetostring'),\r\n    require('./src/nodes/std-library/stringmapper'),\r\n    require('./src/nodes/std-library/inverter'),\r\n    require('./src/nodes/std-library/substring'),\r\n    require('./src/nodes/std-library/stringformat'),\r\n    require('./src/nodes/std-library/counter'),\r\n    require('./src/nodes/std-library/uniqueid'),\r\n\r\n    // User\r\n    require('./src/nodes/std-library/user/setuserproperties'),\r\n    require('./src/nodes/std-library/user/user')\r\n  ].forEach((node) => noodlRuntime.registerNode(node));\r\n}\r\n\r\nfunction NoodlRuntime(args) {\r\n  args = args || {};\r\n  args.platform = args.platform || {};\r\n  NoodlRuntime.instance = this;\r\n\r\n  this.type = args.type || 'browser';\r\n  this.noodlModules = [];\r\n  this.eventEmitter = new EventEmitter();\r\n  this.updateScheduled = false;\r\n  this.rootComponent = null;\r\n  this._currentLoadedData = null;\r\n  this.isWaitingForExport = true;\r\n  this.graphModel = new GraphModel();\r\n  this.errorHandlers = [];\r\n  this.frameNumber = 0;\r\n  this.dontCreateRootComponent = !!args.dontCreateRootComponent;\r\n  this.componentFilter = args.componentFilter;\r\n\r\n  this.runningInEditor = args.runDeployed ? false : true;\r\n\r\n  this.platform = {\r\n    requestUpdate: args.platform.requestUpdate,\r\n    getCurrentTime: args.platform.getCurrentTime,\r\n    webSocketOptions: args.platform.webSocketOptions,\r\n    objectToString: args.platform.objectToString\r\n  };\r\n\r\n  if (!args.platform.requestUpdate) {\r\n    throw new Error('platform.requestUpdate must be set');\r\n  }\r\n\r\n  if (!args.platform.getCurrentTime) {\r\n    throw new Error('platform.getCurrentTime must be set');\r\n  }\r\n\r\n  //Create an editor connection even if we're running deployed.\r\n  //If won't connect and act as a \"noop\" in deployed mode,\r\n  // and reduce the need for lots of if(editorConnection)\r\n  this.editorConnection = new EditorConnection({\r\n    platform: args.platform,\r\n    runtimeType: this.type\r\n  });\r\n\r\n  this.context = new NodeContext({\r\n    runningInEditor: args.runDeployed ? false : true,\r\n    editorConnection: this.editorConnection,\r\n    platform: this.platform,\r\n    graphModel: this.graphModel\r\n  });\r\n\r\n  this.context.eventEmitter.on('scheduleUpdate', this.scheduleUpdate.bind(this));\r\n\r\n  if (!args.runDeployed) {\r\n    this._setupEditorCommunication(args);\r\n  }\r\n\r\n  this.registerGraphModelListeners();\r\n\r\n  registerNodes(this);\r\n}\r\n\r\nNoodlRuntime.prototype.prefetchBundles = async function (bundleNames, numParallelFetches) {\r\n  await asyncPool(numParallelFetches, bundleNames, async (name) => {\r\n    await this.context.fetchComponentBundle(name);\r\n  });\r\n};\r\n\r\nNoodlRuntime.prototype._setupEditorCommunication = function (args) {\r\n  function objectEquals(x, y) {\r\n    if (x === null || x === undefined || y === null || y === undefined) {\r\n      return x === y;\r\n    }\r\n    if (x === y) {\r\n      return true;\r\n    }\r\n    if (Array.isArray(x) && x.length !== y.length) {\r\n      return false;\r\n    }\r\n\r\n    // if they are strictly equal, they both need to be object at least\r\n    if (!(x instanceof Object)) {\r\n      return false;\r\n    }\r\n    if (!(y instanceof Object)) {\r\n      return false;\r\n    }\r\n\r\n    // recursive object equality check\r\n    var p = Object.keys(x);\r\n    return (\r\n      Object.keys(y).every(function (i) {\r\n        return p.indexOf(i) !== -1;\r\n      }) &&\r\n      p.every(function (i) {\r\n        return objectEquals(x[i], y[i]);\r\n      })\r\n    );\r\n  }\r\n\r\n  this.editorConnection.on('exportDataFull', async (exportData) => {\r\n    if (this.graphModel.isEmpty() === false) {\r\n      this.reload();\r\n      return;\r\n    }\r\n\r\n    this.isWaitingForExport = false;\r\n    if (objectEquals(this._currentLoadedData, exportData) === false) {\r\n      if (this.componentFilter) {\r\n        exportData.components = exportData.components.filter((c) => this.componentFilter(c));\r\n      }\r\n\r\n      await this.setData(exportData);\r\n\r\n      //get the rest of the components\r\n      //important to get all the dynamic ports evaluated\r\n      if (exportData.componentIndex) {\r\n        const allBundles = Object.keys(exportData.componentIndex);\r\n        await this.prefetchBundles(allBundles, 2);\r\n      }\r\n\r\n      this.graphModel.emit('editorImportComplete');\r\n    }\r\n  });\r\n\r\n  this.editorConnection.on('reload', this.reload.bind(this));\r\n  this.editorConnection.on('modelUpdate', this.onModelUpdateReceived.bind(this));\r\n  this.editorConnection.on('metadataUpdate', this.onMetaDataUpdateReceived.bind(this));\r\n\r\n  this.editorConnection.on('connected', () => {\r\n    this.sendNodeLibrary();\r\n  });\r\n};\r\n\r\nNoodlRuntime.prototype.setDebugInspectorsEnabled = function (enabled) {\r\n  this.context.setDebugInspectorsEnabled(enabled);\r\n};\r\n\r\nNoodlRuntime.prototype.registerModule = function (module) {\r\n  if (module.nodes) {\r\n    for (let nodeDefinition of module.nodes) {\r\n      if (!nodeDefinition.node) nodeDefinition = { node: nodeDefinition };\r\n      nodeDefinition.node.module = module.name || 'Unknown Module';\r\n      this.registerNode(nodeDefinition);\r\n    }\r\n  }\r\n\r\n  this.noodlModules.push(module);\r\n};\r\n\r\nNoodlRuntime.prototype.registerGraphModelListeners = function () {\r\n  var self = this;\r\n\r\n  this.graphModel.on(\r\n    'componentAdded',\r\n    function (component) {\r\n      self.context.registerComponentModel(component);\r\n    },\r\n    this\r\n  );\r\n\r\n  this.graphModel.on(\r\n    'componentRemoved',\r\n    function (component) {\r\n      self.context.deregisterComponentModel(component);\r\n    },\r\n    this\r\n  );\r\n};\r\n\r\nNoodlRuntime.prototype.reload = function () {\r\n  location.reload();\r\n};\r\n\r\nNoodlRuntime.prototype.registerNode = function (nodeDefinition) {\r\n  if (nodeDefinition.node) {\r\n    const definedNode = NodeDefinition.defineNode(nodeDefinition.node);\r\n    this.context.nodeRegister.register(definedNode);\r\n\r\n    definedNode.setupNumberedInputDynamicPorts &&\r\n      definedNode.setupNumberedInputDynamicPorts(this.context, this.graphModel);\r\n  } else {\r\n    this.context.nodeRegister.register(nodeDefinition);\r\n  }\r\n\r\n  nodeDefinition.setup && nodeDefinition.setup(this.context, this.graphModel);\r\n};\r\n\r\nNoodlRuntime.prototype._setRootComponent = async function (rootComponentName) {\r\n  if (this.rootComponent && this.rootComponent.name === rootComponentName) return;\r\n\r\n  if (this.rootComponent) {\r\n    this.rootComponent.model && this.rootComponent.model.removeListenersWithRef(this);\r\n    this.rootComponent = undefined;\r\n  }\r\n\r\n  if (rootComponentName) {\r\n    this.rootComponent = await this.context.createComponentInstanceNode(rootComponentName, 'rootComponent');\r\n\r\n    this.rootComponent.componentModel.on('rootAdded', () => this.eventEmitter.emit('rootComponentUpdated'), this);\r\n    this.rootComponent.componentModel.on('rootRemoved', () => this.eventEmitter.emit('rootComponentUpdated'), this);\r\n\r\n    this.context.setRootComponent(this.rootComponent);\r\n  }\r\n\r\n  this.eventEmitter.emit('rootComponentUpdated');\r\n};\r\n\r\nNoodlRuntime.prototype.setData = async function (graphData) {\r\n  // Added for SSR Support\r\n  // In SSR, we re-load the graphData and when we render the componet it will\r\n  // invoke this method again, which will cause a duplicate node exception.\r\n  // To avoid this, we flag the runtime to not load again.\r\n  if (this._disableLoad) return;\r\n\r\n  this._currentLoadedData = graphData;\r\n  await this.graphModel.importEditorData(graphData);\r\n\r\n  // Run setup on all modules\r\n  for (const module of this.noodlModules) {\r\n    typeof module.setup === 'function' && module.setup.apply(module);\r\n  }\r\n\r\n  if (this.dontCreateRootComponent !== true) {\r\n    await this._setRootComponent(this.graphModel.rootComponent);\r\n\r\n    //listen to delta updates on the root component\r\n    this.graphModel.on('rootComponentNameUpdated', (name) => {\r\n      this._setRootComponent(name);\r\n    });\r\n\r\n    //check if the root component was deleted\r\n    this.graphModel.on('componentRemoved', (componentModel) => {\r\n      if (this.rootComponent && this.rootComponent.name === componentModel.name) {\r\n        this._setRootComponent(null);\r\n      }\r\n    });\r\n\r\n    //check if the root component was added when it previously didn't exist (e.g. when user deletes it and then hits undo)\r\n    this.graphModel.on('componentAdded', (componentModel) => {\r\n      setTimeout(() => {\r\n        if (!this.rootComponent && this.graphModel.rootComponent === componentModel.name) {\r\n          this._setRootComponent(componentModel.name);\r\n        }\r\n      }, 1);\r\n    });\r\n  }\r\n\r\n  this.scheduleUpdate();\r\n};\r\n\r\nNoodlRuntime.prototype.scheduleUpdate = function () {\r\n  if (this.updateScheduled) {\r\n    return;\r\n  }\r\n\r\n  this.updateScheduled = true;\r\n  this.platform.requestUpdate(NoodlRuntime.prototype._doUpdate.bind(this));\r\n};\r\n\r\nNoodlRuntime.prototype._doUpdate = function () {\r\n  this.updateScheduled = false;\r\n\r\n  this.context.currentFrameTime = this.platform.getCurrentTime();\r\n\r\n  this.context.eventEmitter.emit('frameStart');\r\n\r\n  this.context.update();\r\n\r\n  this.context.eventEmitter.emit('frameEnd');\r\n\r\n  this.frameNumber++;\r\n};\r\n\r\nNoodlRuntime.prototype.setProjectSettings = function (settings) {\r\n  this.projectSettings = settings;\r\n};\r\n\r\nNoodlRuntime.prototype.getNodeLibrary = function () {\r\n  var projectSettings = ProjectSettings.generateProjectSettings(this.graphModel.getSettings(), this.noodlModules);\r\n\r\n  if (this.projectSettings) {\r\n    this.projectSettings.ports && (projectSettings.ports = projectSettings.ports.concat(this.projectSettings.ports));\r\n    this.projectSettings.dynamicports &&\r\n      (projectSettings.dynamicports = projectSettings.ports.concat(this.projectSettings.dynamicports));\r\n  }\r\n\r\n  var nodeLibrary = generateNodeLibrary(this.context.nodeRegister);\r\n  nodeLibrary.projectsettings = projectSettings;\r\n  return JSON.stringify(nodeLibrary, null, 3);\r\n};\r\n\r\nNoodlRuntime.prototype.sendNodeLibrary = function () {\r\n  const nodeLibrary = this.getNodeLibrary();\r\n  if (this.lastSentNodeLibrary !== nodeLibrary) {\r\n    this.lastSentNodeLibrary = nodeLibrary;\r\n    this.editorConnection.sendNodeLibrary(nodeLibrary);\r\n  }\r\n};\r\n\r\nNoodlRuntime.prototype.connectToEditor = function (address) {\r\n  this.editorConnection.connect(address);\r\n};\r\n\r\nNoodlRuntime.prototype.onMetaDataUpdateReceived = function (event) {\r\n  if (!this.graphModel.isEmpty()) {\r\n    EditorMetaDataEventsHandler.handleEvent(this.context, this.graphModel, event);\r\n  }\r\n};\r\n\r\nNoodlRuntime.prototype.onModelUpdateReceived = async function (event) {\r\n  if (this.isWaitingForExport) {\r\n    return;\r\n  }\r\n\r\n  if (event.type === 'projectInstanceChanged') {\r\n    this.reload();\r\n  }\r\n  //wait for data to load before applying model changes\r\n  else if (this.graphModel.isEmpty() === false) {\r\n    await EditorModelEventsHandler.handleEvent(this.context, this.graphModel, event);\r\n  }\r\n};\r\n\r\nNoodlRuntime.prototype.addErrorHandler = function (callback) {\r\n  this.errorHandlers.push(callback);\r\n};\r\n\r\nNoodlRuntime.prototype.reportError = function (message) {\r\n  this.errorHandlers.forEach(function (eh) {\r\n    eh(message);\r\n  });\r\n};\r\n\r\nNoodlRuntime.prototype.getProjectSettings = function () {\r\n  return this.graphModel.getSettings();\r\n};\r\n\r\nNoodlRuntime.prototype.getMetaData = function (key) {\r\n  return this.graphModel.getMetaData(key);\r\n};\r\n\r\nNoodlRuntime.Services = Services;\r\nNoodlRuntime.Node = Node;\r\nNoodlRuntime.NodeDefinition = NodeDefinition;\r\nNoodlRuntime.EdgeTriggeredInput = EdgeTriggeredInput;\r\n\r\nmodule.exports = NoodlRuntime;\r\n","class CloudFile {\r\n  constructor({ name, url }) {\r\n    this.name = name;\r\n    this.url = url;\r\n  }\r\n\r\n  getUrl() {\r\n    return this.url;\r\n  }\r\n\r\n  getName() {\r\n    return this.name;\r\n  }\r\n\r\n  toString() {\r\n    return this.url;\r\n  }\r\n}\r\n\r\nmodule.exports = CloudFile;\r\n","const NoodlRuntime = require('../../noodl-runtime');\r\nconst Model = require('../model');\r\nconst Collection = require('../collection');\r\nconst CloudFile = require('./cloudfile');\r\nconst EventEmitter = require('../events');\r\n\r\nconst _protectedFields = {\r\n  _common: ['_createdAt', '_updatedAt', 'objectId'],\r\n  _User: ['_email_verify_token']\r\n};\r\n\r\nfunction _removeProtectedFields(data, className) {\r\n  const _data = Object.assign({}, data);\r\n  _protectedFields._common.forEach((f) => delete _data[f]);\r\n  if (className && _protectedFields[className]) _protectedFields[className].forEach((f) => delete _data[f]);\r\n\r\n  return _data;\r\n}\r\n\r\nclass CloudStore {\r\n  constructor(modelScope) {\r\n    this._initCloudServices();\r\n\r\n    this.events = new EventEmitter();\r\n    this.events.setMaxListeners(10000);\r\n    this.modelScope = modelScope;\r\n\r\n    this._fromJSON = (item, collectionName) => CloudStore._fromJSON(item, collectionName, modelScope);\r\n    this._deserializeJSON = (data, type) => CloudStore._deserializeJSON(data, type, modelScope);\r\n    this._serializeObject = (data, collectionName) => CloudStore._serializeObject(data, collectionName, modelScope);\r\n  }\r\n\r\n  _initCloudServices() {\r\n    _collections = undefined; // clear collection cache, so it's refetched\r\n\r\n    const cloudServices = NoodlRuntime.instance.getMetaData('cloudservices');\r\n    if (cloudServices) {\r\n      this.appId = cloudServices.appId;\r\n      this.endpoint = cloudServices.endpoint;\r\n    }\r\n\r\n    const dbVersionMajor = NoodlRuntime.instance.getMetaData('dbVersionMajor');\r\n    this.dbVersionMajor = dbVersionMajor;\r\n  }\r\n\r\n  on() {\r\n    this.events.on.apply(this.events, arguments);\r\n  }\r\n\r\n  off() {\r\n    this.events.off.apply(this.events, arguments);\r\n  }\r\n\r\n  _makeRequest(path, options) {\r\n    if (typeof _noodl_cloud_runtime_version === 'undefined') {\r\n      // Running in browser\r\n      var xhr = new XMLHttpRequest();\r\n\r\n      xhr.onreadystatechange = function () {\r\n        if (xhr.readyState === 4) {\r\n          var json;\r\n          try {\r\n            // In SSR, we dont have xhr.response\r\n            json = JSON.parse(xhr.response || xhr.responseText);\r\n          } catch (e) {}\r\n\r\n          if (xhr.status === 200 || xhr.status === 201) {\r\n            options.success(json);\r\n          } else options.error(json || { error: xhr.responseText, status: xhr.status });\r\n        }\r\n      };\r\n\r\n      xhr.open(options.method || 'GET', this.endpoint + path, true);\r\n\r\n      xhr.setRequestHeader('X-Parse-Application-Id', this.appId);\r\n      if (typeof _noodl_cloudservices !== 'undefined') {\r\n        xhr.setRequestHeader('X-Parse-Master-Key', _noodl_cloudservices.masterKey);\r\n      }\r\n\r\n      // Check for current users\r\n      var _cu = localStorage['Parse/' + this.appId + '/currentUser'];\r\n      if (_cu !== undefined) {\r\n        try {\r\n          const currentUser = JSON.parse(_cu);\r\n          xhr.setRequestHeader('X-Parse-Session-Token', currentUser.sessionToken);\r\n        } catch (e) {\r\n          // Failed to extract session token\r\n        }\r\n      }\r\n\r\n      if (options.onUploadProgress) {\r\n        xhr.upload.onprogress = (pe) => options.onUploadProgress(pe);\r\n      }\r\n\r\n      if (options.content instanceof File) {\r\n        xhr.send(options.content);\r\n      } else {\r\n        xhr.setRequestHeader('Content-Type', 'application/json');\r\n        xhr.send(JSON.stringify(options.content));\r\n      }\r\n    } else {\r\n      // Running in cloud runtime\r\n      const endpoint = typeof _noodl_cloudservices !== 'undefined' ? _noodl_cloudservices.endpoint : this.endpoint;\r\n      const appId = typeof _noodl_cloudservices !== 'undefined' ? _noodl_cloudservices.appId : this.appId;\r\n      const masterKey = typeof _noodl_cloudservices !== 'undefined' ? _noodl_cloudservices.masterKey : undefined;\r\n\r\n      fetch(endpoint + path, {\r\n        method: options.method || 'GET',\r\n        headers: {\r\n          'X-Parse-Application-Id': appId,\r\n          'X-Parse-Master-Key': masterKey,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(options.content)\r\n      })\r\n        .then((r) => {\r\n          if (r.status === 200 || r.status === 201) {\r\n            if (options.method === 'DELETE') {\r\n              options.success(undefined);\r\n            } else {\r\n              r.json()\r\n                .then((json) => options.success(json))\r\n                .catch((e) =>\r\n                  options.error({\r\n                    error: 'CloudStore: Failed to get json result.'\r\n                  })\r\n                );\r\n            }\r\n          } else {\r\n            if (options.method === 'DELETE') {\r\n              options.error({ error: 'Failed to delete.' });\r\n            } else {\r\n              r.json()\r\n                .then((json) => options.error(json))\r\n                .catch((e) => options.error({ error: 'Failed to fetch.' }));\r\n            }\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          options.error({ error: e.message });\r\n        });\r\n    }\r\n  }\r\n\r\n  query(options) {\r\n    this._makeRequest('/classes/' + options.collection, {\r\n      method: 'POST',\r\n      content: {\r\n        _method: 'GET',\r\n        where: options.where,\r\n        limit: options.limit,\r\n        skip: options.skip,\r\n        include: Array.isArray(options.include) ? options.include.join(',') : options.include,\r\n        keys: Array.isArray(options.select) ? options.select.join(',') : options.select,\r\n        order: Array.isArray(options.sort) ? options.sort.join(',') : options.sort,\r\n        count: options.count\r\n      },\r\n      success: function (response) {\r\n        options.success(response.results, response.count);\r\n      },\r\n      error: function () {\r\n        options.error();\r\n      }\r\n    });\r\n  }\r\n\r\n  aggregate(options) {\r\n    const args = [];\r\n\r\n    if (!options.group) {\r\n      options.error('You need to provide group option.');\r\n      return;\r\n    }\r\n\r\n    if (options.limit) args.push('limit=' + options.limit);\r\n    if (options.skip) args.push('skip=' + options.skip);\r\n\r\n    const grouping = {};\r\n\r\n    Object.keys(options.group).forEach((k) => {\r\n      const _g = {};\r\n      const group = options.group[k];\r\n      if (group['avg'] !== undefined) _g['$avg'] = '$' + group['avg'];\r\n      else if (group['sum'] !== undefined) _g['$sum'] = '$' + group['sum'];\r\n      else if (group['max'] !== undefined) _g['$max'] = '$' + group['max'];\r\n      else if (group['min'] !== undefined) _g['$min'] = '$' + group['min'];\r\n      else if (group['distinct'] !== undefined) _g['$addToSet'] = '$' + group['distinct'];\r\n\r\n      grouping[k] = _g;\r\n    });\r\n\r\n    // I don't know which version the API was changed, lets just say above 4 for now.\r\n    if (this.dbVersionMajor && this.dbVersionMajor > 4) {\r\n      grouping._id = null;\r\n\r\n      if (options.where) args.push('$match=' + encodeURIComponent(JSON.stringify(options.where)));\r\n\r\n      args.push('$group=' + JSON.stringify(grouping));\r\n    } else {\r\n      grouping.objectId = null;\r\n\r\n      if (options.where) args.push('match=' + encodeURIComponent(JSON.stringify(options.where)));\r\n\r\n      args.push('group=' + JSON.stringify(grouping));\r\n    }\r\n\r\n    this._makeRequest('/aggregate/' + options.collection + (args.length > 0 ? '?' + args.join('&') : ''), {\r\n      success: function (response) {\r\n        const res = {};\r\n\r\n        if (!response.results || response.results.length !== 1) {\r\n          options.success({}); // No result\r\n          return;\r\n        }\r\n\r\n        Object.keys(options.group).forEach((k) => {\r\n          res[k] = response.results[0][k];\r\n        });\r\n\r\n        options.success(res);\r\n      },\r\n      error: function () {\r\n        options.error();\r\n      }\r\n    });\r\n  }\r\n\r\n  count(options) {\r\n    const args = [];\r\n\r\n    if (options.where) args.push('where=' + encodeURIComponent(JSON.stringify(options.where)));\r\n    args.push('limit=0');\r\n    args.push('count=1');\r\n\r\n    this._makeRequest('/classes/' + options.collection + (args.length > 0 ? '?' + args.join('&') : ''), {\r\n      success: function (response) {\r\n        options.success(response.count);\r\n      },\r\n      error: function () {\r\n        options.error();\r\n      }\r\n    });\r\n  }\r\n\r\n  distinct(options) {\r\n    const args = [];\r\n\r\n    if (options.where) args.push('where=' + encodeURIComponent(JSON.stringify(options.where)));\r\n    args.push('distinct=' + options.property);\r\n\r\n    this._makeRequest('/aggregate/' + options.collection + (args.length > 0 ? '?' + args.join('&') : ''), {\r\n      success: function (response) {\r\n        options.success(response.results);\r\n      },\r\n      error: function () {\r\n        options.error();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {{\r\n   *    objectId: string;\r\n   *    collection: string;\r\n   *    keys?: string[] | string;\r\n   *    include?: string[] | string;\r\n   *    excludeKeys?: string[] | string;\r\n   *    success: (data: unknown) => void;\r\n   *    error: (error: unknown) => void;\r\n   * }} options\r\n   */\r\n  fetch(options) {\r\n    const args = [];\r\n\r\n    if (options.include) {\r\n      args.push('include=' + (Array.isArray(options.include) ? options.include.join(',') : options.include));\r\n    }\r\n\r\n    if (options.keys) {\r\n      args.push('keys=' + (Array.isArray(options.keys) ? options.keys.join(',') : options.keys));\r\n    }\r\n\r\n    if (options.excludeKeys) {\r\n      args.push(\r\n        'excludeKeys=' + (Array.isArray(options.excludeKeys) ? options.excludeKeys.join(',') : options.excludeKeys)\r\n      );\r\n    }\r\n\r\n    this._makeRequest(\r\n      '/classes/' + options.collection + '/' + options.objectId + (args.length > 0 ? '?' + args.join('&') : ''),\r\n      {\r\n        method: 'GET',\r\n        success: (response) => {\r\n          options.success(response);\r\n          this.events.emit('fetch', {\r\n            type: 'fetch',\r\n            objectId: options.objectId,\r\n            object: response,\r\n            collection: options.collection\r\n          });\r\n        },\r\n        error: function (res) {\r\n          options.error(res.error);\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  create(options) {\r\n    this._makeRequest('/classes/' + options.collection, {\r\n      method: 'POST',\r\n      content: Object.assign(\r\n        _removeProtectedFields(_serializeObject(options.data, options.collection), options.collection),\r\n        { ACL: options.acl }\r\n      ),\r\n      success: (response) => {\r\n        const _obj = Object.assign({}, options.data, response);\r\n        options.success(_obj);\r\n        this.events.emit('create', {\r\n          type: 'create',\r\n          objectId: options.objectId,\r\n          object: _obj,\r\n          collection: options.collection\r\n        });\r\n      },\r\n      error: function (res) {\r\n        options.error(res.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  increment(options) {\r\n    const data = {};\r\n\r\n    for (let key in options.properties) {\r\n      data[key] = { __op: 'Increment', amount: options.properties[key] };\r\n    }\r\n\r\n    this._makeRequest('/classes/' + options.collection + '/' + options.objectId, {\r\n      method: 'PUT',\r\n      content: data,\r\n      success: (response) => {\r\n        options.success(response);\r\n      },\r\n      error: function (res) {\r\n        options.error(res.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  save(options) {\r\n    const _data = Object.assign({}, options.data);\r\n    delete _data.createdAt;\r\n    delete _data.updatedAt;\r\n\r\n    this._makeRequest('/classes/' + options.collection + '/' + options.objectId, {\r\n      method: 'PUT',\r\n      content: Object.assign(_removeProtectedFields(_serializeObject(_data, options.collection), options.collection), {\r\n        ACL: options.acl\r\n      }),\r\n      success: (response) => {\r\n        options.success(response);\r\n        this.events.emit('save', {\r\n          type: 'save',\r\n          objectId: options.objectId,\r\n          object: Object.assign({}, options.data, response),\r\n          collection: options.collection\r\n        });\r\n      },\r\n      error: function (res) {\r\n        options.error(res.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  delete(options) {\r\n    this._makeRequest('/classes/' + options.collection + '/' + options.objectId, {\r\n      method: 'DELETE',\r\n      success: () => {\r\n        options.success();\r\n        this.events.emit('delete', {\r\n          type: 'delete',\r\n          objectId: options.objectId,\r\n          collection: options.collection\r\n        });\r\n      },\r\n      error: function (res) {\r\n        options.error(res.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  addRelation(options) {\r\n    const _content = {};\r\n    _content[options.key] = {\r\n      __op: 'AddRelation',\r\n      objects: [\r\n        {\r\n          __type: 'Pointer',\r\n          objectId: options.targetObjectId,\r\n          className: options.targetClass\r\n        }\r\n      ]\r\n    };\r\n    this._makeRequest('/classes/' + options.collection + '/' + options.objectId, {\r\n      method: 'PUT',\r\n      content: _content,\r\n      success: function (response) {\r\n        options.success(response);\r\n      },\r\n      error: function (res) {\r\n        options.error(res.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  removeRelation(options) {\r\n    const _content = {};\r\n    _content[options.key] = {\r\n      __op: 'RemoveRelation',\r\n      objects: [\r\n        {\r\n          __type: 'Pointer',\r\n          objectId: options.targetObjectId,\r\n          className: options.targetClass\r\n        }\r\n      ]\r\n    };\r\n    this._makeRequest('/classes/' + options.collection + '/' + options.objectId, {\r\n      method: 'PUT',\r\n      content: _content,\r\n      success: function (response) {\r\n        options.success(response);\r\n      },\r\n      error: function (res) {\r\n        options.error(res.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  uploadFile(options) {\r\n    this._makeRequest('/files/' + options.file.name, {\r\n      method: 'POST',\r\n      content: options.file,\r\n      contentType: options.file.type,\r\n      success: (response) => options.success(Object.assign({}, options.data, response)),\r\n      error: (err) => options.error(err),\r\n      onUploadProgress: options.onUploadProgress\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Users holding the master key are allowed to delete files\r\n   *\r\n   * @param {{\r\n   *    file: {\r\n   *      name: string;\r\n   *    }\r\n   *    success: (data: unknown) => void;\r\n   *    error: (error: unknown) => void;\r\n   * }} options\r\n   */\r\n  deleteFile(options) {\r\n    this._makeRequest('/files/' + options.file.name, {\r\n      method: 'DELETE',\r\n      success: (response) => options.success(Object.assign({}, options.data, response)),\r\n      error: (err) => options.error(err)\r\n    });\r\n  }\r\n}\r\n\r\nfunction _isArrayOfObjects(a) {\r\n  if (!Array.isArray(a)) return false;\r\n  for (var i = 0; i < a.length; i++) if (typeof a[i] !== 'object' || a[i] === null) return false;\r\n\r\n  return true;\r\n}\r\n\r\nfunction _toJSON(obj) {\r\n  if (obj instanceof Model) {\r\n    var res = {};\r\n    for (var key in obj.data) {\r\n      res[key] = _toJSON(obj.data[key]);\r\n    }\r\n    return res;\r\n  } else if (obj instanceof Collection) {\r\n    var res = [];\r\n    obj.items.forEach((m) => {\r\n      res.push(_toJSON(m));\r\n    });\r\n    return res;\r\n  }\r\n  return obj;\r\n}\r\n\r\nfunction _serializeObject(data, collectionName, modelScope) {\r\n  if (CloudStore._collections[collectionName]) var schema = CloudStore._collections[collectionName].schema;\r\n\r\n  for (var key in data) {\r\n    var _type = schema && schema.properties && schema.properties[key] ? schema.properties[key].type : undefined;\r\n\r\n    if (data[key] === undefined || data[key] === null) {\r\n      // Keep null and undefined as is\r\n    } else if (_type === 'Pointer' && typeof data[key] === 'string') {\r\n      // This is a string pointer to an object\r\n      data[key] = {\r\n        __type: 'Pointer',\r\n        className: schema.properties[key].targetClass,\r\n        objectId: data[key]\r\n      };\r\n    } else if (_type === 'Pointer' && typeof data[key] === 'object' && (modelScope || Model).instanceOf(data[key])) {\r\n      // This is an embedded object that should be stored as pointer\r\n      data[key] = {\r\n        __type: 'Pointer',\r\n        className: schema.properties[key].targetClass,\r\n        objectId: data[key].getId()\r\n      };\r\n    } else if (_type === 'Date' && (typeof data[key] === 'string' || data[key] instanceof Date)) {\r\n      data[key] = {\r\n        __type: 'Date',\r\n        iso: data[key] instanceof Date ? data[key].toISOString() : data[key]\r\n      };\r\n    } else if (_type === 'File' && data[key] instanceof CloudFile) {\r\n      const cloudFile = data[key];\r\n      data[key] = {\r\n        __type: 'File',\r\n        url: cloudFile.getUrl(),\r\n        name: cloudFile.getName()\r\n      };\r\n    } else if (_type === 'Array' && typeof data[key] === 'string' && Collection.exists(data[key])) {\r\n      data[key] = _toJSON(Collection.get(data[key]));\r\n    } else if (_type === 'Object' && typeof data[key] === 'string' && (modelScope || Model).exists(data[key])) {\r\n      data[key] = _toJSON((modelScope || Model).get(data[key]));\r\n    } else if (_type === 'GeoPoint' && typeof data[key] === 'object') {\r\n      data[key] = {\r\n        __type: 'GeoPoint',\r\n        latitude: Number(data[key].latitude),\r\n        longitude: Number(data[key].longitude)\r\n      };\r\n    } else data[key] = _toJSON(data[key]);\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nfunction _deserializeJSON(data, type, modelScope) {\r\n  if (data === undefined) return;\r\n  if (data === null) return null;\r\n\r\n  if (type === 'Relation' && data.__type === 'Relation') {\r\n    return undefined; // Ignore relation fields\r\n  } else if (type === 'Pointer' && data.__type === 'Pointer') {\r\n    // This is a pointer type, resolve into id\r\n    return data.objectId;\r\n  } else if (type === 'Date' && data.__type === 'Date') {\r\n    return new Date(data.iso);\r\n  } else if (type === 'Date' && typeof data === 'string') {\r\n    return new Date(data);\r\n  } else if (type === 'File' && data.__type === 'File') {\r\n    return new CloudFile(data);\r\n  } else if (type === 'GeoPoint' && data.__type === 'GeoPoint') {\r\n    return {\r\n      latitude: data.latitude,\r\n      longitude: data.longitude\r\n    };\r\n  } else if (_isArrayOfObjects(data)) {\r\n    var a = [];\r\n    for (var i = 0; i < data.length; i++) {\r\n      a.push(_deserializeJSON(data[i], undefined, modelScope));\r\n    }\r\n    var c = Collection.get();\r\n    c.set(a);\r\n    return c;\r\n  } else if (Array.isArray(data)) return data;\r\n  // This is an array with mixed data, just return it\r\n  else if (data && data.__type === 'Object' && data.className !== undefined && data.objectId !== undefined) {\r\n    const _data = Object.assign({}, data);\r\n    delete _data.className;\r\n    delete _data.__type;\r\n    return _fromJSON(_data, data.className, modelScope);\r\n  } else if (typeof data === 'object' && data !== null) {\r\n    var m = (modelScope || Model).get();\r\n    for (var key in data) {\r\n      m.set(key, _deserializeJSON(data[key], undefined, modelScope));\r\n    }\r\n    return m;\r\n  } else return data;\r\n}\r\n\r\nfunction _fromJSON(item, collectionName, modelScope) {\r\n  const modelStore = modelScope || Model;\r\n\r\n  const model = modelStore.get(item.objectId);\r\n  model._class = collectionName;\r\n\r\n  let schema = undefined;\r\n  if (collectionName !== undefined && CloudStore._collections[collectionName] !== undefined) {\r\n    schema = CloudStore._collections[collectionName].schema;\r\n  }\r\n\r\n  for (const key in item) {\r\n    if (key === 'objectId' || key === 'ACL') {\r\n      continue;\r\n    }\r\n\r\n    const _type = schema && schema.properties && schema.properties[key] ? schema.properties[key].type : undefined;\r\n    model.set(key, _deserializeJSON(item[key], _type, modelScope));\r\n  }\r\n\r\n  return model;\r\n}\r\n\r\nCloudStore._fromJSON = _fromJSON;\r\nCloudStore._deserializeJSON = _deserializeJSON;\r\nCloudStore._serializeObject = _serializeObject;\r\n\r\nCloudStore.forScope = (modelScope) => {\r\n  if (modelScope === undefined) return CloudStore.instance;\r\n  if (modelScope._cloudStore) return modelScope._cloudStore;\r\n\r\n  modelScope._cloudStore = new CloudStore(modelScope);\r\n  return modelScope._cloudStore;\r\n};\r\n\r\nvar _instance;\r\nObject.defineProperty(CloudStore, 'instance', {\r\n  get: function () {\r\n    if (_instance === undefined) _instance = new CloudStore();\r\n    return _instance;\r\n  }\r\n});\r\n\r\nvar _collections;\r\nObject.defineProperty(CloudStore, '_collections', {\r\n  get: function () {\r\n    if (_collections === undefined) {\r\n      _collections = {};\r\n      const dbCollections = NoodlRuntime.instance.getMetaData('dbCollections') || [];\r\n      dbCollections.forEach((c) => {\r\n        _collections[c.name] = c;\r\n      });\r\n\r\n      const systemCollections = NoodlRuntime.instance.getMetaData('systemCollections') || [];\r\n      systemCollections.forEach((c) => {\r\n        _collections[c.name] = c;\r\n      });\r\n    }\r\n    return _collections;\r\n  }\r\n});\r\n\r\nCloudStore.invalidateCollections = () => {\r\n  _collections = undefined;\r\n};\r\n\r\nmodule.exports = CloudStore;\r\n","const NoodlRuntime = require('../../../noodl-runtime');\r\n\r\nclass ConfigService {\r\n  constructor() {\r\n    this.cacheDuration = 15 * 60 * 1000; // 15 min cache\r\n  }\r\n\r\n  _makeRequest(path, options) {\r\n    if (typeof _noodl_cloud_runtime_version === 'undefined') {\r\n      // Running in browser\r\n      var xhr = new XMLHttpRequest();\r\n\r\n      xhr.onreadystatechange = function () {\r\n        if (xhr.readyState === 4) {\r\n          var json;\r\n          try {\r\n            json = JSON.parse(xhr.response);\r\n          } catch (e) {}\r\n\r\n          if (xhr.status === 200 || xhr.status === 201) {\r\n            options.success(json);\r\n          } else options.error(json || { error: xhr.responseText, status: xhr.status });\r\n        }\r\n      };\r\n\r\n      const cloudServices = NoodlRuntime.instance.getMetaData('cloudservices');\r\n      const appId = cloudServices.appId;\r\n      const endpoint = cloudServices.endpoint;\r\n      xhr.open('GET', endpoint + path, true);\r\n\r\n      xhr.setRequestHeader('X-Parse-Application-Id', appId);\r\n\r\n      xhr.send();\r\n    } else {\r\n      // Running in cloud runtime\r\n      const endpoint = typeof _noodl_cloudservices !== 'undefined' ? _noodl_cloudservices.endpoint : this.endpoint;\r\n      const appId = typeof _noodl_cloudservices !== 'undefined' ? _noodl_cloudservices.appId : this.appId;\r\n      const masterKey = typeof _noodl_cloudservices !== 'undefined' ? _noodl_cloudservices.masterKey : undefined;\r\n\r\n      fetch(endpoint + path, {\r\n        method: 'GET',\r\n        headers: {\r\n          'X-Parse-Application-Id': appId,\r\n          'X-Parse-Master-Key': masterKey\r\n        }\r\n      })\r\n        .then((r) => {\r\n          if (r.status === 200 || r.status === 201) {\r\n            r.json()\r\n              .then((json) => options.success(json))\r\n              .catch((e) =>\r\n                options.error({\r\n                  error: 'Config: Failed to get json result.'\r\n                })\r\n              );\r\n          } else {\r\n            r.json()\r\n              .then((json) => options.error(json))\r\n              .catch((e) => options.error({ error: 'Failed to fetch.' }));\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          options.error({ error: e.message });\r\n        });\r\n    }\r\n  }\r\n\r\n  _getConfig() {\r\n    return new Promise((resolve, reject) => {\r\n      this._makeRequest('/config', {\r\n        success: (config) => {\r\n          resolve(config.params || {});\r\n        },\r\n        error: (err) => {\r\n          reject(err);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  async getConfig() {\r\n    if (this.configCachePending) return this.configCachePending;\r\n\r\n    if (!this.configCache) {\r\n      this.configCachePending = this._getConfig();\r\n\r\n      this.configCache = await this.configCachePending;\r\n      delete this.configCachePending;\r\n      this.ttl = Date.now() + this.cacheDuration;\r\n      return this.configCache;\r\n    } else {\r\n      // Update cache if ttl has passed\r\n      if (Date.now() > this.ttl) {\r\n        this._getConfig().then((config) => {\r\n          this.configCache = config;\r\n          this.ttl = Date.now() + this.cacheDuration;\r\n        });\r\n      }\r\n\r\n      // But return currently cached\r\n      return this.configCache;\r\n    }\r\n  }\r\n\r\n  clearCache() {\r\n    delete this.configCache;\r\n  }\r\n}\r\n\r\nConfigService.instance = new ConfigService();\r\n\r\nmodule.exports = ConfigService;\r\n","const CloudStore = require('./cloudstore');\r\nconst Model = require('../model');\r\n\r\nfunction convertVisualFilter(query, options) {\r\n  var inputs = options.queryParameters;\r\n\r\n  if (query.combinator !== undefined && query.rules !== undefined) {\r\n    if (query.rules.length === 0) return;\r\n    else if (query.rules.length === 1) return convertVisualFilter(query.rules[0], options);\r\n    else {\r\n      const _res = {};\r\n      const _op = '$' + query.combinator;\r\n      _res[_op] = [];\r\n      query.rules.forEach((r) => {\r\n        var cond = convertVisualFilter(r, options);\r\n        if (cond !== undefined) _res[_op].push(cond);\r\n      });\r\n\r\n      return _res;\r\n    }\r\n  } else if (query.operator === 'related to') {\r\n    var value = query.input !== undefined ? inputs[query.input] : undefined;\r\n    if (value === undefined) return;\r\n\r\n    return {\r\n      $relatedTo: {\r\n        object: {\r\n          __type: 'Pointer',\r\n          objectId: value,\r\n          className: query.relatedTo\r\n        },\r\n        key: query.relationProperty\r\n      }\r\n    };\r\n  } else {\r\n    const _res = {};\r\n    var cond;\r\n    var value = query.input !== undefined ? inputs[query.input] : query.value;\r\n\r\n    if (query.operator === 'exist') {\r\n      _res[query.property] = { $exists: true };\r\n      return _res;\r\n    } else if (query.operator === 'not exist') {\r\n      _res[query.property] = { $exists: false };\r\n      return _res;\r\n    }\r\n\r\n    if (value === undefined) return;\r\n\r\n    if (CloudStore._collections[options.collectionName])\r\n      var schema = CloudStore._collections[options.collectionName].schema;\r\n\r\n    var propertyType =\r\n      schema && schema.properties && schema.properties[query.property]\r\n        ? schema.properties[query.property].type\r\n        : undefined;\r\n\r\n    if (propertyType === 'Date') {\r\n      if (!(value instanceof Date)) value = new Date(value.toString());\r\n      value = { __type: 'Date', iso: value.toISOString() };\r\n    }\r\n\r\n    if (query.operator === 'greater than') cond = { $gt: value };\r\n    else if (query.operator === 'greater than or equal to') cond = { $gte: value };\r\n    else if (query.operator === 'less than') cond = { $lt: value };\r\n    else if (query.operator === 'less than or equal to') cond = { $lte: value };\r\n    else if (query.operator === 'equal to') cond = { $eq: value };\r\n    else if (query.operator === 'not equal to') cond = { $ne: value };\r\n    else if (query.operator === 'points to') {\r\n      var targetClass =\r\n        schema && schema.properties && schema.properties[query.property]\r\n          ? schema.properties[query.property].targetClass\r\n          : undefined;\r\n\r\n      cond = {\r\n        $eq: { __type: 'Pointer', objectId: value, className: targetClass }\r\n      };\r\n    } else if (query.operator === 'contain') {\r\n      cond = { $regex: value, $options: 'i' };\r\n    }\r\n\r\n    _res[query.property] = cond;\r\n\r\n    return _res;\r\n  }\r\n}\r\n\r\nfunction matchesQuery(model, query) {\r\n  var match = true;\r\n\r\n  if (query === undefined) return true;\r\n\r\n  if (query['$and'] !== undefined) {\r\n    query['$and'].forEach((q) => {\r\n      match &= matchesQuery(model, q);\r\n    });\r\n  } else if (query['$or'] !== undefined) {\r\n    match = false;\r\n    query['$or'].forEach((q) => {\r\n      match |= matchesQuery(model, q);\r\n    });\r\n  } else {\r\n    var keys = Object.keys(query);\r\n    keys.forEach((k) => {\r\n      if (k === 'objectId') {\r\n        if (query[k]['$eq'] !== undefined) match &= model.getId() === query[k]['$eq'];\r\n        else if (query[k]['$in'] !== undefined) match &= query[k]['$in'].indexOf(model.getId()) !== -1;\r\n      } else if (k === '$relatedTo') {\r\n        match = false; // cannot resolve relation queries locally\r\n      } else {\r\n        var value = model.get(k);\r\n        if (query[k]['$eq'] !== undefined && query[k]['$eq'].__type === 'Pointer')\r\n          match &= value === query[k]['$eq'].objectId;\r\n        else if (query[k]['$eq'] !== undefined) match &= value == query[k]['$eq'];\r\n        else if (query[k]['$ne'] !== undefined) match &= value != query[k]['$ne'];\r\n        else if (query[k]['$lt'] !== undefined) match &= value < query[k]['$lt'];\r\n        else if (query[k]['$lte'] !== undefined) match &= value <= query[k]['$lt'];\r\n        else if (query[k]['$gt'] !== undefined) match &= value > query[k]['$gt'];\r\n        else if (query[k]['$gte'] !== undefined) match &= value >= query[k]['$gte'];\r\n        else if (query[k]['$exists'] !== undefined) match &= value !== undefined;\r\n        else if (query[k]['$in'] !== undefined) match &= query[k]['$in'].indexOf(value) !== -1;\r\n        else if (query[k]['$nin'] !== undefined) match &= query[k]['$in'].indexOf(value) === -1;\r\n        else if (query[k]['$regex'] !== undefined)\r\n          match &= new RegExp(query[k]['$regex'], query[k]['$options']).test(value);\r\n      }\r\n    });\r\n  }\r\n  return match;\r\n}\r\n\r\nfunction compareObjects(sort, a, b) {\r\n  for (var i = 0; i < sort.length; i++) {\r\n    let _s = sort[i];\r\n    if (_s[0] === '-') {\r\n      // Descending\r\n      let prop = _s.substring(1);\r\n      if (a.get(prop) > b.get(prop)) return -1;\r\n      else if (a.get(prop) < b.get(prop)) return 1;\r\n    } else {\r\n      // Ascending\r\n      if (a.get(_s) > b.get(_s)) return 1;\r\n      else if (a.get(_s) < b.get(_s)) return -1;\r\n    }\r\n  }\r\n  return 0;\r\n}\r\n\r\nfunction convertVisualSorting(sorting) {\r\n  return sorting.map((s) => {\r\n    return (s.order === 'descending' ? '-' : '') + s.property;\r\n  });\r\n}\r\n\r\nfunction _value(v) {\r\n  if (v instanceof Date && typeof v.toISOString === 'function') {\r\n    return {\r\n      __type: 'Date',\r\n      iso: v.toISOString()\r\n    };\r\n  }\r\n  return v;\r\n}\r\n\r\n/**\r\n *\r\n * @param {Record<string, unknown>} filter\r\n * @param {{\r\n *   collectionName?: string;\r\n *   modelScope?: unknown;\r\n *   error: (error: string) => void;\r\n * }} options\r\n * @returns\r\n */\r\nfunction convertFilterOp(filter, options) {\r\n  const keys = Object.keys(filter);\r\n  if (keys.length === 0) return {};\r\n  if (keys.length !== 1) {\r\n    return options.error('Filter must only have one key found ' + keys.join(','));\r\n  }\r\n\r\n  const res = {};\r\n  const key = keys[0];\r\n  if (filter['and'] !== undefined && Array.isArray(filter['and'])) {\r\n    res['$and'] = filter['and'].map((f) => convertFilterOp(f, options));\r\n  } else if (filter['or'] !== undefined && Array.isArray(filter['or'])) {\r\n    res['$or'] = filter['or'].map((f) => convertFilterOp(f, options));\r\n  } else if (filter['idEqualTo'] !== undefined) {\r\n    res['objectId'] = { $eq: filter['idEqualTo'] };\r\n  } else if (filter['idContainedIn'] !== undefined) {\r\n    res['objectId'] = { $in: filter['idContainedIn'] };\r\n  } else if (filter['relatedTo'] !== undefined) {\r\n    const modelId = filter['relatedTo']['id'];\r\n    if (modelId === undefined) {\r\n      return options.error('Must provide id in relatedTo filter');\r\n    }\r\n\r\n    const relationKey = filter['relatedTo']['key'];\r\n    if (relationKey === undefined) {\r\n      return options.error('Must provide key in relatedTo filter');\r\n    }\r\n\r\n    const className = filter['relatedTo']['className'] || (options.modelScope || Model).get(modelId)?._class;\r\n    if (typeof className === 'undefined') {\r\n      // Either the pointer is loaded as an object or we allow passing in the className.\r\n      return options.error('Must preload the Pointer or include className');\r\n    }\r\n\r\n    res['$relatedTo'] = {\r\n      object: {\r\n        __type: 'Pointer',\r\n        objectId: modelId,\r\n        className\r\n      },\r\n      key: relationKey\r\n    };\r\n  } else if (typeof filter[key] === 'object') {\r\n    const opAndValue = filter[key];\r\n    if (opAndValue['equalTo'] !== undefined) res[key] = { $eq: _value(opAndValue['equalTo']) };\r\n    else if (opAndValue['notEqualTo'] !== undefined) res[key] = { $ne: _value(opAndValue['notEqualTo']) };\r\n    else if (opAndValue['lessThan'] !== undefined) res[key] = { $lt: _value(opAndValue['lessThan']) };\r\n    else if (opAndValue['greaterThan'] !== undefined) res[key] = { $gt: _value(opAndValue['greaterThan']) };\r\n    else if (opAndValue['lessThanOrEqualTo'] !== undefined)\r\n      res[key] = { $lte: _value(opAndValue['lessThanOrEqualTo']) };\r\n    else if (opAndValue['greaterThanOrEqualTo'] !== undefined)\r\n      res[key] = { $gte: _value(opAndValue['greaterThanOrEqualTo']) };\r\n    else if (opAndValue['exists'] !== undefined) res[key] = { $exists: opAndValue['exists'] };\r\n    else if (opAndValue['containedIn'] !== undefined) res[key] = { $in: opAndValue['containedIn'] };\r\n    else if (opAndValue['notContainedIn'] !== undefined) res[key] = { $nin: opAndValue['notContainedIn'] };\r\n    else if (opAndValue['pointsTo'] !== undefined) {\r\n      let schema = null;\r\n      if (CloudStore._collections[options.collectionName]) {\r\n        schema = CloudStore._collections[options.collectionName].schema;\r\n      }\r\n\r\n      const targetClass =\r\n        schema && schema.properties && schema.properties[key] ? schema.properties[key].targetClass : undefined;\r\n      const type = schema && schema.properties && schema.properties[key] ? schema.properties[key].type : undefined;\r\n\r\n      if (type === 'Relation') {\r\n        res[key] = {\r\n          __type: 'Pointer',\r\n          objectId: opAndValue['pointsTo'],\r\n          className: targetClass\r\n        };\r\n      } else {\r\n        if (Array.isArray(opAndValue['pointsTo'])) {\r\n          res[key] = {\r\n            $in: opAndValue['pointsTo'].map((v) => {\r\n              return { __type: 'Pointer', objectId: v, className: targetClass };\r\n            })\r\n          };\r\n        } else {\r\n          res[key] = {\r\n            $eq: {\r\n              __type: 'Pointer',\r\n              objectId: opAndValue['pointsTo'],\r\n              className: targetClass\r\n            }\r\n          };\r\n        }\r\n      }\r\n    } else if (opAndValue['matchesRegex'] !== undefined) {\r\n      res[key] = {\r\n        $regex: opAndValue['matchesRegex'],\r\n        $options: opAndValue['options']\r\n      };\r\n    } else if (opAndValue['text'] !== undefined && opAndValue['text']['search'] !== undefined) {\r\n      var _v = opAndValue['text']['search'];\r\n      if (typeof _v === 'string') res[key] = { $text: { $search: { $term: _v, $caseSensitive: false } } };\r\n      else\r\n        res[key] = {\r\n          $text: {\r\n            $search: {\r\n              $term: _v.term,\r\n              $language: _v.language,\r\n              $caseSensitive: _v.caseSensitive,\r\n              $diacriticSensitive: _v.diacriticSensitive\r\n            }\r\n          }\r\n        };\r\n      // Geo points\r\n    } else if (opAndValue['nearSphere'] !== undefined) {\r\n      var _v = opAndValue['nearSphere'];\r\n      res[key] = {\r\n        $nearSphere: {\r\n          __type: 'GeoPoint',\r\n          latitude: _v.latitude,\r\n          longitude: _v.longitude\r\n        },\r\n        $maxDistanceInMiles: _v.$maxDistanceInMiles,\r\n        $maxDistanceInKilometers: _v.maxDistanceInKilometers,\r\n        $maxDistanceInRadians: _v.maxDistanceInRadians\r\n      };\r\n    } else if (opAndValue['withinBox'] !== undefined) {\r\n      var _v = opAndValue['withinBox'];\r\n      res[key] = {\r\n        $within: {\r\n          $box: _v.map((gp) => ({\r\n            __type: 'GeoPoint',\r\n            latitude: gp.latitude,\r\n            longitude: gp.longitude\r\n          }))\r\n        }\r\n      };\r\n    } else if (opAndValue['withinPolygon'] !== undefined) {\r\n      var _v = opAndValue['withinPolygon'];\r\n      res[key] = {\r\n        $geoWithin: {\r\n          $polygon: _v.map((gp) => ({\r\n            __type: 'GeoPoint',\r\n            latitude: gp.latitude,\r\n            longitude: gp.longitude\r\n          }))\r\n        }\r\n      };\r\n    }\r\n  } else {\r\n    options.error('Unrecognized filter keys ' + keys.join(','));\r\n  }\r\n\r\n  return res;\r\n}\r\n\r\nmodule.exports = {\r\n  convertVisualFilter,\r\n  compareObjects,\r\n  matchesQuery,\r\n  convertVisualSorting,\r\n  convertFilterOp\r\n};\r\n","const CloudStore = require('./cloudstore');\r\nconst QueryUtils = require('./queryutils');\r\nconst Model = require('../model');\r\n\r\nfunction createRecordsAPI(modelScope) {\r\n  let _cloudstore;\r\n  const cloudstore = () => {\r\n    // We must create the cloud store just in time so all meta data is loaded\r\n    if (!_cloudstore) _cloudstore = new CloudStore(modelScope);\r\n    return _cloudstore;\r\n  };\r\n\r\n  return {\r\n    async query(className, query, options) {\r\n      if (typeof className === 'undefined') throw new Error(\"'className' is undefined\");\r\n      return new Promise((resolve, reject) => {\r\n        cloudstore().query({\r\n          collection: className,\r\n          where: QueryUtils.convertFilterOp(query || {}, {\r\n            collectionName: className,\r\n            error: (e) => reject(e),\r\n            modelScope\r\n          }),\r\n          limit: options ? options.limit : undefined,\r\n          sort: options ? options.sort : undefined,\r\n          skip: options ? options.skip : undefined,\r\n          include: options ? options.include : undefined,\r\n          select: options ? options.select : undefined,\r\n          count: options ? options.count : undefined,\r\n          success: (results, count) => {\r\n            const _results = results.map((r) => cloudstore()._fromJSON(r, className));\r\n            if (count !== undefined) resolve({ results: _results, count });\r\n            else resolve(_results);\r\n          },\r\n          error: (err) => {\r\n            reject(Error(err || 'Failed to query.'));\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    async count(className, query) {\r\n      if (typeof className === 'undefined') throw new Error(\"'className' is undefined\");\r\n      return new Promise((resolve, reject) => {\r\n        cloudstore().count({\r\n          collection: className,\r\n          where: query\r\n            ? QueryUtils.convertFilterOp(query || {}, {\r\n                collectionName: className,\r\n                error: (e) => reject(e),\r\n                modelScope\r\n              })\r\n            : undefined,\r\n          success: (count) => {\r\n            resolve(count);\r\n          },\r\n          error: (err) => {\r\n            reject(Error(err || 'Failed to query.'));\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    async distinct(className, property, query) {\r\n      if (typeof className === 'undefined') throw new Error(\"'className' is undefined\");\r\n      return new Promise((resolve, reject) => {\r\n        cloudstore().distinct({\r\n          collection: className,\r\n          property,\r\n          where: query\r\n            ? QueryUtils.convertFilterOp(query || {}, {\r\n                collectionName: className,\r\n                error: (e) => reject(e),\r\n                modelScope\r\n              })\r\n            : undefined,\r\n          success: (results) => {\r\n            resolve(results);\r\n          },\r\n          error: (err) => {\r\n            reject(Error(err || 'Failed to query.'));\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    async aggregate(className, group, query) {\r\n      if (typeof className === 'undefined') throw new Error(\"'className' is undefined\");\r\n      return new Promise((resolve, reject) => {\r\n        cloudstore().aggregate({\r\n          collection: className,\r\n          group,\r\n          where: query\r\n            ? QueryUtils.convertFilterOp(query || {}, {\r\n                collectionName: className,\r\n                error: (e) => reject(e),\r\n                modelScope\r\n              })\r\n            : undefined,\r\n          success: (results) => {\r\n            resolve(results);\r\n          },\r\n          error: (err) => {\r\n            reject(Error(err || 'Failed to aggregate.'));\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param {string | { getId(): string; }} objectOrId\r\n     * @param {{\r\n     *    className: string;\r\n     *    keys?: string[] | string;\r\n     *    include?: string[] | string;\r\n     *    excludeKeys?: string[] | string;\r\n     * }} options\r\n     * @returns {Promise<unknown>}\r\n     */\r\n    async fetch(objectOrId, options) {\r\n      if (typeof objectOrId === 'undefined') return Promise.reject(new Error(\"'objectOrId' is undefined.\"));\r\n      if (typeof objectOrId !== 'string') objectOrId = objectOrId.getId();\r\n      const className = (options ? options.className : undefined) || (modelScope || Model).get(objectOrId)._class;\r\n\r\n      return new Promise((resolve, reject) => {\r\n        if (!className) {\r\n          return reject('No class name specified');\r\n        }\r\n\r\n        cloudstore().fetch({\r\n          collection: className,\r\n          objectId: objectOrId,\r\n          keys: options?.keys,\r\n          include: options?.include,\r\n          excludeKeys: options?.excludeKeys,\r\n          success: function (response) {\r\n            const record = cloudstore()._fromJSON(response, className);\r\n            resolve(record);\r\n          },\r\n          error: function (err) {\r\n            reject(Error(err || 'Failed to fetch.'));\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    async increment(objectOrId, properties, options) {\r\n      if (typeof objectOrId === 'undefined') return Promise.reject(new Error(\"'objectOrId' is undefined.\"));\r\n      if (typeof objectOrId !== 'string') objectOrId = objectOrId.getId();\r\n      const className = (options ? options.className : undefined) || (modelScope || Model).get(objectOrId)._class;\r\n\r\n      return new Promise((resolve, reject) => {\r\n        if (!className) return reject('No class name specified');\r\n\r\n        cloudstore().increment({\r\n          collection: className,\r\n          objectId: objectOrId,\r\n          properties,\r\n          success: (response) => {\r\n            cloudstore()._fromJSON(Object.assign({ objectId: objectOrId }, response), className); // Update values\r\n\r\n            resolve();\r\n          },\r\n          error: (err) => {\r\n            reject(Error(err || 'Failed to increment.'));\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    async save(objectOrId, properties, options) {\r\n      if (typeof objectOrId === 'undefined') return Promise.reject(new Error(\"'objectOrId' is undefined.\"));\r\n      if (typeof objectOrId !== 'string') objectOrId = objectOrId.getId();\r\n      const className = (options ? options.className : undefined) || (modelScope || Model).get(objectOrId)._class;\r\n\r\n      const model = (modelScope || Model).get(objectOrId);\r\n      if (properties) {\r\n        Object.keys(properties).forEach((p) => {\r\n          model.set(p, properties[p]);\r\n        });\r\n      }\r\n\r\n      return new Promise((resolve, reject) => {\r\n        if (!className) return reject('No class name specified');\r\n\r\n        cloudstore().save({\r\n          collection: className,\r\n          objectId: objectOrId,\r\n          data: properties || model.data,\r\n          acl: options ? options.acl : undefined,\r\n          success: (response) => {\r\n            cloudstore()._fromJSON(Object.assign({ objectId: objectOrId }, response), className); // Assign updated at\r\n            resolve();\r\n          },\r\n          error: (err) => {\r\n            reject(Error(err || 'Failed to save.'));\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    async create(className, properties, options) {\r\n      if (typeof className === 'undefined') throw new Error(\"'className' is undefined\");\r\n      return new Promise((resolve, reject) => {\r\n        cloudstore().create({\r\n          collection: className,\r\n          data: properties,\r\n          acl: options ? options.acl : undefined,\r\n          success: (data) => {\r\n            // Successfully created\r\n            const m = cloudstore()._fromJSON(data, className);\r\n            resolve(m);\r\n          },\r\n          error: (err) => {\r\n            reject(Error(err || 'Failed to insert.'));\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    async delete(objectOrId, options) {\r\n      if (typeof objectOrId === 'undefined') return Promise.reject(new Error(\"'objectOrId' is undefined.\"));\r\n      if (typeof objectOrId !== 'string') objectOrId = objectOrId.getId();\r\n      const className = (options ? options.className : undefined) || (modelScope || Model).get(objectOrId)._class;\r\n\r\n      return new Promise((resolve, reject) => {\r\n        if (!className) return reject('No class name specified');\r\n\r\n        cloudstore().delete({\r\n          collection: className,\r\n          objectId: objectOrId,\r\n          success: () => {\r\n            (modelScope || Model).get(objectOrId).notify('delete');\r\n            resolve();\r\n          },\r\n          error: (err) => {\r\n            reject(Error(err || 'Failed to delete.'));\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    async addRelation(options) {\r\n      const recordId = options.recordId || options.record.getId();\r\n      const className = options.className || (modelScope || Model).get(recordId)._class;\r\n\r\n      const targetRecordId = options.targetRecordId || options.targetRecord.getId();\r\n      const targetClassName = options.targetClassName || (modelScope || Model).get(targetRecordId)._class;\r\n\r\n      return new Promise((resolve, reject) => {\r\n        if (!className) return reject('No class name specified');\r\n        if (!targetClassName) return reject('No target class name specified');\r\n\r\n        cloudstore().addRelation({\r\n          collection: className,\r\n          objectId: recordId,\r\n          key: options.key,\r\n          targetObjectId: targetRecordId,\r\n          targetClass: targetClassName,\r\n          success: (response) => {\r\n            resolve();\r\n          },\r\n          error: (err) => {\r\n            reject(Error(err || 'Failed to add relation.'));\r\n          }\r\n        });\r\n      });\r\n    },\r\n\r\n    async removeRelation(options) {\r\n      const recordId = options.recordId || options.record.getId();\r\n      const className = options.className || (modelScope || Model).get(recordId)._class;\r\n\r\n      const targetRecordId = options.targetRecordId || options.targetRecord.getId();\r\n      const targetClassName = options.targetClassName || (modelScope || Model).get(targetRecordId)._class;\r\n\r\n      return new Promise((resolve, reject) => {\r\n        if (!className) return reject('No class name specified');\r\n        if (!targetClassName) return reject('No target class name specified');\r\n\r\n        cloudstore().removeRelation({\r\n          collection: className,\r\n          objectId: recordId,\r\n          key: options.key,\r\n          targetObjectId: targetRecordId,\r\n          targetClass: targetClassName,\r\n          success: (response) => {\r\n            resolve();\r\n          },\r\n          error: (err) => {\r\n            reject(Error(err || 'Failed to add relation.'));\r\n          }\r\n        });\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\nmodule.exports = createRecordsAPI;\r\n","async function asyncPool(poolLimit, values, iteratorFn) {\r\n    const ret = [];\r\n    const executing = [];\r\n    for (const item of values) {\r\n      const p = Promise.resolve().then(() => iteratorFn(item, values));\r\n      ret.push(p);\r\n  \r\n      if (poolLimit <= values.length) {\r\n        const e = p.then(() => executing.splice(executing.indexOf(e), 1));\r\n        executing.push(e);\r\n        if (executing.length >= poolLimit) {\r\n          await Promise.race(executing);\r\n        }\r\n      }\r\n    }\r\n    \r\n    return Promise.all(ret);\r\n  }\r\n  \r\n  module.exports = asyncPool;","'use strict';\r\n\r\nvar Model = require('./model');\r\n\r\n// Get and set proxy\r\n/*const proxies = {}\r\nconst _collectionProxyHandler = {\r\n  get: function(target,prop,receiver) {\r\n    if(typeof target[prop] === 'function')\r\n      return target[prop].bind(target);\r\n    else if(prop === 'length')\r\n      return target.size()\r\n    else if(target.items[prop] !== undefined)\r\n      return target.get(prop)\r\n    else\r\n      return Reflect.get(target,prop,receiver)\r\n  },\r\n  set: function(obj,prop,value) {\r\n    if(prop === 'id') {\r\n      console.log(`Noodl.Object warning: id is readonly (Id is ${obj.id}, trying to set to ${value})`);\r\n      return true; //if a proxy doesn't return true an exception will be thrown\r\n    }\r\n    else\r\n      return Reflect.set(target,prop,receiver)\r\n  }\r\n}\r\n\r\nfunction Collection(id) {\r\n  this.id = id;\r\n  this.items = [];\r\n}\r\n\r\nvar collections = Collection._collections = {};\r\n\r\nCollection.create = function(items) {\r\n  const name = Model.guid();\r\n  collections[name] = new Collection(name);\r\n  if(items) {\r\n    collections[name].set(items);\r\n  }\r\n  return collections[name];\r\n}\r\n\r\nCollection.get = function(name) {\r\n  if(name === undefined) name = Model.guid();\r\n  if(!collections[name]) {\r\n    collections[name] = new Collection(name);\r\n    proxies[name] = new Proxy(collections[name],_collectionProxyHandler);\r\n  }\r\n  return proxies[name];\r\n}\r\n\r\nCollection.instanceOf = function(collection) {\r\n  return collection && (collection instanceof Collection || collection.target instanceof Collection);\r\n}\r\n\r\nCollection.exists = function(name) {\r\n  return collections[name] !== undefined;\r\n}\r\n\r\nCollection.prototype.getId = function() {\r\n  return this.id;\r\n}\r\n\r\nCollection.prototype.on = function(event,listener) {\r\n  if(!this.listeners) this.listeners = {};\r\n  if(!this.listeners[event]) this.listeners[event] = [];\r\n  this.listeners[event].push(listener);\r\n}\r\n\r\nCollection.prototype.off = function(event,listener) {\r\n  if(!this.listeners) return;\r\n  if(!this.listeners[event]) return;\r\n  var idx = this.listeners[event].indexOf(listener);\r\n  if(idx!==-1) this.listeners[event].splice(idx,1);\r\n}\r\n\r\nCollection.prototype.notify = async function(event,args) {\r\n  if(!this.listeners) return;\r\n  if(!this.listeners[event]) return;\r\n  \r\n  var l = this.listeners[event].slice(); //clone in case listeners array is modified in the callbacks\r\n  for(var i = 0; i < l.length; i++) {\r\n    await l[i](args);\r\n  }  \r\n}\r\n\r\nCollection.prototype.set = function(src) {\r\n  var length,i;\r\n  \r\n  if(src === this) return;\r\n  \r\n  function keyIndex(a) {\r\n    var keys = {};\r\n    var length = a.length;\r\n    for(var i = 0; i < length; i++) {   \r\n      var item = a[i];  \r\n      keys[item.getId()] = item;\r\n    }\r\n    return keys;\r\n  }\r\n  \r\n  // Src can be a collection, or an array\r\n  var src = Collection.instanceOf(src)?src.items:src;\r\n  var bItems = [];\r\n  length = src.length;\r\n  for(i = 0; i < length; i++) {\r\n    var item = src[i];\r\n    if(Model.instanceOf(item))\r\n      bItems.push(item);\r\n    else\r\n      bItems.push(Model.create(item));\r\n  }\r\n  \r\n  var aItems = this.items;  \r\n  var aKeys = keyIndex(aItems);\r\n  var bKeys = keyIndex(bItems);\r\n  \r\n  // First remove all items not in the new collection\r\n  length = aItems.length;\r\n  for(i = 0; i < length; i++) {\r\n    if(!bKeys.hasOwnProperty(aItems[i].getId())) {\r\n      // This item is not present in new collection, remove it\r\n      this.removeAtIndex(i);\r\n      i--;\r\n      length--;\r\n    }\r\n  }\r\n  \r\n  // Reorder items\r\n  for(i = 0; i < Math.min(aItems.length,bItems.length); i++) {\r\n    if(aItems[i] !== bItems[i]) {\r\n      if(aKeys.hasOwnProperty(bItems[i].getId())) { \r\n        // The bItem exist in the collection but is in the wrong place\r\n        this.remove(bItems[i]);\r\n      }\r\n\r\n      // This is a new item, add it at correct index\r\n      this.addAtIndex(bItems[i],i);\r\n    }  \r\n  }\r\n  \r\n  // Add remaining items\r\n  for(i = aItems.length; i < bItems.length; i++) {\r\n    this.add(bItems[i]);\r\n  }\r\n      \r\n}\r\n\r\nCollection.prototype.contains = function(item) {\r\n  return this.items.indexOf(item)!==-1;\r\n}\r\n\r\nCollection.prototype.add = async function(item) {\r\n  if(this.contains(item)) return; // Already contains item\r\n  \r\n  this.items.push(item);\r\n  await this.notify('add',{item:item,index:this.items.length-1});\r\n  await this.notify('change');\r\n  await item.notify('add',{collection:this});\r\n}\r\n\r\nCollection.prototype.addAtIndex = async function(item,index) {\r\n  if(this.contains(item)) return; // Already contains item\r\n\r\n  this.items.splice(index,0,item);\r\n  await this.notify('add',{item:item,index:index});\r\n  await this.notify('change');\r\n  await item.notify('add',{collection:this,index:index});\r\n}\r\n\r\nCollection.prototype.removeAtIndex = async function(idx) {\r\n  var item = this.items[idx];\r\n  this.items.splice(idx,1);\r\n  await this.notify('remove',{item:item,index:idx});\r\n  await this.notify('change');\r\n  await item.notify('remove',{collection:this});  \r\n}\r\n\r\nCollection.prototype.remove = function(item) {\r\n  var idx = this.items.indexOf(item);\r\n  if(idx !== -1) this.removeAtIndex(idx);\r\n}\r\n\r\nCollection.prototype.size = function() {\r\n  return this.items.length;\r\n}\r\n\r\nCollection.prototype.get = function(index) {\r\n  return this.items[index];\r\n}\r\n\r\nCollection.prototype.each = function(callback) {\r\n  for(var i = 0; i < this.items.length; i++) {\r\n    callback(this.items[i],i);\r\n  }\r\n}\r\n\r\nCollection.prototype.forEach = Collection.prototype.each;\r\n\r\nCollection.prototype.map = function(fn) {\r\n  return this.items.map(fn);\r\n}\r\n\r\nCollection.prototype.filter = function(fn) {\r\n  return this.items.filter(fn);\r\n}\r\n\r\nCollection.prototype.find = function(predicate, thisArg) {\r\n  return this.items.find(predicate, thisArg);\r\n}\r\n\r\nCollection.prototype.findIndex = function(predicate, thisArg) {\r\n  return this.items.findIndex(predicate, thisArg);\r\n}   \r\n\r\nCollection.prototype.toJSON = function() {\r\n  return this.map(function(m) {\r\n      return m.toJSON()\r\n  })\r\n}*/\r\n\r\n// ----\r\nObject.defineProperty(Array.prototype, 'items', {\r\n  enumerable: false,\r\n  get() {\r\n    return this;\r\n  },\r\n  set(data) {\r\n    this.set(data);\r\n  }\r\n});\r\nObject.defineProperty(Array.prototype, 'each', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: Array.prototype.forEach\r\n});\r\nObject.defineProperty(Array.prototype, 'size', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: function () {\r\n    return this.length;\r\n  }\r\n});\r\nObject.defineProperty(Array.prototype, 'get', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: function (index) {\r\n    return this[index];\r\n  }\r\n});\r\nObject.defineProperty(Array.prototype, 'getId', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: function () {\r\n    return this._id;\r\n  }\r\n});\r\nObject.defineProperty(Array.prototype, 'id', {\r\n  enumerable: false,\r\n  get() {\r\n    return this.getId();\r\n  }\r\n});\r\nObject.defineProperty(Array.prototype, 'set', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: function (src) {\r\n    var length, i;\r\n\r\n    if (src === this) return;\r\n\r\n    src = src || []; //handle if src is undefined\r\n\r\n    function keyIndex(a) {\r\n      var keys = {};\r\n      var length = a.length;\r\n      for (var i = 0; i < length; i++) {\r\n        var item = a[i];\r\n        keys[item.getId()] = item;\r\n      }\r\n      return keys;\r\n    }\r\n\r\n    // Src can be a collection, or an array\r\n    var bItems = [];\r\n    length = src.length;\r\n    for (i = 0; i < length; i++) {\r\n      var item = src[i];\r\n      if (Model.instanceOf(item)) bItems.push(item);\r\n      else bItems.push(Model.create(item));\r\n    }\r\n\r\n    var aItems = this.items;\r\n    var aKeys = keyIndex(aItems);\r\n    var bKeys = keyIndex(bItems);\r\n\r\n    // First remove all items not in the new collection\r\n    length = aItems.length;\r\n    for (i = 0; i < length; i++) {\r\n      if (!bKeys.hasOwnProperty(aItems[i].getId())) {\r\n        // This item is not present in new collection, remove it\r\n        this.removeAtIndex(i);\r\n        i--;\r\n        length--;\r\n      }\r\n    }\r\n\r\n    // Reorder items\r\n    for (i = 0; i < Math.min(aItems.length, bItems.length); i++) {\r\n      if (aItems[i] !== bItems[i]) {\r\n        if (aKeys.hasOwnProperty(bItems[i].getId())) {\r\n          // The bItem exist in the collection but is in the wrong place\r\n          this.remove(bItems[i]);\r\n        }\r\n\r\n        // This is a new item, add it at correct index\r\n        this.addAtIndex(bItems[i], i);\r\n      }\r\n    }\r\n\r\n    // Add remaining items\r\n    for (i = aItems.length; i < bItems.length; i++) {\r\n      this.add(bItems[i]);\r\n    }\r\n  }\r\n});\r\n\r\nObject.defineProperty(Array.prototype, 'notify', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: async function (event, args) {\r\n    if (!this._listeners) return;\r\n    if (!this._listeners[event]) return;\r\n\r\n    var l = this._listeners[event].slice(); //clone in case listeners array is modified in the callbacks\r\n    for (var i = 0; i < l.length; i++) {\r\n      await l[i](args);\r\n    }\r\n  }\r\n});\r\n\r\nObject.defineProperty(Array.prototype, 'contains', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: function (item) {\r\n    return this.indexOf(item) !== -1;\r\n  }\r\n});\r\n\r\nObject.defineProperty(Array.prototype, 'add', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: async function (item) {\r\n    if (this.contains(item)) return; // Already contains item\r\n\r\n    this.items.push(item);\r\n    await this.notify('add', { item: item, index: this.items.length - 1 });\r\n    await this.notify('change');\r\n    await item.notify('add', { collection: this });\r\n  }\r\n});\r\n\r\nObject.defineProperty(Array.prototype, 'remove', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: function (item) {\r\n    var idx = this.items.indexOf(item);\r\n    if (idx !== -1) this.removeAtIndex(idx);\r\n  }\r\n});\r\n\r\nObject.defineProperty(Array.prototype, 'addAtIndex', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: async function (item, index) {\r\n    if (this.contains(item)) return; // Already contains item\r\n\r\n    this.items.splice(index, 0, item);\r\n    await this.notify('add', { item: item, index: index });\r\n    await this.notify('change');\r\n    await item.notify('add', { collection: this, index: index });\r\n  }\r\n});\r\n\r\nObject.defineProperty(Array.prototype, 'removeAtIndex', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: async function (idx) {\r\n    var item = this.items[idx];\r\n    this.items.splice(idx, 1);\r\n    await this.notify('remove', { item: item, index: idx });\r\n    await this.notify('change');\r\n    await item.notify('remove', { collection: this });\r\n  }\r\n});\r\n\r\nObject.defineProperty(Array.prototype, 'on', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: function (event, listener) {\r\n    if (!this._listeners)\r\n      Object.defineProperty(this, '_listeners', {\r\n        enumerable: false,\r\n        writable: false,\r\n        value: {}\r\n      });\r\n    if (!this._listeners[event]) this._listeners[event] = [];\r\n    this._listeners[event].push(listener);\r\n  }\r\n});\r\n\r\nObject.defineProperty(Array.prototype, 'off', {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: function (event, listener) {\r\n    if (!this._listeners) return;\r\n    if (!this._listeners[event]) return;\r\n    var idx = this._listeners[event].indexOf(listener);\r\n    if (idx !== -1) this._listeners[event].splice(idx, 1);\r\n  }\r\n});\r\n\r\nclass Collection extends Array {}\r\n\r\nconst collections = (Collection._collections = {});\r\n\r\nCollection.create = function (items) {\r\n  const name = Model.guid();\r\n  collections[name] = new Collection();\r\n  Object.defineProperty(collections[name], '_id', {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: name\r\n  });\r\n  if (items) {\r\n    collections[name].set(items);\r\n  }\r\n  return collections[name];\r\n};\r\n\r\n/**\r\n * @param {string} name\r\n * @returns {Collection}\r\n */\r\nCollection.get = function (name) {\r\n  if (name === undefined) name = Model.guid();\r\n  if (!collections[name]) {\r\n    collections[name] = new Collection();\r\n    Object.defineProperty(collections[name], '_id', {\r\n      enumerable: false,\r\n      writable: false,\r\n      value: name\r\n    });\r\n  }\r\n\r\n  return collections[name];\r\n};\r\n\r\nCollection.instanceOf = function (collection) {\r\n  return collection instanceof Collection;\r\n};\r\n\r\nCollection.exists = function (name) {\r\n  return collections[name] !== undefined;\r\n};\r\n\r\nmodule.exports = Collection;\r\n","\"use strict\";\r\n\r\nfunction createSetter(args) {\r\n\r\n    var currentValue = false;\r\n\r\n    return function(value) {\r\n        value = value ? true : false;\r\n        //value changed from false to true\r\n        if(value && currentValue === false) {\r\n            args.valueChangedToTrue.call(this);\r\n        }\r\n        currentValue = value;\r\n    };\r\n}\r\n\r\nmodule.exports = {\r\n    createSetter: createSetter\r\n};","//used to optimize warnings so we're not sending unneccessary warnings.\r\n//Improves editor performance, especially in larger projects\r\n\r\nclass ActiveWarnings {\r\n  constructor() {\r\n    this.currentWarnings = new Map();\r\n  }\r\n\r\n  setWarning(nodeId, key, warning) {\r\n    //Check if we've already sent this warning\r\n    if (this.currentWarnings.has(nodeId)) {\r\n      //we have sent warnings to this node before, check if we've sent this particular one before\r\n      const warningKeys = this.currentWarnings.get(nodeId);\r\n      if (warningKeys[key] === warning) {\r\n        //we've already sent this warning, no need to send it again\r\n        return false;\r\n      }\r\n\r\n      //new warning, remember that we sent it\r\n      warningKeys[key] = warning;\r\n      return true;\r\n    } else {\r\n      //new warning, we havent sent any warnings to this node before\r\n      //Remember that we sent it\r\n      this.currentWarnings.set(nodeId, { [key]: warning });\r\n      return true;\r\n    }\r\n  }\r\n\r\n  clearWarning(nodeId, key) {\r\n    const warningKeys = this.currentWarnings.get(nodeId);\r\n\r\n    if (!warningKeys || !warningKeys[key]) {\r\n      //There are no warnings that we've sent on this node.\r\n      //Save some performance by not sending an uneccesary message to the editor\r\n      return false;\r\n    }\r\n\r\n    delete warningKeys[key];\r\n    if (Object.keys(warningKeys).length === 0) {\r\n      delete this.currentWarnings.delete(nodeId);\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  clearWarnings(nodeId) {\r\n    if (this.currentWarnings.has(nodeId) === false) {\r\n      //no warnings on this node, save some performance by not sending a message to the editor\r\n      return false;\r\n    }\r\n\r\n    //no warnings for this node anymore\r\n    this.currentWarnings.delete(nodeId);\r\n    return true;\r\n  }\r\n}\r\n\r\nmodule.exports = ActiveWarnings;\r\n","'use strict';\r\n\r\nvar EventSender = require('./eventsender'),\r\n  Services = require('./services/services'),\r\n  guid = require('./guid');\r\n\r\nconst ActiveWarnings = require('./editorconnection.activewarnings');\r\nfunction EditorConnection(opts) {\r\n  var _opts = opts || {};\r\n\r\n  EventSender.call(this);\r\n\r\n  this.runtimeType = _opts.runtimeType;\r\n  this.platform = _opts.platform;\r\n  this.ws =\r\n    (_opts.platform && _opts.platform.webSocketClass) || (typeof WebSocket !== 'undefined' ? WebSocket : undefined);\r\n  this.wsOptions = (_opts.platform && _opts.platform.webSocketOptions) || undefined;\r\n  this.reconnectOnClose = true;\r\n  this.enableDebugger = false;\r\n\r\n  this.lastSendTimestamp = 0;\r\n  this.sendQueue = [];\r\n  this.sendTimer = undefined;\r\n\r\n  //used to optimize warnings so we're not sending unneccessary warnings.\r\n  //Clan slow down the editor in large projects\r\n  this.activeWarnings = new ActiveWarnings();\r\n}\r\n\r\nEditorConnection.prototype = Object.create(EventSender.prototype);\r\nEditorConnection.prototype.constructor = EditorConnection;\r\n\r\nEditorConnection.prototype.isRunningLocally = function () {\r\n  var runningLocallyInBrowser =\r\n    (this.platform.isRunningLocally && this.platform.isRunningLocally()) ||\r\n    (typeof document !== 'undefined' &&\r\n      (document.location.hostname === 'localhost' || document.location.hostname === '127.0.0.1'));\r\n  return runningLocallyInBrowser;\r\n};\r\n\r\nEditorConnection.prototype.connect = function (address) {\r\n  this.socket = this.wsOptions ? new this.ws(address, this.wsOptions) : new this.ws(address);\r\n\r\n  var self = this;\r\n\r\n  this.socket.addEventListener('open', function () {\r\n    self.clientId = guid();\r\n    self.socket.send(\r\n      JSON.stringify({\r\n        cmd: 'register',\r\n        type: 'viewer',\r\n        clientId: self.clientId\r\n      })\r\n    );\r\n    self.emit('connected');\r\n  });\r\n\r\n  this.socket.addEventListener('close', function (event) {\r\n    if (self.reconnectOnClose) {\r\n      self.reconnect(address);\r\n    }\r\n    console.log('Editor connection closed', event.code, event.reason);\r\n    self.emit('connectionClosed');\r\n  });\r\n\r\n  this.socket.addEventListener('error', function (evt) {\r\n    console.log('Editor connection error, trying to reconnect');\r\n  });\r\n\r\n  this.socket.addEventListener('message', async (e) => {\r\n    // NOTE: When the data is too big it seems to change from string to a blob\r\n    const text = typeof e.data === 'string' ? e.data : await e.data.text();\r\n    const message = JSON.parse(text);\r\n\r\n    let content;\r\n\r\n    if (message.cmd === 'registered') {\r\n      //ignore\r\n    } else if (message.cmd === 'export') {\r\n      content = JSON.parse(message.content);\r\n      if (message.type === 'full' && message.target === this.clientId) {\r\n        self.emit('exportDataFull', content);\r\n      }\r\n    } else if (message.cmd === 'hoverStart') {\r\n      self.emit('hoverStart', message.content.id);\r\n    } else if (message.cmd === 'hoverEnd') {\r\n      self.emit('hoverEnd', message.content.id);\r\n    } else if (message.cmd === 'refresh') {\r\n      self.emit('reload');\r\n    } else if (message.cmd === 'debugInspectors') {\r\n      if (this.debugInspectorsEnabled) {\r\n        content = JSON.parse(message.content);\r\n        self.emit('debugInspectorsUpdated', content.inspectors);\r\n      }\r\n    } else if (message.cmd === 'debuggingEnabled') {\r\n      if (self.isRunningLocally()) {\r\n        content = JSON.parse(message.content);\r\n        self.emit('debuggingEnabledChanged', content.enabled);\r\n      }\r\n    } else if (message.cmd === 'getConnectionValue') {\r\n      if (self.isRunningLocally()) {\r\n        content = JSON.parse(message.content);\r\n        await self.emit('getConnectionValue', { clientId: content.clientId, connectionId: content.connectionId });\r\n      }\r\n    } else if (message.cmd === 'modelUpdate') {\r\n      await self.emit('modelUpdate', message.content);\r\n    } else if (message.cmd === 'publish') {\r\n      Services.pubsub.routeMessage(message); // Publish a message from the pubsub service\r\n    } else if (message.cmd === 'noodlModules') {\r\n      self.emit('noodlModules', JSON.parse(message.content));\r\n    } else if (message.cmd === 'mqttUpdate') {\r\n      self.emit('mqttUpdate', message.content);\r\n    } else if (message.cmd === 'activeComponentChanged') {\r\n      self.emit('activeComponentChanged', message.component);\r\n    } else {\r\n      console.log('Command not implemented', message);\r\n    }\r\n  });\r\n};\r\n\r\nEditorConnection.prototype.reconnect = function (address) {\r\n  var self = this;\r\n\r\n  setTimeout(function () {\r\n    self.connect(address);\r\n  }, 2000);\r\n};\r\n\r\nEditorConnection.prototype.isConnected = function () {\r\n  return this.socket !== undefined && this.socket.readyState === this.ws.OPEN;\r\n};\r\n\r\n//JSON replacer to make cyclic objects non-cyclic.\r\n//Using this example: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cyclic_object_value#examples\r\nconst getCircularReplacer = () => {\r\n  const seen = new WeakSet();\r\n  return (key, value) => {\r\n    if (typeof value === 'object' && value !== null) {\r\n      if (seen.has(value)) {\r\n        return '[Circular]';\r\n      }\r\n      seen.add(value);\r\n    }\r\n    return value;\r\n  };\r\n};\r\n\r\nEditorConnection.prototype.send = function (data) {\r\n  const now = this.platform.getCurrentTime();\r\n  const dt = now - this.lastSendTimestamp;\r\n\r\n  //Send objects as json and capture exceptions\r\n  const trySend = (msg) => {\r\n    try {\r\n      this.socket.send(JSON.stringify(msg));\r\n    } catch (e) {\r\n      if (e.message && e.message.startsWith('Converting circular')) {\r\n        //the object is circular, try to address it\r\n        try {\r\n          this.socket.send(JSON.stringify(msg, getCircularReplacer()));\r\n        } catch (e) {\r\n          //still failed, give up\r\n          console.log('failed to send message to editor', msg, e);\r\n        }\r\n      } else {\r\n        //message couldn't be serialized to json\r\n        console.log('failed to send message to editor', msg, e);\r\n      }\r\n    }\r\n  };\r\n\r\n  //batch messages so they're only sent at most every 200ms\r\n  //note that the first message will always be sent immediately, and the ones for 200ms after\r\n  //that one will be queued. So initial message response time is as low as possible (for hover etc)\r\n  if (dt < 200 || this.sendTimer || !this.isConnected()) {\r\n    this.sendQueue.push(data);\r\n    if (!this.sendTimer) {\r\n      this.sendTimer = setTimeout(() => {\r\n        if (this.isConnected() === false) {\r\n          return;\r\n        }\r\n\r\n        //send messages in chunks. If we send too many at once the editor UI can freeze for a while\r\n        //since it's handling these in the renderer process\r\n        const chunkSize = 50;\r\n        for (let i = 0; i < this.sendQueue.length; i += chunkSize) {\r\n          const chunk = this.sendQueue.slice(i, i + chunkSize);\r\n          trySend(chunk);\r\n        }\r\n\r\n        this.sendQueue = [];\r\n        this.sendTimer = undefined;\r\n        this.lastSendTimestamp = this.platform.getCurrentTime();\r\n      }, 100);\r\n    }\r\n  } else {\r\n    this.lastSendTimestamp = now;\r\n    trySend(data);\r\n  }\r\n};\r\n\r\nEditorConnection.prototype.sendInspectId = function (id) {\r\n  this.send({\r\n    cmd: 'select',\r\n    type: 'viewer',\r\n    content: JSON.stringify({ id: id })\r\n  });\r\n};\r\n\r\nEditorConnection.prototype.sendSelectComponent = function (componentName) {\r\n  this.send({\r\n    cmd: 'select',\r\n    type: 'viewer',\r\n    content: JSON.stringify({ componentName })\r\n  });\r\n};\r\n\r\nEditorConnection.prototype.sendPulsingConnections = function (connectionMap) {\r\n  var connectionsToPulse = [];\r\n  Object.keys(connectionMap).forEach(function (c) {\r\n    var connection = connectionMap[c];\r\n    connectionsToPulse = connectionsToPulse.concat(connection.connections);\r\n  });\r\n\r\n  this.send({\r\n    cmd: 'connectiondebugpulse',\r\n    type: 'viewer',\r\n    content: JSON.stringify({\r\n      connectionsToPulse: connectionsToPulse\r\n    })\r\n  });\r\n};\r\n\r\nEditorConnection.prototype.sendDebugInspectorValues = function (inspectors) {\r\n  this.send({\r\n    cmd: 'debuginspectorvalues',\r\n    type: 'viewer',\r\n    content: { inspectors }\r\n  });\r\n};\r\n\r\nEditorConnection.prototype.sendConnectionValue = function (connectionId, value) {\r\n  this.send({\r\n    cmd: 'connectionValue',\r\n    type: 'viewer',\r\n    content: { connectionId, value }\r\n  });\r\n};\r\n\r\nconst dynamicPortsHash = {};\r\n\r\nfunction _detectRename(before, after) {\r\n  if (!before || !after) return;\r\n\r\n  if (before.length !== after.length) return; // Must be of same length\r\n\r\n  var res = {};\r\n  for (var i = 0; i < before.length; i++) {\r\n    if (after.indexOf(before[i]) === -1) {\r\n      if (res.before) return; // Can only be one from before that is missing\r\n      res.before = before[i];\r\n    }\r\n\r\n    if (before.indexOf(after[i]) === -1) {\r\n      if (res.after) return; // Only one can be missing,otherwise we cannot match\r\n      res.after = after[i];\r\n    }\r\n  }\r\n\r\n  return res.before && res.after ? res : undefined;\r\n}\r\n\r\nEditorConnection.prototype.sendDynamicPorts = function (id, ports, options) {\r\n  var hash = JSON.stringify(ports);\r\n  if (dynamicPortsHash[id] === hash) {\r\n    // Make sure we don't resend the same port data\r\n    return;\r\n  }\r\n\r\n  if (dynamicPortsHash[id] && ports && options && options.detectRenamed) {\r\n    var detectRenamed = Array.isArray(options.detectRenamed) ? options.detectRenamed : [options.detectRenamed];\r\n\r\n    var renamed = [];\r\n    detectRenamed.forEach((d) => {\r\n      var before = JSON.parse(dynamicPortsHash[id]),\r\n        after = [].concat(ports);\r\n\r\n      // Filter ports with correct prefix and plug\r\n      if (d.prefix) {\r\n        before = before.filter((p) => p.name.startsWith(d.prefix));\r\n        after = after.filter((p) => p.name.startsWith(d.prefix));\r\n      }\r\n\r\n      if (d.plug) {\r\n        before = before.filter((p) => p.plug === d.plug);\r\n        after = after.filter((p) => p.plug === d.plug);\r\n      }\r\n\r\n      // Remove the prefix\r\n      after = after.map((p) => p.name.substring((d.prefix || '').length));\r\n      before = before.map((p) => p.name.substring((d.prefix || '').length));\r\n\r\n      // Find the one that is renamed (if any)\r\n      var res = _detectRename(before, after);\r\n      if (res) {\r\n        renamed.push({\r\n          plug: d.plug,\r\n          patterns: [(d.prefix || '') + '{{*}}'],\r\n          before: res.before,\r\n          after: res.after\r\n        });\r\n      }\r\n    });\r\n    if (renamed.length > 0) options.renamed = renamed;\r\n\r\n    delete options.detectRenamed;\r\n  }\r\n\r\n  dynamicPortsHash[id] = hash;\r\n\r\n  this.send({\r\n    cmd: 'instanceports',\r\n    type: 'viewer',\r\n    content: JSON.stringify({\r\n      nodeid: id,\r\n      ports: ports,\r\n      options: options\r\n    })\r\n  });\r\n};\r\n\r\nEditorConnection.prototype.sendWarning = function (componentName, nodeId, key, warning) {\r\n  const isNewWarning = this.activeWarnings.setWarning(nodeId, key, warning);\r\n\r\n  if (isNewWarning) {\r\n    this.send({\r\n      cmd: 'showwarning',\r\n      type: 'viewer',\r\n      content: JSON.stringify({\r\n        componentName: componentName,\r\n        nodeId: nodeId,\r\n        key: key,\r\n        warning: warning\r\n      })\r\n    });\r\n  }\r\n};\r\n\r\nEditorConnection.prototype.clearWarning = function (componentName, nodeId, key) {\r\n  const hasWarning = this.activeWarnings.clearWarning(nodeId, key);\r\n\r\n  if (hasWarning) {\r\n    this.send({\r\n      cmd: 'showwarning',\r\n      type: 'viewer',\r\n      content: JSON.stringify({\r\n        componentName: componentName,\r\n        nodeId: nodeId,\r\n        key: key,\r\n        warning: undefined\r\n      })\r\n    });\r\n  }\r\n};\r\n\r\nEditorConnection.prototype.clearWarnings = function (componentName, nodeId) {\r\n  const hasWarnings = this.activeWarnings.clearWarnings(nodeId);\r\n\r\n  if (hasWarnings) {\r\n    this.send({\r\n      cmd: 'clearwarnings',\r\n      type: 'viewer',\r\n      content: JSON.stringify({\r\n        componentName: componentName,\r\n        nodeId: nodeId\r\n      })\r\n    });\r\n  }\r\n};\r\n\r\nEditorConnection.prototype.sendPatches = function (patches) {\r\n  this.send({\r\n    cmd: 'patchproject',\r\n    type: 'viewer',\r\n    content: JSON.stringify(patches)\r\n  });\r\n};\r\n\r\nEditorConnection.prototype.requestFullExport = function () {\r\n  this.send({\r\n    cmd: 'register',\r\n    type: 'viewer'\r\n  });\r\n};\r\n\r\nEditorConnection.prototype.requestNoodlModules = function () {\r\n  this.send({\r\n    cmd: 'getNoodlModules',\r\n    type: 'viewer'\r\n  });\r\n};\r\n\r\nvar serviceRequests = {};\r\nEditorConnection.prototype.sendServiceRequest = function (request, callback) {\r\n  request.token = guid();\r\n  request.clientId = this.clientId;\r\n  serviceRequests[request.token] = callback;\r\n  this.send(request);\r\n};\r\n\r\nEditorConnection.prototype.close = function () {\r\n  this.reconnectOnClose = false;\r\n\r\n  if (this.isConnected() === false) {\r\n    return;\r\n  }\r\n\r\n  this.socket.close();\r\n};\r\n\r\nEditorConnection.prototype.sendNodeLibrary = function (nodelibrary) {\r\n  this.send({\r\n    cmd: 'nodelibrary',\r\n    type: 'viewer',\r\n    runtimeType: this.runtimeType,\r\n    content: nodelibrary,\r\n    clientId: this.clientId\r\n  });\r\n};\r\n\r\nEditorConnection.prototype.sendComponentMetadata = function (componentName, key, data) {\r\n  this.send({\r\n    cmd: 'componentMetadata',\r\n    type: 'viewer',\r\n    content: JSON.stringify({\r\n      componentName,\r\n      key,\r\n      data\r\n    })\r\n  });\r\n};\r\n\r\nEditorConnection.prototype.sendProjectMetadata = function (key, data) {\r\n  this.send({\r\n    cmd: 'projectMetadata',\r\n    type: 'viewer',\r\n    content: JSON.stringify({\r\n      key,\r\n      data\r\n    })\r\n  });\r\n};\r\n\r\nmodule.exports = EditorConnection;\r\n","\"use strict\";\r\n\r\nfunction difference(array1, array2) {\r\n    const valueSet = new Set(array2);\r\n    return array1.filter(e => !valueSet.has(e));\r\n}\r\n\r\nasync function handleEvent(context, graphModel, event) {\r\n\r\n    function applyPortDelta(nodeModel, newPorts) {\r\n        var inputPorts = {};\r\n        var outputPorts = {};\r\n\r\n        newPorts.forEach(function(port) {\r\n            //some ports are incorrectly named outputs instead of output, patch it here so\r\n            //the rest of the code doesn't need to care\r\n            if(port && port.plug === \"outputs\") {\r\n              port.plug = \"output\";\r\n            }\r\n\r\n            if(port.plug === 'input' || port.plug === 'input/output') {\r\n                inputPorts[port.name] = port;\r\n            }\r\n            if(port.plug === 'output' || port.plug === 'input/output') {\r\n                outputPorts[port.name] = port;\r\n            }\r\n        });\r\n\r\n        var existingInputs = Object.keys(nodeModel.getInputPorts());\r\n\r\n        var inputPortsToRemove = difference(existingInputs, Object.keys(inputPorts));\r\n        var inputPortsToAdd = difference(Object.keys(inputPorts), existingInputs);\r\n        \r\n        // Update port types if it has changed\r\n        nodeModel.updateInputPortTypes(inputPorts);\r\n\r\n        // Remove and add input ports\r\n        inputPortsToRemove.forEach(nodeModel.removeInputPortWithName.bind(nodeModel));\r\n        inputPortsToAdd.forEach(function(portName) {\r\n            nodeModel.addInputPort(inputPorts[portName]);\r\n            if(nodeModel.parameters && nodeModel.parameters.hasOwnProperty(portName)) {\r\n                setInputValueOnNodeInstancesWithModel(context.rootComponent.nodeScope, nodeModel, portName, nodeModel.parameters[portName]);\r\n            }\r\n        });\r\n\r\n        // Update port types if it has changed\r\n        nodeModel.updateOutputPortTypes(outputPorts);\r\n\r\n        // Remove and add output ports\r\n        var existingOutputs = Object.keys(nodeModel.getOutputPorts());\r\n\r\n        var outputPortsToRemove = difference(existingOutputs, Object.keys(outputPorts));\r\n        var outputPortsToAdd = difference(Object.keys(outputPorts), existingOutputs);\r\n\r\n        outputPortsToRemove.forEach(nodeModel.removeOutputPortWithName.bind(nodeModel));\r\n        outputPortsToAdd.forEach(function(portName) {\r\n            nodeModel.addOutputPort(outputPorts[portName]);\r\n        });\r\n    }\r\n\r\n    function setInputValueOnNodeInstancesWithModel(nodeScope, nodeModel, port, value) {\r\n        var nodes = nodeScope.getNodesWithIdRecursive(nodeModel.id);\r\n        nodes.forEach(function(node) {\r\n            node.queueInput(port, value);\r\n        });\r\n    }\r\n\r\n    var componentModel;\r\n    if(event.componentName) {\r\n        componentModel = graphModel.getComponentWithName(event.componentName);\r\n        if(!componentModel) {\r\n            //if we haven't received this component yet, just ignore the delta update\r\n            return;\r\n        }\r\n    }\r\n\r\n    //some ports are incorrectly named outputs instead of output, patch it here so\r\n    //the rest of the code doesn't need to care\r\n    if(event.port && event.port.plug === \"outputs\") {\r\n        event.port.plug = \"output\";\r\n    }\r\n\r\n    var eventHandlers = {\r\n        nodeAdded: function(event) {\r\n            componentModel.importEditorNodeData(event.model, event.parentId, event.childIndex);\r\n        },\r\n        nodeRemoved: async function(event) {\r\n            if(componentModel.hasNodeWithId(event.model.id)) {\r\n                await componentModel.removeNodeWithId(event.model.id);\r\n            }\r\n        },\r\n        connectionAdded: function(event) {\r\n            componentModel.addConnection(event.model);\r\n        },\r\n        connectionRemoved: function(event) {\r\n            componentModel.removeConnection(event.model);\r\n\r\n            //revert to default value or parameter if this was the last connection to that port\r\n            var targetNodeModel = componentModel.getNodeWithId(event.model.targetId);\r\n            if(componentModel.getConnectionsToPort(targetNodeModel.id, event.model.targetId).length === 0) {\r\n                var value = targetNodeModel.parameters[event.model.targetPort];\r\n                if(value === undefined) {\r\n                    value = context.getDefaultValueForInput(targetNodeModel.type, event.model.targetPort);\r\n                }\r\n\r\n                setInputValueOnNodeInstancesWithModel(context.rootComponent.nodeScope, targetNodeModel, event.model.targetPort, value);\r\n            }\r\n\r\n        },\r\n        parameterChanged: function(event) {\r\n\r\n            const nodeModel = componentModel.getNodeWithId(event.nodeId);\r\n            if(nodeModel === undefined) {\r\n                console.log(\"parameterChanged: Unknown node id\",event);\r\n                return;\r\n            }\r\n\r\n            //did we get a bunch of parameters at once?\r\n            if(event.parameters) {\r\n                //note: some props might be deleted, then they only exist in oldParameters\r\n                const allParams = new Set(Object.keys(event.parameters).concat(Object.keys(event.oldParameters)));\r\n                for(const param of allParams) {\r\n                    nodeModel.setParameter(param, event.parameters[param]);\r\n                }\r\n            }\r\n            \r\n            //did we get a single parameters?\r\n            if(event.parameterName) {\r\n                nodeModel.setParameter(event.parameterName, event.parameterValue, event.state);\r\n            }\r\n        },\r\n        nodeAttached: function(event) {\r\n            componentModel.setNodeParent(componentModel.getNodeWithId(event.nodeId), componentModel.getNodeWithId(event.parentId), event.childIndex);\r\n        },\r\n        nodeDetached: function(event) {\r\n            componentModel.setNodeParent(componentModel.getNodeWithId(event.nodeId), null);\r\n            componentModel.addRootId(event.nodeId);\r\n        },\r\n        componentAdded: function(event) {\r\n            graphModel.importComponentFromEditorData(event.model);\r\n        },\r\n        componentRemoved: async function(event) {\r\n            await graphModel.removeComponentWithName(event.componentName);\r\n        },\r\n        rootAdded: function(event) {\r\n            componentModel.addRootId(event.nodeId);\r\n        },\r\n        portAdded: function(event) {\r\n            var nodeModel = componentModel.getNodeWithId(event.nodeId);\r\n            if(event.port.plug === \"input\" || event.port.plug === \"input/output\") {\r\n                nodeModel.addInputPort(event.port);\r\n\r\n                //if node already has an old value for this port, set that value on all instances of the node\r\n                //example: expression a+b, a=1, b=2. User removes b and then adds it again, the value 2 should be restored since it's still in the model\r\n                if(nodeModel.parameters.hasOwnProperty(event.port)) {\r\n                    setInputValueOnNodeInstancesWithModel(context.rootComponent.nodeScope, nodeModel, event.port, nodeModel.parameters[event.port]);\r\n                }\r\n            }\r\n            if(event.port.plug === \"output\" || event.port.plug === \"input/output\") {\r\n                nodeModel.addOutputPort(event.port);\r\n            }\r\n        },\r\n        portRemoved: function(event) {\r\n            var nodeModel = componentModel.getNodeWithId(event.nodeId);\r\n            if(event.port.plug === \"input\" || event.port.plug === \"input/output\") {\r\n                nodeModel.removeInputPortWithName(event.port.name);\r\n            }\r\n            if(event.port.plug === \"output\" || event.port.plug === \"input/output\") {\r\n                nodeModel.removeOutputPortWithName(event.port.name);\r\n            }\r\n        },\r\n        nodePortRenamed: function(event) {\r\n            if(event.port.plug === \"input\" || event.port.plug === \"input/output\") {\r\n                componentModel.renameInputPortOnNodeWithId(event.nodeId, event.oldName, event.port.name);\r\n            }\r\n            if(event.port.plug === \"output\" || event.port.plug === \"input/output\") {\r\n                componentModel.renameOutputPortOnNodeWithId(event.nodeId, event.oldName, event.port.name);\r\n            }\r\n            var node = componentModel.getNodeWithId(event.nodeId);\r\n            if(node.type === \"Component Inputs\") {\r\n                componentModel.addInputPort(event.port);\r\n                graphModel.getNodesWithType(componentModel.name).forEach(function(componentInstance) {\r\n                    componentInstance.component.renameInputPortOnNodeWithId(componentInstance.id, event.oldName, event.port.name);\r\n                });\r\n                componentModel.removeInputPortWithName(event.oldName);\r\n            }\r\n            else if(node.type === \"Component Outputs\") {\r\n                componentModel.addOutputPort(event.port);\r\n                graphModel.getNodesWithType(componentModel.name).forEach(function(componentInstance) {\r\n                    componentInstance.component.renameOutputPortOnNodeWithId(componentInstance.id, event.oldName, event.port.name);\r\n                });\r\n                componentModel.removeOutputPortWithName(event.oldName);\r\n            }\r\n        },\r\n        componentPortsUpdated: function(event) {\r\n            applyPortDelta(componentModel, event.ports);\r\n        },\r\n        instancePortsChanged: function(event) {\r\n            if(!componentModel.hasNodeWithId(event.nodeId)) return;\r\n            var nodeModel = componentModel.getNodeWithId(event.nodeId);\r\n            applyPortDelta(nodeModel, event.ports);\r\n        },\r\n        componentRenamed: function(event) {\r\n            graphModel.renameComponent(event.oldName, event.newName);\r\n        },\r\n        settingsChanged: function(event) {\r\n            graphModel.setSettings(event.settings);\r\n        },\r\n        metadataChanged: function(event) {\r\n            graphModel.setMetaData(event.key,event.data);\r\n        },\r\n        componentMetadataChanged: function(event) {\r\n            const c = graphModel.getComponentWithName(event.componentName);\r\n            if(!c) return;\r\n            c.setMetadata(event.key, event.data);\r\n        },\r\n        variantParametersChanged: function(event) {\r\n            if(event.variant) {\r\n                //we got the whole variant\r\n                graphModel.updateVariant(event.variant);\r\n            }\r\n            else {\r\n                //we got a specific value to update\r\n                graphModel.updateVariantParameter(event.variantName, event.variantTypeName, event.parameterName, event.parameterValue, event.state);\r\n\r\n                //check if value has been deleted from the variant\r\n                if(event.parameterValue === undefined) {\r\n                    //all active nodes with this variant will have to revert back to the default value, if they don't have local overrides\r\n                    const variant = graphModel.getVariant(event.variantTypeName, event.variantName);\r\n                    const nodes = context.rootComponent.nodeScope.getAllNodesWithVariantRecursive(variant);\r\n                    nodes.forEach(node => {\r\n                        node.queueInput(event.parameterName, node.getParameter(event.parameterName));\r\n                    });\r\n                }\r\n            }\r\n        },\r\n        variantDeleted: function(event) {\r\n            graphModel.deleteVariant(event.variantTypeName, event.variantName);\r\n        },\r\n        variantChanged: function(event) {\r\n            const nodeModel = componentModel.getNodeWithId(event.nodeId);\r\n            const variant = graphModel.getVariant(nodeModel.type, event.variantName);\r\n\r\n            nodeModel.setVariant(variant);\r\n        },\r\n        variantRenamed: function(event) {\r\n            const variant = graphModel.getVariant(event.variantTypeName, event.oldVariantName);\r\n            if(variant) {\r\n                variant.name = variant.variantName;\r\n            }\r\n        },\r\n        defaultStateTransitionChanged: function(event) {\r\n            const nodeModel = componentModel.getNodeWithId(event.nodeId);\r\n            nodeModel.setDefaultStateTransition(event.curve, event.state);\r\n        },\r\n        stateTransitionsChanged: function(event) {\r\n            const nodeModel = componentModel.getNodeWithId(event.nodeId);\r\n            if(event.parameterName) {\r\n                nodeModel.setStateTransitionParamter(event.parameterName, event.curve, event.state);\r\n            }            \r\n        },\r\n        variantDefaultStateTransitionChanged: function(event) {\r\n            graphModel.updateVariantDefaultStateTransition(event.variantName, event.variantTypeName, event.curve, event.state);\r\n        },\r\n        variantStateTransitionsChanged: function(event) {\r\n            graphModel.updateVariantStateTransition(event);\r\n        },\r\n        routerIndexChanged: function(event) {\r\n            graphModel.routerIndex = event.data;\r\n        }\r\n    };\r\n\r\n    if(eventHandlers.hasOwnProperty(event.type)) {\r\n        await eventHandlers[event.type](event);\r\n        context.scheduleUpdate();\r\n    }\r\n    else {\r\n        console.log('Unknown event', event);\r\n    }\r\n}\r\n\r\nmodule.exports = {\r\n    handleEvent: handleEvent\r\n};\r\n","// Copyright Joyent, Inc. and other Node contributors.\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a\r\n// copy of this software and associated documentation files (the\r\n// \"Software\"), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to permit\r\n// persons to whom the Software is furnished to do so, subject to the\r\n// following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included\r\n// in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\r\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\r\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\r\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\r\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\r\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\n'use strict';\r\n\r\nvar R = typeof Reflect === 'object' ? Reflect : null\r\nvar ReflectApply = R && typeof R.apply === 'function'\r\n  ? R.apply\r\n  : function ReflectApply(target, receiver, args) {\r\n    return Function.prototype.apply.call(target, receiver, args);\r\n  }\r\n\r\nvar ReflectOwnKeys\r\nif (R && typeof R.ownKeys === 'function') {\r\n  ReflectOwnKeys = R.ownKeys\r\n} else if (Object.getOwnPropertySymbols) {\r\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\r\n    return Object.getOwnPropertyNames(target)\r\n      .concat(Object.getOwnPropertySymbols(target));\r\n  };\r\n} else {\r\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\r\n    return Object.getOwnPropertyNames(target);\r\n  };\r\n}\r\n\r\nfunction ProcessEmitWarning(warning) {\r\n  if (console && console.warn) console.warn(warning);\r\n}\r\n\r\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\r\n  return value !== value;\r\n}\r\n\r\nfunction EventEmitter() {\r\n  EventEmitter.init.call(this);\r\n}\r\nmodule.exports = EventEmitter;\r\nmodule.exports.once = once;\r\n\r\n// Backwards-compat with node 0.10.x\r\nEventEmitter.EventEmitter = EventEmitter;\r\n\r\nEventEmitter.prototype._events = undefined;\r\nEventEmitter.prototype._eventsCount = 0;\r\nEventEmitter.prototype._maxListeners = undefined;\r\n\r\n// By default EventEmitters will print a warning if more than 10 listeners are\r\n// added to it. This is a useful default which helps finding memory leaks.\r\nvar defaultMaxListeners = 10;\r\n\r\nfunction checkListener(listener) {\r\n  if (typeof listener !== 'function') {\r\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\r\n  }\r\n}\r\n\r\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\r\n  enumerable: true,\r\n  get: function() {\r\n    return defaultMaxListeners;\r\n  },\r\n  set: function(arg) {\r\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\r\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\r\n    }\r\n    defaultMaxListeners = arg;\r\n  }\r\n});\r\n\r\nEventEmitter.init = function() {\r\n\r\n  if (this._events === undefined ||\r\n      this._events === Object.getPrototypeOf(this)._events) {\r\n    this._events = Object.create(null);\r\n    this._eventsCount = 0;\r\n  }\r\n\r\n  this._maxListeners = this._maxListeners || undefined;\r\n};\r\n\r\n// Obviously not all Emitters should be limited to 10. This function allows\r\n// that to be increased. Set to zero for unlimited.\r\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\r\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\r\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\r\n  }\r\n  this._maxListeners = n;\r\n  return this;\r\n};\r\n\r\nfunction _getMaxListeners(that) {\r\n  if (that._maxListeners === undefined)\r\n    return EventEmitter.defaultMaxListeners;\r\n  return that._maxListeners;\r\n}\r\n\r\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\r\n  return _getMaxListeners(this);\r\n};\r\n\r\nEventEmitter.prototype.emit = function emit(type) {\r\n  var args = [];\r\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\r\n  var doError = (type === 'error');\r\n\r\n  var events = this._events;\r\n  if (events !== undefined)\r\n    doError = (doError && events.error === undefined);\r\n  else if (!doError)\r\n    return false;\r\n\r\n  // If there is no 'error' event listener then throw.\r\n  if (doError) {\r\n    var er;\r\n    if (args.length > 0)\r\n      er = args[0];\r\n    if (er instanceof Error) {\r\n      // Note: The comments on the `throw` lines are intentional, they show\r\n      // up in Node's output if this results in an unhandled exception.\r\n      throw er; // Unhandled 'error' event\r\n    }\r\n    // At least give some kind of context to the user\r\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\r\n    err.context = er;\r\n    throw err; // Unhandled 'error' event\r\n  }\r\n\r\n  var handler = events[type];\r\n\r\n  if (handler === undefined)\r\n    return false;\r\n\r\n  if (typeof handler === 'function') {\r\n    ReflectApply(handler, this, args);\r\n  } else {\r\n    var len = handler.length;\r\n    var listeners = arrayClone(handler, len);\r\n    for (var i = 0; i < len; ++i)\r\n      ReflectApply(listeners[i], this, args);\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\nfunction _addListener(target, type, listener, prepend) {\r\n  var m;\r\n  var events;\r\n  var existing;\r\n\r\n  checkListener(listener);\r\n\r\n  events = target._events;\r\n  if (events === undefined) {\r\n    events = target._events = Object.create(null);\r\n    target._eventsCount = 0;\r\n  } else {\r\n    // To avoid recursion in the case that type === \"newListener\"! Before\r\n    // adding it to the listeners, first emit \"newListener\".\r\n    if (events.newListener !== undefined) {\r\n      target.emit('newListener', type,\r\n                  listener.listener ? listener.listener : listener);\r\n\r\n      // Re-assign `events` because a newListener handler could have caused the\r\n      // this._events to be assigned to a new object\r\n      events = target._events;\r\n    }\r\n    existing = events[type];\r\n  }\r\n\r\n  if (existing === undefined) {\r\n    // Optimize the case of one listener. Don't need the extra array object.\r\n    existing = events[type] = listener;\r\n    ++target._eventsCount;\r\n  } else {\r\n    if (typeof existing === 'function') {\r\n      // Adding the second element, need to change to array.\r\n      existing = events[type] =\r\n        prepend ? [listener, existing] : [existing, listener];\r\n      // If we've already got an array, just append.\r\n    } else if (prepend) {\r\n      existing.unshift(listener);\r\n    } else {\r\n      existing.push(listener);\r\n    }\r\n\r\n    // Check for listener leak\r\n    m = _getMaxListeners(target);\r\n    if (m > 0 && existing.length > m && !existing.warned) {\r\n      existing.warned = true;\r\n      // No error code for this since it is a Warning\r\n      // eslint-disable-next-line no-restricted-syntax\r\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\r\n                          existing.length + ' ' + String(type) + ' listeners ' +\r\n                          'added. Use emitter.setMaxListeners() to ' +\r\n                          'increase limit');\r\n      w.name = 'MaxListenersExceededWarning';\r\n      w.emitter = target;\r\n      w.type = type;\r\n      w.count = existing.length;\r\n      ProcessEmitWarning(w);\r\n    }\r\n  }\r\n\r\n  return target;\r\n}\r\n\r\nEventEmitter.prototype.addListener = function addListener(type, listener) {\r\n  return _addListener(this, type, listener, false);\r\n};\r\n\r\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\r\n\r\nEventEmitter.prototype.prependListener =\r\n    function prependListener(type, listener) {\r\n      return _addListener(this, type, listener, true);\r\n    };\r\n\r\nfunction onceWrapper() {\r\n  if (!this.fired) {\r\n    this.target.removeListener(this.type, this.wrapFn);\r\n    this.fired = true;\r\n    if (arguments.length === 0)\r\n      return this.listener.call(this.target);\r\n    return this.listener.apply(this.target, arguments);\r\n  }\r\n}\r\n\r\nfunction _onceWrap(target, type, listener) {\r\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\r\n  var wrapped = onceWrapper.bind(state);\r\n  wrapped.listener = listener;\r\n  state.wrapFn = wrapped;\r\n  return wrapped;\r\n}\r\n\r\nEventEmitter.prototype.once = function once(type, listener) {\r\n  checkListener(listener);\r\n  this.on(type, _onceWrap(this, type, listener));\r\n  return this;\r\n};\r\n\r\nEventEmitter.prototype.prependOnceListener =\r\n    function prependOnceListener(type, listener) {\r\n      checkListener(listener);\r\n      this.prependListener(type, _onceWrap(this, type, listener));\r\n      return this;\r\n    };\r\n\r\n// Emits a 'removeListener' event if and only if the listener was removed.\r\nEventEmitter.prototype.removeListener =\r\n    function removeListener(type, listener) {\r\n      var list, events, position, i, originalListener;\r\n\r\n      checkListener(listener);\r\n\r\n      events = this._events;\r\n      if (events === undefined)\r\n        return this;\r\n\r\n      list = events[type];\r\n      if (list === undefined)\r\n        return this;\r\n\r\n      if (list === listener || list.listener === listener) {\r\n        if (--this._eventsCount === 0)\r\n          this._events = Object.create(null);\r\n        else {\r\n          delete events[type];\r\n          if (events.removeListener)\r\n            this.emit('removeListener', type, list.listener || listener);\r\n        }\r\n      } else if (typeof list !== 'function') {\r\n        position = -1;\r\n\r\n        for (i = list.length - 1; i >= 0; i--) {\r\n          if (list[i] === listener || list[i].listener === listener) {\r\n            originalListener = list[i].listener;\r\n            position = i;\r\n            break;\r\n          }\r\n        }\r\n\r\n        if (position < 0)\r\n          return this;\r\n\r\n        if (position === 0)\r\n          list.shift();\r\n        else {\r\n          spliceOne(list, position);\r\n        }\r\n\r\n        if (list.length === 1)\r\n          events[type] = list[0];\r\n\r\n        if (events.removeListener !== undefined)\r\n          this.emit('removeListener', type, originalListener || listener);\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\r\n\r\nEventEmitter.prototype.removeAllListeners =\r\n    function removeAllListeners(type) {\r\n      var listeners, events, i;\r\n\r\n      events = this._events;\r\n      if (events === undefined)\r\n        return this;\r\n\r\n      // not listening for removeListener, no need to emit\r\n      if (events.removeListener === undefined) {\r\n        if (arguments.length === 0) {\r\n          this._events = Object.create(null);\r\n          this._eventsCount = 0;\r\n        } else if (events[type] !== undefined) {\r\n          if (--this._eventsCount === 0)\r\n            this._events = Object.create(null);\r\n          else\r\n            delete events[type];\r\n        }\r\n        return this;\r\n      }\r\n\r\n      // emit removeListener for all listeners on all events\r\n      if (arguments.length === 0) {\r\n        var keys = Object.keys(events);\r\n        var key;\r\n        for (i = 0; i < keys.length; ++i) {\r\n          key = keys[i];\r\n          if (key === 'removeListener') continue;\r\n          this.removeAllListeners(key);\r\n        }\r\n        this.removeAllListeners('removeListener');\r\n        this._events = Object.create(null);\r\n        this._eventsCount = 0;\r\n        return this;\r\n      }\r\n\r\n      listeners = events[type];\r\n\r\n      if (typeof listeners === 'function') {\r\n        this.removeListener(type, listeners);\r\n      } else if (listeners !== undefined) {\r\n        // LIFO order\r\n        for (i = listeners.length - 1; i >= 0; i--) {\r\n          this.removeListener(type, listeners[i]);\r\n        }\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\nfunction _listeners(target, type, unwrap) {\r\n  var events = target._events;\r\n\r\n  if (events === undefined)\r\n    return [];\r\n\r\n  var evlistener = events[type];\r\n  if (evlistener === undefined)\r\n    return [];\r\n\r\n  if (typeof evlistener === 'function')\r\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\r\n\r\n  return unwrap ?\r\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\r\n}\r\n\r\nEventEmitter.prototype.listeners = function listeners(type) {\r\n  return _listeners(this, type, true);\r\n};\r\n\r\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\r\n  return _listeners(this, type, false);\r\n};\r\n\r\nEventEmitter.listenerCount = function(emitter, type) {\r\n  if (typeof emitter.listenerCount === 'function') {\r\n    return emitter.listenerCount(type);\r\n  } else {\r\n    return listenerCount.call(emitter, type);\r\n  }\r\n};\r\n\r\nEventEmitter.prototype.listenerCount = listenerCount;\r\nfunction listenerCount(type) {\r\n  var events = this._events;\r\n\r\n  if (events !== undefined) {\r\n    var evlistener = events[type];\r\n\r\n    if (typeof evlistener === 'function') {\r\n      return 1;\r\n    } else if (evlistener !== undefined) {\r\n      return evlistener.length;\r\n    }\r\n  }\r\n\r\n  return 0;\r\n}\r\n\r\nEventEmitter.prototype.eventNames = function eventNames() {\r\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\r\n};\r\n\r\nfunction arrayClone(arr, n) {\r\n  var copy = new Array(n);\r\n  for (var i = 0; i < n; ++i)\r\n    copy[i] = arr[i];\r\n  return copy;\r\n}\r\n\r\nfunction spliceOne(list, index) {\r\n  for (; index + 1 < list.length; index++)\r\n    list[index] = list[index + 1];\r\n  list.pop();\r\n}\r\n\r\nfunction unwrapListeners(arr) {\r\n  var ret = new Array(arr.length);\r\n  for (var i = 0; i < ret.length; ++i) {\r\n    ret[i] = arr[i].listener || arr[i];\r\n  }\r\n  return ret;\r\n}\r\n\r\nfunction once(emitter, name) {\r\n  return new Promise(function (resolve, reject) {\r\n    function errorListener(err) {\r\n      emitter.removeListener(name, resolver);\r\n      reject(err);\r\n    }\r\n\r\n    function resolver() {\r\n      if (typeof emitter.removeListener === 'function') {\r\n        emitter.removeListener('error', errorListener);\r\n      }\r\n      resolve([].slice.call(arguments));\r\n    };\r\n\r\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\r\n    if (name !== 'error') {\r\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\r\n    }\r\n  });\r\n}\r\n\r\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\r\n  if (typeof emitter.on === 'function') {\r\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\r\n  }\r\n}\r\n\r\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\r\n  if (typeof emitter.on === 'function') {\r\n    if (flags.once) {\r\n      emitter.once(name, listener);\r\n    } else {\r\n      emitter.on(name, listener);\r\n    }\r\n  } else if (typeof emitter.addEventListener === 'function') {\r\n    // EventTarget does not have `error` event semantics like Node\r\n    // EventEmitters, we do not listen for `error` events here.\r\n    emitter.addEventListener(name, function wrapListener(arg) {\r\n      // IE does not have builtin `{ once: true }` support so we\r\n      // have to do it manually.\r\n      if (flags.once) {\r\n        emitter.removeEventListener(name, wrapListener);\r\n      }\r\n      listener(arg);\r\n    });\r\n  } else {\r\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\r\n  }\r\n}","'use strict';\r\n\r\nfunction EventSender() {\r\n  this.listeners = {};\r\n  this.listenersWithRefs = {};\r\n}\r\n\r\nEventSender.prototype.on = function (eventName, callback, ref) {\r\n  if (ref) {\r\n    if (!this.listenersWithRefs.hasOwnProperty(eventName)) {\r\n      this.listenersWithRefs[eventName] = new Map();\r\n    }\r\n\r\n    if (!this.listenersWithRefs[eventName].get(ref)) {\r\n      this.listenersWithRefs[eventName].set(ref, []);\r\n    }\r\n\r\n    this.listenersWithRefs[eventName].get(ref).push(callback);\r\n  } else {\r\n    if (!this.listeners.hasOwnProperty(eventName)) {\r\n      this.listeners[eventName] = [];\r\n    }\r\n\r\n    this.listeners[eventName].push(callback);\r\n  }\r\n};\r\n\r\nEventSender.prototype.removeListenersWithRef = function (ref) {\r\n  Object.keys(this.listenersWithRefs).forEach((eventName) => {\r\n    const listeners = this.listenersWithRefs[eventName];\r\n    if (listeners.has(ref)) {\r\n      listeners.delete(ref);\r\n    }\r\n  });\r\n};\r\n\r\nEventSender.prototype.removeAllListeners = function (eventName) {\r\n  if (eventName) {\r\n    delete this.listeners[eventName];\r\n    delete this.listenersWithRefs[eventName];\r\n  } else {\r\n    this.listeners = {};\r\n    this.listenersWithRefs = {};\r\n  }\r\n};\r\n\r\nEventSender.prototype.emit = async function (eventName, data) {\r\n  const array = this.listeners[eventName];\r\n\r\n  if (array) {\r\n    for (let i = 0; i < array.length; i++) {\r\n      const callback = array[i];\r\n      await Promise.resolve(callback.call(null, data));\r\n    }\r\n  }\r\n\r\n  const map = this.listenersWithRefs[eventName];\r\n\r\n  if (map) {\r\n    for (const [ref, callbacks] of map) {\r\n      for (const callback of callbacks) {\r\n        await Promise.resolve(callback.call(ref, data));\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = EventSender;\r\n","//adapted from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\r\nfunction guid() {\r\n    function s4() {\r\n        return Math.floor((1 + Math.random()) * 0x10000) .toString(16) .substring(1);\r\n    }\r\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\r\n}\r\n\r\nmodule.exports = guid;\r\n","'use strict';\r\n\r\nconst Model = require('./model');\r\nconst { getAbsoluteUrl } = require('./utils');\r\n\r\nvar userFunctionsCache = {};\r\n\r\nfunction JavascriptNodeParser(code, options) {\r\n  this.inputs = {};\r\n  this.outputs = {};\r\n  this.error = undefined;\r\n  this.code = code;\r\n\r\n  const node = options ? options.node : undefined;\r\n  this._initializeAPIs();\r\n\r\n  var userCode = userFunctionsCache[code];\r\n  if (!userCode) {\r\n    try {\r\n      userCode = new Function(['define', 'script', 'Node', 'Component'], JavascriptNodeParser.getCodePrefix() + code);\r\n      userFunctionsCache[code] = userCode;\r\n    } catch (e) {\r\n      this.error = e.message;\r\n      console.error(e);\r\n    }\r\n  }\r\n  if (userCode) {\r\n    try {\r\n      userCode(\r\n        this.define.bind(this),\r\n        this.script.bind(this),\r\n        this.apis.Node,\r\n        node ? JavascriptNodeParser.getComponentScopeForNode(node) : {}\r\n      ); //noodlJavascriptAPI);\r\n\r\n      this._afterSourced();\r\n    } catch (e) {\r\n      this.error = e.message;\r\n      console.error(e);\r\n    }\r\n  }\r\n}\r\n\r\n// First generation API\r\nJavascriptNodeParser.prototype.define = function (userObject) {\r\n  this.inputs = userObject.inputs || {};\r\n  this.outputs = userObject.outputs || {};\r\n  this.setup = userObject.setup;\r\n  this.change = userObject.run || userObject.change;\r\n  this.destroy = userObject.destroy;\r\n\r\n  this.definedObject = userObject;\r\n};\r\n\r\n// Second generation API\r\nfunction _scriptExtend(_this) {\r\n  var _extended = {\r\n    inputs: _this.inputs || {},\r\n    outputs: _this.outputs || {},\r\n\r\n    setup: function (inputs, outputs) {\r\n      this.inputs = inputs;\r\n      this.outputs = outputs;\r\n\r\n      this.setOutputs = function (states) {\r\n        for (var key in states) {\r\n          this.outputs[key] = states[key];\r\n          this.flagOutputDirty(key);\r\n        }\r\n      };\r\n\r\n      if (_this.methods) {\r\n        for (var key in _this.methods) {\r\n          this[key] = _this.methods[key];\r\n        }\r\n      }\r\n\r\n      _this.setup && _this.setup.apply(this);\r\n    },\r\n\r\n    destroy: function (inputs, outputs) {\r\n      this.inputs = inputs;\r\n      this.outputs = outputs;\r\n\r\n      _this.destroy && _this.destroy.apply(this);\r\n    },\r\n\r\n    change: function (inputs, outputs) {\r\n      this.inputs = inputs;\r\n      this.outputs = outputs;\r\n\r\n      // Detect property changed\r\n      var old = this._oldInputs || {};\r\n\r\n      if (_this.changed) {\r\n        for (var key in inputs) {\r\n          if (inputs[key] !== old[key]) {\r\n            var changedFunction = _this.changed[key];\r\n            if (typeof changedFunction === 'function') changedFunction.apply(this, [inputs[key], old[key]]);\r\n          }\r\n        }\r\n      }\r\n\r\n      this._oldInputs = Object.assign({}, inputs);\r\n    }\r\n  };\r\n\r\n  if (_this.signals) {\r\n    for (var key in _this.signals) {\r\n      _extended[key] = _this.signals[key];\r\n\r\n      _extended.inputs[key] = 'signal';\r\n    }\r\n  }\r\n\r\n  return _extended;\r\n}\r\n\r\nJavascriptNodeParser.prototype.script = function (userObject) {\r\n  var _userObjectExtended = _scriptExtend(userObject);\r\n  this.inputs = _userObjectExtended.inputs || {};\r\n  this.outputs = _userObjectExtended.outputs || {};\r\n  this.setup = _userObjectExtended.setup;\r\n  this.change = _userObjectExtended.run || _userObjectExtended.change;\r\n  this.destroy = _userObjectExtended.destroy;\r\n\r\n  this.definedObject = _userObjectExtended;\r\n};\r\n\r\n// Third generation API\r\n\r\n// Node.Setters.Hej = function(value) {...}\r\n// Node.OnInputsChanged = function() {...}\r\n// Node.Signals.Hej = function(value) {...}\r\n// Node.OnInit = function() {...}\r\n// Node.OnDestroy = function() {...}\r\n// Node.Inputs.A\r\n// Node.Outputs.A = 10;\r\n// Node.Outputs.Done()\r\n// Node.setOutputs({...})\r\n// Component.Object, Component.ParentObject\r\nJavascriptNodeParser.prototype._initializeAPIs = function () {\r\n  this.apis = {};\r\n\r\n  this.apis.Node = {\r\n    Inputs: {},\r\n    Outputs: {},\r\n    Signals: {},\r\n    Setters: {}\r\n  };\r\n};\r\n\r\nJavascriptNodeParser.prototype._afterSourced = function () {\r\n  if (this.definedObject !== undefined) return; // a legacy API have been used\r\n\r\n  var _Node = this.apis.Node;\r\n\r\n  // Merge inputs and outputs from node extension\r\n  this.inputs = Object.assign({}, _Node.Inputs || {});\r\n  this.outputs = Object.assign({}, _Node.Outputs || {});\r\n\r\n  this.setup = function (inputs, outputs) {\r\n    const _this = this;\r\n\r\n    _Node.setOutputs = function (_outputs) {\r\n      for (var key in _outputs) {\r\n        outputs[key] = _outputs[key];\r\n        _this.flagOutputDirty(key);\r\n      }\r\n    };\r\n\r\n    _Node.OnInit && _Node.OnInit.apply(this);\r\n  };\r\n\r\n  this.destroy = _Node.OnDestroy || this.destory;\r\n  this.change = (inputs, outputs, changedInputs) => {\r\n    for (var key in changedInputs) {\r\n      if (typeof _Node.Setters[key] === 'function') {\r\n        _Node.Setters[key](inputs[key]);\r\n      }\r\n    }\r\n\r\n    if (typeof _Node.OnInputsChanged === 'function') {\r\n      _Node.OnInputsChanged();\r\n    }\r\n  };\r\n\r\n  this.definedObject = {\r\n    inputs: this.inputs,\r\n    outputs: this.outputs,\r\n    setup: this.setup,\r\n    destroy: this.destroy,\r\n    change: this.change\r\n  };\r\n\r\n  // Set all signals as signal inputs\r\n  if (_Node.Signals !== undefined) {\r\n    for (var key in _Node.Signals) {\r\n      if (typeof _Node.Signals[key] === 'function') {\r\n        this.inputs[key] = 'signal';\r\n\r\n        this.definedObject[key] = _Node.Signals[key];\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nJavascriptNodeParser.createFromCode = function (code, options) {\r\n  return new JavascriptNodeParser(code, options);\r\n};\r\n\r\nJavascriptNodeParser.createFromURL = function (url, callback, options) {\r\n  url = getAbsoluteUrl(url);\r\n\r\n  var xhr = new window.XMLHttpRequest();\r\n  xhr.open('GET', url, true);\r\n  xhr.onreadystatechange = function () {\r\n    // XMLHttpRequest.DONE = 4, but torped runtime doesn't support enum\r\n    if (this.readyState === 4 || this.readyState === XMLHttpRequest.DONE) {\r\n      callback(new JavascriptNodeParser(this.response));\r\n    }\r\n  };\r\n  xhr.onerror = function () {\r\n    console.log('Failed to request', url);\r\n  };\r\n  xhr.send();\r\n};\r\n\r\nJavascriptNodeParser.parseAndAddPortsFromScript = function (script, ports, options) {\r\n  // Extract inputs and outputs\r\n  function _exists(port) {\r\n    if (typeof port === 'string') return ports.find((p) => p.name === port) !== undefined;\r\n    else return ports.find((p) => p.name === port.name && p.plug === port.plug) !== undefined;\r\n  }\r\n\r\n  function _addPortsFromMatch(match, options) {\r\n    if (match === undefined || match === null) return;\r\n\r\n    const unique = {};\r\n    for (const _s of match) {\r\n      let name = _s[1];\r\n      if (name === undefined) continue;\r\n\r\n      unique[name] = true;\r\n    }\r\n\r\n    Object.keys(unique).forEach((p) => {\r\n      if (\r\n        _exists({\r\n          name: options.prefix + p,\r\n          plug: options.plug\r\n        })\r\n      )\r\n        return;\r\n\r\n      ports.push({\r\n        name: options.prefix + p,\r\n        displayName: p,\r\n        plug: options.plug,\r\n        type: options.type,\r\n        group: options.group\r\n      });\r\n    });\r\n  }\r\n\r\n  // const scriptWithoutComments = script.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g,''); // Remove comments\r\n\r\n  // Regular Inputs. notation\r\n  if (!options.skipInputs) {\r\n    _addPortsFromMatch(script.matchAll(/Inputs\\.([A-Za-z0-9_]+)/g), {\r\n      type: options.inputType || '*',\r\n      plug: 'input',\r\n      group: options.inputGroup || 'Inputs',\r\n      prefix: options.inputPrefix || ''\r\n    });\r\n\r\n    // Inputs with Inputs[\"A\"] notation\r\n    _addPortsFromMatch(script.matchAll(/Inputs\\s*\\[\\s*(?:'|\")(.*)(?:'|\")\\s*\\]/g), {\r\n      type: options.inputType || '*',\r\n      plug: 'inputs',\r\n      group: options.inputGroup || 'Inputs',\r\n      prefix: options.inputPrefix || ''\r\n    });\r\n  }\r\n\r\n  if (!options.skipOutputs) {\r\n    if (!options.skipOutputSignals) {\r\n      // Output signals, Output.Done()\r\n      _addPortsFromMatch(script.matchAll(/Outputs\\.([A-Za-z0-9]+)\\s*\\(\\s*\\)/g), {\r\n        type: 'signal',\r\n        plug: 'output',\r\n        group: 'Outputs',\r\n        prefix: options.outputPrefix || ''\r\n      });\r\n\r\n      // Output signals, Outputs[\"Done\"]()\r\n      _addPortsFromMatch(script.matchAll(/Outputs\\s*\\[\\s*(?:'|\")(.*)(?:'|\")\\s*\\]\\(\\s*\\)/g), {\r\n        type: 'signal',\r\n        plug: 'output',\r\n        group: 'Outputs',\r\n        prefix: options.outputPrefix || ''\r\n      });\r\n    }\r\n\r\n    if (!options.skipRegularOutputs) {\r\n      // Regular output Outputs. notation\r\n      _addPortsFromMatch(script.matchAll(/Outputs\\.([A-Za-z0-9_]+)/g), {\r\n        type: '*',\r\n        plug: 'output',\r\n        group: 'Outputs',\r\n        prefix: options.outputPrefix || ''\r\n      });\r\n\r\n      // Outputs with Outputs[\"A\"] notation\r\n      _addPortsFromMatch(script.matchAll(/Outputs\\s*\\[\\s*\\\"([^\\\"]*)\\\"\\s*\\]/g), {\r\n        type: '*',\r\n        plug: 'output',\r\n        group: 'Outputs',\r\n        prefix: options.outputPrefix || ''\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nJavascriptNodeParser.prototype.getPorts = function () {\r\n  var ports = [];\r\n\r\n  var self = this;\r\n\r\n  Object.keys(this.inputs).forEach(function (name) {\r\n    var inputPort = self.inputs[name];\r\n\r\n    var port = {\r\n      name: name,\r\n      plug: 'input'\r\n    };\r\n    if (typeof inputPort === 'string') {\r\n      port.type = {\r\n        name: inputPort\r\n      };\r\n      port.group = 'Inputs';\r\n    } else {\r\n      for (var p in inputPort) {\r\n        port[p] = inputPort[p];\r\n      }\r\n    }\r\n\r\n    ports.push(port);\r\n  });\r\n\r\n  Object.keys(this.outputs).forEach(function (name) {\r\n    ports.push({\r\n      name: name,\r\n      type: {\r\n        name: self.outputs[name]\r\n      },\r\n      plug: 'output',\r\n      group: 'Outputs'\r\n    });\r\n  });\r\n\r\n  JavascriptNodeParser.parseAndAddPortsFromScript(this.code, ports, {});\r\n\r\n  return ports;\r\n};\r\n\r\nconst _componentScopes = {};\r\n\r\nfunction _findParentComponentStateModelId(node) {\r\n  function getParentComponent(component) {\r\n    let parent;\r\n    if (component.getRoots().length > 0) {\r\n      //visual\r\n      const root = component.getRoots()[0];\r\n\r\n      if (root.getVisualParentNode) {\r\n        //regular visual node\r\n        if (root.getVisualParentNode()) {\r\n          parent = root.getVisualParentNode().nodeScope.componentOwner;\r\n        }\r\n      } else if (root.parentNodeScope) {\r\n        //component instance node\r\n        parent = component.parentNodeScope.componentOwner;\r\n      }\r\n    } else if (component.parentNodeScope) {\r\n      parent = component.parentNodeScope.componentOwner;\r\n    }\r\n\r\n    //check that a parent exists and that the component is different\r\n    if (parent && parent.nodeScope && parent.nodeScope.componentOwner !== component) {\r\n      //check if parent has a Component State node\r\n      if (parent.nodeScope.getNodesWithType('net.noodl.ComponentObject').length > 0) {\r\n        return parent;\r\n      }\r\n\r\n      if (parent.nodeScope.getNodesWithType('Component State').length > 0) {\r\n        return parent;\r\n      }\r\n\r\n      //if not, continue searching up the tree\r\n      return getParentComponent(parent);\r\n    }\r\n  }\r\n\r\n  const parent = getParentComponent(node.nodeScope.componentOwner);\r\n  if (!parent) return;\r\n\r\n  //this._internal.parentComponentName = parent.name;\r\n\r\n  return 'componentState' + parent.getInstanceId();\r\n}\r\n\r\nfunction _findForEachModel(node) {\r\n  var component = node.nodeScope.componentOwner;\r\n  while (component !== undefined && component._forEachModel === undefined && component.parentNodeScope) {\r\n    component = component.parentNodeScope.componentOwner;\r\n  }\r\n  return component !== undefined ? component._forEachModel : undefined;\r\n}\r\n\r\nJavascriptNodeParser.getComponentScopeForNode = function (node) {\r\n  const componentId = node.nodeScope.componentOwner.getInstanceId();\r\n\r\n  if (_componentScopes[componentId] === undefined) {\r\n    _componentScopes[componentId] = {};\r\n\r\n    const componentObject = (node.nodeScope.modelScope || Model).get('componentState' + componentId);\r\n\r\n    _componentScopes[componentId].Object = componentObject;\r\n  }\r\n\r\n  // This should be done each time, since the component can be moved\r\n  const parentComponentObjectId = _findParentComponentStateModelId(node);\r\n  const parentComponentObject =\r\n    parentComponentObjectId !== undefined\r\n      ? (node.nodeScope.modelScope || Model).get(parentComponentObjectId)\r\n      : undefined;\r\n\r\n  _componentScopes[componentId].ParentObject = parentComponentObject;\r\n\r\n  // Set the for each model\r\n  _componentScopes[componentId].RepeaterObject = _findForEachModel(node);\r\n\r\n  return _componentScopes[componentId];\r\n};\r\n\r\nJavascriptNodeParser.getCodePrefix = function () {\r\n  // API\r\n  return \"const Script = (typeof Node !== 'undefined')?Node:undefined;\\n\";\r\n};\r\n\r\nJavascriptNodeParser.createNoodlAPI = function () {\r\n  // If we are running in browser mode and there is a global Noodl API object, use it. If not\r\n  // create a new one for this scope.\r\n  return typeof window !== 'undefined' && window.Noodl !== undefined ? window.Noodl : {};\r\n};\r\n\r\nmodule.exports = JavascriptNodeParser;\r\n","// ------------------------------------------------------------------------------\r\n// Model\r\n// ------------------------------------------------------------------------------\r\nfunction Model(id, data) {\r\n  this.id = id;\r\n  this.data = data;\r\n}\r\n\r\nconst models = (Model._models = {});\r\nconst proxies = {};\r\n\r\n// Get and set proxy\r\nconst _modelProxyHandler = {\r\n  get: function (target, prop, receiver) {\r\n    if (typeof target[prop] === 'function') return target[prop].bind(target);\r\n    else if (prop in target) return Reflect.get(target, prop, receiver);\r\n    else return target.get(prop);\r\n  },\r\n  set: function (obj, prop, value) {\r\n    if (prop === '_class') {\r\n      obj._class = value;\r\n    } else if (prop === 'id') {\r\n      console.log(`Noodl.Object warning: id is readonly (Id is ${obj.id}, trying to set to ${value})`);\r\n      return true; //if a proxy doesn't return true an exception will be thrown\r\n    } else {\r\n      obj.set(prop, value);\r\n    }\r\n    return true;\r\n  },\r\n  ownKeys(target) {\r\n    return Reflect.ownKeys(target.data);\r\n  },\r\n  getOwnPropertyDescriptor(target, prop) {\r\n    return Object.getOwnPropertyDescriptor(target.data, prop);\r\n  }\r\n};\r\n\r\n/**\r\n *\r\n * @param {*} id\r\n * @returns {Model}\r\n */\r\nModel.get = function (id) {\r\n  if (id === undefined) id = Model.guid();\r\n  if (!models[id]) {\r\n    models[id] = new Model(id, {});\r\n    proxies[id] = new Proxy(models[id], _modelProxyHandler);\r\n  }\r\n  return proxies[id];\r\n};\r\n\r\nModel.create = function (data) {\r\n  var modelData = data ? data : {};\r\n  var m = Model.get(modelData.id);\r\n  for (var key in modelData) {\r\n    if (key === 'id') continue;\r\n    m.set(key, modelData[key]);\r\n  }\r\n\r\n  return m;\r\n};\r\n\r\nModel.exists = function (id) {\r\n  return models[id] !== undefined;\r\n};\r\n\r\nModel.instanceOf = function (collection) {\r\n  return collection instanceof Model || collection.target instanceof Model;\r\n};\r\n\r\nfunction _randomString(size) {\r\n  if (size === 0) {\r\n    throw new Error('Zero-length randomString is useless.');\r\n  }\r\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '0123456789';\r\n  let objectId = '';\r\n  for (let i = 0; i < size; ++i) {\r\n    objectId += chars[Math.floor((1 + Math.random()) * 0x10000) % chars.length];\r\n  }\r\n  return objectId;\r\n}\r\n\r\nModel.guid = function guid() {\r\n  return _randomString(10);\r\n};\r\n\r\nModel.prototype.on = function (event, listener) {\r\n  if (!this.listeners) this.listeners = {};\r\n  if (!this.listeners[event]) this.listeners[event] = [];\r\n  this.listeners[event].push(listener);\r\n};\r\n\r\nModel.prototype.off = function (event, listener) {\r\n  if (!this.listeners) return;\r\n  if (!this.listeners[event]) return;\r\n  var idx = this.listeners[event].indexOf(listener);\r\n  if (idx !== -1) this.listeners[event].splice(idx, 1);\r\n};\r\n\r\nModel.prototype.notify = function (event, args) {\r\n  if (!this.listeners) return;\r\n  if (!this.listeners[event]) return;\r\n\r\n  var l = this.listeners[event].slice(); //clone in case listeners array is modified in the callbacks\r\n  for (var i = 0; i < l.length; i++) {\r\n    l[i](args);\r\n  }\r\n};\r\n\r\nModel.prototype.setAll = function (obj) {\r\n  for (var i in obj) {\r\n    if (i === 'id') continue; // Skip id\r\n    if (this.data[i] !== obj[i]) {\r\n      var old = this.data[i];\r\n      this.data[i] = obj[i];\r\n      this.notify('change', { name: i, value: obj[i], old: old });\r\n    }\r\n  }\r\n};\r\n\r\nModel.prototype.fill = function (value = null) {\r\n  for (const key in this.data) {\r\n    if (key === 'id') continue; // Skip id\r\n    const temp = this.data[key];\r\n    this.data[key] = value;\r\n    this.notify('change', { name: key, value: this.data[key], old: temp });\r\n  }\r\n};\r\n\r\n/**\r\n * @param {string} name\r\n * @param {unknown} value\r\n * @param {{\r\n *  resolve?: boolean;\r\n *  forceChange?: boolean;\r\n *  silent?: boolean;\r\n * }} args\r\n */\r\nModel.prototype.set = function (name, value, args) {\r\n  if (args && args.resolve && name.indexOf('.') !== -1) {\r\n    // We should resolve path references\r\n    const path = name.split('.');\r\n    let model = this;\r\n    for (let i = 0; i < path.length - 1; i++) {\r\n      const v = model.get(path[i]);\r\n      if (Model.instanceOf(v)) model = v;\r\n      else return; // Path resolve failed\r\n    }\r\n    model.set(path[path.length - 1], value);\r\n    return;\r\n  }\r\n\r\n  const forceChange = args && args.forceChange;\r\n\r\n  const oldValue = this.data[name];\r\n  this.data[name] = value;\r\n\r\n  if ((forceChange || oldValue !== value) && (!args || !args.silent)) {\r\n    this.notify('change', { name: name, value: value, old: oldValue });\r\n  }\r\n};\r\n\r\n/**\r\n * @returns {string}\r\n */\r\nModel.prototype.getId = function () {\r\n  return this.id;\r\n};\r\n\r\n/**\r\n * @param {string} name\r\n * @param {{\r\n *  resolve?: boolean;\r\n * }} args\r\n * @returns {unknown}\r\n */\r\nModel.prototype.get = function (name, args) {\r\n  if (args && args.resolve && name.indexOf('.') !== -1) {\r\n    // We should resolve path references\r\n    const path = name.split('.');\r\n    let model = this;\r\n    for (let i = 0; i < path.length - 1; i++) {\r\n      const v = model.get(path[i]);\r\n      if (Model.instanceOf(v)) model = v;\r\n      else return; // Path resolve failed\r\n    }\r\n    return model.get(path[path.length - 1]);\r\n  }\r\n\r\n  return this.data[name];\r\n};\r\n\r\nModel.prototype.toJSON = function () {\r\n  return Object.assign({}, this.data, { id: this.id });\r\n};\r\n\r\nModel.Scope = function () {\r\n  this.models = {};\r\n  this.proxies = {};\r\n};\r\n\r\nModel.Scope.prototype.get = function (id) {\r\n  if (id === undefined) id = Model.guid();\r\n  if (!this.models[id]) {\r\n    this.models[id] = new Model(id, {});\r\n    this.proxies[id] = new Proxy(this.models[id], _modelProxyHandler);\r\n  }\r\n  return this.proxies[id];\r\n};\r\n\r\nModel.Scope.prototype.create = function (data) {\r\n  var modelData = data ? data : {};\r\n  var m = this.get(modelData.id);\r\n  for (var key in modelData) {\r\n    if (key === 'id') continue;\r\n    m.set(key, modelData[key]);\r\n  }\r\n\r\n  return m;\r\n};\r\n\r\nModel.Scope.prototype.exists = function (id) {\r\n  return this.models[id] !== undefined;\r\n};\r\n\r\nModel.Scope.prototype.instanceOf = function (collection) {\r\n  return collection instanceof Model || collection.target instanceof Model;\r\n};\r\n\r\nModel.Scope.prototype.guid = function guid() {\r\n  return _randomString(10);\r\n};\r\n\r\nModel.Scope.prototype.reset = function () {\r\n  this.models = {};\r\n  this.proxies = {};\r\n  delete this._cloudStore;\r\n};\r\n\r\nmodule.exports = Model;\r\n","\"use strict\";\r\n\r\nvar NodeModel = require('./nodemodel');\r\nvar EventSender = require('../eventsender');\r\n\r\nfunction ComponentModel(name) {\r\n    EventSender.call(this);\r\n\r\n    this.name = name;\r\n    this.nodes = [];\r\n    this.connections = [];\r\n    this.roots = [];\r\n    this.inputPorts = {};\r\n    this.outputPorts = {};\r\n    this.metadata = {};\r\n}\r\n\r\nComponentModel.prototype = Object.create(EventSender.prototype);\r\n\r\nComponentModel.prototype.addNode = async function(node) {\r\n    node.component = this;\r\n    this.nodes[node.id] = node;\r\n    await this.emit(\"nodeAdded\", node);\r\n};\r\n\r\nComponentModel.prototype.hasNodeWithId = function(id) {\r\n    return this.getNodeWithId(id) !== undefined;\r\n};\r\n\r\nComponentModel.prototype.getNodeWithId = function(id) {\r\n    return this.nodes[id];\r\n};\r\n\r\nComponentModel.prototype.getAllNodes = function() {\r\n    return Object.values(this.nodes);\r\n};\r\n\r\nComponentModel.prototype.getNodesWithType = function(type) {\r\n    var nodes = [];\r\n    var self = this;\r\n    Object.keys(this.nodes).forEach(function(id) {\r\n        var node = self.nodes[id];\r\n        if(node.type === type) {\r\n            nodes.push(node);\r\n        }\r\n    });\r\n\r\n    return nodes;\r\n};\r\n\r\nComponentModel.prototype.addConnection = function(connection) {\r\n    this.connections.push(connection);\r\n    this.emit(\"connectionAdded\", connection);\r\n    \r\n    //emit an event on the target node model\r\n    //used by numbered inputs\r\n    if(connection.targetId) {\r\n        const node = this.getNodeWithId(connection.targetId);\r\n        if(node) {\r\n            node.emit(\"inputConnectionAdded\", connection);\r\n        }\r\n    }\r\n};\r\n\r\nComponentModel.prototype.removeConnection = function(connection) {\r\n    const index = this.connections.findIndex(con => {\r\n        return con.sourceId === connection.sourceId &&\r\n               con.sourcePort === connection.sourcePort &&\r\n               con.targetId === connection.targetId &&\r\n               con.targetPort === connection.targetPort;\r\n    });\r\n\r\n    if(index === -1) {\r\n       console.log(\"Connection doesn't exist\", connection);\r\n       return;\r\n    }\r\n\r\n    this.connections.splice(index, 1);\r\n    this.emit(\"connectionRemoved\", connection);\r\n\r\n    //emit an event on the target node model\r\n    //used by numbered inputs\r\n    if(connection.targetId) {\r\n        const node = this.getNodeWithId(connection.targetId);\r\n        if(node) {\r\n            node.emit(\"inputConnectionRemoved\", connection);\r\n        }\r\n    }\r\n};\r\n\r\nComponentModel.prototype.getConnectionsFromPort = function(nodeId, sourcePortName) {\r\n    return this.connections.filter(function(connection) {\r\n        return connection.sourceId === nodeId && connection.sourcePort === sourcePortName;\r\n    })\r\n};\r\n\r\nComponentModel.prototype.getConnectionsToPort = function(nodeId, targetPortName) {\r\n    return this.connections.filter(function(connection) {\r\n        return connection.targetId === nodeId && connection.targetPort === targetPortName;\r\n    })\r\n};\r\n\r\nComponentModel.prototype.getConnectionsFrom = function(nodeId) {\r\n    return this.connections.filter(function(connection) {\r\n        return connection.sourceId === nodeId;\r\n    })\r\n};\r\n\r\nComponentModel.prototype.getConnectionsTo = function(nodeId) {\r\n    return this.connections.filter(function(connection) {\r\n        return connection.targetId === nodeId;\r\n    })\r\n};\r\n\r\nComponentModel.prototype.addRootId = function(rootId) {\r\n    if(this.roots.indexOf(rootId) !== -1) {\r\n        return;\r\n    }\r\n    this.roots.push(rootId);\r\n    this.emit(\"rootAdded\", rootId);\r\n};\r\n\r\nComponentModel.prototype.removeRootId = function(rootId) {\r\n    const index = this.roots.indexOf(rootId);\r\n    if(index !== -1) {\r\n        this.roots.splice(index, 1);\r\n        this.emit(\"rootRemoved\", rootId);\r\n    }\r\n};\r\n\r\nComponentModel.prototype.getRoots = function() {\r\n    return this.roots;\r\n}\r\n\r\nComponentModel.prototype.removeNodeWithId = async function(id) {\r\n    const node = this.getNodeWithId(id);\r\n\r\n    if (!node) {\r\n        console.warn(\"ERROR: Attempted to remove non-existing node with ID:\", id);\r\n        return false;\r\n    }\r\n\r\n    //remove children first\r\n    while(node.children.length > 0) {\r\n        const child = node.children[0];\r\n        const childRemoved = await this.removeNodeWithId(child.id);\r\n        if (!childRemoved) {\r\n            // Workaround for corrupt node trees, should never happen, a remove should always be successful\r\n            node.children.shift();\r\n        }\r\n    }\r\n\r\n    const connections = this.getConnectionsTo(id).concat(this.getConnectionsFrom(id));\r\n\r\n    for(let i=0; i<connections.length; i++) {\r\n        this.removeConnection(connections[i]);\r\n    }\r\n\r\n    this.setNodeParent(node, null);\r\n\r\n    if(this.roots.indexOf(node.id) !== -1) {\r\n        this.removeRootId(node.id);\r\n    }\r\n\r\n    await this.emit(\"nodeRemoved\", node);\r\n\r\n    node.removeAllListeners();\r\n    delete this.nodes[id];\r\n\r\n    await this.emit(\"nodeWasRemoved\", node);\r\n    return true;\r\n};\r\n\r\nComponentModel.prototype.getAllConnections = function() {\r\n    return this.connections;\r\n};\r\n\r\nComponentModel.prototype.getInputPorts = function() {\r\n    return this.inputPorts;\r\n};\r\n\r\nComponentModel.prototype.getOutputPorts = function() {\r\n    return this.outputPorts;\r\n};\r\n\r\nComponentModel.prototype.addInputPort = function(port) {\r\n    this.inputPorts[port.name] = port;\r\n    this.emit(\"inputPortAdded\", port);\r\n};\r\n\r\nComponentModel.prototype.addOutputPort = function(port) {\r\n    this.outputPorts[port.name] = port;\r\n    this.emit(\"outputPortAdded\", port);\r\n};\r\n\r\nComponentModel.prototype.removeOutputPortWithName = function(portName) {\r\n    if(this.outputPorts.hasOwnProperty(portName)) {\r\n        var port = this.outputPorts[portName];\r\n        delete this.outputPorts[portName];\r\n        this.emit(\"outputPortRemoved\", port);\r\n    }\r\n};\r\n\r\nComponentModel.prototype.removeInputPortWithName = function(portName) {\r\n    if(this.inputPorts.hasOwnProperty(portName)) {\r\n        var port = this.inputPorts[portName];\r\n        delete this.inputPorts[portName];\r\n        this.emit(\"inputPortRemoved\", port);\r\n    }\r\n};\r\n\r\nComponentModel.prototype.updateInputPortTypes = function(ports) {\r\n    var changed = false;\r\n    for(var key in ports) {\r\n        if(this.inputPorts[key] !== undefined) {\r\n            this.inputPorts[key].type = ports[key].type;\r\n            changed = true;\r\n        }\r\n    }\r\n    changed && this.emit(\"inputPortTypesUpdated\");\r\n}\r\n\r\nComponentModel.prototype.updateOutputPortTypes = function(ports) {\r\n    var changed = false;\r\n    for(var key in ports) {\r\n        if(this.outputPorts[key] !== undefined) {\r\n            this.outputPorts[key].type = ports[key].type;\r\n            changed = true;\r\n        }\r\n    }\r\n    changed && this.emit(\"outputPortTypesUpdated\");\r\n}\r\n\r\nComponentModel.prototype.renameInputPortOnNodeWithId = function(id, oldName, newName) {\r\n\r\n    //remove connections\r\n    var connections = this.getConnectionsToPort(id, oldName);\r\n    connections.forEach(this.removeConnection.bind(this));\r\n\r\n    //get port before deleting it\r\n    var nodeModel = this.getNodeWithId(id);\r\n    var port = {...nodeModel.getInputPort(oldName)};\r\n\r\n    //remove old port\r\n    if(port) {\r\n        nodeModel.removeInputPortWithName(oldName);\r\n\r\n        //rename and add new port\r\n        port.name = newName;\r\n        nodeModel.addInputPort(port);\r\n    }\r\n\r\n    //add new connection\r\n    connections.forEach(function(connection) {\r\n        connection.targetPort = newName;\r\n    });\r\n\r\n    connections.forEach(this.addConnection.bind(this));\r\n};\r\n\r\nComponentModel.prototype.renameOutputPortOnNodeWithId = function(id, oldName, newName) {\r\n\r\n    //remove connections\r\n    var connections = this.getConnectionsFromPort(id, oldName);\r\n    connections.forEach(this.removeConnection.bind(this));\r\n\r\n    //get port before deleting it\r\n    var nodeModel = this.getNodeWithId(id);\r\n    var port = {...nodeModel.getOutputPort(oldName)};\r\n\r\n    //remove old port\r\n    nodeModel.removeOutputPortWithName(oldName);\r\n\r\n    //rename and add new port\r\n    port.name = newName;\r\n    nodeModel.addOutputPort(port);\r\n\r\n    //add new connection\r\n    connections.forEach(function(connection) {\r\n        connection.sourcePort = newName;\r\n    });\r\n\r\n    connections.forEach(this.addConnection.bind(this));\r\n};\r\n\r\nComponentModel.prototype.setNodeParent = function(childModel, newParentModel, index) {\r\n\r\n    if(this.roots.indexOf(childModel.id) !== -1) {\r\n        this.removeRootId(childModel.id)\r\n    }\r\n\r\n    if(childModel.parent) {\r\n        this.emit(\"nodeParentWillBeRemoved\", childModel);\r\n        childModel.parent.removeChild(childModel);\r\n    }\r\n    childModel.emit(\"parentUpdated\", newParentModel);\r\n    if(newParentModel) {\r\n        newParentModel.addChild(childModel, index);\r\n        this.emit(\"nodeParentUpdated\", childModel);\r\n    }\r\n};\r\n\r\nComponentModel.prototype.importEditorNodeData = async function(nodeData, parentId, childIndex) {\r\n    var nodeModel = NodeModel.createFromExportData(nodeData);\r\n    await this.addNode(nodeModel);\r\n\r\n    if(parentId) {\r\n        this.setNodeParent(nodeModel, this.getNodeWithId(parentId), childIndex);\r\n    }\r\n\r\n    if(nodeData.children) {\r\n        for(let i=0; i<nodeData.children.length; i++) {\r\n            const child = nodeData.children[i];\r\n            await this.importEditorNodeData(child, nodeModel.id, i);\r\n        }\r\n    }\r\n};\r\n\r\nComponentModel.prototype.reset = async function() {\r\n    while(this.roots.length) {\r\n        await this.removeNodeWithId(this.roots[0]);\r\n    }\r\n\r\n    for(const id of this.nodes) {\r\n        //note: with an incomplete library there will be no roots\r\n        //so some of the nodes will have children, which will be recursively removed by\r\n        //removeNodeWithId(), so some IDs from the Object.keys(this.nodes) that runs this loop\r\n        //will already have been removed, so check if they exist before removing\r\n        if(this.hasNodeWithId(id)) {\r\n            await this.removeNodeWithId(id);\r\n        }\r\n    }\r\n\r\n    if(this.nodes.length > 0) {\r\n        throw new Error(\"Not all nodes were removed during a reset\");\r\n    }\r\n\r\n    if(this.connections.length > 0) {\r\n        throw new Error(\"Not all connections were removed during a reset\");\r\n    }\r\n};\r\n\r\nComponentModel.prototype.rename = function(newName) {\r\n    var oldName = this.name;\r\n    this.name = newName;\r\n    this.emit(\"renamed\", {oldName: oldName, newName: newName});\r\n};\r\n\r\nComponentModel.prototype.setMetadata = function(key, data) {\r\n    this.metadata[key] = data;\r\n};\r\n\r\nComponentModel.prototype.getMetadata = function(key) {\r\n    if(!key) return this.metadata;\r\n    return this.metadata[key];\r\n};\r\n\r\nComponentModel.createFromExportData = async function(componentData) {\r\n\r\n    var componentModel = new ComponentModel(componentData.name);\r\n\r\n    if(componentData.metadata) {\r\n        for(const key in componentData.metadata) {\r\n            componentModel.setMetadata(key, componentData.metadata[key]);\r\n        }\r\n    }\r\n\r\n    componentData.ports && componentData.ports.forEach(function(port) {\r\n        if(port.plug === \"input\" || port.plug === \"input/output\") {\r\n            componentModel.addInputPort(port);\r\n        }\r\n        if(port.plug === \"output\" || port.plug === \"input/output\") {\r\n            componentModel.addOutputPort(port);\r\n        }\r\n    });\r\n\r\n    if(componentData.nodes) {\r\n        for(const node of componentData.nodes) {\r\n            await componentModel.importEditorNodeData(node);\r\n        }\r\n    }\r\n\r\n    componentData.connections && componentData.connections.forEach(connection => componentModel.addConnection(connection));\r\n    componentData.roots && componentData.roots.forEach(root => componentModel.addRootId(root));\r\n\r\n    return componentModel;\r\n};\r\n\r\nmodule.exports = ComponentModel;\r\n","'use strict';\r\n\r\nvar ComponentModel = require('./componentmodel');\r\nvar EventSender = require('../eventsender');\r\n\r\nfunction GraphModel() {\r\n  EventSender.call(this);\r\n  this.components = {};\r\n\r\n  this.settings = {};\r\n\r\n  this.metadata = {};\r\n}\r\n\r\nGraphModel.prototype = Object.create(EventSender.prototype);\r\n\r\nGraphModel.prototype.importComponentFromEditorData = async function (componentData) {\r\n  var componentModel = await ComponentModel.createFromExportData(componentData);\r\n  this.addComponent(componentModel);\r\n};\r\n\r\nGraphModel.prototype.getBundleContainingComponent = function (name) {\r\n  return this.componentToBundleMap.get(name);\r\n};\r\n\r\nGraphModel.prototype.getBundlesContainingSheet = function (sheetName) {\r\n  const bundles = new Set();\r\n  for (const name of this.componentToBundleMap.keys()) {\r\n    const isOnDefaultSheet = name.indexOf('/#') !== 0;\r\n\r\n    const isMatch =\r\n      (isOnDefaultSheet && sheetName === 'Default') || (!isOnDefaultSheet && name.indexOf('/#' + sheetName) === 0);\r\n\r\n    if (isMatch) {\r\n      bundles.add(this.componentToBundleMap.get(name));\r\n    }\r\n  }\r\n  return Array.from(bundles);\r\n};\r\n\r\nGraphModel.prototype.getBundleDependencies = function (bundleName) {\r\n  const result = new Set();\r\n\r\n  const recurse = (name) => {\r\n    const bundle = this.componentIndex[name];\r\n    for (const dep of bundle.dependencies) {\r\n      if (!result.has(dep)) {\r\n        result.add(dep);\r\n        recurse(dep);\r\n      }\r\n    }\r\n  };\r\n\r\n  recurse(bundleName);\r\n\r\n  return Array.from(result);\r\n};\r\n\r\nGraphModel.prototype.importEditorData = async function (exportData) {\r\n  this.componentIndex = exportData.componentIndex;\r\n  this.routerIndex = exportData.routerIndex;\r\n\r\n  this.componentToBundleMap = new Map();\r\n\r\n  for (const bundleName in exportData.componentIndex) {\r\n    const bundle = exportData.componentIndex[bundleName];\r\n\r\n    for (const componentName of bundle.components) {\r\n      this.componentToBundleMap.set(componentName, bundleName);\r\n    }\r\n  }\r\n\r\n  this.variants = exportData.variants || [];\r\n\r\n  exportData.settings && this.setSettings(exportData.settings);\r\n\r\n  exportData.metadata && this.setAllMetaData(exportData.metadata);\r\n\r\n  for (const component of exportData.components) {\r\n    await this.importComponentFromEditorData(component);\r\n  }\r\n\r\n  this.setRootComponentName(exportData.rootComponent);\r\n};\r\n\r\nGraphModel.prototype.setRootComponentName = function (componentName) {\r\n  this.rootComponent = componentName;\r\n  this.emit('rootComponentNameUpdated', componentName);\r\n};\r\n\r\nGraphModel.prototype.getNodesWithType = function (type) {\r\n  var nodes = [];\r\n\r\n  var componentNames = Object.keys(this.components);\r\n  for (var i = 0; i < componentNames.length; i++) {\r\n    var component = this.components[componentNames[i]];\r\n    nodes = nodes.concat(component.getNodesWithType(type));\r\n  }\r\n  return nodes;\r\n};\r\n\r\nGraphModel.prototype.getComponentWithName = function (type) {\r\n  return this.components[type];\r\n};\r\n\r\nGraphModel.prototype.hasComponentWithName = function (type) {\r\n  return this.components[type] ? true : false;\r\n};\r\n\r\nGraphModel.prototype.getAllComponents = function () {\r\n  return Object.keys(this.components).map((name) => {\r\n    return this.components[name];\r\n  });\r\n};\r\n\r\nGraphModel.prototype.getAllNodes = function () {\r\n  var nodes = [];\r\n\r\n  var componentNames = Object.keys(this.components);\r\n  for (var i = 0; i < componentNames.length; i++) {\r\n    var component = this.components[componentNames[i]];\r\n    nodes = nodes.concat(component.getAllNodes());\r\n  }\r\n\r\n  return nodes;\r\n};\r\n\r\nGraphModel.prototype.addComponent = function (component) {\r\n  this.components[component.name] = component;\r\n\r\n  //nodes that are already added are missing component input/output ports if the component is registered after the nodes\r\n  //now when we have the component info, add them to the node instance models\r\n  this.getNodesWithType(component.name).forEach(this._addComponentPorts.bind(this));\r\n\r\n  //emit the \"nodeAdded\" event for every node already in the component\r\n  component.getAllNodes().forEach(this._onNodeAdded.bind(this));\r\n\r\n  //emit the same event for future nodes that will be added\r\n  component.on('nodeAdded', this._onNodeAdded.bind(this), this);\r\n\r\n  //and for nodes that are removed\r\n  component.on('nodeRemoved', this._onNodeRemoved.bind(this), this);\r\n  component.on('nodeWasRemoved', this._onNodeWasRemoved.bind(this), this);\r\n\r\n  this.emit('componentAdded', component);\r\n};\r\n\r\nGraphModel.prototype.removeComponentWithName = async function (componentName) {\r\n  if (this.components.hasOwnProperty(componentName) === false) {\r\n    console.error('GraphModel: Component with name ' + componentName + ' not in graph');\r\n    return;\r\n  }\r\n\r\n  var component = this.components[componentName];\r\n  await component.reset();\r\n\r\n  component.removeAllListeners();\r\n  delete this.components[component.name];\r\n\r\n  this.emit('componentRemoved', component);\r\n};\r\n\r\nGraphModel.prototype.renameComponent = function (componentName, newName) {\r\n  if (this.components.hasOwnProperty(componentName) === false) {\r\n    console.error('GraphModel: Component with name ' + componentName + ' not in graph');\r\n    return;\r\n  }\r\n\r\n  this.getNodesWithType(componentName).forEach(function (nodeModel) {\r\n    nodeModel.type = newName;\r\n  });\r\n\r\n  var component = this.components[componentName];\r\n  component.rename(newName);\r\n\r\n  delete this.components[componentName];\r\n  this.components[newName] = component;\r\n\r\n  this.emit('componentRenamed', component);\r\n};\r\n\r\nGraphModel.prototype._addComponentPorts = function (node) {\r\n  //check if this node is a known component and add port to the model\r\n  if (this.components.hasOwnProperty(node.type)) {\r\n    //a component was created, add component ports to model\r\n    var component = this.components[node.type];\r\n\r\n    const inputPorts = component.getInputPorts();\r\n    const outputPorts = component.getOutputPorts();\r\n\r\n    Object.keys(inputPorts).forEach((portName) => {\r\n      node.addInputPort(inputPorts[portName]);\r\n    });\r\n\r\n    Object.keys(outputPorts).forEach((portName) => {\r\n      node.addOutputPort(outputPorts[portName]);\r\n    });\r\n  }\r\n};\r\n\r\nGraphModel.prototype._onNodeAdded = function (node) {\r\n  this._addComponentPorts(node);\r\n\r\n  this.emit('nodeAdded', node);\r\n  this.emit('nodeAdded.' + node.type, node);\r\n};\r\n\r\nGraphModel.prototype._onNodeRemoved = function (node) {\r\n  this.emit('nodeRemoved', node);\r\n  this.emit('nodeRemoved.' + node.type, node);\r\n};\r\n\r\nGraphModel.prototype._onNodeWasRemoved = function (node) {\r\n  this.emit('nodeWasRemoved', node);\r\n  this.emit('nodeWasRemoved.' + node.type, node);\r\n};\r\n\r\nGraphModel.prototype.reset = async function () {\r\n  for (const componentName of Object.keys(this.components)) {\r\n    await this.removeComponentWithName(componentName);\r\n  }\r\n  this.setSettings({});\r\n};\r\n\r\nGraphModel.prototype.isEmpty = function () {\r\n  return Object.keys(this.components).length === 0;\r\n};\r\n\r\nGraphModel.prototype.setSettings = function (settings) {\r\n  this.settings = settings;\r\n  this.emit('projectSettingsChanged', settings);\r\n};\r\n\r\nGraphModel.prototype.getSettings = function () {\r\n  return this.settings;\r\n};\r\n\r\nGraphModel.prototype.setAllMetaData = function (metadata) {\r\n  for (const p in metadata) {\r\n    this.setMetaData(p, metadata[p]);\r\n  }\r\n};\r\n\r\nGraphModel.prototype.setMetaData = function (key, data) {\r\n  //metadata changes can trigger lots of ports to evaluate (e.g. when a database model has been changed)\r\n  //check if the data actually has been updated before since the editor can send the same data multiple times\r\n  if (this.metadata[key] && JSON.stringify(this.metadata[key]) === JSON.stringify(data)) {\r\n    return;\r\n  }\r\n\r\n  this.metadata[key] = data;\r\n  this.emit('metadataChanged', { key, data });\r\n  this.emit('metadataChanged.' + key, data);\r\n};\r\n\r\nGraphModel.prototype.getMetaData = function (key) {\r\n  if (key) return this.metadata[key];\r\n  return this.metadata;\r\n};\r\n\r\nGraphModel.prototype.getVariants = function () {\r\n  return this.variants || [];\r\n};\r\n\r\nGraphModel.prototype.getVariant = function (typename, name) {\r\n  return this.variants.find((v) => v.name === name && v.typename === typename);\r\n};\r\n\r\nGraphModel.prototype.updateVariant = function (variant) {\r\n  const i = this.variants.findIndex((v) => v.name === variant.name && v.typename === variant.typename);\r\n  if (i !== -1) this.variants.splice(i, 1);\r\n  this.variants.push(variant);\r\n\r\n  this.emit('variantUpdated', variant);\r\n};\r\n\r\nGraphModel.prototype.updateVariantParameter = function (\r\n  variantName,\r\n  variantTypeName,\r\n  parameterName,\r\n  parameterValue,\r\n  state\r\n) {\r\n  const variant = this.getVariant(variantTypeName, variantName);\r\n  if (!variant) {\r\n    console.log(\"updateVariantParameter: can't find variant\", variantName, variantTypeName);\r\n    return;\r\n  }\r\n\r\n  if (!state) {\r\n    if (parameterValue === undefined) {\r\n      delete variant.parameters[parameterName];\r\n    } else {\r\n      variant.parameters[parameterName] = parameterValue;\r\n    }\r\n  } else {\r\n    if (!variant.stateParameters.hasOwnProperty(state)) {\r\n      variant.stateParameters[state] = {};\r\n    }\r\n\r\n    if (parameterValue === undefined) {\r\n      delete variant.stateParameters[state][parameterName];\r\n    } else {\r\n      variant.stateParameters[state][parameterName] = parameterValue;\r\n    }\r\n  }\r\n\r\n  this.emit('variantUpdated', variant);\r\n};\r\n\r\nGraphModel.prototype.updateVariantDefaultStateTransition = function (variantName, variantTypeName, transition, state) {\r\n  const variant = this.getVariant(variantTypeName, variantName);\r\n  if (!variant) return;\r\n\r\n  variant.defaultStateTransitions[state] = transition;\r\n  this.emit('variantUpdated', variant);\r\n};\r\n\r\nGraphModel.prototype.updateVariantStateTransition = function (args) {\r\n  const { variantTypeName, variantName, state, parameterName, curve } = args;\r\n\r\n  const variant = this.getVariant(variantTypeName, variantName);\r\n  if (!variant) return;\r\n\r\n  if (!variant.stateTransitions[state]) {\r\n    variant.stateTransitions[state] = {};\r\n  }\r\n\r\n  variant.stateTransitions[state][parameterName] = curve;\r\n};\r\n\r\nGraphModel.prototype.deleteVariant = function (typename, name) {\r\n  const i = this.variants.findIndex((v) => v.name === name && v.typename === typename);\r\n  if (i !== -1) this.variants.splice(i, 1);\r\n};\r\n\r\nmodule.exports = GraphModel;\r\n","\"use strict\";\r\n\r\nvar EventSender = require('../eventsender');\r\n\r\nfunction NodeModel(id, type) {\r\n    EventSender.call(this);\r\n\r\n    this.id = id;\r\n    this.type = type;\r\n\r\n    this.inputs = [];\r\n    this.outputs = [];\r\n    this.children = [];\r\n    this.parameters = {};\r\n    this.inputPorts = {};\r\n    this.outputPorts = {};\r\n}\r\n\r\nNodeModel.prototype = Object.create(EventSender.prototype);\r\n\r\nNodeModel.prototype.setParameter = function(name, value, state) {\r\n    if(state) {\r\n        if(!this.stateParameters) this.stateParameters = {};\r\n        if(!this.stateParameters[state]) this.stateParameters[state] = {};\r\n\r\n        if(value === undefined) {\r\n            delete this.stateParameters[state][name];\r\n        }\r\n        else {\r\n            this.stateParameters[state][name] = value;\r\n        }\r\n    }\r\n    else {\r\n        if(value === undefined) {\r\n            delete this.parameters[name];\r\n        }\r\n        else {\r\n            this.parameters[name] = value;\r\n        }\r\n    }\r\n\r\n    this.emit(\"parameterUpdated\", {name, value, state});\r\n};\r\n\r\nNodeModel.prototype.setParameters = function(parameters) {\r\n    Object.keys(parameters).forEach(name => {\r\n        this.setParameter(name, parameters[name]);\r\n    });\r\n};\r\n\r\nNodeModel.prototype.setStateParameters = function(parameters) {\r\n   this.stateParameters = parameters;\r\n};\r\n\r\nNodeModel.prototype.setStateTransitions = function(stateTransitions) {\r\n    this.stateTransitions = stateTransitions;\r\n};\r\n\r\nNodeModel.prototype.setStateTransitionParamter = function(parameter, curve, state) {\r\n    if(!this.stateTransitions) {\r\n        this.stateTransitions = {};\r\n    }\r\n\r\n    if(curve) {\r\n        this.stateTransitions[state][parameter] = curve;\r\n    }\r\n    else {\r\n        delete this.stateTransitions[state][parameter];\r\n    }\r\n};\r\n\r\nNodeModel.prototype.setDefaultStateTransition = function(stateTransition, state) {\r\n    if(!this.defaultStateTransitions) {\r\n        this.defaultStateTransitions = {};\r\n    }\r\n    this.defaultStateTransitions[state] = stateTransition;\r\n};\r\n\r\nNodeModel.prototype.addInputPort = function(port) {\r\n    this.inputPorts[port.name] = port;\r\n    this.emit(\"inputPortAdded\", port);\r\n};\r\n\r\nNodeModel.prototype.getInputPort = function(portName) {\r\n    return this.inputPorts[portName];\r\n};\r\n\r\nNodeModel.prototype.getInputPorts = function() {\r\n    return this.inputPorts;\r\n};\r\n\r\nNodeModel.prototype.removeInputPortWithName = function(portName) {\r\n    if(this.inputPorts.hasOwnProperty(portName)) {\r\n        var port = this.inputPorts[portName];\r\n        delete this.inputPorts[portName];\r\n        this.emit(\"inputPortRemoved\", port);\r\n    }\r\n};\r\n\r\nNodeModel.prototype.updateInputPortTypes = function(ports) {\r\n    var changed = false;\r\n    for(var key in ports) {\r\n        if(this.inputPorts[key] !== undefined) {\r\n            this.inputPorts[key].type = ports[key].type;\r\n            changed = true;\r\n        }\r\n    }\r\n    changed && this.emit(\"inputPortTypesUpdated\");\r\n}\r\n\r\nNodeModel.prototype.addOutputPort = function(port) {\r\n    this.outputPorts[port.name] = port;\r\n    this.emit(\"outputPortAdded\", port);\r\n};\r\n\r\nNodeModel.prototype.getOutputPort = function(portName) {\r\n    return this.outputPorts[portName];\r\n};\r\n\r\nNodeModel.prototype.getOutputPorts = function() {\r\n    return this.outputPorts;\r\n};\r\n\r\nNodeModel.prototype.removeOutputPortWithName = function(portName) {\r\n    if(this.outputPorts.hasOwnProperty(portName)) {\r\n        var port = this.outputPorts[portName];\r\n        delete this.outputPorts[portName];\r\n        this.emit(\"outputPortRemoved\", port);\r\n    }\r\n};\r\n\r\nNodeModel.prototype.updateOutputPortTypes = function(ports) {\r\n    var changed = false;\r\n    for(var key in ports) {\r\n        if(this.outputPorts[key] !== undefined) {\r\n            this.outputPorts[key].type = ports[key].type;\r\n            changed = true;\r\n        }\r\n    }\r\n    changed && this.emit(\"outputPortTypesUpdated\");\r\n}\r\n\r\nNodeModel.prototype.addChild = function(child, index) {\r\n    child.parent = this;\r\n    if(index === undefined) {\r\n        this.children.push(child);\r\n    }\r\n    else {\r\n        this.children.splice(index, 0, child);\r\n    }\r\n    this.emit(\"childAdded\", child);\r\n};\r\n\r\nNodeModel.prototype.removeChild = function(child) {\r\n    child.parent = undefined;\r\n    var index = this.children.indexOf(child);\r\n    this.children.splice(index, 1);\r\n    this.emit(\"childRemoved\", child);\r\n};\r\n\r\nNodeModel.prototype.reset = function() {\r\n    this.removeAllListeners();\r\n};\r\n\r\nNodeModel.prototype.setVariant = function(variant) {\r\n    this.variant = variant;\r\n    this.emit(\"variantUpdated\", variant);\r\n};\r\n\r\nNodeModel.createFromExportData = function(nodeData) {\r\n    var node = new NodeModel(nodeData.id, nodeData.type);\r\n    nodeData.parameters && node.setParameters(nodeData.parameters);\r\n    nodeData.stateParameters && node.setStateParameters(nodeData.stateParameters);\r\n    nodeData.stateTransitions && node.setStateTransitions(nodeData.stateTransitions);\r\n    \r\n    if(nodeData.defaultStateTransitions) {\r\n        for(const state in nodeData.defaultStateTransitions) {\r\n            node.setDefaultStateTransition(nodeData.defaultStateTransitions[state], state);\r\n        }\r\n    }\r\n    \r\n    nodeData.ports && nodeData.ports.forEach(function(port) {\r\n\r\n        //some ports are incorrectly named outputs instead of output, patch it here so\r\n        //the rest of the code doesn't need to care\r\n        if(port.plug === \"outputs\") {\r\n          port.plug = \"output\";\r\n        }\r\n\r\n        if(port.plug === \"input\" || port.plug === \"input/output\") {\r\n            node.addInputPort(port);\r\n        }\r\n        if(port.plug === \"output\" || port.plug === \"input/output\") {\r\n            node.addOutputPort(port);\r\n        }\r\n    });\r\n\r\n    nodeData.variant && node.setVariant(nodeData.variant);\r\n\r\n    return node;\r\n};\r\n\r\nmodule.exports = NodeModel;","const OutputProperty = require('./outputproperty');\r\n\r\n/**\r\n * Base class for all Nodes\r\n * @constructor\r\n */\r\nfunction Node(context, id) {\r\n  this.id = id;\r\n  this.context = context;\r\n  this._dirty = false;\r\n\r\n  this._inputs = {};\r\n  this._inputValues = {};\r\n  this._outputs = {};\r\n\r\n  this._inputConnections = {};\r\n  this._outputList = [];\r\n  this._isUpdating = false;\r\n  this._inputValuesQueue = {};\r\n  this._afterInputsHaveUpdatedCallbacks = [];\r\n\r\n  this._internal = {};\r\n  this._signalsSentThisUpdate = {};\r\n\r\n  this._deleted = false;\r\n  this._deleteListeners = [];\r\n  this._isFirstUpdate = true;\r\n\r\n  this._valuesFromConnections = {};\r\n  this.updateOnDirtyFlagging = true;\r\n}\r\n\r\nNode.prototype.getInputValue = function (name) {\r\n  return this._inputValues[name];\r\n};\r\n\r\nNode.prototype.registerInput = function (name, input) {\r\n  if (this.hasInput(name)) {\r\n    throw new Error('Input property ' + name + ' already registered');\r\n  }\r\n\r\n  this._inputs[name] = input;\r\n\r\n  if (input.type && input.type.units) {\r\n    const defaultUnit = input.type.defaultUnit || input.type.units[0];\r\n    this._inputValues[name] = {\r\n      value: input.default,\r\n      type: defaultUnit\r\n    };\r\n  } else if (input.hasOwnProperty('default')) {\r\n    this._inputValues[name] = input.default;\r\n  }\r\n};\r\n\r\nNode.prototype.deregisterInput = function (name) {\r\n  if (this.hasInput(name) === false) {\r\n    throw new Error('Input property ' + name + \" doesn't exist\");\r\n  }\r\n  delete this._inputs[name];\r\n  delete this._inputValues[name];\r\n};\r\n\r\nNode.prototype.registerInputs = function (inputs) {\r\n  for (const name in inputs) {\r\n    this.registerInput(name, inputs[name]);\r\n  }\r\n};\r\n\r\nNode.prototype.getInput = function (name) {\r\n  if (this.hasInput(name) === false) {\r\n    console.log('Node ' + this.name + ': Invalid input property ' + name);\r\n    return undefined;\r\n  }\r\n\r\n  return this._inputs[name];\r\n};\r\n\r\nNode.prototype.hasInput = function (name) {\r\n  return name in this._inputs;\r\n};\r\n\r\nNode.prototype.registerInputIfNeeded = function () {\r\n  //noop, can be overriden by subclasses\r\n};\r\n\r\nNode.prototype.setInputValue = function (name, value) {\r\n  const input = this.getInput(name);\r\n  if (!input) {\r\n    console.log(\"node doesn't have input\", name);\r\n    return;\r\n  }\r\n\r\n  //inputs with units always expect objects in the shape of {value, unit, ...}\r\n  //these inputs might sometimes get raw numbers without units, and in those cases\r\n  //Noodl should just update the value and not the other parameters\r\n  const currentInputValue = this._inputValues[name];\r\n\r\n  if (isNaN(value) === false && currentInputValue && currentInputValue.unit) {\r\n    //update the value, and keep the other parameters\r\n    const newValue = Object.assign({}, currentInputValue); //copy it, so we don't modify the original object (e.g. it might come from a variant)\r\n    newValue.value = value;\r\n    value = newValue;\r\n  }\r\n\r\n  //Save the current input value. Save it before resolving color styles so delta updates on color styles work correctly\r\n  this._inputValues[name] = value;\r\n\r\n  if (input.type === 'color' && this.context && this.context.styles) {\r\n    value = this.context.styles.resolveColor(value);\r\n  } else if (input.type === 'array' && typeof value === 'string') {\r\n    try {\r\n      value = eval(value);\r\n      this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'invalid-array-' + name);\r\n    } catch (e) {\r\n      value = [];\r\n      console.log(e);\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          'invalid-array-' + name,\r\n          {\r\n            showGlobally: true,\r\n            message: 'Invalid array<br>' + e.toString()\r\n          }\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  input.set.call(this, value);\r\n};\r\n\r\nNode.prototype.hasOutput = function (name) {\r\n  return name in this._outputs;\r\n};\r\n\r\nNode.prototype.registerOutput = function (name, output) {\r\n  if (this.hasOutput(name)) {\r\n    throw new Error('Output property ' + name + ' already registered');\r\n  }\r\n\r\n  const newOutput = new OutputProperty({\r\n    owner: this,\r\n    getter: output.get || output.getter,\r\n    name: name,\r\n    onFirstConnectionAdded: output.onFirstConnectionAdded,\r\n    onLastConnectionRemoved: output.onLastConnectionRemoved\r\n  });\r\n\r\n  this._outputs[name] = newOutput;\r\n  this._outputList.push(newOutput);\r\n};\r\n\r\nNode.prototype.deregisterOutput = function (name) {\r\n  if (this.hasOutput(name) === false) {\r\n    throw new Error('Output property ' + name + \" isn't registered\");\r\n  }\r\n\r\n  const output = this._outputs[name];\r\n\r\n  if (output.hasConnections()) {\r\n    throw new Error('Output property ' + name + \" has connections and can't be removed\");\r\n  }\r\n\r\n  delete this._outputs[name];\r\n  var index = this._outputList.indexOf(output);\r\n  this._outputList.splice(index, 1);\r\n};\r\n\r\nNode.prototype.registerOutputs = function (outputs) {\r\n  for (var name in outputs) {\r\n    this.registerOutput(name, outputs[name]);\r\n  }\r\n};\r\n\r\nNode.prototype.registerOutputIfNeeded = function () {\r\n  //noop, can be overriden by subclasses\r\n};\r\n\r\nNode.prototype.getOutput = function (name) {\r\n  if (this.hasOutput(name) === false) {\r\n    throw new Error('Node ' + this.name + \" doesn't have a port named \" + name);\r\n  }\r\n  return this._outputs[name];\r\n};\r\n\r\nNode.prototype.connectInput = function (inputName, sourceNode, sourcePortName) {\r\n  if (this.hasInput(inputName) === false) {\r\n    throw new Error(\r\n      \"Invalid connection, input doesn't exist. Trying to connect from \" +\r\n        sourceNode.name +\r\n        ' output ' +\r\n        sourcePortName +\r\n        ' to ' +\r\n        this.name +\r\n        ' input ' +\r\n        inputName\r\n    );\r\n  }\r\n\r\n  var sourcePort = sourceNode.getOutput(sourcePortName);\r\n  sourcePort.registerConnection(this, inputName);\r\n\r\n  if (!this._inputConnections[inputName]) {\r\n    this._inputConnections[inputName] = [];\r\n  }\r\n\r\n  this._inputConnections[inputName].push(sourcePort);\r\n\r\n  if (sourceNode._signalsSentThisUpdate[sourcePortName]) {\r\n    this._setValueFromConnection(inputName, true);\r\n    this._setValueFromConnection(inputName, false);\r\n  } else {\r\n    var outputValue = sourcePort.value;\r\n    if (outputValue !== undefined) {\r\n      this._setValueFromConnection(inputName, outputValue);\r\n\r\n      if (this.context) {\r\n        // Send value to editor for connection debugging.\r\n        // Conceptually the value has already been sent,\r\n        // but the editor needs to be notified after a connection is created\r\n        this.context.connectionSentValue(sourcePort, sourcePort.value);\r\n      }\r\n    }\r\n  }\r\n\r\n  this.flagDirty();\r\n};\r\n\r\nNode.prototype.removeInputConnection = function (inputName, sourceNodeId, sourcePortName) {\r\n  if (!this._inputConnections[inputName]) {\r\n    throw new Error(\"Node removeInputConnection: Input doesn't exist\");\r\n  }\r\n\r\n  const inputsToPort = this._inputConnections[inputName];\r\n\r\n  for (let i = 0; i < inputsToPort.length; i++) {\r\n    const sourcePort = inputsToPort[i];\r\n    if (sourcePort.owner.id === sourceNodeId && sourcePort.name === sourcePortName) {\r\n      inputsToPort.splice(i, 1);\r\n\r\n      //remove the output from the source node\r\n      const output = sourcePort.owner.getOutput(sourcePortName);\r\n      output.deregisterConnection(this, inputName);\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (inputsToPort.length === 0) {\r\n    //no inputs left, remove the bookkeeping that traces values sent to this node as inputs\r\n    delete this._valuesFromConnections[inputName];\r\n  }\r\n};\r\n\r\nNode.prototype.isInputConnected = function (inputName) {\r\n  if (!this._inputConnections.hasOwnProperty(inputName)) {\r\n    return false;\r\n  }\r\n\r\n  //We have connections, but they might be from non-connected component inputs.\r\n  // If they are from a component input then check the input on the component instance.\r\n  return this._inputConnections[inputName].some((c) => {\r\n    //if this is not a component input, then we have a proper connection\r\n    if (c.owner.name !== 'Component Inputs') return true;\r\n\r\n    //the name of the output from the component input, is the same as the component instance input\r\n    const component = c.owner.nodeScope.componentOwner;\r\n    return component.isInputConnected(c.name);\r\n  });\r\n};\r\n\r\nNode.prototype.update = function () {\r\n  if (this._isUpdating || this._dirty === false) {\r\n    return;\r\n  }\r\n\r\n  if (this._updatedAtIteration !== this.context.updateIteration) {\r\n    this._updatedAtIteration = this.context.updateIteration;\r\n    this._updateIteration = 0;\r\n    if (this._cyclicLoop) this._cyclicLoop = false;\r\n  }\r\n\r\n  this._isUpdating = true;\r\n  const maxUpdateIterations = 100;\r\n\r\n  try {\r\n    while (this._dirty && !this._cyclicLoop) {\r\n      this._updateDependencies();\r\n\r\n      //all inputs are now updated, flag as not dirty\r\n      this._dirty = false;\r\n\r\n      const inputNames = Object.keys(this._inputValuesQueue);\r\n\r\n      let hasMoreInputs = true;\r\n\r\n      while (hasMoreInputs && !this._cyclicLoop) {\r\n        hasMoreInputs = false;\r\n\r\n        for (let i = 0; i < inputNames.length; i++) {\r\n          const inputName = inputNames[i];\r\n          const queue = this._inputValuesQueue[inputName];\r\n          if (queue.length > 0) {\r\n            this.setInputValue(inputName, queue.shift());\r\n            if (queue.length > 0) {\r\n              hasMoreInputs = true;\r\n            }\r\n          }\r\n        }\r\n\r\n        const afterInputCallbacks = this._afterInputsHaveUpdatedCallbacks;\r\n        this._afterInputsHaveUpdatedCallbacks = [];\r\n        for (let i = 0; i < afterInputCallbacks.length; i++) {\r\n          afterInputCallbacks[i].call(this);\r\n        }\r\n      }\r\n      this._updateIteration++;\r\n\r\n      if (this._updateIteration >= maxUpdateIterations) {\r\n        this._cyclicLoop = true;\r\n      }\r\n    }\r\n  } catch (e) {\r\n    this._isUpdating = false;\r\n    throw e;\r\n  }\r\n\r\n  if (this._cyclicLoop) {\r\n    //flag the node as dirty again to let it contiune next frame so we don't just stop it\r\n    //This will allow the browser a chance to render and run other code\r\n    this.context.scheduleNextFrame(() => {\r\n      this.context.nodeIsDirty(this);\r\n    });\r\n\r\n    if (this.context.editorConnection && !this._cyclicWarningSent && this.context.isWarningTypeEnabled('cyclicLoops')) {\r\n      this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'cyclic-loop', {\r\n        showGlobally: true,\r\n        message: 'Cyclic loop detected'\r\n      });\r\n      this._cyclicWarningSent = true;\r\n      console.log('cycle detected', {\r\n        id: this.id,\r\n        name: this.name,\r\n        component: this.nodeScope.componentOwner.name\r\n      });\r\n    }\r\n  }\r\n\r\n  this._isFirstUpdate = false;\r\n  this._isUpdating = false;\r\n};\r\n\r\nNode.prototype._updateDependencies = function () {\r\n  for (var inputName in this._inputConnections) {\r\n    var connectedPorts = this._inputConnections[inputName];\r\n    for (var i = 0; i < connectedPorts.length; ++i) {\r\n      connectedPorts[i].owner.update();\r\n    }\r\n  }\r\n};\r\n\r\nNode.prototype.flagDirty = function () {\r\n  if (this._dirty) {\r\n    return;\r\n  }\r\n\r\n  this._dirty = true;\r\n\r\n  //a hack to not update nodes as a component is being created.\r\n  //Nodes should update once all connections are in place, so inputs that rely on connections, e.g. \"Run\" on a Function node, have the correct context before running.\r\n  //This flag is being updated externally by the NodeScope and _performDirtyUpdate will be called when the component setup is done\r\n  if (this.updateOnDirtyFlagging) {\r\n    this._performDirtyUpdate();\r\n  }\r\n};\r\n\r\nNode.prototype._performDirtyUpdate = function () {\r\n  this.context && this.context.nodeIsDirty(this);\r\n\r\n  for (var i = 0; i < this._outputList.length; ++i) {\r\n    this._outputList[i].flagDependeesDirty();\r\n  }\r\n};\r\n\r\nNode.prototype.sendValue = function (name, value) {\r\n  if (this.hasOutput(name) === false) {\r\n    console.log('Error: Node', this.name, \"doesn't have a output named\", name);\r\n    return;\r\n  }\r\n\r\n  if (value === undefined) {\r\n    return;\r\n  }\r\n\r\n  const output = this.getOutput(name);\r\n  output.sendValue(value);\r\n\r\n  if (this.context) {\r\n    this.context.connectionSentValue(output, value);\r\n  }\r\n};\r\n\r\nNode.prototype.flagOutputDirty = function (name) {\r\n  const output = this.getOutput(name);\r\n  this.sendValue(name, output.value);\r\n};\r\n\r\nNode.prototype.flagAllOutputsDirty = function () {\r\n  for (const output of this._outputList) {\r\n    this.sendValue(output.name, output.value);\r\n  }\r\n};\r\n\r\nNode.prototype.sendSignalOnOutput = function (outputName) {\r\n  if (this.hasOutput(outputName) === false) {\r\n    console.log('Error: Node', this.name, \"doesn't have a output named\", outputName);\r\n    return;\r\n  }\r\n\r\n  const output = this.getOutput(outputName);\r\n  output.sendValue(true);\r\n  output.sendValue(false);\r\n\r\n  this._signalsSentThisUpdate[outputName] = true;\r\n  this.scheduleAfterInputsHaveUpdated(function () {\r\n    this._signalsSentThisUpdate[outputName] = false;\r\n  });\r\n\r\n  if (this.context) {\r\n    this.context.connectionSentSignal(output);\r\n  }\r\n};\r\n\r\nNode.prototype._setValueFromConnection = function (inputName, value) {\r\n  this._valuesFromConnections[inputName] = value;\r\n  this.queueInput(inputName, value);\r\n};\r\n\r\nNode.prototype._hasInputBeenSetFromAConnection = function (inputName) {\r\n  return this._valuesFromConnections.hasOwnProperty(inputName);\r\n};\r\n\r\nNode.prototype.queueInput = function (inputName, value) {\r\n  if (!this._inputValuesQueue[inputName]) {\r\n    this._inputValuesQueue[inputName] = [];\r\n  }\r\n\r\n  //when values are queued during the very first update, make the last value overwrite previous ones\r\n  //so a chain with multiple nodes with values that connect to each other all\r\n  //consolidate to a single value, instead of piling up in the queue\r\n  if (this._isFirstUpdate) {\r\n    //signals need two values, so make sure we don't suppress the 'false' that comes directly\r\n    //after a 'true'\r\n    const queueValue = this._inputValuesQueue[inputName][0];\r\n    const isSignal = queueValue === true; // && value === true;\r\n    if (!isSignal) {\r\n      //default units are set as an object {value, unit}\r\n      //subsequent inputs can be unitless. and will will then overwrite those\r\n      //and the node will get a value without ever getting a unit.\r\n      //To make sure that doesn't happen, look at the value being overwritten\r\n      //and use the unit from that before overwriting\r\n      if (queueValue instanceof Object && queueValue.unit && value instanceof Object === false) {\r\n        value = {\r\n          value,\r\n          unit: queueValue.unit\r\n        };\r\n      }\r\n\r\n      this._inputValuesQueue[inputName].length = 0;\r\n    }\r\n  }\r\n\r\n  this._inputValuesQueue[inputName].push(value);\r\n  this.flagDirty();\r\n};\r\n\r\nNode.prototype.scheduleAfterInputsHaveUpdated = function (callback) {\r\n  this._afterInputsHaveUpdatedCallbacks.push(callback);\r\n  this.flagDirty();\r\n};\r\n\r\nNode.prototype.setNodeModel = function (nodeModel) {\r\n  this.model = nodeModel;\r\n  nodeModel.on('parameterUpdated', this._onNodeModelParameterUpdated, this);\r\n  nodeModel.on('variantUpdated', this._onNodeModelVariantUpdated, this);\r\n\r\n  nodeModel.on(\r\n    'inputPortRemoved',\r\n    (port) => {\r\n      if (this.hasInput(port.name)) {\r\n        this.deregisterInput(port.name);\r\n      }\r\n    },\r\n    this\r\n  );\r\n\r\n  nodeModel.on(\r\n    'outputPortRemoved',\r\n    (port) => {\r\n      if (this.hasOutput(port.name)) {\r\n        this.deregisterOutput(port.name);\r\n      }\r\n    },\r\n    this\r\n  );\r\n};\r\n\r\nNode.prototype.addDeleteListener = function (listener) {\r\n  this._deleteListeners.push(listener);\r\n};\r\n\r\nNode.prototype._onNodeDeleted = function () {\r\n  if (this.model) {\r\n    this.model.removeListenersWithRef(this);\r\n    this.model = undefined;\r\n  }\r\n\r\n  this._deleted = true;\r\n\r\n  for (const deleteListener of this._deleteListeners) {\r\n    deleteListener.call(this);\r\n  }\r\n};\r\n\r\nNode.prototype._onNodeModelParameterUpdated = function (event) {\r\n  this.registerInputIfNeeded(event.name);\r\n\r\n  if (event.value !== undefined) {\r\n    if (event.state) {\r\n      //this parameter is only used in a certain visual state\r\n      //make sure we are in that state before setting it\r\n\r\n      if (!this._getVisualStates) {\r\n        console.log('Node has nos visual states, but got a parameter for state', event.state);\r\n        return;\r\n      }\r\n\r\n      const states = this._getVisualStates();\r\n      if (states.indexOf(event.state) !== -1) {\r\n        this.queueInput(event.name, event.value);\r\n      }\r\n    } else {\r\n      this.queueInput(event.name, event.value);\r\n    }\r\n  } else {\r\n    //parameter is undefined, that means it has been removed and we should reset to default\r\n    let defaultValue;\r\n\r\n    const variant = this.variant;\r\n\r\n    if (event.state) {\r\n      //local value has been reset, check the variant first\r\n      if (\r\n        variant &&\r\n        variant.stateParameters.hasOwnProperty(event.state) &&\r\n        variant.stateParameters[event.state].hasOwnProperty(event.name)\r\n      ) {\r\n        defaultValue = variant.stateParameters[event.state][event.name];\r\n      }\r\n      //and if variant has no value in that state, check for local values in the neutral state\r\n      else if (this.model.parameters.hasOwnProperty(event.name)) {\r\n        defaultValue = this.model.parameters[event.name];\r\n      }\r\n      //and then look in the variant neutral values\r\n      else if (variant && variant.parameters.hasOwnProperty(event.name)) {\r\n        defaultValue = variant.parameters[event.name];\r\n      }\r\n    } else if (variant && variant.parameters.hasOwnProperty(event.name)) {\r\n      defaultValue = variant.parameters[event.name];\r\n    }\r\n\r\n    if (defaultValue === undefined) {\r\n      //get the default value for the port\r\n      defaultValue = this.context.getDefaultValueForInput(this.model.type, event.name);\r\n\r\n      //when a paramter that's used by a text style is reset, Noodl will modify the original dom node, outside of React\r\n      //React will then re-render, and should apply the values from the text style, but won't see any delta in the virtual dom,\r\n      //even though there is a diff to the real dom.\r\n      //to fix that, we just force React to re-render the entire node\r\n      this._resetReactVirtualDOM && this._resetReactVirtualDOM();\r\n    }\r\n\r\n    this.queueInput(event.name, defaultValue);\r\n  }\r\n};\r\n\r\nNode.prototype._onNodeModelVariantUpdated = function (variant) {\r\n  this.setVariant(variant);\r\n};\r\n\r\nmodule.exports = Node;\r\n","'use strict';\r\n\r\nvar EventEmitter = require('./events');\r\nvar NodeRegister = require('./noderegister');\r\nvar TimerScheduler = require('./timerscheduler');\r\nconst Variants = require('./variants');\r\n\r\nfunction NodeContext(args) {\r\n  args = args || {};\r\n  args.runningInEditor = args.hasOwnProperty('runningInEditor') ? args.runningInEditor : false;\r\n\r\n  this._dirtyNodes = [];\r\n  this.callbacksAfterUpdate = [];\r\n\r\n  this.graphModel = args.graphModel;\r\n\r\n  this.platform = args.platform;\r\n\r\n  this.eventEmitter = new EventEmitter();\r\n  this.eventEmitter.setMaxListeners(1000000);\r\n\r\n  this.eventSenderEmitter = new EventEmitter(); //used by event senders and receivers\r\n  this.eventSenderEmitter.setMaxListeners(1000000);\r\n\r\n  this.globalValues = {};\r\n  this.globalsEventEmitter = new EventEmitter();\r\n  this.globalsEventEmitter.setMaxListeners(1000000);\r\n\r\n  this.runningInEditor = args.runningInEditor;\r\n  this.currentFrameTime = 0;\r\n  this.frameNumber = 0;\r\n  this.updateIteration = 0;\r\n\r\n  this.nodeRegister = new NodeRegister(this);\r\n  this.timerScheduler = new TimerScheduler(this.scheduleUpdate.bind(this));\r\n\r\n  this.componentModels = {};\r\n  this.debugInspectorsEnabled = false;\r\n  this.connectionsToPulse = {};\r\n  this.connectionsToPulseChanged = false;\r\n\r\n  this.debugInspectors = {};\r\n\r\n  this.connectionPulsingCallbackScheduled = false;\r\n\r\n  this.editorConnection = args.editorConnection;\r\n\r\n  this.rootComponent = undefined;\r\n\r\n  this._outputHistory = {};\r\n  this._signalHistory = {};\r\n\r\n  this.warningTypes = {}; //default is to send all warning types\r\n\r\n  this.bundleFetchesInFlight = new Map();\r\n\r\n  this.variants = new Variants({\r\n    graphModel: this.graphModel,\r\n    getNodeScope: () => (this.rootComponent ? this.rootComponent.nodeScope : null)\r\n  });\r\n\r\n  if (this.editorConnection) {\r\n    this.editorConnection.on('debugInspectorsUpdated', (inspectors) => {\r\n      this.onDebugInspectorsUpdated(inspectors);\r\n    });\r\n\r\n    this.editorConnection.on('getConnectionValue', ({ clientId, connectionId }) => {\r\n      if (this.editorConnection.clientId !== clientId) return;\r\n      const connection = this._outputHistory[connectionId];\r\n      this.editorConnection.sendConnectionValue(connectionId, connection ? connection.value : undefined);\r\n    });\r\n  }\r\n}\r\n\r\nNodeContext.prototype.setRootComponent = function (rootComponent) {\r\n  this.rootComponent = rootComponent;\r\n};\r\n\r\nNodeContext.prototype.getCurrentTime = function () {\r\n  return this.platform.getCurrentTime();\r\n};\r\n\r\nNodeContext.prototype.onDebugInspectorsUpdated = function (inspectors) {\r\n  if (!this.debugInspectorsEnabled) return;\r\n\r\n  inspectors = inspectors.map((inspector) => {\r\n    if (inspector.type === 'connection') {\r\n      const connection = inspector.connection;\r\n      inspector.id = connection.fromId + connection.fromProperty;\r\n    } else if (inspector.type === 'node') {\r\n      inspector.id = inspector.nodeId;\r\n    }\r\n    return inspector;\r\n  });\r\n\r\n  this.debugInspectors = {};\r\n  inspectors.forEach((inspector) => (this.debugInspectors[inspector.id] = inspector));\r\n\r\n  this.sendDebugInspectorValues();\r\n};\r\n\r\nNodeContext.prototype.updateDirtyNodes = function () {\r\n  var i, len;\r\n\r\n  var loop = true,\r\n    iterations = 0;\r\n\r\n  this.updateIteration++;\r\n\r\n  this.isUpdating = true;\r\n\r\n  while (loop && iterations < 10) {\r\n    var dirtyNodes = this._dirtyNodes;\r\n    this._dirtyNodes = [];\r\n    for (i = 0, len = dirtyNodes.length; i < len; ++i) {\r\n      try {\r\n        if (!dirtyNodes[i]._deleted) {\r\n          dirtyNodes[i].update();\r\n        }\r\n      } catch (e) {\r\n        console.error(e, e.stack);\r\n      }\r\n    }\r\n\r\n    //make a new reference and reset array in case new callbacks are scheduled\r\n    //by the current callbacks\r\n    var callbacks = this.callbacksAfterUpdate;\r\n    this.callbacksAfterUpdate = [];\r\n    for (i = 0, len = callbacks.length; i < len; i++) {\r\n      try {\r\n        callbacks[i]();\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    }\r\n\r\n    loop = this.callbacksAfterUpdate.length > 0 || this._dirtyNodes.length > 0;\r\n    iterations++;\r\n  }\r\n\r\n  this.isUpdating = false;\r\n};\r\n\r\nNodeContext.prototype.update = function () {\r\n  this.frameNumber++;\r\n\r\n  this.updateDirtyNodes();\r\n\r\n  if (this.timerScheduler.hasPendingTimers()) {\r\n    this.scheduleUpdate();\r\n    this.timerScheduler.runTimers(this.currentFrameTime);\r\n  }\r\n\r\n  if (this.debugInspectorsEnabled) {\r\n    this.sendDebugInspectorValues();\r\n  }\r\n};\r\n\r\nNodeContext.prototype.reset = function () {\r\n  //removes listeners like device orientation, websockets and more\r\n  this.eventEmitter.emit('applicationDataReloaded');\r\n\r\n  var eventEmitter = this.eventEmitter;\r\n  ['frameStart', 'frameEnd'].forEach(function (name) {\r\n    eventEmitter.removeAllListeners(name);\r\n  });\r\n\r\n  this.globalValues = {};\r\n  this._dirtyNodes.length = 0;\r\n  this.callbacksAfterUpdate.length = 0;\r\n\r\n  this.timerScheduler.runningTimers = [];\r\n  this.timerScheduler.newTimers = [];\r\n  this.rootComponent = undefined;\r\n\r\n  this.clearDebugInspectors();\r\n};\r\n\r\nNodeContext.prototype.nodeIsDirty = function (node) {\r\n  this._dirtyNodes.push(node);\r\n  this.scheduleUpdate();\r\n};\r\n\r\nNodeContext.prototype.scheduleUpdate = function () {\r\n  this.eventEmitter.emit('scheduleUpdate');\r\n};\r\n\r\nNodeContext.prototype.scheduleAfterUpdate = function (func) {\r\n  this.callbacksAfterUpdate.push(func);\r\n  this.scheduleUpdate();\r\n};\r\n\r\nNodeContext.prototype.scheduleNextFrame = function (func) {\r\n  this.eventEmitter.once('frameStart', func);\r\n  this.scheduleUpdate();\r\n};\r\n\r\nNodeContext.prototype.setGlobalValue = function (name, value) {\r\n  this.globalValues[name] = value;\r\n  this.globalsEventEmitter.emit(name);\r\n};\r\n\r\nNodeContext.prototype.getGlobalValue = function (name) {\r\n  return this.globalValues[name];\r\n};\r\n\r\nNodeContext.prototype.registerComponentModel = function (componentModel) {\r\n  if (this.componentModels.hasOwnProperty(componentModel.name)) {\r\n    throw new Error('Duplicate component name ' + componentModel.name);\r\n  }\r\n  this.componentModels[componentModel.name] = componentModel;\r\n\r\n  var self = this;\r\n  componentModel.on(\r\n    'renamed',\r\n    function (event) {\r\n      delete self.componentModels[event.oldName];\r\n      self.componentModels[event.newName] = componentModel;\r\n    },\r\n    this\r\n  );\r\n};\r\n\r\nNodeContext.prototype.deregisterComponentModel = function (componentModel) {\r\n  if (this.componentModels.hasOwnProperty(componentModel.name)) {\r\n    this.componentModels[componentModel.name].removeListenersWithRef(this);\r\n    delete this.componentModels[componentModel.name];\r\n  }\r\n};\r\n\r\nNodeContext.prototype.fetchComponentBundle = async function (name) {\r\n  const fetchBundle = async (name) => {\r\n    let baseUrl = Noodl.Env['BaseUrl'] || '/';\r\n    let bundleUrl = `${baseUrl}noodl_bundles/${name}.json`;\r\n\r\n    const response = await fetch(bundleUrl);\r\n    if (response.status === 404) {\r\n      throw new Error('Component not found ' + name);\r\n    }\r\n\r\n    const data = await response.json();\r\n    for (const component of data) {\r\n      if (this.graphModel.hasComponentWithName(component.name) === false) {\r\n        await this.graphModel.importComponentFromEditorData(component);\r\n      }\r\n    }\r\n  };\r\n\r\n  if (this.bundleFetchesInFlight.has(name)) {\r\n    await this.bundleFetchesInFlight.get(name);\r\n  } else {\r\n    const promise = fetchBundle(name);\r\n    this.bundleFetchesInFlight.set(name, promise);\r\n    await promise;\r\n    //the promise is kept in bundleFetchesInFlight to mark what bundles have been downloaded\r\n    //so eventual future requests will just await the resolved promise and resolve immediately\r\n  }\r\n};\r\n\r\nNodeContext.prototype.getComponentModel = async function (name) {\r\n  if (!name) {\r\n    throw new Error('Component instance must have a name');\r\n  }\r\n\r\n  if (this.componentModels.hasOwnProperty(name) === false) {\r\n    const bundleName = this.graphModel.getBundleContainingComponent(name);\r\n    if (!bundleName) {\r\n      throw new Error(\"Can't find component model for \" + name);\r\n    }\r\n\r\n    //start fetching dependencies in the background\r\n    for (const bundleDep of this.graphModel.getBundleDependencies(bundleName)) {\r\n      this.fetchComponentBundle(bundleDep);\r\n    }\r\n\r\n    //and wait for the bundle that has the component we need\r\n    await this.fetchComponentBundle(bundleName);\r\n  }\r\n\r\n  return this.componentModels[name];\r\n};\r\n\r\nNodeContext.prototype.hasComponentModelWithName = function (name) {\r\n  return this.componentModels.hasOwnProperty(name);\r\n};\r\n\r\nNodeContext.prototype.createComponentInstanceNode = async function (componentName, id, nodeScope, extraProps) {\r\n  var ComponentInstanceNode = require('./nodes/componentinstance');\r\n  var node = new ComponentInstanceNode(this, id, nodeScope);\r\n  node.name = componentName;\r\n\r\n  for (const prop in extraProps) {\r\n    node[prop] = extraProps[prop];\r\n  }\r\n\r\n  const componentModel = await this.getComponentModel(componentName);\r\n  await node.setComponentModel(componentModel);\r\n\r\n  return node;\r\n};\r\n\r\nNodeContext.prototype._formatConnectionValue = function (value) {\r\n  if (typeof value === 'object' && value && value.constructor && value.constructor.name === 'Node') {\r\n    value = '<Node> ' + value.name;\r\n  } else if (typeof value === 'object' && typeof window !== 'undefined' && value instanceof HTMLElement) {\r\n    value = `DOM Node <${value.tagName}>`;\r\n  } else if (typeof value === 'string' && !value.startsWith('[Signal]')) {\r\n    return '\"' + value + '\"';\r\n  } else if (Number.isNaN(value)) {\r\n    return 'NaN';\r\n  }\r\n\r\n  return value;\r\n};\r\n\r\nNodeContext.prototype.connectionSentValue = function (output, value) {\r\n  if (!this.editorConnection || !this.editorConnection.isConnected() || !this.debugInspectorsEnabled) {\r\n    return;\r\n  }\r\n\r\n  const timestamp = this.getCurrentTime();\r\n\r\n  this._outputHistory[output.id] = {\r\n    value,\r\n    timestamp\r\n  };\r\n\r\n  if (this.connectionsToPulse.hasOwnProperty(output.id)) {\r\n    this.connectionsToPulse[output.id].timestamp = timestamp;\r\n    return;\r\n  }\r\n\r\n  const connections = [];\r\n\r\n  output.connections.forEach((connection) => {\r\n    connections.push(output.owner.id + output.name + connection.node.id + connection.inputPortName);\r\n  });\r\n\r\n  this.connectionsToPulse[output.id] = {\r\n    timestamp,\r\n    connections: connections\r\n  };\r\n\r\n  this.connectionsToPulseChanged = true;\r\n\r\n  if (this.connectionPulsingCallbackScheduled === false) {\r\n    this.connectionPulsingCallbackScheduled = true;\r\n    setTimeout(this.clearOldConnectionPulsing.bind(this), 100);\r\n  }\r\n};\r\n\r\nNodeContext.prototype.connectionSentSignal = function (output) {\r\n  const id = output.id;\r\n  if (!this._signalHistory.hasOwnProperty(id)) {\r\n    this._signalHistory[id] = {\r\n      count: 0\r\n    };\r\n  }\r\n\r\n  this._signalHistory[id].count++;\r\n\r\n  this.connectionSentValue(output, '[Signal] Trigger count ' + this._signalHistory[id].count);\r\n};\r\n\r\nNodeContext.prototype.clearDebugInspectors = function () {\r\n  this.debugInspectors = {};\r\n  this.connectionsToPulse = {};\r\n\r\n  this.editorConnection.sendPulsingConnections(this.connectionsToPulse);\r\n};\r\n\r\nNodeContext.prototype.clearOldConnectionPulsing = function () {\r\n  this.connectionPulsingCallbackScheduled = false;\r\n\r\n  var now = this.getCurrentTime();\r\n  var self = this;\r\n\r\n  var connectionIds = Object.keys(this.connectionsToPulse);\r\n  connectionIds.forEach(function (id) {\r\n    var con = self.connectionsToPulse[id];\r\n    if (now - con.timestamp > 100) {\r\n      self.connectionsToPulseChanged = true;\r\n      delete self.connectionsToPulse[id];\r\n    }\r\n  });\r\n\r\n  if (this.connectionsToPulseChanged) {\r\n    this.connectionsToPulseChanged = false;\r\n    this.editorConnection.sendPulsingConnections(this.connectionsToPulse);\r\n  }\r\n\r\n  if (Object.keys(this.connectionsToPulse).length > 0) {\r\n    this.connectionPulsingCallbackScheduled = true;\r\n    setTimeout(this.clearOldConnectionPulsing.bind(this), 500);\r\n  }\r\n};\r\n\r\nNodeContext.prototype._getDebugInspectorValueForNode = function (id) {\r\n  if (!this.rootComponent) return;\r\n  const nodes = this.rootComponent.nodeScope.getNodesWithIdRecursive(id);\r\n  const node = nodes[nodes.length - 1];\r\n\r\n  if (node && node.getInspectInfo) {\r\n    const info = node.getInspectInfo();\r\n    if (info !== undefined) {\r\n      return { type: 'node', id, value: info };\r\n    }\r\n  }\r\n};\r\n\r\nNodeContext.prototype.sendDebugInspectorValues = function () {\r\n  const valuesToSend = [];\r\n\r\n  for (const id in this.debugInspectors) {\r\n    const inspector = this.debugInspectors[id];\r\n\r\n    if (inspector.type === 'connection' && this._outputHistory.hasOwnProperty(id)) {\r\n      const value = this._outputHistory[id].value;\r\n\r\n      valuesToSend.push({\r\n        type: 'connection',\r\n        id,\r\n        value: this._formatConnectionValue(value)\r\n      });\r\n    } else if (inspector.type === 'node') {\r\n      const inspectorValue = this._getDebugInspectorValueForNode(id);\r\n      inspectorValue && valuesToSend.push(inspectorValue);\r\n    }\r\n  }\r\n\r\n  if (valuesToSend.length > 0) {\r\n    this.editorConnection.sendDebugInspectorValues(valuesToSend);\r\n  }\r\n\r\n  if (this.connectionsToPulseChanged) {\r\n    this.connectionsToPulseChanged = false;\r\n    this.editorConnection.sendPulsingConnections(this.connectionsToPulse);\r\n  }\r\n};\r\n\r\nNodeContext.prototype.setDebugInspectorsEnabled = function (enabled) {\r\n  this.debugInspectorsEnabled = enabled;\r\n  this.editorConnection.debugInspectorsEnabled = enabled;\r\n  if (enabled) {\r\n    this.sendDebugInspectorValues();\r\n  }\r\n};\r\n\r\nNodeContext.prototype.sendGlobalEventFromEventSender = function (channelName, inputValues) {\r\n  this.eventSenderEmitter.emit(channelName, inputValues);\r\n};\r\n\r\nNodeContext.prototype.setPopupCallbacks = function ({ onShow, onClose }) {\r\n  this.onShowPopup = onShow;\r\n  this.onClosePopup = onClose;\r\n};\r\n\r\n/**\r\n * @param {string} popupComponent\r\n * @param {Record<string, unknown>} params\r\n * @param {{\r\n *  senderNode?: unknown;\r\n *  onClosePopup?: (action?: string, results: object) => void;\r\n * }} args\r\n * @returns\r\n */\r\nNodeContext.prototype.showPopup = async function (popupComponent, params, args) {\r\n  if (!this.onShowPopup) return;\r\n\r\n  const nodeScope = this.rootComponent.nodeScope;\r\n\r\n  const popupNode = await nodeScope.createNode(popupComponent);\r\n  for (const inputKey in params) {\r\n    popupNode.setInputValue(inputKey, params[inputKey]);\r\n  }\r\n\r\n  popupNode.popupParent = args?.senderNode || null;\r\n\r\n  // Create container group\r\n  const group = nodeScope.createPrimitiveNode('Group');\r\n  group.setInputValue('flexDirection', 'node');\r\n  group.setInputValue('cssClassName', 'noodl-popup');\r\n\r\n  const bodyScroll = this.graphModel.getSettings().bodyScroll;\r\n\r\n  //if the body can scroll the position of the popup needs to be fixed.\r\n  group.setInputValue('position', bodyScroll ? 'fixed' : 'absolute');\r\n\r\n  var closePopupNodes = popupNode.nodeScope.getNodesWithType('NavigationClosePopup');\r\n  if (closePopupNodes && closePopupNodes.length > 0) {\r\n    for (var j = 0; j < closePopupNodes.length; j++) {\r\n      closePopupNodes[j]._setCloseCallback((action, results) => {\r\n        //close next frame so all nodes have a chance to update before being deleted\r\n        this.scheduleNextFrame(() => {\r\n          //avoid double callbacks\r\n          if (!nodeScope.hasNodeWithId(group.id)) return;\r\n\r\n          this.onClosePopup(group);\r\n          nodeScope.deleteNode(group);\r\n          args && args.onClosePopup && args.onClosePopup(action, results);\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  this.onShowPopup(group);\r\n\r\n  requestAnimationFrame(() => {\r\n    //hack to make the react components have the right props\r\n    //TODO: figure out why this requestAnimationFrame is necessary\r\n    group.addChild(popupNode);\r\n  });\r\n};\r\n\r\nNodeContext.prototype.setWarningTypes = function (warningTypes) {\r\n  Object.assign(this.warningTypes, warningTypes);\r\n};\r\n\r\nNodeContext.prototype.isWarningTypeEnabled = function (warning) {\r\n  if (!this.warningTypes.hasOwnProperty(warning)) {\r\n    //if a level isn't set, default to true\r\n    return true;\r\n  }\r\n\r\n  return this.warningTypes[warning] ? true : false;\r\n};\r\n\r\nNodeContext.prototype.getDefaultValueForInput = function (nodeType, inputName) {\r\n  if (this.nodeRegister.hasNode(nodeType) === false) {\r\n    return undefined;\r\n  }\r\n\r\n  const nodeMetadata = this.nodeRegister.getNodeMetadata(nodeType);\r\n  const inputMetadata = nodeMetadata.inputs[inputName];\r\n\r\n  if (!inputMetadata) {\r\n    return undefined;\r\n  }\r\n\r\n  if (inputMetadata.type.defaultUnit) {\r\n    return {\r\n      value: inputMetadata.default,\r\n      unit: inputMetadata.type.defaultUnit\r\n    };\r\n  }\r\n\r\n  return inputMetadata.default;\r\n};\r\n\r\nmodule.exports = NodeContext;\r\n","const Node = require('./node'),\r\n  EdgeTriggeredInput = require('./edgetriggeredinput');\r\n\r\nfunction registerInput(object, metadata, name, input) {\r\n  if (object.hasOwnProperty(name)) {\r\n    throw new Error('Input property ' + name + ' already registered');\r\n  }\r\n\r\n  if (!input.set && !input.valueChangedToTrue) {\r\n    input.set = () => {};\r\n  }\r\n\r\n  if (input.set) {\r\n    object[name] = {\r\n      set: input.set\r\n    };\r\n\r\n    //types to keep in the input on the node instances\r\n    //color and textStyles are used for style updates\r\n    //array is for supporting eval:ing strings\r\n    const typesToSaveInInput = ['color', 'textStyle', 'array'];\r\n\r\n    typesToSaveInInput.forEach((type) => {\r\n      if (input.type && (input.type === type || input.type.name === type)) {\r\n        object[name].type = type;\r\n      }\r\n    });\r\n  }\r\n\r\n  if (input.setUnitType) {\r\n    object[name].setUnitType = input.setUnitType;\r\n  }\r\n\r\n  metadata.inputs[name] = {\r\n    displayName: input.displayName,\r\n    editorName: input.editorName,\r\n    group: input.group,\r\n    type: input.type,\r\n    default: input.default,\r\n    index: input.index,\r\n    exportToEditor: input.hasOwnProperty('exportToEditor') ? input.exportToEditor : true,\r\n    inputPriority: input.inputPriority || 0,\r\n    tooltip: input.tooltip,\r\n    tab: input.tab,\r\n    popout: input.popout,\r\n    allowVisualStates: input.allowVisualStates,\r\n    nodeDoubleClickAction: input.nodeDoubleClickAction\r\n  };\r\n\r\n  if (input.valueChangedToTrue) {\r\n    metadata.inputs[name].type = {\r\n      name: 'signal',\r\n      allowConnectionsOnly: true\r\n    };\r\n  }\r\n}\r\n\r\nfunction registerInputs(object, metadata, inputs) {\r\n  Object.keys(inputs).forEach(function (inputName) {\r\n    registerInput(object, metadata, inputName, inputs[inputName]);\r\n  });\r\n}\r\n\r\nfunction registerNumberedInputs(node, numberedInputs) {\r\n  for (const inputName of Object.keys(numberedInputs)) {\r\n    registerNumberedInput(node, inputName, numberedInputs[inputName]);\r\n  }\r\n}\r\n\r\nfunction registerNumberedInput(node, name, input) {\r\n  const oldRegisterInputIfNeeded = node.registerInputIfNeeded;\r\n\r\n  node.registerInputIfNeeded = function (inputName) {\r\n    if (oldRegisterInputIfNeeded) {\r\n      oldRegisterInputIfNeeded.call(node, inputName);\r\n    }\r\n\r\n    if (node.hasInput(inputName) || !inputName.startsWith(name)) {\r\n      return;\r\n    }\r\n\r\n    const index = Number(inputName.slice(name.length + 1)); // inputName is \"nameOfInput xxx\" where xxx is the index\r\n\r\n    node.registerInput(inputName, {\r\n      type: input.type,\r\n      set: input.createSetter.call(node, index)\r\n    });\r\n  };\r\n}\r\n\r\nfunction registerOutputsMetadata(metadata, outputs) {\r\n  Object.keys(outputs).forEach(function (name) {\r\n    var output = outputs[name];\r\n\r\n    metadata.outputs[name] = {\r\n      displayName: output.displayName,\r\n      editorName: output.editorName,\r\n      group: output.group,\r\n      type: output.type,\r\n      index: output.index,\r\n      exportToEditor: output.hasOwnProperty('exportToEditor') ? output.exportToEditor : true\r\n    };\r\n  });\r\n}\r\n\r\nfunction initializeDefaultValues(defaultValues, inputsMetadata) {\r\n  Object.keys(inputsMetadata).forEach((name) => {\r\n    const defaultValue = inputsMetadata[name].default;\r\n    if (defaultValue === undefined) return;\r\n\r\n    if (inputsMetadata[name].type.defaultUnit) {\r\n      defaultValues[name] = {\r\n        unit: inputsMetadata[name].type.defaultUnit,\r\n        value: defaultValue\r\n      };\r\n    } else {\r\n      defaultValues[name] = defaultValue;\r\n    }\r\n  });\r\n}\r\n\r\nfunction defineNode(opts) {\r\n  if (!opts.category) {\r\n    throw new Error('Node must have a category');\r\n  }\r\n\r\n  if (!opts.name) {\r\n    throw new Error('Node must have a name');\r\n  }\r\n\r\n  const metadata = {\r\n    inputs: {},\r\n    outputs: {},\r\n    category: opts.category,\r\n    dynamicports: opts.dynamicports,\r\n    exportDynamicPorts: opts.exportDynamicPorts,\r\n    useVariants: opts.useVariants,\r\n    allowChildren: opts.allowChildren,\r\n    allowChildrenWithCategory: opts.allowChildrenWithCategory,\r\n    singleton: opts.singleton,\r\n    connectionPanel: opts.connectionPanel,\r\n    allowAsChild: opts.allowAsChild,\r\n    visualStates: opts.visualStates,\r\n    panels: opts.panels,\r\n    color: opts.color,\r\n    usePortAsLabel: opts.usePortAsLabel,\r\n    portLabelTruncationMode: opts.portLabelTruncationMode,\r\n    name: opts.name,\r\n    displayNodeName: opts.displayNodeName || opts.displayName,\r\n    deprecated: opts.deprecated,\r\n    haveComponentPorts: opts.haveComponentPorts,\r\n    version: opts.version,\r\n    module: opts.module,\r\n    docs: opts.docs,\r\n    allowAsExportRoot: opts.allowAsExportRoot,\r\n    nodeDoubleClickAction: opts.nodeDoubleClickAction,\r\n    searchTags: opts.searchTags\r\n  };\r\n\r\n  opts._internal = opts._internal || {};\r\n\r\n  //prototypeExtensions - old API\r\n  //methods - new API\r\n  opts.prototypeExtensions = opts.methods || opts.prototypeExtensions || {};\r\n  opts.inputs = opts.inputs || {};\r\n  opts.outputs = opts.outputs || {};\r\n  opts.initialize = opts.initialize || function () {};\r\n\r\n  let inputs = {};\r\n\r\n  registerInputs(inputs, metadata, opts.inputs);\r\n  registerOutputsMetadata(metadata, opts.outputs);\r\n  function NodeConstructor(context, id) {\r\n    Node.call(this, context, id);\r\n  }\r\n\r\n  Object.keys(opts.prototypeExtensions).forEach(function (propName) {\r\n    if (!opts.prototypeExtensions[propName].value) {\r\n      opts.prototypeExtensions[propName] = {\r\n        value: opts.prototypeExtensions[propName]\r\n      };\r\n    }\r\n  });\r\n\r\n  NodeConstructor.prototype = Object.create(Node.prototype, opts.prototypeExtensions);\r\n  Object.defineProperty(NodeConstructor.prototype, 'name', {\r\n    value: opts.name\r\n  });\r\n\r\n  if (opts.getInspectInfo) NodeConstructor.prototype.getInspectInfo = opts.getInspectInfo;\r\n  if (opts.nodeScopeDidInitialize) NodeConstructor.prototype.nodeScopeDidInitialize = opts.nodeScopeDidInitialize;\r\n\r\n  const nodeDefinition = function (context, id, nodeScope) {\r\n    const node = new NodeConstructor(context, id);\r\n\r\n    //create all inputs. Use the inputs object for setters that don't have state and can be shared\r\n    node._inputs = Object.create(inputs);\r\n\r\n    //all inputs that use the valueChangedToTrue have state and need to be instanced\r\n    Object.keys(opts.inputs).forEach(function (name) {\r\n      var input = opts.inputs[name];\r\n      if (input.valueChangedToTrue) {\r\n        node._inputs[name] = {\r\n          set: EdgeTriggeredInput.createSetter({\r\n            valueChangedToTrue: input.valueChangedToTrue\r\n          })\r\n        };\r\n      }\r\n    });\r\n\r\n    Object.keys(opts.outputs).forEach(function (name) {\r\n      var output = opts.outputs[name];\r\n      if (output.type === 'signal') {\r\n        node.registerOutput(name, {\r\n          getter: function () {\r\n            //signals are always emitted as a sequence of false, true, so this getter is never used\r\n            return undefined;\r\n          }\r\n        });\r\n      } else {\r\n        node.registerOutput(name, output);\r\n      }\r\n    });\r\n\r\n    opts.numberedInputs && registerNumberedInputs(node, opts.numberedInputs);\r\n\r\n    node.nodeScope = nodeScope;\r\n    initializeDefaultValues(node._inputValues, metadata.inputs);\r\n\r\n    opts.initialize.call(node);\r\n\r\n    return node;\r\n  };\r\n\r\n  nodeDefinition.metadata = metadata;\r\n\r\n  if (opts.numberedInputs) registerSetupFunctionForNumberedInputs(nodeDefinition, opts.name, opts.numberedInputs);\r\n\r\n  return nodeDefinition;\r\n}\r\n\r\nfunction registerSetupFunctionForNumberedInputs(nodeDefinition, nodeType, numberedInputs) {\r\n  const inputNames = Object.keys(numberedInputs);\r\n\r\n  if (!inputNames.length) return;\r\n\r\n  nodeDefinition.setupNumberedInputDynamicPorts = function (context, graphModel) {\r\n    const editorConnection = context.editorConnection;\r\n\r\n    if (!editorConnection || !editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function collectPorts(node, inputName, input) {\r\n      const connections = node.component.getConnectionsTo(node.id).map((c) => c.targetPort);\r\n\r\n      const allPortNames = Object.keys(node.parameters).concat(connections);\r\n      const portNames = allPortNames.filter((p) => p.startsWith(inputName + ' '));\r\n\r\n      //Figure out how many we need to create\r\n      //It needs to be the highest index + 1\r\n      //Only parameters with values are present, e.g. input 3 can be missing even if input 4 is defined\r\n      const maxIndex = portNames.length\r\n        ? 1 + Math.max(...portNames.map((p) => Number(p.slice(inputName.length + 1))))\r\n        : 0;\r\n      const numPorts = maxIndex + 1;\r\n\r\n      const ports = [];\r\n\r\n      for (let i = 0; i < numPorts; i++) {\r\n        const port = {\r\n          name: inputName + ' ' + i,\r\n          displayName: (input.displayPrefix || inputName) + ' ' + i,\r\n          type: input.type,\r\n          plug: 'input',\r\n          group: input.group\r\n        };\r\n\r\n        if (input.hasOwnProperty('index')) {\r\n          port.index = input.index + i;\r\n        }\r\n\r\n        ports.push(port);\r\n      }\r\n\r\n      return ports;\r\n    }\r\n\r\n    function updatePorts(node) {\r\n      const ports = inputNames.map((inputName) => collectPorts(node, inputName, numberedInputs[inputName])).flat();\r\n      editorConnection.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    graphModel.on('nodeAdded.' + nodeType, (node) => {\r\n      updatePorts(node);\r\n      node.on('parameterUpdated', () => {\r\n        updatePorts(node);\r\n      });\r\n\r\n      node.on('inputConnectionAdded', () => {\r\n        updatePorts(node);\r\n      });\r\n\r\n      node.on('inputConnectionRemoved', () => {\r\n        updatePorts(node);\r\n      });\r\n    });\r\n  };\r\n}\r\n\r\nfunction extend(obj1, obj2) {\r\n  for (var p in obj2) {\r\n    if (p === 'initialize' && obj1.initialize) {\r\n      var oldInit = obj1.initialize;\r\n      obj1.initialize = function () {\r\n        oldInit.call(this);\r\n        obj2.initialize.call(this);\r\n      };\r\n    } else if (obj2[p] && obj2[p].constructor === Object) {\r\n      obj1[p] = extend(obj1[p] || {}, obj2[p]);\r\n    } else if (obj2[p] && obj2[p].constructor === Array && obj1[p] && obj1[p].constructor == Array) {\r\n      obj1[p] = obj1[p].concat(obj2[p]);\r\n    } else {\r\n      obj1[p] = obj2[p];\r\n    }\r\n  }\r\n  return obj1;\r\n}\r\n\r\nmodule.exports = {\r\n  defineNode: defineNode,\r\n  extend: extend\r\n};\r\n","'use strict';\r\n\r\nfunction formatDynamicPorts(nodeMetadata) {\r\n  const dynamicports = [];\r\n\r\n  for (const dp of nodeMetadata.dynamicports) {\r\n    if (dp.ports || dp.template || dp.port || dp.channelPort) {\r\n      //same format as editor expects, no need to transform it\r\n      dynamicports.push(dp);\r\n    } else if (dp.inputs || dp.outputs) {\r\n      //inputs and outputs is just list of names\r\n      //need to pull the metadata from the inputs/outputs since they\r\n      //won't be registered by the editor (it's either a regular port\r\n      // or a dynamic port, can't register both)\r\n      const ports = [];\r\n\r\n      if (dp.inputs) {\r\n        for (const inputName of dp.inputs) {\r\n          ports.push(formatPort(inputName, nodeMetadata.inputs[inputName], 'input'));\r\n        }\r\n      }\r\n\r\n      if (dp.outputs) {\r\n        for (const outputName of dp.outputs) {\r\n          ports.push(formatPort(outputName, nodeMetadata.outputs[outputName], 'output'));\r\n        }\r\n      }\r\n\r\n      const dynamicPortGroup = {\r\n        name: dp.name || 'conditionalports/basic',\r\n        condition: dp.condition,\r\n        ports\r\n      };\r\n\r\n      dynamicports.push(dynamicPortGroup);\r\n    }\r\n  }\r\n\r\n  return dynamicports;\r\n}\r\n\r\nfunction formatPort(portName, portData, plugType) {\r\n  var port = {\r\n    name: portName,\r\n    type: portData.type,\r\n    plug: plugType\r\n  };\r\n  if (portData.group) {\r\n    port.group = portData.group;\r\n  }\r\n  if (portData.displayName) {\r\n    port.displayName = portData.displayName;\r\n  }\r\n  if (portData.description) {\r\n    port.description = portData.description;\r\n  }\r\n  if (portData.editorName) {\r\n    port.editorName = portData.editorName;\r\n  }\r\n  if (portData.default !== undefined) {\r\n    port.default = portData.default;\r\n  }\r\n  if (portData.hasOwnProperty('index')) {\r\n    port.index = portData.index;\r\n  }\r\n  if (portData.tooltip) {\r\n    port.tooltip = portData.tooltip;\r\n  }\r\n  if (portData.tab) {\r\n    port.tab = portData.tab;\r\n  }\r\n  if (portData.popout) {\r\n    port.popout = portData.popout;\r\n  }\r\n  if (portData.allowVisualStates) {\r\n    port.allowVisualStates = portData.allowVisualStates;\r\n  }\r\n  return port;\r\n}\r\n\r\nfunction generateNodeLibrary(nodeRegister) {\r\n  var obj = {\r\n    //note: needs to include ALL types\r\n    typecasts: [\r\n      {\r\n        from: 'string',\r\n        to: ['number', 'boolean', 'image', 'color', 'enum', 'textStyle', 'dimension', 'array', 'object']\r\n      },\r\n      {\r\n        from: 'boolean',\r\n        to: ['number', 'string', 'signal']\r\n      },\r\n      {\r\n        from: 'number',\r\n        to: ['boolean', 'string', 'dimension']\r\n      },\r\n      {\r\n        from: 'date',\r\n        to: ['string']\r\n      },\r\n      {\r\n        from: 'signal',\r\n        to: ['boolean', 'number']\r\n      },\r\n      {\r\n        from: 'image',\r\n        to: []\r\n      },\r\n      {\r\n        from: 'cloudfile',\r\n        to: ['string', 'image']\r\n      },\r\n      {\r\n        from: 'color',\r\n        to: []\r\n      },\r\n      {\r\n        from: 'enum',\r\n        to: []\r\n      },\r\n      {\r\n        from: 'object',\r\n        to: []\r\n      },\r\n      {\r\n        from: 'domelement',\r\n        to: []\r\n      },\r\n      {\r\n        from: 'reference',\r\n        to: []\r\n      },\r\n      {\r\n        from: 'font',\r\n        to: []\r\n      },\r\n      {\r\n        from: 'textStyle',\r\n        to: ['string']\r\n      },\r\n      {\r\n        // Collection is deprecated but supported via typecasts\r\n        from: 'collection',\r\n        to: ['array']\r\n      },\r\n      {\r\n        from: 'array',\r\n        to: ['collection']\r\n      }\r\n    ],\r\n    dynamicports: [\r\n      {\r\n        type: 'conditionalports',\r\n        name: 'basic'\r\n      },\r\n      {\r\n        type: 'expand',\r\n        name: 'basic'\r\n      }\r\n    ],\r\n    colors: {\r\n      nodes: {\r\n        component: {\r\n          base: '#643D8B',\r\n          baseHighlighted: '#79559b',\r\n          header: '#4E2877',\r\n          headerHighlighted: '#643d8b',\r\n          outline: '#4E2877',\r\n          outlineHighlighted: '#b58900',\r\n          text: '#dbd0e4'\r\n        },\r\n        visual: {\r\n          base: '#315272',\r\n          baseHighlighted: '#4d6784',\r\n          header: '#173E5D',\r\n          headerHighlighted: '#315272',\r\n          outline: '#173E5D',\r\n          outlineHighlighted: '#b58900',\r\n          text: '#cfd5de'\r\n        },\r\n        data: {\r\n          base: '#465524',\r\n          baseHighlighted: '#5b6a37',\r\n          header: '#314110',\r\n          headerHighlighted: '#465524',\r\n          outline: '#314110',\r\n          outlineHighlighted: '#b58900',\r\n          text: '#d2d6c5'\r\n        },\r\n        javascript: {\r\n          base: '#7E3660',\r\n          baseHighlighted: '#944e74',\r\n          header: '#67214B',\r\n          headerHighlighted: '#7e3660',\r\n          outline: '#67214B',\r\n          outlineHighlighted: '#d57bab',\r\n          text: '#e4cfd9'\r\n        },\r\n        default: {\r\n          base: '#4C4F59',\r\n          baseHighlighted: '#62656e',\r\n          header: '#373B45',\r\n          headerHighlighted: '#4c4f59',\r\n          outline: '#373B45',\r\n          outlineHighlighted: '#b58900',\r\n          text: '#d3d4d6'\r\n        }\r\n      },\r\n      connections: {\r\n        signal: {\r\n          normal: '#006f82',\r\n          highlighted: '#7ec2cf',\r\n          pulsing: '#ffffff'\r\n        },\r\n        default: {\r\n          normal: '#875d00',\r\n          highlighted: '#e5ae32',\r\n          pulsing: '#ffffff'\r\n        }\r\n      }\r\n    },\r\n    nodetypes: [\r\n      {\r\n        name: 'Component Children',\r\n        shortDesc: 'This node is a placeholder for where children of this component will be inserted.',\r\n        docs: 'https://docs.noodl.net/nodes/component-utilities/component-children',\r\n        color: 'component',\r\n        allowAsChild: true,\r\n        category: 'Visual',\r\n        haveComponentChildren: ['Visual']\r\n      }\r\n    ]\r\n  };\r\n\r\n  var nodeTypes = Object.keys(nodeRegister._constructors);\r\n\r\n  nodeTypes.forEach(function (type) {\r\n    var nodeMetadata = nodeRegister._constructors[type].metadata;\r\n\r\n    var nodeObj = {\r\n      name: type,\r\n      searchTags: nodeMetadata.searchTags\r\n    };\r\n    obj.nodetypes.push(nodeObj);\r\n\r\n    if (nodeMetadata.version) {\r\n      nodeObj.version = nodeMetadata.version;\r\n    }\r\n    if (nodeMetadata.displayNodeName) {\r\n      nodeObj.displayNodeName = nodeMetadata.displayNodeName;\r\n    }\r\n    if (nodeMetadata.nodeDoubleClickAction) {\r\n      nodeObj.nodeDoubleClickAction = nodeMetadata.nodeDoubleClickAction;\r\n    }\r\n    if (nodeMetadata.shortDesc) {\r\n      nodeObj.shortDesc = nodeMetadata.shortDesc;\r\n    }\r\n    if (nodeMetadata.module) {\r\n      nodeObj.module = nodeMetadata.module;\r\n    }\r\n    if (nodeMetadata.deprecated) {\r\n      nodeObj.deprecated = true;\r\n    }\r\n    if (nodeMetadata.haveComponentPorts) {\r\n      nodeObj.haveComponentPorts = true;\r\n    }\r\n    if (nodeMetadata.category === 'Visual') {\r\n      nodeObj.allowAsChild = true;\r\n      nodeObj.allowAsExportRoot = true;\r\n      nodeObj.color = 'visual';\r\n    }\r\n\r\n    if (nodeMetadata.allowAsExportRoot !== undefined) {\r\n      nodeObj.allowAsExportRoot = nodeMetadata.allowAsExportRoot;\r\n    }\r\n\r\n    if (nodeMetadata.allowChildren) {\r\n      nodeObj.allowChildrenWithCategory = ['Visual'];\r\n      nodeObj.color = 'visual';\r\n    }\r\n    if (nodeMetadata.allowChildrenWithCategory) {\r\n      nodeObj.allowChildrenWithCategory = nodeMetadata.allowChildrenWithCategory;\r\n    }\r\n    if (nodeMetadata.singleton) {\r\n      nodeObj.singleton = true;\r\n    }\r\n    if (nodeMetadata.allowAsChild) {\r\n      nodeObj.allowAsChild = true;\r\n    }\r\n    if (nodeMetadata.docs) {\r\n      nodeObj.docs = nodeMetadata.docs;\r\n    }\r\n    if (nodeMetadata.shortDocs) {\r\n      nodeObj.shortDocs = nodeMetadata.shortDocs;\r\n    } else if (nodeMetadata.docs && nodeMetadata.docs.indexOf('https://docs.noodl.net') === 0) {\r\n      nodeObj.shortDocs = nodeMetadata.docs.replace('/#', '') + '-short.md';\r\n    }\r\n    nodeObj.category = nodeMetadata.category;\r\n\r\n    if (nodeMetadata.panels) {\r\n      nodeObj.panels = nodeMetadata.panels;\r\n    }\r\n    if (nodeMetadata.usePortAsLabel) {\r\n      nodeObj.usePortAsLabel = nodeMetadata.usePortAsLabel;\r\n      nodeObj.portLabelTruncationMode = nodeMetadata.portLabelTruncationMode;\r\n    }\r\n    if (nodeMetadata.color) {\r\n      nodeObj.color = nodeMetadata.color;\r\n    }\r\n    if (nodeMetadata.dynamicports) {\r\n      nodeObj.dynamicports = formatDynamicPorts(nodeMetadata);\r\n    }\r\n    if (nodeMetadata.exportDynamicPorts) {\r\n      nodeObj.exportDynamicPorts = nodeMetadata.exportDynamicPorts;\r\n    }\r\n    if (nodeMetadata.visualStates) {\r\n      nodeObj.visualStates = nodeMetadata.visualStates;\r\n    }\r\n    if (nodeMetadata.useVariants) {\r\n      nodeObj.useVariants = nodeMetadata.useVariants;\r\n    }\r\n    if (nodeMetadata.connectionPanel) {\r\n      nodeObj.connectionPanel = nodeMetadata.connectionPanel;\r\n    }\r\n    nodeObj.ports = [];\r\n\r\n    var dynamicports = nodeObj.dynamicports || [];\r\n    var selectorNames = {};\r\n    var conditionalPortNames = {};\r\n\r\n    //flag conditional ports so they don't get added from the normal ports, making them appear twice in the export\r\n    /* dynamicports.filter(d=> d.name === 'conditionalports/basic')\r\n            .forEach(d=> {\r\n                d.ports.forEach(port=> {\r\n                    conditionalPortNames[port.plug + '/' + port.name] = true;\r\n                });\r\n            });*/\r\n\r\n    //same for channel ports\r\n    dynamicports\r\n      .filter((d) => d.channelPort !== undefined)\r\n      .forEach((port) => {\r\n        conditionalPortNames[port.channelPort.plug + '/' + port.channelPort.name] = true;\r\n      });\r\n\r\n    if (dynamicports.length) {\r\n      nodeObj.dynamicports = dynamicports;\r\n    }\r\n\r\n    Object.keys(nodeMetadata.inputs).forEach(function (inputName) {\r\n      if (\r\n        selectorNames.hasOwnProperty('input/' + inputName) ||\r\n        conditionalPortNames.hasOwnProperty('input/' + inputName)\r\n      ) {\r\n        //this is a selector or dynamic port. It's already been registered\r\n        return;\r\n      }\r\n      var port = nodeMetadata.inputs[inputName];\r\n      if (port.exportToEditor === false) {\r\n        return;\r\n      }\r\n\r\n      nodeObj.ports.push(formatPort(inputName, port, 'input'));\r\n    });\r\n\r\n    function exportOutput(name, output) {\r\n      var port = {\r\n        name: name,\r\n        type: output.type,\r\n        plug: 'output'\r\n      };\r\n      if (output.group) {\r\n        port.group = output.group;\r\n      }\r\n      if (output.displayName) {\r\n        port.displayName = output.displayName;\r\n      }\r\n      if (output.editorName) {\r\n        port.editorName = output.editorName;\r\n      }\r\n      if (output.hasOwnProperty('index')) {\r\n        port.index = output.index;\r\n      }\r\n      nodeObj.ports.push(port);\r\n    }\r\n\r\n    Object.keys(nodeMetadata.outputs).forEach(function (prop) {\r\n      if (selectorNames.hasOwnProperty('output/' + prop) || conditionalPortNames.hasOwnProperty('output/' + prop)) {\r\n        //this is a selector or dynamic port. It's already been registered\r\n        return;\r\n      }\r\n\r\n      var output = nodeMetadata.outputs[prop];\r\n      exportOutput(prop, output);\r\n    });\r\n  });\r\n\r\n  const coreNodes = [\r\n    {\r\n      name: 'UI Elements',\r\n      description: 'Buttons, inputs, containers, media',\r\n      type: 'visual',\r\n      subCategories: [\r\n        {\r\n          name: 'Basic Elements',\r\n          items: ['Group', 'net.noodl.visual.columns', 'Text', 'Image', 'Video', 'Circle', 'net.noodl.visual.icon']\r\n        },\r\n        {\r\n          name: 'UI Controls',\r\n          items: [\r\n            'net.noodl.controls.button',\r\n            'net.noodl.controls.checkbox',\r\n            'net.noodl.controls.options',\r\n            'net.noodl.controls.radiobutton',\r\n            'Radio Button Group',\r\n            'net.noodl.controls.range',\r\n            'net.noodl.controls.textinput'\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      name: 'Navigation & Popups',\r\n      description: 'Page routing, navigation, popups',\r\n      type: 'logic',\r\n      subCategories: [\r\n        {\r\n          name: 'Navigation',\r\n          items: ['Router', 'RouterNavigate', 'PageInputs', 'net.noodl.externallink', 'PageStackNavigateToPath']\r\n        },\r\n        {\r\n          name: 'Component Stack',\r\n          items: ['Page Stack', 'PageStackNavigate', 'PageStackNavigateBack']\r\n        },\r\n        {\r\n          name: 'Popups',\r\n          items: ['NavigationShowPopup', 'NavigationClosePopup']\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      name: 'Logic & Utilities',\r\n      description: 'Logic, events, string manipulation',\r\n      type: 'logic',\r\n      subCategories: [\r\n        {\r\n          name: 'General Utils',\r\n          items: [\r\n            'States',\r\n            'Value Changed',\r\n            'Timer',\r\n            'Color Blend',\r\n            'Number Remapper',\r\n            'Counter',\r\n            'Drag',\r\n            'net.noodl.animatetovalue'\r\n          ]\r\n        },\r\n        {\r\n          name: 'Logic',\r\n          items: ['Boolean To String', 'Switch', 'And', 'Or', 'Condition', 'Inverter']\r\n        },\r\n        {\r\n          name: 'Events',\r\n          items: ['Event Sender', 'Event Receiver']\r\n        },\r\n        {\r\n          name: 'String Manipulation',\r\n          items: ['Substring', 'String Mapper', 'String Format', 'Date To String', 'Unique Id']\r\n        },\r\n        {\r\n          name: 'System',\r\n          items: ['Screen Resolution', 'Open File Picker']\r\n        },\r\n        {\r\n          name: 'Variables',\r\n          items: ['String', 'Boolean', 'Color', 'Number']\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      name: 'Component Utilities',\r\n      description: 'Component inputs, outputs & object',\r\n      type: 'component',\r\n      subCategories: [\r\n        {\r\n          name: '',\r\n          items: [\r\n            'Component Inputs',\r\n            'Component Outputs',\r\n            'Component Children',\r\n            'net.noodl.ComponentObject',\r\n            'net.noodl.ParentComponentObject',\r\n            'net.noodl.SetComponentObjectProperties',\r\n            'net.noodl.SetParentComponentObjectProperties'\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      name: 'Read & Write Data',\r\n      description: 'Arrays, objects, cloud data',\r\n      type: 'data',\r\n      subCategories: [\r\n        {\r\n          name: '',\r\n          items: [\r\n            'RunTasks',\r\n            'For Each',\r\n            'For Each Actions',\r\n            'Model2',\r\n            'SetModelProperties',\r\n            'NewModel',\r\n            'Set Variable',\r\n            'Variable2'\r\n          ]\r\n        },\r\n        {\r\n          name: 'Array',\r\n          items: [\r\n            'Collection2',\r\n            'CollectionNew',\r\n            'CollectionRemove',\r\n            'CollectionClear',\r\n            'CollectionInsert',\r\n            'Filter Collection',\r\n            'Map Collection',\r\n            'Static Data'\r\n          ]\r\n        },\r\n        {\r\n          name: 'Cloud Data',\r\n          items: [\r\n            'DbModel2',\r\n            'NewDbModelProperties',\r\n            'FilterDBModels',\r\n            'SetDbModelProperties',\r\n            'DbCollection2',\r\n            'DeleteDbModelProperties',\r\n            'AddDbModelRelation',\r\n            'RemoveDbModelRelation',\r\n            'Cloud File',\r\n            'Upload File',\r\n            'CloudFunction2',\r\n            'DbConfig'\r\n          ]\r\n        },\r\n        {\r\n          name: 'User',\r\n          items: [\r\n            'net.noodl.user.LogIn',\r\n            'net.noodl.user.LogOut',\r\n            'net.noodl.user.SignUp',\r\n            'net.noodl.user.User',\r\n            'net.noodl.user.SetUserProperties',\r\n            'net.noodl.user.VerifyEmail',\r\n            'net.noodl.user.SendEmailVerification',\r\n            'net.noodl.user.ResetPassword',\r\n            'net.noodl.user.RequestPasswordReset'\r\n          ]\r\n        },\r\n        {\r\n          name: 'External Data',\r\n          items: ['REST2']\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      name: 'Custom Code',\r\n      description: 'Custom JavaScript and CSS',\r\n      type: 'javascript',\r\n      subCategories: [\r\n        {\r\n          name: '',\r\n          items: ['Expression', 'JavaScriptFunction', 'Javascript2', 'CSS Definition']\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      name: 'Cloud Functions',\r\n      description: 'Nodes to be used in cloud functions',\r\n      type: 'data',\r\n      subCategories: [\r\n        {\r\n          name: '',\r\n          items: ['noodl.cloud.request', 'noodl.cloud.response']\r\n        },\r\n        {\r\n          name: 'Cloud Data',\r\n          items: ['noodl.cloud.aggregate']\r\n        }\r\n      ]\r\n    }\r\n  ];\r\n\r\n  obj.nodeIndex = {\r\n    coreNodes\r\n  };\r\n\r\n  const moduleNodes = [];\r\n\r\n  nodeTypes.forEach((type) => {\r\n    const nodeMetadata = nodeRegister._constructors[type].metadata;\r\n    if (nodeMetadata.module) {\r\n      moduleNodes.push(type);\r\n    }\r\n  });\r\n\r\n  if (moduleNodes.length) {\r\n    obj.nodeIndex.moduleNodes = [\r\n      {\r\n        name: '',\r\n        items: moduleNodes\r\n      }\r\n    ];\r\n  }\r\n\r\n  return obj;\r\n}\r\n\r\nmodule.exports = generateNodeLibrary;\r\n","\"use strict\";\r\n\r\nfunction NodeRegister(context) {\r\n    this._constructors = {};\r\n    this.context = context;\r\n}\r\n\r\nNodeRegister.prototype.register = function(nodeDefinition) {\r\n    var name = nodeDefinition.metadata.name;\r\n\r\n    this._constructors[name] = nodeDefinition;\r\n};\r\n\r\nNodeRegister.prototype.createNode = function(name, id, nodeScope) {\r\n    if(this._constructors.hasOwnProperty(name) === false) {\r\n        throw new Error(\"Unknown node type with name \" + name);\r\n    }\r\n\r\n    return this._constructors[name](this.context, id, nodeScope);\r\n};\r\n\r\nNodeRegister.prototype.getNodeMetadata = function(type) {\r\n    if(this._constructors.hasOwnProperty(type) === false) {\r\n        throw new Error(\"Unknown node type with name \" + type);\r\n    }\r\n\r\n    return this._constructors[type].metadata;\r\n};\r\n\r\nNodeRegister.prototype.hasNode = function(type) {\r\n    return this._constructors.hasOwnProperty(type);\r\n};\r\n\r\nNodeRegister.prototype.getInputType = function(type, inputName) {\r\n    const metadata = this.getNodeMetadata(type);\r\n    return metadata.inputs[inputName] && metadata.inputs[inputName].type;\r\n}\r\n\r\nmodule.exports = NodeRegister;","'use strict';\r\n\r\nmodule.exports = {\r\n  node: {\r\n    name: 'Component Inputs',\r\n    shortDesc: 'This node is used to define the inputs of a component.',\r\n    docs: 'https://docs.noodl.net/nodes/component-utilities/component-inputs',\r\n    panels: [\r\n      {\r\n        name: 'PortEditor',\r\n        context: ['select', 'connectFrom'],\r\n        title: 'Inputs',\r\n        plug: 'output',\r\n        type: {\r\n          name: '*'\r\n        },\r\n        canArrangeInGroups: true\r\n      },\r\n      {\r\n        name: 'PropertyEditor',\r\n        hidden: true\r\n      }\r\n    ],\r\n    getInspectInfo() {\r\n      return { type: 'value', value: this.nodeScope.componentOwner._internal.inputValues };\r\n    },\r\n    color: 'component',\r\n    haveComponentPorts: true,\r\n    category: 'Component Utilities',\r\n    methods: {\r\n      registerOutputIfNeeded: function (name) {\r\n        if (this.hasOutput(name)) {\r\n          return;\r\n        }\r\n\r\n        this.registerOutput(name, {\r\n          getter: function () {\r\n            return this.nodeScope.componentOwner._internal.inputValues[name];\r\n          }\r\n        });\r\n      },\r\n      _updateDependencies: function () {\r\n        this.nodeScope.componentOwner.update();\r\n      }\r\n    }\r\n  }\r\n};\r\n","'use strict';\r\n\r\nvar Node = require('../node');\r\nvar NodeScope = require('../nodescope');\r\n\r\nlet componentIdCounter = 0;\r\n\r\nfunction ComponentInstanceNode(context, id, parentNodeScope) {\r\n  Node.call(this, context, id);\r\n\r\n  this.nodeScope = new NodeScope(context, this);\r\n  this.parentNodeScope = parentNodeScope;\r\n  this._internal.childRoot = null;\r\n  this._internal.componentOutputValues = {};\r\n  this._internal.componentOutputs = [];\r\n  this._internal.componentInputs = [];\r\n  this._internal.inputValues = {};\r\n  this._internal.roots = [];\r\n\r\n  this._internal.instanceId = '__$ndl_componentInstaceId' + componentIdCounter;\r\n\r\n  this.nodeScope.modelScope = parentNodeScope ? parentNodeScope.modelScope : undefined;\r\n\r\n  componentIdCounter++;\r\n}\r\n\r\nComponentInstanceNode.prototype = Object.create(Node.prototype, {\r\n  setComponentModel: {\r\n    value: async function (componentModel) {\r\n      this.componentModel = componentModel;\r\n      var self = this;\r\n\r\n      await this.nodeScope.setComponentModel(componentModel);\r\n\r\n      this._internal.componentInputs = this.nodeScope.getNodesWithType('Component Inputs');\r\n      this._internal.componentOutputs = this.nodeScope.getNodesWithType('Component Outputs');\r\n\r\n      Object.values(componentModel.getInputPorts()).forEach(this.registerComponentInputPort.bind(this));\r\n      Object.values(componentModel.getOutputPorts()).forEach(this.registerComponentOutputPort.bind(this));\r\n\r\n      const roots = componentModel.roots || [];\r\n      this._internal.roots = roots.map((id) => this.nodeScope.getNodeWithId(id));\r\n\r\n      componentModel.on(\r\n        'rootAdded',\r\n        (id) => {\r\n          this._internal.roots.push(this.nodeScope.getNodeWithId(id));\r\n          this.forceUpdate();\r\n        },\r\n        this\r\n      );\r\n\r\n      componentModel.on(\r\n        'rootRemoved',\r\n        function (id) {\r\n          const index = this._internal.roots.findIndex((root) => root.id === id);\r\n          if (index !== -1) {\r\n            this._internal.roots.splice(index, 1);\r\n          }\r\n          this.forceUpdate();\r\n        },\r\n        this\r\n      );\r\n\r\n      componentModel.on('inputPortAdded', this.registerComponentInputPort.bind(this), this);\r\n      componentModel.on('outputPortAdded', this.registerComponentOutputPort.bind(this), this);\r\n\r\n      componentModel.on(\r\n        'inputPortRemoved',\r\n        function (port) {\r\n          if (self.hasInput(port.name)) {\r\n            self.deregisterInput(port.name);\r\n          }\r\n        },\r\n        this\r\n      );\r\n      componentModel.on(\r\n        'outputPortRemoved',\r\n        function (port) {\r\n          if (this.hasOutput(port.name)) {\r\n            self.deregisterOutput(port.name);\r\n          }\r\n        },\r\n        this\r\n      );\r\n\r\n      componentModel.on(\r\n        'nodeAdded',\r\n        function (node) {\r\n          if (node.type === 'Component Inputs') {\r\n            self._internal.componentInputs.push(self.nodeScope.getNodeWithId(node.id));\r\n          } else if (node.type === 'Component Outputs') {\r\n            self._internal.componentOutputs.push(self.nodeScope.getNodeWithId(node.id));\r\n          }\r\n        },\r\n        this\r\n      );\r\n\r\n      componentModel.on(\r\n        'nodeRemoved',\r\n        function (node) {\r\n          function removeNodesWithId(array, id) {\r\n            return array.filter((e) => e.id !== id);\r\n          }\r\n          if (node.type === 'Component Inputs') {\r\n            self._internal.componentInputs = removeNodesWithId(self._internal.componentInputs, node.id);\r\n          } else if (node.type === 'Component Outputs') {\r\n            self._internal.componentOutputs = removeNodesWithId(self._internal.componentOutputs, node.id);\r\n          }\r\n        },\r\n        this\r\n      );\r\n\r\n      componentModel.on(\r\n        'renamed',\r\n        function (event) {\r\n          self.name = event.newName;\r\n        },\r\n        this\r\n      );\r\n    }\r\n  },\r\n  _onNodeDeleted: {\r\n    value: function () {\r\n      if (this.componentModel) {\r\n        this.componentModel.removeListenersWithRef(this);\r\n        this.componentModel = undefined;\r\n      }\r\n\r\n      this.nodeScope.reset();\r\n      Node.prototype._onNodeDeleted.call(this);\r\n    }\r\n  },\r\n  registerComponentInputPort: {\r\n    value: function (port) {\r\n      this.registerInput(port.name, {\r\n        set: function (value) {\r\n          this._internal.inputValues[port.name] = value;\r\n          this._internal.componentInputs.forEach(function (componentInput) {\r\n            componentInput.registerOutputIfNeeded(port.name);\r\n            componentInput.flagOutputDirty(port.name);\r\n          });\r\n        }\r\n      });\r\n    }\r\n  },\r\n  registerComponentOutputPort: {\r\n    value: function (port) {\r\n      this.registerOutput(port.name, {\r\n        getter: function () {\r\n          return this._internal.componentOutputValues[port.name];\r\n        }\r\n      });\r\n    }\r\n  },\r\n  setOutputFromComponentOutput: {\r\n    value: function (name, value) {\r\n      if (this.hasOutput(name) === false) {\r\n        return;\r\n      }\r\n\r\n      this._internal.creatorCallbacks &&\r\n        this._internal.creatorCallbacks.onOutputChanged &&\r\n        this._internal.creatorCallbacks.onOutputChanged(name, value, this._internal.componentOutputValues[name]);\r\n\r\n      this._internal.componentOutputValues[name] = value;\r\n      this.flagOutputDirty(name);\r\n    }\r\n  },\r\n  setChildRoot: {\r\n    value: function (node) {\r\n      const prevChildRoot = this._internal.childRoot;\r\n      const newChildRoot = node;\r\n\r\n      this._internal.childRoot = newChildRoot;\r\n\r\n      if (this.model && this.model.children) {\r\n        const parentNodeScope = this.parentNodeScope;\r\n\r\n        const children = this.model.children\r\n          .filter((child) => child.type !== 'Component Children')\r\n          .map((child) => parentNodeScope.getNodeWithId(child.id));\r\n\r\n        if (prevChildRoot) {\r\n          for (let i = 0; i < children.length; i++) {\r\n            if (prevChildRoot.isChild(children[i])) {\r\n              prevChildRoot.removeChild(children[i]);\r\n            }\r\n          }\r\n        }\r\n\r\n        if (newChildRoot) {\r\n          for (let i = 0; i < children.length; i++) {\r\n            const child = children[i];\r\n            const index = child.model.parent.children.indexOf(child.model);\r\n            this.addChild(child, index);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  getChildRootIndex: {\r\n    value: function () {\r\n      if (!this._internal.childRoot || !this._internal.childRoot.model || !this._internal.childRoot.model.children) {\r\n        return 0;\r\n      }\r\n\r\n      var children = this._internal.childRoot.model.children;\r\n\r\n      for (var i = 0; i < children.length; i++) {\r\n        if (children[i].type === 'Component Children') {\r\n          return i;\r\n        }\r\n      }\r\n\r\n      return 0;\r\n    }\r\n  },\r\n  getChildRoot: {\r\n    value: function () {\r\n      if (this._internal.childRoot) {\r\n        return this._internal.childRoot;\r\n      }\r\n      return null;\r\n    }\r\n  },\r\n  getRoots: {\r\n    value: function () {\r\n      return this._internal.roots;\r\n    }\r\n  },\r\n  /** Added for SSR Support */\r\n  triggerDidMount: {\r\n    value: function () {\r\n      this._internal.roots.forEach((root) => {\r\n        root.triggerDidMount && root.triggerDidMount();\r\n      });\r\n    }\r\n  },\r\n  render: {\r\n    value: function () {\r\n      if (this._internal.roots.length === 0) {\r\n        return null;\r\n      }\r\n\r\n      return this._internal.roots[0].render();\r\n    }\r\n  },\r\n  setChildIndex: {\r\n    value: function (childIndex) {\r\n      // NOTE: setChildIndex can be undefined when it is not a React node,\r\n      //       but still a visual node like the foreach (Repeater) node.\r\n      this.getRoots().forEach((root) => root.setChildIndex && root.setChildIndex(childIndex));\r\n    }\r\n  },\r\n  addChild: {\r\n    value: function (child, index) {\r\n      this.getChildRoot().addChild(child, index + this.getChildRootIndex());\r\n    }\r\n  },\r\n  removeChild: {\r\n    value: function (child) {\r\n      this.getChildRoot().removeChild(child);\r\n    }\r\n  },\r\n  getChildren: {\r\n    value: function (child) {\r\n      const childRoot = this.getChildRoot();\r\n      return childRoot ? childRoot.getChildren() : [];\r\n    }\r\n  },\r\n  isChild: {\r\n    value: function (child) {\r\n      if (!this.getChildRoot()) {\r\n        return false;\r\n      }\r\n\r\n      return this.getChildRoot().isChild(child);\r\n    }\r\n  },\r\n  contains: {\r\n    value: function (node) {\r\n      return this.getRoots().some((root) => root.contains && root.contains(node));\r\n    }\r\n  },\r\n  _performDirtyUpdate: {\r\n    value: function () {\r\n      Node.prototype._performDirtyUpdate.call(this);\r\n\r\n      var componentInputs = this._internal.componentInputs;\r\n      for (var i = 0, len = componentInputs.length; i < len; i++) {\r\n        componentInputs[i].flagDirty();\r\n      }\r\n\r\n      this._internal.componentOutputs.forEach(function (componentOutput) {\r\n        componentOutput.flagDirty();\r\n      });\r\n    }\r\n  },\r\n  getRef: {\r\n    value: function () {\r\n      const root = this._internal.roots[0];\r\n      return root ? root.getRef() : undefined;\r\n    }\r\n  },\r\n  update: {\r\n    value: function () {\r\n      Node.prototype.update.call(this);\r\n\r\n      this._internal.componentOutputs.forEach(function (componentOutput) {\r\n        componentOutput.update();\r\n      });\r\n    }\r\n  },\r\n  forceUpdate: {\r\n    //this is only used when roots are added or removed\r\n    value: function () {\r\n      if (!this.parent) return;\r\n\r\n      //the parent will need to re-render the roots of this component instance\r\n      //TODO: make this use a cleaner API, and only invalidate the affected child, instead of all children\r\n      this.parent.cachedChildren = undefined;\r\n      this.parent.forceUpdate();\r\n    }\r\n  },\r\n  getInstanceId: {\r\n    value() {\r\n      return this._internal.instanceId;\r\n    }\r\n  }\r\n});\r\n\r\nComponentInstanceNode.prototype.constructor = ComponentInstanceNode;\r\nmodule.exports = ComponentInstanceNode;\r\n","'use strict';\r\n\r\nmodule.exports = {\r\n  node: {\r\n    category: 'Component Utilities',\r\n    name: 'Component Outputs',\r\n    shortDesc: 'This node is used to define the outputs of a component.',\r\n    docs: 'https://docs.noodl.net/nodes/component-utilities/component-outputs',\r\n    panels: [\r\n      {\r\n        name: 'PortEditor',\r\n        context: ['select', 'connectTo'],\r\n        title: 'Outputs',\r\n        plug: 'input',\r\n        type: {\r\n          name: '*'\r\n        },\r\n        canArrangeInGroups: true\r\n      },\r\n      {\r\n        name: 'PropertyEditor',\r\n        hidden: true\r\n      }\r\n    ],\r\n    color: 'component',\r\n    haveComponentPorts: true,\r\n    prototypeExtensions: {\r\n      registerInputIfNeeded: function (name) {\r\n        if (this.hasInput(name)) {\r\n          return;\r\n        }\r\n\r\n        this.registerInput(name, {\r\n          set: function (value) {\r\n            this.nodeScope.componentOwner.setOutputFromComponentOutput(name, value);\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst AndNode = {\r\n  name: 'And',\r\n  docs: 'https://docs.noodl.net/nodes/logic/and',\r\n  category: 'Logic',\r\n  initialize: function () {\r\n    this._internal.inputs = [];\r\n  },\r\n  getInspectInfo() {\r\n    return and(this._internal.inputs);\r\n  },\r\n  numberedInputs: {\r\n    input: {\r\n      displayPrefix: 'Input',\r\n      type: 'boolean',\r\n      createSetter(index) {\r\n        return function (value) {\r\n          value = value ? true : false;\r\n\r\n          if (this._internal.inputs[index] === value) {\r\n            return;\r\n          }\r\n\r\n          this._internal.inputs[index] = value;\r\n          const result = and(this._internal.inputs);\r\n\r\n          if (this._internal.result !== result) {\r\n            this._internal.result = result;\r\n            this.flagOutputDirty('result');\r\n          }\r\n        };\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: 'boolean',\r\n      displayName: 'Result',\r\n      get() {\r\n        return this._internal.result;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: AndNode\r\n};\r\n\r\nfunction and(values) {\r\n  //if none are false, then return true\r\n  return values.length > 0 && values.some((v) => !v) === false;\r\n}\r\n","'use strict';\r\n\r\nconst BooleanToStringNode = {\r\n  name: 'Boolean To String',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/boolean-to-string',\r\n  category: 'Utilities',\r\n  initialize: function () {\r\n    this._internal.inputs = [];\r\n    this._internal.currentSelectedIndex = 0;\r\n    this._internal.indexChanged = false;\r\n\r\n    this._internal.trueString = '';\r\n    this._internal.falseString = '';\r\n  },\r\n  inputs: {\r\n    trueString: {\r\n      displayName: 'String for true',\r\n      type: 'string',\r\n      set: function (value) {\r\n        if (this._internal.trueString === value) return;\r\n        this._internal.trueString = value;\r\n\r\n        if (this._internal.currentInput) {\r\n          this.flagOutputDirty('currentValue');\r\n        }\r\n      }\r\n    },\r\n    falseString: {\r\n      displayName: 'String for false',\r\n      type: 'string',\r\n      set: function (value) {\r\n        if (this._internal.falseString === value) return;\r\n        this._internal.falseString = value;\r\n\r\n        if (!this._internal.currentInput) {\r\n          this.flagOutputDirty('currentValue');\r\n        }\r\n      }\r\n    },\r\n    input: {\r\n      type: { name: 'boolean' },\r\n      displayName: 'Selector',\r\n      set: function (value) {\r\n        if (this._internal.currentInput === value) return;\r\n\r\n        this._internal.currentInput = value;\r\n        this.flagOutputDirty('currentValue');\r\n        this.sendSignalOnOutput('inputChanged');\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    currentValue: {\r\n      type: 'string',\r\n      displayName: 'Current Value',\r\n      group: 'Value',\r\n      getter: function () {\r\n        return this._internal.currentInput ? this._internal.trueString : this._internal.falseString;\r\n      }\r\n    },\r\n    inputChanged: {\r\n      type: 'signal',\r\n      displayName: 'Selector Changed',\r\n      group: 'Signals'\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: BooleanToStringNode\r\n};\r\n","'use strict';\r\n\r\nconst ConditionNode = {\r\n  name: 'Condition',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/logic/condition',\r\n  category: 'Logic',\r\n  initialize: function () {},\r\n  getInspectInfo() {\r\n    const condition = this.getInputValue('condition');\r\n    let value;\r\n    if (condition === undefined) {\r\n      value = '[No input]';\r\n    }\r\n    value = condition;\r\n    return [\r\n      {\r\n        type: 'value',\r\n        value\r\n      }\r\n    ];\r\n  },\r\n  inputs: {\r\n    condition: {\r\n      type: 'boolean',\r\n      displayName: 'Condition',\r\n      group: 'General',\r\n      set(value) {\r\n        if (!this.isInputConnected('eval')) {\r\n          // Evaluate right away\r\n          this.scheduleEvaluate();\r\n        }\r\n      }\r\n    },\r\n    eval: {\r\n      type: 'signal',\r\n      displayName: 'Evaluate',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleEvaluate();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    ontrue: {\r\n      type: 'signal',\r\n      displayName: 'On True',\r\n      group: 'Events'\r\n    },\r\n    onfalse: {\r\n      type: 'signal',\r\n      displayName: 'On False',\r\n      group: 'Events'\r\n    },\r\n    result: {\r\n      type: 'boolean',\r\n      displayName: 'Is True',\r\n      group: 'Booleans',\r\n      get() {\r\n        return !!this.getInputValue('condition');\r\n      }\r\n    },\r\n    isfalse: {\r\n      type: 'boolean',\r\n      displayName: 'Is False',\r\n      group: 'Booleans',\r\n      get() {\r\n        return !this.getInputValue('condition');\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    scheduleEvaluate() {\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.flagOutputDirty('result');\r\n        this.flagOutputDirty('isfalse');\r\n\r\n        const condition = this.getInputValue('condition');\r\n        this.sendSignalOnOutput(condition ? 'ontrue' : 'onfalse');\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: ConditionNode\r\n};\r\n","'use strict';\r\n\r\nconst CounterNode = {\r\n  name: 'Counter',\r\n  docs: 'https://docs.noodl.net/nodes/math/counter',\r\n  category: 'Math',\r\n  initialize: function () {\r\n    this._internal.currentValue = 0;\r\n    this._internal.startValue = 0;\r\n    this._internal.startValueSet = false;\r\n\r\n    this._internal.limitsEnabled = false;\r\n    this._internal.limitsMin = 0;\r\n    this._internal.limitsMax = 0;\r\n  },\r\n  getInspectInfo() {\r\n    return 'Count: ' + this._internal.currentValue;\r\n  },\r\n  inputs: {\r\n    increase: {\r\n      group: 'Actions',\r\n      displayName: 'Increase Count',\r\n      valueChangedToTrue: function () {\r\n        if (this._internal.limitsEnabled && this._internal.currentValue >= this._internal.limitsMax) {\r\n          return;\r\n        }\r\n\r\n        this._internal.currentValue++;\r\n        this.flagOutputDirty('currentCount');\r\n        this.sendSignalOnOutput('countChanged');\r\n      }\r\n    },\r\n    decrease: {\r\n      group: 'Actions',\r\n      displayName: 'Decrease Count',\r\n      valueChangedToTrue: function () {\r\n        if (this._internal.limitsEnabled && this._internal.currentValue <= this._internal.limitsMin) {\r\n          return;\r\n        }\r\n\r\n        this._internal.currentValue--;\r\n        this.flagOutputDirty('currentCount');\r\n        this.sendSignalOnOutput('countChanged');\r\n      }\r\n    },\r\n    reset: {\r\n      group: 'Actions',\r\n      displayName: 'Reset To Start',\r\n      valueChangedToTrue: function () {\r\n        if (this.currentValue === 0) {\r\n          return;\r\n        }\r\n        this._internal.currentValue = this._internal.startValue;\r\n        this.flagOutputDirty('currentCount');\r\n        this.sendSignalOnOutput('countChanged');\r\n      }\r\n    },\r\n    startValue: {\r\n      type: 'number',\r\n      displayName: 'Start Value',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal.startValue = Number(value);\r\n\r\n        if (this._internal.startValueSet === false) {\r\n          this._internal.startValueSet = true;\r\n          this._internal.currentValue = this._internal.startValue;\r\n          this.flagOutputDirty('currentCount');\r\n          this.sendSignalOnOutput('countChanged');\r\n        }\r\n      }\r\n    },\r\n    limitsMin: {\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      displayName: 'Min Value',\r\n      group: 'Limits',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal.limitsMin = Number(value);\r\n      }\r\n    },\r\n    limitsMax: {\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      displayName: 'Max Value',\r\n      group: 'Limits',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal.limitsMax = Number(value);\r\n      }\r\n    },\r\n    limitsEnabled: {\r\n      type: {\r\n        name: 'boolean'\r\n      },\r\n      displayName: 'Limits Enabled',\r\n      group: 'Limits',\r\n      default: false,\r\n      set: function (value) {\r\n        this._internal.limitsEnabled = value ? true : false;\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    currentCount: {\r\n      displayName: 'Current Count',\r\n      type: 'number',\r\n      getter: function () {\r\n        return this._internal.currentValue;\r\n      }\r\n    },\r\n    countChanged: {\r\n      displayName: 'Count Changed',\r\n      type: 'signal'\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CounterNode\r\n};\r\n","const CloudFile = require('../../../api/cloudfile');\r\n\r\nconst CloudFileNode = {\r\n  name: 'Cloud File',\r\n  docs: 'https://docs.noodl.net/nodes/data/cloud-data/cloud-file',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  getInspectInfo() {\r\n    return this._internal.cloudFile && this._internal.cloudFile.getUrl();\r\n  },\r\n  outputs: {\r\n    url: {\r\n      type: 'string',\r\n      displayName: 'URL',\r\n      group: 'General',\r\n      get() {\r\n        return this._internal.cloudFile && this._internal.cloudFile.getUrl();\r\n      }\r\n    },\r\n    name: {\r\n      type: 'string',\r\n      displayName: 'Name',\r\n      group: 'General',\r\n      get() {\r\n        if (!this._internal.cloudFile) return;\r\n\r\n        //parse prefixes the file with a guid_\r\n        //remove it so the name is the same as the original file name\r\n        const n = this._internal.cloudFile.getName().split('_');\r\n        return n.length === 1 ? n[0] : n.slice(1).join('_');\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    file: {\r\n      type: 'cloudfile',\r\n      displayName: 'Cloud File',\r\n      group: 'General',\r\n      set(value) {\r\n        if (value instanceof CloudFile === false) {\r\n          return;\r\n        }\r\n        this._internal.cloudFile = value;\r\n        this.flagOutputDirty('name');\r\n        this.flagOutputDirty('url');\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CloudFileNode\r\n};\r\n","const { Node, EdgeTriggeredInput } = require('../../../../noodl-runtime');\r\n\r\nconst Model = require('../../../model'),\r\n  Collection = require('../../../collection'),\r\n  CloudStore = require('../../../api/cloudstore'),\r\n  JavascriptNodeParser = require('../../../javascriptnodeparser'),\r\n  QueryUtils = require('../../../api/queryutils');\r\n\r\nvar DbCollectionNode = {\r\n  name: 'DbCollection2',\r\n  docs: 'https://docs.noodl.net/nodes/data/cloud-data/query-records',\r\n  displayName: 'Query Records',\r\n  /* shortDesc: \"A database collection.\",*/\r\n  category: 'Cloud Services',\r\n  usePortAsLabel: 'collectionName',\r\n  color: 'data',\r\n  initialize: function () {\r\n    var _this = this;\r\n    this._internal.queryParameters = {};\r\n\r\n    var collectionChangedScheduled = false;\r\n    this._internal.collectionChangedCallback = function () {\r\n      //this can be called multiple times when adding/removing more than one item\r\n      //so optimize by only updating outputs once\r\n      if (collectionChangedScheduled) return;\r\n      collectionChangedScheduled = true;\r\n\r\n      _this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.flagOutputDirty('count');\r\n        _this.flagOutputDirty('firstItemId');\r\n        _this.flagOutputDirty('isEmpty');\r\n        collectionChangedScheduled = false;\r\n      });\r\n    };\r\n\r\n    this._internal.cloudStoreEvents = function (args) {\r\n      if (_this.isInputConnected('storageFetch') === true) return;\r\n\r\n      if (_this._internal.collection === undefined) return;\r\n      if (args.collection !== _this._internal.name) return;\r\n\r\n      function _addModelAtCorrectIndex(m) {\r\n        if (_this._internal.currentQuery.sort !== undefined) {\r\n          // We need to add it at the right index\r\n          for (var i = 0; i < _this._internal.collection.size(); i++)\r\n            if (QueryUtils.compareObjects(_this._internal.currentQuery.sort, _this._internal.collection.get(i), m) > 0)\r\n              break;\r\n\r\n          _this._internal.collection.addAtIndex(m, i);\r\n        } else {\r\n          _this._internal.collection.add(m);\r\n        }\r\n\r\n        // Make sure we don't exceed limit\r\n        let size = _this._internal.collection.size();\r\n        if (_this._internal.currentQuery.limit !== undefined && size > _this._internal.currentQuery.limit)\r\n          _this._internal.collection.remove(\r\n            _this._internal.collection.get(\r\n              _this._internal.currentQuery.sort !== undefined && _this._internal.currentQuery.sort[0][0] === '-'\r\n                ? size - 1\r\n                : 0\r\n            )\r\n          );\r\n\r\n        //Send the array again over the items output to trigger function nodes etc that might be connected\r\n        _this.flagOutputDirty('items');\r\n\r\n        _this.flagOutputDirty('count');\r\n        _this.flagOutputDirty('firstItemId');\r\n        _this.flagOutputDirty('isEmpty');\r\n      }\r\n\r\n      if (args.type === 'create') {\r\n        const m = Model.get(args.object.objectId);\r\n        if (m !== undefined) {\r\n          // Check if the object matches the current query\r\n          if (QueryUtils.matchesQuery(m, _this._internal.currentQuery.where)) {\r\n            // If matches the query, add the item to results\r\n            _addModelAtCorrectIndex(m);\r\n          }\r\n        }\r\n      } else if (args.type === 'save') {\r\n        const m = Model.get(args.objectId);\r\n        if (m !== undefined) {\r\n          const matchesQuery = QueryUtils.matchesQuery(m, _this._internal.currentQuery.where);\r\n\r\n          if (!matchesQuery && _this._internal.collection.contains(m)) {\r\n            // The record no longer matches the filter, remove it\r\n            _this._internal.collection.remove(m);\r\n\r\n            //Send the array again over the items output to trigger function nodes etc that might be connected\r\n            _this.flagOutputDirty('items');\r\n\r\n            _this.flagOutputDirty('count');\r\n            _this.flagOutputDirty('firstItemId');\r\n            _this.flagOutputDirty('isEmpty');\r\n          } else if (matchesQuery && !_this._internal.collection.contains(m)) {\r\n            // It's not part of the result collection but now matches they query, add it and resort\r\n            _addModelAtCorrectIndex(m);\r\n          }\r\n        }\r\n      } else if (args.type === 'delete') {\r\n        const m = Model.get(args.objectId);\r\n        if (m !== undefined) {\r\n          _this._internal.collection.remove(m);\r\n\r\n          //Send the array again over the items output to trigger function nodes etc that might be connected\r\n          _this.flagOutputDirty('items');\r\n\r\n          _this.flagOutputDirty('count');\r\n          _this.flagOutputDirty('firstItemId');\r\n          _this.flagOutputDirty('isEmpty');\r\n        }\r\n      }\r\n    };\r\n\r\n    // Listening to cloud store events is only for the global model scope, only valid in browser\r\n    // in cloud runtime its a nop\r\n    const cloudstore = CloudStore.forScope(this.nodeScope.modelScope);\r\n    cloudstore.on('save', this._internal.cloudStoreEvents);\r\n    cloudstore.on('create', this._internal.cloudStoreEvents);\r\n    cloudstore.on('delete', this._internal.cloudStoreEvents);\r\n\r\n    this._internal.storageSettings = {};\r\n  },\r\n  getInspectInfo() {\r\n    const collection = this._internal.collection;\r\n    if (!collection) {\r\n      return { type: 'text', value: '[Not executed yet]' };\r\n    }\r\n\r\n    return [\r\n      {\r\n        type: 'value',\r\n        value: collection.items\r\n      }\r\n    ];\r\n  },\r\n  inputs: {},\r\n  outputs: {\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection;\r\n      }\r\n    },\r\n    firstItemId: {\r\n      type: 'string',\r\n      displayName: 'First Record Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        if (this._internal.collection) {\r\n          var firstItem = this._internal.collection.get(0);\r\n          if (firstItem !== undefined) return firstItem.getId();\r\n        }\r\n      }\r\n    },\r\n    isEmpty: {\r\n      type: 'boolean',\r\n      displayName: 'Is Empty',\r\n      group: 'General',\r\n      getter: function () {\r\n        if (this._internal.collection) {\r\n          return this._internal.collection.size() === 0;\r\n        }\r\n        return true;\r\n      }\r\n    },\r\n    count: {\r\n      type: 'number',\r\n      displayName: 'Count',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection ? this._internal.collection.size() : 0;\r\n      }\r\n    },\r\n    fetched: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Success'\r\n    },\r\n    failure: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Failure'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionName: function (name) {\r\n      this._internal.name = name;\r\n\r\n      if (this.isInputConnected('storageFetch') === false) this.scheduleFetch();\r\n    },\r\n    setCollection: function (collection) {\r\n      this.bindCollection(collection);\r\n      this.flagOutputDirty('firstItemId');\r\n      this.flagOutputDirty('isEmpty');\r\n      this.flagOutputDirty('items');\r\n      this.flagOutputDirty('count');\r\n    },\r\n    unbindCurrentCollection: function () {\r\n      var collection = this._internal.collection;\r\n      if (!collection) return;\r\n      collection.off('change', this._internal.collectionChangedCallback);\r\n      this._internal.collection = undefined;\r\n    },\r\n    bindCollection: function (collection) {\r\n      this.unbindCurrentCollection();\r\n      this._internal.collection = collection;\r\n      collection && collection.on('change', this._internal.collectionChangedCallback);\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this.unbindCurrentCollection();\r\n\r\n      const cloudstore = CloudStore.forScope(this.nodeScope.modelScope);\r\n      cloudstore.off('insert', this._internal.cloudStoreEvents);\r\n      cloudstore.off('delete', this._internal.cloudStoreEvents);\r\n      cloudstore.off('save', this._internal.cloudStoreEvents);\r\n    },\r\n    setError: function (err) {\r\n      this._internal.err = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n    },\r\n    scheduleFetch: function () {\r\n      var internal = this._internal;\r\n\r\n      if (internal.fetchScheduled) return;\r\n      internal.fetchScheduled = true;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        internal.fetchScheduled = false;\r\n\r\n        this.fetch();\r\n      });\r\n    },\r\n    fetch: function () {\r\n      if (this.context.editorConnection) {\r\n        if (this._internal.name === undefined) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'query-collection', {\r\n            message: 'No collection specified for query'\r\n          });\r\n        } else {\r\n          this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'query-collection');\r\n        }\r\n      }\r\n\r\n      const _c = Collection.get();\r\n      const f = this.getStorageFilter();\r\n      const limit = this.getStorageLimit();\r\n      const skip = this.getStorageSkip();\r\n      const count = this.getStorageFetchTotalCount();\r\n      this._internal.currentQuery = {\r\n        where: f.where,\r\n        sort: f.sort,\r\n        limit: limit,\r\n        skip: skip\r\n      };\r\n      CloudStore.forScope(this.nodeScope.modelScope).query({\r\n        collection: this._internal.name,\r\n        where: f.where,\r\n        sort: f.sort,\r\n        limit: limit,\r\n        skip: skip,\r\n        count: count,\r\n        success: (results, count) => {\r\n          if (results !== undefined) {\r\n            _c.set(\r\n              results.map((i) => {\r\n                var m = CloudStore._fromJSON(i, this._internal.name, this.nodeScope.modelScope);\r\n\r\n                return m;\r\n              })\r\n            );\r\n          }\r\n          if (count !== undefined) {\r\n            this._internal.storageSettings.storageTotalCount = count;\r\n            if (this.hasOutput('storageTotalCount')) this.flagOutputDirty('storageTotalCount');\r\n          }\r\n          this.setCollection(_c);\r\n          this.sendSignalOnOutput('fetched');\r\n        },\r\n        error: (err) => {\r\n          this.setCollection(_c);\r\n          this.setError(err || 'Failed to fetch.');\r\n        }\r\n      });\r\n    },\r\n    getStorageFilter: function () {\r\n      const storageSettings = this._internal.storageSettings;\r\n      if (storageSettings['storageFilterType'] === undefined || storageSettings['storageFilterType'] === 'simple') {\r\n        // Create simple filter\r\n        const _where =\r\n          this._internal.visualFilter !== undefined\r\n            ? QueryUtils.convertVisualFilter(this._internal.visualFilter, {\r\n                queryParameters: this._internal.queryParameters,\r\n                collectionName: this._internal.name\r\n              })\r\n            : undefined;\r\n\r\n        const _sort =\r\n          this._internal.visualSorting !== undefined\r\n            ? QueryUtils.convertVisualSorting(this._internal.visualSorting)\r\n            : undefined;\r\n\r\n        return {\r\n          where: _where,\r\n          sort: _sort\r\n        };\r\n      } else if (storageSettings['storageFilterType'] === 'json') {\r\n        // JSON filter\r\n        if (!this._internal.filterFunc) {\r\n          try {\r\n            var filterCode = storageSettings['storageJSONFilter'];\r\n\r\n            // Parse out variables\r\n            filterCode = filterCode.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g, ''); // Remove comments\r\n            this._internal.filterVariables = filterCode.match(/\\$[A-Za-z0-9]+/g) || [];\r\n\r\n            var args = ['filter', 'where', 'sort', 'Inputs']\r\n              .concat(this._internal.filterVariables)\r\n              .concat([filterCode]);\r\n            this._internal.filterFunc = Function.apply(null, args);\r\n          } catch (e) {\r\n            this._internal.filterFunc = undefined;\r\n            console.log('Error while parsing filter script: ' + e);\r\n          }\r\n        }\r\n\r\n        if (!this._internal.filterFunc) return;\r\n\r\n        var _filter = {},\r\n          _sort = [],\r\n          _this = this;\r\n\r\n        // Collect filter variables\r\n        var _filterCb = function (f) {\r\n          _filter = QueryUtils.convertFilterOp(f, {\r\n            collectionName: _this._internal.name,\r\n            error: function (err) {\r\n              _this.context.editorConnection.sendWarning(\r\n                _this.nodeScope.componentOwner.name,\r\n                _this.id,\r\n                'query-collection-filter',\r\n                {\r\n                  message: err\r\n                }\r\n              );\r\n            }\r\n          });\r\n        };\r\n        var _sortCb = function (s) {\r\n          _sort = s;\r\n        };\r\n\r\n        // Extract inputs\r\n        const inputs = {};\r\n        for (let key in storageSettings) {\r\n          if (key.startsWith('storageFilterValue-'))\r\n            inputs[key.substring('storageFilterValue-'.length)] = storageSettings[key];\r\n        }\r\n\r\n        var filterFuncArgs = [_filterCb, _filterCb, _sortCb, inputs]; // One for filter, one for where\r\n\r\n        this._internal.filterVariables.forEach((v) => {\r\n          filterFuncArgs.push(storageSettings['storageFilterValue-' + v.substring(1)]);\r\n        });\r\n\r\n        // Run the code to get the filter\r\n        try {\r\n          this._internal.filterFunc.apply(this, filterFuncArgs);\r\n        } catch (e) {\r\n          console.log('Error while running filter script: ' + e);\r\n        }\r\n\r\n        return { where: _filter, sort: _sort };\r\n      }\r\n    },\r\n    getStorageLimit: function () {\r\n      const storageSettings = this._internal.storageSettings;\r\n\r\n      if (!storageSettings['storageEnableLimit']) return;\r\n      else return storageSettings['storageLimit'] || 10;\r\n    },\r\n    getStorageSkip: function () {\r\n      const storageSettings = this._internal.storageSettings;\r\n\r\n      if (!storageSettings['storageEnableLimit']) return;\r\n      else return storageSettings['storageSkip'] || 0;\r\n    },\r\n    getStorageFetchTotalCount: function () {\r\n      const storageSettings = this._internal.storageSettings;\r\n\r\n      return !!storageSettings['storageEnableCount'];\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerOutput(name, {\r\n        getter: userOutputGetter.bind(this, name)\r\n      });\r\n    },\r\n    setVisualFilter: function (value) {\r\n      this._internal.visualFilter = value;\r\n\r\n      if (this.isInputConnected('storageFetch') === false) this.scheduleFetch();\r\n    },\r\n    setVisualSorting: function (value) {\r\n      this._internal.visualSorting = value;\r\n\r\n      if (this.isInputConnected('storageFetch') === false) this.scheduleFetch();\r\n    },\r\n    setQueryParameter: function (name, value) {\r\n      this._internal.queryParameters[name] = value;\r\n\r\n      if (this.isInputConnected('storageFetch') === false) this.scheduleFetch();\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      var _this = this;\r\n\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('qp-'))\r\n        return this.registerInput(name, {\r\n          set: this.setQueryParameter.bind(this, name.substring('qp-'.length))\r\n        });\r\n\r\n      const dynamicSignals = {\r\n        storageFetch: this.scheduleFetch.bind(this)\r\n      };\r\n\r\n      if (dynamicSignals[name])\r\n        return this.registerInput(name, {\r\n          set: EdgeTriggeredInput.createSetter({\r\n            valueChangedToTrue: dynamicSignals[name]\r\n          })\r\n        });\r\n\r\n      const dynamicSetters = {\r\n        collectionName: this.setCollectionName.bind(this),\r\n        visualFilter: this.setVisualFilter.bind(this),\r\n        visualSort: this.setVisualSorting.bind(this)\r\n      };\r\n\r\n      if (dynamicSetters[name])\r\n        return this.registerInput(name, {\r\n          set: dynamicSetters[name]\r\n        });\r\n\r\n      this.registerInput(name, {\r\n        set: userInputSetter.bind(this, name)\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nfunction userOutputGetter(name) {\r\n  /* jshint validthis:true */\r\n  return this._internal.storageSettings[name];\r\n}\r\n\r\nfunction userInputSetter(name, value) {\r\n  /* jshint validthis:true */\r\n  this._internal.storageSettings[name] = value;\r\n\r\n  if (this.isInputConnected('storageFetch') === false) this.scheduleFetch();\r\n}\r\n\r\nconst _defaultJSONQuery =\r\n  '// Write your query script here, check out the reference documentation for examples\\n' + 'where({ })\\n';\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection, graphModel) {\r\n  var ports = [];\r\n\r\n  const dbCollections = graphModel.getMetaData('dbCollections');\r\n  const systemCollections = graphModel.getMetaData('systemCollections');\r\n\r\n  const _systemClasses = [\r\n    { label: 'User', value: '_User' },\r\n    { label: 'Role', value: '_Role' }\r\n  ];\r\n  ports.push({\r\n    name: 'collectionName',\r\n    type: {\r\n      name: 'enum',\r\n      enums: _systemClasses.concat(\r\n        dbCollections !== undefined\r\n          ? dbCollections.map((c) => {\r\n              return { value: c.name, label: c.name };\r\n            })\r\n          : []\r\n      ),\r\n      allowEditOnly: true\r\n    },\r\n    displayName: 'Class',\r\n    plug: 'input',\r\n    group: 'General'\r\n  });\r\n\r\n  ports.push({\r\n    name: 'storageFilterType',\r\n    type: {\r\n      name: 'enum',\r\n      allowEditOnly: true,\r\n      enums: [\r\n        { value: 'simple', label: 'Visual' },\r\n        { value: 'json', label: 'Javascript' }\r\n      ]\r\n    },\r\n    displayName: 'Filter',\r\n    default: 'simple',\r\n    plug: 'input',\r\n    group: 'General'\r\n  });\r\n\r\n  // Limit\r\n  ports.push({\r\n    type: 'boolean',\r\n    plug: 'input',\r\n    group: 'Limit',\r\n    name: 'storageEnableLimit',\r\n    displayName: 'Use limit'\r\n  });\r\n\r\n  if (parameters['storageEnableLimit']) {\r\n    ports.push({\r\n      type: 'number',\r\n      default: 10,\r\n      plug: 'input',\r\n      group: 'Limit',\r\n      name: 'storageLimit',\r\n      displayName: 'Limit'\r\n    });\r\n\r\n    ports.push({\r\n      type: 'number',\r\n      default: 0,\r\n      plug: 'input',\r\n      group: 'Limit',\r\n      name: 'storageSkip',\r\n      displayName: 'Skip'\r\n    });\r\n  }\r\n\r\n  ports.push({\r\n    type: 'signal',\r\n    plug: 'input',\r\n    group: 'Actions',\r\n    name: 'storageFetch',\r\n    displayName: 'Do'\r\n  });\r\n\r\n  // Total Count\r\n  ports.push({\r\n    type: 'boolean',\r\n    plug: 'input',\r\n    group: 'Total Count',\r\n    name: 'storageEnableCount',\r\n    displayName: 'Fetch total count'\r\n  });\r\n\r\n  if (parameters['storageEnableCount']) {\r\n    ports.push({\r\n      type: 'number',\r\n      plug: 'output',\r\n      group: 'General',\r\n      name: 'storageTotalCount',\r\n      displayName: 'Total Count'\r\n    });\r\n  }\r\n\r\n  // Simple query\r\n  if (parameters['storageFilterType'] === undefined || parameters['storageFilterType'] === 'simple') {\r\n    if (parameters.collectionName !== undefined) {\r\n      var c = dbCollections && dbCollections.find((c) => c.name === parameters.collectionName);\r\n      if (c === undefined && systemCollections) c = systemCollections.find((c) => c.name === parameters.collectionName);\r\n      if (c && c.schema && c.schema.properties) {\r\n        const schema = JSON.parse(JSON.stringify(c.schema));\r\n\r\n        // Find all records that have a relation with this type\r\n        function _findRelations(c) {\r\n          if (c.schema !== undefined && c.schema.properties !== undefined)\r\n            for (var key in c.schema.properties) {\r\n              var p = c.schema.properties[key];\r\n              if (p.type === 'Relation' && p.targetClass === parameters.collectionName) {\r\n                if (schema.relations === undefined) schema.relations = {};\r\n                if (schema.relations[c.name] === undefined) schema.relations[c.name] = [];\r\n\r\n                schema.relations[c.name].push({ property: key });\r\n              }\r\n            }\r\n        }\r\n\r\n        dbCollections && dbCollections.forEach(_findRelations);\r\n        systemCollections && systemCollections.forEach(_findRelations);\r\n\r\n        ports.push({\r\n          name: 'visualFilter',\r\n          plug: 'input',\r\n          type: { name: 'query-filter', schema: schema, allowEditOnly: true },\r\n          displayName: 'Filter',\r\n          group: 'Filter'\r\n        });\r\n\r\n        ports.push({\r\n          name: 'visualSort',\r\n          plug: 'input',\r\n          type: { name: 'query-sorting', schema: schema, allowEditOnly: true },\r\n          displayName: 'Sort',\r\n          group: 'Sorting'\r\n        });\r\n      }\r\n\r\n      if (parameters.visualFilter !== undefined) {\r\n        // Find all input ports\r\n        const uniqueInputs = {};\r\n        function _collectInputs(query) {\r\n          if (query === undefined) return;\r\n          if (query.rules !== undefined) query.rules.forEach((r) => _collectInputs(r));\r\n          else if (query.input !== undefined) uniqueInputs[query.input] = true;\r\n        }\r\n\r\n        _collectInputs(parameters.visualFilter);\r\n        Object.keys(uniqueInputs).forEach((input) => {\r\n          ports.push({\r\n            name: 'qp-' + input,\r\n            plug: 'input',\r\n            type: '*',\r\n            displayName: input,\r\n            group: 'Query Parameters'\r\n          });\r\n        });\r\n      }\r\n    }\r\n  }\r\n  // JSON query\r\n  else if (parameters['storageFilterType'] === 'json') {\r\n    ports.push({\r\n      type: { name: 'string', allowEditOnly: true, codeeditor: 'javascript' },\r\n      plug: 'input',\r\n      group: 'Filter',\r\n      name: 'storageJSONFilter',\r\n      default: _defaultJSONQuery,\r\n      displayName: 'Filter'\r\n    });\r\n\r\n    var filter = parameters['storageJSONFilter'];\r\n    if (filter) {\r\n      filter = filter.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g, ''); // Remove comments\r\n      var variables = filter.match(/\\$[A-Za-z0-9]+/g);\r\n\r\n      if (variables) {\r\n        const unique = {};\r\n        variables.forEach((v) => {\r\n          unique[v] = true;\r\n        });\r\n\r\n        Object.keys(unique).forEach((p) => {\r\n          ports.push({\r\n            name: 'storageFilterValue-' + p.substring(1),\r\n            displayName: p.substring(1),\r\n            group: 'Filter Values',\r\n            plug: 'input',\r\n            type: { name: '*', allowConnectionsOnly: true }\r\n          });\r\n        });\r\n      }\r\n\r\n      // Support variables with the \"Inputs.\"\" syntax\r\n      JavascriptNodeParser.parseAndAddPortsFromScript(filter, ports, {\r\n        inputPrefix: 'storageFilterValue-',\r\n        inputGroup: 'Filter Values',\r\n        inputType: { name: '*', allowConnectionsOnly: true },\r\n        skipOutputs: true\r\n      });\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nmodule.exports = {\r\n  node: DbCollectionNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, graphModel);\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        if (event.name.startsWith('storage') || event.name === 'visualFilter' || event.name === 'collectionName') {\r\n          updatePorts(node.id, node.parameters, context.editorConnection, graphModel);\r\n        }\r\n      });\r\n\r\n      graphModel.on('metadataChanged.dbCollections', function (data) {\r\n        CloudStore.invalidateCollections();\r\n        updatePorts(node.id, node.parameters, context.editorConnection, graphModel);\r\n      });\r\n\r\n      graphModel.on('metadataChanged.systemCollections', function (data) {\r\n        CloudStore.invalidateCollections();\r\n        updatePorts(node.id, node.parameters, context.editorConnection, graphModel);\r\n      });\r\n\r\n      graphModel.on('metadataChanged.cloudservices', function (data) {\r\n        CloudStore.instance._initCloudServices();\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.DbCollection2', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('DbCollection2')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst ConfigService = require('../../../api/configservice');\r\n\r\nvar ConfigNodeDefinition = {\r\n  name: 'DbConfig',\r\n  docs: 'https://docs.noodl.net/nodes/data/cloud-data/config',\r\n  displayNodeName: 'Config',\r\n  category: 'Cloud Services',\r\n  usePortAsLabel: 'configKey',\r\n  color: 'data',\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n\r\n    ConfigService.instance.getConfig().then((config) => {\r\n      internal.config = config;\r\n      if (this.hasOutput('value')) this.flagOutputDirty('value');\r\n    });\r\n  },\r\n  getInspectInfo() {\r\n    const value = this.getValue();\r\n\r\n    if (value === undefined) return '[No Value]';\r\n\r\n    return [{ type: 'value', value: value }];\r\n  },\r\n  inputs: {},\r\n  outputs: {},\r\n  methods: {\r\n    getValue: function () {\r\n      const internal = this._internal;\r\n      if (internal.useDevValue && this.context.editorConnection && this.context.editorConnection.isRunningLocally()) {\r\n        return internal.devValue;\r\n      } else if (internal.config !== undefined && internal.configKey !== undefined) {\r\n        return internal.config[internal.configKey];\r\n      }\r\n    },\r\n    setInternal: function (key, value) {\r\n      this._internal[key] = value;\r\n      if (this.hasOutput('value')) this.flagOutputDirty('value');\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'value')\r\n        return this.registerOutput(name, {\r\n          getter: this.getValue.bind(this)\r\n        });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'configKey' || name === 'useDevValue' || name === 'devValue')\r\n        return this.registerInput(name, {\r\n          set: this.setInternal.bind(this, name)\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: ConfigNodeDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function updatePorts(node) {\r\n      var ports = [];\r\n\r\n      context.editorConnection.clearWarning(node.component.name, node.id, 'dbconfig-warning');\r\n\r\n      const configSchema = graphModel.getMetaData('dbConfigSchema');\r\n      let valueType;\r\n\r\n      if (configSchema) {\r\n        const isCloud = typeof _noodl_cloud_runtime_version !== 'undefined';\r\n        ports.push({\r\n          name: 'configKey',\r\n          displayName: 'Parameter',\r\n          group: 'General',\r\n          type: {\r\n            name: 'enum',\r\n            enums: Object.keys(configSchema)\r\n              .filter((k) => isCloud || !configSchema[k].masterKeyOnly)\r\n              .map((k) => ({ value: k, label: k })),\r\n            allowEditOnly: true\r\n          },\r\n          plug: 'input'\r\n        });\r\n\r\n        if (node.parameters['configKey'] !== undefined && configSchema && configSchema[node.parameters['configKey']]) {\r\n          valueType = configSchema[node.parameters['configKey']].type;\r\n\r\n          if (\r\n            valueType === 'string' ||\r\n            valueType === 'boolean' ||\r\n            valueType === 'number' ||\r\n            valueType === 'object' ||\r\n            valueType === 'array'\r\n          ) {\r\n            ports.push({\r\n              name: 'useDevValue',\r\n              displayName: 'Enable',\r\n              group: 'Local Override',\r\n              type: 'boolean',\r\n              default: false,\r\n              plug: 'input'\r\n            });\r\n\r\n            if (node.parameters['useDevValue'] === true) {\r\n              ports.push({\r\n                name: 'devValue',\r\n                displayName: 'Value',\r\n                group: 'Local Override',\r\n                type: valueType,\r\n                plug: 'input'\r\n              });\r\n            }\r\n          }\r\n        } else if (node.parameters['configKey'] !== undefined) {\r\n          context.editorConnection.sendWarning(node.component.name, node.id, 'dbconfig-warning', {\r\n            showGlobally: true,\r\n            message: node.parameters['configKey'] + ' config parameter is missing, add it to your cloud service.'\r\n          });\r\n        }\r\n      } else {\r\n        context.editorConnection.sendWarning(node.component.name, node.id, 'dbconfig-warning', {\r\n          showGlobally: true,\r\n          message: 'You need an active cloud service.'\r\n        });\r\n      }\r\n\r\n      ports.push({\r\n        name: 'value',\r\n        displayName: 'Value',\r\n        group: 'General',\r\n        type: valueType || '*',\r\n        plug: 'output'\r\n      });\r\n\r\n      context.editorConnection.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      updatePorts(node);\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        updatePorts(node);\r\n      });\r\n\r\n      graphModel.on('metadataChanged.dbConfigSchema', function (data) {\r\n        ConfigService.instance.clearCache();\r\n        updatePorts(node);\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.DbConfig', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('DbConfig')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst Model = require('../../../model');\r\nconst CloudStore = require('../../../api/cloudstore');\r\n\r\nfunction _addBaseInfo(def, opts) {\r\n  const _includeInputProperties = opts === undefined || opts.includeInputProperties;\r\n  const _includeRelations = opts !== undefined && opts.includeRelations;\r\n\r\n  Object.assign(def.node, {\r\n    category: 'Data',\r\n    color: 'data',\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {}\r\n  });\r\n\r\n  // Outputs\r\n  Object.assign(def.node.outputs, {\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  });\r\n\r\n  // Methods\r\n  Object.assign(def.node.methods, {\r\n    scheduleOnce: function (type, cb) {\r\n      const _this = this;\r\n      const _type = 'hasScheduled' + type;\r\n      if (this._internal[_type]) return;\r\n      this._internal[_type] = true;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this._internal[_type] = false;\r\n        cb();\r\n      });\r\n    },\r\n    checkWarningsBeforeCloudOp() {\r\n      //clear all errors first\r\n      this.clearWarnings();\r\n\r\n      if (!this._internal.collectionId) {\r\n        this.setError('No class name specified');\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    },\r\n    setError: function (err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'storage-op-warning', {\r\n          message: err,\r\n          showGlobally: true\r\n        });\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'storage-op-warning');\r\n      }\r\n    }\r\n  });\r\n\r\n  // Setup\r\n  Object.assign(def, {\r\n    setup: function (context, graphModel) {\r\n      if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n        return;\r\n      }\r\n\r\n      function _managePortsForNode(node) {\r\n        function _updatePorts() {\r\n          var ports = [];\r\n\r\n          const dbCollections = graphModel.getMetaData('dbCollections');\r\n          const systemCollections = graphModel.getMetaData('systemCollections');\r\n\r\n          const _systemClasses = [\r\n            { label: 'User', value: '_User' },\r\n            { label: 'Role', value: '_Role' }\r\n          ];\r\n\r\n          const parameters = node.parameters;\r\n\r\n          ports.push({\r\n            name: 'collectionName',\r\n            displayName: 'Class',\r\n            group: 'General',\r\n            type: {\r\n              name: 'enum',\r\n              enums: _systemClasses.concat(\r\n                dbCollections !== undefined\r\n                  ? dbCollections.map((c) => {\r\n                      return { value: c.name, label: c.name };\r\n                    })\r\n                  : []\r\n              ),\r\n              allowEditOnly: true\r\n            },\r\n            plug: 'input'\r\n          });\r\n\r\n          if (_includeRelations && parameters.collectionName && dbCollections) {\r\n            // Fetch ports from collection keys\r\n            var c = dbCollections.find((c) => c.name === parameters.collectionName);\r\n            if (c === undefined && systemCollections)\r\n              c = systemCollections.find((c) => c.name === parameters.collectionName);\r\n            if (c && c.schema && c.schema.properties) {\r\n              const props = c.schema.properties;\r\n              const enums = Object.keys(props)\r\n                .filter((key) => props[key].type === 'Relation')\r\n                .map((key) => ({ label: key, value: key }));\r\n\r\n              ports.push({\r\n                name: 'relationProperty',\r\n                displayName: 'Relation',\r\n                group: 'General',\r\n                type: { name: 'enum', enums: enums, allowEditOnly: true },\r\n                plug: 'input'\r\n              });\r\n            }\r\n          }\r\n\r\n          if (_includeInputProperties && parameters.collectionName && dbCollections) {\r\n            const _typeMap = {\r\n              String: 'string',\r\n              Boolean: 'boolean',\r\n              Number: 'number',\r\n              Date: 'date'\r\n            };\r\n\r\n            // Fetch ports from collection keys\r\n            var c = dbCollections.find((c) => c.name === parameters.collectionName);\r\n            if (c === undefined && systemCollections)\r\n              c = systemCollections.find((c) => c.name === parameters.collectionName);\r\n            if (c && c.schema && c.schema.properties) {\r\n              var props = c.schema.properties;\r\n              for (var key in props) {\r\n                var p = props[key];\r\n                if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n                ports.push({\r\n                  type: {\r\n                    name: _typeMap[p.type] ? _typeMap[p.type] : '*'\r\n                  },\r\n                  plug: 'input',\r\n                  group: 'Properties',\r\n                  name: 'prop-' + key,\r\n                  displayName: key\r\n                });\r\n              }\r\n            }\r\n          }\r\n\r\n          def._additionalDynamicPorts && def._additionalDynamicPorts(node, ports, graphModel);\r\n\r\n          context.editorConnection.sendDynamicPorts(node.id, ports);\r\n        }\r\n\r\n        _updatePorts();\r\n\r\n        node.on('parameterUpdated', function (event) {\r\n          _updatePorts();\r\n        });\r\n\r\n        graphModel.on('metadataChanged.dbCollections', function (data) {\r\n          CloudStore.invalidateCollections();\r\n          _updatePorts();\r\n        });\r\n\r\n        graphModel.on('metadataChanged.systemCollections', function (data) {\r\n          CloudStore.invalidateCollections();\r\n          _updatePorts();\r\n        });\r\n      }\r\n\r\n      graphModel.on('editorImportComplete', () => {\r\n        graphModel.on('nodeAdded.' + def.node.name, function (node) {\r\n          _managePortsForNode(node);\r\n        });\r\n\r\n        for (const node of graphModel.getNodesWithType(def.node.name)) {\r\n          _managePortsForNode(node);\r\n        }\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nfunction _addModelId(def, opts) {\r\n  var _def = { node: Object.assign({}, def.node), setup: def.setup };\r\n  var _methods = Object.assign({}, def.node.methods);\r\n\r\n  const _includeInputs = opts === undefined || opts.includeInputs;\r\n  const _includeOutputs = opts === undefined || opts.includeOutputs;\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {}\r\n  });\r\n\r\n  if (_includeInputs) {\r\n    Object.assign(def.node, {\r\n      usePortAsLabel: 'collectionName'\r\n    });\r\n\r\n    def.node.dynamicports = (def.node.dynamicports || []).concat([\r\n      {\r\n        name: 'conditionalports/extended',\r\n        condition: 'idSource = explicit OR idSource NOT SET',\r\n        inputs: ['modelId']\r\n      }\r\n    ]);\r\n\r\n    // Inputs\r\n    Object.assign(def.node.inputs, {\r\n      idSource: {\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'Specify explicitly', value: 'explicit' },\r\n            { label: 'From repeater', value: 'foreach' }\r\n          ],\r\n          allowEditOnly: true\r\n        },\r\n        default: 'explicit',\r\n        displayName: 'Id Source',\r\n        group: 'General',\r\n        tooltip:\r\n          'Choose if you want to specify the Id explicitly, \\n or if you want it to be that of the current record in a repeater.',\r\n        set: function (value) {\r\n          if (value === 'foreach') {\r\n            this.scheduleAfterInputsHaveUpdated(() => {\r\n              // Find closest nodescope that have a _forEachModel\r\n              var component = this.nodeScope.componentOwner;\r\n              while (component !== undefined && component._forEachModel === undefined && component.parentNodeScope) {\r\n                component = component.parentNodeScope.componentOwner;\r\n              }\r\n              this.setModel(component !== undefined ? component._forEachModel : undefined);\r\n            });\r\n          }\r\n        }\r\n      },\r\n      modelId: {\r\n        type: {\r\n          name: 'string',\r\n          identifierOf: 'ModelName',\r\n          identifierDisplayName: 'Object Ids'\r\n        },\r\n        displayName: 'Id',\r\n        group: 'General',\r\n        set: function (value) {\r\n          if (value instanceof Model) value = value.getId(); // Can be passed as model as well\r\n          this._internal.modelId = value; // Wait to fetch data\r\n          this.setModelID(value);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // Outputs\r\n  if (_includeOutputs) {\r\n    Object.assign(def.node.outputs, {\r\n      id: {\r\n        type: 'string',\r\n        displayName: 'Id',\r\n        group: 'General',\r\n        getter: function () {\r\n          return this._internal.model ? this._internal.model.getId() : this._internal.modelId;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // Methods\r\n  Object.assign(def.node.methods, {\r\n    setCollectionID: function (id) {\r\n      this._internal.collectionId = id;\r\n      this.clearWarnings();\r\n    },\r\n    setModelID: function (id) {\r\n      var model = (this.nodeScope.modelScope || Model).get(id);\r\n      this.setModel(model);\r\n    },\r\n    setModel: function (model) {\r\n      this._internal.model = model;\r\n      this.flagOutputDirty('id');\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'collectionName')\r\n        this.registerInput(name, {\r\n          set: this.setCollectionID.bind(this)\r\n        });\r\n\r\n      _methods && _methods.registerInputIfNeeded && _methods.registerInputIfNeeded.call(this, name);\r\n    }\r\n  });\r\n}\r\n\r\nfunction _addInputProperties(def) {\r\n  var _def = { node: Object.assign({}, def.node), setup: def.setup };\r\n  var _methods = Object.assign({}, def.node.methods);\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {}\r\n  });\r\n\r\n  Object.assign(def.node, {\r\n    initialize: function () {\r\n      var internal = this._internal;\r\n      internal.inputValues = {};\r\n\r\n      _def.node.initialize && _def.node.initialize.call(this);\r\n    }\r\n  });\r\n\r\n  // Outputs\r\n  Object.assign(def.node.outputs, {});\r\n\r\n  // Inputs\r\n  Object.assign(def.node.inputs, {});\r\n\r\n  // Methods\r\n  Object.assign(def.node.methods, {\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('prop-'))\r\n        this.registerInput(name, {\r\n          set: this._setInputValue.bind(this, name.substring('prop-'.length))\r\n        });\r\n\r\n      _methods && _methods.registerInputIfNeeded && _methods.registerInputIfNeeded.call(this, name);\r\n    },\r\n    _setInputValue: function (name, value) {\r\n      this._internal.inputValues[name] = value;\r\n    }\r\n  });\r\n}\r\n\r\nfunction _addRelationProperty(def) {\r\n  var _def = { node: Object.assign({}, def.node), setup: def.setup };\r\n  var _methods = Object.assign({}, def.node.methods);\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {}\r\n  });\r\n\r\n  // Inputs\r\n  Object.assign(def.node.inputs, {\r\n    targetId: {\r\n      type: { name: 'string', allowConnectionsOnly: true },\r\n      displayName: 'Target Record Id',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.targetModelId = value;\r\n      }\r\n    }\r\n  });\r\n\r\n  // Methods\r\n  Object.assign(def.node.methods, {\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'relationProperty')\r\n        this.registerInput(name, {\r\n          set: this.setRelationProperty.bind(this)\r\n        });\r\n\r\n      _methods && _methods.registerInputIfNeeded && _methods.registerInputIfNeeded.call(this, name);\r\n    },\r\n    setRelationProperty: function (value) {\r\n      this._internal.relationProperty = value;\r\n    }\r\n  });\r\n}\r\n\r\nfunction _getCurrentUser(modelScope) {\r\n  if (typeof _noodl_cloud_runtime_version === 'undefined') {\r\n    // We are running in browser, try to find the current user\r\n\r\n    var _cu = localStorage['Parse/' + CloudStore.instance.appId + '/currentUser'];\r\n    if (_cu !== undefined) {\r\n      let cu;\r\n      try {\r\n        cu = JSON.parse(_cu);\r\n      } catch (e) {}\r\n\r\n      return cu !== undefined ? cu.objectId : undefined;\r\n    }\r\n  } else {\r\n    // Assume we are running in cloud runtime\r\n    const request = modelScope.get('Request');\r\n    return request.UserId;\r\n  }\r\n}\r\n\r\nfunction _addAccessControl(def) {\r\n  var _def = { node: Object.assign({}, def.node), setup: def.setup };\r\n  var _methods = Object.assign({}, def.node.methods);\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {}\r\n  });\r\n\r\n  Object.assign(def.node, {\r\n    initialize: function () {\r\n      var internal = this._internal;\r\n      internal.accessControl = {};\r\n\r\n      _def.node.initialize && _def.node.initialize.call(this);\r\n    }\r\n  });\r\n\r\n  // Inputs\r\n  Object.assign(def.node.inputs, {\r\n    accessControl: {\r\n      type: { name: 'proplist', autoName: 'Rule', allowEditOnly: true },\r\n      index: 1000,\r\n      displayName: 'Access Control Rules',\r\n      group: 'Access Control Rules',\r\n      set: function (value) {\r\n        this._internal.accessControlRules = value;\r\n      }\r\n    }\r\n  });\r\n\r\n  // Dynamic ports\r\n  const _super = def._additionalDynamicPorts;\r\n  def._additionalDynamicPorts = function (node, ports, graphModel) {\r\n    if (node.parameters['accessControl'] !== undefined && node.parameters['accessControl'].length > 0) {\r\n      node.parameters['accessControl'].forEach((ac) => {\r\n        const prefix = 'acl-' + ac.id;\r\n        // User or role?\r\n        ports.push({\r\n          name: prefix + '-target',\r\n          displayName: 'Target',\r\n          editorName: ac.label + ' | Target',\r\n          plug: 'input',\r\n          type: {\r\n            name: 'enum',\r\n            enums: [\r\n              { value: 'user', label: 'User' },\r\n              { value: 'everyone', label: 'Everyone' },\r\n              { value: 'role', label: 'Role' }\r\n            ],\r\n            allowEditOnly: true\r\n          },\r\n          group: ac.label + ' Access Rule',\r\n          default: 'user',\r\n          parent: 'accessControl',\r\n          parentItemId: ac.id\r\n        });\r\n\r\n        if (node.parameters[prefix + '-target'] === 'role') {\r\n          ports.push({\r\n            name: prefix + '-role',\r\n            displayName: 'Role',\r\n            editorName: ac.label + ' | Role',\r\n            group: ac.label + ' Access Rule',\r\n            plug: 'input',\r\n            type: 'string',\r\n            parent: 'accessControl',\r\n            parentItemId: ac.id\r\n          });\r\n        } else if (\r\n          node.parameters[prefix + '-target'] === undefined ||\r\n          node.parameters[prefix + '-target'] === 'user'\r\n        ) {\r\n          ports.push({\r\n            name: prefix + '-userid',\r\n            displayName: 'User Id',\r\n            group: ac.label + ' Access Rule',\r\n            editorName: ac.label + ' | User Id',\r\n            plug: 'input',\r\n            type: { name: 'string', allowConnectionsOnly: true },\r\n            parent: 'accessControl',\r\n            parentItemId: ac.id\r\n          });\r\n        }\r\n\r\n        // Read\r\n        ports.push({\r\n          name: prefix + '-read',\r\n          displayName: 'Read',\r\n          editorName: ac.label + ' | Read',\r\n          group: ac.label + ' Access Rule',\r\n          plug: 'input',\r\n          type: { name: 'boolean' },\r\n          default: true,\r\n          parent: 'accessControl',\r\n          parentItemId: ac.id\r\n        });\r\n\r\n        // Write\r\n        ports.push({\r\n          name: prefix + '-write',\r\n          displayName: 'Write',\r\n          editorName: ac.label + ' | Write',\r\n          group: ac.label + ' Access Rule',\r\n          plug: 'input',\r\n          type: { name: 'boolean' },\r\n          default: true,\r\n          parent: 'accessControl',\r\n          parentItemId: ac.id\r\n        });\r\n      });\r\n    }\r\n\r\n    _super && _super(node, ports, graphModel);\r\n  };\r\n\r\n  // Methods\r\n  Object.assign(def.node.methods, {\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('acl-'))\r\n        this.registerInput(name, {\r\n          set: this.setAccessControl.bind(this, name)\r\n        });\r\n\r\n      _methods && _methods.registerInputIfNeeded && _methods.registerInputIfNeeded.call(this, name);\r\n    },\r\n    _getACL: function () {\r\n      let acl = {};\r\n\r\n      function _rule(rule) {\r\n        return {\r\n          read: rule.read === undefined ? true : rule.read,\r\n          write: rule.write === undefined ? true : rule.write\r\n        };\r\n      }\r\n\r\n      const currentUserId = _getCurrentUser(this.nodeScope.modelScope);\r\n\r\n      if (this._internal.accessControlRules !== undefined) {\r\n        this._internal.accessControlRules.forEach((r) => {\r\n          const rule = this._internal.accessControl[r.id];\r\n\r\n          if (rule === undefined) {\r\n            const userId = currentUserId;\r\n            if (userId !== undefined) acl[userId] = { write: true, read: true };\r\n          } else if (rule.target === 'everyone') {\r\n            acl['*'] = _rule(rule);\r\n          } else if (rule.target === 'user') {\r\n            const userId = rule.userid || currentUserId;\r\n            acl[userId] = _rule(rule);\r\n          } else if (rule.target === 'role') {\r\n            acl['role:' + rule.role] = _rule(rule);\r\n          }\r\n        });\r\n      }\r\n\r\n      return Object.keys(acl).length > 0 ? acl : undefined;\r\n    },\r\n    setAccessControl: function (name, value) {\r\n      const _parts = name.split('-');\r\n\r\n      if (this._internal.accessControl[_parts[1]] === undefined) this._internal.accessControl[_parts[1]] = {};\r\n      this._internal.accessControl[_parts[1]][_parts[2]] = value;\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  addInputProperties: _addInputProperties,\r\n  addModelId: _addModelId,\r\n  addBaseInfo: _addBaseInfo,\r\n  addRelationProperty: _addRelationProperty,\r\n  addAccessControl: _addAccessControl\r\n};\r\n","'use strict';\r\n\r\nvar Model = require('../../../model');\r\nvar DbModelCRUDBase = require('./dbmodelcrudbase');\r\nconst CloudStore = require('../../../api/cloudstore');\r\n\r\nvar AddDbModelRelationNodeDefinition = {\r\n  node: {\r\n    name: 'AddDbModelRelation',\r\n    docs: 'https://docs.noodl.net/nodes/data/cloud-data/add-record-relation',\r\n    displayNodeName: 'Add Record Relation',\r\n    usePortAsLabel: 'collectionName',\r\n    // shortDesc: \"Stores any amount of properties and can be used standalone or together with Collections and For Each nodes.\",\r\n    inputs: {\r\n      store: {\r\n        displayName: 'Do',\r\n        group: 'Actions',\r\n        valueChangedToTrue: function () {\r\n          this.scheduleAddRelation();\r\n        }\r\n      }\r\n    },\r\n    outputs: {\r\n      relationAdded: {\r\n        type: 'signal',\r\n        displayName: 'Success',\r\n        group: 'Events'\r\n      }\r\n    },\r\n    methods: {\r\n      validateInputs: function () {\r\n        if (!this.context.editorConnection) return;\r\n\r\n        const _warning = (message) => {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'add-relation', {\r\n            message\r\n          });\r\n        };\r\n\r\n        if (this._internal.collectionId === undefined) {\r\n          _warning('No class specified');\r\n        } else if (this._internal.relationProperty === undefined) {\r\n          _warning('No relation property specified');\r\n        } else if (this._internal.targetModelId === undefined) {\r\n          _warning('No target record Id (the record to add a relation to) specified');\r\n        } else if (this._internal.model === undefined) {\r\n          _warning('No record Id specified (the record that should get the relation)');\r\n        } else {\r\n          this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'add-relation');\r\n        }\r\n      },\r\n      scheduleAddRelation: function (key) {\r\n        const _this = this;\r\n        const internal = this._internal;\r\n\r\n        this.scheduleOnce('StorageAddRelation', function () {\r\n          _this.validateInputs();\r\n\r\n          if (!internal.model) return;\r\n          var model = internal.model;\r\n\r\n          var targetModelId = internal.targetModelId;\r\n          if (targetModelId === undefined) return;\r\n\r\n          CloudStore.forScope(_this.nodeScope.modelScope).addRelation({\r\n            collection: internal.collectionId,\r\n            objectId: model.getId(),\r\n            key: internal.relationProperty,\r\n            targetObjectId: targetModelId,\r\n            targetClass: (_this.nodeScope.modelScope || Model).get(targetModelId)._class,\r\n            success: function (response) {\r\n              for (var _key in response) {\r\n                model.set(_key, response[_key]);\r\n              }\r\n\r\n              // Successfully added relation\r\n              _this.sendSignalOnOutput('relationAdded');\r\n            },\r\n            error: function (err) {\r\n              _this.setError(err || 'Failed to add relation.');\r\n            }\r\n          });\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nDbModelCRUDBase.addBaseInfo(AddDbModelRelationNodeDefinition, {\r\n  includeRelations: true\r\n});\r\nDbModelCRUDBase.addModelId(AddDbModelRelationNodeDefinition);\r\nDbModelCRUDBase.addRelationProperty(AddDbModelRelationNodeDefinition);\r\n\r\nmodule.exports = AddDbModelRelationNodeDefinition;\r\n","'use strict';\r\n\r\nvar Model = require('../../../model');\r\nvar DbModelCRUDBase = require('./dbmodelcrudbase');\r\nconst CloudStore = require('../../../api/cloudstore');\r\n\r\nvar AddDbModelRelationNodeDefinition = {\r\n  node: {\r\n    name: 'RemoveDbModelRelation',\r\n    docs: 'https://docs.noodl.net/nodes/data/cloud-data/remove-record-relation',\r\n    displayName: 'Remove Record Relation',\r\n    usePortAsLabel: 'collectionName',\r\n    inputs: {\r\n      store: {\r\n        displayName: 'Do',\r\n        group: 'Actions',\r\n        valueChangedToTrue: function () {\r\n          this.scheduleRemoveRelation();\r\n        }\r\n      }\r\n    },\r\n    outputs: {\r\n      relationRemoved: {\r\n        type: 'signal',\r\n        displayName: 'Success',\r\n        group: 'Events'\r\n      }\r\n    },\r\n    methods: {\r\n      validateInputs: function () {\r\n        if (!this.context.editorConnection) return;\r\n\r\n        const _warning = (message) => {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'add-relation', {\r\n            message\r\n          });\r\n        };\r\n\r\n        if (this._internal.collectionId === undefined) {\r\n          _warning('No class specified');\r\n        } else if (this._internal.relationProperty === undefined) {\r\n          _warning('No relation property specified');\r\n        } else if (this._internal.targetModelId === undefined) {\r\n          _warning('No target record Id (the record to add a relation to) specified');\r\n        } else if (this._internal.model === undefined) {\r\n          _warning('No record Id specified (the record that should get the relation)');\r\n        } else {\r\n          this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'add-relation');\r\n        }\r\n      },\r\n      scheduleRemoveRelation: function (key) {\r\n        const _this = this;\r\n        const internal = this._internal;\r\n\r\n        this.scheduleOnce('StorageRemoveRelation', function () {\r\n          _this.validateInputs();\r\n\r\n          if (!internal.model) return;\r\n          var model = internal.model;\r\n\r\n          var targetModelId = internal.targetModelId;\r\n          if (targetModelId === undefined) return;\r\n\r\n          CloudStore.forScope(_this.nodeScope.modelScope).removeRelation({\r\n            collection: internal.collectionId,\r\n            objectId: model.getId(),\r\n            key: internal.relationProperty,\r\n            targetObjectId: targetModelId,\r\n            targetClass: (_this.nodeScope.modelScope || Model).get(targetModelId)._class,\r\n            success: function (response) {\r\n              for (var _key in response) {\r\n                model.set(_key, response[_key]);\r\n              }\r\n\r\n              // Successfully removed relation\r\n              _this.sendSignalOnOutput('relationRemoved');\r\n            },\r\n            error: function (err) {\r\n              _this.setError(err || 'Failed to remove relation.');\r\n            }\r\n          });\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nDbModelCRUDBase.addBaseInfo(AddDbModelRelationNodeDefinition, {\r\n  includeRelations: true\r\n});\r\nDbModelCRUDBase.addModelId(AddDbModelRelationNodeDefinition);\r\nDbModelCRUDBase.addRelationProperty(AddDbModelRelationNodeDefinition);\r\n\r\nmodule.exports = AddDbModelRelationNodeDefinition;\r\n","'use strict';\r\n\r\nconst { Node, EdgeTriggeredInput } = require('../../../../noodl-runtime');\r\n\r\nconst Model = require('../../../model');\r\nconst CloudStore = require('../../../api/cloudstore');\r\n\r\nconst ModelNodeDefinition = {\r\n  name: 'DbModel2',\r\n  docs: 'https://docs.noodl.net/nodes/data/cloud-data/record',\r\n  displayNodeName: 'Record',\r\n  shortDesc: 'Database model',\r\n  category: 'Cloud Services',\r\n  usePortAsLabel: 'collectionName',\r\n  color: 'data',\r\n  dynamicports: [\r\n    {\r\n      name: 'conditionalports/extended',\r\n      condition: 'idSource = explicit OR idSource NOT SET',\r\n      inputs: ['modelId']\r\n    }\r\n  ],\r\n  initialize: function () {\r\n    const internal = this._internal;\r\n    internal.inputValues = {};\r\n    internal.relationModelIds = {};\r\n\r\n    const _this = this;\r\n    this._internal.onModelChangedCallback = function (args) {\r\n      if (_this.isInputConnected('fetch')) return;\r\n\r\n      if (_this.hasOutput('prop-' + args.name)) _this.flagOutputDirty('prop-' + args.name);\r\n\r\n      if (_this.hasOutput('changed-' + args.name)) _this.sendSignalOnOutput('changed-' + args.name);\r\n\r\n      _this.sendSignalOnOutput('changed');\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return '[No Record]';\r\n\r\n    return [\r\n      { type: 'text', value: 'Id: ' + model.getId() },\r\n      { type: 'value', value: model.data }\r\n    ];\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: 'string',\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.model ? this._internal.model.getId() : this._internal.modelId;\r\n      }\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    },\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    idSource: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Specify explicitly', value: 'explicit' },\r\n          { label: 'From repeater', value: 'foreach' }\r\n        ],\r\n        allowEditOnly: true\r\n      },\r\n      default: 'explicit',\r\n      displayName: 'Id Source',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value === 'foreach') {\r\n          this.scheduleAfterInputsHaveUpdated(() => {\r\n            // Find closest nodescope that have a _forEachModel\r\n            var component = this.nodeScope.componentOwner;\r\n            while (component !== undefined && component._forEachModel === undefined && component.parentNodeScope) {\r\n              component = component.parentNodeScope.componentOwner;\r\n            }\r\n            this.setModel(component !== undefined ? component._forEachModel : undefined);\r\n          });\r\n        }\r\n      }\r\n    },\r\n    modelId: {\r\n      type: { name: 'string', allowConnectionsOnly: true },\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value instanceof Model) {\r\n          // Can be passed as model as well\r\n          value = value.getId();\r\n        } else if (typeof value === 'object') {\r\n          // If this is an js object, dereference it\r\n          value = Model.create(value).getId();\r\n        }\r\n\r\n        this._internal.modelId = value; // Wait to fetch data\r\n        if (this.isInputConnected('fetch') === false) {\r\n          this.setModelID(value);\r\n        } else {\r\n          this.flagOutputDirty('id');\r\n        }\r\n      }\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleFetch();\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setCollectionID: function (id) {\r\n      this._internal.collectionId = id;\r\n    },\r\n    setModelID: function (id) {\r\n      var model = (this.nodeScope.modelScope || Model).get(id);\r\n      // this._internal.modelIsNew = false;\r\n      this.setModel(model);\r\n    },\r\n    setModel: function (model) {\r\n      if (this._internal.model) {\r\n        // Remove old listener if existing\r\n        this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n      }\r\n\r\n      this._internal.model = model;\r\n      this.flagOutputDirty('id');\r\n      model.on('change', this._internal.onModelChangedCallback);\r\n\r\n      // We have a new model, mark all outputs as dirty\r\n      for (var key in model.data) {\r\n        if (this.hasOutput('prop-' + key)) {\r\n          this.flagOutputDirty('prop-' + key);\r\n        }\r\n      }\r\n      this.sendSignalOnOutput('fetched');\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      if (this._internal.model) this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n    },\r\n    scheduleOnce: function (type, cb) {\r\n      const _this = this;\r\n      const _type = 'hasScheduled' + type;\r\n      if (this._internal[_type]) return;\r\n      this._internal[_type] = true;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this._internal[_type] = false;\r\n        cb();\r\n      });\r\n    },\r\n    setError: function (err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'storage-op-warning', {\r\n          message: err,\r\n          showGlobally: true\r\n        });\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'storage-op-warning');\r\n      }\r\n    },\r\n    scheduleFetch: function () {\r\n      const _this = this;\r\n      const internal = this._internal;\r\n\r\n      this.scheduleOnce('Fetch', function () {\r\n        // Don't do fetch if no id\r\n        if (internal.modelId === undefined || internal.modelId === '') {\r\n          _this.setError('Missing Id.');\r\n          return;\r\n        }\r\n\r\n        const cloudstore = CloudStore.forScope(_this.nodeScope.modelScope);\r\n        cloudstore.fetch({\r\n          collection: internal.collectionId,\r\n          objectId: internal.modelId, // Get the objectId part of the model id\r\n          success: function (response) {\r\n            const model = cloudstore._fromJSON(response, internal.collectionId);\r\n            if (internal.model !== model) {\r\n              // Check if we need to change model\r\n              if (internal.model) {\r\n                // Remove old listener if existing\r\n                internal.model.off('change', internal.onModelChangedCallback);\r\n              }\r\n\r\n              internal.model = model;\r\n              model.on('change', internal.onModelChangedCallback);\r\n            }\r\n            _this.flagOutputDirty('id');\r\n\r\n            delete response.objectId;\r\n\r\n            for (const key in response) {\r\n              if (_this.hasOutput('prop-' + key)) {\r\n                _this.flagOutputDirty('prop-' + key);\r\n              }\r\n            }\r\n\r\n            _this.sendSignalOnOutput('fetched');\r\n          },\r\n          error: function (err) {\r\n            _this.setError(err || 'Failed to fetch.');\r\n          }\r\n        });\r\n      });\r\n    },\r\n    scheduleStore: function () {\r\n      var internal = this._internal;\r\n      if (!internal.model) return;\r\n\r\n      this.scheduleOnce('Store', function () {\r\n        for (var i in internal.inputValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n      });\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('prop-'))\r\n        this.registerOutput(name, {\r\n          getter: userOutputGetter.bind(this, name.substring('prop-'.length))\r\n        });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      const dynamicSignals = {};\r\n\r\n      if (dynamicSignals[name])\r\n        return this.registerInput(name, {\r\n          set: EdgeTriggeredInput.createSetter({\r\n            valueChangedToTrue: dynamicSignals[name]\r\n          })\r\n        });\r\n\r\n      const dynamicSetters = {\r\n        collectionName: this.setCollectionID.bind(this)\r\n      };\r\n\r\n      if (dynamicSetters[name])\r\n        return this.registerInput(name, {\r\n          set: dynamicSetters[name]\r\n        });\r\n\r\n      if (name.startsWith('prop-'))\r\n        this.registerInput(name, {\r\n          set: userInputSetter.bind(this, name.substring('prop-'.length))\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nfunction userOutputGetter(name) {\r\n  /* jshint validthis:true */\r\n  return this._internal.model ? this._internal.model.get(name, { resolve: true }) : undefined;\r\n}\r\n\r\nfunction userInputSetter(name, value) {\r\n  //console.log('dbmodel setter:',name,value)\r\n  /* jshint validthis:true */\r\n  this._internal.inputValues[name] = value;\r\n}\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection, graphModel) {\r\n  var ports = [];\r\n\r\n  const dbCollections = graphModel.getMetaData('dbCollections');\r\n  const systemCollections = graphModel.getMetaData('systemCollections');\r\n\r\n  const _systemClasses = [\r\n    { label: 'User', value: '_User' },\r\n    { label: 'Role', value: '_Role' }\r\n  ];\r\n  ports.push({\r\n    name: 'collectionName',\r\n    displayName: 'Class',\r\n    group: 'General',\r\n    type: {\r\n      name: 'enum',\r\n      enums: _systemClasses.concat(\r\n        dbCollections !== undefined\r\n          ? dbCollections.map((c) => {\r\n              return { value: c.name, label: c.name };\r\n            })\r\n          : []\r\n      ),\r\n      allowEditOnly: true\r\n    },\r\n    plug: 'input'\r\n  });\r\n\r\n  if (parameters.collectionName && dbCollections) {\r\n    // Fetch ports from collection keys\r\n    var c = dbCollections.find((c) => c.name === parameters.collectionName);\r\n    if (c === undefined && systemCollections) c = systemCollections.find((c) => c.name === parameters.collectionName);\r\n    if (c && c.schema && c.schema.properties) {\r\n      var props = c.schema.properties;\r\n      for (var key in props) {\r\n        var p = props[key];\r\n        if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n        if (p.type !== 'Relation') {\r\n          // Other schema type ports\r\n          const _typeMap = {\r\n            String: 'string',\r\n            Boolean: 'boolean',\r\n            Number: 'number',\r\n            Date: 'date'\r\n          };\r\n\r\n          ports.push({\r\n            type: {\r\n              name: _typeMap[p.type] ? _typeMap[p.type] : '*'\r\n            },\r\n            plug: 'output',\r\n            group: 'Properties',\r\n            name: 'prop-' + key,\r\n            displayName: key\r\n          });\r\n\r\n          ports.push({\r\n            type: 'signal',\r\n            plug: 'output',\r\n            group: 'Changed Events',\r\n            displayName: key + ' Changed',\r\n            name: 'changed-' + key\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nmodule.exports = {\r\n  node: ModelNodeDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, graphModel);\r\n\r\n      node.on('parameterUpdated', function () {\r\n        updatePorts(node.id, node.parameters, context.editorConnection, graphModel);\r\n      });\r\n\r\n      graphModel.on('metadataChanged.dbCollections', function () {\r\n        CloudStore.invalidateCollections();\r\n        updatePorts(node.id, node.parameters, context.editorConnection, graphModel);\r\n      });\r\n\r\n      graphModel.on('metadataChanged.systemCollections', function () {\r\n        CloudStore.invalidateCollections();\r\n        updatePorts(node.id, node.parameters, context.editorConnection, graphModel);\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.DbModel2', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('DbModel2')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nvar DbModelCRUDBase = require('./dbmodelcrudbase');\r\nconst CloudStore = require('../../../api/cloudstore');\r\n\r\nvar DeleteDbModelPropertiedNodeDefinition = {\r\n  node: {\r\n    name: 'DeleteDbModelProperties',\r\n    docs: 'https://docs.noodl.net/nodes/data/cloud-data/delete-record',\r\n    displayNodeName: 'Delete Record',\r\n    shortDesc:\r\n      'Stores any amount of properties and can be used standalone or together with Collections and For Each nodes.',\r\n    inputs: {\r\n      store: {\r\n        displayName: 'Do',\r\n        group: 'Actions',\r\n        valueChangedToTrue: function () {\r\n          this.storageDelete();\r\n        }\r\n      }\r\n    },\r\n    outputs: {\r\n      deleted: {\r\n        type: 'signal',\r\n        displayName: 'Success',\r\n        group: 'Events'\r\n      }\r\n    },\r\n    methods: {\r\n      storageDelete: function () {\r\n        const _this = this;\r\n        const internal = this._internal;\r\n\r\n        if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n        this.scheduleOnce('StorageDelete', function () {\r\n          if (!internal.model) {\r\n            _this.setError('Missing Record Id');\r\n            return;\r\n          }\r\n\r\n          CloudStore.forScope(_this.nodeScope.ModelScope).delete({\r\n            collection: internal.collectionId,\r\n            objectId: internal.model.getId(), // Get the objectId part of the model id,\r\n            success: function () {\r\n              internal.model.notify('delete'); // Notify that this model has been deleted\r\n              _this.sendSignalOnOutput('deleted');\r\n            },\r\n            error: function (err) {\r\n              _this.setError(err || 'Failed to delete.');\r\n            }\r\n          });\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nDbModelCRUDBase.addBaseInfo(DeleteDbModelPropertiedNodeDefinition, {\r\n  includeInputProperties: false\r\n});\r\nDbModelCRUDBase.addModelId(DeleteDbModelPropertiedNodeDefinition);\r\n\r\nmodule.exports = DeleteDbModelPropertiedNodeDefinition;\r\n","'use strict';\r\n\r\nconst { Node } = require('../../../../noodl-runtime');\r\n\r\nconst Collection = require('../../../collection'),\r\n  Model = require('../../../model'),\r\n  CloudStore = require('../../../api/cloudstore'),\r\n  QueryUtils = require('../../../api/queryutils');\r\n\r\nvar FilterDBModelsNode = {\r\n  name: 'FilterDBModels',\r\n  docs: 'https://docs.noodl.net/nodes/data/cloud-data/filter-records',\r\n  displayNodeName: 'Filter Records',\r\n  shortDesc: 'Filter, sort and limit array',\r\n  category: 'Data',\r\n  color: 'data',\r\n  initialize: function () {\r\n    var _this = this;\r\n\r\n    this._internal.collectionChangedCallback = function () {\r\n      if (_this.isInputConnected('filter') === true) return;\r\n\r\n      _this.scheduleFilter();\r\n    };\r\n\r\n    this._internal.cloudStoreEvents = function (args) {\r\n      if (_this.isInputConnected('filter') === true) return;\r\n\r\n      if (_this._internal.visualFilter === undefined) return;\r\n      if (_this._internal.collection === undefined) return;\r\n      if (args.collection !== _this._internal.collectionName) return;\r\n\r\n      if (args.objectId !== undefined && _this._internal.collection.contains(Model.get(args.objectId)))\r\n        _this.scheduleFilter();\r\n    };\r\n\r\n    CloudStore.instance.on('save', this._internal.cloudStoreEvents);\r\n\r\n    this._internal.enabled = true;\r\n    this._internal.filterSettings = {};\r\n    this._internal.filterParameters = {};\r\n    //   this._internal.filteredCollection = Collection.get();\r\n  },\r\n  getInspectInfo() {\r\n    const collection = this._internal.filteredCollection;\r\n\r\n    if (!collection) {\r\n      return { type: 'text', value: '[Not executed yet]' };\r\n    }\r\n\r\n    return [\r\n      {\r\n        type: 'text',\r\n        value: 'Id: ' + collection.getId()\r\n      },\r\n      {\r\n        type: 'value',\r\n        value: collection.items\r\n      }\r\n    ];\r\n  },\r\n  inputs: {\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      set(value) {\r\n        this.bindCollection(value);\r\n        if (this.isInputConnected('filter') === false) this.scheduleFilter();\r\n      }\r\n    },\r\n    enabled: {\r\n      type: 'boolean',\r\n      group: 'General',\r\n      displayName: 'Enabled',\r\n      default: true,\r\n      set: function (value) {\r\n        this._internal.enabled = value;\r\n        if (this.isInputConnected('filter') === false) this.scheduleFilter();\r\n      }\r\n    },\r\n    filter: {\r\n      type: 'signal',\r\n      group: 'Actions',\r\n      displayName: 'Filter',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleFilter();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.filteredCollection;\r\n      }\r\n    },\r\n    firstItemId: {\r\n      type: 'string',\r\n      displayName: 'First Record Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        if (this._internal.filteredCollection !== undefined) {\r\n          const firstItem = this._internal.filteredCollection.get(0);\r\n          if (firstItem !== undefined) return firstItem.getId();\r\n        }\r\n      }\r\n    },\r\n    /*   firstItem:{\r\n            type: 'object',\r\n            displayName: 'First Item',\r\n            group: 'General',\r\n            getter: function () {\r\n                if(this._internal.filteredCollection !== undefined) {\r\n                    return this._internal.filteredCollection.get(0);\r\n                }\r\n            }            \r\n        },  */\r\n    count: {\r\n      type: 'number',\r\n      displayName: 'Count',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.filteredCollection ? this._internal.filteredCollection.size() : 0;\r\n      }\r\n    },\r\n    modified: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Filtered'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    unbindCurrentCollection: function () {\r\n      var collection = this._internal.collection;\r\n      if (!collection) return;\r\n      collection.off('change', this._internal.collectionChangedCallback);\r\n      this._internal.collection = undefined;\r\n    },\r\n    bindCollection: function (collection) {\r\n      this.unbindCurrentCollection();\r\n      this._internal.collection = collection;\r\n      collection && collection.on('change', this._internal.collectionChangedCallback);\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this.unbindCurrentCollection();\r\n\r\n      CloudStore.instance.off('save', this._internal.cloudStoreEvents);\r\n    },\r\n    /* getFilter: function () {\r\n            const filterSettings = this._internal.filterSettings;\r\n\r\n            const options = ['case'] // List all supported options here\r\n\r\n            if (filterSettings['filterFilter']) {\r\n                const filters = filterSettings['filterFilter'].split(',');\r\n                var _filter = {};\r\n                filters.forEach(function (f) {\r\n                    var op = '$' + (filterSettings['filterFilterOp-' + f] || 'eq');\r\n                    _filter[f] = {};\r\n                    _filter[f][op] = filterSettings['filterFilterValue-' + f];\r\n\r\n                    options.forEach((o) => {\r\n                        var option = filterSettings['filterFilterOption-' + o + '-' + f];\r\n                        if(option) _filter[f]['$' + o] =  option\r\n                    })\r\n                })\r\n                return _filter;\r\n            }\r\n        },\r\n        getSort: function() {\r\n            const filterSettings = this._internal.filterSettings;\r\n\r\n            if (filterSettings['filterSort']) {\r\n                const sort = filterSettings['filterSort'].split(',');\r\n                var _sort = {};\r\n                sort.forEach(function (s) {\r\n                    _sort[s] = filterSettings['filterSort-'+s] === 'descending'?-1:1;\r\n                })\r\n                return _sort;\r\n            }\r\n        },*/\r\n    getLimit: function () {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      if (!filterSettings['filterEnableLimit']) return;\r\n      else return filterSettings['filterLimit'] || 10;\r\n    },\r\n    getSkip: function () {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      if (!filterSettings['filterEnableLimit']) return;\r\n      else return filterSettings['filterSkip'] || 0;\r\n    },\r\n    scheduleFilter: function () {\r\n      if (this.collectionChangedScheduled) return;\r\n      this.collectionChangedScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.collectionChangedScheduled = false;\r\n        if (!this._internal.collection) return;\r\n\r\n        // Apply filter and write to output collection\r\n        var filtered = [].concat(this._internal.collection.items);\r\n\r\n        if (this._internal.enabled) {\r\n          const _filter = this._internal.visualFilter;\r\n          if (_filter !== undefined) {\r\n            var filter = QueryUtils.convertVisualFilter(_filter, {\r\n              queryParameters: this._internal.filterParameters,\r\n              collectionName: this._internal.collectionName\r\n            });\r\n            if (filter) filtered = filtered.filter((m) => QueryUtils.matchesQuery(m, filter));\r\n          }\r\n\r\n          var _sort = this._internal.visualSorting;\r\n          if (_sort !== undefined && _sort.length > 0) {\r\n            var sort = QueryUtils.convertVisualSorting(_sort);\r\n          }\r\n          if (sort) filtered.sort(QueryUtils.compareObjects.bind(this, sort));\r\n\r\n          var skip = this.getSkip();\r\n          if (skip) filtered = filtered.slice(skip, filtered.length);\r\n\r\n          var limit = this.getLimit();\r\n          if (limit) filtered = filtered.slice(0, limit);\r\n        }\r\n\r\n        this._internal.filteredCollection = Collection.create(filtered);\r\n\r\n        this.sendSignalOnOutput('modified');\r\n        this.flagOutputDirty('firstItemId');\r\n        this.flagOutputDirty('items');\r\n        this.flagOutputDirty('count');\r\n      });\r\n    },\r\n    setCollectionName: function (name) {\r\n      this._internal.collectionName = name;\r\n    },\r\n    setVisualFilter: function (value) {\r\n      this._internal.visualFilter = value;\r\n\r\n      if (this.isInputConnected('filter') === false) this.scheduleFilter();\r\n    },\r\n    setVisualSorting: function (value) {\r\n      this._internal.visualSorting = value;\r\n\r\n      if (this.isInputConnected('filter') === false) this.scheduleFilter();\r\n    },\r\n    setFilterParameter: function (name, value) {\r\n      this._internal.filterParameters[name] = value;\r\n\r\n      if (this.isInputConnected('filter') === false) this.scheduleFilter();\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      var _this = this;\r\n\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'collectionName')\r\n        return this.registerInput(name, {\r\n          set: this.setCollectionName.bind(this)\r\n        });\r\n\r\n      if (name === 'visualFilter')\r\n        return this.registerInput(name, {\r\n          set: this.setVisualFilter.bind(this)\r\n        });\r\n\r\n      if (name === 'visualSorting')\r\n        return this.registerInput(name, {\r\n          set: this.setVisualSorting.bind(this)\r\n        });\r\n\r\n      if (name.startsWith('fp-'))\r\n        return this.registerInput(name, {\r\n          set: this.setFilterParameter.bind(this, name.substring('fp-'.length))\r\n        });\r\n\r\n      this.registerInput(name, {\r\n        set: userInputSetter.bind(this, name)\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nfunction userInputSetter(name, value) {\r\n  /* jshint validthis:true */\r\n  this._internal.filterSettings[name] = value;\r\n  if (this.isInputConnected('filter') === false) this.scheduleFilter();\r\n}\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection, dbCollections) {\r\n  var ports = [];\r\n\r\n  ports.push({\r\n    name: 'collectionName',\r\n    type: {\r\n      name: 'enum',\r\n      enums:\r\n        dbCollections !== undefined\r\n          ? dbCollections.map((c) => {\r\n              return { value: c.name, label: c.name };\r\n            })\r\n          : [],\r\n      allowEditOnly: true\r\n    },\r\n    displayName: 'Class',\r\n    plug: 'input',\r\n    group: 'General'\r\n  });\r\n\r\n  ports.push({\r\n    type: 'boolean',\r\n    plug: 'input',\r\n    group: 'Limit',\r\n    name: 'filterEnableLimit',\r\n    displayName: 'Use limit'\r\n  });\r\n\r\n  if (parameters['filterEnableLimit']) {\r\n    ports.push({\r\n      type: 'number',\r\n      default: 10,\r\n      plug: 'input',\r\n      group: 'Limit',\r\n      name: 'filterLimit',\r\n      displayName: 'Limit'\r\n    });\r\n\r\n    ports.push({\r\n      type: 'number',\r\n      default: 0,\r\n      plug: 'input',\r\n      group: 'Limit',\r\n      name: 'filterSkip',\r\n      displayName: 'Skip'\r\n    });\r\n  }\r\n\r\n  if (parameters.collectionName !== undefined) {\r\n    var c = dbCollections.find((c) => c.name === parameters.collectionName);\r\n    if (c && c.schema && c.schema.properties) {\r\n      const schema = JSON.parse(JSON.stringify(c.schema));\r\n\r\n      const _supportedTypes = {\r\n        Boolean: true,\r\n        String: true,\r\n        Date: true,\r\n        Number: true,\r\n        Pointer: true\r\n      };\r\n      for (var key in schema.properties) {\r\n        if (!_supportedTypes[schema.properties[key].type]) delete schema.properties[key];\r\n      }\r\n\r\n      ports.push({\r\n        name: 'visualFilter',\r\n        plug: 'input',\r\n        type: { name: 'query-filter', schema: schema, allowEditOnly: true },\r\n        displayName: 'Filter',\r\n        group: 'Filter'\r\n      });\r\n\r\n      ports.push({\r\n        name: 'visualSorting',\r\n        plug: 'input',\r\n        type: { name: 'query-sorting', schema: schema, allowEditOnly: true },\r\n        displayName: 'Sorting',\r\n        group: 'Sorting'\r\n      });\r\n    }\r\n\r\n    if (parameters.visualFilter !== undefined) {\r\n      // Find all input ports\r\n      const uniqueInputs = {};\r\n      function _collectInputs(query) {\r\n        if (query === undefined) return;\r\n        if (query.rules !== undefined) query.rules.forEach((r) => _collectInputs(r));\r\n        else if (query.input !== undefined) uniqueInputs[query.input] = true;\r\n      }\r\n\r\n      _collectInputs(parameters.visualFilter);\r\n      Object.keys(uniqueInputs).forEach((input) => {\r\n        ports.push({\r\n          name: 'fp-' + input,\r\n          plug: 'input',\r\n          type: '*',\r\n          displayName: input,\r\n          group: 'Filter Parameters'\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  /*  ports.push({\r\n        type: { name: 'stringlist', allowEditOnly: true },\r\n        plug: 'input',\r\n        group: 'Filter',\r\n        name: 'filterFilter',\r\n        displayName: 'Filter',\r\n    })\r\n\r\n    ports.push({\r\n        type: { name: 'stringlist', allowEditOnly: true },\r\n        plug: 'input',\r\n        group: 'Sort',\r\n        name: 'filterSort',\r\n        displayName: 'Sort',\r\n    })    \r\n\r\n    const filterOps = {\r\n        \"string\": [{ value: 'eq', label: 'Equals' }, { value: 'neq', label: 'Not Equals' },{value: 'regex', label: 'Matches RegEx'}],\r\n        \"boolean\": [{ value: 'eq', label: 'Equals' }, { value: 'neq', label: 'Not Equals' }],\r\n        \"number\": [{ value: 'eq', label: 'Equals' }, { value: 'neq', label: 'Not Equals' }, { value: 'lt', label: 'Less than' }, { value: 'gt', label: 'Greater than' },\r\n        { value: 'gte', label: 'Greater than or equal' }, { value: 'lte', label: 'Less than or equal' }]\r\n    }\r\n\r\n    if (parameters['filterFilter']) {\r\n        var filters = parameters['filterFilter'].split(',');\r\n        filters.forEach((f) => {\r\n            // Type\r\n            ports.push({\r\n                type: { name: 'enum', enums: [{ value: 'string', label: 'String' }, { value: 'number', label: 'Number' }, { value: 'boolean', label: 'Boolean' }] },\r\n                default: 'string',\r\n                plug: 'input',\r\n                group: f + ' filter',\r\n                displayName: 'Type',\r\n                editorName: f + ' filter | Type',\r\n                name: 'filterFilterType-' + f\r\n            })\r\n\r\n            var type = parameters['filterFilterType-' + f];\r\n\r\n            // String filter type\r\n            ports.push({\r\n                type: { name: 'enum', enums: filterOps[type || 'string'] },\r\n                default: 'eq',\r\n                plug: 'input',\r\n                group: f + ' filter',\r\n                displayName: 'Op',\r\n                editorName: f + ' filter| Op',\r\n                name: 'filterFilterOp-' + f\r\n            })\r\n\r\n            // Case sensitivite option\r\n            if(parameters['filterFilterOp-' + f] === 'regex') {\r\n                ports.push({\r\n                    type: 'boolean',\r\n                    default: false,\r\n                    plug: 'input',\r\n                    group: f + ' filter',\r\n                    displayName: 'Case sensitive',\r\n                    editorName: f + ' filter| Case',\r\n                    name: 'filterFilterOption-case-' + f\r\n                })\r\n            }\r\n\r\n            ports.push({\r\n                type: type || 'string',\r\n                plug: 'input',\r\n                group: f + ' filter',\r\n                displayName: 'Value',\r\n                editorName: f + ' Filter Value',\r\n                name: 'filterFilterValue-' + f\r\n            })\r\n\r\n        })\r\n    }\r\n\r\n    if (parameters['filterSort']) {\r\n        var filters = parameters['filterSort'].split(',');\r\n        filters.forEach((f) => {\r\n            ports.push({\r\n                type: { name: 'enum', enums: [{ value: 'ascending', label: 'Ascending' }, { value: 'descending', label: 'Descending' }] },\r\n                default: 'ascending',\r\n                plug: 'input',\r\n                group: f + ' sort',\r\n                displayName: 'Sort',\r\n                editorName: f + ' sorting',\r\n                name: 'filterSort-' + f\r\n            })\r\n        })\r\n    }*/\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nmodule.exports = {\r\n  node: FilterDBModelsNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.FilterDBModels', function (node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('dbCollections'));\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('dbCollections'));\r\n      });\r\n\r\n      graphModel.on('metadataChanged.dbCollections', function (data) {\r\n        CloudStore.invalidateCollections();\r\n        updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n      });\r\n\r\n      graphModel.on('metadataChanged.systemCollections', function (data) {\r\n        CloudStore.invalidateCollections();\r\n        updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst Collection = require('../../../collection');\r\nconst Model = require('../../../model');\r\n\r\nfunction _addBaseInfo(def) {\r\n  Object.assign(def.node, {\r\n    category: 'Data',\r\n    color: 'data'\r\n  });\r\n}\r\n\r\nfunction _addModelId(def, opts) {\r\n  const _includeInputs = opts === undefined || opts.includeInputs;\r\n  const _includeOutputs = opts === undefined || opts.includeOutputs;\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {}\r\n  });\r\n\r\n  if (_includeInputs) {\r\n    Object.assign(def.node, {\r\n      usePortAsLabel: 'modelId'\r\n    });\r\n\r\n    def.node.dynamicports = (def.node.dynamicports || []).concat([\r\n      {\r\n        name: 'conditionalports/extended',\r\n        condition: 'idSource = explicit OR idSource NOT SET',\r\n        inputs: ['modelId']\r\n      }\r\n    ]);\r\n\r\n    // Inputs\r\n    Object.assign(def.node.inputs, {\r\n      idSource: {\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'Specify explicitly', value: 'explicit' },\r\n            { label: 'From repeater', value: 'foreach' }\r\n          ],\r\n          allowEditOnly: true\r\n        },\r\n        default: 'explicit',\r\n        displayName: 'Id Source',\r\n        group: 'General',\r\n        set: function (value) {\r\n          if (value === 'foreach') {\r\n            this.scheduleAfterInputsHaveUpdated(() => {\r\n              // Find closest nodescope that have a _forEachModel\r\n              var component = this.nodeScope.componentOwner;\r\n              while (component !== undefined && component._forEachModel === undefined && component.parentNodeScope) {\r\n                component = component.parentNodeScope.componentOwner;\r\n              }\r\n              this.setModel(component !== undefined ? component._forEachModel : undefined);\r\n            });\r\n          }\r\n        }\r\n      },\r\n      modelId: {\r\n        type: {\r\n          name: 'string',\r\n          identifierOf: 'ModelName',\r\n          identifierDisplayName: 'Object Ids'\r\n        },\r\n        displayName: 'Id',\r\n        group: 'General',\r\n        set: function (value) {\r\n          if (value instanceof Model) value = value.getId(); // Can be passed as model as well\r\n          this._internal.modelId = value; // Wait to fetch data\r\n          this.setModelID(value);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // Outputs\r\n  if (_includeOutputs) {\r\n    Object.assign(def.node.outputs, {\r\n      id: {\r\n        type: 'string',\r\n        displayName: 'Id',\r\n        group: 'General',\r\n        getter: function () {\r\n          return this._internal.model ? this._internal.model.getId() : this._internal.modelId;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // Methods\r\n  Object.assign(def.node.methods, {\r\n    setModelID: function (id) {\r\n      var model = (this.nodeScope.modelScope || Model).get(id);\r\n      this.setModel(model);\r\n    },\r\n    setModel: function (model) {\r\n      this._internal.model = model;\r\n      this.flagOutputDirty('id');\r\n    }\r\n  });\r\n\r\n  //Inspect model\r\n  if (!def.node.getInspectInfo) {\r\n    def.node.getInspectInfo = function () {\r\n      const model = this._internal.model;\r\n      if (!model) return '[No Object]';\r\n\r\n      return [\r\n        { type: 'text', value: 'Id: ' + model.getId() },\r\n        { type: 'value', value: model.data }\r\n      ];\r\n    };\r\n  }\r\n}\r\n\r\nfunction _addInputProperties(def) {\r\n  var _def = { node: Object.assign({}, def.node), setup: def.setup };\r\n  var _methods = Object.assign({}, def.node.methods);\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {}\r\n  });\r\n\r\n  Object.assign(def, {\r\n    setup: function (context, graphModel) {\r\n      if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n        return;\r\n      }\r\n\r\n      graphModel.on('nodeAdded.' + def.node.name, function (node) {\r\n        function _updatePorts() {\r\n          var ports = [];\r\n\r\n          const _types = [\r\n            { label: 'String', value: 'string' },\r\n            { label: 'Boolean', value: 'boolean' },\r\n            { label: 'Number', value: 'number' },\r\n            { label: 'Date', value: 'date' },\r\n            { label: 'Array', value: 'array' },\r\n            { label: 'Object', value: 'object' },\r\n            { label: 'Any', value: '*' }\r\n          ];\r\n\r\n          // Add value outputs\r\n          var properties = node.parameters.properties;\r\n          if (properties) {\r\n            properties = properties ? properties.split(',') : undefined;\r\n            for (var i in properties) {\r\n              var p = properties[i];\r\n\r\n              // Property input\r\n              ports.push({\r\n                type: {\r\n                  name: node.parameters['type-' + p] === undefined ? '*' : node.parameters['type-' + p]\r\n                },\r\n                plug: 'input',\r\n                group: 'Property Values',\r\n                displayName: p,\r\n                //  editorName:p,\r\n                name: 'prop-' + p\r\n              });\r\n\r\n              // Property type\r\n              ports.push({\r\n                type: {\r\n                  name: 'enum',\r\n                  enums: _types,\r\n                  allowEditOnly: true\r\n                },\r\n                plug: 'input',\r\n                group: 'Property Types',\r\n                displayName: p,\r\n                default: '*',\r\n                name: 'type-' + p\r\n              });\r\n            }\r\n          }\r\n\r\n          context.editorConnection.sendDynamicPorts(node.id, ports, {\r\n            detectRenamed: {\r\n              plug: 'input'\r\n            }\r\n          });\r\n        }\r\n\r\n        _updatePorts();\r\n\r\n        node.on('parameterUpdated', function (event) {\r\n          _updatePorts();\r\n        });\r\n      });\r\n\r\n      _def.setup && _def.setup(context, graphModel);\r\n    }\r\n  });\r\n\r\n  // Initilize\r\n  Object.assign(def.node, {\r\n    initialize: function () {\r\n      var internal = this._internal;\r\n      internal.inputValues = {};\r\n      internal.inputTypes = {};\r\n\r\n      _def.node.initialize && _def.node.initialize.call(this);\r\n    }\r\n  });\r\n\r\n  // Outputs\r\n  Object.assign(def.node.outputs, {});\r\n\r\n  // Inputs\r\n  Object.assign(def.node.inputs, {\r\n    properties: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      displayName: 'Properties',\r\n      group: 'Properties to set',\r\n      set: function (value) {}\r\n    }\r\n  });\r\n\r\n  // Methods\r\n  Object.assign(def.node.methods, {\r\n    _pushInputValues: function (model) {\r\n      var internal = this._internal;\r\n\r\n      const _defaultValueForType = {\r\n        boolean: false,\r\n        string: '',\r\n        number: 0,\r\n        date: new Date()\r\n      };\r\n\r\n      const _allKeys = {};\r\n      for (const key in internal.inputTypes) _allKeys[key] = true;\r\n      for (const key in internal.inputValues) _allKeys[key] = true;\r\n\r\n      const properties = this.model.parameters.properties || '';\r\n\r\n      const validProperties = properties.split(',');\r\n\r\n      const keysToSet = Object.keys(_allKeys).filter((key) => validProperties.indexOf(key) !== -1);\r\n\r\n      for (const i of keysToSet) {\r\n        var value = internal.inputValues[i];\r\n\r\n        if (value !== undefined) {\r\n          //Parse array types with string as javascript\r\n          if (internal.inputTypes[i] !== undefined && internal.inputTypes[i] === 'array' && typeof value === 'string') {\r\n            this.context.editorConnection.clearWarning(\r\n              this.nodeScope.componentOwner.name,\r\n              this.id,\r\n              'invalid-array-' + i\r\n            );\r\n\r\n            try {\r\n              value = eval(value); //this might be static data in the form of javascript\r\n            } catch (e) {\r\n              if (value.indexOf('[') !== -1 || value.indexOf('{') !== -1) {\r\n                this.context.editorConnection.sendWarning(\r\n                  this.nodeScope.componentOwner.name,\r\n                  this.id,\r\n                  'invalid-array-' + i,\r\n                  {\r\n                    showGlobally: true,\r\n                    message: 'Invalid array<br>' + e.toString()\r\n                  }\r\n                );\r\n                value = [];\r\n              } else {\r\n                //backwards compability with how this node used to work\r\n                value = Collection.get(value);\r\n              }\r\n            }\r\n          }\r\n          // Resolve object  from IDs\r\n          if (\r\n            internal.inputTypes[i] !== undefined &&\r\n            internal.inputTypes[i] === 'object' &&\r\n            typeof value === 'string'\r\n          ) {\r\n            value = (this.nodeScope.modelScope || Model).get(value);\r\n          }\r\n\r\n          model.set(i, value, { resolve: true });\r\n        } else {\r\n          model.set(i, _defaultValueForType[internal.inputTypes[i]], {\r\n            resolve: true\r\n          });\r\n        }\r\n      }\r\n    },\r\n    scheduleStore: function () {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledStore = false;\r\n        if (!internal.model) return;\r\n\r\n        this._pushInputValues(internal.model);\r\n\r\n        this.sendSignalOnOutput('stored');\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('prop-'))\r\n        this.registerInput(name, {\r\n          set: this._setInputValue.bind(this, name.substring('prop-'.length))\r\n        });\r\n\r\n      if (name.startsWith('type-'))\r\n        this.registerInput(name, {\r\n          set: this._setInputType.bind(this, name.substring('type-'.length))\r\n        });\r\n\r\n      _methods && _methods.registerInputIfNeeded && _def.node.methods.registerInputIfNeeded.call(this, name);\r\n    },\r\n    _setInputValue: function (name, value) {\r\n      this._internal.inputValues[name] = value;\r\n    },\r\n    _setInputType: function (name, value) {\r\n      this._internal.inputTypes[name] = value;\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  addInputProperties: _addInputProperties,\r\n  addModelId: _addModelId,\r\n  addBaseInfo: _addBaseInfo\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('../../../../noodl-runtime');\r\n\r\nvar Model = require('../../../model');\r\n\r\nvar ModelNodeDefinition = {\r\n  name: 'Model2',\r\n  docs: 'https://docs.noodl.net/nodes/data/object/object-node',\r\n  displayNodeName: 'Object',\r\n  shortDesc:\r\n    'Stores any amount of properties and can be used standalone or together with Collections and For Each nodes.',\r\n  category: 'Data',\r\n  usePortAsLabel: 'modelId',\r\n  color: 'data',\r\n  dynamicports: [\r\n    {\r\n      name: 'conditionalports/extended',\r\n      condition: 'idSource = explicit OR idSource NOT SET',\r\n      inputs: ['modelId']\r\n    }\r\n  ],\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.inputValues = {};\r\n    internal.dirtyValues = {};\r\n\r\n    var _this = this;\r\n    this._internal.onModelChangedCallback = function (args) {\r\n      if (_this.isInputConnected('fetch') === true) return;\r\n\r\n      if (_this.hasOutput('prop-' + args.name)) _this.flagOutputDirty('prop-' + args.name);\r\n\r\n      if (_this.hasOutput('changed-' + args.name)) _this.sendSignalOnOutput('changed-' + args.name);\r\n\r\n      _this.sendSignalOnOutput('changed');\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return '[No Object]';\r\n\r\n    return [\r\n      { type: 'text', value: 'Id: ' + model.getId() },\r\n      { type: 'value', value: model.data }\r\n    ];\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: 'string',\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.model ? this._internal.model.getId() : this._internal.modelId;\r\n      }\r\n    },\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  inputs: {\r\n    idSource: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Specify explicitly', value: 'explicit' },\r\n          { label: 'From repeater', value: 'foreach' }\r\n        ],\r\n        allowEditOnly: true\r\n      },\r\n      default: 'explicit',\r\n      displayName: 'Get Id from',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value === 'foreach') {\r\n          this.scheduleAfterInputsHaveUpdated(() => {\r\n            // Find closest nodescope that have a _forEachModel\r\n            var component = this.nodeScope.componentOwner;\r\n            while (component !== undefined && component._forEachModel === undefined && component.parentNodeScope) {\r\n              component = component.parentNodeScope.componentOwner;\r\n            }\r\n            this.setModel(component !== undefined ? component._forEachModel : undefined);\r\n          });\r\n        }\r\n      }\r\n    },\r\n    modelId: {\r\n      type: {\r\n        name: 'string',\r\n        identifierOf: 'ModelName',\r\n        identifierDisplayName: 'Object Ids'\r\n      },\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value instanceof Model) value = value.getId();\r\n        // Can be passed as model as well\r\n        else if (typeof value === 'object') value = Model.create(value).getId(); // If this is an js object, dereference it\r\n\r\n        this._internal.modelId = value; // Wait to fetch data\r\n        if (this.isInputConnected('fetch') === false) this.setModelID(value);\r\n        else {\r\n          this.flagOutputDirty('id');\r\n        }\r\n      }\r\n    },\r\n    properties: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      displayName: 'Properties',\r\n      group: 'Properties',\r\n      set: function (value) {}\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleSetModel();\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    scheduleStore: function () {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledStore = false;\r\n        if (!internal.model) return;\r\n\r\n        for (var i in internal.dirtyValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n        internal.dirtyValues = {}; // Reset dirty values\r\n      });\r\n    },\r\n    scheduleSetModel: function () {\r\n      if (this.hasScheduledSetModel) return;\r\n      this.hasScheduledSetModel = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledSetModel = false;\r\n        this.setModelID(this._internal.modelId);\r\n      });\r\n    },\r\n    setModelID: function (id) {\r\n      var model = (this.nodeScope.modelScope || Model).get(id);\r\n      this.setModel(model);\r\n      this.sendSignalOnOutput('fetched');\r\n    },\r\n    setModel: function (model) {\r\n      if (this._internal.model)\r\n        // Remove old listener if existing\r\n        this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n\r\n      this._internal.model = model;\r\n      this.flagOutputDirty('id');\r\n\r\n      // In set idSource, we are calling setModel with undefined\r\n      if (model) {\r\n        model.on('change', this._internal.onModelChangedCallback);\r\n\r\n        // We have a new model, mark all outputs as dirty\r\n        for (var key in model.data) {\r\n          if (this.hasOutput('prop-' + key)) this.flagOutputDirty('prop-' + key);\r\n        }\r\n      }\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      if (this._internal.model) this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('prop-'))\r\n        this.registerOutput(name, {\r\n          getter: userOutputGetter.bind(this, name.substring('prop-'.length))\r\n        });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      var _this = this;\r\n\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('prop-'))\r\n        this.registerInput(name, {\r\n          set: userInputSetter.bind(this, name.substring('prop-'.length))\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nfunction userOutputGetter(name) {\r\n  /* jshint validthis:true */\r\n  return this._internal.model ? this._internal.model.get(name, { resolve: true }) : undefined;\r\n}\r\n\r\nfunction userInputSetter(name, value) {\r\n  /* jshint validthis:true */\r\n  this._internal.inputValues[name] = value;\r\n\r\n  // Store on change if no connection to store or new\r\n  const model = this._internal.model;\r\n  const valueChanged = model ? model.get(name) !== value : true;\r\n  if (valueChanged) {\r\n    this._internal.dirtyValues[name] = true;\r\n    this.scheduleStore();\r\n  }\r\n}\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection) {\r\n  var ports = [];\r\n\r\n  // Add value outputs\r\n  var properties = parameters.properties;\r\n  if (properties) {\r\n    properties = properties ? properties.split(',') : undefined;\r\n    for (var i in properties) {\r\n      var p = properties[i];\r\n\r\n      ports.push({\r\n        type: {\r\n          name: '*',\r\n          allowConnectionsOnly: true\r\n        },\r\n        plug: 'input/output',\r\n        group: 'Properties',\r\n        name: 'prop-' + p,\r\n        displayName: p\r\n      });\r\n\r\n      ports.push({\r\n        type: 'signal',\r\n        plug: 'output',\r\n        group: 'Changed Events',\r\n        displayName: p + ' Changed',\r\n        name: 'changed-' + p\r\n      });\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: 'input/output'\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: ModelNodeDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.Model2', function (node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection);\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nvar Model = require('../../../model');\r\nvar DbModelCRUDBase = require('./dbmodelcrudbase');\r\nconst CloudStore = require('../../../api/cloudstore');\r\n\r\nvar NewDbModelPropertiedNodeDefinition = {\r\n  node: {\r\n    name: 'NewDbModelProperties',\r\n    docs: 'https://docs.noodl.net/nodes/data/cloud-data/create-new-record',\r\n    displayName: 'Create New Record',\r\n    usePortAsLabel: 'collectionName',\r\n    inputs: {\r\n      store: {\r\n        displayName: 'Do',\r\n        group: 'Actions',\r\n        valueChangedToTrue: function () {\r\n          this.storageInsert();\r\n        }\r\n      },\r\n      sourceObjectId: {\r\n        type: { name: 'string', allowConnectionsOnly: true },\r\n        displayName: 'Source Object Id',\r\n        group: 'General',\r\n        set: function (value) {\r\n          if (value instanceof Model) value = value.getId(); // Can be passed as model as well\r\n          this._internal.sourceObjectId = value; // Wait to fetch data\r\n        }\r\n      }\r\n    },\r\n    outputs: {\r\n      created: {\r\n        type: 'signal',\r\n        displayName: 'Success',\r\n        group: 'Events'\r\n      }\r\n    },\r\n    methods: {\r\n      storageInsert: function () {\r\n        const internal = this._internal;\r\n\r\n        if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n        this.scheduleOnce('StorageInsert', () => {\r\n          const initValues = Object.assign(\r\n            {},\r\n            internal.sourceObjectId ? (this.nodeScope.modelScope || Model).get(internal.sourceObjectId).data : {},\r\n            internal.inputValues\r\n          );\r\n\r\n          const cloudstore = CloudStore.forScope(this.nodeScope.modelScope);\r\n          cloudstore.create({\r\n            collection: internal.collectionId,\r\n            data: initValues,\r\n            acl: this._getACL(),\r\n            success: (data) => {\r\n              // Successfully created\r\n              const m = cloudstore._fromJSON(data, internal.collectionId);\r\n              this.setModel(m);\r\n              this.sendSignalOnOutput('created');\r\n            },\r\n            error: (err) => {\r\n              this.setError(err || 'Failed to insert.');\r\n            }\r\n          });\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nDbModelCRUDBase.addBaseInfo(NewDbModelPropertiedNodeDefinition);\r\nDbModelCRUDBase.addModelId(NewDbModelPropertiedNodeDefinition, {\r\n  includeOutputs: true\r\n});\r\nDbModelCRUDBase.addInputProperties(NewDbModelPropertiedNodeDefinition);\r\nDbModelCRUDBase.addAccessControl(NewDbModelPropertiedNodeDefinition);\r\n\r\nmodule.exports = NewDbModelPropertiedNodeDefinition;\r\n","'use strict';\r\n\r\nvar Model = require('../../../model');\r\nvar ModelCRUDBase = require('./modelcrudbase');\r\n\r\nvar NewModelNodeDefinition = {\r\n  node: {\r\n    name: 'NewModel',\r\n    docs: 'https://docs.noodl.net/nodes/data/object/create-new-object',\r\n    displayNodeName: 'Create New Object',\r\n    inputs: {\r\n      new: {\r\n        displayName: 'Do',\r\n        group: 'Actions',\r\n        valueChangedToTrue: function () {\r\n          this.scheduleNew();\r\n        }\r\n      }\r\n    },\r\n    outputs: {\r\n      created: {\r\n        type: 'signal',\r\n        displayName: 'Done',\r\n        group: 'Events'\r\n      }\r\n    },\r\n    methods: {\r\n      scheduleNew: function () {\r\n        if (this.hasScheduledNew) return;\r\n        this.hasScheduledNew = true;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          this.hasScheduledNew = false;\r\n          const newModel = (this.nodeScope.modelScope || Model).get();\r\n\r\n          this._pushInputValues(newModel);\r\n\r\n          this.setModel(newModel);\r\n\r\n          this.sendSignalOnOutput('created');\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nModelCRUDBase.addBaseInfo(NewModelNodeDefinition);\r\nModelCRUDBase.addModelId(NewModelNodeDefinition, { includeOutputs: true });\r\nModelCRUDBase.addInputProperties(NewModelNodeDefinition);\r\n\r\nmodule.exports = NewModelNodeDefinition;\r\n","var defaultRequestScript =\r\n  '' +\r\n  '//Add custom code to setup the request object before the request\\n' +\r\n  '//is made.\\n' +\r\n  '//\\n' +\r\n  '//*Request.resource     contains the resource path of the request.\\n' +\r\n  '//*Request.method       contains the method, GET, POST, PUT or DELETE.\\n' +\r\n  '//*Request.headers      is a map where you can add additional headers.\\n' +\r\n  '//*Request.parameters   is a map the parameters that will be appended\\n' +\r\n  '//                      to the url.\\n' +\r\n  '//*Request.content      contains the content of the request as a javascript\\n' +\r\n  '//                      object.\\n' +\r\n  '//\\n';\r\n('//*Inputs and *Outputs contain the inputs and outputs of the node.\\n');\r\n\r\nvar defaultResponseScript =\r\n  '' +\r\n  '// Add custom code to convert the response content to outputs\\n' +\r\n  '//\\n' +\r\n  '//*Response.status    The status code of the response\\n' +\r\n  '//*Response.content   The content of the response as a javascript\\n' +\r\n  '//                    object.\\n' +\r\n  '//*Response.request   The request object that resulted in the response.\\n' +\r\n  '//\\n' +\r\n  '//*Inputs and *Outputs contain the inputs and outputs of the node.\\n';\r\n\r\nvar RestNode = {\r\n  name: 'REST2',\r\n  displayNodeName: 'REST',\r\n  docs: 'https://docs.noodl.net/nodes/data/rest',\r\n  category: 'Data',\r\n  color: 'data',\r\n  searchTags: ['http', 'request', 'fetch'],\r\n  initialize: function () {\r\n    this._internal.inputValues = {};\r\n    this._internal.outputValues = {};\r\n\r\n    this._internal.outputValuesProxy = new Proxy(this._internal.outputValues, {\r\n      set: (obj, prop, value) => {\r\n        //only send outputs when they change.\r\n        //Some Noodl projects rely on this behavior, so changing it breaks backwards compability\r\n        if (value !== this._internal.outputValues[prop]) {\r\n          this.registerOutputIfNeeded('out-' + prop);\r\n\r\n          this._internal.outputValues[prop] = value;\r\n          this.flagOutputDirty('out-' + prop);\r\n        }\r\n        return true;\r\n      }\r\n    });\r\n\r\n    this._internal.self = {};\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.inspectData\r\n      ? { type: 'value', value: this._internal.inspectData }\r\n      : { type: 'text', value: '[Not executed yet]' };\r\n  },\r\n  inputs: {\r\n    resource: {\r\n      type: 'string',\r\n      displayName: 'Resource',\r\n      group: 'Request',\r\n      default: '/',\r\n      set: function (value) {\r\n        this._internal.resource = value;\r\n      }\r\n    },\r\n    method: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'GET', value: 'GET' },\r\n          { label: 'POST', value: 'POST' },\r\n          { label: 'PUT', value: 'PUT' },\r\n          { label: 'PATCH', value: 'PATCH' },\r\n          { label: 'DELETE', value: 'DELETE' }\r\n        ]\r\n      },\r\n      displayName: 'Method',\r\n      group: 'Request',\r\n      default: 'GET',\r\n      set: function (value) {\r\n        this._internal.method = value;\r\n      }\r\n    },\r\n    /*  scriptInputs: {\r\n      type: { name: 'proplist', allowEditOnly: true },\r\n      group: 'Inputs',\r\n      set: function (value) {\r\n        //  this._internal.scriptInputs = value;   \r\n      }\r\n    },\r\n    scriptOutputs: {\r\n      type: { name: 'proplist', allowEditOnly: true },\r\n      group: 'Outputs',\r\n      set: function (value) {\r\n        //   this._internal.scriptOutputs = value;   \r\n      }\r\n    },*/\r\n    requestScript: {\r\n      type: {\r\n        name: 'string',\r\n        allowEditOnly: true,\r\n        codeeditor: 'javascript'\r\n      },\r\n      displayName: 'Request',\r\n      default: defaultRequestScript,\r\n      group: 'Scripts',\r\n      set: function (script) {\r\n        try {\r\n          this._internal.requestFunc = new Function('Inputs', 'Outputs', 'Request', script);\r\n        } catch (e) {\r\n          console.log(e);\r\n        }\r\n      }\r\n    },\r\n    responseScript: {\r\n      type: {\r\n        name: 'string',\r\n        allowEditOnly: true,\r\n        codeeditor: 'javascript'\r\n      },\r\n      displayName: 'Response',\r\n      default: defaultResponseScript,\r\n      group: 'Scripts',\r\n      set: function (script) {\r\n        try {\r\n          this._internal.responseFunc = new Function('Inputs', 'Outputs', 'Response', script);\r\n        } catch (e) {\r\n          console.log(e);\r\n        }\r\n      }\r\n    },\r\n    fetch: {\r\n      type: 'signal',\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleFetch();\r\n      }\r\n    },\r\n    cancel: {\r\n      type: 'signal',\r\n      displayName: 'Cancel',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.cancelFetch();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Events'\r\n    },\r\n    canceled: {\r\n      type: 'signal',\r\n      displayName: 'Canceled',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    getScriptOutputValue: function (name) {\r\n      return this._internal.outputValues[name];\r\n    },\r\n    setScriptInputValue: function (name, value) {\r\n      return (this._internal.inputValues[name] = value);\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('out-'))\r\n        return this.registerOutput(name, {\r\n          getter: this.getScriptOutputValue.bind(this, name.substring('out-'.length))\r\n        });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('in-'))\r\n        return this.registerInput(name, {\r\n          set: this.setScriptInputValue.bind(this, name.substring('in-'.length))\r\n        });\r\n\r\n      /*    if (name.startsWith('intype-')) return this.registerInput(name, {\r\n        set: function() {} // Ignore input type\r\n      })\r\n\r\n      if (name.startsWith('outtype-')) return this.registerInput(name, {\r\n        set: function() {} // Ignore output type\r\n      })*/\r\n    },\r\n    scheduleFetch: function () {\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledFetch) {\r\n        internal.hasScheduledFetch = true;\r\n        this.scheduleAfterInputsHaveUpdated(this.doFetch.bind(this));\r\n      }\r\n    },\r\n    doResponse: function (status, response, request) {\r\n      // Process the response content with the response function\r\n      if (this._internal.responseFunc) {\r\n        this._internal.responseFunc.apply(this._internal.self, [\r\n          this._internal.inputValues,\r\n          this._internal.outputValuesProxy,\r\n          { status: status, content: response, request: request }\r\n        ]);\r\n      }\r\n\r\n      this._internal.inspectData = { status: status, content: response };\r\n\r\n      // Flag status\r\n      if (status >= 200 && status < 300) {\r\n        this.sendSignalOnOutput('success');\r\n      } else {\r\n        this.sendSignalOnOutput('failure');\r\n      }\r\n    },\r\n    doExternalFetch: function (request) {\r\n      var url = request.resource;\r\n\r\n      // Append parameters from request as query\r\n      if (Object.keys(request.parameters).length > 0) {\r\n        var parameters = Object.keys(request.parameters).map(function (p) {\r\n          return p + '=' + encodeURIComponent(request.parameters[p]);\r\n        });\r\n        url += '?' + parameters.join('&');\r\n      }\r\n\r\n      if (typeof _noodl_cloud_runtime_version === 'undefined') {\r\n        // Running in browser\r\n        var _this = this;\r\n        var xhr = new window.XMLHttpRequest();\r\n        this._xhr = xhr;\r\n\r\n        xhr.open(request.method, url, true);\r\n        for (var header in request.headers) {\r\n          xhr.setRequestHeader(header, request.headers[header]);\r\n        }\r\n        xhr.onreadystatechange = function () {\r\n          // XMLHttpRequest.DONE = 4, but torped runtime doesn't support enum\r\n\r\n          var sentResponse = false;\r\n\r\n          if (this.readyState === 4 || this.readyState === XMLHttpRequest.DONE) {\r\n            var statusCode = this.status;\r\n            var responseType = this.getResponseHeader('content-type');\r\n            var rawResponse = this.response;\r\n            delete this._xhr;\r\n\r\n            if (responseType) {\r\n              responseType = responseType.toLowerCase();\r\n              const responseData = responseType.indexOf('json') !== -1 ? JSON.parse(rawResponse) : rawResponse;\r\n\r\n              _this.doResponse(statusCode, responseData, request);\r\n              sentResponse = true;\r\n            }\r\n\r\n            if (sentResponse === false) {\r\n              _this.doResponse(statusCode, rawResponse, request);\r\n            }\r\n          }\r\n        };\r\n        xhr.onerror = function (e) {\r\n          //console.log('REST: Failed to request', url);\r\n          delete this._xhr;\r\n          _this.sendSignalOnOutput('failure');\r\n        };\r\n\r\n        xhr.onabort = function () {\r\n          delete this._xhr;\r\n          _this.sendSignalOnOutput('canceled');\r\n        };\r\n\r\n        if (request.content) {\r\n          xhr.setRequestHeader('Content-Type', 'application/json');\r\n          xhr.send(JSON.stringify(request.content));\r\n        } else {\r\n          xhr.send();\r\n        }\r\n      } else {\r\n        // Running in cloud runtime\r\n        const headers = Object.assign(\r\n          {},\r\n          request.headers,\r\n          request.content\r\n            ? {\r\n                'Content-Type': 'application/json'\r\n              }\r\n            : {}\r\n        );\r\n        fetch(url, {\r\n          method: request.method,\r\n          headers,\r\n          body: request.content ? JSON.stringify(request.content) : undefined\r\n        })\r\n          .then((response) => {\r\n            const responseType = response.headers.get('content-type');\r\n            if (responseType) {\r\n              if (responseType.indexOf('/json') !== -1) {\r\n                response.json().then((json) => {\r\n                  this.doResponse(response.status, json, request);\r\n                });\r\n              } else {\r\n                if (this.context.editorConnection) {\r\n                  this.context.editorConnection.sendWarning(\r\n                    this.nodeScope.componentOwner.name,\r\n                    this.id,\r\n                    'rest-run-waring-',\r\n                    {\r\n                      message: 'REST only supports json content type in response.'\r\n                    }\r\n                  );\r\n                }\r\n              }\r\n            } else {\r\n              response.text().then((raw) => {\r\n                this.doResponse(response.status, raw, request);\r\n              });\r\n            }\r\n          })\r\n          .catch((e) => {\r\n            console.log('REST: Failed to request', url);\r\n            console.log(e);\r\n            this.sendSignalOnOutput('failure');\r\n          });\r\n      }\r\n    },\r\n    doFetch: function () {\r\n      this._internal.hasScheduledFetch = false;\r\n\r\n      // Format resource path\r\n      var resource = this._internal.resource;\r\n      if (resource) {\r\n        for (var key in this._internal.inputValues) {\r\n          resource = resource.replace('{' + key + '}', this._internal.inputValues[key]);\r\n        }\r\n      }\r\n\r\n      // Setup the request\r\n      var request = {\r\n        resource: resource,\r\n        headers: {},\r\n        method: this._internal.method !== undefined ? this._internal.method : 'GET',\r\n        parameters: {}\r\n      };\r\n\r\n      // Process the request content with the preprocess function\r\n      if (this._internal.requestFunc) {\r\n        this._internal.requestFunc.apply(this._internal.self, [\r\n          this._internal.inputValues,\r\n          this._internal.outputValuesProxy,\r\n          request\r\n        ]);\r\n      }\r\n\r\n      // Perform request\r\n      this.doExternalFetch(request);\r\n    },\r\n    cancelFetch: function () {\r\n      if (typeof _noodl_cloud_runtime_version === 'undefined') {\r\n        this._xhr && this._xhr.abort();\r\n      } else {\r\n        if (this.context.editorConnection) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'rest-run-waring-', {\r\n            message: \"REST doesn't support cancel in cloud functions.\"\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nfunction _parseScriptForErrors(script, args, name, node, context, ports) {\r\n  // Clear run warnings if the script is edited\r\n  context.editorConnection.clearWarning(node.component.name, node.id, 'rest-run-waring-' + name);\r\n\r\n  if (script === undefined) {\r\n    context.editorConnection.clearWarning(node.component.name, node.id, 'rest-parse-waring-' + name);\r\n    return;\r\n  }\r\n\r\n  try {\r\n    new Function(...args, script);\r\n\r\n    context.editorConnection.clearWarning(node.component.name, node.id, 'rest-parse-waring-' + name);\r\n  } catch (e) {\r\n    context.editorConnection.sendWarning(node.component.name, node.id, 'rest-parse-waring-' + name, {\r\n      message: '<strong>' + name + '</strong>: ' + e.message,\r\n      showGlobally: true\r\n    });\r\n  }\r\n\r\n  // Extract inputs and outputs\r\n  function _exists(port) {\r\n    return ports.find((p) => p.name === port) !== undefined;\r\n  }\r\n\r\n  const scriptWithoutComments = script.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g, ''); // Remove comments\r\n  const inputs = scriptWithoutComments.match(/Inputs\\.[A-Za-z0-9]+/g);\r\n  if (inputs) {\r\n    const unique = {};\r\n    inputs.forEach((v) => {\r\n      unique[v.substring('Inputs.'.length)] = true;\r\n    });\r\n\r\n    Object.keys(unique).forEach((p) => {\r\n      if (_exists('in-' + p)) return;\r\n\r\n      ports.push({\r\n        name: 'in-' + p,\r\n        displayName: p,\r\n        plug: 'input',\r\n        type: '*',\r\n        group: 'Inputs'\r\n      });\r\n    });\r\n  }\r\n\r\n  const outputs = scriptWithoutComments.match(/Outputs\\.[A-Za-z0-9]+/g);\r\n  if (outputs) {\r\n    const unique = {};\r\n    outputs.forEach((v) => {\r\n      unique[v.substring('Outputs.'.length)] = true;\r\n    });\r\n\r\n    Object.keys(unique).forEach((p) => {\r\n      if (_exists('out-' + p)) return;\r\n\r\n      ports.push({\r\n        name: 'out-' + p,\r\n        displayName: p,\r\n        plug: 'output',\r\n        type: '*',\r\n        group: 'Outputs'\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = {\r\n  node: RestNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _updatePorts() {\r\n        if (!node.parameters) {\r\n          return;\r\n        }\r\n\r\n        var ports = [];\r\n        function exists(name) {\r\n          for (var i = 0; i < ports.length; i++) if (ports[i].name === name && ports[i].plug === 'input') return true;\r\n          return false;\r\n        }\r\n\r\n        /*  const _typeEnums = [{value:'string',label:'String'},\r\n                                {value:'boolean',label:'Boolean'},\r\n                                {value:'number',label:'Number'},\r\n                                {value:'color',label:'Color'},\r\n                                {value:'object',label:'Object'},\r\n                                {value:'array',label:'Array'}]*/\r\n\r\n        // Inputs\r\n        /* if (node.parameters['scriptInputs'] !== undefined && node.parameters['scriptInputs'].length > 0) {\r\n          node.parameters['scriptInputs'].forEach((p) => {\r\n            // Type for input\r\n            ports.push({\r\n              name: 'intype-' + p.label,\r\n              displayName: 'Type',\r\n              plug: 'input',\r\n              type: { name: 'enum', enums: _typeEnums, allowEditOnly: true },\r\n              default: 'string',\r\n              parent: 'scriptInputs',\r\n              parentItemId: p.id\r\n            })\r\n      \r\n            // Default Value for input\r\n            ports.push({\r\n              name: 'in-' + p.label,\r\n              displayName: p.label,\r\n              plug: 'input',\r\n              type: node.parameters['intype-' + p.label] || 'string',\r\n              group: 'Input Values'\r\n            })\r\n          })\r\n        }*/\r\n\r\n        // Outputs\r\n        /* if (node.parameters['scriptOutputs'] !== undefined && node.parameters['scriptOutputs'].length > 0) {\r\n          node.parameters['scriptOutputs'].forEach((p) => {\r\n            // Type for output\r\n            ports.push({\r\n              name: 'outtype-' + p.label,\r\n              displayName: 'Type',\r\n              plug: 'input',\r\n              type: { name: 'enum', enums: _typeEnums, allowEditOnly: true },\r\n              default: 'string',\r\n              parent: 'scriptOutputs',\r\n              parentItemId: p.id\r\n            })\r\n      \r\n            // Value for output\r\n            ports.push({\r\n              name: 'out-' + p.label,\r\n              displayName: p.label,\r\n              plug: 'output',\r\n              type: node.parameters['outtype-' + p.label] || '*',\r\n              group: 'Outputs',\r\n            })\r\n          })\r\n        }*/\r\n\r\n        // Parse resource path inputs\r\n        if (node.parameters.resource) {\r\n          var inputs = node.parameters.resource.match(/\\{[A-Za-z0-9_]*\\}/g);\r\n          for (var i in inputs) {\r\n            var def = inputs[i];\r\n            var name = def.replace('{', '').replace('}', '');\r\n            if (exists('in-' + name)) continue;\r\n\r\n            ports.push({\r\n              name: 'in-' + name,\r\n              displayName: name,\r\n              type: 'string',\r\n              plug: 'input',\r\n              group: 'Inputs'\r\n            });\r\n          }\r\n        }\r\n\r\n        if (node.parameters['requestScript']) {\r\n          _parseScriptForErrors(\r\n            node.parameters['requestScript'],\r\n            ['Inputs', 'Outputs', 'Request'],\r\n            'Request script',\r\n            node,\r\n            context,\r\n            ports\r\n          );\r\n        }\r\n\r\n        if (node.parameters['responseScript']) {\r\n          _parseScriptForErrors(\r\n            node.parameters['responseScript'],\r\n            ['Inputs', 'Outputs', 'Response'],\r\n            'Response script',\r\n            node,\r\n            context,\r\n            ports\r\n          );\r\n        }\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on('parameterUpdated', function () {\r\n        _updatePorts();\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.REST2', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('REST2')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nvar DbModelCRUDBase = require('./dbmodelcrudbase');\r\nconst CloudStore = require('../../../api/cloudstore');\r\n\r\nvar SetDbModelPropertiedNodeDefinition = {\r\n  node: {\r\n    name: 'SetDbModelProperties',\r\n    docs: 'https://docs.noodl.net/nodes/data/cloud-data/set-record-properties',\r\n    displayNodeName: 'Set Record Properties',\r\n    usePortAsLabel: 'collectionName',\r\n    dynamicports: [\r\n      {\r\n        name: 'conditionalports/extended',\r\n        condition: 'storeType = cloud OR storeType NOT SET',\r\n        inputs: ['storeProperties']\r\n      }\r\n    ],\r\n    inputs: {\r\n      store: {\r\n        displayName: 'Do',\r\n        group: 'Actions',\r\n        valueChangedToTrue: function () {\r\n          if (this._internal.storeType === undefined || this._internal.storeType === 'cloud') this.scheduleSave();\r\n          else this.scheduleStore();\r\n        }\r\n      },\r\n      storeProperties: {\r\n        displayName: 'Properties to  store',\r\n        group: 'General',\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'Only specified', value: 'specified' },\r\n            { label: 'All', value: 'all' }\r\n          ]\r\n        },\r\n        default: 'specified',\r\n        set: function (value) {\r\n          this._internal.storeProperties = value;\r\n        }\r\n      },\r\n      storeType: {\r\n        displayName: 'Store to',\r\n        group: 'General',\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'Cloud and local', value: 'cloud' },\r\n            { label: 'Local only', value: 'local' }\r\n          ]\r\n        },\r\n        default: 'cloud',\r\n        set: function (value) {\r\n          this._internal.storeType = value;\r\n        }\r\n      }\r\n    },\r\n    outputs: {\r\n      stored: {\r\n        type: 'signal',\r\n        displayName: 'Success',\r\n        group: 'Events'\r\n      }\r\n    },\r\n    methods: {\r\n      scheduleSave: function () {\r\n        const _this = this;\r\n        const internal = this._internal;\r\n\r\n        if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n        this.scheduleOnce('StorageSave', function () {\r\n          if (!internal.model) {\r\n            _this.setError('Missing Record Id');\r\n            return;\r\n          }\r\n          \r\n          const model = internal.model;\r\n          for (const key in internal.inputValues) {\r\n            model.set(key, internal.inputValues[key], { resolve: true });\r\n          }\r\n          \r\n          CloudStore.forScope(_this.nodeScope.modelScope).save({\r\n            collection: internal.collectionId,\r\n            objectId: model.getId(), // Get the objectId part of the model id\r\n            data: internal.storeProperties === 'all' ? model.data : internal.inputValues, // Only store input values by default, if not explicitly specified\r\n            acl: _this._getACL(),\r\n            success: function (response) {\r\n              for (var key in response) {\r\n                model.set(key, response[key]);\r\n              }\r\n\r\n              _this.sendSignalOnOutput('stored');\r\n            },\r\n            error: function (err) {\r\n              _this.setError(err || 'Failed to save.');\r\n            }\r\n          });\r\n        });\r\n      },\r\n      scheduleStore: function () {\r\n        if (this.hasScheduledStore) return;\r\n        this.hasScheduledStore = true;\r\n\r\n        var internal = this._internal;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          this.hasScheduledStore = false;\r\n          if (!internal.model) return;\r\n\r\n          for (var i in internal.inputValues) {\r\n            internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n          }\r\n          this.sendSignalOnOutput('stored');\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nDbModelCRUDBase.addBaseInfo(SetDbModelPropertiedNodeDefinition);\r\nDbModelCRUDBase.addModelId(SetDbModelPropertiedNodeDefinition);\r\nDbModelCRUDBase.addInputProperties(SetDbModelPropertiedNodeDefinition);\r\nDbModelCRUDBase.addAccessControl(SetDbModelPropertiedNodeDefinition);\r\n\r\nmodule.exports = SetDbModelPropertiedNodeDefinition;\r\n","'use strict';\r\n\r\nvar ModelCRUDBase = require('./modelcrudbase');\r\n\r\nvar SetModelPropertiedNodeDefinition = {\r\n  node: {\r\n    name: 'SetModelProperties',\r\n    docs: 'https://docs.noodl.net/nodes/data/object/set-object-properties',\r\n    displayNodeName: 'Set Object Properties',\r\n    inputs: {\r\n      store: {\r\n        displayName: 'Do',\r\n        group: 'Actions',\r\n        valueChangedToTrue: function () {\r\n          this.scheduleStore();\r\n        }\r\n      }\r\n    },\r\n    outputs: {\r\n      stored: {\r\n        type: 'signal',\r\n        displayName: 'Done',\r\n        group: 'Events'\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nModelCRUDBase.addBaseInfo(SetModelPropertiedNodeDefinition);\r\nModelCRUDBase.addModelId(SetModelPropertiedNodeDefinition);\r\nModelCRUDBase.addInputProperties(SetModelPropertiedNodeDefinition);\r\n\r\nmodule.exports = SetModelPropertiedNodeDefinition;\r\n","'use strict';\n\nconst DateToStringNode = {\n  name: 'Date To String',\n  docs: 'https://docs.noodl.net/nodes/utilities/date-to-string',\n  category: 'Utilities',\n  initialize: function () {\n    this._internal.formatString = '{year}-{month}-{date}';\n  },\n  inputs: {\n    formatString: {\n      displayName: 'Format',\n      type: 'string',\n      default: '{year}-{month}-{date}',\n      set: function (value) {\n        if (this._internal.formatString === value) return;\n        this._internal.formatString = value;\n\n        if (this._internal.currentInput !== undefined) {\n          this._format();\n          this.flagOutputDirty('currentValue');\n        }\n      }\n    },\n    input: {\n      type: { name: 'date' },\n      displayName: 'Date',\n      set: function (value) {\n        const _value = typeof value === 'string' ? new Date(value) : value;\n        if (this._internal.currentInput === _value) return;\n\n        this._internal.currentInput = _value;\n        this._format();\n      }\n    }\n  },\n  outputs: {\n    currentValue: {\n      type: 'string',\n      displayName: 'Date String',\n      group: 'Value',\n      getter: function () {\n        return this._internal.dateString;\n      }\n    },\n    inputChanged: {\n      type: 'signal',\n      displayName: 'Date Changed',\n      group: 'Signals'\n    },\n    onError: {\n      type: 'signal',\n      displayName: 'Invalid Date',\n      group: 'Signals'\n    }\n  },\n  methods: {\n    _format() {\n      try {\n        const t = this._internal.currentInput;\n        const format = this._internal.formatString;\n        const date = ('0' + t.getDate()).slice(-2);\n        const month = ('0' + (t.getMonth() + 1)).slice(-2);\n        const monthShort = new Intl.DateTimeFormat('en-US', { month: 'short' }).format(t);\n        const year = t.getFullYear();\n        const yearShort = year.toString().substring(2);\n        const hours = ('0' + t.getHours()).slice(-2);\n        const minutes = ('0' + t.getMinutes()).slice(-2);\n        const seconds = ('0' + t.getSeconds()).slice(-2);\n\n        this._internal.dateString = format\n          .replace(/\\{date\\}/g, date)\n          .replace(/\\{month\\}/g, month)\n          .replace(/\\{monthShort\\}/g, monthShort)\n          .replace(/\\{year\\}/g, year)\n          .replace(/\\{yearShort\\}/g, yearShort)\n          .replace(/\\{hours\\}/g, hours)\n          .replace(/\\{minutes\\}/g, minutes)\n          .replace(/\\{seconds\\}/g, seconds);\n      } catch (error) {\n        // Set the output to be blank, makes it easier to handle.\n        this._internal.dateString = '';\n        this.flagOutputDirty('onError');\n      }\n\n      // Flag that the value have changed\n      this.flagOutputDirty('currentValue');\n      this.sendSignalOnOutput('inputChanged');\n    }\n  }\n};\n\nmodule.exports = {\n  node: DateToStringNode\n};\n","'use strict';\r\n\r\nconst difference = require('lodash.difference');\r\n\r\n//const Model = require('./data/model');\r\n\r\nconst ExpressionNode = {\r\n  name: 'Expression',\r\n  docs: 'https://docs.noodl.net/nodes/math/expression',\r\n  usePortAsLabel: 'expression',\r\n  category: 'CustomCode',\r\n  color: 'javascript',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'Expression'\r\n  },\r\n  searchTags: ['javascript'],\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n\r\n    internal.scope = {};\r\n    internal.hasScheduledEvaluation = false;\r\n\r\n    internal.code = undefined;\r\n    internal.cachedValue = 0;\r\n    internal.currentExpression = '';\r\n    internal.compiledFunction = undefined;\r\n    internal.inputNames = [];\r\n    internal.inputValues = [];\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.cachedValue;\r\n  },\r\n  inputs: {\r\n    expression: {\r\n      group: 'General',\r\n      inputPriority: 1,\r\n      type: {\r\n        name: 'string',\r\n        allowEditOnly: true,\r\n        codeeditor: 'javascript'\r\n      },\r\n      displayName: 'Expression',\r\n      set: function (value) {\r\n        var internal = this._internal;\r\n        internal.currentExpression = functionPreamble + 'return (' + value + ');';\r\n        internal.compiledFunction = undefined;\r\n\r\n        var newInputs = parsePorts(value);\r\n\r\n        var inputsToAdd = difference(newInputs, internal.inputNames);\r\n        var inputsToRemove = difference(internal.inputNames, newInputs);\r\n\r\n        var self = this;\r\n        inputsToRemove.forEach(function (name) {\r\n          self.deregisterInput(name);\r\n          delete internal.scope[name];\r\n        });\r\n\r\n        inputsToAdd.forEach(function (name) {\r\n          if (self.hasInput(name)) {\r\n            return;\r\n          }\r\n\r\n          self.registerInput(name, {\r\n            set: function (value) {\r\n              internal.scope[name] = value;\r\n              if (!this.isInputConnected('run')) this._scheduleEvaluateExpression();\r\n            }\r\n          });\r\n\r\n          internal.scope[name] = 0;\r\n          self._inputValues[name] = 0;\r\n        });\r\n\r\n        /*      if(value.indexOf('Vars') !== -1 || value.indexOf('Variables') !== -1)  {\r\n                    // This expression is using variables, it should listen for changes\r\n                    this._internal.onVariablesChangedCallback = (args) => {\r\n                        this._scheduleEvaluateExpression()\r\n                    }\r\n\r\n                    Model.get('--ndl--global-variables').off('change',this._internal.onVariablesChangedCallback)\r\n                    Model.get('--ndl--global-variables').on('change',this._internal.onVariablesChangedCallback)\r\n                }*/\r\n\r\n        internal.inputNames = Object.keys(internal.scope);\r\n        if (!this.isInputConnected('run')) this._scheduleEvaluateExpression();\r\n      }\r\n    },\r\n    run: {\r\n      group: 'Actions',\r\n      displayName: 'Run',\r\n      type: 'signal',\r\n      valueChangedToTrue: function () {\r\n        this._scheduleEvaluateExpression();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    result: {\r\n      group: 'Result',\r\n      type: '*',\r\n      displayName: 'Result',\r\n      getter: function () {\r\n        if (!this._internal.currentExpression) {\r\n          return 0;\r\n        }\r\n\r\n        return this._internal.cachedValue;\r\n      }\r\n    },\r\n    isTrue: {\r\n      group: 'Result',\r\n      type: 'boolean',\r\n      displayName: 'Is True',\r\n      getter: function () {\r\n        if (!this._internal.currentExpression) {\r\n          return false;\r\n        }\r\n\r\n        return !!this._internal.cachedValue;\r\n      }\r\n    },\r\n    isFalse: {\r\n      group: 'Result',\r\n      type: 'boolean',\r\n      displayName: 'Is False',\r\n      getter: function () {\r\n        if (!this._internal.currentExpression) {\r\n          return true;\r\n        }\r\n\r\n        return !this._internal.cachedValue;\r\n      }\r\n    },\r\n    isTrueEv: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'On True'\r\n    },\r\n    isFalseEv: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'On False'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    registerInputIfNeeded: {\r\n      value: function (name) {\r\n        if (this.hasInput(name)) {\r\n          return;\r\n        }\r\n\r\n        this._internal.scope[name] = 0;\r\n        this._inputValues[name] = 0;\r\n\r\n        this.registerInput(name, {\r\n          set: function (value) {\r\n            this._internal.scope[name] = value;\r\n            if (!this.isInputConnected('run')) this._scheduleEvaluateExpression();\r\n          }\r\n        });\r\n      }\r\n    },\r\n    _scheduleEvaluateExpression: {\r\n      value: function () {\r\n        var internal = this._internal;\r\n        if (internal.hasScheduledEvaluation === false) {\r\n          internal.hasScheduledEvaluation = true;\r\n          this.flagDirty();\r\n          this.scheduleAfterInputsHaveUpdated(function () {\r\n            var lastValue = internal.cachedValue;\r\n            internal.cachedValue = this._calculateExpression();\r\n            if (lastValue !== internal.cachedValue) {\r\n              this.flagOutputDirty('result');\r\n              this.flagOutputDirty('isTrue');\r\n              this.flagOutputDirty('isFalse');\r\n            }\r\n            if (internal.cachedValue) this.sendSignalOnOutput('isTrueEv');\r\n            else this.sendSignalOnOutput('isFalseEv');\r\n            internal.hasScheduledEvaluation = false;\r\n          });\r\n        }\r\n      }\r\n    },\r\n    _calculateExpression: {\r\n      value: function () {\r\n        var internal = this._internal;\r\n\r\n        if (!internal.compiledFunction) {\r\n          internal.compiledFunction = this._compileFunction();\r\n        }\r\n        for (var i = 0; i < internal.inputNames.length; ++i) {\r\n          var inputValue = internal.scope[internal.inputNames[i]];\r\n          internal.inputValues[i] = inputValue;\r\n        }\r\n        try {\r\n          return internal.compiledFunction.apply(null, internal.inputValues);\r\n        } catch (e) {\r\n          console.error('Error in expression:', e.message);\r\n        }\r\n        return 0;\r\n      }\r\n    },\r\n    _compileFunction: {\r\n      value: function () {\r\n        var expression = this._internal.currentExpression;\r\n        var args = Object.keys(this._internal.scope);\r\n\r\n        var key = expression + args.join(' ');\r\n\r\n        if (compiledFunctionsCache.hasOwnProperty(key) === false) {\r\n          args.push(expression);\r\n\r\n          try {\r\n            compiledFunctionsCache[key] = construct(Function, args);\r\n          } catch (e) {\r\n            console.error('Failed to compile JS function', e.message);\r\n          }\r\n        }\r\n        return compiledFunctionsCache[key];\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nvar functionPreamble = [\r\n  'var min = Math.min,' +\r\n    '    max = Math.max,' +\r\n    '    cos = Math.cos,' +\r\n    '    sin = Math.sin,' +\r\n    '    tan = Math.tan,' +\r\n    '    sqrt = Math.sqrt,' +\r\n    '    pi = Math.PI,' +\r\n    '    round = Math.round,' +\r\n    '    floor = Math.floor,' +\r\n    '    ceil = Math.ceil,' +\r\n    '    abs = Math.abs,' +\r\n    '    random = Math.random;'\r\n  /* '    Vars = Variables = Noodl.Object.get(\"--ndl--global-variables\");' */\r\n].join('');\r\n\r\n//Since apply cannot be used on constructors (i.e. new Something) we need this hax\r\n//see http://stackoverflow.com/questions/1606797/use-of-apply-with-new-operator-is-this-possible\r\nfunction construct(constructor, args) {\r\n  function F() {\r\n    return constructor.apply(this, args);\r\n  }\r\n  F.prototype = constructor.prototype;\r\n  return new F();\r\n}\r\n\r\nvar compiledFunctionsCache = {};\r\n\r\nvar portsToIgnore = [\r\n  'min',\r\n  'max',\r\n  'cos',\r\n  'sin',\r\n  'tan',\r\n  'sqrt',\r\n  'pi',\r\n  'round',\r\n  'floor',\r\n  'ceil',\r\n  'abs',\r\n  'random',\r\n  'Math',\r\n  'window',\r\n  'document',\r\n  'undefined',\r\n  'Vars',\r\n  'true',\r\n  'false',\r\n  'null',\r\n  'Boolean'\r\n];\r\n\r\nfunction parsePorts(expression) {\r\n  var ports = [];\r\n\r\n  function addPort(name) {\r\n    if (portsToIgnore.indexOf(name) !== -1) return;\r\n    if (\r\n      ports.some(function (p) {\r\n        return p === name;\r\n      })\r\n    )\r\n      return;\r\n\r\n    ports.push(name);\r\n  }\r\n\r\n  // First remove all strings\r\n  expression = expression.replace(/\\\"([^\\\"]*)\\\"/g, '').replace(/\\'([^\\']*)\\'/g, '');\r\n\r\n  // Extract identifiers\r\n  var identifiers = expression.matchAll(/[a-zA-Z\\_\\$][a-zA-Z0-9\\.\\_\\$]*/g);\r\n  for (const _id of identifiers) {\r\n    var name = _id[0];\r\n    if (name.indexOf('.') !== -1) {\r\n      name = name.split('.')[0]; // Take first symbol on \".\" sequence\r\n    }\r\n\r\n    addPort(name);\r\n  }\r\n\r\n  return ports;\r\n}\r\n\r\nfunction updatePorts(nodeId, expression, editorConnection) {\r\n  var portNames = parsePorts(expression);\r\n\r\n  var ports = portNames.map(function (name) {\r\n    return {\r\n      group: 'Parameters',\r\n      name: name,\r\n      type: {\r\n        name: '*',\r\n        editAsType: 'string'\r\n      },\r\n      plug: 'input'\r\n    };\r\n  });\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nfunction evalCompileWarnings(editorConnection, node) {\r\n  try {\r\n    new Function(node.parameters.expression);\r\n    editorConnection.clearWarning(node.component.name, node.id, 'expression-compile-error');\r\n  } catch (e) {\r\n    editorConnection.sendWarning(node.component.name, node.id, 'expression-compile-error', {\r\n      message: e.message\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = {\r\n  node: ExpressionNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.Expression', function (node) {\r\n      if (node.parameters.expression) {\r\n        updatePorts(node.id, node.parameters.expression, context.editorConnection);\r\n        evalCompileWarnings(context.editorConnection, node);\r\n      }\r\n      node.on('parameterUpdated', function (event) {\r\n        if (event.name === 'expression') {\r\n          updatePorts(node.id, node.parameters.expression, context.editorConnection);\r\n          evalCompileWarnings(context.editorConnection, node);\r\n        }\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nfunction invert(value) {\r\n  if (value === undefined) {\r\n    return undefined;\r\n  }\r\n  return !value;\r\n}\r\n\r\nconst InverterNode = {\r\n  name: 'Inverter',\r\n  docs: 'https://docs.noodl.net/nodes/logic/inverter',\r\n  category: 'Logic',\r\n  initialize: function () {\r\n    this._internal.currentValue = undefined;\r\n  },\r\n  getInspectInfo() {\r\n    return String(invert(this._internal.currentValue));\r\n  },\r\n  inputs: {\r\n    value: {\r\n      type: {\r\n        name: 'boolean'\r\n      },\r\n      displayName: 'Value',\r\n      set: function (value) {\r\n        this._internal.currentValue = value;\r\n        this.flagOutputDirty('result');\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: 'boolean',\r\n      displayName: 'Result',\r\n      getter: function () {\r\n        return invert(this._internal.currentValue);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: InverterNode\r\n};\r\n","'use strict';\r\n\r\nconst OrNode = {\r\n  name: 'Or',\r\n  docs: 'https://docs.noodl.net/nodes/logic/or',\r\n  category: 'Logic',\r\n  initialize: function () {\r\n    this._internal.inputs = [];\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.inputs.some(isTrue);\r\n  },\r\n  numberedInputs: {\r\n    input: {\r\n      type: 'boolean',\r\n      displayPrefix: 'Input',\r\n      createSetter(index) {\r\n        return function (value) {\r\n          if (this._internal.inputs[index] === value) {\r\n            return;\r\n          }\r\n\r\n          this._internal.inputs[index] = value;\r\n          this.flagOutputDirty('result');\r\n        };\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: 'boolean',\r\n      displayName: 'Result',\r\n      getter: function () {\r\n        return this._internal.inputs.some(isTrue);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: OrNode\r\n};\r\n\r\nfunction isTrue(value) {\r\n  return value ? true : false;\r\n}\r\n","const { Node } = require('../../../noodl-runtime');\r\nconst guid = require('../../guid');\r\nconst Model = require('../../model');\r\n\r\nfunction sendSignalOnInput(itemNode, name) {\r\n  itemNode.queueInput(name, true); // send signal\r\n  itemNode.queueInput(name, false);\r\n}\r\n\r\nconst RunTasksDefinition = {\r\n  name: 'RunTasks',\r\n  displayNodeName: 'Run Tasks',\r\n  docs: 'https://docs.noodl.net/nodes/data/run-tasks',\r\n  color: 'data',\r\n  category: 'Data',\r\n  initialize() {\r\n    this._internal.queuedOperations = [];\r\n    this._internal.state = 'idle';\r\n    this._internal.maxRunningTasks = 10;\r\n    this._internal.activeTasks = new Map(); //id => ComponentInstanceNode\r\n  },\r\n  inputs: {\r\n    items: {\r\n      group: 'Data',\r\n      displayName: 'Items',\r\n      type: 'array',\r\n      set: function (value) {\r\n        if (!value) return;\r\n        if (value === this._internal.items) return;\r\n\r\n        this._internal.items = value;\r\n      }\r\n    },\r\n    stopOnFailure: {\r\n      group: 'General',\r\n      displayName: 'Stop On Failure',\r\n      type: 'boolean',\r\n      default: false,\r\n      set: function (value) {\r\n        this._internal.stopOnFailure = value;\r\n      }\r\n    },\r\n    maxRunningTasks: {\r\n      group: 'General',\r\n      displayName: 'Max Running Tasks',\r\n      type: 'number',\r\n      default: 10,\r\n      set: function (value) {\r\n        this._internal.maxRunningTasks = value;\r\n      }\r\n    },\r\n    taskTemplate: {\r\n      type: 'component',\r\n      displayName: 'Template',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.template = value;\r\n      }\r\n    },\r\n    run: {\r\n      group: 'General',\r\n      displayName: 'Do',\r\n      type: 'signal',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleRun();\r\n      }\r\n    },\r\n    abort: {\r\n      group: 'General',\r\n      displayName: 'Abort',\r\n      type: 'signal',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleAbort();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      group: 'Events',\r\n      displayName: 'Success'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      group: 'Events',\r\n      displayName: 'Failure'\r\n    },\r\n    done: {\r\n      type: 'signal',\r\n      group: 'Events',\r\n      displayName: 'Done'\r\n    },\r\n    aborted: {\r\n      type: 'signal',\r\n      group: 'Events',\r\n      displayName: 'Aborted'\r\n    }\r\n  },\r\n  methods: {\r\n    scheduleRun() {\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledRun) {\r\n        internal.hasScheduledRun = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          this._queueOperation(() => {\r\n            internal.hasScheduledRun = false;\r\n            this.run();\r\n          });\r\n        });\r\n      }\r\n    },\r\n    scheduleAbort() {\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledAbort) {\r\n        internal.hasScheduledAbort = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          this._queueOperation(() => {\r\n            internal.hasScheduledAbort = false;\r\n            this.abort();\r\n          });\r\n        });\r\n      }\r\n    },\r\n    async createTaskComponent(item) {\r\n      const internal = this._internal;\r\n\r\n      const modelScope = this.nodeScope.modelScope || Model;\r\n      const model = modelScope.create(item);\r\n\r\n      var itemNode = await this.nodeScope.createNode(internal.template, guid(), {\r\n        _forEachModel: model,\r\n        _forEachNode: this\r\n      });\r\n\r\n      // This is needed to make sure any action connected to \"Do\"\r\n      // is not run directly\r\n      const _isInputConnected = itemNode.isInputConnected.bind(itemNode);\r\n      itemNode.isInputConnected = (name) => {\r\n        if (name === 'Do') return true;\r\n        return _isInputConnected(name);\r\n      };\r\n\r\n      // Set the Id as an input\r\n      if (itemNode.hasInput('Id')) {\r\n        itemNode.setInputValue('Id', model.getId());\r\n      }\r\n      if (itemNode.hasInput('id')) {\r\n        itemNode.setInputValue('id', model.getId());\r\n      }\r\n\r\n      // Push all other values also as inputs\r\n      // if they exist as component inputs\r\n      for (var inputKey in itemNode._inputs) {\r\n        if (model.data[inputKey] !== undefined) itemNode.setInputValue(inputKey, model.data[inputKey]);\r\n      }\r\n\r\n      // capture signals\r\n      itemNode._internal.creatorCallbacks = {\r\n        onOutputChanged: (name, value, oldValue) => {\r\n          if ((oldValue === false || oldValue === undefined) && value === true) {\r\n            this.itemOutputSignalTriggered(name, model, itemNode);\r\n          }\r\n        }\r\n      };\r\n\r\n      return itemNode;\r\n    },\r\n    async startTask(task) {\r\n      const internal = this._internal;\r\n\r\n      try {\r\n        const taskComponent = await this.createTaskComponent(task);\r\n        internal.runningTasks++;\r\n        sendSignalOnInput(taskComponent, 'Do');\r\n        internal.activeTasks.set(taskComponent.id, taskComponent);\r\n      } catch (e) {\r\n        // Something went wrong starting the task\r\n        console.log(e);\r\n      }\r\n    },\r\n    async run() {\r\n      const internal = this._internal;\r\n\r\n      if (this.context.editorConnection) {\r\n        if (internal.state !== 'idle') {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'run-tasks', {\r\n            message: 'Cannot start when not in idle mode'\r\n          });\r\n        } else if (!internal.template) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'run-tasks', {\r\n            message: 'No task template specified.'\r\n          });\r\n        } else if (!internal.items) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'run-tasks', {\r\n            message: 'No items array provided.'\r\n          });\r\n        } else {\r\n          this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'run-tasks');\r\n        }\r\n      }\r\n\r\n      if (internal.state !== 'idle') {\r\n        return;\r\n      }\r\n\r\n      if (!internal.template) {\r\n        return;\r\n      }\r\n\r\n      if (!internal.items) {\r\n        return;\r\n      }\r\n\r\n      internal.state = 'running';\r\n      internal.numTasks = internal.items.length;\r\n      internal.failedTasks = 0;\r\n      internal.completedTasks = 0;\r\n      internal.queuedTasks = [].concat(internal.items);\r\n      internal.runningTasks = 0;\r\n\r\n      // No tasks\r\n      if (internal.items.length === 0) {\r\n        this.sendSignalOnOutput('success');\r\n        internal.state = 'idle';\r\n      }\r\n\r\n      // Start tasks\r\n      for (let i = 0; i < Math.min(internal.maxRunningTasks, internal.queuedTasks.length); i++) {\r\n        const task = internal.queuedTasks.shift();\r\n        if (!task) break;\r\n\r\n        this.startTask(task);\r\n      }\r\n    },\r\n    abort: function () {\r\n      const internal = this._internal;\r\n\r\n      internal.state = 'aborted';\r\n    },\r\n    itemOutputSignalTriggered: function (name, model, itemNode) {\r\n      const internal = this._internal;\r\n\r\n      if (internal.state === 'idle') {\r\n        // Signal while we are not running is ignored\r\n        return;\r\n      }\r\n\r\n      const checkDone = () => {\r\n        if (internal.state === 'aborted') {\r\n          this.sendSignalOnOutput('aborted');\r\n          internal.state = 'idle';\r\n          return;\r\n        }\r\n\r\n        if (internal.completedTasks === internal.numTasks) {\r\n          if (internal.failedTasks === 0) this.sendSignalOnOutput('success');\r\n          else this.sendSignalOnOutput('failure');\r\n          this.sendSignalOnOutput('done');\r\n          internal.state = 'idle';\r\n        } else {\r\n          if (internal.stopOnFailure) {\r\n            // Only continue if there are no failed tasks, otherwise aborted\r\n            if (internal.failedTasks === 0) {\r\n              internal.runningTasks++;\r\n              const task = internal.queuedTasks.shift();\r\n              if (task) this.startTask(task);\r\n            } else {\r\n              this.sendSignalOnOutput('failure');\r\n              this.sendSignalOnOutput('aborted');\r\n            }\r\n          } else {\r\n            internal.runningTasks++;\r\n            const task = internal.queuedTasks.shift();\r\n            if (task) this.startTask(task);\r\n          }\r\n        }\r\n      };\r\n\r\n      if (name === 'Success') {\r\n        internal.completedTasks++;\r\n        internal.runningTasks--;\r\n        checkDone();\r\n      } else if (name === 'Failure') {\r\n        internal.completedTasks++;\r\n        internal.failedTasks++;\r\n        internal.runningTasks--;\r\n        checkDone();\r\n      }\r\n\r\n      internal.activeTasks.delete(itemNode.id);\r\n      this.nodeScope.deleteNode(itemNode);\r\n    },\r\n    _queueOperation(op) {\r\n      this._internal.queuedOperations.push(op);\r\n      this._runQueueOperations();\r\n    },\r\n    async _runQueueOperations() {\r\n      if (this.runningOperations) {\r\n        return;\r\n      }\r\n      this.runningOperations = true;\r\n\r\n      while (this._internal.queuedOperations.length) {\r\n        const op = this._internal.queuedOperations.shift();\r\n        await op();\r\n      }\r\n\r\n      this.runningOperations = false;\r\n    }\r\n  },\r\n  _deleteAllTasks() {\r\n    for (const taskComponent of this._internal.activeTasks) {\r\n      this.nodeScope.deleteNode(taskComponent);\r\n    }\r\n    this._internal.activeTasks.clear();\r\n  },\r\n  _onNodeDeleted: function () {\r\n    Node.prototype._onNodeDeleted.call(this);\r\n    this._deleteAllTasks();\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: RunTasksDefinition\r\n};\r\n","const JavascriptNodeParser = require('../../javascriptnodeparser');\r\nconst { logJavaScriptNodeError } = require('../../utils');\r\n\r\nconst SimpleJavascriptNode = {\r\n  name: 'JavaScriptFunction',\r\n  displayNodeName: 'Function',\r\n  docs: 'https://docs.noodl.net/nodes/javascript/function',\r\n  category: 'CustomCode',\r\n  color: 'javascript',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'Script'\r\n  },\r\n  searchTags: ['javascript'],\r\n  exportDynamicPorts: true,\r\n  initialize: function () {\r\n    this._internal.inputValues = {};\r\n    this._internal.outputValues = {};\r\n\r\n    this._internal.outputValuesProxy = new Proxy(this._internal.outputValues, {\r\n      set: (obj, prop, value) => {\r\n        //a function node can continue running after it has been deleted. E.g. with timeouts or event listeners that hasn't been removed.\r\n        //if the node is deleted, just do nothing\r\n        if (this._deleted) {\r\n          return;\r\n        }\r\n\r\n        //only send outputs when they change.\r\n        //Some Noodl projects rely on this behavior, so changing it breaks backwards compability\r\n        if (value !== this._internal.outputValues[prop]) {\r\n          this.registerOutputIfNeeded('out-' + prop);\r\n\r\n          this._internal.outputValues[prop] = value;\r\n          this.flagOutputDirty('out-' + prop);\r\n        }\r\n        return true;\r\n      }\r\n    });\r\n\r\n    this._internal._this = {};\r\n  },\r\n  getInspectInfo() {\r\n    return [\r\n      {\r\n        type: 'value',\r\n        value: {\r\n          inputs: this._internal.inputValues,\r\n          outputs: this._internal.outputValues\r\n        }\r\n      }\r\n    ];\r\n  },\r\n  inputs: {\r\n    scriptInputs: {\r\n      type: {\r\n        name: 'proplist',\r\n        allowEditOnly: true\r\n      },\r\n      group: 'Script Inputs',\r\n      set(value) {\r\n        //  ignore\r\n      }\r\n    },\r\n    scriptOutputs: {\r\n      type: {\r\n        name: 'proplist',\r\n        allowEditOnly: true\r\n      },\r\n      group: 'Script Outputs',\r\n      set(value) {\r\n        //  ignore\r\n      }\r\n    },\r\n    functionScript: {\r\n      displayName: 'Script',\r\n      plug: 'input',\r\n      type: {\r\n        name: 'string',\r\n        allowEditOnly: true,\r\n        codeeditor: 'javascript'\r\n      },\r\n      group: 'General',\r\n      set(script) {\r\n        if (script === undefined) {\r\n          this._internal.func = undefined;\r\n          return;\r\n        }\r\n\r\n        this._internal.func = this.parseScript(script);\r\n\r\n        if (!this.isInputConnected('run')) this.scheduleRun();\r\n      }\r\n    },\r\n    run: {\r\n      type: 'signal',\r\n      displayName: 'Run',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleRun();\r\n      }\r\n    }\r\n  },\r\n  outputs: {},\r\n  methods: {\r\n    scheduleRun: function () {\r\n      if (this.runScheduled) return;\r\n      this.runScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.runScheduled = false;\r\n\r\n        if (!this._deleted) {\r\n          this.runScript();\r\n        }\r\n      });\r\n    },\r\n    runScript: async function () {\r\n      const func = this._internal.func;\r\n\r\n      if (func === undefined) return;\r\n\r\n      const inputs = this._internal.inputValues;\r\n      const outputs = this._internal.outputValuesProxy;\r\n\r\n      // Prepare send signal functions\r\n      for (const key in this.model.outputPorts) {\r\n        if (this._isSignalType(key)) {\r\n          const _sendSignal = () => {\r\n            if (this.hasOutput(key)) this.sendSignalOnOutput(key);\r\n          };\r\n          this._internal.outputValues[key.substring('out-'.length)] = _sendSignal;\r\n          this._internal.outputValues[key.substring('out-'.length)].send = _sendSignal;\r\n        }\r\n      }\r\n\r\n      try {\r\n        await func.apply(this._internal._this, [\r\n          inputs,\r\n          outputs,\r\n          JavascriptNodeParser.createNoodlAPI(this.nodeScope.modelScope),\r\n          JavascriptNodeParser.getComponentScopeForNode(this)\r\n        ]);\r\n      } catch (e) {\r\n        logJavaScriptNodeError(e);\r\n\r\n        if (this.context.editorConnection && this.context.isWarningTypeEnabled('javascriptExecution')) {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            'js-function-run-waring',\r\n            {\r\n              showGlobally: true,\r\n              message: e.message,\r\n              stack: e.stack\r\n            }\r\n          );\r\n        }\r\n      }\r\n    },\r\n    setScriptInputValue: function (name, value) {\r\n      this._internal.inputValues[name] = value;\r\n\r\n      if (!this.isInputConnected('run')) this.scheduleRun();\r\n    },\r\n    getScriptOutputValue: function (name) {\r\n      if (this._isSignalType(name)) {\r\n        return undefined;\r\n      }\r\n      return this._internal.outputValues[name];\r\n    },\r\n    setScriptInputType: function (name, type) {\r\n      this._internal.inputTypes[name] = type;\r\n    },\r\n    setScriptOutputType: function (name, type) {\r\n      this._internal.outputTypes[name] = type;\r\n    },\r\n    parseScript: function (script) {\r\n      var func;\r\n      try {\r\n        const AsyncFunction = Object.getPrototypeOf(async function () {}).constructor;\r\n        func = new AsyncFunction(\r\n          'Inputs',\r\n          'Outputs',\r\n          'Noodl',\r\n          'Component',\r\n          JavascriptNodeParser.getCodePrefix() + script\r\n        );\r\n      } catch (e) {\r\n        console.log('Error while parsing action script: ' + e);\r\n      }\r\n\r\n      return func;\r\n    },\r\n    _isSignalType: function (name) {\r\n      // This will catch signals in script that may not have been delivered by the editor yet\r\n      return this.model.outputPorts[name] && this.model.outputPorts[name].type === 'signal';\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('in-')) {\r\n        const n = name.substring('in-'.length);\r\n\r\n        const input = {\r\n          set: this.setScriptInputValue.bind(this, n)\r\n        };\r\n\r\n        //make sure we register the type as well, so Noodl resolves types like color styles to an actual color\r\n        if (this.model && this.model.parameters['intype-' + n]) {\r\n          input.type = this.model.parameters['intype-' + n];\r\n        }\r\n\r\n        this.registerInput(name, input);\r\n      }\r\n\r\n      if (name.startsWith('intype-')) {\r\n        const n = name.substring('intype-'.length);\r\n\r\n        this.registerInput(name, {\r\n          set(value) {\r\n            //make sure we register the type as well, so Noodl resolves types like color styles to an actual color\r\n            if (this.hasInput('in' + n)) {\r\n              this.getInput('in' + n).type = value;\r\n            }\r\n          }\r\n        });\r\n      }\r\n\r\n      if (name.startsWith('outtype-')) {\r\n        this.registerInput(name, {\r\n          set() {} // Ignore\r\n        });\r\n      }\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('out-'))\r\n        return this.registerOutput(name, {\r\n          getter: this.getScriptOutputValue.bind(this, name.substring('out-'.length))\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nfunction _parseScriptForErrorsAndPorts(script, name, node, context, ports) {\r\n  // Clear run warnings if the script is edited\r\n  context.editorConnection.clearWarning(node.component.name, node.id, 'js-function-run-waring');\r\n\r\n  if (script === undefined) {\r\n    context.editorConnection.clearWarning(node.component.name, node.id, 'js-function-parse-waring');\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const AsyncFunction = Object.getPrototypeOf(async function () {}).constructor;\r\n    new AsyncFunction('Inputs', 'Outputs', 'Noodl', 'Component', script);\r\n\r\n    context.editorConnection.clearWarning(node.component.name, node.id, 'js-function-parse-waring');\r\n  } catch (e) {\r\n    context.editorConnection.sendWarning(node.component.name, node.id, 'js-function-parse-waring', {\r\n      showGlobally: true,\r\n      message: e.message\r\n    });\r\n  }\r\n\r\n  JavascriptNodeParser.parseAndAddPortsFromScript(script, ports, {\r\n    inputPrefix: 'in-',\r\n    outputPrefix: 'out-'\r\n  });\r\n}\r\n\r\nconst inputTypeEnums = [\r\n  {\r\n    value: 'string',\r\n    label: 'String'\r\n  },\r\n  {\r\n    value: 'boolean',\r\n    label: 'Boolean'\r\n  },\r\n  {\r\n    value: 'number',\r\n    label: 'Number'\r\n  },\r\n  {\r\n    value: 'object',\r\n    label: 'Object'\r\n  },\r\n  {\r\n    value: 'date',\r\n    label: 'Date'\r\n  },\r\n  {\r\n    value: 'array',\r\n    label: 'Array'\r\n  },\r\n  {\r\n    value: 'color',\r\n    label: 'Color'\r\n  }\r\n];\r\n\r\nmodule.exports = {\r\n  node: SimpleJavascriptNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _updatePorts() {\r\n        var ports = [];\r\n\r\n        const _outputTypeEnums = inputTypeEnums.concat([\r\n          {\r\n            value: 'signal',\r\n            label: 'Signal'\r\n          }\r\n        ]);\r\n\r\n        // Outputs\r\n        if (node.parameters['scriptOutputs'] !== undefined && node.parameters['scriptOutputs'].length > 0) {\r\n          node.parameters['scriptOutputs'].forEach((p) => {\r\n            // Type for output\r\n            ports.push({\r\n              name: 'outtype-' + p.label,\r\n              displayName: 'Type',\r\n              editorName: p.label + ' | Type',\r\n              plug: 'input',\r\n              type: {\r\n                name: 'enum',\r\n                enums: _outputTypeEnums,\r\n                allowEditOnly: true\r\n              },\r\n              default: 'string',\r\n              parent: 'scriptOutputs',\r\n              parentItemId: p.id\r\n            });\r\n\r\n            // Value for output\r\n            ports.push({\r\n              name: 'out-' + p.label,\r\n              displayName: p.label,\r\n              plug: 'output',\r\n              type: node.parameters['outtype-' + p.label] || '*',\r\n              group: 'Outputs'\r\n            });\r\n          });\r\n        }\r\n\r\n        // Inputs\r\n        if (node.parameters['scriptInputs'] !== undefined && node.parameters['scriptInputs'].length > 0) {\r\n          node.parameters['scriptInputs'].forEach((p) => {\r\n            // Type for input\r\n            ports.push({\r\n              name: 'intype-' + p.label,\r\n              displayName: 'Type',\r\n              editorName: p.label + ' | Type',\r\n              plug: 'input',\r\n              type: {\r\n                name: 'enum',\r\n                enums: inputTypeEnums,\r\n                allowEditOnly: true\r\n              },\r\n              default: 'string',\r\n              parent: 'scriptInputs',\r\n              parentItemId: p.id\r\n            });\r\n\r\n            // Default Value for input\r\n            ports.push({\r\n              name: 'in-' + p.label,\r\n              displayName: p.label,\r\n              plug: 'input',\r\n              type: node.parameters['intype-' + p.label] || 'string',\r\n              group: 'Inputs'\r\n            });\r\n          });\r\n        }\r\n\r\n        _parseScriptForErrorsAndPorts(node.parameters['functionScript'], 'Script ', node, context, ports);\r\n\r\n        // Push output ports that are signals directly to the model, it's needed by the initial run of\r\n        // the script function\r\n        ports.forEach((p) => {\r\n          if (p.type === 'signal' && p.plug === 'output') {\r\n            node.outputPorts[p.name] = p;\r\n          }\r\n        });\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on('parameterUpdated', function (ev) {\r\n        _updatePorts();\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.JavaScriptFunction', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('JavaScriptFunction')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","const StringFormatDefinition = {\n  name: 'String Format',\n  docs: 'https://docs.noodl.net/nodes/string-manipulation/string-format',\n  category: 'String Manipulation',\n  usePortAsLabel: 'format',\n  portLabelTruncationMode: 'length',\n  initialize() {\n    const internal = this._internal;\n    internal.format = '';\n    internal.cachedResult = '';\n    internal.resultDirty = false;\n    internal.inputValues = {};\n  },\n  getInspectInfo() {\n    return this.formatValue();\n  },\n  inputs: {\n    format: {\n      type: { name: 'string', multiline: true },\n      displayName: 'Format',\n      set(value) {\n        if (this._internal.format === value) return;\n\n        this._internal.format = value;\n        this._internal.resultDirty = true;\n        this.scheduleFormat();\n      }\n    }\n  },\n  outputs: {\n    formatted: {\n      type: 'string',\n      displayName: 'Formatted',\n      get() {\n        return this.formatValue();\n      }\n    }\n  },\n  methods: {\n    formatValue() {\n      var internal = this._internal;\n\n      if (internal.resultDirty) {\n        var formatted = internal.format;\n\n        var matches = internal.format.match(/\\{[A-Za-z0-9_]*\\}/g);\n        var inputs = [];\n        if (matches) {\n          inputs = matches.map(function (name) {\n            return name.replace('{', '').replace('}', '');\n          });\n        }\n\n        inputs.forEach(function (name) {\n          var v = internal.inputValues[name];\n          formatted = formatted.replace('{' + name + '}', v !== undefined ? v : '');\n        });\n\n        internal.cachedResult = formatted;\n        internal.resultDirty = false;\n      }\n\n      return internal.cachedResult;\n    },\n    registerInputIfNeeded(name) {\n      if (this.hasInput(name)) {\n        return;\n      }\n\n      this.registerInput(name, {\n        set: userInputSetter.bind(this, name)\n      });\n    },\n    scheduleFormat() {\n      if (this.formatScheduled) return;\n\n      this.formatScheduled = true;\n      this.scheduleAfterInputsHaveUpdated(() => {\n        this.formatValue();\n        this.flagOutputDirty('formatted');\n        this.formatScheduled = false;\n      });\n    }\n  }\n};\n\nfunction userInputSetter(name, value) {\n  /* jshint validthis:true */\n  if (this._internal.inputValues[name] === value) return;\n\n  this._internal.inputValues[name] = value;\n  this._internal.resultDirty = true;\n  this.scheduleFormat();\n}\n\nfunction updatePorts(id, format, editorConnection) {\n  var inputs = format.match(/\\{[A-Za-z0-9_]*\\}/g) || [];\n  var portsNames = inputs.map(function (def) {\n    return def.replace('{', '').replace('}', '');\n  });\n\n  var ports = portsNames\n    //get unique names\n    .filter(function (value, index, self) {\n      return self.indexOf(value) === index;\n    })\n    //and map names to ports\n    .map(function (name) {\n      return {\n        name: name,\n        type: 'string',\n        plug: 'input'\n      };\n    });\n\n  editorConnection.sendDynamicPorts(id, ports);\n}\n\nmodule.exports = {\n  node: StringFormatDefinition,\n  setup: function (context, graphModel) {\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\n      return;\n    }\n\n    graphModel.on('nodeAdded.String Format', function (node) {\n      if (node.parameters.format) {\n        updatePorts(node.id, node.parameters.format, context.editorConnection);\n      }\n      node.on('parameterUpdated', function (event) {\n        if (event.name === 'format') {\n          updatePorts(node.id, node.parameters.format, context.editorConnection);\n        }\n      });\n    });\n  }\n};\n","const StringMapperNode = {\r\n  name: 'String Mapper',\r\n  docs: 'https://docs.noodl.net/nodes/string-manipulation/string-mapper',\r\n  category: 'Utilities',\r\n  initialize: function () {\r\n    this._internal.inputs = [];\r\n    this._internal.mappings = [];\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.mappedString;\r\n  },\r\n  numberedInputs: {\r\n    input: {\r\n      type: 'string',\r\n      displayPrefix: 'Input',\r\n      group: 'Inputs',\r\n      index: 10,\r\n      createSetter(index) {\r\n        return function (value) {\r\n          value = value === undefined ? '' : value.toString();\r\n          this._internal.inputs[index] = value;\r\n          this.scheduleMapping();\r\n        };\r\n      }\r\n    },\r\n    output: {\r\n      type: 'string',\r\n      displayPrefix: 'Mapping',\r\n      index: 1001,\r\n      group: 'Mappings',\r\n      createSetter(index) {\r\n        return function (value) {\r\n          value = value === undefined ? '' : value.toString();\r\n          this._internal.mappings[index] = value;\r\n          this.scheduleMapping();\r\n        };\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    inputString: {\r\n      type: {\r\n        name: 'string'\r\n      },\r\n      index: 1,\r\n      displayName: 'Input String',\r\n      set: function (value) {\r\n        this._internal.currentInputString = value !== undefined ? value.toString() : undefined;\r\n        this.scheduleMapping();\r\n      }\r\n    },\r\n    defaultMapping: {\r\n      type: 'string',\r\n      displayName: 'Default',\r\n      index: 1000,\r\n      group: 'Mappings',\r\n      set: function (value) {\r\n        this._internal.defaultMapping = value;\r\n        this.scheduleMapping();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    mappedString: {\r\n      type: 'string',\r\n      displayName: 'Mapped String',\r\n      group: 'Value',\r\n      getter: function () {\r\n        return this._internal.mappedString;\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    doMapping: function () {\r\n      this._internal.hasScheduledFetch = false;\r\n      var idx = this._internal.inputs.indexOf(this._internal.currentInputString);\r\n      if (idx !== -1) this._internal.mappedString = this._internal.mappings[idx];\r\n      else this._internal.mappedString = this._internal.defaultMapping;\r\n\r\n      this.flagOutputDirty('mappedString');\r\n    },\r\n    scheduleMapping: function () {\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledFetch) {\r\n        internal.hasScheduledFetch = true;\r\n        this.scheduleAfterInputsHaveUpdated(this.doMapping.bind(this));\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: StringMapperNode\r\n};\r\n","'use strict';\r\n\r\nconst SubStringNode = {\r\n  name: 'Substring',\r\n  docs: 'https://docs.noodl.net/nodes/string-manipulation/substring',\r\n  category: 'String Manipulation',\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.startIndex = 0;\r\n    internal.endIndex = -1;\r\n    internal.cachedResult = '';\r\n    internal.inputString = '';\r\n    internal.resultDirty = false;\r\n  },\r\n  inputs: {\r\n    start: {\r\n      type: 'number',\r\n      displayName: 'Start',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal.startIndex = value;\r\n        this._internal.resultDirty = true;\r\n        this.flagOutputDirty('result');\r\n      }\r\n    },\r\n    end: {\r\n      type: 'number',\r\n      displayName: 'End',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal.endIndex = value;\r\n        this._internal.resultDirty = true;\r\n        this.flagOutputDirty('result');\r\n      }\r\n    },\r\n    string: {\r\n      type: {\r\n        name: 'string'\r\n      },\r\n      displayName: 'String',\r\n      default: '',\r\n      set: function (value) {\r\n        value = value.toString();\r\n        this._internal.inputString = value;\r\n        this._internal.resultDirty = true;\r\n        this.flagOutputDirty('result');\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: 'string',\r\n      displayName: 'Result',\r\n      getter: function () {\r\n        var internal = this._internal;\r\n\r\n        if (internal.resultDirty) {\r\n          if (internal.endIndex === -1) {\r\n            internal.cachedResult = internal.inputString.substr(internal.startIndex);\r\n          } else {\r\n            internal.cachedResult = internal.inputString.substr(\r\n              internal.startIndex,\r\n              internal.endIndex - internal.startIndex\r\n            );\r\n          }\r\n          internal.resultDirty = false;\r\n        }\r\n        return internal.cachedResult;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: SubStringNode\r\n};\r\n","'use strict';\r\n\r\nconst Model = require('../../model');\r\n\r\nconst UniqueIdNode = {\r\n  name: 'Unique Id',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/unique-id',\r\n  category: 'String Manipulation',\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.guid = Model.guid();\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.guid;\r\n  },\r\n  inputs: {\r\n    new: {\r\n      displayName: 'New',\r\n      valueChangedToTrue: function () {\r\n        var internal = this._internal;\r\n        internal.guid = Model.guid();\r\n        this.flagOutputDirty('guid');\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    guid: {\r\n      type: 'string',\r\n      displayName: 'Id',\r\n      getter: function () {\r\n        var internal = this._internal;\r\n        return internal.guid;\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {}\r\n};\r\n\r\nmodule.exports = {\r\n  node: UniqueIdNode\r\n};\r\n","'use strict';\r\n\r\nconst NoodlRuntime = require('../../../../noodl-runtime');\r\n\r\nvar SetUserPropertiesNodeDefinition = {\r\n  name: 'net.noodl.user.SetUserProperties',\r\n  docs: 'https://docs.noodl.net/nodes/data/user/set-user-properties',\r\n  displayNodeName: 'Set User Properties',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n\r\n    internal.userProperties = {};\r\n  },\r\n  getInspectInfo() {},\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    store: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleStore();\r\n      }\r\n    },\r\n    email: {\r\n      displayName: 'Email',\r\n      type: 'string',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.email = value;\r\n      }\r\n    },\r\n    username: {\r\n      displayName: 'Username',\r\n      type: 'string',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.username = value;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setError: function (err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'user-set-warning', {\r\n          message: err,\r\n          showGlobally: true\r\n        });\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'user-set-warning');\r\n      }\r\n    },\r\n    scheduleStore: function () {\r\n      const internal = this._internal;\r\n\r\n      if (this.storeScheduled === true) return;\r\n      this.storeScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.storeScheduled = false;\r\n\r\n        const UserService = NoodlRuntime.Services.UserService;\r\n        UserService.forScope(this.nodeScope.modelScope).setUserProperties({\r\n          email: this._internal.email,\r\n          username: this._internal.username,\r\n          properties: internal.userProperties,\r\n          success: () => {\r\n            this.sendSignalOnOutput('success');\r\n          },\r\n          error: (e) => {\r\n            this.setError(e);\r\n          }\r\n        });\r\n      });\r\n    },\r\n    setUserProperty: function (name, value) {\r\n      this._internal.userProperties[name] = value;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('prop-'))\r\n        return this.registerInput(name, {\r\n          set: this.setUserProperty.bind(this, name.substring('prop-'.length))\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection, systemCollections) {\r\n  var ports = [];\r\n\r\n  if (systemCollections) {\r\n    // Fetch ports from collection keys\r\n    var c = systemCollections.find((c) => c.name === '_User');\r\n    if (c && c.schema && c.schema.properties) {\r\n      var props = c.schema.properties;\r\n\r\n      const _ignoreKeys =\r\n        typeof _noodl_cloud_runtime_version === 'undefined'\r\n          ? ['authData', 'createdAt', 'updatedAt', 'email', 'username', 'emailVerified', 'password']\r\n          : ['authData', 'createdAt', 'updatedAt', 'email', 'username'];\r\n\r\n      for (var key in props) {\r\n        if (_ignoreKeys.indexOf(key) !== -1) continue;\r\n\r\n        var p = props[key];\r\n        if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n        if (p.type === 'Relation') {\r\n        } else {\r\n          // Other schema type ports\r\n          const _typeMap = {\r\n            String: 'string',\r\n            Boolean: 'boolean',\r\n            Number: 'number',\r\n            Date: 'date'\r\n          };\r\n\r\n          ports.push({\r\n            type: {\r\n              name: _typeMap[p.type] ? _typeMap[p.type] : '*'\r\n            },\r\n            plug: 'input',\r\n            group: 'Properties',\r\n            name: 'prop-' + key,\r\n            displayName: key\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nmodule.exports = {\r\n  node: SetUserPropertiesNodeDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('systemCollections'));\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('systemCollections'));\r\n      });\r\n\r\n      graphModel.on('metadataChanged.systemCollections', function (data) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.net.noodl.user.SetUserProperties', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('net.noodl.user.SetUserProperties')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst NoodlRuntime = require('../../../../noodl-runtime');\r\nconst { Node } = require('../../../../noodl-runtime');\r\n\r\nvar UserNodeDefinition = {\r\n  name: 'net.noodl.user.User',\r\n  docs: 'https://docs.noodl.net/nodes/data/user/user-node',\r\n  displayNodeName: 'User',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  initialize: function () {\r\n    var _this = this;\r\n    this._internal.onModelChangedCallback = function (args) {\r\n      if (_this.isInputConnected('fetch')) return;\r\n\r\n      if (_this.hasOutput('prop-' + args.name)) _this.flagOutputDirty('prop-' + args.name);\r\n\r\n      if (_this.hasOutput('changed-' + args.name)) _this.sendSignalOnOutput('changed-' + args.name);\r\n\r\n      _this.sendSignalOnOutput('changed');\r\n    };\r\n\r\n    const userService = NoodlRuntime.Services.UserService.forScope(this.nodeScope.modelScope);\r\n\r\n    this.setUserModel(userService.current);\r\n    userService.on('loggedIn', () => {\r\n      this.setUserModel(userService.current);\r\n\r\n      if (this.hasOutput('loggedIn')) this.sendSignalOnOutput('loggedIn');\r\n    });\r\n\r\n    userService.on('sessionGained', () => {\r\n      this.setUserModel(userService.current);\r\n    });\r\n\r\n    userService.on('loggedOut', () => {\r\n      this.setUserModel(undefined);\r\n      if (this.hasOutput('loggedOut')) this.sendSignalOnOutput('loggedOut');\r\n    });\r\n\r\n    userService.on('sessionLost', () => {\r\n      this.setUserModel(undefined);\r\n      if (this.hasOutput('sessionLost')) this.sendSignalOnOutput('sessionLost');\r\n    });\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return '[No Model]';\r\n\r\n    return [\r\n      { type: 'text', value: 'Id: ' + model.getId() },\r\n      { type: 'value', value: this._internal.model.data }\r\n    ];\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: 'string',\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.model !== undefined ? this._internal.model.getId() : undefined;\r\n      }\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    },\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    },\r\n    username: {\r\n      type: 'string',\r\n      displayName: 'Username',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.model !== undefined ? this._internal.model.get('username') : undefined;\r\n      }\r\n    },\r\n    email: {\r\n      type: 'string',\r\n      displayName: 'Email',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.model !== undefined ? this._internal.model.get('email') : undefined;\r\n      }\r\n    },\r\n    authenticated: {\r\n      type: 'boolean',\r\n      displayName: 'Authenticated',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.model !== undefined;\r\n      }\r\n    }\r\n    /*    loggedIn:{\r\n            type:'signal',\r\n            displayName:'Logged In',\r\n            group:'Events'\r\n        },\r\n        loggedOut:{\r\n            type:'signal',\r\n            displayName:'Logged Out',\r\n            group:'Events'\r\n        },\r\n        sessionLost:{\r\n            type:'signal',\r\n            displayName:'Session Lost',\r\n            group:'Events'\r\n        },         */\r\n  },\r\n  inputs: {\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleFetch();\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      if (this._internal.model) this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n    },\r\n    scheduleOnce: function (type, cb) {\r\n      const _this = this;\r\n      const _type = 'hasScheduled' + type;\r\n      if (this._internal[_type]) return;\r\n      this._internal[_type] = true;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this._internal[_type] = false;\r\n        cb();\r\n      });\r\n    },\r\n    setError: function (err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'user-warning', {\r\n          message: err,\r\n          showGlobally: true\r\n        });\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'user-warning');\r\n      }\r\n    },\r\n    setUserModel(model) {\r\n      const internal = this._internal;\r\n\r\n      if (internal.model !== model) {\r\n        // Check if we need to change model\r\n        if (internal.model)\r\n          // Remove old listener if existing\r\n          internal.model.off('change', internal.onModelChangedCallback);\r\n\r\n        internal.model = model;\r\n        if (model) model.on('change', internal.onModelChangedCallback);\r\n      }\r\n      this.flagOutputDirty('id');\r\n      this.flagOutputDirty('authenticated');\r\n      this.flagOutputDirty('email');\r\n      this.flagOutputDirty('username');\r\n\r\n      // Notify all properties changed\r\n      if (model)\r\n        for (var key in model.data) {\r\n          if (this.hasOutput('prop-' + key)) this.flagOutputDirty('prop-' + key);\r\n        }\r\n    },\r\n    scheduleFetch: function () {\r\n      const internal = this._internal;\r\n\r\n      this.scheduleOnce('Fetch', () => {\r\n        const userService = NoodlRuntime.Services.UserService.forScope(this.nodeScope.modelScope);\r\n        userService.fetchCurrentUser({\r\n          success: (response) => {\r\n            this.setUserModel(userService.current);\r\n\r\n            this.sendSignalOnOutput('fetched');\r\n          },\r\n          error: (err) => {\r\n            this.setError(err || 'Failed to fetch.');\r\n          }\r\n        });\r\n      });\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'loggedOut' || name === 'loggedIn' || name === 'sessionLost') {\r\n        this.registerOutput(name, {\r\n          getter: () => {} /* No getter needed, signal */\r\n        });\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('prop-'))\r\n        this.registerOutput(name, {\r\n          getter: this.getUserProperty.bind(this, name.substring('prop-'.length))\r\n        });\r\n    },\r\n    getUserProperty: function (name) {\r\n      return this._internal.model !== undefined ? this._internal.model.get(name) : undefined;\r\n    }\r\n  }\r\n};\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection, systemCollections) {\r\n  var ports = [];\r\n\r\n  if (systemCollections) {\r\n    // Fetch ports from collection keys\r\n    var c = systemCollections.find((c) => c.name === '_User');\r\n    if (c && c.schema && c.schema.properties) {\r\n      var props = c.schema.properties;\r\n      const _ignoreKeys = ['authData', 'password', 'username', 'email'];\r\n      for (var key in props) {\r\n        if (_ignoreKeys.indexOf(key) !== -1) continue;\r\n\r\n        var p = props[key];\r\n        if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n        if (p.type === 'Relation') {\r\n        } else {\r\n          // Other schema type ports\r\n          const _typeMap = {\r\n            String: 'string',\r\n            Boolean: 'boolean',\r\n            Number: 'number',\r\n            Date: 'date'\r\n          };\r\n\r\n          ports.push({\r\n            type: {\r\n              name: _typeMap[p.type] ? _typeMap[p.type] : '*'\r\n            },\r\n            plug: 'output',\r\n            group: 'Properties',\r\n            name: 'prop-' + key,\r\n            displayName: key\r\n          });\r\n\r\n          ports.push({\r\n            type: 'signal',\r\n            plug: 'output',\r\n            group: 'Changed Events',\r\n            displayName: key + ' Changed',\r\n            name: 'changed-' + key\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  if (typeof _noodl_cloud_runtime_version === 'undefined') {\r\n    // On the client we have some extra outputs\r\n    ports.push({\r\n      plug: 'output',\r\n      name: 'loggedIn',\r\n      type: 'signal',\r\n      displayName: 'Logged In',\r\n      group: 'Events'\r\n    });\r\n\r\n    ports.push({\r\n      plug: 'output',\r\n      name: 'loggedOut',\r\n      type: 'signal',\r\n      displayName: 'Logged Out',\r\n      group: 'Events'\r\n    });\r\n\r\n    ports.push({\r\n      plug: 'output',\r\n      name: 'sessionLost',\r\n      type: 'signal',\r\n      displayName: 'Session Lost',\r\n      group: 'Events'\r\n    });\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nmodule.exports = {\r\n  node: UserNodeDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('systemCollections'));\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('systemCollections'));\r\n      });\r\n\r\n      graphModel.on('metadataChanged.systemCollections', function (data) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.net.noodl.user.User', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('net.noodl.user.User')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst VariableBase = require('./variablebase');\r\n\r\nconst BooleanNode = VariableBase.createDefinition({\r\n  name: 'Boolean',\r\n  docs: 'https://docs.noodl.net/nodes/data/boolean',\r\n  startValue: false,\r\n  type: {\r\n    name: 'boolean'\r\n  },\r\n  cast: function (value) {\r\n    return Boolean(value);\r\n  }\r\n});\r\n\r\nmodule.exports = {\r\n  node: BooleanNode\r\n};\r\n","'use strict';\r\n\r\nconst VariableBase = require('./variablebase');\r\n\r\nconst NumberNode = VariableBase.createDefinition({\r\n  name: 'Number',\r\n  docs: 'https://docs.noodl.net/nodes/data/number',\r\n  startValue: 0,\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'value'\r\n  },\r\n  type: {\r\n    name: 'number'\r\n  },\r\n  cast: function (value) {\r\n    return Number(value);\r\n  }\r\n});\r\n\r\nmodule.exports = {\r\n  node: NumberNode\r\n};\r\n","'use strict';\r\n\r\nconst VariableBase = require('./variablebase');\r\nconst { NodeDefinition } = require('../../../../noodl-runtime');\r\n\r\nconst StringNode = VariableBase.createDefinition({\r\n  name: 'String',\r\n  docs: 'https://docs.noodl.net/nodes/data/string',\r\n  shortDesc: 'Contains a string (text).',\r\n  startValue: '',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'value'\r\n  },\r\n  type: {\r\n    name: 'string'\r\n  },\r\n  cast: function (value) {\r\n    return String(value);\r\n  },\r\n  onChanged: function () {\r\n    this.flagOutputDirty('length');\r\n  }\r\n});\r\n\r\nNodeDefinition.extend(StringNode, {\r\n  usePortAsLabel: 'value',\r\n  portLabelTruncationMode: 'length',\r\n  outputs: {\r\n    length: {\r\n      type: 'number',\r\n      displayName: 'Length',\r\n      getter: function () {\r\n        return this._internal.currentValue.length;\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\nmodule.exports = {\r\n  node: StringNode\r\n};\r\n","'use strict';\r\n\r\nfunction createDefinition(args) {\r\n  return {\r\n    name: args.name,\r\n    docs: args.docs,\r\n    shortDesc: args.shortDesc,\r\n    nodeDoubleClickAction: args.nodeDoubleClickAction,\r\n    category: 'Variables',\r\n    initialize: function () {\r\n      this._internal.currentValue = args.startValue;\r\n      this._internal.latestValue = 0;\r\n    },\r\n    getInspectInfo() {\r\n      const type = args.type.name === 'color' ? 'color' : 'text';\r\n      return [{ type, value: this._internal.currentValue }];\r\n    },\r\n    inputs: {\r\n      value: {\r\n        type: args.type,\r\n        displayName: 'Value',\r\n        default: args.startValue,\r\n        set: function (value) {\r\n          if (this.isInputConnected('saveValue') === false) {\r\n            this.setValueTo(value);\r\n          } else {\r\n            this._internal.latestValue = value;\r\n          }\r\n        }\r\n      },\r\n      saveValue: {\r\n        displayName: 'Set',\r\n        valueChangedToTrue: function () {\r\n          this.scheduleAfterInputsHaveUpdated(function () {\r\n            this.setValueTo(this._internal.latestValue);\r\n            this.sendSignalOnOutput('stored');\r\n          });\r\n        }\r\n      }\r\n    },\r\n    outputs: {\r\n      savedValue: {\r\n        type: args.type.name,\r\n        displayName: 'Value',\r\n        getter: function () {\r\n          return this._internal.currentValue;\r\n        }\r\n      },\r\n      changed: {\r\n        type: 'signal',\r\n        displayName: 'Changed'\r\n      },\r\n      stored: {\r\n        type: 'signal',\r\n        displayName: 'Stored'\r\n      }\r\n    },\r\n    prototypeExtensions: {\r\n      setValueTo: function (value) {\r\n        value = args.cast(value);\r\n        const changed = this._internal.currentValue !== value;\r\n        this._internal.currentValue = value;\r\n\r\n        if (changed) {\r\n          this.flagOutputDirty('savedValue');\r\n          this.sendSignalOnOutput('changed');\r\n          args.onChanged && args.onChanged.call(this);\r\n        }\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nmodule.exports = {\r\n  createDefinition: createDefinition\r\n};\r\n","'use strict';\r\n\r\nconst guid = require('./guid');\r\n\r\nfunction NodeScope(context, componentOwner) {\r\n  this.context = context;\r\n  this.nodes = {};\r\n  this.componentOwner = componentOwner; //Component Instance that owns this NodeScope\r\n  this.componentInstanceChildren = {};\r\n}\r\n\r\nfunction verifyData(data, requiredKeys) {\r\n  requiredKeys.forEach(function (key) {\r\n    if (!data[key]) {\r\n      throw new Error('Missing ' + key);\r\n    }\r\n  });\r\n}\r\n\r\nNodeScope.prototype.addConnection = function (connectionData) {\r\n  try {\r\n    verifyData(connectionData, ['sourceId', 'sourcePort', 'targetId', 'targetPort']);\r\n  } catch (e) {\r\n    throw new Error('Error in connection: ' + e.message);\r\n  }\r\n\r\n  try {\r\n    var sourceNode = this.getNodeWithId(connectionData.sourceId),\r\n      targetNode = this.getNodeWithId(connectionData.targetId);\r\n\r\n    targetNode.registerInputIfNeeded(connectionData.targetPort);\r\n    sourceNode.registerOutputIfNeeded(connectionData.sourcePort);\r\n    targetNode.connectInput(connectionData.targetPort, sourceNode, connectionData.sourcePort);\r\n  } catch (e) {\r\n    console.error(e.message);\r\n  }\r\n};\r\n\r\nNodeScope.prototype.setNodeParameters = function (node, nodeModel) {\r\n  const variant = this.context.variants.getVariant(nodeModel.type, nodeModel.variant);\r\n\r\n  if (variant) {\r\n    //apply the variant (this will also apply the parameters)\r\n    node.setVariant(variant);\r\n  } else {\r\n    const parameters = nodeModel.parameters;\r\n\r\n    var inputNames = Object.keys(parameters);\r\n\r\n    if (this.context.nodeRegister.hasNode(node.name)) {\r\n      var metadata = this.context.nodeRegister.getNodeMetadata(node.name);\r\n      inputNames.sort(function (a, b) {\r\n        var inputA = metadata.inputs[a];\r\n        var inputB = metadata.inputs[b];\r\n        return (inputB ? inputB.inputPriority : 0) - (inputA ? inputA.inputPriority : 0);\r\n      });\r\n    }\r\n\r\n    inputNames.forEach((inputName) => {\r\n      node.registerInputIfNeeded(inputName);\r\n\r\n      //protect against obsolete parameters\r\n      if (node.hasInput(inputName) === false) {\r\n        return;\r\n      }\r\n\r\n      node.queueInput(inputName, parameters[inputName]);\r\n    });\r\n  }\r\n};\r\n\r\nNodeScope.prototype.createNodeFromModel = async function (nodeModel, updateOnDirtyFlagging) {\r\n  if (nodeModel.type === 'Component Children') {\r\n    if (nodeModel.parent) {\r\n      var parentInstance = this.getNodeWithId(nodeModel.parent.id);\r\n      this.componentOwner.setChildRoot(parentInstance);\r\n    }\r\n    return;\r\n  }\r\n\r\n  var node;\r\n  try {\r\n    node = await this.createNode(nodeModel.type, nodeModel.id);\r\n    node.updateOnDirtyFlagging = updateOnDirtyFlagging === false ? false : true;\r\n    node.setNodeModel(nodeModel);\r\n  } catch (e) {\r\n    console.error(e.message);\r\n    if (this.context.editorConnection && this.context.isWarningTypeEnabled('nodescope')) {\r\n      this.context.editorConnection.sendWarning(this.componentOwner.name, nodeModel.id, 'nodelibrary-unknown-node', {\r\n        message: e.message,\r\n        showGlobally: true\r\n      });\r\n    }\r\n    return;\r\n  }\r\n\r\n  if (nodeModel.variant && node.setVariant) node.setVariant(nodeModel.variant);\r\n  this.setNodeParameters(node, nodeModel);\r\n\r\n  if (nodeModel.parent) {\r\n    this.insertNodeInTree(node, nodeModel);\r\n  }\r\n\r\n  return node;\r\n};\r\n\r\nNodeScope.prototype.insertNodeInTree = function (nodeInstance, nodeModel) {\r\n  var parentInstance = this.getNodeWithId(nodeModel.parent.id);\r\n  var childIndex = nodeModel.parent.children.indexOf(nodeModel);\r\n\r\n  if (!parentInstance.addChild) {\r\n    throw new Error(\r\n      'Node ' + parentInstance.id + ' of type ' + parentInstance.constructor.name + \" can't have children\"\r\n    );\r\n  }\r\n\r\n  parentInstance.addChild(nodeInstance, childIndex);\r\n};\r\n\r\nNodeScope.prototype.getNodeWithId = function (id) {\r\n  if (this.nodes.hasOwnProperty(id) === false) {\r\n    throw new Error('Unknown node id ' + id);\r\n  }\r\n  return this.nodes[id];\r\n};\r\n\r\nNodeScope.prototype.hasNodeWithId = function (id) {\r\n  return this.nodes.hasOwnProperty(id);\r\n};\r\n\r\nNodeScope.prototype.createPrimitiveNode = function (name, id, extraProps) {\r\n  if (!id) id = guid();\r\n\r\n  if (this.nodes.hasOwnProperty(id)) {\r\n    throw Error('duplicate id ' + id);\r\n  }\r\n\r\n  const node = this.context.nodeRegister.createNode(name, id, this);\r\n  if (extraProps) {\r\n    for (const prop in extraProps) {\r\n      node[prop] = extraProps[prop];\r\n    }\r\n  }\r\n\r\n  this.nodes[id] = node;\r\n  return node;\r\n};\r\n\r\nNodeScope.prototype.createNode = async function (name, id, extraProps) {\r\n  if (!id) id = guid();\r\n\r\n  if (this.nodes.hasOwnProperty(id)) {\r\n    throw Error('duplicate id ' + id);\r\n  }\r\n\r\n  let node;\r\n\r\n  if (this.context.nodeRegister.hasNode(name)) {\r\n    node = this.context.nodeRegister.createNode(name, id, this);\r\n    if (extraProps) {\r\n      for (const prop in extraProps) {\r\n        node[prop] = extraProps[prop];\r\n      }\r\n    }\r\n  } else {\r\n    node = await this.context.createComponentInstanceNode(name, id, this, extraProps);\r\n    this.componentInstanceChildren[id] = node;\r\n  }\r\n\r\n  this.nodes[id] = node;\r\n  return node;\r\n};\r\n\r\nNodeScope.prototype.getNodesWithIdRecursive = function (id) {\r\n  var ComponentInstanceNode = require('./nodes/componentinstance');\r\n\r\n  function findNodesWithIdRec(scope, id, result) {\r\n    if (scope.nodes.hasOwnProperty(id)) {\r\n      result.push(scope.nodes[id]);\r\n    }\r\n\r\n    var componentIds = Object.keys(scope.nodes).filter(function (nodeId) {\r\n      return scope.nodes[nodeId] instanceof ComponentInstanceNode;\r\n    });\r\n\r\n    componentIds.forEach(function (componentId) {\r\n      findNodesWithIdRec(scope.nodes[componentId].nodeScope, id, result);\r\n    });\r\n  }\r\n\r\n  var result = [];\r\n  findNodesWithIdRec(this, id, result);\r\n  return result;\r\n};\r\n\r\nNodeScope.prototype.getNodesWithType = function (name) {\r\n  var self = this;\r\n  var ids = Object.keys(this.nodes).filter(function (id) {\r\n    return self.nodes[id].name === name;\r\n  });\r\n  return ids.map(function (id) {\r\n    return self.nodes[id];\r\n  });\r\n};\r\n\r\nNodeScope.prototype.getNodesWithTypeRecursive = function (name) {\r\n  var ComponentInstanceNode = require('./nodes/componentinstance');\r\n\r\n  var self = this;\r\n  function findNodesWithTypeRec() {\r\n    result = result.concat(self.getNodesWithType(name));\r\n\r\n    var componentIds = Object.keys(self.nodes).filter(function (nodeId) {\r\n      return self.nodes[nodeId] instanceof ComponentInstanceNode;\r\n    });\r\n\r\n    componentIds.forEach(function (componentId) {\r\n      var res = self.nodes[componentId].nodeScope.getNodesWithTypeRecursive(name);\r\n      result = result.concat(res);\r\n    });\r\n  }\r\n\r\n  var result = [];\r\n  findNodesWithTypeRec(result);\r\n  return result;\r\n};\r\n\r\nNodeScope.prototype.getAllNodesRecursive = function () {\r\n  var ComponentInstanceNode = require('./nodes/componentinstance');\r\n\r\n  let result = [];\r\n\r\n  const getAllNodesRec = () => {\r\n    result = result.concat(Object.values(this.nodes));\r\n\r\n    var componentIds = Object.keys(this.nodes).filter((nodeId) => {\r\n      return this.nodes[nodeId] instanceof ComponentInstanceNode;\r\n    });\r\n\r\n    componentIds.forEach((componentId) => {\r\n      var res = this.nodes[componentId].nodeScope.getAllNodesRecursive();\r\n      result = result.concat(res);\r\n    });\r\n  };\r\n\r\n  getAllNodesRec(result);\r\n  return result;\r\n};\r\n\r\nNodeScope.prototype.getAllNodesWithVariantRecursive = function (variant) {\r\n  const nodes = this.getAllNodesRecursive();\r\n  return nodes.filter((node) => node.variant === variant);\r\n};\r\n\r\nNodeScope.prototype.onNodeModelRemoved = function (nodeModel) {\r\n  var nodeInstance = this.getNodeWithId(nodeModel.id);\r\n\r\n  if (nodeModel.parent) {\r\n    var parentInstance = this.getNodeWithId(nodeModel.parent.id);\r\n    parentInstance.removeChild(nodeInstance);\r\n  }\r\n\r\n  nodeInstance._onNodeDeleted();\r\n  delete this.nodes[nodeInstance.id];\r\n  delete this.componentInstanceChildren[nodeInstance.id];\r\n};\r\n\r\nNodeScope.prototype.removeConnection = function (connectionModel) {\r\n  var targetNode = this.getNodeWithId(connectionModel.targetId);\r\n  targetNode.removeInputConnection(connectionModel.targetPort, connectionModel.sourceId, connectionModel.sourcePort);\r\n};\r\n\r\nNodeScope.prototype.setComponentModel = async function (componentModel) {\r\n  this.componentModel = componentModel;\r\n\r\n  const nodes = [];\r\n\r\n  //create all nodes\r\n  for (const nodeModel of componentModel.getAllNodes()) {\r\n    const node = await this.createNodeFromModel(nodeModel, false);\r\n    if (node) nodes.push(node);\r\n  }\r\n\r\n  componentModel.getAllConnections().forEach((conn) => this.addConnection(conn));\r\n\r\n  //now that all nodes and connections are setup, trigger the dirty flagging so nodes can run with all the connections in place\r\n  nodes.forEach((node) => (node.updateOnDirtyFlagging = true));\r\n\r\n  nodes.forEach((node) => {\r\n    if (node._dirty) {\r\n      node._performDirtyUpdate();\r\n    }\r\n  });\r\n\r\n  componentModel.on('connectionAdded', (conn) => this.addConnection(conn), this);\r\n  componentModel.on('connectionRemoved', this.removeConnection, this);\r\n  componentModel.on('nodeAdded', this.createNodeFromModel, this);\r\n\r\n  var self = this;\r\n  componentModel.on(\r\n    'nodeParentWillBeRemoved',\r\n    function (nodeModel) {\r\n      if (nodeModel.type === 'Component Children') {\r\n        if (nodeModel.parent) {\r\n          this.componentOwner.setChildRoot(null);\r\n        }\r\n        return;\r\n      }\r\n\r\n      const nodeInstance = self.getNodeWithId(nodeModel.id);\r\n      if (nodeInstance.parent) {\r\n        nodeInstance.parent.removeChild(nodeInstance);\r\n      }\r\n    },\r\n    this\r\n  );\r\n\r\n  componentModel.on(\r\n    'nodeParentUpdated',\r\n    function (nodeModel) {\r\n      if (nodeModel.type === 'Component Children') {\r\n        var parentInstance = this.getNodeWithId(nodeModel.parent.id);\r\n        this.componentOwner.setChildRoot(parentInstance);\r\n      } else {\r\n        var nodeInstance = self.getNodeWithId(nodeModel.id);\r\n        self.insertNodeInTree(nodeInstance, nodeModel);\r\n      }\r\n    },\r\n    this\r\n  );\r\n\r\n  componentModel.on(\r\n    'nodeRemoved',\r\n    function (nodeModel) {\r\n      if (nodeModel.type !== 'Component Children') {\r\n        self.onNodeModelRemoved(nodeModel);\r\n      }\r\n    },\r\n    this\r\n  );\r\n\r\n  for (const id in this.nodes) {\r\n    const node = this.nodes[id];\r\n    node.nodeScopeDidInitialize && node.nodeScopeDidInitialize();\r\n  }\r\n};\r\n\r\nNodeScope.prototype.reset = function () {\r\n  if (this.componentModel) {\r\n    this.componentModel.removeListenersWithRef(this);\r\n    this.componentModel = undefined;\r\n  }\r\n\r\n  Object.keys(this.nodes).forEach((id) => {\r\n    if (this.nodes.hasOwnProperty(id)) {\r\n      this.deleteNode(this.nodes[id]);\r\n    }\r\n  });\r\n};\r\n\r\nNodeScope.prototype.deleteNode = function (nodeInstance) {\r\n  if (this.nodes.hasOwnProperty(nodeInstance.id) === false) {\r\n    console.error(\"Node doesn't belong to this scope\", nodeInstance.id, nodeInstance.name);\r\n    return;\r\n  }\r\n\r\n  if (nodeInstance.parent) {\r\n    nodeInstance.parent.removeChild(nodeInstance);\r\n  }\r\n\r\n  //depth first\r\n  if (nodeInstance.getChildren) {\r\n    nodeInstance.getChildren().forEach((child) => {\r\n      nodeInstance.removeChild(child);\r\n      //the child might be created in a different scope\r\n      //if the child is a component instance, we want its parent scope, not the inner scope\r\n      const nodeScope = child.parentNodeScope || child.nodeScope;\r\n      nodeScope.deleteNode(child);\r\n    });\r\n  }\r\n\r\n  if (this.componentModel) {\r\n    const connectionFrom = this.componentModel.getConnectionsFrom(nodeInstance.id);\r\n    const connectionTo = this.componentModel.getConnectionsTo(nodeInstance.id);\r\n\r\n    connectionFrom.concat(connectionTo).forEach((connection) => {\r\n      if (this.nodes.hasOwnProperty(connection.targetId) && this.nodes.hasOwnProperty(connection.sourceId)) {\r\n        this.removeConnection(connection);\r\n      }\r\n    });\r\n  }\r\n\r\n  nodeInstance._onNodeDeleted();\r\n  delete this.nodes[nodeInstance.id];\r\n  delete this.componentInstanceChildren[nodeInstance.id]; //in case this is a component\r\n};\r\n\r\nNodeScope.prototype.sendEventFromThisScope = function (eventName, data, propagation, sendEventInThisScope, _exclude) {\r\n  if (sendEventInThisScope) {\r\n    var eventReceivers = this.getNodesWithType('Event Receiver').filter(function (eventReceiver) {\r\n      return eventReceiver.getChannelName() === eventName;\r\n    });\r\n\r\n    for (var i = 0; i < eventReceivers.length; i++) {\r\n      var consumed = eventReceivers[i].handleEvent(data);\r\n      if (consumed) return true;\r\n    }\r\n  }\r\n\r\n  if (propagation === 'parent' && this.componentOwner.parentNodeScope) {\r\n    // Send event to parent scope\r\n    //either the scope of the visual parent if there is one, otherwise the parent component\r\n    const parentNodeScope = this.componentOwner.parent\r\n      ? this.componentOwner.parent.nodeScope\r\n      : this.componentOwner.parentNodeScope;\r\n    if (!parentNodeScope) return;\r\n    parentNodeScope.sendEventFromThisScope(eventName, data, propagation, true);\r\n  } else if (propagation === 'children') {\r\n    // Send event to all child scopes\r\n    var nodes = this.nodes;\r\n    for (var nodeId in nodes) {\r\n      var children = nodes[nodeId].children;\r\n      if (children)\r\n        children.forEach((child) => {\r\n          if (child.name && this.context.hasComponentModelWithName(child.name)) {\r\n            // This is a component instance child\r\n            var consumed = child.nodeScope.sendEventFromThisScope(eventName, data, propagation, true);\r\n            if (consumed) return true;\r\n          }\r\n        });\r\n    }\r\n  } else if (propagation === 'siblings') {\r\n    // Send event to all siblings, that is all children of the parent scope except this scope\r\n    let parentNodeScope;\r\n    if (this.componentOwner.parent) {\r\n      parentNodeScope = this.componentOwner.parent.nodeScope;\r\n    } else {\r\n      parentNodeScope = this.componentOwner.parentNodeScope;\r\n    }\r\n\r\n    if (!parentNodeScope) return;\r\n\r\n    var nodes = parentNodeScope.nodes;\r\n    for (var nodeId in nodes) {\r\n      var children = nodes[nodeId].children;\r\n      if (children) {\r\n        var _c = children.filter(\r\n          (child) => child.name && this.context.hasComponentModelWithName(child.name) && child.nodeScope !== this\r\n        );\r\n        _c.forEach((child) => {\r\n          var consumed = child.nodeScope.sendEventFromThisScope(eventName, data, null, true);\r\n          if (consumed) return true;\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nmodule.exports = NodeScope;\r\n","\"use strict\";\r\n\r\n/**\r\n * @class OutputProperty\r\n *\r\n * @param args Arguments\r\n * @param {Function} args.getter Function that returns the value\r\n * @param {Node} args.owner Port owner\r\n * @param {string} args.type Output value type\r\n * @constructor\r\n */\r\nfunction OutputProperty(args) {\r\n\r\n    if(!args.owner) {\r\n        throw new Error(\"Owner must be set\");\r\n    }\r\n    this.getter = args.getter;\r\n    this.connections = [];\r\n    this.owner = args.owner;\r\n    this.name = args.name;\r\n    this.onFirstConnectionAdded = args.onFirstConnectionAdded;\r\n    this.onLastConnectionRemoved = args.onLastConnectionRemoved;\r\n\r\n    this._id = undefined;\r\n}\r\n\r\nObject.defineProperties(OutputProperty.prototype, {\r\n    /**\r\n     * Gets the current value\r\n     * @name OutputProperty#value\r\n     * @readonly\r\n     */\r\n    value: {\r\n        get: function() {\r\n            return this.getter.call(this.owner);\r\n        }\r\n    },\r\n\r\n    id: {\r\n        get: function() {\r\n            if(!this._id) {\r\n                this._id = this.owner.id + this.name;\r\n            }\r\n            return this._id;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Registers a connection to propagate dirtiness\r\n     * Also records which input port it's connected to so nodes like\r\n     * Animation can set it's implicit start value\r\n     * @name OutputProperty#registerConnection\r\n     * @readonly\r\n     */\r\n    registerConnection: {\r\n        value: function(node, inputPortName) {\r\n            this.connections.push({\r\n                node: node,\r\n                inputPortName: inputPortName\r\n            });\r\n\r\n            if(this.connections.length === 1 && this.onFirstConnectionAdded) {\r\n                this.onFirstConnectionAdded.call(this.owner);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Deregisters a connection to a specific input port\r\n     * @name OutputProperty#deregisterConnection\r\n     * @readonly\r\n     */\r\n    deregisterConnection: {\r\n        value: function(node, inputPortName) {\r\n            for(var i=0; i<this.connections.length; i++) {\r\n                var connection = this.connections[i];\r\n                if(connection.node === node && connection.inputPortName === inputPortName) {\r\n                    this.connections.splice(i,1);\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if(this.connections.length === 0 && this.onLastConnectionRemoved) {\r\n                this.onLastConnectionRemoved.call(this.owner);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets dirty flag of all nodes that depend on this output port\r\n     * @name OutputProperty#flagDependeesDirty\r\n     * @readonly\r\n     */\r\n    flagDependeesDirty: {\r\n        value: function(value) {\r\n            for(var i= 0, len=this.connections.length; i<len; i++) {\r\n                this.connections[i].node.flagDirty();\r\n            }\r\n        }\r\n    },\r\n    sendValue: {\r\n        value: function(value) {\r\n            if(this._lastUpdateIteration !== this.owner._updatedAtIteration) {\r\n                this._lastUpdateIteration = this.owner._updatedAtIteration;\r\n                this.valuesSendThisIteration = 0;\r\n            }\r\n            else {\r\n                this.valuesSendThisIteration++;\r\n            }\r\n\r\n            if(this.valuesSendThisIteration > 500) {\r\n                //this will make the owner send a warning and stop its update\r\n                this.owner._cyclicLoop = true;\r\n            }\r\n\r\n            for(var i= 0, len=this.connections.length; i<len; i++) {\r\n                var connection = this.connections[i];\r\n                connection.node._setValueFromConnection(connection.inputPortName, value);\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * @name OutputProperty#hasConnections\r\n     * @readonly\r\n     */\r\n    hasConnections: {\r\n        value: function() {\r\n            return this.connections.length > 0;\r\n        }\r\n    }\r\n});\r\nmodule.exports = OutputProperty;","\"use strict\";\r\n\r\nfunction addModuleSettings(result, modules) {\r\n    // Add module settings\r\n    for(var i = 0; i < modules.length; i++) {\r\n        var m = modules[i];\r\n        if(m.settings) {\r\n            m.settings.forEach(function(p) {\r\n                result.ports.push(p);\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\nfunction generateProjectSettings(projectSettings, modules) {\r\n    const result = {\r\n        dynamicports: [],\r\n        ports: []\r\n    };\r\n\r\n    addModuleSettings(result, modules);\r\n\r\n    return result;\r\n}\r\n\r\nmodule.exports = {\r\n    generateProjectSettings: generateProjectSettings\r\n};","var EventEmitter = require('../events');\r\n\r\nfunction Services() {\r\n}\r\n\r\nServices.events = new EventEmitter();\r\n\r\nmodule.exports = Services;","'use strict';\r\n\r\nfunction Timer(scheduler, args) {\r\n    this.duration = args.duration || 0;\r\n    this._isRunning = false;\r\n    this._hasCalledOnStart = false;\r\n    this.scheduler = scheduler;\r\n    this.repeatCount = 1;\r\n    this.delay = 0;\r\n\r\n    for(var arg in args) {\r\n        this[arg] = args[arg];\r\n    }\r\n}\r\n\r\nTimer.prototype.start = function() {\r\n    if(this._isRunning) {\r\n        this.stop();\r\n    }\r\n\r\n    this.scheduler.scheduleTimer(this);\r\n    return this;\r\n};\r\n\r\nTimer.prototype.stop = function() {\r\n    this.scheduler.stopTimer(this);\r\n    this._hasCalledOnStart = false;\r\n    this._isRunning = false;\r\n    this._wasStopped = true;    // This is used to avoid calling onFinish\r\n};\r\n\r\nTimer.prototype.isRunning = function() {\r\n    return this._isRunning;\r\n};\r\n\r\nTimer.prototype.durationLeft = function() {\r\n    return this._durationLeft;\r\n};\r\n\r\nfunction TimerScheduler(requestFrameCallback) {\r\n    this.requestFrame = requestFrameCallback;\r\n    this.runningTimers = [];\r\n    this.newTimers = [];\r\n}\r\n\r\nTimerScheduler.prototype.createTimer = function(args) {\r\n    return new Timer(this, args);\r\n};\r\n\r\nTimerScheduler.prototype.scheduleTimer = function(timer) {\r\n    if(this.newTimers.indexOf(timer) === -1) {\r\n        if(timer.repeatCount === 0) {\r\n            timer.repeatCount = 100000;\r\n        }\r\n\r\n        this.newTimers.push(timer);\r\n        this.requestFrame();\r\n    }\r\n};\r\n\r\nTimerScheduler.prototype.stopTimer = function(timer) {\r\n    var index;\r\n\r\n    if(timer._isRunning) {\r\n        index = this.runningTimers.indexOf(timer);\r\n        if(index !== -1) {\r\n            this.runningTimers.splice(index, 1);\r\n        }\r\n\r\n        if (timer.onStop && !timer._wasStopped) {\r\n            timer.onStop();\r\n        }\r\n    }\r\n    else {\r\n        index = this.newTimers.indexOf(timer);\r\n        if(index !== -1) {\r\n            this.newTimers.splice(index, 1);\r\n        }\r\n    }\r\n};\r\n\r\nTimerScheduler.prototype.runTimers = function(currentTime) {\r\n\r\n    var remainingTimers = [],\r\n        finishedTimers = [],\r\n        timersThisFrame = [];\r\n\r\n    var i,\r\n        len = this.runningTimers.length,\r\n        timer;\r\n\r\n    //copy timer list in case timers are added or removed during onStart or onRunning\r\n    for(i=0; i<len; ++i) {\r\n        timersThisFrame[i] = this.runningTimers[i];\r\n    }\r\n\r\n    for(i=0; i<len; ++i) {\r\n        timer = timersThisFrame[i];\r\n        if(timer && currentTime >= timer._start) {\r\n\r\n            if(timer._hasCalledOnStart === false && timer.onStart) {\r\n                timer.onStart();\r\n                timer._hasCalledOnStart = true;\r\n            }\r\n\r\n            var t;\r\n            if(timer.duration > 0) {\r\n                t = (currentTime - timer._start)/(timer.duration*timer.repeatCount);\r\n            } else {\r\n                t = 1.0;\r\n            }\r\n\r\n            timer._durationLeft = timer.duration * (1-t);\r\n\r\n            var localT = t*timer.repeatCount - Math.floor(t*timer.repeatCount);\r\n            if(t >= 1.0) {\r\n                localT = 1.0;\r\n            }\r\n\r\n            if(timer.onRunning) {\r\n                timer.onRunning(localT);\r\n            }\r\n\r\n            if(t < 1.0 && timer._isRunning) {\r\n                remainingTimers.push(timer);\r\n            }\r\n            else if (!timer._wasStopped) {\r\n                finishedTimers.push(timer);\r\n            }\r\n        } else {\r\n            remainingTimers.push(timer);\r\n        }\r\n    }\r\n\r\n    this.runningTimers = remainingTimers;\r\n\r\n    for(i=0; i<finishedTimers.length; ++i) {\r\n        finishedTimers[i]._isRunning = false;\r\n        finishedTimers[i]._hasCalledOnStart = false;\r\n        if( finishedTimers[i].onFinish ) {\r\n            finishedTimers[i].onFinish();\r\n        }\r\n    }\r\n\r\n    //add newly queued timers\r\n    if(this.newTimers.length > 0) {\r\n        for(i=0; i<this.newTimers.length; ++i) {\r\n            timer = this.newTimers[i];\r\n            timer._start = currentTime + timer.delay;\r\n            timer._isRunning = true;\r\n            timer._wasStopped = false;\r\n            this.runningTimers.push(timer);\r\n\r\n            if(timer.delay === 0) {\r\n                //play first timer frame directly to keep everything nicely synched\r\n                if(timer.onStart) {\r\n                    timer.onStart();\r\n                    timer._hasCalledOnStart = true;\r\n                }\r\n                if(timer.onRunning) {\r\n                    timer.onRunning(0);\r\n                }\r\n            }\r\n        }\r\n        this.newTimers.length = 0;\r\n    }\r\n};\r\n\r\nTimerScheduler.prototype.hasPendingTimers = function() {\r\n    return this.runningTimers.length > 0 || this.newTimers.length > 0;\r\n};\r\n\r\nmodule.exports = TimerScheduler;\r\n","//this just assumes the base url is '/' always\r\nfunction getAbsoluteUrl(_url) {\r\n\r\n  //convert to string in case the _url is a Cloud File (which is an object with a custom toString())\r\n  const url = String(_url);\r\n\r\n  //only add a the base url if this is a local URL (e.g. not a https url or  base64 string)\r\n  if (!url || url[0] === \"/\" || url.includes(\"://\") || url.startsWith('data:')) {\r\n    return url;\r\n  }\r\n\r\n  return (Noodl.baseUrl || '/') + url;\r\n}\r\n\r\n/**\r\n * Log an error thrown by the JavaScript nodes.\r\n *\r\n * @param {any} error \r\n */\r\nfunction logJavaScriptNodeError(error) {\r\n  if (typeof error === 'string') {\r\n    console.log('Error in JS node run code.', error);\r\n  } else {\r\n    console.log(\r\n      'Error in JS node run code.',\r\n      Object.getPrototypeOf(error).constructor.name + ': ' + error.message,\r\n      error.stack\r\n    );\r\n  }\r\n}\r\n\r\nmodule.exports = {\r\n  getAbsoluteUrl,\r\n  logJavaScriptNodeError\r\n};\r\n","class Variants {\r\n\r\n    constructor({graphModel, getNodeScope}) {\r\n        this.getNodeScope = getNodeScope;\r\n\r\n        if(graphModel) {\r\n            this.graphModel = graphModel;\r\n            graphModel.on('variantUpdated', variant => this.onVariantUpdated(variant));\r\n        }\r\n    }\r\n\r\n    getVariant(typename, name) {\r\n        if(!this.graphModel) return undefined;\r\n        \r\n        return this.graphModel.getVariant(typename, name);\r\n    }\r\n\r\n    onVariantUpdated(variant) {\r\n        const nodeScope = this.getNodeScope();\r\n        if(!nodeScope) return;\r\n\r\n        //get all nodes with the type the variant applies to\r\n        const nodes = nodeScope.getNodesWithTypeRecursive(variant.typename);\r\n\r\n        //and filter for the ones using the updated variant\r\n        const nodesWithVariant = nodes.filter(node => {\r\n\r\n            //if a variant has been set during runtime, it'll override the value from the model\r\n            if(node.variant) return node.variant.name === variant.name;\r\n\r\n            //otherwise check the model (which always matches the editor)\r\n            return node.model && node.model.variant === variant.name;\r\n        });\r\n\r\n        //and re-apply the variant\r\n        for(const node of nodesWithVariant) {\r\n            node.setVariant(variant);\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = Variants;","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","const NoodlRuntime = require('@noodl/runtime');\r\n\r\nfunction _makeRequest(path, options) {\r\n  var xhr = new XMLHttpRequest();\r\n\r\n  xhr.onreadystatechange = function () {\r\n    if (xhr.readyState === 4) {\r\n      var json;\r\n      try {\r\n        json = JSON.parse(xhr.response);\r\n      } catch (e) {}\r\n\r\n      if (xhr.status === 200 || xhr.status === 201) {\r\n        options.success(json);\r\n      } else options.error(json);\r\n    }\r\n  };\r\n\r\n  xhr.open(options.method || 'GET', options.endpoint + path, true);\r\n\r\n  xhr.setRequestHeader('X-Parse-Application-Id', options.appId);\r\n  xhr.setRequestHeader('Content-Type', 'application/json');\r\n\r\n  const cloudServices = NoodlRuntime.instance.getMetaData('cloudservices');\r\n  if (cloudServices && cloudServices.deployVersion) {\r\n    xhr.setRequestHeader('x-noodl-cloud-version', cloudServices.deployVersion);\r\n  }\r\n\r\n  // Check for current users\r\n  var _cu = localStorage['Parse/' + options.appId + '/currentUser'];\r\n  if (_cu !== undefined) {\r\n    try {\r\n      const currentUser = JSON.parse(_cu);\r\n      xhr.setRequestHeader('X-Parse-Session-Token', currentUser.sessionToken);\r\n    } catch (e) {\r\n      // Failed to extract session token\r\n    }\r\n  }\r\n\r\n  xhr.send(JSON.stringify(options.content));\r\n}\r\n\r\nconst cloudfunctions = {\r\n  async run(functionName, params) {\r\n    return new Promise((resolve, reject) => {\r\n      const cloudServices = NoodlRuntime.instance.getMetaData('cloudservices');\r\n      if (cloudServices === undefined) {\r\n        reject('No cloud services defined in this project.');\r\n        return;\r\n      }\r\n\r\n      const appId = cloudServices.appId;\r\n      const endpoint = NoodlRuntime.instance.editorConnection.isRunningLocally()\r\n        ? `http://${window.location.hostname}:8577`\r\n        : cloudServices.endpoint;\r\n\r\n      _makeRequest('/functions/' + encodeURIComponent(functionName), {\r\n        appId,\r\n        endpoint,\r\n        content: params,\r\n        method: 'POST',\r\n        success: (res) => {\r\n          resolve(res ? res.result : undefined);\r\n        },\r\n        error: (err) => {\r\n          reject(err);\r\n        }\r\n      });\r\n    });\r\n  }\r\n};\r\n\r\nmodule.exports = cloudfunctions;\r\n","const CloudStore = require(\"@noodl/runtime/src/api/cloudstore\");\r\nconst CloudFile = require(\"@noodl/runtime/src/api/cloudfile\");\r\n\r\nconst files = {\r\n  async upload(file, options) {\r\n    return new Promise((resolve, reject) => {\r\n      CloudStore.instance.uploadFile({\r\n        file,\r\n        onUploadProgress: (p) => {\r\n          options && options.onProgress && options.onProgress(p);\r\n        },\r\n        success: (response) => {\r\n          resolve(new CloudFile(response));\r\n        },\r\n        error: (e) => {\r\n          reject(e);\r\n        },\r\n      });\r\n    });\r\n  },\r\n};\r\n\r\nmodule.exports = files;\r\n","const { RouterHandler } = require('../nodes/navigation/router-handler');\r\nconst NoodlRuntime = require('@noodl/runtime');\r\n\r\nconst navigation = {\r\n  /**\r\n   * This is set by \"packages/noodl-viewer-react/src/noodl-js-api.js\"\r\n   * @type {NoodlRuntime}\r\n   */\r\n  _noodlRuntime: undefined,\r\n\r\n  async showPopup(componentPath, params) {\r\n    return new Promise((resolve) => {\r\n      navigation._noodlRuntime.context.showPopup(componentPath, params, {\r\n        onClosePopup: (action, results) => {\r\n          resolve({\r\n            action: action?.replace('closeAction-', ''),\r\n            parameters: results\r\n          });\r\n        }\r\n      });\r\n    });\r\n  },\r\n\r\n  navigate(routerName, targetPageName, params) {\r\n    RouterHandler.instance.navigate(routerName, {\r\n      target: targetPageName,\r\n      params: params\r\n    });\r\n  },\r\n\r\n  navigateToPath(path, options) {\r\n    let hashPath, urlPath;\r\n    var navigationPathType = NoodlRuntime.instance.getProjectSettings()['navigationPathType'];\r\n    if (navigationPathType === undefined || navigationPathType === 'hash') hashPath = path;\r\n    else urlPath = path;\r\n\r\n    var query = [];\r\n    if (options && options.query !== undefined) {\r\n      for (let key in options.query) {\r\n        query.push(key + '=' + options.query[key]);\r\n      }\r\n    }\r\n\r\n    var compiledUrl =\r\n      (urlPath !== undefined ? urlPath : '') +\r\n      (query.length >= 1 ? '?' + query.join('&') : '') +\r\n      (hashPath !== undefined ? '#' + hashPath : '');\r\n\r\n    window.history.pushState({}, '', compiledUrl);\r\n    dispatchEvent(new PopStateEvent('popstate', {}));\r\n  }\r\n};\r\n\r\nmodule.exports = navigation;\r\n","const UserService = require('../nodes/std-library/user/userservice')\r\n\r\nconst users = {\r\n    async logIn(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.logIn({\r\n                username:options.username,\r\n                password:options.password,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async signUp(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.signUp({\r\n                username:options.username,\r\n                password:options.password,\r\n                email:options.email,\r\n                properties:options.properties,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async become(sessionToken) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.fetchCurrentUser({\r\n                sessionToken,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    // Deprecated use cloud functions instead\r\n  /*  async requestPasswordReset(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.requestPasswordReset({\r\n                email:options.email,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async resetPassword(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.resetPassword({\r\n                token:options.token,\r\n                username:options.username,\r\n                newPassword:options.newPassword,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },   \r\n\r\n    async sendEmailVerification(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.sendEmailVerification({\r\n                email:options.email,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async verifyEmail(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.verifyEmail({\r\n                username:options.username,\r\n                token:options.token,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },*/\r\n\r\n    on(event,cb) {\r\n        UserService.instance.on(event,cb)\r\n    },\r\n\r\n    off(event,cb) {\r\n        UserService.instance.off(event,cb)\r\n    }, \r\n}\r\n\r\nconst _currentUser = {\r\n    async logOut() {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.logOut({\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async save() {\r\n        return new Promise((resolve,reject) => {\r\n            const props = Object.assign({},_currentUser.Properties.data)\r\n\r\n            UserService.instance.setUserProperties({\r\n                properties:props,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async fetch() {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.fetchCurrentUser({\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    }\r\n}\r\n\r\nObject.defineProperty(users, 'Current', { \r\n    get: function() { \r\n        const _user = UserService.instance.current; \r\n        if(_user === undefined) return; \r\n        else {\r\n            _currentUser.email = _user.email;\r\n            _currentUser.username = _user.username;\r\n            _currentUser.id = _user.id;\r\n            _currentUser.emailVerified = _user.emailVerified;\r\n            _currentUser.Properties = _user\r\n            return _currentUser\r\n        } \r\n    } \r\n});\r\n\r\nmodule.exports = users","module.exports = function patchedMomentum(current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\r\n  if (options === void 0) {\r\n    options = this.options;\r\n  }\r\n  var distance = current - start;\r\n  var speed = Math.abs(distance) / time;\r\n  var deceleration = options.deceleration,\r\n    swipeBounceTime = options.swipeBounceTime,\r\n    swipeTime = options.swipeTime;\r\n  var momentumData = {\r\n    destination: current + (speed / deceleration) * (distance < 0 ? -1 : 1),\r\n    duration: swipeTime,\r\n    rate: 15\r\n  };\r\n  this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\r\n  if (momentumData.destination < lowerMargin) {\r\n    momentumData.destination = wrapperSize\r\n      ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - (wrapperSize / momentumData.rate) * speed)\r\n      : lowerMargin;\r\n    momentumData.duration = Math.abs(momentumData.destination - current) / speed;\r\n  } else if (momentumData.destination > upperMargin) {\r\n    momentumData.destination = wrapperSize\r\n      ? Math.min(upperMargin + wrapperSize / 4, upperMargin + (wrapperSize / momentumData.rate) * speed)\r\n      : upperMargin;\r\n    // momentumData.duration = swipeBounceTime;\r\n    momentumData.duration = Math.abs(momentumData.destination - current) / speed;\r\n  }\r\n  momentumData.destination = Math.round(momentumData.destination);\r\n  return momentumData;\r\n};\r\n","'use strict';\r\n\r\nvar EaseCurves = {\r\n  easeOutQuartic: function (start, end, t) {\r\n    t--;\r\n    return -(end - start) * (t * t * t * t - 1.0) + start;\r\n  },\r\n  easeInQuartic: function (start, end, t) {\r\n    return (end - start) * (t * t * t * t) + start;\r\n  },\r\n  easeInOutQuartic: function (start, end, t) {\r\n    t *= 2.0;\r\n    if (t < 1.0) {\r\n      return ((end - start) / 2.0) * t * t * t * t + start;\r\n    }\r\n    t -= 2.0;\r\n    return (-(end - start) / 2.0) * (t * t * t * t - 2.0) + start;\r\n  },\r\n  easeOutCubic: function (start, end, t) {\r\n    t--;\r\n    return (end - start) * (t * t * t + 1.0) + start;\r\n  },\r\n  easeInCubic: function (start, end, t) {\r\n    return (end - start) * (t * t * t) + start;\r\n  },\r\n  easeInOutCubic: function (start, end, t) {\r\n    t *= 2.0;\r\n    if (t < 1.0) {\r\n      return ((end - start) / 2.0) * t * t * t + start;\r\n    }\r\n    t -= 2.0;\r\n    return ((end - start) / 2.0) * (t * t * t + 2.0) + start;\r\n  },\r\n  easeOutQuadratic: function (start, end, t) {\r\n    return -(end - start) * t * (t - 2.0) + start;\r\n  },\r\n  easeInQuadratic: function (start, end, t) {\r\n    return (end - start) * (t * t) + start;\r\n  },\r\n  easeInOutQuadratic: function (start, end, t) {\r\n    t *= 2.0;\r\n    if (t < 1.0) {\r\n      return ((end - start) / 2.0) * t * t + start;\r\n    }\r\n    t -= 1.0;\r\n    return (-(end - start) / 2.0) * (t * (t - 2) - 1.0) + start;\r\n  },\r\n  linear: function (start, end, t) {\r\n    return start + (end - start) * t;\r\n  }\r\n};\r\n\r\n//default interpolation curves\r\nEaseCurves.easeIn = EaseCurves.easeInCubic;\r\nEaseCurves.easeOut = EaseCurves.easeOutCubic;\r\nEaseCurves.easeInOut = EaseCurves.easeInOutCubic;\r\n\r\nmodule.exports = EaseCurves;\r\n","'use strict';\r\n\r\nconst { getAbsoluteUrl } = require('@noodl/runtime/src/utils');\r\n\r\nfunction FontLoader() {\r\n  this.loadedFontFamilies = {};\r\n  this.fontCssFamiliesAdded = {};\r\n  this.fontCallbacks = {};\r\n\r\n  var self = this;\r\n  ['Arial', 'Arial Black', 'Courier New', 'Helvetica', 'Impact', 'Lucida Console', 'Tahoma', 'Times New Roman'].forEach(\r\n    function (fontFamily) {\r\n      self.loadedFontFamilies[fontFamily] = true;\r\n    }\r\n  );\r\n}\r\n\r\nfunction removeFileEnding(url) {\r\n  return url.replace(/\\.[^/.]+$/, '');\r\n}\r\n\r\nFontLoader.prototype.loadFont = function (fontURL) {\r\n  // Support SSR\r\n  if (typeof document === 'undefined') return;\r\n\r\n  fontURL = getAbsoluteUrl(fontURL);\r\n\r\n  //get file name without path and file ending\r\n  var family = removeFileEnding(fontURL).split('/').pop();\r\n\r\n  //check if it's already loaded\r\n  if (this.loadedFontFamilies[family]) {\r\n    this.fontCallbacks[family] &&\r\n      this.fontCallbacks[family].forEach(function (callback) {\r\n        callback();\r\n      });\r\n    return;\r\n  }\r\n\r\n  //check if font is already being loaded, we're just waiting for the callback\r\n  if (this.fontCssFamiliesAdded[family]) {\r\n    return;\r\n  }\r\n\r\n  this.fontCssFamiliesAdded[family] = true;\r\n\r\n  var newStyle = document.createElement('style');\r\n  newStyle.type = 'text/css';\r\n\r\n  let baseUrl = Noodl.Env[\"BaseUrl\"] || '/';\r\n\r\n  if (fontURL.startsWith('/')) {\r\n    fontURL = fontURL.substring(1);\r\n  }\r\n\r\n  newStyle.appendChild(\r\n    document.createTextNode(\"@font-face { font-family: '\" + family + \"'; src: url('\" + baseUrl + fontURL + \"'); }\\n\")\r\n  );\r\n  document.head.appendChild(newStyle);\r\n\r\n  // Support SSR\r\n  if (typeof window !== 'undefined') {\r\n    var self = this;\r\n\r\n    const WebFontLoader = require('webfontloader');\r\n    WebFontLoader.load({\r\n      timeout: 1000 * 600, //10 minutes in case the bandwidth is reeeeeeally low\r\n      custom: {\r\n        families: [family]\r\n      },\r\n      fontactive: function (family) {\r\n        self.loadedFontFamilies[family] = true;\r\n        if (self.fontCallbacks[family]) {\r\n          self.fontCallbacks[family].forEach(function (callback) {\r\n            callback();\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n};\r\n\r\nFontLoader.prototype.callWhenFontIsActive = function (family, callback) {\r\n  if (this.loadedFontFamilies[family]) {\r\n    callback();\r\n    return;\r\n  }\r\n\r\n  if (!this.fontCallbacks[family]) {\r\n    this.fontCallbacks[family] = [];\r\n  }\r\n  this.fontCallbacks[family].push(callback);\r\n};\r\n\r\nFontLoader.instance = new FontLoader();\r\n\r\nmodule.exports = FontLoader;\r\n","//adapted from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\r\nfunction guid() {\r\n  function s4() {\r\n    return Math.floor((1 + Math.random()) * 0x10000)\r\n      .toString(16)\r\n      .substring(1);\r\n  }\r\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\r\n}\r\n\r\nmodule.exports = guid;\r\n","'use strict';\r\n\r\nconst EaseCurves = require('../../easecurves'),\r\n  BezierEasing = require('bezier-easing');\r\n\r\nfunction SubAnimation(args) {\r\n  this.name = args.name;\r\n  this.startValue = 0;\r\n  this.endValue = 0;\r\n  this.currentValue = undefined;\r\n  this.startMode = 'implicit';\r\n  this.ease = args.ease;\r\n  this.node = args.node;\r\n  this.hasSampledStartValue = false;\r\n\r\n  var self = this;\r\n\r\n  this.animation = args.node.context.timerScheduler.createTimer({\r\n    startValue: 0,\r\n    endValue: 0,\r\n    onRunning: function (t) {\r\n      var value = self.ease(this.startValue, this.endValue, t);\r\n      self.setCurrentValue(value);\r\n    }\r\n  });\r\n  this.animation.startValue = 0;\r\n  this.animation.endValue = 0;\r\n}\r\n\r\nObject.defineProperties(SubAnimation.prototype, {\r\n  setCurrentValue: {\r\n    value: function (value) {\r\n      this.currentValue = value;\r\n      this.node.flagOutputDirty(this.name);\r\n    }\r\n  },\r\n  play: {\r\n    value: function (start, end) {\r\n      if (start === undefined) {\r\n        console.log('Animation warning, start value is undefined');\r\n        start = 0;\r\n      }\r\n      if (end === undefined) {\r\n        console.error('Animation error, start:', start, 'end:', end);\r\n        return;\r\n      }\r\n      var animation = this.animation;\r\n      animation.startValue = start;\r\n      this.setCurrentValue(start);\r\n      animation.endValue = end;\r\n      animation.duration = this.node._internal.duration;\r\n      animation.start();\r\n    }\r\n  },\r\n  playToEnd: {\r\n    value: function () {\r\n      if (this.hasConnections() === false) {\r\n        return;\r\n      }\r\n      this.updateStartValue();\r\n      this.play(this.getTargetsCurrentValue(), this.endValue);\r\n    }\r\n  },\r\n  playToStart: {\r\n    value: function () {\r\n      if (this.hasConnections() === false) {\r\n        return;\r\n      }\r\n      this.updateStartValue();\r\n      this.play(this.getTargetsCurrentValue(), this.startValue);\r\n    }\r\n  },\r\n  replayToEnd: {\r\n    value: function () {\r\n      if (this.hasConnections() === false) {\r\n        return;\r\n      }\r\n      this.updateStartValue(); //in case animation doesn't have an explicit start value set\r\n      this.play(this.startValue, this.endValue);\r\n    }\r\n  },\r\n  replayToStart: {\r\n    value: function () {\r\n      if (this.hasConnections() === false) {\r\n        return;\r\n      }\r\n      this.play(this.endValue, this.startValue);\r\n    }\r\n  },\r\n  hasConnections: {\r\n    value: function () {\r\n      return this.node.getOutput(this.name).hasConnections();\r\n    }\r\n  },\r\n  getTargetsCurrentValue: {\r\n    value: function () {\r\n      var valueConnections = this.node.getOutput(this.name).connections;\r\n\r\n      //TODO: this will only work for the first connection\r\n      const value = valueConnections[0].node.getInputValue(valueConnections[0].inputPortName);\r\n      return value instanceof Object && value.hasOwnProperty('value') ? value.value : value;\r\n    }\r\n  },\r\n  updateStartValue: {\r\n    value: function () {\r\n      if (this.startMode !== 'implicit' || this.hasSampledStartValue) {\r\n        return;\r\n      }\r\n\r\n      this.hasSampledStartValue = true;\r\n      this.startValue = this.getTargetsCurrentValue();\r\n    }\r\n  },\r\n  stop: {\r\n    value: function () {\r\n      this.animation.stop();\r\n      this.setCurrentValue(undefined);\r\n    }\r\n  },\r\n  jumpToStart: {\r\n    value: function () {\r\n      this.animation.stop();\r\n      this.setCurrentValue(this.startValue);\r\n    }\r\n  },\r\n  jumpToEnd: {\r\n    value: function () {\r\n      this.animation.stop();\r\n      this.setCurrentValue(this.endValue);\r\n    }\r\n  }\r\n});\r\n\r\nvar easeEnum = [\r\n  { value: 'easeOut', label: 'Ease Out' },\r\n  { value: 'easeIn', label: 'Ease In' },\r\n  { value: 'linear', label: 'Linear' },\r\n  { value: 'easeInOut', label: 'Ease In Out' },\r\n  { value: 'cubicBezier', label: 'Cubic Bezier' }\r\n];\r\n\r\nvar defaultDuration = 300;\r\n\r\nvar AnimationNode = {\r\n  name: 'Animation',\r\n  docs: 'https://docs.noodl.net/nodes/animation/animation',\r\n  shortDesc: 'Node that can animate any number of values, with different types of easing curves.',\r\n  category: 'Animation',\r\n  deprecated: true,\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n\r\n    internal.duration = defaultDuration;\r\n    internal.ease = EaseCurves.easeOut;\r\n    internal._isPlayingToEnd = false;\r\n    internal.animations = [];\r\n    internal.cubicBezierPoints = [0, 0, 0, 0];\r\n    internal.cubicBezierFunction = undefined;\r\n\r\n    var self = this;\r\n\r\n    internal.animation = this.context.timerScheduler.createTimer({\r\n      onFinish: function () {\r\n        if (internal._isPlayingToEnd === false) {\r\n          self.sendSignalOnOutput('hasReachedStart');\r\n        } else {\r\n          self.sendSignalOnOutput('hasReachedEnd');\r\n        }\r\n      }\r\n    });\r\n  },\r\n  inputs: {\r\n    duration: {\r\n      index: 0,\r\n      type: 'number',\r\n      displayName: 'Duration (ms)',\r\n      group: 'Animation Properties',\r\n      default: defaultDuration,\r\n      set: function (value) {\r\n        this._internal.duration = value;\r\n      }\r\n    },\r\n    easingCurve: {\r\n      index: 10,\r\n      type: {\r\n        name: 'enum',\r\n        enums: easeEnum\r\n      },\r\n      group: 'Animation Properties',\r\n      displayName: 'Easing Curve',\r\n      default: 'easeOut',\r\n      set: function (value) {\r\n        var easeCurve;\r\n        if (value === 'cubicBezier') {\r\n          this.updateCubicBezierFunction();\r\n          easeCurve = this._internal.cubicBezierFunction;\r\n        } else {\r\n          easeCurve = EaseCurves[value];\r\n        }\r\n\r\n        this._internal.ease = easeCurve;\r\n      }\r\n    },\r\n    playToEnd: {\r\n      index: 20,\r\n      group: 'Play',\r\n      displayName: 'To End',\r\n      editorName: 'Play To End',\r\n      valueChangedToTrue: function () {\r\n        this._internal._isPlayingToEnd = true;\r\n\r\n        var animation = this._internal.animation,\r\n          animations = this._internal.animations,\r\n          self = this;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          animation.duration = self._internal.duration;\r\n          animation.start();\r\n          for (var i = 0; i < animations.length; i++) {\r\n            animations[i].ease = self._internal.ease;\r\n            animations[i].playToEnd();\r\n          }\r\n        });\r\n      }\r\n    },\r\n    playToStart: {\r\n      index: 21,\r\n      group: 'Play',\r\n      displayName: 'To Start',\r\n      editorName: 'Play To Start',\r\n      valueChangedToTrue: function () {\r\n        this._internal._isPlayingToEnd = false;\r\n        var animation = this._internal.animation,\r\n          animations = this._internal.animations,\r\n          self = this;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          animation.duration = self._internal.duration;\r\n          animation.start();\r\n          for (var i = 0; i < animations.length; i++) {\r\n            animations[i].ease = self._internal.ease;\r\n            animations[i].playToStart();\r\n          }\r\n        });\r\n      }\r\n    },\r\n    replayToEnd: {\r\n      index: 22,\r\n      group: 'Play',\r\n      displayName: 'From Start To End',\r\n      editorName: 'Play From Start To End',\r\n      valueChangedToTrue: function () {\r\n        var animation = this._internal.animation,\r\n          animations = this._internal.animations,\r\n          self = this;\r\n\r\n        this._internal._isPlayingToEnd = true;\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          animation.duration = self._internal.duration;\r\n          animation.start();\r\n          for (var i = 0; i < animations.length; i++) {\r\n            animations[i].ease = self._internal.ease;\r\n            animations[i].replayToEnd();\r\n          }\r\n        });\r\n      }\r\n    },\r\n    replayToStart: {\r\n      index: 23,\r\n      group: 'Play',\r\n      displayName: 'From End To Start',\r\n      editorName: 'Play From End To Start',\r\n      valueChangedToTrue: function () {\r\n        this._internal._isPlayingToEnd = false;\r\n        var animation = this._internal.animation,\r\n          animations = this._internal.animations,\r\n          self = this;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          animation.duration = self._internal.duration;\r\n          animation.start();\r\n          for (var i = 0; i < animations.length; i++) {\r\n            animations[i].ease = self._internal.ease;\r\n            animations[i].replayToStart();\r\n          }\r\n        });\r\n      }\r\n    },\r\n    stop: {\r\n      index: 60,\r\n      group: 'Instant Actions',\r\n      displayName: 'Stop',\r\n      valueChangedToTrue: function () {\r\n        var animation = this._internal.animation,\r\n          animations = this._internal.animations;\r\n\r\n        animation.stop();\r\n        for (var i = 0; i < animations.length; i++) {\r\n          animations[i].stop();\r\n        }\r\n      }\r\n    },\r\n    jumpToStart: {\r\n      index: 61,\r\n      group: 'Instant Actions',\r\n      displayName: 'Jump To Start',\r\n      valueChangedToTrue: function () {\r\n        var animations = this._internal.animations;\r\n\r\n        for (var i = 0; i < animations.length; i++) {\r\n          animations[i].jumpToStart();\r\n        }\r\n\r\n        this.sendSignalOnOutput('hasReachedStart');\r\n      }\r\n    },\r\n    jumpToEnd: {\r\n      index: 62,\r\n      group: 'Instant Actions',\r\n      displayName: 'Jump To End',\r\n      valueChangedToTrue: function () {\r\n        var animations = this._internal.animations;\r\n\r\n        for (var i = 0; i < animations.length; i++) {\r\n          animations[i].jumpToEnd();\r\n        }\r\n\r\n        this.sendSignalOnOutput('hasReachedEnd');\r\n      }\r\n    },\r\n    cubicBezierP1X: {\r\n      displayName: 'P1 X',\r\n      group: 'Cubic Bezier',\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      index: 11,\r\n      set: function (value) {\r\n        this._internal.cubicBezierPoints[0] = Math.min(1, Math.max(0, value));\r\n        this.updateCubicBezierFunction();\r\n      }\r\n    },\r\n    cubicBezierP1Y: {\r\n      displayName: 'P1 Y',\r\n      group: 'Cubic Bezier',\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      index: 12,\r\n      set: function (value) {\r\n        this._internal.cubicBezierPoints[1] = value;\r\n        this.updateCubicBezierFunction();\r\n      }\r\n    },\r\n    cubicBezierP2X: {\r\n      displayName: 'P2 X',\r\n      group: 'Cubic Bezier',\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      index: 13,\r\n      set: function (value) {\r\n        this._internal.cubicBezierPoints[2] = Math.min(1, Math.max(0, value));\r\n        this.updateCubicBezierFunction();\r\n      }\r\n    },\r\n    cubicBezierP2Y: {\r\n      displayName: 'P2 Y',\r\n      group: 'Cubic Bezier',\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      index: 14,\r\n      set: function (value) {\r\n        this._internal.cubicBezierPoints[3] = value;\r\n        this.updateCubicBezierFunction();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    hasReachedStart: {\r\n      type: 'signal',\r\n      group: 'Signals',\r\n      displayName: 'Has Reached Start'\r\n    },\r\n    hasReachedEnd: {\r\n      type: 'signal',\r\n      group: 'Signals',\r\n      displayName: 'Has Reached End'\r\n    }\r\n  },\r\n  dynamicports: [\r\n    {\r\n      condition: 'easingCurve = cubicBezier',\r\n      inputs: ['cubicBezierP1X', 'cubicBezierP1Y', 'cubicBezierP2X', 'cubicBezierP2Y']\r\n    },\r\n    //animation outputs\r\n    {\r\n      name: 'expand/basic',\r\n      indexStep: 100,\r\n      template: [\r\n        {\r\n          name: '{{portname}}.startMode',\r\n          type: {\r\n            name: 'enum',\r\n            enums: [\r\n              {\r\n                value: 'explicit',\r\n                label: 'Explicit'\r\n              },\r\n              {\r\n                value: 'implicit',\r\n                label: 'Implicit'\r\n              }\r\n            ],\r\n            allowEditOnly: true\r\n          },\r\n          plug: 'input',\r\n          group: '{{portname}} Animation',\r\n          displayName: 'Start Mode',\r\n          default: 'implicit',\r\n          index: 1000\r\n        },\r\n        {\r\n          name: '{{portname}}.endValue',\r\n          type: 'number',\r\n          plug: 'input',\r\n          group: '{{portname}} Animation',\r\n          displayName: 'End Value',\r\n          editorName: 'End Value | {{portname}} ',\r\n          default: 0,\r\n          index: 1002\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      name: 'expand/basic',\r\n      condition: \"'{{portname}}.startMode' = explicit\",\r\n      indexStep: 100,\r\n      template: [\r\n        {\r\n          name: '{{portname}}.startValue',\r\n          plug: 'input',\r\n          type: 'number',\r\n          displayName: 'Start Value',\r\n          editorName: 'Start Value | {{portname}}',\r\n          group: '{{portname}} Animation',\r\n          default: 0,\r\n          index: 1001\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  panels: [\r\n    {\r\n      name: 'PortEditor',\r\n      title: 'Animations',\r\n      plug: 'output',\r\n      type: { name: 'number' },\r\n      group: 'Animation Values'\r\n    }\r\n  ],\r\n  prototypeExtensions: {\r\n    updateCubicBezierFunction: {\r\n      value: function () {\r\n        var points = this._internal.cubicBezierPoints;\r\n        var cubicBezierEase = BezierEasing(points);\r\n        this._internal.cubicBezierFunction = function (start, end, t) {\r\n          return EaseCurves.linear(start, end, cubicBezierEase.get(t));\r\n        };\r\n        this._internal.ease = this._internal.cubicBezierFunction;\r\n      }\r\n    },\r\n    _registerAnimationGroup: {\r\n      value: function (name) {\r\n        var subAnimation = new SubAnimation({\r\n          node: this,\r\n          ease: this._internal.ease,\r\n          name: name\r\n        });\r\n\r\n        this._internal.animations.push(subAnimation);\r\n\r\n        var inputs = {};\r\n\r\n        inputs[name + '.' + 'startMode'] = {\r\n          set: function (value) {\r\n            subAnimation.startMode = value;\r\n          }\r\n        };\r\n        inputs[name + '.' + 'startValue'] = {\r\n          default: 0,\r\n          set: function (value) {\r\n            subAnimation.startValue = value;\r\n          }\r\n        };\r\n        inputs[name + '.' + 'endValue'] = {\r\n          default: 0,\r\n          set: function (value) {\r\n            subAnimation.endValue = value;\r\n          }\r\n        };\r\n\r\n        this.registerInputs(inputs);\r\n\r\n        this.registerOutput(name, {\r\n          getter: function () {\r\n            return subAnimation.currentValue;\r\n          }\r\n        });\r\n      }\r\n    },\r\n    registerInputIfNeeded: {\r\n      value: function (name) {\r\n        if (this.hasInput(name)) {\r\n          return;\r\n        }\r\n\r\n        var dotIndex = name.indexOf('.'),\r\n          animationName = name.substr(0, dotIndex);\r\n\r\n        if (this.hasOutput(animationName)) {\r\n          return;\r\n        }\r\n\r\n        this._registerAnimationGroup(animationName);\r\n      }\r\n    },\r\n    registerOutputIfNeeded: {\r\n      value: function (name) {\r\n        if (this.hasOutput(name)) {\r\n          return;\r\n        }\r\n\r\n        this._registerAnimationGroup(name);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: AnimationNode\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\nconst Model = require('@noodl/runtime/src/model');\r\n\r\nconst ComponentState = {\r\n  name: 'Component State',\r\n  displayNodeName: 'Component Object',\r\n  category: 'Component Utilities',\r\n  color: 'component',\r\n  docs: 'https://docs.noodl.net/nodes/component-utilities/component-object',\r\n  deprecated: true,\r\n  initialize: function () {\r\n    this._internal.inputValues = {};\r\n\r\n    this._internal.onModelChangedCallback = (args) => {\r\n      if (this.isInputConnected('fetch') !== false) return;\r\n\r\n      if (this.hasOutput('value-' + args.name)) {\r\n        this.flagOutputDirty('value-' + args.name);\r\n      }\r\n\r\n      if (this.hasOutput('changed-' + args.name)) {\r\n        this.sendSignalOnOutput('changed-' + args.name);\r\n      }\r\n\r\n      this.sendSignalOnOutput('changed');\r\n    };\r\n\r\n    const model = Model.get('componentState' + this.nodeScope.componentOwner.getInstanceId());\r\n    this._internal.model = model;\r\n\r\n    model.on('change', this._internal.onModelChangedCallback);\r\n\r\n    //    if(this.isInputConnected('fetch') === false)\r\n    //      this.fetch();\r\n  },\r\n  getInspectInfo() {\r\n    const data = this._internal.model.data;\r\n    return Object.keys(data).map((key) => {\r\n      return { type: 'text', value: key + ': ' + data[key] };\r\n    });\r\n  },\r\n  inputs: {\r\n    properties: {\r\n      type: {\r\n        name: 'stringlist',\r\n        allowEditOnly: true\r\n      },\r\n      displayName: 'Properties',\r\n      group: 'Properties',\r\n      set(value) {}\r\n    },\r\n    store: {\r\n      displayName: 'Set',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleStore();\r\n      }\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleFetch();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    },\r\n    stored: {\r\n      type: 'signal',\r\n      displayName: 'Stored',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  methods: {\r\n    scheduleStore() {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledStore = false;\r\n        for (var i in internal.inputValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n        this.sendSignalOnOutput('stored');\r\n      });\r\n    },\r\n    scheduleFetch() {\r\n      if (this.hasScheduledFetch) return;\r\n      this.hasScheduledFetch = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledFetch = false;\r\n        this.fetch();\r\n      });\r\n    },\r\n    fetch() {\r\n      for (var key in this._internal.model.data) {\r\n        if (this.hasOutput('value-' + key)) {\r\n          this.flagOutputDirty('value-' + key);\r\n          if (this.hasOutput('changed-' + key)) {\r\n            this.sendSignalOnOutput('changed-' + key);\r\n          }\r\n        }\r\n      }\r\n      this.sendSignalOnOutput('fetched');\r\n    },\r\n    _onNodeDeleted() {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n    },\r\n    registerOutputIfNeeded(name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      const split = name.split('-');\r\n      const propertyName = split[split.length - 1];\r\n\r\n      this.registerOutput(name, {\r\n        get() {\r\n          return this._internal.model.get(propertyName, { resolve: true });\r\n        }\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      const split = name.split('-');\r\n      const propertyName = split[split.length - 1];\r\n\r\n      if (name.startsWith('value-')) {\r\n        this.registerInput(name, {\r\n          set(value) {\r\n            this._internal.inputValues[propertyName] = value;\r\n\r\n            if (this.isInputConnected('store') === false)\r\n              // Lazy set\r\n              this.scheduleStore();\r\n          }\r\n        });\r\n      }\r\n      /*  else if (name.startsWith('start-value-')) {\r\n                this.registerInput(name, {\r\n                    set(value) {\r\n                        this._internal.model.set(propertyName, value)\r\n                    }\r\n                });\r\n            }\r\n            else if (name.startsWith('type-')) {\r\n                this.registerInput(name, {\r\n                    set(value) {}\r\n                });\r\n            }*/\r\n    }\r\n  }\r\n};\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection) {\r\n  const ports = [];\r\n\r\n  // Add value outputs\r\n  if (parameters.properties) {\r\n    var properties = parameters.properties.split(',');\r\n    for (var i in properties) {\r\n      var p = properties[i];\r\n\r\n      ports.push({\r\n        type: {\r\n          name: '*',\r\n          allowConnectionsOnly: true\r\n        },\r\n        plug: 'input/output',\r\n        group: 'Properties',\r\n        name: 'value-' + p,\r\n        displayName: p\r\n      });\r\n      /*   ports.push({\r\n                type: {\r\n                    name: parameters['type-' + p] || 'string',\r\n                    allowEditOnly: true\r\n                },\r\n                plug: 'input',\r\n                group: 'Start Values',\r\n                name: 'start-value-' + p,\r\n                displayName: p\r\n            });\r\n\r\n            ports.push({\r\n                type: {\r\n                    name: 'enum',\r\n                    enums: [\r\n                        { label: 'Number', value: 'number' },\r\n                        { label: 'String', value: 'string' },\r\n                        { label: 'Boolean', value: 'boolean' },\r\n                        { label: 'Color', value: 'color' },\r\n                        { label: 'Image', value: 'image' }\r\n                    ],\r\n                    allowEditOnly: true\r\n                },\r\n                default: 'string',\r\n                plug: 'input',\r\n                group: 'Types',\r\n                displayName: p,\r\n                name: 'type-' + p,\r\n            });*/\r\n\r\n      ports.push({\r\n        type: 'signal',\r\n        plug: 'output',\r\n        group: 'Changed Events',\r\n        displayName: p + ' Changed',\r\n        name: 'changed-' + p\r\n      });\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: 'input/output'\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: ComponentState,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.Component State', (node) => {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n      node.on('parameterUpdated', (event) => {\r\n        if (event.name === 'properties' || event.name.startsWith('type-')) {\r\n          updatePorts(node.id, node.parameters, context.editorConnection);\r\n        }\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\n\r\nvar Model = require('@noodl/runtime/src/model'),\r\n  Collection = require('@noodl/runtime/src/collection');\r\n\r\nvar CollectionNode = {\r\n  name: 'Collection',\r\n  docs: 'https://docs.noodl.net/nodes/data/array',\r\n  displayNodeName: 'Array',\r\n  shortDesc: 'A collection of models, mainly used together with a For Each Node.',\r\n  category: 'Data',\r\n  usePortAsLabel: 'collectionId',\r\n  color: 'data',\r\n  deprecated: true, // Use new array node\r\n  initialize: function () {\r\n    var _this = this;\r\n\r\n    var collectionChangedScheduled = false;\r\n    this._internal.collectionChangedCallback = function () {\r\n      if (_this.isInputConnected('fetch') === true) return; // Ignore if we have explicit fetch connection\r\n\r\n      //this can be called multiple times when adding/removing more than one item\r\n      //so optimize by only updating outputs once\r\n      if (collectionChangedScheduled) return;\r\n      collectionChangedScheduled = true;\r\n\r\n      _this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.sendSignalOnOutput('changed');\r\n        _this.flagOutputDirty('count');\r\n        collectionChangedScheduled = false;\r\n      });\r\n    };\r\n\r\n    // When the source collection has changed, simply copy items into this collection\r\n    this._internal.sourceCollectionChangedCallback = function () {\r\n      if (_this.isInputConnected('store') === true) return; // Ignore if we have explicit store connection\r\n\r\n      _this.scheduleCopyItems();\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal.collection) {\r\n      return 'Count: ' + this._internal.collection.size();\r\n    }\r\n  },\r\n  inputs: {\r\n    collectionId: {\r\n      type: {\r\n        name: 'string',\r\n        identifierOf: 'CollectionName',\r\n        identifierDisplayName: 'Array Ids'\r\n      },\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value instanceof Collection) value = value.getId(); // Can be passed as collection as well\r\n        this._internal.collectionId = value; // Wait to fetch data\r\n        if (this.isInputConnected('fetch') === false) this.setCollectionID(value);\r\n        else {\r\n          this.flagOutputDirty('id');\r\n        }\r\n      }\r\n    },\r\n    items: {\r\n      type: 'array',\r\n      group: 'General',\r\n      displayName: 'Items',\r\n      set: function (value) {\r\n        var _this = this;\r\n        if (value === undefined) return;\r\n        if (value === this._internal.collection) return;\r\n\r\n        this._internal.pendingSourceCollection = value;\r\n        if (this.isInputConnected('store') === false) {\r\n          // Don't auto copy if we have connections to store\r\n          this.scheduleAfterInputsHaveUpdated(function () {\r\n            _this.setSourceCollection(value);\r\n          });\r\n        }\r\n      }\r\n    },\r\n    modifyId: {\r\n      type: { name: 'string', allowConnectionsOnly: true },\r\n      displayName: 'Item Id',\r\n      group: 'Modify',\r\n      set: function (value) {\r\n        this._internal.modifyId = value;\r\n      }\r\n    },\r\n    /*  modifyModel: {\r\n      type: {name:'object',\r\n              allowConnectionsOnly:true},\r\n      displayName:'Item',\r\n      group:'Modify',\r\n      set:function(value) {\r\n        if(!(value instanceof Model)) return;\r\n        this._internal.modifyId = value.getId();\r\n      },\r\n    },   */\r\n    store: {\r\n      displayName: 'Set',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleStore();\r\n      }\r\n    },\r\n    add: {\r\n      displayName: 'Add',\r\n      group: 'Modify',\r\n      valueChangedToTrue: function () {\r\n        var _this = this;\r\n        var internal = this._internal;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          if (internal.modifyId === undefined) return;\r\n          if (internal.collection === undefined && this.isInputConnected('fetch') === false)\r\n            _this.setCollection(Collection.get()); // Create a new empty collection if we don't have one yet\r\n          if (internal.collection === undefined) return;\r\n\r\n          var model = Model.get(internal.modifyId);\r\n          internal.collection.add(model);\r\n          _this.sendSignalOnOutput('modified');\r\n        });\r\n      }\r\n    },\r\n    remove: {\r\n      displayName: 'Remove',\r\n      group: 'Modify',\r\n      valueChangedToTrue: function () {\r\n        var _this = this;\r\n        var internal = this._internal;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          if (internal.modifyId === undefined) return;\r\n          if (internal.collection === undefined && this.isInputConnected('fetch') === false)\r\n            _this.setCollection(Collection.get()); // Create a new empty collection if we don't have one yet\r\n          if (internal.collection === undefined) return;\r\n\r\n          var model = Model.get(internal.modifyId);\r\n          internal.collection.remove(model);\r\n          _this.sendSignalOnOutput('modified');\r\n        });\r\n      }\r\n    },\r\n    clear: {\r\n      displayName: 'Clear',\r\n      group: 'Modify',\r\n      valueChangedToTrue: function () {\r\n        var _this = this;\r\n        var internal = this._internal;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          if (internal.collection === undefined && this.isInputConnected('fetch') === false)\r\n            _this.setCollection(Collection.get()); // Create a new empty collection if we don't have one yet\r\n          if (internal.collection === undefined) return;\r\n\r\n          internal.collection.set([]);\r\n          _this.sendSignalOnOutput('modified');\r\n          _this.sendSignalOnOutput('count');\r\n        });\r\n      }\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleSetCollection();\r\n      }\r\n    },\r\n    new: {\r\n      displayName: 'New',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleNew();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: 'string',\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection ? this._internal.collection.getId() : this._internal.collectionId;\r\n      }\r\n    },\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection;\r\n      }\r\n    },\r\n    count: {\r\n      type: 'number',\r\n      displayName: 'Count',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection ? this._internal.collection.size() : 0;\r\n      }\r\n    },\r\n    modified: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Modified'\r\n    },\r\n    changed: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Changed'\r\n    },\r\n    stored: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Stored'\r\n    },\r\n    fetched: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Fetched'\r\n    },\r\n    created: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Created'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionID: function (id) {\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection: function (collection) {\r\n      if (this._internal.collection)\r\n        // Remove old listener if existing\r\n        this._internal.collection.off('change', this._internal.collectionChangedCallback);\r\n\r\n      this._internal.collection = collection;\r\n      this.flagOutputDirty('id');\r\n      collection.on('change', this._internal.collectionChangedCallback);\r\n\r\n      this.flagOutputDirty('items');\r\n      this.flagOutputDirty('count');\r\n    },\r\n    setSourceCollection: function (collection) {\r\n      var internal = this._internal;\r\n\r\n      if (internal.sourceCollection && internal.sourceCollection instanceof Collection)\r\n        // Remove old listener if existing\r\n        internal.sourceCollection.off('change', internal.sourceCollectionChangedCallback);\r\n\r\n      internal.sourceCollection = collection;\r\n      if (internal.sourceCollection instanceof Collection)\r\n        internal.sourceCollection.on('change', internal.sourceCollectionChangedCallback);\r\n\r\n      this._copySourceItems();\r\n    },\r\n    scheduleSetCollection: function () {\r\n      var _this = this;\r\n\r\n      if (this.hasScheduledSetCollection) return;\r\n      this.hasScheduledSetCollection = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.hasScheduledSetCollection = false;\r\n        _this.setCollectionID(_this._internal.collectionId);\r\n        _this.sendSignalOnOutput('fetched');\r\n      });\r\n    },\r\n    scheduleStore: function () {\r\n      var _this = this;\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.hasScheduledStore = false;\r\n        _this.setSourceCollection(internal.pendingSourceCollection);\r\n        _this.sendSignalOnOutput('stored');\r\n      });\r\n    },\r\n    _copySourceItems: function () {\r\n      var internal = this._internal;\r\n\r\n      if (internal.collection === undefined && this.isInputConnected('fetch') === false)\r\n        this.setCollection(Collection.get());\r\n      internal.collection && internal.collection.set(internal.sourceCollection);\r\n    },\r\n    scheduleCopyItems: function () {\r\n      var _this = this;\r\n      var internal = this._internal;\r\n\r\n      if (this.hasScheduledCopyItems) return;\r\n      this.hasScheduledCopyItems = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.hasScheduledCopyItems = false;\r\n        _this._copySourceItems();\r\n      });\r\n    },\r\n    scheduleNew: function () {\r\n      var _this = this;\r\n\r\n      if (this.hasScheduledNew) return;\r\n      this.hasScheduledNew = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.hasScheduledNew = false;\r\n        _this.setCollection(Collection.get());\r\n\r\n        // If we have a source collection, copy items\r\n        if (internal.sourceCollection) internal.collection.set(internal.sourceCollection);\r\n\r\n        _this.sendSignalOnOutput('created');\r\n      });\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n\r\n      if (this._internal.collection)\r\n        // Remove old listener if existing\r\n        this._internal.collection.off('change', this._internal.collectionChangedCallback);\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CollectionNode\r\n};\r\n","'use strict';\r\n\r\nconst { Node, EdgeTriggeredInput } = require('@noodl/runtime');\r\n\r\nconst Model = require('@noodl/runtime/src/model'),\r\n  Collection = require('@noodl/runtime/src/collection'),\r\n  CloudStore = require('@noodl/runtime/src/api/cloudstore'),\r\n  JavascriptNodeParser = require('@noodl/runtime/src/javascriptnodeparser');\r\n\r\nfunction _convertFilterOp(filter, options) {\r\n  const keys = Object.keys(filter);\r\n  if (keys.length === 0) return {};\r\n  if (keys.length !== 1) return options.error('Filter must only have one key found ' + keys.join(','));\r\n\r\n  const res = {};\r\n  const key = keys[0];\r\n  if (filter['and'] !== undefined && Array.isArray(filter['and'])) {\r\n    res['$and'] = filter['and'].map((f) => _convertFilterOp(f, options));\r\n  } else if (filter['or'] !== undefined && Array.isArray(filter['or'])) {\r\n    res['$or'] = filter['or'].map((f) => _convertFilterOp(f, options));\r\n  } else if (filter['idEqualTo'] !== undefined) {\r\n    res['objectId'] = { $eq: filter['idEqualTo'] };\r\n  } else if (filter['idContainedIn'] !== undefined) {\r\n    res['objectId'] = { $in: filter['idContainedIn'] };\r\n  } else if (filter['relatedTo'] !== undefined) {\r\n    var modelId = filter['relatedTo']['id'];\r\n    if (modelId === undefined) return options.error('Must provide id in relatedTo filter');\r\n\r\n    var relationKey = filter['relatedTo']['key'];\r\n    if (relationKey === undefined) return options.error('Must provide key in relatedTo filter');\r\n\r\n    var m = Model.get(modelId);\r\n    res['$relatedTo'] = {\r\n      object: {\r\n        __type: 'Pointer',\r\n        objectId: modelId,\r\n        className: m._class\r\n      },\r\n      key: relationKey\r\n    };\r\n  } else if (typeof filter[key] === 'object') {\r\n    const opAndValue = filter[key];\r\n    if (opAndValue['equalTo'] !== undefined) res[key] = { $eq: opAndValue['equalTo'] };\r\n    else if (opAndValue['notEqualTo'] !== undefined) res[key] = { $ne: opAndValue['notEqualTo'] };\r\n    else if (opAndValue['lessThan'] !== undefined) res[key] = { $lt: opAndValue['lessThan'] };\r\n    else if (opAndValue['greaterThan'] !== undefined) res[key] = { $gt: opAndValue['greaterThan'] };\r\n    else if (opAndValue['lessThanOrEqualTo'] !== undefined) res[key] = { $lte: opAndValue['lessThanOrEqualTo'] };\r\n    else if (opAndValue['greaterThanOrEqualTo'] !== undefined) res[key] = { $gte: opAndValue['greaterThanOrEqualTo'] };\r\n    else if (opAndValue['exists'] !== undefined) res[key] = { $exists: opAndValue['exists'] };\r\n    else if (opAndValue['containedIn'] !== undefined) res[key] = { $in: opAndValue['containedIn'] };\r\n    else if (opAndValue['notContainedIn'] !== undefined) res[key] = { $nin: opAndValue['notContainedIn'] };\r\n    else if (opAndValue['pointsTo'] !== undefined) {\r\n      var m = Model.get(opAndValue['pointsTo']);\r\n      if (CloudStore._collections[options.collectionName])\r\n        var schema = CloudStore._collections[options.collectionName].schema;\r\n\r\n      var targetClass =\r\n        schema && schema.properties && schema.properties[key] ? schema.properties[key].targetClass : undefined;\r\n      var type = schema && schema.properties && schema.properties[key] ? schema.properties[key].type : undefined;\r\n\r\n      if (type === 'Relation') {\r\n        res[key] = {\r\n          __type: 'Pointer',\r\n          objectId: opAndValue['pointsTo'],\r\n          className: targetClass\r\n        };\r\n      } else {\r\n        if (Array.isArray(opAndValue['pointsTo']))\r\n          res[key] = {\r\n            $in: opAndValue['pointsTo'].map((v) => {\r\n              return { __type: 'Pointer', objectId: v, className: targetClass };\r\n            })\r\n          };\r\n        else\r\n          res[key] = {\r\n            $eq: {\r\n              __type: 'Pointer',\r\n              objectId: opAndValue['pointsTo'],\r\n              className: targetClass\r\n            }\r\n          };\r\n      }\r\n    } else if (opAndValue['matchesRegex'] !== undefined) {\r\n      res[key] = {\r\n        $regex: opAndValue['matchesRegex'],\r\n        $options: opAndValue['options']\r\n      };\r\n    } else if (opAndValue['text'] !== undefined && opAndValue['text']['search'] !== undefined) {\r\n      var _v = opAndValue['text']['search'];\r\n      if (typeof _v === 'string') res[key] = { $text: { $search: { $term: _v, $caseSensitive: false } } };\r\n      else\r\n        res[key] = {\r\n          $text: {\r\n            $search: {\r\n              $term: _v.term,\r\n              $language: _v.language,\r\n              $caseSensitive: _v.caseSensitive,\r\n              $diacriticSensitive: _v.diacriticSensitive\r\n            }\r\n          }\r\n        };\r\n    }\r\n  } else {\r\n    options.error('Unrecognized filter keys ' + keys.join(','));\r\n  }\r\n\r\n  return res;\r\n}\r\n\r\nvar DbCollectionNode = {\r\n  name: 'DbCollection',\r\n  docs: 'https://docs.noodl.net/nodes/cloud-services/collection',\r\n  displayNodeName: 'Query Collection',\r\n  shortDesc: 'A database collection.',\r\n  category: 'Cloud Services',\r\n  usePortAsLabel: 'collectionName',\r\n  color: 'data',\r\n  deprecated: true, // Use Query Records\r\n  initialize: function () {\r\n    var _this = this;\r\n\r\n    var collectionChangedScheduled = false;\r\n    this._internal.collectionChangedCallback = function () {\r\n      //this can be called multiple times when adding/removing more than one item\r\n      //so optimize by only updating outputs once\r\n      if (collectionChangedScheduled) return;\r\n      collectionChangedScheduled = true;\r\n\r\n      _this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.sendSignalOnOutput('modified');\r\n        _this.flagOutputDirty('count');\r\n        _this.flagOutputDirty('firstItemId');\r\n        //  _this.flagOutputDirty('firstItem');\r\n        collectionChangedScheduled = false;\r\n      });\r\n    };\r\n\r\n    this._internal.storageSettings = {};\r\n  },\r\n  inputs: {},\r\n  outputs: {\r\n    id: {\r\n      type: 'string',\r\n      displayName: 'Name',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.name;\r\n      }\r\n    },\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Result',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection;\r\n      }\r\n    },\r\n    firstItemId: {\r\n      type: 'string',\r\n      displayName: 'First Item Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        if (this._internal.collection) {\r\n          var firstItem = this._internal.collection.get(0);\r\n          if (firstItem !== undefined) return firstItem.getId();\r\n        }\r\n      }\r\n    },\r\n    /*    firstItem: {\r\n            type: 'object',\r\n            displayName: 'First Item',\r\n            group: 'General',\r\n            getter: function () {\r\n                if (this._internal.collection) {\r\n                    return this._internal.collection.get(0);\r\n                }\r\n            }\r\n        },  */\r\n    count: {\r\n      type: 'number',\r\n      displayName: 'Count',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection ? this._internal.collection.size() : 0;\r\n      }\r\n    },\r\n    modified: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Modified'\r\n    },\r\n    fetched: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Fetched'\r\n    },\r\n    failure: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Failure'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Events',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionName: function (name) {\r\n      this._internal.name = name;\r\n      // this.invalidateCollection();\r\n      this.flagOutputDirty('id');\r\n    },\r\n    setCollection: function (collection) {\r\n      this.bindCollection(collection);\r\n      this.flagOutputDirty('firstItemId');\r\n      // this.flagOutputDirty('firstItem');\r\n      this.flagOutputDirty('items');\r\n      this.flagOutputDirty('count');\r\n    },\r\n    unbindCurrentCollection: function () {\r\n      var collection = this._internal.collection;\r\n      if (!collection) return;\r\n      collection.off('change', this._internal.collectionChangedCallback);\r\n      this._internal.collection = undefined;\r\n    },\r\n    bindCollection: function (collection) {\r\n      this.unbindCurrentCollection();\r\n      this._internal.collection = collection;\r\n      collection && collection.on('change', this._internal.collectionChangedCallback);\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this.unbindCurrentCollection();\r\n    },\r\n    setError: function (err) {\r\n      this._internal.err = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n    },\r\n    fetch: function () {\r\n      var internal = this._internal;\r\n\r\n      if (this.context.editorConnection) {\r\n        if (this._internal.name === undefined) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'query-collection', {\r\n            message: 'No collection specified for query'\r\n          });\r\n        } else {\r\n          this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'query-collection');\r\n        }\r\n      }\r\n\r\n      if (internal.fetchScheduled) return;\r\n      internal.fetchScheduled = true;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        internal.fetchScheduled = false;\r\n\r\n        const _c = Collection.get();\r\n        const f = this.getStorageFilter();\r\n        CloudStore.instance.query({\r\n          collection: this._internal.name,\r\n          where: f.where,\r\n          sort: f.sort,\r\n          limit: this.getStorageLimit(),\r\n          skip: this.getStorageSkip(),\r\n          success: (results) => {\r\n            if (results !== undefined) {\r\n              _c.set(\r\n                results.map((i) => {\r\n                  var m = CloudStore._fromJSON(i, this._internal.name);\r\n\r\n                  // Remove from collection if model is deleted\r\n                  m.on('delete', () => _c.remove(m));\r\n                  return m;\r\n                })\r\n              );\r\n            }\r\n            this.setCollection(_c);\r\n            this.sendSignalOnOutput('fetched');\r\n          },\r\n          error: (err) => {\r\n            this.setCollection(_c);\r\n            this.setError(err || 'Failed to fetch.');\r\n          }\r\n        });\r\n      });\r\n    },\r\n    getStorageFilter: function () {\r\n      const storageSettings = this._internal.storageSettings;\r\n      if (storageSettings['storageFilterType'] === undefined || storageSettings['storageFilterType'] === 'simple') {\r\n        // Create simple filter\r\n        if (storageSettings['storageFilter']) {\r\n          const filters = storageSettings['storageFilter'].split(',');\r\n          var _filters = [];\r\n          filters.forEach(function (f) {\r\n            const _filter = {};\r\n            var op = '$' + (storageSettings['storageFilterOp-' + f] || 'eq');\r\n            _filter[f] = {};\r\n            _filter[f][op] = storageSettings['storageFilterValue-' + f];\r\n            _filters.push(_filter);\r\n          });\r\n          var _where = _filters.length > 1 ? { $and: _filters } : _filters[0];\r\n        }\r\n\r\n        if (storageSettings['storageSort']) {\r\n          const sort = storageSettings['storageSort'].split(',');\r\n          var _sort = [];\r\n          sort.forEach(function (s) {\r\n            _sort.push((storageSettings['storageSort-' + s] === 'descending' ? '-' : '') + s);\r\n          });\r\n        }\r\n\r\n        return {\r\n          where: _where,\r\n          sort: _sort\r\n        };\r\n      } else if (storageSettings['storageFilterType'] === 'json') {\r\n        // JSON filter\r\n        if (!this._internal.filterFunc) {\r\n          try {\r\n            var filterCode = storageSettings['storageJSONFilter'];\r\n\r\n            // Parse out variables\r\n            filterCode = filterCode.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g, ''); // Remove comments\r\n            this._internal.filterVariables = filterCode.match(/\\$[A-Za-z0-9]+/g) || [];\r\n\r\n            var args = ['filter', 'where', 'sort', 'Inputs']\r\n              .concat(this._internal.filterVariables)\r\n              .concat([filterCode]);\r\n            this._internal.filterFunc = Function.apply(null, args);\r\n          } catch (e) {\r\n            this._internal.filterFunc = undefined;\r\n            console.log('Error while parsing filter script: ' + e);\r\n          }\r\n        }\r\n\r\n        if (!this._internal.filterFunc) return;\r\n\r\n        var _filter = {},\r\n          _sort = [],\r\n          _this = this;\r\n\r\n        // Collect filter variables\r\n        var _filterCb = function (f) {\r\n          _filter = _convertFilterOp(f, {\r\n            collectionName: _this._internal.name,\r\n            error: function (err) {\r\n              _this.context.editorConnection.sendWarning(\r\n                _this.nodeScope.componentOwner.name,\r\n                _this.id,\r\n                'query-collection-filter',\r\n                {\r\n                  message: err\r\n                }\r\n              );\r\n            }\r\n          });\r\n        };\r\n        var _sortCb = function (s) {\r\n          _sort = s;\r\n        };\r\n\r\n        // Extract inputs\r\n        const inputs = {};\r\n        for (let key in storageSettings) {\r\n          if (key.startsWith('storageFilterValue-'))\r\n            inputs[key.substring('storageFilterValue-'.length)] = storageSettings[key];\r\n        }\r\n\r\n        var filterFuncArgs = [_filterCb, _filterCb, _sortCb, inputs]; // One for filter, one for where\r\n\r\n        this._internal.filterVariables.forEach((v) => {\r\n          filterFuncArgs.push(storageSettings['storageFilterValue-' + v.substring(1)]);\r\n        });\r\n\r\n        // Run the code to get the filter\r\n        try {\r\n          this._internal.filterFunc.apply(this, filterFuncArgs);\r\n        } catch (e) {\r\n          console.log('Error while running filter script: ' + e);\r\n        }\r\n\r\n        return { where: _filter, sort: _sort };\r\n      }\r\n    },\r\n    getStorageLimit: function () {\r\n      const storageSettings = this._internal.storageSettings;\r\n\r\n      if (!storageSettings['storageEnableLimit']) return;\r\n      else return storageSettings['storageLimit'] || 10;\r\n    },\r\n    getStorageSkip: function () {\r\n      const storageSettings = this._internal.storageSettings;\r\n\r\n      if (!storageSettings['storageEnableLimit']) return;\r\n      else return storageSettings['storageSkip'] || 0;\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerOutput(name, {\r\n        getter: userOutputGetter.bind(this, name)\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      var _this = this;\r\n\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      const dynamicSignals = {\r\n        storageFetch: this.fetch.bind(this)\r\n      };\r\n\r\n      if (dynamicSignals[name])\r\n        return this.registerInput(name, {\r\n          set: EdgeTriggeredInput.createSetter({\r\n            valueChangedToTrue: dynamicSignals[name]\r\n          })\r\n        });\r\n\r\n      const dynamicSetters = {\r\n        collectionName: this.setCollectionName.bind(this)\r\n      };\r\n\r\n      if (dynamicSetters[name])\r\n        return this.registerInput(name, {\r\n          set: dynamicSetters[name]\r\n        });\r\n\r\n      this.registerInput(name, {\r\n        set: userInputSetter.bind(this, name)\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nfunction userOutputGetter(name) {\r\n  /* jshint validthis:true */\r\n  return this._internal.storageSettings[name];\r\n}\r\n\r\nfunction userInputSetter(name, value) {\r\n  /* jshint validthis:true */\r\n  this._internal.storageSettings[name] = value;\r\n}\r\n\r\nconst _defaultJSONQuery =\r\n  '// Write your query script here, check out the reference documentation for examples\\n' + 'where({ })\\n';\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection, dbCollections) {\r\n  var ports = [];\r\n\r\n  ports.push({\r\n    name: 'collectionName',\r\n    type: {\r\n      name: 'enum',\r\n      enums:\r\n        dbCollections !== undefined\r\n          ? dbCollections.map((c) => {\r\n              return { value: c.name, label: c.name };\r\n            })\r\n          : [],\r\n      allowEditOnly: true\r\n    },\r\n    displayName: 'Collecton Name',\r\n    plug: 'input',\r\n    group: 'General'\r\n  });\r\n\r\n  ports.push({\r\n    name: 'storageFilterType',\r\n    type: {\r\n      name: 'enum',\r\n      allowEditOnly: true,\r\n      enums: [\r\n        { value: 'simple', label: 'Simple' },\r\n        { value: 'json', label: 'Advanced' }\r\n      ]\r\n    },\r\n    displayName: 'Filter',\r\n    default: 'simple',\r\n    plug: 'input',\r\n    group: 'General'\r\n  });\r\n\r\n  // Limit\r\n  ports.push({\r\n    type: 'boolean',\r\n    plug: 'input',\r\n    group: 'Limit',\r\n    name: 'storageEnableLimit',\r\n    displayName: 'Use limit'\r\n  });\r\n\r\n  if (parameters['storageEnableLimit']) {\r\n    ports.push({\r\n      type: 'number',\r\n      default: 10,\r\n      plug: 'input',\r\n      group: 'Limit',\r\n      name: 'storageLimit',\r\n      displayName: 'Limit'\r\n    });\r\n\r\n    ports.push({\r\n      type: 'number',\r\n      default: 0,\r\n      plug: 'input',\r\n      group: 'Limit',\r\n      name: 'storageSkip',\r\n      displayName: 'Skip'\r\n    });\r\n  }\r\n\r\n  ports.push({\r\n    type: 'signal',\r\n    plug: 'input',\r\n    group: 'Storage',\r\n    name: 'storageFetch',\r\n    displayName: 'Fetch'\r\n  });\r\n\r\n  // Simple query\r\n  if (parameters['storageFilterType'] === undefined || parameters['storageFilterType'] === 'simple') {\r\n    ports.push({\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      plug: 'input',\r\n      group: 'Filter',\r\n      name: 'storageFilter',\r\n      displayName: 'Filter'\r\n    });\r\n\r\n    const filterOps = {\r\n      string: [\r\n        { value: 'eq', label: 'Equals' },\r\n        { value: 'ne', label: 'Not Equals' }\r\n      ],\r\n      boolean: [\r\n        { value: 'eq', label: 'Equals' },\r\n        { value: 'ne', label: 'Not Equals' }\r\n      ],\r\n      number: [\r\n        { value: 'eq', label: 'Equals' },\r\n        { value: 'ne', label: 'Not Equals' },\r\n        { value: 'lt', label: 'Less than' },\r\n        { value: 'gt', label: 'Greater than' },\r\n        { value: 'gte', label: 'Greater than or equal' },\r\n        { value: 'lte', label: 'Less than or equal' }\r\n      ]\r\n    };\r\n\r\n    if (parameters['storageFilter']) {\r\n      var filters = parameters['storageFilter'].split(',');\r\n      filters.forEach((f) => {\r\n        // Type\r\n        ports.push({\r\n          type: {\r\n            name: 'enum',\r\n            enums: [\r\n              { value: 'string', label: 'String' },\r\n              { value: 'number', label: 'Number' },\r\n              { value: 'boolean', label: 'Boolean' }\r\n            ]\r\n          },\r\n          default: 'string',\r\n          plug: 'input',\r\n          group: f + ' filter',\r\n          displayName: 'Type',\r\n          editorName: f + ' filter | Type',\r\n          name: 'storageFilterType-' + f\r\n        });\r\n\r\n        var type = parameters['storageFilterType-' + f];\r\n\r\n        // String filter type\r\n        ports.push({\r\n          type: { name: 'enum', enums: filterOps[type || 'string'] },\r\n          default: 'eq',\r\n          plug: 'input',\r\n          group: f + ' filter',\r\n          displayName: 'Op',\r\n          editorName: f + ' filter| Op',\r\n          name: 'storageFilterOp-' + f\r\n        });\r\n\r\n        ports.push({\r\n          type: type || 'string',\r\n          plug: 'input',\r\n          group: f + ' filter',\r\n          displayName: 'Value',\r\n          editorName: f + ' Filter Value',\r\n          name: 'storageFilterValue-' + f\r\n        });\r\n      });\r\n    }\r\n\r\n    ports.push({\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      plug: 'input',\r\n      group: 'Sort',\r\n      name: 'storageSort',\r\n      displayName: 'Sort'\r\n    });\r\n\r\n    // Sorting inputs\r\n    if (parameters['storageSort']) {\r\n      var filters = parameters['storageSort'].split(',');\r\n      filters.forEach((f) => {\r\n        ports.push({\r\n          type: {\r\n            name: 'enum',\r\n            enums: [\r\n              { value: 'ascending', label: 'Ascending' },\r\n              { value: 'descending', label: 'Descending' }\r\n            ]\r\n          },\r\n          default: 'ascending',\r\n          plug: 'input',\r\n          group: f + ' sort',\r\n          displayName: 'Sort',\r\n          editorName: f + ' sorting',\r\n          name: 'storageSort-' + f\r\n        });\r\n      });\r\n    }\r\n  }\r\n  // JSON query\r\n  else if (parameters['storageFilterType'] === 'json') {\r\n    ports.push({\r\n      type: { name: 'string', allowEditOnly: true, codeeditor: 'javascript' },\r\n      plug: 'input',\r\n      group: 'Filter',\r\n      name: 'storageJSONFilter',\r\n      default: _defaultJSONQuery,\r\n      displayName: 'Filter'\r\n    });\r\n\r\n    var filter = parameters['storageJSONFilter'];\r\n    if (filter) {\r\n      filter = filter.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g, ''); // Remove comments\r\n      var variables = filter.match(/\\$[A-Za-z0-9]+/g);\r\n\r\n      if (variables) {\r\n        const unique = {};\r\n        variables.forEach((v) => {\r\n          unique[v] = true;\r\n        });\r\n\r\n        Object.keys(unique).forEach((p) => {\r\n          ports.push({\r\n            name: 'storageFilterValue-' + p.substring(1),\r\n            displayName: p.substring(1),\r\n            group: 'Filter Values',\r\n            plug: 'input',\r\n            type: { name: '*', allowConnectionsOnly: true }\r\n          });\r\n        });\r\n      }\r\n\r\n      // Support variables with the \"Inputs.\"\" syntax\r\n      JavascriptNodeParser.parseAndAddPortsFromScript(filter, ports, {\r\n        inputPrefix: 'storageFilterValue-',\r\n        inputGroup: 'Filter Values',\r\n        inputType: { name: '*', allowConnectionsOnly: true },\r\n        skipOutputs: true\r\n      });\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nmodule.exports = {\r\n  node: DbCollectionNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('dbCollections'));\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        if (event.name.startsWith('storage')) {\r\n          updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('dbCollections'));\r\n        }\r\n      });\r\n\r\n      graphModel.on('metadataChanged.dbCollections', function (data) {\r\n        CloudStore.invalidateCollections();\r\n        updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n      });\r\n\r\n      graphModel.on('metadataChanged.cloudservices', function (data) {\r\n        CloudStore.instance._initCloudServices();\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.DbCollection', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('DbCollection')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst { Node, EdgeTriggeredInput } = require('@noodl/runtime');\r\nconst isEqual = require('lodash.isequal');\r\n\r\nvar Model = require('@noodl/runtime/src/model');\r\nconst CloudStore = require('@noodl/runtime/src/api/cloudstore');\r\n\r\nvar modelPortsHash = {},\r\n  previousProperties = {};\r\n\r\nvar ModelNodeDefinition = {\r\n  name: 'DbModel',\r\n  docs: 'https://docs.noodl.net/nodes/cloud-services/model',\r\n  displayNodeName: 'Model',\r\n  shortDesc: 'Database model',\r\n  category: 'Cloud Services',\r\n  usePortAsLabel: '$ndlCollectionName',\r\n  color: 'data',\r\n  deprecated: true, // Use record node\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.inputValues = {};\r\n    internal.relationModelIds = {};\r\n\r\n    var _this = this;\r\n    this._internal.onModelChangedCallback = function (args) {\r\n      if (_this.isInputConnected('fetch')) return;\r\n\r\n      if (_this.hasOutput(args.name)) _this.flagOutputDirty(args.name);\r\n\r\n      if (_this.hasOutput('changed-' + args.name)) _this.sendSignalOnOutput('changed-' + args.name);\r\n\r\n      _this.sendSignalOnOutput('changed');\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return '[No Model]';\r\n\r\n    return [\r\n      { type: 'text', value: 'Id: ' + model.getId() },\r\n      { type: 'value', value: model.data }\r\n    ];\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: 'string',\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.model ? this._internal.model.getId() : this._internal.modelId;\r\n      }\r\n    },\r\n    saved: {\r\n      type: 'signal',\r\n      displayName: 'Saved',\r\n      group: 'Events'\r\n    },\r\n    stored: {\r\n      type: 'signal',\r\n      displayName: 'Stored',\r\n      group: 'Events'\r\n    },\r\n    created: {\r\n      type: 'signal',\r\n      displayName: 'Created',\r\n      group: 'Events'\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    },\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    deleted: {\r\n      type: 'signal',\r\n      displayName: 'Deleted',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Events',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    modelId: {\r\n      type: { name: 'string', allowConnectionsOnly: true },\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value instanceof Model) value = value.getId(); // Can be passed as model as well\r\n        this._internal.modelId = value; // Wait to fetch data\r\n        if (this.isInputConnected('fetch') === false) this.setModelID(value);\r\n        else {\r\n          this.flagOutputDirty('id');\r\n        }\r\n      }\r\n    },\r\n    properties: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      displayName: 'Properties',\r\n      group: 'Properties',\r\n      set: function (value) {}\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleFetch();\r\n      }\r\n    },\r\n    store: {\r\n      displayName: 'Set',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleStore();\r\n      }\r\n    },\r\n    save: {\r\n      displayName: 'Save',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.storageSave();\r\n      }\r\n    },\r\n    delete: {\r\n      displayName: 'Delete',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.storageDelete();\r\n      }\r\n    },\r\n    new: {\r\n      displayName: 'New',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.storageNew();\r\n      }\r\n    },\r\n    insert: {\r\n      displayName: 'Insert',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.storageInsert();\r\n        //  this.storageSave();\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setCollectionID: function (id) {\r\n      this._internal.collectionId = id;\r\n      this.clearWarnings();\r\n    },\r\n    setModelID: function (id) {\r\n      var model = Model.get(id);\r\n      // this._internal.modelIsNew = false;\r\n      this.setModel(model);\r\n    },\r\n    setModel: function (model) {\r\n      if (this._internal.model)\r\n        // Remove old listener if existing\r\n        this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n\r\n      this._internal.model = model;\r\n      this.flagOutputDirty('id');\r\n      model.on('change', this._internal.onModelChangedCallback);\r\n\r\n      // We have a new model, mark all outputs as dirty\r\n      for (var key in model.data) {\r\n        if (this.hasOutput(key)) this.flagOutputDirty(key);\r\n      }\r\n      this.sendSignalOnOutput('fetched');\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      if (this._internal.model) this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n    },\r\n    scheduleOnce: function (type, cb) {\r\n      const _this = this;\r\n      const _type = 'hasScheduled' + type;\r\n      if (this._internal[_type]) return;\r\n      this._internal[_type] = true;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this._internal[_type] = false;\r\n        cb();\r\n      });\r\n    },\r\n    _hasChangesPending: function () {\r\n      const internal = this._internal;\r\n      var model = internal.model;\r\n\r\n      for (var key in internal.inputValues) {\r\n        if (isEqual(model.data[key], internal.inputValues[key])) return true;\r\n      }\r\n\r\n      return false;\r\n    },\r\n    scheduleFetch: function () {\r\n      var _this = this;\r\n      const internal = this._internal;\r\n\r\n      if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n      this.scheduleOnce('Fetch', function () {\r\n        if (internal.modelId === undefined || internal.modelId === '') return; // Don't do fetch if no id\r\n\r\n        CloudStore.instance.fetch({\r\n          collection: internal.collectionId,\r\n          objectId: internal.modelId, // Get the objectId part of the model id\r\n          success: function (response) {\r\n            var model = CloudStore._fromJSON(response, internal.collectionId);\r\n            if (internal.model !== model) {\r\n              // Check if we need to change model\r\n              if (internal.model)\r\n                // Remove old listener if existing\r\n                internal.model.off('change', internal.onModelChangedCallback);\r\n\r\n              internal.model = model;\r\n              model.on('change', internal.onModelChangedCallback);\r\n            }\r\n            _this.flagOutputDirty('id');\r\n\r\n            delete response.objectId;\r\n\r\n            for (var key in response) {\r\n              // model.set(key,response[key]);\r\n\r\n              if (_this.hasOutput(key)) _this.flagOutputDirty(key);\r\n            }\r\n\r\n            _this.sendSignalOnOutput('fetched');\r\n          },\r\n          error: function (err) {\r\n            _this.setError(err || 'Failed to fetch.');\r\n          }\r\n        });\r\n      });\r\n    },\r\n    scheduleStore: function () {\r\n      var _this = this;\r\n      var internal = this._internal;\r\n      if (!internal.model) return;\r\n\r\n      if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n      this.scheduleOnce('Store', function () {\r\n        for (var i in internal.inputValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n        _this.sendSignalOnOutput('stored');\r\n      });\r\n    },\r\n    storageSave: function () {\r\n      const _this = this;\r\n      const internal = this._internal;\r\n\r\n      if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n      //console.log('dbmodel save scheduled')\r\n      this.scheduleOnce('StorageSave', function () {\r\n        if (!internal.model) return;\r\n        var model = internal.model;\r\n        //console.log('dbmodel save hasChanges='+_this._hasChangesPending())\r\n        //if(!_this._internal.modelIsNew && !_this._hasChangesPending()) return; // No need to save, no changes pending\r\n\r\n        for (var i in internal.inputValues) {\r\n          model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n\r\n        CloudStore.instance.save({\r\n          collection: internal.collectionId,\r\n          objectId: model.getId(), // Get the objectId part of the model id\r\n          data: model.data,\r\n          success: function (response) {\r\n            for (var key in response) {\r\n              model.set(key, response[key]);\r\n            }\r\n            //                        _this._internal.modelIsNew = false; // If the model was a new model, it is now saved\r\n            _this.sendSignalOnOutput('saved');\r\n          },\r\n          error: function (err) {\r\n            _this.setError(err || 'Failed to save.');\r\n          }\r\n        });\r\n      });\r\n    },\r\n    storageDelete: function () {\r\n      const _this = this;\r\n      if (!this._internal.model) return;\r\n      const internal = this._internal;\r\n\r\n      if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n      this.scheduleOnce('StorageDelete', function () {\r\n        CloudStore.instance.delete({\r\n          collection: internal.collectionId,\r\n          objectId: internal.model.getId(), // Get the objectId part of the model id,\r\n          success: function () {\r\n            internal.model.notify('delete'); // Notify that this model has been deleted\r\n            _this.sendSignalOnOutput('deleted');\r\n          },\r\n          error: function (err) {\r\n            _this.setError(err || 'Failed to delete.');\r\n          }\r\n        });\r\n      });\r\n    },\r\n    storageInsert: function () {\r\n      const _this = this;\r\n      const internal = this._internal;\r\n\r\n      if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n      this.scheduleOnce('StorageInsert', function () {\r\n        var _data = _this._getModelInitData();\r\n\r\n        CloudStore.instance.create({\r\n          collection: internal.collectionId,\r\n          data: _data,\r\n          success: function (data) {\r\n            // Successfully created\r\n            const m = CloudStore._fromJSON(data, internal.collectionId);\r\n            _this.setModel(m);\r\n            _this.sendSignalOnOutput('created');\r\n            _this.sendSignalOnOutput('saved');\r\n          },\r\n          error: function (err) {\r\n            _this.setError(err || 'Failed to insert.');\r\n          }\r\n        });\r\n      });\r\n    },\r\n    checkWarningsBeforeCloudOp() {\r\n      //clear all errors first\r\n      this.clearWarnings();\r\n\r\n      if (!this._internal.collectionId) {\r\n        this.setError('No collection name specified');\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    },\r\n    setError: function (err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'storage-op-warning', {\r\n          message: err,\r\n          showGlobally: true\r\n        });\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'storage-op-warning');\r\n      }\r\n    },\r\n    onRelationAdd: function (key) {\r\n      const _this = this;\r\n      const internal = this._internal;\r\n\r\n      this.scheduleOnce('StorageAddRelation', function () {\r\n        if (!internal.model) return;\r\n        var model = internal.model;\r\n\r\n        var targetModelId = internal.relationModelIds[key];\r\n        if (targetModelId === undefined) return;\r\n\r\n        CloudStore.instance.addRelation({\r\n          collection: internal.collectionId,\r\n          objectId: model.getId(),\r\n          key: key,\r\n          targetObjectId: targetModelId,\r\n          targetClass: Model.get(targetModelId)._class,\r\n          success: function (response) {\r\n            for (var _key in response) {\r\n              model.set(_key, response[_key]);\r\n            }\r\n\r\n            // Successfully added relation\r\n            _this.sendSignalOnOutput('$relation-added-' + key);\r\n          },\r\n          error: function (err) {\r\n            _this.setError(err || 'Failed to add relation.');\r\n          }\r\n        });\r\n      });\r\n    },\r\n    onRelationRemove: function (key) {\r\n      const _this = this;\r\n      const internal = this._internal;\r\n\r\n      this.scheduleOnce('StorageRemoveRelation', function () {\r\n        if (!internal.model) return;\r\n        var model = internal.model;\r\n\r\n        var targetModelId = internal.relationModelIds[key];\r\n        if (targetModelId === undefined) return;\r\n\r\n        CloudStore.instance.removeRelation({\r\n          collection: internal.collectionId,\r\n          objectId: model.getId(),\r\n          key: key,\r\n          targetObjectId: targetModelId,\r\n          targetClass: Model.get(targetModelId)._class,\r\n          success: function (response) {\r\n            for (var _key in response) {\r\n              model.set(_key, response[_key]);\r\n            }\r\n\r\n            // Successfully removed relation\r\n            _this.sendSignalOnOutput('$relation-removed-' + key);\r\n          },\r\n          error: function (err) {\r\n            _this.setError(err || 'Failed to remove relation.');\r\n          }\r\n        });\r\n      });\r\n    },\r\n    setRelationModelId: function (key, modelId) {\r\n      this._internal.relationModelIds[key] = modelId;\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('$relation-added-'))\r\n        return this.registerOutput(name, {\r\n          getter: function () {\r\n            /** No needed for signals */\r\n          }\r\n        });\r\n\r\n      if (name.startsWith('$relation-removed-'))\r\n        return this.registerOutput(name, {\r\n          getter: function () {\r\n            /** No needed for signals */\r\n          }\r\n        });\r\n\r\n      this.registerOutput(name, {\r\n        getter: userOutputGetter.bind(this, name)\r\n      });\r\n    },\r\n    _getModelInitData: function () {\r\n      var internal = this._internal;\r\n\r\n      var _data = {};\r\n\r\n      // First copy values from inputs\r\n      for (var i in internal.inputValues) {\r\n        _data[i] = internal.inputValues[i];\r\n      }\r\n\r\n      // Then run initialize code\r\n      if (this._internal.modelInitCode) {\r\n        try {\r\n          var initCode = new Function('initialize', this._internal.modelInitCode);\r\n          initCode(function (data) {\r\n            for (var key in data) {\r\n              if (typeof data[key] === 'function') _data[key] = data[key]();\r\n              else _data[key] = data[key];\r\n            }\r\n          });\r\n        } catch (e) {\r\n          console.log('Error while initializing model: ' + e);\r\n        }\r\n      }\r\n\r\n      return _data;\r\n    },\r\n    setModelInitCode: function (code) {\r\n      this._internal.modelInitCode = code;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      var _this = this;\r\n\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      // Relation inputs\r\n      if (name.startsWith('$relation-add-'))\r\n        return this.registerInput(name, {\r\n          set: EdgeTriggeredInput.createSetter({\r\n            valueChangedToTrue: this.onRelationAdd.bind(this, name.substring('$relation-add-'.length))\r\n          })\r\n        });\r\n\r\n      if (name.startsWith('$relation-remove-'))\r\n        return this.registerInput(name, {\r\n          set: EdgeTriggeredInput.createSetter({\r\n            valueChangedToTrue: this.onRelationRemove.bind(this, name.substring('$relation-remove-'.length))\r\n          })\r\n        });\r\n\r\n      if (name.startsWith('$relation-modelid-'))\r\n        return this.registerInput(name, {\r\n          set: this.setRelationModelId.bind(this, name.substring('$relation-modelid-'.length))\r\n        });\r\n\r\n      const dynamicSignals = {};\r\n\r\n      if (dynamicSignals[name])\r\n        return this.registerInput(name, {\r\n          set: EdgeTriggeredInput.createSetter({\r\n            valueChangedToTrue: dynamicSignals[name]\r\n          })\r\n        });\r\n\r\n      const dynamicSetters = {\r\n        $ndlCollectionName: this.setCollectionID.bind(this),\r\n        $ndlModelInitCode: this.setModelInitCode.bind(this)\r\n        //       '$ndlModelValidationCode':this.setModelValidationCode.bind(this),\r\n      };\r\n\r\n      if (dynamicSetters[name])\r\n        return this.registerInput(name, {\r\n          set: dynamicSetters[name]\r\n        });\r\n\r\n      this.registerInput(name, {\r\n        set: userInputSetter.bind(this, name)\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nfunction userOutputGetter(name) {\r\n  /* jshint validthis:true */\r\n  return this._internal.model ? this._internal.model.get(name, { resolve: true }) : undefined;\r\n}\r\n\r\nfunction userInputSetter(name, value) {\r\n  //console.log('dbmodel setter:',name,value)\r\n  /* jshint validthis:true */\r\n  this._internal.inputValues[name] = value;\r\n}\r\n\r\nfunction detectRename(before, after) {\r\n  if (!before || !after) return;\r\n\r\n  if (before.length !== after.length) return; // Must be of same length\r\n\r\n  var res = {};\r\n  for (var i = 0; i < before.length; i++) {\r\n    if (after.indexOf(before[i]) === -1) {\r\n      if (res.before) return; // Can only be one from before that is missing\r\n      res.before = before[i];\r\n    }\r\n\r\n    if (before.indexOf(after[i]) === -1) {\r\n      if (res.after) return; // Only one can be missing,otherwise we cannot match\r\n      res.after = after[i];\r\n    }\r\n  }\r\n\r\n  return res.before && res.after ? res : undefined;\r\n}\r\n\r\nconst defaultStorageInitCode =\r\n  'initialize({\\n' +\r\n  '\\t// Here you can initialize new models\\n' +\r\n  \"\\t//myProperty:'Some init value',\\n\" +\r\n  \"\\t//anotherProperty:function() { return 'Some other value' }\\n\" +\r\n  '})\\n';\r\n\r\n/*const defaultStorageValidateCode = \"validation({\\n\" +\r\n    \"\\t// Here you add validation specifications for your model properties.\\n\" +\r\n    \"\\t//myProperty: { required:true, length:4 },\\n\" +\r\n    \"\\t//anotherProperty: function(value) {\\n\" +\r\n    \"\\t//\\tif(value !== 'someValue) return 'Error message'\\n\" +\r\n    \"\\t//}\\n\" +\r\n    \"})\\n\";*/\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection, dbCollections) {\r\n  var ports = [];\r\n\r\n  // Add value outputs\r\n  var properties = parameters.properties;\r\n  if (properties) {\r\n    properties = properties ? properties.split(',') : undefined;\r\n    for (var i in properties) {\r\n      var p = properties[i];\r\n\r\n      ports.push({\r\n        type: {\r\n          name: '*',\r\n          allowConnectionsOnly: true\r\n        },\r\n        plug: 'input/output',\r\n        group: 'Properties',\r\n        name: p\r\n      });\r\n\r\n      ports.push({\r\n        type: 'signal',\r\n        plug: 'output',\r\n        group: 'Events',\r\n        displayName: 'Changed ' + p,\r\n        name: 'changed-' + p\r\n      });\r\n    }\r\n\r\n    var propertyRenamed = detectRename(previousProperties[nodeId], properties);\r\n    previousProperties[nodeId] = properties;\r\n    if (propertyRenamed) {\r\n      var renamed = {\r\n        plug: 'input/output',\r\n        patterns: ['{{*}}'],\r\n        before: propertyRenamed.before,\r\n        after: propertyRenamed.after\r\n      };\r\n    }\r\n  }\r\n\r\n  ports.push({\r\n    name: '$ndlCollectionName',\r\n    displayName: 'Class',\r\n    group: 'General',\r\n    type: {\r\n      name: 'enum',\r\n      enums:\r\n        dbCollections !== undefined\r\n          ? dbCollections.map((c) => {\r\n              return { value: c.name, label: c.name };\r\n            })\r\n          : [],\r\n      allowEditOnly: true\r\n    },\r\n    plug: 'input'\r\n  });\r\n\r\n  if (parameters.$ndlCollectionName && dbCollections) {\r\n    // Fetch ports from collection keys\r\n    var c = dbCollections.find((c) => c.name === parameters.$ndlCollectionName);\r\n    if (c && c.schema && c.schema.properties) {\r\n      var props = c.schema.properties;\r\n      for (var key in props) {\r\n        var p = props[key];\r\n        if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n        if (p.type === 'Relation') {\r\n          // Ports for adding / removing relation\r\n          ports.push({\r\n            type: 'signal',\r\n            plug: 'input',\r\n            group: key + ' Relation',\r\n            name: '$relation-add-' + key,\r\n            displayName: 'Add',\r\n            editorName: key + ' | Add'\r\n          });\r\n\r\n          ports.push({\r\n            type: 'signal',\r\n            plug: 'input',\r\n            group: key + ' Relation',\r\n            name: '$relation-remove-' + key,\r\n            displayName: 'Remove',\r\n            editorName: key + ' | Remove'\r\n          });\r\n\r\n          ports.push({\r\n            type: { name: 'string', allowConnectionsOnly: true },\r\n            plug: 'input',\r\n            group: key + ' Relation',\r\n            name: '$relation-modelid-' + key,\r\n            displayName: 'Model Id',\r\n            editorName: key + ' | Model Id'\r\n          });\r\n\r\n          ports.push({\r\n            type: 'signal',\r\n            plug: 'output',\r\n            group: key + ' Relation',\r\n            name: '$relation-removed-' + key,\r\n            displayName: 'Removed',\r\n            editorName: key + ' | Removed'\r\n          });\r\n\r\n          ports.push({\r\n            type: 'signal',\r\n            plug: 'output',\r\n            group: key + ' Relation',\r\n            name: '$relation-added-' + key,\r\n            displayName: 'Added',\r\n            editorName: key + ' | Added'\r\n          });\r\n        } else {\r\n          // Other schema type ports\r\n          ports.push({\r\n            type: {\r\n              name: '*',\r\n              allowConnectionsOnly: true\r\n            },\r\n            plug: 'input/output',\r\n            group: 'Properties',\r\n            name: key\r\n          });\r\n\r\n          ports.push({\r\n            type: 'signal',\r\n            plug: 'output',\r\n            group: 'Events',\r\n            displayName: 'Changed ' + key,\r\n            name: 'changed-' + key\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Storage ports\r\n\r\n  ports.push({\r\n    name: '$ndlModelInitCode',\r\n    displayName: 'Initialize',\r\n    group: 'Scripts',\r\n    type: {\r\n      name: 'string',\r\n      allowEditOnly: true,\r\n      codeeditor: 'javascript'\r\n    },\r\n    default: defaultStorageInitCode,\r\n    plug: 'input'\r\n  });\r\n\r\n  /*  ports.push({\r\n        name:'$ndlModelValidationCode',\r\n        displayName: \"Validate\",\r\n        group: \"Storage scripts\",\r\n        \"type\": {\r\n            name: \"string\",\r\n            allowEditOnly: true,\r\n            codeeditor: \"javascript\"\r\n        },\r\n        default: defaultStorageValidateCode,   \r\n        plug:'input'   \r\n      })  */\r\n\r\n  var hash = JSON.stringify(ports);\r\n  if (modelPortsHash[nodeId] !== hash) {\r\n    // Make sure we don't resend the same port data\r\n    modelPortsHash[nodeId] = hash;\r\n    editorConnection.sendDynamicPorts(nodeId, ports, { renamed: renamed });\r\n  }\r\n}\r\n\r\nmodule.exports = {\r\n  node: ModelNodeDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('dbCollections'));\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('dbCollections'));\r\n      });\r\n\r\n      graphModel.on('metadataChanged.dbCollections', function (data) {\r\n        CloudStore.invalidateCollections();\r\n        updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.DbModel', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('DbModel')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\n\r\nvar Model = require('@noodl/runtime/src/model');\r\n\r\n//var previousProperties = {};\r\n\r\nvar ModelNodeDefinition = {\r\n  name: 'Model',\r\n  docs: 'https://docs.noodl.net/nodes/data/object',\r\n  displayNodeName: 'Object',\r\n  shortDesc:\r\n    'Stores any amount of properties and can be used standalone or together with Collections and For Each nodes.',\r\n  category: 'Data',\r\n  usePortAsLabel: 'modelId',\r\n  color: 'data',\r\n  deprecated: true, // Use new model node\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.inputValues = {};\r\n\r\n    var _this = this;\r\n    this._internal.onModelChangedCallback = function (args) {\r\n      if (_this.isInputConnected('fetch') === true) return;\r\n\r\n      if (_this.hasOutput(args.name)) _this.flagOutputDirty(args.name);\r\n\r\n      if (_this.hasOutput('changed-' + args.name)) _this.sendSignalOnOutput('changed-' + args.name);\r\n\r\n      _this.sendSignalOnOutput('changed');\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return '[No Object]';\r\n\r\n    const modelInfo = [{ type: 'text', value: 'Id: ' + model.getId() }];\r\n\r\n    const data = this._internal.model.data;\r\n    return modelInfo.concat(\r\n      Object.keys(data).map((key) => {\r\n        return { type: 'text', value: key + ': ' + data[key] };\r\n      })\r\n    );\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: 'string',\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.model ? this._internal.model.getId() : this._internal.modelId;\r\n      }\r\n    },\r\n    /*  currentModel: {\r\n      type: 'object',\r\n      displayName: 'Object',\r\n      group: 'General',\r\n      getter: function () {\r\n          return this._internal.model;\r\n      }\r\n    },*/\r\n    stored: {\r\n      type: 'signal',\r\n      displayName: 'Stored',\r\n      group: 'Events'\r\n    },\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    },\r\n    created: {\r\n      type: 'signal',\r\n      displayName: 'Created',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  inputs: {\r\n    modelId: {\r\n      type: {\r\n        name: 'string',\r\n        identifierOf: 'ModelName',\r\n        identifierDisplayName: 'Object Ids'\r\n      },\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value instanceof Model) value = value.getId(); // Can be passed as model as well\r\n        this._internal.modelId = value; // Wait to fetch data\r\n        if (this.isInputConnected('fetch') === false) this.setModelID(value);\r\n        else {\r\n          this.flagOutputDirty('id');\r\n        }\r\n      }\r\n    },\r\n    /*  model:{\r\n      type:'object',\r\n      displayName:'Object',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if(value === undefined) return;\r\n        if(value === this._internal.model) return;\r\n\r\n        if(!(value instanceof Model) && typeof value === 'object') {\r\n          // This is a regular JS object, convert to model\r\n          value = Model.create(value);\r\n        }\r\n\r\n        this._internal.modelId = value.getId(); \r\n        if(this.isInputConnected('fetch') === false)\r\n          this.setModelID(this._internal.modelId);\r\n        else {\r\n          this.flagOutputDirty('id');\r\n        }\r\n      }\r\n    },*/\r\n    properties: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      displayName: 'Properties',\r\n      group: 'Properties',\r\n      set: function (value) {}\r\n    },\r\n    new: {\r\n      displayName: 'New',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleNew();\r\n      }\r\n    },\r\n    store: {\r\n      displayName: 'Set',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleStore();\r\n      }\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleSetModel();\r\n      }\r\n    },\r\n    clear: {\r\n      displayName: 'Clear',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        var internal = this._internal;\r\n        if (!internal.model) return;\r\n        for (var i in internal.inputValues) {\r\n          internal.model.set(i, undefined, { resolve: true });\r\n        }\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    scheduleStore: function () {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledStore = false;\r\n        if (!internal.model) return;\r\n\r\n        for (var i in internal.inputValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n        this.sendSignalOnOutput('stored');\r\n      });\r\n    },\r\n    scheduleNew: function () {\r\n      if (this.hasScheduledNew) return;\r\n      this.hasScheduledNew = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledNew = false;\r\n        const newModel = Model.get();\r\n\r\n        for (var i in internal.inputValues) {\r\n          newModel.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n\r\n        this.setModel(newModel);\r\n\r\n        this.sendSignalOnOutput('created');\r\n        this.sendSignalOnOutput('stored');\r\n      });\r\n    },\r\n    scheduleSetModel: function () {\r\n      if (this.hasScheduledSetModel) return;\r\n      this.hasScheduledSetModel = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledSetModel = false;\r\n        this.setModelID(this._internal.modelId);\r\n      });\r\n    },\r\n    setModelID: function (id) {\r\n      var model = Model.get(id);\r\n      this.setModel(model);\r\n      this.sendSignalOnOutput('fetched');\r\n    },\r\n    setModel: function (model) {\r\n      if (this._internal.model)\r\n        // Remove old listener if existing\r\n        this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n\r\n      this._internal.model = model;\r\n      this.flagOutputDirty('id');\r\n      model.on('change', this._internal.onModelChangedCallback);\r\n\r\n      // We have a new model, mark all outputs as dirty\r\n      for (var key in model.data) {\r\n        if (this.hasOutput(key)) this.flagOutputDirty(key);\r\n      }\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      if (this._internal.model) this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerOutput(name, {\r\n        getter: userOutputGetter.bind(this, name)\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      var _this = this;\r\n\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerInput(name, {\r\n        set: userInputSetter.bind(this, name)\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nfunction userOutputGetter(name) {\r\n  /* jshint validthis:true */\r\n  return this._internal.model ? this._internal.model.get(name, { resolve: true }) : undefined;\r\n}\r\n\r\nfunction userInputSetter(name, value) {\r\n  /* jshint validthis:true */\r\n  this._internal.inputValues[name] = value;\r\n\r\n  // Store on change if no connection to store or new\r\n  if (this.isInputConnected('store') === false && this.isInputConnected('new') === false) {\r\n    const model = this._internal.model;\r\n    const valueChanged = model ? model.get(name) !== value : true;\r\n    if (valueChanged) {\r\n      this.scheduleStore();\r\n    }\r\n  }\r\n}\r\n\r\n/*function detectRename(before, after) {\r\n  if (!before || !after) return;\r\n\r\n  if (before.length !== after.length) return; // Must be of same length\r\n\r\n  var res = {}\r\n  for (var i = 0; i < before.length; i++) {\r\n    if (after.indexOf(before[i]) === -1) {\r\n      if (res.before) return; // Can only be one from before that is missing\r\n      res.before = before[i];\r\n    }\r\n\r\n    if (before.indexOf(after[i]) === -1) {\r\n      if (res.after) return; // Only one can be missing,otherwise we cannot match\r\n      res.after = after[i];\r\n    }\r\n  }\r\n\r\n  return (res.before && res.after) ? res : undefined;\r\n}*/\r\n\r\n/*const defaultStorageInitCode = \"initialize({\\n\"+\r\n\"\\t// Here you can initialize new models\\n\"+\r\n\"\\tmyProperty:'Some init value',\\n\"+\r\n\"\\tanotherProperty:function() { return 'Some other value')\\n\"+\r\n\"})\\n\";\r\n\r\nconst defaultStorageValidateCode = \"validation({\\n\"+\r\n\"\\t// Here you add validation specifications for your model properties.\\n\"+\r\n\"\\tmyProperty: { required:true, length:4 },\\n\"+\r\n\"\\tanotherProperty: function(value) {\\n\"+\r\n\"\\t\\tif(value !== 'someValue) return 'Error message'\\n\"+\r\n\"\\t}\\n\"+\r\n\"})\\n\";*/\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection) {\r\n  var ports = [];\r\n\r\n  // Add value outputs\r\n  var properties = parameters.properties;\r\n  if (properties) {\r\n    properties = properties ? properties.split(',') : undefined;\r\n    for (var i in properties) {\r\n      var p = properties[i];\r\n\r\n      ports.push({\r\n        type: {\r\n          name: '*',\r\n          allowConnectionsOnly: true\r\n        },\r\n        plug: 'input/output',\r\n        group: 'Properties',\r\n        name: p\r\n      });\r\n\r\n      ports.push({\r\n        type: 'signal',\r\n        plug: 'output',\r\n        group: 'Changed Events',\r\n        displayName: p + ' Changed',\r\n        name: 'changed-' + p\r\n      });\r\n    }\r\n\r\n    /*  var propertyRenamed = detectRename(previousProperties[nodeId], properties);\r\n    previousProperties[nodeId] = properties;\r\n    if (propertyRenamed) {\r\n      var renamed = {\r\n        plug: 'input/output',\r\n        patterns: ['{{*}}'],\r\n        before: propertyRenamed.before,\r\n        after: propertyRenamed.after\r\n      };\r\n    }*/\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: 'input/output'\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: ModelNodeDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.Model', function (node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection);\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\nconst Model = require('@noodl/runtime/src/model');\r\n\r\nconst VariableNodeDefinition = {\r\n  name: 'Variable',\r\n  docs: 'https://docs.noodl.net/nodes/data/variable',\r\n  category: 'Data',\r\n  usePortAsLabel: 'name',\r\n  color: 'data',\r\n  deprecated: true, // use newvariable instead\r\n  initialize: function () {\r\n    var _this = this;\r\n    var internal = this._internal;\r\n\r\n    this._internal.onModelChangedCallback = function (args) {\r\n      if (!_this.isInputConnected('fetch') && args.name === internal.name) {\r\n        _this.sendSignalOnOutput('changed');\r\n        _this.flagOutputDirty('value');\r\n      }\r\n    };\r\n\r\n    internal.variablesModel = Model.get('--ndl--global-variables');\r\n    internal.variablesModel.on('change', this._internal.onModelChangedCallback);\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal.name) {\r\n      return this._internal.variablesModel.get(this._internal.name);\r\n    }\r\n\r\n    return '[No value set]';\r\n  },\r\n  outputs: {\r\n    name: {\r\n      type: 'string',\r\n      displayName: 'Name',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.name;\r\n      }\r\n    },\r\n    stored: {\r\n      type: 'signal',\r\n      displayName: 'Stored',\r\n      group: 'Events'\r\n    },\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    },\r\n    value: {\r\n      type: '*',\r\n      displayName: 'Value',\r\n      group: 'General',\r\n      getter: function () {\r\n        var internal = this._internal;\r\n        if (!internal.name) return;\r\n\r\n        return internal.variablesModel.get(internal.name);\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    name: {\r\n      type: {\r\n        name: 'string',\r\n        identifierOf: 'VariableName',\r\n        identifierDisplayName: 'Variable names'\r\n      },\r\n      displayName: 'Name',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (this.isInputConnected('fetch') === false) this.setVariableName(value);\r\n        else {\r\n          this._internal.name = value; // Wait to fetch data\r\n          this.flagOutputDirty('name');\r\n        }\r\n      }\r\n    },\r\n    store: {\r\n      displayName: 'Set',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleStore();\r\n      }\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.setVariableName(this._internal.name);\r\n      }\r\n    },\r\n    value: {\r\n      type: '*',\r\n      displayName: 'Value',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.value = value;\r\n        if (this.isInputConnected('store') === false) {\r\n          this.scheduleStore();\r\n        }\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    scheduleStore: function () {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        this.hasScheduledStore = false;\r\n\r\n        internal.variablesModel.set(internal.name, internal.value);\r\n        this.sendSignalOnOutput('stored');\r\n      });\r\n    },\r\n    setVariableName: function (name) {\r\n      this._internal.name = name;\r\n      this.flagOutputDirty('name');\r\n      this.flagOutputDirty('value');\r\n      this.sendSignalOnOutput('fetched');\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this._internal.variablesModel.off('change', this._internal.onModelChangedCallback);\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: VariableNodeDefinition\r\n};\r\n","'use strict';\r\nconst { Node } = require('@noodl/runtime');\r\n\r\nconst GlobalsNode = {\r\n  name: 'Globals',\r\n  shortDesc: 'A node used to communicate values across the project.',\r\n  category: 'Utilities',\r\n  color: 'component',\r\n  deprecated: true, // use variable instead\r\n  initialize: function () {\r\n    this._internal.listeners = [];\r\n  },\r\n  panels: [\r\n    {\r\n      name: 'PortEditor',\r\n      context: ['select', 'connectTo', 'connectFrom'],\r\n      title: 'Globals',\r\n      plug: 'input/output',\r\n      type: {\r\n        name: '*'\r\n      }\r\n    }\r\n  ],\r\n  prototypeExtensions: {\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      var globalsEmitter = this.context.globalsEventEmitter;\r\n\r\n      for (var i = 0; i < this._internal.listeners.length; i++) {\r\n        var listener = this._internal.listeners[i];\r\n        globalsEmitter.removeListener(listener.name, listener.listener);\r\n      }\r\n      this._internal.listeners = [];\r\n    },\r\n    _newOutputValueReceived: {\r\n      value: function (name) {\r\n        this._cachedInputValues[name] = this.context.globalValues[name];\r\n        this.flagOutputDirty(name);\r\n      }\r\n    },\r\n    registerInputIfNeeded: {\r\n      value: function (name) {\r\n        var self = this;\r\n\r\n        if (this.hasInput(name)) {\r\n          return;\r\n        }\r\n        this.registerInput(name, {\r\n          set: self.context.setGlobalValue.bind(self.context, name)\r\n        });\r\n      }\r\n    },\r\n    registerOutputIfNeeded: {\r\n      value: function (name) {\r\n        if (this.hasOutput(name)) {\r\n          return;\r\n        }\r\n\r\n        var newOutputValueReceivedCallback = this._newOutputValueReceived.bind(this, name);\r\n\r\n        var globalsEmitter = this.context.globalsEventEmitter;\r\n\r\n        this._internal.listeners.push({\r\n          name: name,\r\n          listener: newOutputValueReceivedCallback\r\n        });\r\n\r\n        globalsEmitter.on(name, newOutputValueReceivedCallback);\r\n\r\n        this.registerOutput(name, {\r\n          getter: function () {\r\n            return this.context.globalValues[name];\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: GlobalsNode\r\n};\r\n","'use strict';\r\n\r\nconst GyroscopeNode = {\r\n  name: 'Gyroscope',\r\n  docs: 'https://docs.noodl.net/nodes/sensors/device-orientation',\r\n  shortDesc: 'The orientation of a device. Works on phones, tablets and other devices with the required sensors.',\r\n  displayNodeName: 'Device Orientation',\r\n  category: 'Sensors',\r\n  deprecated: true,\r\n  initialize: function () {\r\n    this._internal.alpha = 0;\r\n    this._internal.beta = 0;\r\n    this._internal.gamma = 0;\r\n\r\n    var onEvent = onDeviceOrientation.bind(this);\r\n    window.addEventListener('deviceorientation', onEvent);\r\n    this.context.eventEmitter.once('applicationDataReloaded', function () {\r\n      window.removeEventListener('deviceorientation', onEvent);\r\n    });\r\n  },\r\n  outputs: {\r\n    rotationX: {\r\n      type: 'number',\r\n      displayName: 'Rotation X',\r\n      getter: function () {\r\n        return -this._internal.beta;\r\n      }\r\n    },\r\n    rotationY: {\r\n      type: 'number',\r\n      displayName: 'Rotation Y',\r\n      getter: function () {\r\n        return this._internal.gamma;\r\n      }\r\n    },\r\n    rotationZ: {\r\n      type: 'number',\r\n      displayName: 'Rotation Z',\r\n      getter: function () {\r\n        return -this._internal.alpha;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nfunction onDeviceOrientation(event) {\r\n  /* jshint validthis:true */\r\n  if (event.alpha !== this._internal.alpha) {\r\n    this._internal.alpha = event.alpha;\r\n    this.flagOutputDirty('rotationZ');\r\n  }\r\n  if (event.beta !== this._internal.beta) {\r\n    this._internal.beta = event.beta;\r\n    this.flagOutputDirty('rotationX');\r\n  }\r\n  if (event.gamma !== this._internal.gamma) {\r\n    this._internal.gamma = event.gamma;\r\n    this.flagOutputDirty('rotationY');\r\n  }\r\n}\r\n\r\nmodule.exports = {\r\n  node: GyroscopeNode\r\n};\r\n","'use strict';\r\n\r\nconst EaseCurves = require('../../easecurves');\r\n\r\nconst NumberBlend = {\r\n  name: 'Number Blend',\r\n  docs: 'https://docs.noodl.net/nodes/interpolation/number-blend',\r\n  shortDesc: 'Computes a result output based on blending (linearly interpolating) between the inputs.',\r\n  category: 'Interpolation',\r\n  deprecated: true,\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.inputs = [];\r\n    internal.blendValue = 0;\r\n    internal.result = 0;\r\n    internal.clamp = false;\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.result;\r\n  },\r\n  prototypeExtensions: {\r\n    updateResult: function () {\r\n      var inputs = this._internal.inputs;\r\n\r\n      if (inputs.length === 0) {\r\n        return 0;\r\n      }\r\n\r\n      var index = Math.floor(this._internal.blendValue),\r\n        t = this._internal.blendValue - index;\r\n\r\n      if (index >= inputs.length - 1) {\r\n        if (this._internal.clamp) {\r\n          index = inputs.length - 1;\r\n          t = 0;\r\n        } else {\r\n          t += index - (inputs.length - 1);\r\n          index = inputs.length - 1;\r\n        }\r\n      } else if (index <= 0) {\r\n        if (this._internal.clamp) {\r\n          index = 0;\r\n          t = 0;\r\n        } else {\r\n          t += index;\r\n          index = 0;\r\n        }\r\n      }\r\n\r\n      if (t === 0 || inputs.length === 1) {\r\n        this._internal.result = inputs[index];\r\n      } else if (index === inputs.length - 1 && t > 0) {\r\n        this._internal.result = EaseCurves.linear(inputs[index - 1], inputs[index], t + 1);\r\n      } else {\r\n        this._internal.result = EaseCurves.linear(inputs[index], inputs[index + 1], t);\r\n      }\r\n\r\n      this.flagOutputDirty('result');\r\n    }\r\n  },\r\n  numberedInputs: {\r\n    input: {\r\n      type: 'number',\r\n      displayPrefix: 'Number',\r\n      createSetter(index) {\r\n        return function (value) {\r\n          const inputs = this._internal.inputs;\r\n\r\n          if (inputs[index] === value) {\r\n            return;\r\n          }\r\n\r\n          inputs[index] = value || 0;\r\n          this.updateResult();\r\n        };\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    blendValue: {\r\n      type: 'number',\r\n      displayName: 'Blend Value',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal.blendValue = value;\r\n        this.updateResult();\r\n      }\r\n    },\r\n    clamp: {\r\n      type: 'boolean',\r\n      displayName: 'Clamp',\r\n      default: false,\r\n      set: function (value) {\r\n        this._internal.clamp = value ? true : false;\r\n        this.updateResult();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: 'number',\r\n      displayName: 'Result',\r\n      getter: function () {\r\n        return this._internal.result;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: NumberBlend\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\nconst Model = require('@noodl/runtime/src/model');\r\nconst EventEmitter = require('events').EventEmitter;\r\n\r\nconst graphEventEmitter = new EventEmitter();\r\ngraphEventEmitter.setMaxListeners(1000000);\r\n\r\nconst ParentComponentState = {\r\n  name: 'Parent Component State',\r\n  displayNodeName: 'Parent Component Object',\r\n  category: 'Component Utilities',\r\n  color: 'component',\r\n  docs: 'https://docs.noodl.net/nodes/component-utilities/parent-component-object',\r\n  deprecated: true,\r\n  initialize() {\r\n    this._internal.inputValues = {};\r\n\r\n    this._internal.onModelChangedCallback = (args) => {\r\n      if (this.isInputConnected('fetch') === true) return;\r\n\r\n      if (this.hasOutput(args.name)) {\r\n        this.flagOutputDirty(args.name);\r\n      }\r\n\r\n      if (this.hasOutput('changed-' + args.name)) {\r\n        this.sendSignalOnOutput('changed-' + args.name);\r\n      }\r\n\r\n      this.sendSignalOnOutput('changed');\r\n    };\r\n\r\n    //TODO: don't listen for delta updates when running deployed\r\n    this.onComponentStateNodesChanged = () => {\r\n      const id = this.findParentComponentStateModelId();\r\n\r\n      if (this._internal.modelId !== id) {\r\n        this._internal.modelId = id;\r\n\r\n        if (this.isInputConnected('fetch') === false) {\r\n          this.setModelId(this._internal.modelId);\r\n        }\r\n      }\r\n    };\r\n\r\n    graphEventEmitter.on('componentStateNodesChanged', this.onComponentStateNodesChanged);\r\n\r\n    this.updateComponentState();\r\n  },\r\n  //to search up the tree the root nodes in this component must have been initialized\r\n  //we also need the connections to be setup so we can use isInputConnected\r\n  //nodeScopeDidInitialize takes care of that\r\n  nodeScopeDidInitialize() {\r\n    //FIXME: temporary hack. Our parent's node scope might not have finished created yet\r\n    //so just wait until after this update. It'll make the parent component state\r\n    //have a delay in propagating outputs which can cause subtle bugs.\r\n    //The fix is to call this code when the entire node tree has been created,\r\n    //before running updating the next update.\r\n    if (!this._internal.modelId) {\r\n      this.context.scheduleAfterUpdate(() => {\r\n        this.updateComponentState();\r\n      });\r\n    }\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return 'No parent component state found';\r\n\r\n    const modelInfo = [{ type: 'text', value: this._internal.parentComponentName }];\r\n\r\n    const data = this._internal.model.data;\r\n    return modelInfo.concat(\r\n      Object.keys(data).map((key) => {\r\n        return { type: 'text', value: key + ': ' + data[key] };\r\n      })\r\n    );\r\n  },\r\n  inputs: {\r\n    properties: {\r\n      type: {\r\n        name: 'stringlist',\r\n        allowEditOnly: true\r\n      },\r\n      displayName: 'Properties',\r\n      group: 'Properties',\r\n      set(value) {}\r\n    },\r\n    store: {\r\n      displayName: 'Set',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleStore();\r\n      }\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.setModelId(this._internal.modelId);\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    },\r\n    stored: {\r\n      type: 'signal',\r\n      displayName: 'Stored',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  methods: {\r\n    updateComponentState() {\r\n      this._internal.modelId = this.findParentComponentStateModelId();\r\n      if (this.isInputConnected('fetch') === false) {\r\n        this.setModelId(this._internal.modelId);\r\n      }\r\n    },\r\n    findParentComponentStateModelId() {\r\n      function getParentComponent(component) {\r\n        let parent;\r\n        if (component.getRoots().length > 0) {\r\n          //visual\r\n          const root = component.getRoots()[0];\r\n\r\n          if (root.getVisualParentNode) {\r\n            //regular visual node\r\n            if (root.getVisualParentNode()) {\r\n              parent = root.getVisualParentNode().nodeScope.componentOwner;\r\n            }\r\n          } else if (root.parentNodeScope) {\r\n            //component instance node\r\n            parent = component.parentNodeScope.componentOwner;\r\n          }\r\n        } else if (component.parentNodeScope) {\r\n          parent = component.parentNodeScope.componentOwner;\r\n        }\r\n\r\n        //check that a parent exists and that the component is different\r\n        if (parent && parent.nodeScope && parent.nodeScope.componentOwner !== component) {\r\n          //check if parent has a Component State node\r\n          if (parent.nodeScope.getNodesWithType('Component State').length > 0) {\r\n            return parent;\r\n          }\r\n\r\n          //if not, continue searching up the tree\r\n          return getParentComponent(parent);\r\n        }\r\n      }\r\n\r\n      const parent = getParentComponent(this.nodeScope.componentOwner);\r\n      if (!parent) return;\r\n\r\n      this._internal.parentComponentName = parent.name;\r\n\r\n      return 'componentState' + parent.getInstanceId();\r\n    },\r\n    setModelId(id) {\r\n      this._internal.model && this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n      this._internal.model = undefined;\r\n\r\n      if (!id) return;\r\n\r\n      const model = Model.get(id);\r\n      this._internal.model = model;\r\n\r\n      model.on('change', this._internal.onModelChangedCallback);\r\n\r\n      for (var key in model.data) {\r\n        if (this.hasOutput(key)) {\r\n          this.flagOutputDirty(key);\r\n        }\r\n        if (this.hasOutput('changed-' + key)) {\r\n          this.sendSignalOnOutput('changed-' + key);\r\n        }\r\n      }\r\n\r\n      this.sendSignalOnOutput('changed');\r\n      this.sendSignalOnOutput('fetched');\r\n    },\r\n    scheduleStore() {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledStore = false;\r\n        if (!internal.model) return;\r\n        for (var i in internal.inputValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n        this.sendSignalOnOutput('stored');\r\n      });\r\n    },\r\n    _onNodeDeleted() {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n\r\n      graphEventEmitter.off('componentStateNodesChanged', this.onComponentStateNodesChanged);\r\n      this._internal.model && this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n    },\r\n    registerOutputIfNeeded(name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerOutput(name, {\r\n        get() {\r\n          if (!this._internal.model) return undefined;\r\n          return this._internal.model.get(name, { resolve: true });\r\n        }\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerInput(name, {\r\n        set(value) {\r\n          this._internal.inputValues[name] = value;\r\n\r\n          if (this.isInputConnected('store') === false)\r\n            // Lazy set\r\n            this.scheduleStore();\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection) {\r\n  const ports = [];\r\n\r\n  // Add value outputs\r\n  var properties = parameters.properties && parameters.properties.split(',');\r\n  for (var i in properties) {\r\n    var p = properties[i];\r\n\r\n    ports.push({\r\n      type: {\r\n        name: '*', //parameters['type-' + p] || 'string',\r\n        allowConnectionsOnly: true\r\n      },\r\n      plug: 'input/output',\r\n      group: 'Properties',\r\n      name: p,\r\n      displayName: p\r\n    });\r\n\r\n    ports.push({\r\n      type: 'signal',\r\n      plug: 'output',\r\n      group: 'Changed Events',\r\n      displayName: p + ' Changed',\r\n      name: 'changed-' + p\r\n    });\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: 'input/output'\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: ParentComponentState,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.Parent Component State', (node) => {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n      node.on('parameterUpdated', (event) => {\r\n        updatePorts(node.id, node.parameters, context.editorConnection);\r\n      });\r\n    });\r\n\r\n    //TODO: handle additional delta update event:\r\n    // - visual parent changed\r\n\r\n    //this are the same events that'll create and delete the Comopent State instance node\r\n    //it might not have had a chance to run yet if we're first in the event list, so\r\n    //use a setTimeout\r\n    graphModel.on('nodeAdded.Component State', (node) => {\r\n      setTimeout(() => {\r\n        graphEventEmitter.emit('componentStateNodesChanged');\r\n      }, 0);\r\n    });\r\n    graphModel.on('nodeRemoved.Component State', (node) => {\r\n      setTimeout(() => {\r\n        graphEventEmitter.emit('componentStateNodesChanged');\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst ScriptDownloadDefinition = {\r\n  name: 'Script Downloader',\r\n  docs: 'https://docs.noodl.net/nodes/javascript/script-downloader',\r\n  shortDesc: 'Script Downloader allows you load external Javascript libraries. ',\r\n  category: 'Javascript',\r\n  color: 'javascript',\r\n  deprecated: true,\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.loaded = false;\r\n    internal.scripts = [];\r\n    internal.loadedScripts = {};\r\n    internal.startLoad = true;\r\n  },\r\n  inputs: {\r\n    startLoad: {\r\n      type: 'boolean',\r\n      default: true,\r\n      displayName: 'Load on start',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.startLoad = value;\r\n      }\r\n    },\r\n    load: {\r\n      displayName: 'Load',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleUpdateScripts();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    loaded: {\r\n      type: 'signal',\r\n      displayName: 'Loaded'\r\n    }\r\n  },\r\n  numberedInputs: {\r\n    input: {\r\n      displayPrefix: 'Script',\r\n      group: 'External scripts',\r\n      type: 'string',\r\n      index: 3008,\r\n      createSetter: function (index) {\r\n        return function (value) {\r\n          value = value.toString();\r\n          this._internal.scripts[index] = value;\r\n\r\n          if (!this._internal.loadStarted) {\r\n            this._internal.loadStarted = true;\r\n            this.scheduleAfterInputsHaveUpdated(function () {\r\n              this._internal.loadStarted = false;\r\n\r\n              if (!this._internal.startLoad) {\r\n                return;\r\n              }\r\n\r\n              this.updateScripts();\r\n            });\r\n          }\r\n        };\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    removeLoadTerminator: function () {\r\n      var terminatorId = 'sentinel_' + this.id;\r\n      var elem = document.getElementById(terminatorId);\r\n      if (elem && elem.parentNode) {\r\n        elem.parentNode.removeChild(elem);\r\n      }\r\n    },\r\n    scheduleUpdateScripts: function () {\r\n      const _this = this;\r\n\r\n      if (!this._internal.updateScriptsScheduled) {\r\n        this._internal.updateScriptsScheduled = true;\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          _this._internal.updateScriptsScheduled = false;\r\n\r\n          _this.updateScripts();\r\n        });\r\n      }\r\n    },\r\n    updateScripts: function () {\r\n      var terminatorId = 'sentinel_' + this.id;\r\n\r\n      this.removeLoadTerminator();\r\n      var scripts = this._internal.scripts;\r\n      scripts = scripts.filter(function (script) {\r\n        return script !== '';\r\n      });\r\n\r\n      var scriptElements = document.head.getElementsByTagName('script');\r\n      var scriptsInHead = {};\r\n      for (var i = 0; i < scriptElements.length; i++) {\r\n        var script = scriptElements[i];\r\n        if (script.src !== undefined && script.src !== '') {\r\n          scriptsInHead[script.src] = script;\r\n        }\r\n      }\r\n\r\n      for (var i = 0; i < scripts.length; i++) {\r\n        var script = scripts[i].trim();\r\n\r\n        if (!this._internal.loadedScripts.hasOwnProperty(script)) {\r\n          if (scriptsInHead.hasOwnProperty(script)) {\r\n            continue;\r\n          }\r\n\r\n          var scriptObj = document.createElement('script');\r\n          var _this = this;\r\n          scriptObj.src = script;\r\n          scriptObj.async = false;\r\n          document.head.appendChild(scriptObj);\r\n        }\r\n      }\r\n\r\n      var self = this;\r\n      var onLoadedScript = document.createElement('script');\r\n      onLoadedScript.onload = onLoadedScript.onreadystatechange = function (script) {\r\n        if (!this.readyState || this.readyState === 'loaded' || this.readyState === 'complete') {\r\n          self._internal.loaded = true;\r\n          self.sendSignalOnOutput('loaded');\r\n          self.removeLoadTerminator();\r\n        }\r\n      };\r\n\r\n      // Since all scripts are downloaded synchronously, this will be loaded last and\r\n      // signals that the others are done loading.\r\n      onLoadedScript.id = terminatorId;\r\n      onLoadedScript.src = 'load_terminator.js';\r\n      onLoadedScript.async = false;\r\n      document.head.appendChild(onLoadedScript);\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: ScriptDownloadDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst { EdgeTriggeredInput } = require('@noodl/runtime');\r\n\r\nconst SignalToIndexNode = {\r\n  name: 'Signal To Index',\r\n  docs: 'https://docs.noodl.net/nodes/logic/signal-to-index',\r\n  shortDesc: 'Maps signal inputs to their index value.',\r\n  category: 'Logic',\r\n  deprecated: true,\r\n  initialize: function () {\r\n    this._internal.currentIndex = 0;\r\n  },\r\n  getInspectInfo() {\r\n    return 'Index: ' + this._internal.currentIndex;\r\n  },\r\n  numberedInputs: {\r\n    input: {\r\n      type: 'boolean',\r\n      displayPrefix: 'Signal',\r\n      createSetter: function (index) {\r\n        return EdgeTriggeredInput.createSetter({\r\n          valueChangedToTrue: this.onValueChangedToTrue.bind(this, index)\r\n        });\r\n      },\r\n      selectors: {\r\n        startIndex: {\r\n          displayName: 'Start Index',\r\n          set: function (index) {\r\n            this._internal.currentIndex = index;\r\n            this.flagOutputDirty('index');\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    index: {\r\n      displayName: 'Index',\r\n      type: 'number',\r\n      getter: function () {\r\n        return this._internal.currentIndex;\r\n      }\r\n    },\r\n    signalTriggered: {\r\n      displayName: 'Signal Triggered',\r\n      type: 'signal'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    onValueChangedToTrue: function (index) {\r\n      this.sendSignalOnOutput('signalTriggered');\r\n\r\n      if (this._internal.currentIndex === index) {\r\n        return;\r\n      }\r\n\r\n      this._internal.currentIndex = index;\r\n      this.flagOutputDirty('index');\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: SignalToIndexNode\r\n};\r\n","'use strict';\r\n\r\nconst StringSelectorNode = {\r\n  name: 'String Selector',\r\n  displayNodeName: 'Index To String',\r\n  shortDesc: 'Choose between multiple strings.',\r\n  category: 'Utilities',\r\n  deprecated: true,\r\n  initialize: function () {\r\n    this._internal.inputs = [];\r\n    this._internal.currentSelectedIndex = 0;\r\n    this._internal.indexChanged = false;\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.inputs[this._internal.currentSelectedIndex];\r\n  },\r\n  numberedInputs: {\r\n    input: {\r\n      type: 'string',\r\n      displayPrefix: 'String for ',\r\n      group: 'Inputs',\r\n      createSetter: function (index) {\r\n        return function (value) {\r\n          value = value ? value.toString() : '';\r\n          this._internal.inputs[index] = value;\r\n          if (this._internal.currentSelectedIndex === index) {\r\n            this.flagOutputDirty('currentValue');\r\n          }\r\n        };\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    index: {\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      displayName: 'Index',\r\n      default: 0,\r\n      set: function (value) {\r\n        value = value | 0;\r\n\r\n        this._internal.currentSelectedIndex = value;\r\n        this.flagOutputDirty('currentValue');\r\n        this.sendSignalOnOutput('indexChanged');\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    currentValue: {\r\n      type: 'string',\r\n      displayName: 'Current Value',\r\n      group: 'Value',\r\n      getter: function () {\r\n        return this._internal.inputs[this._internal.currentSelectedIndex];\r\n      }\r\n    },\r\n    indexChanged: {\r\n      type: 'signal',\r\n      displayName: 'Index Changed',\r\n      group: 'Signals'\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: StringSelectorNode\r\n};\r\n","'use strict';\r\n\r\nvar EaseCurves = require('../../easecurves');\r\n\r\nvar defaultDuration = 300;\r\n\r\nvar TransitionNode = {\r\n  name: 'Transition',\r\n  docs: 'https://docs.noodl.net/nodes/animation/transition',\r\n  shortDesc: 'This node can interpolate smooothely for the current value to a target value.',\r\n  category: 'Animation',\r\n  deprecated: true,\r\n  initialize: function () {\r\n    var self = this,\r\n      _internal = this._internal;\r\n\r\n    _internal.currentNumber = 0;\r\n    _internal.numberInitialized = false;\r\n    _internal.animationStarted = false;\r\n    _internal.setCurrentNumberEnabled = false;\r\n    _internal.overrideValue = 0;\r\n\r\n    _internal._animation = this.context.timerScheduler.createTimer({\r\n      duration: defaultDuration,\r\n      startValue: 0,\r\n      endValue: 0,\r\n      ease: EaseCurves.easeOut,\r\n      onStart: function () {\r\n        _internal.animationStarted = true;\r\n      },\r\n      onRunning: function (t) {\r\n        _internal.currentNumber = this.ease(this.startValue, this.endValue, t);\r\n        self.flagOutputDirty('currentValue');\r\n      },\r\n      onFinish: function () {\r\n        self.sendSignalOnOutput('atTargetValue');\r\n      }\r\n    });\r\n  },\r\n  inputs: {\r\n    targetValue: {\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      displayName: 'Target Value',\r\n      group: 'Target Value',\r\n      default: undefined, //default is undefined so transition initializes to the first input value\r\n      set: function (value) {\r\n        if (value === true) {\r\n          value = 1;\r\n        } else if (value === false) {\r\n          value = 0;\r\n        }\r\n\r\n        value = Number(value);\r\n\r\n        if (isNaN(value)) {\r\n          //bail out on NaN values\r\n          return;\r\n        }\r\n\r\n        var internal = this._internal;\r\n\r\n        if (internal.numberInitialized === false) {\r\n          internal.currentNumber = value;\r\n          internal.numberInitialized = true;\r\n          internal._animation.endValue = value;\r\n          this.flagOutputDirty('currentValue');\r\n          return;\r\n        } else if (value === internal._animation.endValue) {\r\n          //same as previous value\r\n          return;\r\n        }\r\n\r\n        internal._animation.startValue = internal.currentNumber;\r\n        internal._animation.endValue = value;\r\n        internal._animation.start();\r\n      }\r\n    },\r\n    'overrideCurrentValue.value': {\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      group: 'Override Value',\r\n      displayName: 'Override Value',\r\n      editorName: 'Value|Override Value',\r\n      set: function (value) {\r\n        this._internal.overrideValue = value;\r\n      }\r\n    },\r\n    'overrideCurrentValue.do': {\r\n      group: 'Override Value',\r\n      displayName: 'Do',\r\n      editorName: 'Do|Override Value',\r\n      valueChangedToTrue: function () {\r\n        setCurrentNumber.call(this, this._internal.overrideValue);\r\n      }\r\n    },\r\n    duration: {\r\n      type: 'number',\r\n      group: 'Parameters',\r\n      displayName: 'Duration',\r\n      default: defaultDuration,\r\n      set: function (value) {\r\n        this._internal._animation.duration = value;\r\n      }\r\n    },\r\n    delay: {\r\n      type: 'number',\r\n      group: 'Parameters',\r\n      displayName: 'Delay',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal._animation.delay = value;\r\n      }\r\n    },\r\n    easingCurve: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { value: 'easeOut', label: 'Ease Out' },\r\n          { value: 'easeIn', label: 'Ease In' },\r\n          { value: 'linear', label: 'Linear' },\r\n          { value: 'easeInOut', label: 'Ease In Out' }\r\n        ]\r\n      },\r\n      default: 'easeOut',\r\n      displayName: 'Easing Curve',\r\n      group: 'Parameters',\r\n      set: function (value) {\r\n        this._internal._animation.ease = EaseCurves[value];\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    currentValue: {\r\n      type: 'number',\r\n      displayName: 'Current Value',\r\n      group: 'Current State',\r\n      getter: function () {\r\n        return this._internal.currentNumber;\r\n      }\r\n    },\r\n    atTargetValue: {\r\n      type: 'signal',\r\n      displayName: 'At Target Value',\r\n      group: 'Signals'\r\n    }\r\n  }\r\n};\r\n\r\nfunction setCurrentNumber(value) {\r\n  /* jshint validthis:true */\r\n  var animation = this._internal._animation;\r\n\r\n  animation.stop();\r\n  animation.startValue = value;\r\n\r\n  //wait until all values are set until checking if animation needs to be started\r\n  this.scheduleAfterInputsHaveUpdated(function () {\r\n    if (animation.endValue !== value) {\r\n      animation.start();\r\n    }\r\n  });\r\n  this._internal.currentNumber = value;\r\n  this.flagOutputDirty('currentValue');\r\n}\r\n\r\nmodule.exports = {\r\n  node: TransitionNode\r\n};\r\n","const { EdgeTriggeredInput } = require('@noodl/runtime');\r\n\r\nconst ClosePopupNode = {\r\n  name: 'NavigationClosePopup',\r\n  displayNodeName: 'Close Popup',\r\n  category: 'Navigation',\r\n  docs: 'https://docs.noodl.net/nodes/popups/close-popup',\r\n  initialize: function () {\r\n    this._internal.resultValues = {};\r\n  },\r\n  inputs: {\r\n    results: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      group: 'Results',\r\n      set: function (value) {\r\n        this._internal.results = value;\r\n      }\r\n    },\r\n    closeActions: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      group: 'Close Actions',\r\n      set: function (value) {\r\n        this._internal.closeActions = value;\r\n      }\r\n    },\r\n    close: {\r\n      type: 'Signal',\r\n      displayName: 'Close',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleClose();\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setResultValue: function (key, value) {\r\n      this._internal.resultValues[key] = value;\r\n    },\r\n    _setCloseCallback: function (cb) {\r\n      this._internal.closeCallback = cb;\r\n    },\r\n    scheduleClose: function () {\r\n      const _this = this;\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledClose) {\r\n        internal.hasScheduledClose = true;\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          internal.hasScheduledClose = false;\r\n          _this.close();\r\n        });\r\n      }\r\n    },\r\n    close: function () {\r\n      if (this._internal.closeCallback) {\r\n        this._internal.closeCallback(this._internal.closeAction, this._internal.resultValues);\r\n      }\r\n    },\r\n    closeActionTriggered: function (name) {\r\n      this._internal.closeAction = name;\r\n      this.scheduleClose();\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('result-'))\r\n        return this.registerInput(name, {\r\n          set: this.setResultValue.bind(this, name.substring('result-'.length))\r\n        });\r\n\r\n      if (name.startsWith('closeAction-'))\r\n        return this.registerInput(name, {\r\n          set: EdgeTriggeredInput.createSetter({\r\n            valueChangedToTrue: this.closeActionTriggered.bind(this, name)\r\n          })\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: ClosePopupNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _updatePorts() {\r\n        var ports = [];\r\n\r\n        // Add results inputs\r\n        var results = node.parameters['results'];\r\n        if (results) {\r\n          results = results ? results.split(',') : undefined;\r\n          for (var i in results) {\r\n            var p = results[i];\r\n\r\n            ports.push({\r\n              type: {\r\n                name: '*'\r\n              },\r\n              plug: 'input',\r\n              group: 'Results',\r\n              name: 'result-' + p,\r\n              displayName: p\r\n            });\r\n          }\r\n        }\r\n\r\n        // Add close actions\r\n        var closeActions = node.parameters['closeActions'];\r\n        if (closeActions) {\r\n          closeActions = closeActions ? closeActions.split(',') : undefined;\r\n          for (const i in closeActions) {\r\n            const p = closeActions[i];\r\n            ports.push({\r\n              type: 'signal',\r\n              plug: 'input',\r\n              group: 'Close Actions',\r\n              name: 'closeAction-' + p,\r\n              displayName: p\r\n            });\r\n          }\r\n        }\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on('parameterUpdated', function (event) {\r\n        if (event.name === 'results' || event.name === 'closeActions') {\r\n          _updatePorts();\r\n        }\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.NavigationClosePopup', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('NavigationClosePopup')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","const NavigateBack = {\r\n  name: 'PageStackNavigateBack',\r\n  displayNodeName: 'Pop Component Stack',\r\n  category: 'Navigation',\r\n  docs: 'https://docs.noodl.net/nodes/component-stack/pop-component',\r\n  inputs: {\r\n    navigate: {\r\n      displayName: 'Navigate',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleNavigate();\r\n      }\r\n    },\r\n    results: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      group: 'Results',\r\n      set: function (value) {\r\n        this._internal.results = value;\r\n      }\r\n    },\r\n    backActions: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      group: 'Back Actions',\r\n      set: function (value) {\r\n        this._internal.backActions = value;\r\n      }\r\n    }\r\n  },\r\n  initialize: function () {\r\n    this._internal.resultValues = {};\r\n  },\r\n  methods: {\r\n    scheduleNavigate: function () {\r\n      var _this = this;\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledNavigate) {\r\n        internal.hasScheduledNavigate = true;\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          internal.hasScheduledNavigate = false;\r\n          _this.navigate();\r\n        });\r\n      }\r\n    },\r\n    _setBackCallback(cb) {\r\n      this._internal.backCallback = cb;\r\n    },\r\n    navigate() {\r\n      if (this._internal.backCallback === undefined) return;\r\n\r\n      this._internal.backCallback({\r\n        backAction: this._internal.backAction,\r\n        results: this._internal.resultValues\r\n      });\r\n    },\r\n    setResultValue: function (key, value) {\r\n      this._internal.resultValues[key] = value;\r\n    },\r\n    backActionTriggered: function (name) {\r\n      this._internal.backAction = name;\r\n      this.scheduleNavigate();\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('result-')) {\r\n        return this.registerInput(name, {\r\n          set: this.setResultValue.bind(this, name.substring('result-'.length))\r\n        });\r\n      }\r\n\r\n      if (name.startsWith('backAction-')) {\r\n        return this.registerInput(name, {\r\n          set: (value) => {\r\n            value && this.backActionTriggered(name)\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nfunction setup(context, graphModel) {\r\n  if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node) {\r\n    function _updatePorts() {\r\n      var ports = [];\r\n\r\n      // Add results inputs\r\n      var results = node.parameters.results;\r\n      if (results) {\r\n        results = results ? results.split(',') : undefined;\r\n        for (var i in results) {\r\n          var p = results[i];\r\n\r\n          ports.push({\r\n            type: {\r\n              name: '*'\r\n            },\r\n            plug: 'input',\r\n            group: 'Results',\r\n            name: 'result-' + p,\r\n            displayName: p\r\n          });\r\n        }\r\n      }\r\n\r\n      // Add back actions\r\n      var backActions = node.parameters.backActions;\r\n      if (backActions) {\r\n        backActions = backActions ? backActions.split(',') : undefined;\r\n        for (var i in backActions) {\r\n          var p = backActions[i];\r\n\r\n          ports.push({\r\n            type: 'signal',\r\n            plug: 'input',\r\n            group: 'Back Actions',\r\n            name: 'backAction-' + p,\r\n            displayName: p\r\n          });\r\n        }\r\n      }\r\n\r\n      context.editorConnection.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    _updatePorts();\r\n    node.on('parameterUpdated', function (event) {\r\n      if (event.name === 'results' || event.name === 'backActions') {\r\n        _updatePorts();\r\n      }\r\n    });\r\n  }\r\n\r\n  graphModel.on('editorImportComplete', () => {\r\n    graphModel.on('nodeAdded.PageStackNavigateBack', function (node) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType('PageStackNavigateBack')) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: NavigateBack,\r\n  setup: setup\r\n};\r\n","'use strict';\r\n\r\nconst NoodlRuntime = require('@noodl/runtime');\r\n\r\nconst NavigateToPathNode = {\r\n  name: 'PageStackNavigateToPath',\r\n  displayNodeName: 'Navigate To Path',\r\n  category: 'Navigation',\r\n  docs: 'https://docs.noodl.net/nodes/navigation/navigate-to-path',\r\n  initialize() {\r\n    const internal = this._internal;\r\n    internal.params = {};\r\n    internal.query = {};\r\n    internal.openInNewTab = false;\r\n  },\r\n  inputs: {\r\n    path: {\r\n      type: { name: 'string' },\r\n      displayName: 'Path',\r\n      group: 'General',\r\n      set(value) {\r\n        this._internal.path = value;\r\n      }\r\n    },\r\n    queryNames: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      displayName: 'Query',\r\n      group: 'Query',\r\n      set(value) {\r\n        this._internal.queryNames = value;\r\n      }\r\n    },\r\n    openInNewTab: {\r\n      index: 10,\r\n      displayName: 'Open in new tab',\r\n      group: 'General',\r\n      default: false,\r\n      type: 'boolean',\r\n      set(value) {\r\n        this._internal.openInNewTab = !!value;\r\n      }\r\n    },\r\n    navigate: {\r\n      displayName: 'Navigate',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleNavigate();\r\n      }\r\n    }\r\n  },\r\n  outputs: {},\r\n  methods: {\r\n    scheduleNavigate() {\r\n      var internal = this._internal;\r\n\r\n      if (!internal.hasScheduledNavigate) {\r\n        internal.hasScheduledNavigate = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          internal.hasScheduledNavigate = false;\r\n          this.navigate();\r\n        });\r\n      }\r\n    },\r\n    navigate() {\r\n      var internal = this._internal;\r\n\r\n      var formattedPath = internal.path;\r\n      if (formattedPath === undefined) return;\r\n\r\n      var matches = internal.path.match(/\\{[A-Za-z0-9_]*\\}/g);\r\n      var inputs = [];\r\n      if (matches) {\r\n        inputs = matches.map(function (name) {\r\n          return name.replace('{', '').replace('}', '');\r\n        });\r\n      }\r\n\r\n      inputs.forEach(function (name) {\r\n        var v = internal.params[name];\r\n        formattedPath = formattedPath.replace('{' + name + '}', v !== undefined ? v : '');\r\n      });\r\n\r\n      var urlPath, hashPath;\r\n      var navigationPathType = NoodlRuntime.instance.getProjectSettings()['navigationPathType'];\r\n      if (navigationPathType === undefined || navigationPathType === 'hash') hashPath = formattedPath;\r\n      else urlPath = formattedPath;\r\n\r\n      var query = [];\r\n      if (internal.queryNames !== undefined) {\r\n        internal.queryNames.split(',').forEach((q) => {\r\n          if (internal.query[q] !== undefined) {\r\n            query.push(q + '=' + internal.query[q]);\r\n          }\r\n        });\r\n      }\r\n\r\n      var compiledUrl =\r\n        (urlPath !== undefined ? urlPath : '') +\r\n        (query.length >= 1 ? '?' + query.join('&') : '') +\r\n        (hashPath !== undefined ? '#' + hashPath : '');\r\n\r\n      if (this._internal.openInNewTab) {\r\n        window.open(compiledUrl, '_blank');\r\n      } else {\r\n        window.history.pushState({}, '', compiledUrl);\r\n        dispatchEvent(new PopStateEvent('popstate', {}));\r\n      }\r\n    },\r\n    setParam(name, value) {\r\n      this._internal.params[name] = value;\r\n    },\r\n    setQuery(name, value) {\r\n      this._internal.query[name] = value;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('p-'))\r\n        return this.registerInput(name, {\r\n          set: this.setParam.bind(this, name.substring('p-'.length))\r\n        });\r\n\r\n      if (name.startsWith('q-'))\r\n        return this.registerInput(name, {\r\n          set: this.setQuery.bind(this, name.substring('q-'.length))\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: NavigateToPathNode,\r\n  setup: function setup(context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _updatePorts() {\r\n        var ports = [];\r\n\r\n        if (node.parameters['path'] !== undefined) {\r\n          var inputs = node.parameters['path'].match(/\\{[A-Za-z0-9_]*\\}/g) || [];\r\n          var portsNames = inputs.map(function (def) {\r\n            return def.replace('{', '').replace('}', '');\r\n          });\r\n\r\n          var ports = portsNames\r\n            //get unique names\r\n            .filter(function (value, index, self) {\r\n              return self.indexOf(value) === index;\r\n            })\r\n            //and map names to ports\r\n            .map(function (name) {\r\n              return {\r\n                name: 'p-' + name,\r\n                displayName: name,\r\n                group: 'Parameter',\r\n                type: '*',\r\n                plug: 'input'\r\n              };\r\n            });\r\n        }\r\n\r\n        if (node.parameters['queryNames'] !== undefined) {\r\n          node.parameters['queryNames'].split(',').forEach((q) => {\r\n            ports.push({\r\n              name: 'q-' + q,\r\n              displayName: q,\r\n              group: 'Query',\r\n              plug: 'input',\r\n              type: '*'\r\n            });\r\n          });\r\n        }\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on('parameterUpdated', function (event) {\r\n        _updatePorts();\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.PageStackNavigateToPath', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('PageStackNavigateToPath')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","const Transitions = require('./transitions');\r\nconst NavigationHandler = require('./navigation-handler');\r\n\r\nconst Navigate = {\r\n  name: 'PageStackNavigate',\r\n  displayNodeName: 'Push Component To Stack',\r\n  category: 'Navigation',\r\n  docs: 'https://docs.noodl.net/nodes/component-stack/push-component',\r\n  initialize: function () {\r\n    this._internal.transitionParams = {};\r\n    this._internal.pageParams = {};\r\n    this._internal.backResults = {};\r\n  },\r\n  inputs: {\r\n    stack: {\r\n      type: { name: 'string', identifierOf: 'PackStack' },\r\n      displayName: 'Stack',\r\n      group: 'General',\r\n      default: 'Main',\r\n      set: function (value) {\r\n        this._internal.stack = value;\r\n      }\r\n    },\r\n    mode: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Push', value: 'push' },\r\n          { label: 'Replace', value: 'replace' }\r\n        ]\r\n      },\r\n      displayName: 'Mode',\r\n      default: 'push',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.navigationMode = value;\r\n      }\r\n    },\r\n    navigate: {\r\n      displayName: 'Navigate',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleNavigate();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    navigated: {\r\n      type: 'signal',\r\n      displayName: 'Navigated',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  methods: {\r\n    scheduleNavigate: function () {\r\n      var _this = this;\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledNavigate) {\r\n        internal.hasScheduledNavigate = true;\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          internal.hasScheduledNavigate = false;\r\n          _this.navigate();\r\n        });\r\n      }\r\n    },\r\n    navigate() {\r\n      if (this._internal.navigationMode === 'push' || this._internal.navigationMode === undefined) {\r\n        NavigationHandler.instance.navigate(this._internal.stack, {\r\n          target: this._internal.target,\r\n          transition: { ...{ type: this._internal.transition }, ...this._internal.transitionParams },\r\n          params: this._internal.pageParams,\r\n          backCallback: (action, results) => {\r\n            this._internal.backResults = results;\r\n\r\n            for (const key in results) {\r\n              if (this.hasOutput('backResult-' + key)) {\r\n                this.flagOutputDirty('backResult-' + key);\r\n              }\r\n            }\r\n\r\n            if (action !== undefined) this.sendSignalOnOutput(action);\r\n          },\r\n          hasNavigated: () => {\r\n            this.sendSignalOnOutput('navigated');\r\n          }\r\n        });\r\n      } else if (this._internal.navigationMode === 'replace') {\r\n        NavigationHandler.instance.replace(this._internal.stack, {\r\n          target: this._internal.target,\r\n          params: this._internal.pageParams,\r\n          hasNavigated: () => {\r\n            this.scheduleAfterInputsHaveUpdated(() => {\r\n              this.sendSignalOnOutput('navigated');\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    setTransitionParam: function (param, value) {\r\n      this._internal.transitionParams[param] = value;\r\n    },\r\n    setPageParam: function (param, value) {\r\n      this._internal.pageParams[param] = value;\r\n    },\r\n    getBackResult: function (param, value) {\r\n      return this._internal.backResults[param];\r\n    },\r\n    setTargetPageId: function (pageId) {\r\n      this._internal.target = pageId;\r\n    },\r\n    setTransition: function (value) {\r\n      this._internal.transition = value;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'target') {\r\n        return this.registerInput(name, {\r\n          set: this.setTargetPageId.bind(this)\r\n        });\r\n      } else if (name === 'transition') {\r\n        return this.registerInput(name, {\r\n          set: this.setTransition.bind(this)\r\n        });\r\n      } else if (name.startsWith('tr-')) {\r\n        return this.registerInput(name, {\r\n          set: this.setTransitionParam.bind(this, name.substring('tr-'.length))\r\n        });\r\n      } else if (name.startsWith('pm-')) {\r\n        return this.registerInput(name, {\r\n          set: this.setPageParam.bind(this, name.substring('pm-'.length))\r\n        });\r\n      }\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('backResult-'))\r\n        return this.registerOutput(name, {\r\n          getter: this.getBackResult.bind(this, name.substring('backResult-'.length))\r\n        });\r\n      else if (name.startsWith('backAction-'))\r\n        return this.registerOutput(name, {\r\n          getter: function () {\r\n            /** No needed for signals */\r\n          }\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nfunction setup(context, graphModel) {\r\n  if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node) {\r\n    function _updatePorts() {\r\n      var ports = [];\r\n\r\n      // Only push mode have transition\r\n      if (node.parameters['mode'] === 'push' || node.parameters['mode'] === undefined) {\r\n        ports.push({\r\n          name: 'transition',\r\n          plug: 'input',\r\n          type: { name: 'enum', enums: Object.keys(Transitions) },\r\n          default: 'Push',\r\n          displayName: 'Transition',\r\n          group: 'Transition'\r\n        });\r\n\r\n        var transition = node.parameters['transition'] || 'Push';\r\n        if (Transitions[transition]) ports = ports.concat(Transitions[transition].ports(node.parameters));\r\n      }\r\n\r\n      const pageStacks = graphModel.getNodesWithType('Page Stack');\r\n      const pageStack = pageStacks.find(\r\n        (ps) => (ps.parameters['name'] || 'Main') === (node.parameters['stack'] || 'Main')\r\n      );\r\n\r\n      if (pageStack !== undefined) {\r\n        const pages = pageStack.parameters['pages'];\r\n        if (pages !== undefined && pages.length > 0) {\r\n          ports.push({\r\n            plug: 'input',\r\n            type: {\r\n              name: 'enum',\r\n              enums: pages.map((p) => ({\r\n                label: p.label,\r\n                value: p.id\r\n              }))\r\n            },\r\n            group: 'General',\r\n            displayName: 'Target Page',\r\n            name: 'target',\r\n            default: pages[0].id\r\n          });\r\n\r\n          // See if there is a target page with component\r\n          const targetPageId = node.parameters['target'] || pages[0].id;\r\n          const targetComponentName = pageStack.parameters['pageComp-' + targetPageId];\r\n          if (targetComponentName !== undefined) {\r\n            const component = graphModel.components[targetComponentName];\r\n\r\n            if (component !== undefined) {\r\n              // Make all inputs of the component to inputs of this navigation node\r\n              for (const inputName in component.inputPorts) {\r\n                ports.push({\r\n                  name: 'pm-' + inputName,\r\n                  displayName: inputName,\r\n                  type: '*',\r\n                  plug: 'input',\r\n                  group: 'Parameters'\r\n                });\r\n              }\r\n\r\n              // Find all navigate back nodes and compile the back actions as\r\n              // outputs of this node\r\n              for (const backNode of component.getNodesWithType('PageStackNavigateBack')) {\r\n                if (backNode.parameters['backActions'] !== undefined) {\r\n                  backNode.parameters['backActions'].split(',').forEach((a) => {\r\n                    if (ports.find((_p) => _p.name === 'backAction-' + a)) return;\r\n\r\n                    ports.push({\r\n                      name: 'backAction-' + a,\r\n                      displayName: a,\r\n                      type: 'signal',\r\n                      plug: 'output',\r\n                      group: 'Back Actions'\r\n                    });\r\n                  });\r\n                }\r\n\r\n                if (backNode.parameters['results']) {\r\n                  backNode.parameters['results'].split(',').forEach((p) => {\r\n                    if (ports.find((_p) => _p.name === 'backResult-' + p)) return;\r\n\r\n                    ports.push({\r\n                      name: 'backResult-' + p,\r\n                      displayName: p,\r\n                      type: '*',\r\n                      plug: 'output',\r\n                      group: 'Back Results'\r\n                    });\r\n                  });\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      context.editorConnection.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    function _trackTargetComponent() {\r\n      var pageStacks = graphModel.getNodesWithType('Page Stack');\r\n      var pageStack = pageStacks.find((ps) => ps.parameters['name'] === node.parameters['stack']);\r\n      if (pageStack === undefined) return;\r\n\r\n      var pages = pageStack.parameters['pages'];\r\n      if (pages === undefined || pages.length === 0) return;\r\n\r\n      var targetCompoment = pageStack.parameters['pageComp-' + (node.parameters['target'] || pages[0].id)];\r\n      if (targetCompoment === undefined) return;\r\n      var c = graphModel.components[targetCompoment];\r\n      if (c === undefined) return;\r\n\r\n      c.on('inputPortAdded', _updatePorts);\r\n      c.on('inputPortRemoved', _updatePorts);\r\n\r\n      // Also track all back navigate for changes\r\n      for (const _n of c.getNodesWithType('PageStackNavigateBack')) {\r\n        _n.on('parameterUpdated', _updatePorts);\r\n      }\r\n\r\n      // Track back navigate added and removed\r\n      c.on('nodeAdded', (_n) => {\r\n        if (_n.type === 'PageStackNavigateBack') {\r\n          _n.on('parameterUpdated', _updatePorts);\r\n          _updatePorts();\r\n        }\r\n      });\r\n\r\n      c.on('nodeWasRemoved', (_n) => {\r\n        if (_n.type === 'PageStackNavigateBack') _updatePorts();\r\n      });\r\n    }\r\n\r\n    _updatePorts();\r\n    _trackTargetComponent();\r\n    node.on('parameterUpdated', function (ev) {\r\n      if (ev.name === 'target') {\r\n        _trackTargetComponent();\r\n        _updatePorts();\r\n      } else if (ev.name === 'stack' || ev.name === 'mode' || ev.name === 'transition' || ev.name.startsWith('tr-')) _updatePorts();\r\n    });\r\n\r\n    // Track all page stacks for changes (if there are any changes to the pages of the name of a stack we might have to update)\r\n    function _trackPageStack(node) {\r\n      node.on('parameterUpdated', function (ev) {\r\n        if (ev.name === 'pages' || ev.name === 'name') _updatePorts();\r\n      });\r\n    }\r\n    graphModel.on('nodeAdded.Page Stack', _trackPageStack);\r\n    graphModel.on('nodeWasRemoved.Page Stack', _updatePorts);\r\n\r\n    for (const node of graphModel.getNodesWithType('Page Stack')) {\r\n      _trackPageStack(node);\r\n    }\r\n  }\r\n\r\n  graphModel.on('editorImportComplete', () => {\r\n    graphModel.on('nodeAdded.PageStackNavigate', function (node) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType('PageStackNavigate')) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: Navigate,\r\n  setup: setup\r\n};\r\n","class NavigationHandler {\r\n  constructor() {\r\n    this._pageStacks = {};\r\n    this._navigationQueue = [];\r\n  }\r\n\r\n  _performNavigation(name, args, type) {\r\n    name = name || 'Main';\r\n    if (this._pageStacks[name]) {\r\n      for (const pageStack of this._pageStacks[name]) {\r\n        type === 'navigate' ? pageStack.navigate(args) : pageStack.replace(args);\r\n      }\r\n    } else {\r\n      this._navigationQueue.push({ name, args, type });\r\n    }\r\n  }\r\n\r\n  navigate(name, args) {\r\n    name = name || 'Main';\r\n    this._performNavigation(name, args, 'navigate');\r\n  }\r\n\r\n  replace(name, args) {\r\n    name = name || 'Main';\r\n    this._performNavigation(name, args, 'replace');\r\n  }\r\n\r\n  registerPageStack(name, pageStack) {\r\n    name = name || 'Main';\r\n    if (!this._pageStacks[name]) {\r\n      this._pageStacks[name] = [];\r\n    }\r\n\r\n    this._pageStacks[name].push(pageStack);\r\n\r\n    let hasReset = false;\r\n    let hasNavigated = false;\r\n\r\n    let i = 0;\r\n    while (i < this._navigationQueue.length) {\r\n      const e = this._navigationQueue[i];\r\n      if (e.name === name) {\r\n        if (e.type === 'navigate') {\r\n          if (!hasReset) {\r\n            //we need to reset to the start page before doing the first navigation\r\n            pageStack.reset();\r\n            hasReset = true;\r\n          }\r\n          pageStack.navigate(e.args);\r\n        } else {\r\n          pageStack.replace(e.args);\r\n        }\r\n\r\n        hasNavigated = true;\r\n        this._navigationQueue.splice(i, 1);\r\n      } else {\r\n        i++;\r\n      }\r\n    }\r\n\r\n    if (!hasNavigated) {\r\n      pageStack.reset(); //no navigation has happened, call reset() so the start page is created\r\n    }\r\n  }\r\n\r\n  deregisterPageStack(name, pageStack) {\r\n    name = name || 'Main';\r\n\r\n    if (!this._pageStacks[name]) {\r\n      return;\r\n    }\r\n\r\n    const index = this._pageStacks[name].indexOf(pageStack);\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n\r\n    this._pageStacks[name].splice(index, 1);\r\n    if (this._pageStacks[name].length === 0) {\r\n      delete this._pageStacks[name];\r\n    }\r\n  }\r\n}\r\n\r\nNavigationHandler.instance = new NavigationHandler();\r\n\r\nmodule.exports = NavigationHandler;\r\n","'use strict';\r\n\r\nconst PageInputsNode = {\r\n  name: 'PageInputs',\r\n  displayNodeName: 'Page Inputs',\r\n  category: 'Navigation',\r\n  docs: 'https://docs.noodl.net/nodes/navigation/page-inputs',\r\n  color: 'component',\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n\r\n    internal.params = {};\r\n  },\r\n  inputs: {\r\n    pathParams: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      group: 'Path Parameters'\r\n    },\r\n    queryParams: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      group: 'Query Parameters'\r\n    }\r\n  },\r\n  outputs: {},\r\n  methods: {\r\n    _setPageParams: function (params) {\r\n      for (var key in params) {\r\n        this._internal.params[key] = params[key];\r\n        if (this.hasOutput('pm-' + key)) this.flagOutputDirty('pm-' + key);\r\n      }\r\n    },\r\n    getPageParam: function (name) {\r\n      return this._internal.params[name];\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('pm-'))\r\n        return this.registerOutput(name, {\r\n          getter: this.getPageParam.bind(this, name.substring('pm-'.length))\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: PageInputsNode\r\n  /*  setup: function setup(context, graphModel) {\r\n        if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n            return;\r\n        }\r\n    \r\n        function _managePortsForNode(node) {\r\n            function _updatePorts() {\r\n                var ports = []\r\n\r\n                const uniqueNames = {}\r\n\r\n                if(node.parameters['pathParams'] !== undefined) {\r\n                    node.parameters['pathParams'].split(',').forEach((p) => {\r\n                        uniqueNames[p] = true\r\n                    }) \r\n                }\r\n\r\n                if(node.parameters['queryParams'] !== undefined) {\r\n                    node.parameters['queryParams'].split(',').forEach((p) => {\r\n                        uniqueNames[p] = true\r\n                    }) \r\n                }\r\n\r\n                Object.keys(uniqueNames).forEach((outputName) => {\r\n                    ports.push({\r\n                        name: 'pm-' + outputName,\r\n                        displayName: outputName,\r\n                        type: '*',\r\n                        plug: 'output',\r\n                        group: 'Parameters'\r\n                    })\r\n                })\r\n\r\n                context.editorConnection.sendDynamicPorts(node.id, ports);\r\n            }\r\n\r\n            // Track page node in this component, update if there are any changes\r\n            _updatePorts();\r\n            node.on(\"parameterUpdated\", function (event) {\r\n                _updatePorts();\r\n            })\r\n        }\r\n        \r\n        graphModel.on(\"editorImportComplete\", ()=> {\r\n            graphModel.on(\"nodeAdded.PageInputs\", function (node) {\r\n                _managePortsForNode(node)\r\n            })\r\n    \r\n            for(const node of graphModel.getNodesWithType('PageInputs')) {\r\n                _managePortsForNode(node)\r\n            }\r\n        })\r\n    }*/\r\n};\r\n","const { RouterHandler } = require('./router-handler');\r\n\r\nconst RouterNavigate = {\r\n  name: 'RouterNavigate',\r\n  displayNodeName: 'Navigate',\r\n  category: 'Navigation',\r\n  docs: 'https://docs.noodl.net/nodes/navigation/navigate',\r\n  initialize: function () {\r\n    this._internal.pageParams = {};\r\n    this._internal.openInNewTab = false;\r\n  },\r\n  inputs: {\r\n    navigate: {\r\n      displayName: 'Navigate',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleNavigate();\r\n      }\r\n    },\r\n    openInNewTab: {\r\n      index: 10,\r\n      displayName: 'Open in new tab',\r\n      group: 'General',\r\n      default: false,\r\n      type: 'boolean',\r\n      set(value) {\r\n        this._internal.openInNewTab = !!value;\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    navigated: {\r\n      type: 'signal',\r\n      displayName: 'Navigated',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  methods: {\r\n    scheduleNavigate: function () {\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledNavigate) {\r\n        internal.hasScheduledNavigate = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          internal.hasScheduledNavigate = false;\r\n          this.navigate();\r\n        });\r\n      }\r\n    },\r\n    navigate() {\r\n      RouterHandler.instance.navigate(this._internal.router, {\r\n        target: this._internal.target,\r\n        params: this._internal.pageParams,\r\n        openInNewTab: this._internal.openInNewTab,\r\n        hasNavigated: () => {\r\n          this.scheduleAfterInputsHaveUpdated(() => {\r\n            this.sendSignalOnOutput('navigated');\r\n          });\r\n        }\r\n      });\r\n    },\r\n    setPageParam: function (param, value) {\r\n      this._internal.pageParams[param] = value;\r\n    },\r\n    setTargetPage: function (page) {\r\n      this._internal.target = page;\r\n    },\r\n    setRouter: function (value) {\r\n      this._internal.router = value;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'target') {\r\n        return this.registerInput(name, {\r\n          set: this.setTargetPage.bind(this)\r\n        });\r\n      } else if (name === 'router') {\r\n        return this.registerInput(name, {\r\n          set: this.setRouter.bind(this)\r\n        });\r\n      } else if (name.startsWith('pm-')) {\r\n        return this.registerInput(name, {\r\n          set: this.setPageParam.bind(this, name.substring('pm-'.length))\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: RouterNavigate\r\n};\r\n","const ShowPopupNode = {\r\n  name: 'NavigationShowPopup',\r\n  displayNodeName: 'Show Popup',\r\n  category: 'Navigation',\r\n  docs: 'https://docs.noodl.net/nodes/popups/show-popup',\r\n  initialize: function () {\r\n    this._internal.popupParams = {};\r\n    this._internal.closeResults = {};\r\n  },\r\n  inputs: {\r\n    target: {\r\n      type: 'component',\r\n      displayName: 'Target',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.target = value;\r\n      }\r\n    },\r\n    show: {\r\n      type: 'signal',\r\n      displayName: 'Show',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleShow();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    Closed: {\r\n      type: 'signal'\r\n    }\r\n  },\r\n  methods: {\r\n    setPopupParam: function (param, value) {\r\n      this._internal.popupParams[param] = value;\r\n    },\r\n    getCloseResult: function (param) {\r\n      return this._internal.closeResults[param];\r\n    },\r\n    scheduleShow: function () {\r\n      var _this = this;\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledShow) {\r\n        internal.hasScheduledShow = true;\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          internal.hasScheduledShow = false;\r\n          _this.show();\r\n        });\r\n      }\r\n    },\r\n    show: function () {\r\n      if (this._internal.target == undefined) return;\r\n\r\n      this.context.showPopup(this._internal.target, this._internal.popupParams, {\r\n        senderNode: this.nodeScope.componentOwner,\r\n        /**\r\n         * @param {string | undefined} action\r\n         * @param {*} results\r\n         */\r\n        onClosePopup: (action, results) => {\r\n          this._internal.closeResults = results;\r\n\r\n          for (const key in results) {\r\n            if (this.hasOutput('closeResult-' + key)) {\r\n              this.flagOutputDirty('closeResult-' + key);\r\n            }\r\n          }\r\n\r\n          if (!action) {\r\n            this.sendSignalOnOutput('Closed');\r\n          } else {\r\n            this.sendSignalOnOutput(action);\r\n          }\r\n        }\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('popupParam-'))\r\n        return this.registerInput(name, {\r\n          set: this.setPopupParam.bind(this, name.substring('popupParam-'.length))\r\n        });\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('closeResult-'))\r\n        return this.registerOutput(name, {\r\n          getter: this.getCloseResult.bind(this, name.substring('closeResult-'.length))\r\n        });\r\n\r\n      if (name.startsWith('closeAction-'))\r\n        return this.registerOutput(name, {\r\n          getter: function () {\r\n            /** No needed for signals */\r\n          }\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: ShowPopupNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _updatePorts() {\r\n        var ports = [];\r\n\r\n        var targetComponentName = node.parameters['target'];\r\n        if (targetComponentName !== undefined) {\r\n          var c = graphModel.components[targetComponentName];\r\n          if (c) {\r\n            for (var inputName in c.inputPorts) {\r\n              var o = c.inputPorts[inputName];\r\n              ports.push({\r\n                name: 'popupParam-' + inputName,\r\n                displayName: inputName,\r\n                type: o.type || '*',\r\n                plug: 'input',\r\n                group: 'Params'\r\n              });\r\n            }\r\n\r\n            for (const _n of c.getNodesWithType('NavigationClosePopup')) {\r\n              if (_n.parameters['closeActions'] !== undefined) {\r\n                _n.parameters['closeActions'].split(',').forEach((a) => {\r\n                  if (ports.find((p) => p.name === a)) return;\r\n\r\n                  ports.push({\r\n                    name: 'closeAction-' + a,\r\n                    displayName: a,\r\n                    type: 'signal',\r\n                    plug: 'output',\r\n                    group: 'Close Actions'\r\n                  });\r\n                });\r\n              }\r\n\r\n              if (_n.parameters['results'] !== undefined) {\r\n                _n.parameters['results'].split(',').forEach((p) => {\r\n                  ports.push({\r\n                    name: 'closeResult-' + p,\r\n                    displayName: p,\r\n                    type: '*',\r\n                    plug: 'output',\r\n                    group: 'Close Results'\r\n                  });\r\n                });\r\n              }\r\n            }\r\n          }\r\n        }\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      function _trackTargetComponent(name) {\r\n        if (name === undefined) return;\r\n        var c = graphModel.components[name];\r\n        if (c === undefined) return;\r\n\r\n        c.on('inputPortAdded', _updatePorts);\r\n        c.on('inputPortRemoved', _updatePorts);\r\n\r\n        // Also track all close popups for changes\r\n        for (const _n of c.getNodesWithType('NavigationClosePopup')) {\r\n          _n.on('parameterUpdated', _updatePorts);\r\n        }\r\n\r\n        // Track close popup added and removed\r\n        c.on('nodeAdded', (_n) => {\r\n          if (_n.type === 'NavigationClosePopup') {\r\n            _n.on('parameterUpdated', _updatePorts);\r\n            _updatePorts();\r\n          }\r\n        });\r\n\r\n        c.on('nodeWasRemoved', (_n) => {\r\n          if (_n.type === 'NavigationClosePopup') _updatePorts();\r\n        });\r\n      }\r\n\r\n      _updatePorts();\r\n      _trackTargetComponent(node.parameters['target']);\r\n\r\n      // Track parameter updated\r\n      node.on('parameterUpdated', function (event) {\r\n        if (event.name === 'target') {\r\n          _updatePorts();\r\n          _trackTargetComponent(node.parameters['target']);\r\n        }\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.NavigationShowPopup', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('NavigationShowPopup')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","module.exports = {\r\n  None: require('./transitions/none-transition'),\r\n  Push: require('./transitions/push-transition'),\r\n  Popup: require('./transitions/popup-transition')\r\n};\r\n","const Transition = require('./transition');\r\n\r\nclass NoneTransition extends Transition {\r\n  constructor(from, to, params) {\r\n    super();\r\n\r\n    this.from = from;\r\n    this.to = to;\r\n\r\n    this.timing = { dur: 0, delay: 0 };\r\n  }\r\n\r\n  update(t) {}\r\n\r\n  forward(t) {}\r\n\r\n  back(t) {}\r\n\r\n  static ports() {\r\n    return [];\r\n  }\r\n}\r\n\r\nmodule.exports = NoneTransition;\r\n","const Transition = require('./transition');\r\nconst BezierEasing = require('bezier-easing');\r\n\r\nclass PopupTransition extends Transition {\r\n  constructor(from, to, params) {\r\n    super();\r\n\r\n    this.from = from;\r\n    this.to = to;\r\n\r\n    this.timing = params.timing || { curve: [0.0, 0.0, 0.58, 1.0], dur: 300, delay: 0 };\r\n    this.distance = params.shift || { value: 25, unit: '%' };\r\n    if (typeof this.distance === 'number') this.distance = { value: this.distance, unit: '%' };\r\n    this.direction = params.direction || 'Right';\r\n\r\n    this.timing.curve[0] = Math.min(1, Math.max(0, this.timing.curve[0]));\r\n    this.timing.curve[2] = Math.min(1, Math.max(0, this.timing.curve[2]));\r\n    this.ease = BezierEasing.apply(null, this.timing.curve).get;\r\n\r\n    this.fadein = params.fadein === undefined ? false : params.fadein;\r\n\r\n    this.zoom = params.zoom || { value: 25, unit: '%' };\r\n    if (typeof this.zoom === 'number') this.zoom = { value: this.zoom, unit: '%' };\r\n  }\r\n\r\n  update(t) {\r\n    if (this.direction === 'In' || this.direction === 'Out') {\r\n      var zoom = this.zoom.value / 100;\r\n\r\n      zoom = this.direction === 'Out' ? -zoom : zoom;\r\n\r\n      this.to.setStyle({\r\n        transform: 'scale(' + (1 - zoom * (1 - t)) + ')',\r\n        opacity: this.crossfade ? t : 1\r\n      });\r\n    } else {\r\n      var dist = this.distance.value;\r\n      var unit = this.distance.unit;\r\n\r\n      const targets = {\r\n        Up: { x: 0, y: -1 },\r\n        Down: { x: 0, y: 1 },\r\n        Left: { x: -1, y: 0 },\r\n        Right: { x: 1, y: 0 }\r\n      };\r\n      const target = {\r\n        x: targets[this.direction].x * dist,\r\n        y: targets[this.direction].y * dist\r\n      };\r\n\r\n      this.to.setStyle({\r\n        transform: 'translate(' + target.x * (t - 1) + unit + ',' + target.y * (t - 1) + unit + ')',\r\n        opacity: this.fadein ? t : 1\r\n      });\r\n    }\r\n  }\r\n\r\n  forward(t) {\r\n    var _t = this.ease(t);\r\n    this.update(_t);\r\n  }\r\n\r\n  back(t) {\r\n    var _t = this.ease(t);\r\n    this.update(1 - _t);\r\n  }\r\n\r\n  static ports(parameters) {\r\n    var ports = [];\r\n\r\n    ports.push({\r\n      name: 'tr-direction',\r\n      displayName: 'Direction',\r\n      group: 'Transition',\r\n      type: { name: 'enum', enums: ['Right', 'Left', 'Up', 'Down', 'In', 'Out'] },\r\n      default: 'Right',\r\n      plug: 'input'\r\n    });\r\n\r\n    if (parameters['tr-direction'] === 'In' || parameters['tr-direction'] === 'Out') {\r\n      ports.push({\r\n        name: 'tr-zoom',\r\n        displayName: 'Zoom',\r\n        group: 'Transition',\r\n        type: { name: 'number', units: ['%'] },\r\n        default: { value: 25, unit: '%' },\r\n        plug: 'input'\r\n      });\r\n    } else {\r\n      ports.push({\r\n        name: 'tr-shift',\r\n        displayName: 'Shift Distance',\r\n        group: 'Transition',\r\n        type: { name: 'number', units: ['%', 'px'] },\r\n        default: { value: 25, unit: '%' },\r\n        plug: 'input'\r\n      });\r\n    }\r\n\r\n    ports.push({\r\n      name: 'tr-fadein',\r\n      displayName: 'Fade In',\r\n      group: 'Transition',\r\n      type: 'boolean',\r\n      default: false,\r\n      plug: 'input'\r\n    });\r\n\r\n    ports.push({\r\n      name: 'tr-timing',\r\n      displayName: 'Timing',\r\n      group: 'Transition',\r\n      type: 'curve',\r\n      plug: 'input'\r\n    });\r\n\r\n    return ports;\r\n  }\r\n}\r\n\r\nmodule.exports = PopupTransition;\r\n","const Transition = require('./transition');\r\nconst BezierEasing = require('bezier-easing');\r\nclass PushTransition extends Transition {\r\n  constructor(from, to, params) {\r\n    super();\r\n\r\n    this.from = from;\r\n    this.to = to;\r\n\r\n    this.timing = params.timing || { curve: [0.0, 0.0, 0.58, 1.0], dur: 300, delay: 0 };\r\n    this.distance = params.shift || { value: 25, unit: '%' };\r\n    if (typeof this.distance === 'number') this.distance = { value: this.distance, unit: '%' };\r\n    this.direction = params.direction || 'Left';\r\n\r\n    this.timing.curve[0] = Math.min(1, Math.max(0, this.timing.curve[0]));\r\n    this.timing.curve[2] = Math.min(1, Math.max(0, this.timing.curve[2]));\r\n    this.ease = BezierEasing.apply(null, this.timing.curve).get;\r\n\r\n    this.crossfade = params.crossfade === undefined ? false : params.crossfade;\r\n    this.darkOverlay = params.darkoverlay === undefined ? true : params.darkoverlay;\r\n    this.darkOverlayAmount = params.darkoverlayamount === undefined ? 0.5 : params.darkoverlayamount;\r\n\r\n    this.zoom = params.zoom || { value: 25, unit: '%' };\r\n    if (typeof this.zoom === 'number') this.zoom = { value: this.zoom, unit: '%' };\r\n\r\n    if (this.darkOverlay) {\r\n      this.darkOverlay = from.nodeScope.createPrimitiveNode('Group');\r\n      this.darkOverlay.setInputValue('position', 'absolute');\r\n      this.darkOverlay.setInputValue('sizeMode', 'explicit');\r\n      this.darkOverlay.setInputValue('width', { value: 100, unit: '%' });\r\n      this.darkOverlay.setInputValue('height', { value: 100, unit: '%' });\r\n      this.darkOverlay.setInputValue('backgroundColor', '#000000');\r\n      this.darkOverlay.setInputValue('opacity', 0);\r\n    }\r\n  }\r\n\r\n  update(t) {\r\n    if (this.direction === 'In' || this.direction === 'Out') {\r\n      var zoom = this.zoom.value / 100;\r\n\r\n      zoom = this.direction === 'Out' ? -zoom : zoom;\r\n\r\n      this.from.setStyle({\r\n        transform: 'scale(' + (1 + zoom * t) + ')',\r\n        opacity: this.crossfade ? 1 - t : 1\r\n      });\r\n\r\n      this.to.setStyle({\r\n        transform: 'scale(' + (1 - zoom * (1 - t)) + ')',\r\n        opacity: this.crossfade ? t : 1\r\n      });\r\n    } else {\r\n      var dist = this.distance.value;\r\n      var unit = this.distance.unit;\r\n\r\n      const targets = {\r\n        Up: { x: 0, y: -1 },\r\n        Down: { x: 0, y: 1 },\r\n        Left: { x: -1, y: 0 },\r\n        Right: { x: 1, y: 0 }\r\n      };\r\n\r\n      const from = {\r\n        x: targets[this.direction].x * dist,\r\n        y: targets[this.direction].y * dist\r\n      };\r\n\r\n      const target = {\r\n        x: targets[this.direction].x * 100,\r\n        y: targets[this.direction].y * 100\r\n      };\r\n\r\n      this.from.setStyle({\r\n        transform: 'translate(' + from.x * t + unit + ',' + from.y * t + unit + ')',\r\n        opacity: this.crossfade ? 1 - t : 1\r\n      });\r\n\r\n      this.to.setStyle({\r\n        transform: 'translate(' + target.x * (t - 1) + unit + ',' + target.y * (t - 1) + '%)',\r\n        opacity: this.crossfade ? t : 1\r\n      });\r\n    }\r\n\r\n    if (this.darkOverlay) {\r\n      this.darkOverlay.setStyle({\r\n        opacity: t * this.darkOverlayAmount\r\n      });\r\n    }\r\n  }\r\n\r\n  forward(t) {\r\n    var _t = this.ease(t);\r\n    this.update(_t);\r\n  }\r\n\r\n  back(t) {\r\n    var _t = this.ease(t);\r\n    this.update(1 - _t);\r\n  }\r\n\r\n  start(args) {\r\n    super.start(args);\r\n    if (this.darkOverlay) {\r\n      this.from.addChild(this.darkOverlay);\r\n    }\r\n  }\r\n\r\n  end(args) {\r\n    if (this.darkOverlay) {\r\n      this.from.removeChild(this.darkOverlay);\r\n    }\r\n    super.end(args);\r\n  }\r\n\r\n  static ports(parameters) {\r\n    const ports = [];\r\n\r\n    ports.push({\r\n      name: 'tr-direction',\r\n      displayName: 'Direction',\r\n      group: 'Transition',\r\n      type: { name: 'enum', enums: ['Right', 'Left', 'Up', 'Down', 'In', 'Out'] },\r\n      default: 'Left',\r\n      plug: 'input'\r\n    });\r\n\r\n    if (parameters['tr-direction'] === 'In' || parameters['tr-direction'] === 'Out') {\r\n      ports.push({\r\n        name: 'tr-zoom',\r\n        displayName: 'Zoom',\r\n        group: 'Transition',\r\n        type: { name: 'number', units: ['%'] },\r\n        default: { value: 25, unit: '%' },\r\n        plug: 'input'\r\n      });\r\n    } else {\r\n      ports.push({\r\n        name: 'tr-shift',\r\n        displayName: 'Shift Distance',\r\n        group: 'Transition',\r\n        type: { name: 'number', units: ['%', 'px'] },\r\n        default: { value: 25, unit: '%' },\r\n        plug: 'input'\r\n      });\r\n    }\r\n\r\n    ports.push({\r\n      name: 'tr-crossfade',\r\n      displayName: 'Crossfade',\r\n      group: 'Transition',\r\n      type: 'boolean',\r\n      default: false,\r\n      plug: 'input'\r\n    });\r\n\r\n    ports.push({\r\n      name: 'tr-darkoverlay',\r\n      displayName: 'Dark Overlay',\r\n      group: 'Transition',\r\n      type: 'boolean',\r\n      default: true,\r\n      plug: 'input'\r\n    });\r\n\r\n    ports.push({\r\n      name: 'tr-darkoverlayamount',\r\n      displayName: 'Dark Overlay Amount',\r\n      group: 'Transition',\r\n      type: 'number',\r\n      default: 0.5,\r\n      plug: 'input'\r\n    });\r\n\r\n    ports.push({\r\n      name: 'tr-timing',\r\n      displayName: 'Timing',\r\n      group: 'Transition',\r\n      type: 'curve',\r\n      plug: 'input'\r\n    });\r\n\r\n    return ports;\r\n  }\r\n}\r\n\r\nmodule.exports = PushTransition;\r\n","class Transition {\r\n  constructor() {\r\n    this._frame = this.frame.bind(this);\r\n  }\r\n\r\n  start(args) {\r\n    this.cb = args.end;\r\n\r\n    if (this.timing.delay + this.timing.dur === 0) {\r\n      this.end();\r\n    } else {\r\n      this.transitionForward = !args.back;\r\n      this.startTime = window.performance.now();\r\n      requestAnimationFrame(this._frame);\r\n    }\r\n  }\r\n\r\n  frame() {\r\n    var t = (window.performance.now() - (this.startTime + this.timing.delay)) / this.timing.dur;\r\n    var _t = Math.max(0, Math.min(t, 1));\r\n\r\n    this.transitionForward ? this.forward(_t) : this.back(_t);\r\n\r\n    if (window.performance.now() <= this.startTime + this.timing.dur + this.timing.delay)\r\n      requestAnimationFrame(this._frame);\r\n    else this.end();\r\n  }\r\n\r\n  end() {\r\n    this.cb && this.cb();\r\n  }\r\n}\r\n\r\nmodule.exports = Transition;\r\n","'use strict';\r\n\r\nvar EaseCurves = require('../../easecurves');\r\n\r\nvar defaultDuration = 300;\r\n\r\nvar AnimateToValue = {\r\n  name: 'net.noodl.animatetovalue',\r\n  docs: 'https://docs.noodl.net/nodes/logic/animate-to-value',\r\n  displayName: 'Animate To Value',\r\n  shortDesc: 'This node can interpolate smooothely from the current value to a target value.',\r\n  category: 'Animation',\r\n  initialize: function () {\r\n    var self = this,\r\n      _internal = this._internal;\r\n\r\n    _internal.currentNumber = 0;\r\n    _internal.numberInitialized = false;\r\n    _internal.animationStarted = false;\r\n    _internal.setCurrentNumberEnabled = false;\r\n    _internal.overrideValue = 0;\r\n\r\n    _internal._animation = this.context.timerScheduler.createTimer({\r\n      duration: defaultDuration,\r\n      startValue: 0,\r\n      endValue: 0,\r\n      ease: EaseCurves.easeOut,\r\n      onStart: function () {\r\n        _internal.animationStarted = true;\r\n      },\r\n      onRunning: function (t) {\r\n        _internal.currentNumber = this.ease(this.startValue, this.endValue, t);\r\n        self.flagOutputDirty('currentValue');\r\n      },\r\n      onFinish: function () {\r\n        self.sendSignalOnOutput('atTargetValue');\r\n      }\r\n    });\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.currentNumber;\r\n  },\r\n  inputs: {\r\n    targetValue: {\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      displayName: 'Target Value',\r\n      group: 'Target Value',\r\n      default: undefined, //default is undefined so transition initializes to the first input value\r\n      set: function (value) {\r\n        if (value === true) {\r\n          value = 1;\r\n        } else if (value === false) {\r\n          value = 0;\r\n        }\r\n\r\n        value = Number(value);\r\n\r\n        if (isNaN(value)) {\r\n          //bail out on NaN values\r\n          return;\r\n        }\r\n\r\n        var internal = this._internal;\r\n\r\n        if (internal.numberInitialized === false) {\r\n          internal.currentNumber = value;\r\n          internal.numberInitialized = true;\r\n          internal._animation.endValue = value;\r\n          this.flagOutputDirty('currentValue');\r\n          return;\r\n        } else if (value === internal._animation.endValue) {\r\n          //same as previous value\r\n          return;\r\n        }\r\n\r\n        internal._animation.startValue = internal.currentNumber;\r\n        internal._animation.endValue = value;\r\n        internal._animation.start();\r\n      }\r\n    },\r\n    duration: {\r\n      type: 'number',\r\n      group: 'Parameters',\r\n      displayName: 'Duration',\r\n      default: defaultDuration,\r\n      set: function (value) {\r\n        this._internal._animation.duration = value;\r\n      }\r\n    },\r\n    delay: {\r\n      type: 'number',\r\n      group: 'Parameters',\r\n      displayName: 'Delay',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal._animation.delay = value;\r\n      }\r\n    },\r\n    easingCurve: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { value: 'easeOut', label: 'Ease Out' },\r\n          { value: 'easeIn', label: 'Ease In' },\r\n          { value: 'linear', label: 'Linear' },\r\n          { value: 'easeInOut', label: 'Ease In Out' }\r\n        ]\r\n      },\r\n      default: 'easeOut',\r\n      displayName: 'Easing Curve',\r\n      group: 'Parameters',\r\n      set: function (value) {\r\n        this._internal._animation.ease = EaseCurves[value];\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    currentValue: {\r\n      type: 'number',\r\n      displayName: 'Current Value',\r\n      group: 'Current State',\r\n      getter: function () {\r\n        return this._internal.currentNumber;\r\n      }\r\n    },\r\n    atTargetValue: {\r\n      type: 'signal',\r\n      displayName: 'At Target Value',\r\n      group: 'Signals'\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: AnimateToValue\r\n};\r\n","'use strict';\r\n\r\nconst EaseCurves = require('../../easecurves');\r\n\r\nfunction clamp(min, max, value) {\r\n  return Math.max(min, Math.min(max, value));\r\n}\r\n\r\nfunction setRGB(result, hex) {\r\n  for (var i = 0; i < 3; ++i) {\r\n    var index = 1 + i * 2;\r\n    result[i] = parseInt(hex.substring(index, index + 2), 16);\r\n  }\r\n}\r\n\r\nfunction componentToHex(c) {\r\n  var hex = c.toString(16);\r\n  return hex.length == 1 ? '0' + hex : hex;\r\n}\r\n\r\nfunction rgbToHex(rgb) {\r\n  return '#' + componentToHex(rgb[0]) + componentToHex(rgb[1]) + componentToHex(rgb[2]);\r\n}\r\n\r\n//reusing these to reduce GC pressure\r\nlet rgb0 = [0, 0, 0];\r\nlet rgb1 = [0, 0, 0];\r\nlet rgb2 = [0, 0, 0];\r\n\r\nconst ColorBlendNode = {\r\n  name: 'Color Blend',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/color-blend',\r\n  shortDesc:\r\n    'Given any number of input colors this node can interpolate between these and give the result color as output.',\r\n  category: 'Interpolation',\r\n  getInspectInfo() {\r\n    return [{ type: 'color', value: this._internal.resultColor }];\r\n  },\r\n  initialize() {\r\n    const internal = this._internal;\r\n\r\n    internal.resultColor = '#000000';\r\n    internal.blendValue = 0;\r\n    internal.colors = [];\r\n  },\r\n  numberedInputs: {\r\n    color: {\r\n      type: 'color',\r\n      displayPrefix: 'Color',\r\n      createSetter(index) {\r\n        return function (value) {\r\n          this._internal.colors[index] = value;\r\n          this.updateColor();\r\n        };\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    blendValue: {\r\n      type: 'number',\r\n      displayName: 'Blend Value',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal.blendValue = value;\r\n        this.updateColor();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: 'color',\r\n      displayName: 'Result',\r\n      getter: function () {\r\n        return this._internal.resultColor;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    updateColor() {\r\n      var colors = this._internal.colors;\r\n      if (colors.length === 0) {\r\n        return;\r\n      }\r\n\r\n      function getColor(index) {\r\n        return colors[index] ? colors[index] : '#000000';\r\n      }\r\n\r\n      var clampedBlendValue = clamp(0, colors.length - 1, this._internal.blendValue);\r\n      var index = Math.floor(clampedBlendValue);\r\n      var t = clampedBlendValue - index;\r\n\r\n      if (t === 0) {\r\n        this._internal.resultColor = getColor(index);\r\n      } else {\r\n        setRGB(rgb0, getColor(index));\r\n        setRGB(rgb1, getColor(index + 1));\r\n\r\n        rgb2[0] = Math.floor(EaseCurves.linear(rgb0[0], rgb1[0], t));\r\n        rgb2[1] = Math.floor(EaseCurves.linear(rgb0[1], rgb1[1], t));\r\n        rgb2[2] = Math.floor(EaseCurves.linear(rgb0[2], rgb1[2], t));\r\n        this._internal.resultColor = rgbToHex(rgb2);\r\n      }\r\n\r\n      this.flagOutputDirty('result');\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: ColorBlendNode\r\n};\r\n","'use strict';\r\n\r\nconst Model = require('@noodl/runtime/src/model');\r\n\r\nfunction extendSetComponentObjectProperties(def) {\r\n  const SetComponentObjectProperties = {\r\n    name: def.name,\r\n    displayNodeName: def.displayName,\r\n    category: 'Component Utilities',\r\n    color: 'component',\r\n    docs: def.docs,\r\n    initialize: function () {\r\n      this._internal.inputValues = {};\r\n    },\r\n    inputs: {\r\n      properties: {\r\n        type: {\r\n          name: 'stringlist',\r\n          allowEditOnly: true\r\n        },\r\n        displayName: 'Properties',\r\n        group: 'Properties',\r\n        set(value) {}\r\n      },\r\n      store: {\r\n        type: 'signal',\r\n        group: 'Actions',\r\n        displayName: 'Do',\r\n        valueChangedToTrue() {\r\n          this.scheduleStore();\r\n        }\r\n      }\r\n    },\r\n    outputs: {\r\n      stored: {\r\n        type: 'signal',\r\n        group: 'Events',\r\n        displayName: 'Done'\r\n      }\r\n    },\r\n    methods: {\r\n      getComponentObjectId: def.getComponentObjectId,\r\n      scheduleStore() {\r\n        if (this.hasScheduledStore) return;\r\n        this.hasScheduledStore = true;\r\n\r\n        var internal = this._internal;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const model = Model.get(this.getComponentObjectId());\r\n          this.hasScheduledStore = false;\r\n\r\n          const properties = this.model.parameters.properties || '';\r\n          const validProperties = properties.split(',');\r\n\r\n          const keysToSet = Object.keys(internal.inputValues).filter((key) => validProperties.indexOf(key) !== -1);\r\n\r\n          for (const i of keysToSet) {\r\n            model.set(i, internal.inputValues[i], { resolve: true });\r\n          }\r\n          this.sendSignalOnOutput('stored');\r\n        });\r\n      },\r\n      registerInputIfNeeded: function (name) {\r\n        if (this.hasInput(name)) {\r\n          return;\r\n        }\r\n\r\n        if (name.startsWith('prop-')) {\r\n          const propertyName = name.substring('prop-'.length);\r\n          this.registerInput(name, {\r\n            set(value) {\r\n              this._internal.inputValues[propertyName] = value;\r\n            }\r\n          });\r\n        } else if (name.startsWith('type-')) {\r\n          this.registerInput(name, {\r\n            set(value) {}\r\n          });\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  function updatePorts(nodeId, parameters, editorConnection) {\r\n    var ports = [];\r\n\r\n    const _types = [\r\n      { label: 'String', value: 'string' },\r\n      { label: 'Boolean', value: 'boolean' },\r\n      { label: 'Number', value: 'number' },\r\n      { label: 'Date', value: 'date' },\r\n      { label: 'Array', value: 'array' },\r\n      { label: 'Object', value: 'object' },\r\n      { label: 'Any', value: '*' }\r\n    ];\r\n\r\n    // Add value outputs\r\n    var properties = parameters.properties;\r\n    if (properties) {\r\n      properties = properties ? properties.split(',') : undefined;\r\n      for (var i in properties) {\r\n        var p = properties[i];\r\n\r\n        // Property input\r\n        ports.push({\r\n          type: {\r\n            name: parameters['type-' + p] === undefined ? '*' : parameters['type-' + p]\r\n          },\r\n          plug: 'input',\r\n          group: 'Property Values',\r\n          displayName: p,\r\n          //  editorName:p,\r\n          name: 'prop-' + p\r\n        });\r\n\r\n        // Property type\r\n        ports.push({\r\n          type: {\r\n            name: 'enum',\r\n            enums: _types,\r\n            allowEditOnly: true\r\n          },\r\n          plug: 'input',\r\n          group: 'Property Types',\r\n          displayName: p,\r\n          default: '*',\r\n          name: 'type-' + p\r\n        });\r\n      }\r\n    }\r\n\r\n    editorConnection.sendDynamicPorts(nodeId, ports, {\r\n      detectRenamed: {\r\n        plug: 'input'\r\n      }\r\n    });\r\n  }\r\n\r\n  return {\r\n    node: SetComponentObjectProperties,\r\n    setup: function (context, graphModel) {\r\n      if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n        return;\r\n      }\r\n\r\n      graphModel.on('nodeAdded.' + def.name, (node) => {\r\n        updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n        node.on('parameterUpdated', (event) => {\r\n          if (event.name === 'properties' || event.name.startsWith('type-')) {\r\n            updatePorts(node.id, node.parameters, context.editorConnection);\r\n          }\r\n        });\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\nmodule.exports = {\r\n  extendSetComponentObjectProperties\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\nconst Model = require('@noodl/runtime/src/model');\r\n\r\nconst ComponentObject = {\r\n  name: 'net.noodl.ComponentObject',\r\n  displayNodeName: 'Component Object',\r\n  category: 'Component Utilities',\r\n  color: 'component',\r\n  docs: 'https://docs.noodl.net/nodes/component-utilities/component-object',\r\n  initialize: function () {\r\n    this._internal.inputValues = {};\r\n    this._internal.dirtyValues = {};\r\n\r\n    this._internal.onModelChangedCallback = (args) => {\r\n      if (this.isInputConnected('fetch') !== false) return;\r\n\r\n      if (this.hasOutput('value-' + args.name)) {\r\n        this.flagOutputDirty('value-' + args.name);\r\n      }\r\n\r\n      if (this.hasOutput('changed-' + args.name)) {\r\n        this.sendSignalOnOutput('changed-' + args.name);\r\n      }\r\n\r\n      this.sendSignalOnOutput('changed');\r\n    };\r\n\r\n    const model = Model.get('componentState' + this.nodeScope.componentOwner.getInstanceId());\r\n    this._internal.model = model;\r\n\r\n    model.on('change', this._internal.onModelChangedCallback);\r\n  },\r\n  getInspectInfo() {\r\n    return {\r\n      type: 'value',\r\n      value: this._internal.model.data\r\n    };\r\n  },\r\n  inputs: {\r\n    properties: {\r\n      type: {\r\n        name: 'stringlist',\r\n        allowEditOnly: true\r\n      },\r\n      displayName: 'Properties',\r\n      group: 'Properties',\r\n      set(value) {}\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleFetch();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  methods: {\r\n    scheduleStore() {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledStore = false;\r\n        for (var i in internal.dirtyValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n        internal.dirtyValues = {};\r\n      });\r\n    },\r\n    scheduleFetch() {\r\n      if (this.hasScheduledFetch) return;\r\n      this.hasScheduledFetch = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledFetch = false;\r\n        this.fetch();\r\n      });\r\n    },\r\n    fetch() {\r\n      for (var key in this._internal.model.data) {\r\n        if (this.hasOutput('value-' + key)) {\r\n          this.flagOutputDirty('value-' + key);\r\n          if (this.hasOutput('changed-' + key)) {\r\n            this.sendSignalOnOutput('changed-' + key);\r\n          }\r\n        }\r\n      }\r\n      this.sendSignalOnOutput('fetched');\r\n    },\r\n    _onNodeDeleted() {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n    },\r\n    registerOutputIfNeeded(name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      const split = name.split('-');\r\n      const propertyName = split[split.length - 1];\r\n\r\n      this.registerOutput(name, {\r\n        get() {\r\n          return this._internal.model.get(propertyName, { resolve: true });\r\n        }\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('value-')) {\r\n        const propertyName = name.substring('value-'.length);\r\n        this.registerInput(name, {\r\n          set(value) {\r\n            this._internal.inputValues[propertyName] = value;\r\n            this._internal.dirtyValues[propertyName] = true;\r\n\r\n            this.scheduleStore();\r\n          }\r\n        });\r\n      }\r\n      /*  else if (name.startsWith('start-value-')) {\r\n                this.registerInput(name, {\r\n                    set(value) {\r\n                        this._internal.model.set(propertyName, value)\r\n                    }\r\n                });\r\n            }\r\n            else if (name.startsWith('type-')) {\r\n                this.registerInput(name, {\r\n                    set(value) {}\r\n                });\r\n            }*/\r\n    }\r\n  }\r\n};\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection) {\r\n  const ports = [];\r\n\r\n  // Add value outputs\r\n  if (parameters.properties) {\r\n    var properties = parameters.properties.split(',');\r\n    for (var i in properties) {\r\n      var p = properties[i];\r\n\r\n      ports.push({\r\n        type: {\r\n          name: '*',\r\n          allowConnectionsOnly: true\r\n        },\r\n        plug: 'input/output',\r\n        group: 'Properties',\r\n        name: 'value-' + p,\r\n        displayName: p\r\n      });\r\n      /*   ports.push({\r\n                type: {\r\n                    name: parameters['type-' + p] || 'string',\r\n                    allowEditOnly: true\r\n                },\r\n                plug: 'input',\r\n                group: 'Start Values',\r\n                name: 'start-value-' + p,\r\n                displayName: p\r\n            });\r\n\r\n            ports.push({\r\n                type: {\r\n                    name: 'enum',\r\n                    enums: [\r\n                        { label: 'Number', value: 'number' },\r\n                        { label: 'String', value: 'string' },\r\n                        { label: 'Boolean', value: 'boolean' },\r\n                        { label: 'Color', value: 'color' },\r\n                        { label: 'Image', value: 'image' }\r\n                    ],\r\n                    allowEditOnly: true\r\n                },\r\n                default: 'string',\r\n                plug: 'input',\r\n                group: 'Types',\r\n                displayName: p,\r\n                name: 'type-' + p,\r\n            });*/\r\n\r\n      ports.push({\r\n        type: 'signal',\r\n        plug: 'output',\r\n        group: 'Changed Events',\r\n        displayName: p + ' Changed',\r\n        name: 'changed-' + p\r\n      });\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: 'input/output'\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: ComponentObject,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.net.noodl.ComponentObject', (node) => {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n      node.on('parameterUpdated', (event) => {\r\n        if (event.name === 'properties') {\r\n          updatePorts(node.id, node.parameters, context.editorConnection);\r\n        }\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\nconst Model = require('@noodl/runtime/src/model');\r\nconst EventEmitter = require('events').EventEmitter;\r\n\r\nconst graphEventEmitter = new EventEmitter();\r\ngraphEventEmitter.setMaxListeners(1000000);\r\n\r\nconst ParentComponentObject = {\r\n  name: 'net.noodl.ParentComponentObject',\r\n  displayNodeName: 'Parent Component Object',\r\n  category: 'Component Utilities',\r\n  color: 'component',\r\n  docs: 'https://docs.noodl.net/nodes/component-utilities/parent-component-object',\r\n  initialize() {\r\n    this._internal.inputValues = {};\r\n\r\n    this._internal.onModelChangedCallback = (args) => {\r\n      if (this.isInputConnected('fetch') !== false) return;\r\n\r\n      if (this.hasOutput('value-' + args.name)) {\r\n        this.flagOutputDirty('value-' + args.name);\r\n      }\r\n\r\n      if (this.hasOutput('changed-' + args.name)) {\r\n        this.sendSignalOnOutput('changed-' + args.name);\r\n      }\r\n\r\n      this.sendSignalOnOutput('changed');\r\n    };\r\n\r\n    //TODO: don't listen for delta updates when running deployed\r\n    this.onComponentStateNodesChanged = () => {\r\n      const id = this.findParentComponentStateModelId();\r\n\r\n      if (this._internal.modelId !== id) {\r\n        this._internal.modelId = id;\r\n\r\n        if (this.isInputConnected('fetch') === false) {\r\n          this.setModelId(this._internal.modelId);\r\n        }\r\n      }\r\n    };\r\n\r\n    graphEventEmitter.on('componentStateNodesChanged', this.onComponentStateNodesChanged);\r\n\r\n    this.updateComponentState();\r\n  },\r\n  //to search up the tree the root nodes in this component must have been initialized\r\n  //we also need the connections to be setup so we can use isInputConnected\r\n  //nodeScopeDidInitialize takes care of that\r\n  nodeScopeDidInitialize() {\r\n    //FIXME: temporary hack. Our parent's node scope might not have finished created yet\r\n    //so just wait until after this update. It'll make the parent component state\r\n    //have a delay in propagating outputs which can cause subtle bugs.\r\n    //The fix is to call this code when the entire node tree has been created,\r\n    //before running updating the next update.\r\n    if (!this._internal.modelId) {\r\n      this.context.scheduleAfterUpdate(() => {\r\n        this.updateComponentState();\r\n      });\r\n    }\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return 'No parent component state found';\r\n\r\n    const modelInfo = [{ type: 'text', value: this._internal.parentComponentName }];\r\n\r\n    const data = this._internal.model.data;\r\n    return modelInfo.concat(\r\n      Object.keys(data).map((key) => {\r\n        return { type: 'text', value: key + ': ' + data[key] };\r\n      })\r\n    );\r\n  },\r\n  inputs: {\r\n    properties: {\r\n      type: {\r\n        name: 'stringlist',\r\n        allowEditOnly: true\r\n      },\r\n      displayName: 'Properties',\r\n      group: 'Properties',\r\n      set(value) {}\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.setModelId(this._internal.modelId);\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  methods: {\r\n    updateComponentState() {\r\n      this._internal.modelId = this.findParentComponentStateModelId();\r\n      if (this.isInputConnected('fetch') === false) {\r\n        this.setModelId(this._internal.modelId);\r\n      }\r\n    },\r\n    findParentComponentStateModelId() {\r\n      function getParentComponent(component) {\r\n        let parent;\r\n        if (component.getRoots().length > 0) {\r\n          //visual\r\n          const root = component.getRoots()[0];\r\n\r\n          if (root.getVisualParentNode) {\r\n            //regular visual node\r\n            if (root.getVisualParentNode()) {\r\n              parent = root.getVisualParentNode().nodeScope.componentOwner;\r\n            }\r\n          } else if (root.parentNodeScope) {\r\n            //component instance node\r\n            parent = component.parentNodeScope.componentOwner;\r\n          }\r\n        } else if (component.parentNodeScope) {\r\n          parent = component.parentNodeScope.componentOwner;\r\n        }\r\n\r\n        //check that a parent exists and that the component is different\r\n        if (parent && parent.nodeScope && parent.nodeScope.componentOwner !== component) {\r\n          //check if parent has a Component State node\r\n          if (parent.nodeScope.getNodesWithType('net.noodl.ComponentObject').length > 0) {\r\n            return parent;\r\n          }\r\n\r\n          //if not, continue searching up the tree\r\n          return getParentComponent(parent);\r\n        }\r\n      }\r\n\r\n      const parent = getParentComponent(this.nodeScope.componentOwner);\r\n      if (!parent) return;\r\n\r\n      this._internal.parentComponentName = parent.name;\r\n\r\n      return 'componentState' + parent.getInstanceId();\r\n    },\r\n    setModelId(id) {\r\n      this._internal.model && this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n      this._internal.model = undefined;\r\n\r\n      if (!id) return;\r\n\r\n      const model = Model.get(id);\r\n      this._internal.model = model;\r\n\r\n      model.on('change', this._internal.onModelChangedCallback);\r\n\r\n      for (var key in model.data) {\r\n        if (this.hasOutput('value-' + key)) {\r\n          this.flagOutputDirty('value-' + key);\r\n        }\r\n        if (this.hasOutput('changed-' + key)) {\r\n          this.sendSignalOnOutput('changed-' + key);\r\n        }\r\n      }\r\n\r\n      this.sendSignalOnOutput('changed');\r\n      this.sendSignalOnOutput('fetched');\r\n    },\r\n    scheduleStore() {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledStore = false;\r\n        if (!internal.model) return;\r\n        for (var i in internal.inputValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n      });\r\n    },\r\n    _onNodeDeleted() {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n\r\n      graphEventEmitter.off('componentStateNodesChanged', this.onComponentStateNodesChanged);\r\n      this._internal.model && this._internal.model.off('change', this._internal.onModelChangedCallback);\r\n    },\r\n    registerOutputIfNeeded(name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      const propertyName = name.substring('value-'.length);\r\n\r\n      this.registerOutput(name, {\r\n        get() {\r\n          if (!this._internal.model) return undefined;\r\n          return this._internal.model.get(propertyName, { resolve: true });\r\n        }\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('value-')) {\r\n        const propertyName = name.substring('value-'.length);\r\n        this.registerInput(name, {\r\n          set(value) {\r\n            this._internal.inputValues[propertyName] = value;\r\n\r\n            this.scheduleStore();\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection) {\r\n  const ports = [];\r\n\r\n  // Add value outputs\r\n  var properties = parameters.properties && parameters.properties.split(',');\r\n  for (var i in properties) {\r\n    var p = properties[i];\r\n\r\n    ports.push({\r\n      type: {\r\n        name: '*', //parameters['type-' + p] || 'string',\r\n        allowConnectionsOnly: true\r\n      },\r\n      plug: 'input/output',\r\n      group: 'Properties',\r\n      name: 'value-' + p,\r\n      displayName: p\r\n    });\r\n\r\n    ports.push({\r\n      type: 'signal',\r\n      plug: 'output',\r\n      group: 'Changed Events',\r\n      displayName: p + ' Changed',\r\n      name: 'changed-' + p\r\n    });\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: 'input/output'\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: ParentComponentObject,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.net.noodl.ParentComponentObject', (node) => {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n      node.on('parameterUpdated', (event) => {\r\n        updatePorts(node.id, node.parameters, context.editorConnection);\r\n      });\r\n    });\r\n\r\n    //TODO: handle additional delta update event:\r\n    // - visual parent changed\r\n\r\n    //this are the same events that'll create and delete the Comopent State instance node\r\n    //it might not have had a chance to run yet if we're first in the event list, so\r\n    //use a setTimeout\r\n    graphModel.on('nodeAdded.net.noodl.ComponentObject', (node) => {\r\n      setTimeout(() => {\r\n        graphEventEmitter.emit('componentStateNodesChanged');\r\n      }, 0);\r\n    });\r\n    graphModel.on('nodeRemoved.net.noodl.ComponentObject', (node) => {\r\n      setTimeout(() => {\r\n        graphEventEmitter.emit('componentStateNodesChanged');\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst Base = require('./base');\r\n\r\nmodule.exports = Base.extendSetComponentObjectProperties({\r\n  name: 'net.noodl.SetComponentObjectProperties',\r\n  displayName: 'Set Component Object Properties',\r\n  docs: 'https://docs.noodl.net/nodes/component-utilities/set-component-object-properties',\r\n  getComponentObjectId: function () {\r\n    return 'componentState' + this.nodeScope.componentOwner.getInstanceId();\r\n  }\r\n});\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\nconst Model = require('@noodl/runtime/src/model');\r\n\r\nconst Base = require('./base');\r\n\r\nmodule.exports = Base.extendSetComponentObjectProperties({\r\n  name: 'net.noodl.SetParentComponentObjectProperties',\r\n  displayName: 'Set Parent Component Object Properties',\r\n  docs: 'https://docs.noodl.net/nodes/component-utilities/set-parent-component-object-properties',\r\n  getComponentObjectId: function () {\r\n    function getParentComponent(component) {\r\n      let parent;\r\n      if (component.getRoots().length > 0) {\r\n        //visual\r\n        const root = component.getRoots()[0];\r\n\r\n        if (root.getVisualParentNode) {\r\n          //regular visual node\r\n          if (root.getVisualParentNode()) {\r\n            parent = root.getVisualParentNode().nodeScope.componentOwner;\r\n          }\r\n        } else if (root.parentNodeScope) {\r\n          //component instance node\r\n          parent = component.parentNodeScope.componentOwner;\r\n        }\r\n      } else if (component.parentNodeScope) {\r\n        parent = component.parentNodeScope.componentOwner;\r\n      }\r\n\r\n      //check that a parent exists and that the component is different\r\n      if (parent && parent.nodeScope && parent.nodeScope.componentOwner !== component) {\r\n        //check if parent has a Component State node\r\n        if (parent.nodeScope.getNodesWithType('net.noodl.ComponentObject').length > 0) {\r\n          return parent;\r\n        }\r\n\r\n        //if not, continue searching up the tree\r\n        return getParentComponent(parent);\r\n      }\r\n    }\r\n\r\n    const parent = getParentComponent(this.nodeScope.componentOwner);\r\n    if (!parent) return;\r\n\r\n    this._internal.parentComponentName = parent.name;\r\n\r\n    return 'componentState' + parent.getInstanceId();\r\n  }\r\n});\r\n","const NoodlRuntime = require('@noodl/runtime');\r\nconst CloudStore = require('@noodl/runtime/src/api/cloudstore');\r\n\r\n('use strict');\r\n\r\n/*var defaultBeforeCallScript = \"// Add custom code to setup the parameters send to the function\\n\"+\r\n\"// The parameters are found in the object called 'Parameters'\\n\";\r\n\r\nvar defaultAfterCallScript = \"// Add custom code modfiy the result from the cloud function\\n\"+\r\n\"// The result is found in the object called 'Result'\\n\";*/\r\n\r\nfunction _makeRequest(path, options) {\r\n  var xhr = new XMLHttpRequest();\r\n\r\n  xhr.onreadystatechange = function () {\r\n    if (xhr.readyState === 4) {\r\n      var json;\r\n      try {\r\n        json = JSON.parse(xhr.response);\r\n      } catch (e) {}\r\n\r\n      if (xhr.status === 200 || xhr.status === 201) {\r\n        options.success(json);\r\n      } else options.error(json);\r\n    }\r\n  };\r\n\r\n  xhr.open(options.method || 'GET', options.endpoint + path, true);\r\n\r\n  xhr.setRequestHeader('X-Parse-Application-Id', options.appId);\r\n  xhr.setRequestHeader('Content-Type', 'application/json');\r\n\r\n  // Check for current users\r\n  var _cu = localStorage['Parse/' + options.appId + '/currentUser'];\r\n  if (_cu !== undefined) {\r\n    try {\r\n      const currentUser = JSON.parse(_cu);\r\n      xhr.setRequestHeader('X-Parse-Session-Token', currentUser.sessionToken);\r\n    } catch (e) {\r\n      // Failed to extract session token\r\n    }\r\n  }\r\n\r\n  xhr.send(JSON.stringify(options.content));\r\n}\r\n\r\nvar CloudFunctionNode = {\r\n  name: 'Cloud Function',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  usePortAsLabel: 'functionName',\r\n  docs: 'https://docs.noodl.net/nodes/data/cloud-data/cloud-function',\r\n  deprecated: true,\r\n  initialize: function () {\r\n    this._internal.paramsValues = {};\r\n    // this._internal.resultsValues = {};\r\n    // this._internal.convertArraysAndObjects = true;\r\n  },\r\n  getInspectInfo() {\r\n    const result = this._internal.lastCallResult;\r\n    if (!result) return '[Not executed yet]';\r\n\r\n    return [{ type: 'value', value: result }];\r\n  },\r\n  inputs: {\r\n    functionName: {\r\n      type: 'string',\r\n      displayName: 'Function Name',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.functionName = value;\r\n      }\r\n    },\r\n    params: {\r\n      group: 'Parameters',\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      set: function (value) {\r\n        this._internal.params = value;\r\n      }\r\n    },\r\n    /* results:{\r\n        group:'Result',\r\n        type:{name:'stringlist',allowEditOnly:true},\r\n        set:function(value) {\r\n            this._internal.results = value;\r\n        }\r\n    },    \r\n    beforeCallScript: {\r\n        group:'Scripts',\r\n        displayName:'Before Call',\r\n        default:defaultBeforeCallScript,\r\n        type:{name:'string',codeeditor:'javascript'},\r\n        set: function(scriptCode) {\r\n            try {\r\n                if(scriptCode !== undefined) {\r\n                    var args = ['Parameters'].concat([scriptCode]);\r\n                    this._internal.scriptBeforeCallFunc = Function.apply(null,args);\r\n                }\r\n            }\r\n            catch(e) {\r\n                this._internal.scriptBeforeCallFunc = undefined;\r\n                console.log('Error while parsing script (before call): ' +  e);\r\n            }  \r\n        }\r\n    },\r\n    afterCallScript: {\r\n        group:'Scripts',\r\n        displayName:'After Call',\r\n        default:defaultAfterCallScript,\r\n        type:{name:'string',codeeditor:'javascript'},\r\n        set: function(scriptCode) {\r\n            try {\r\n                if(scriptCode !== undefined) {\r\n                    var args = ['Result'].concat([scriptCode]);\r\n                    this._internal.scriptAfterCallFunc = Function.apply(null,args);\r\n                }\r\n            }\r\n            catch(e) {\r\n                this._internal.scriptAfterCallFunc = undefined;\r\n                console.log('Error while parsing script (after call): ' +  e);\r\n            }  \r\n        }\r\n    },*/\r\n    call: {\r\n      type: 'signal',\r\n      displayName: 'Call',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleCall();\r\n      }\r\n    }\r\n    /* convertArraysAndObjects:{\r\n        group:'Advanced',\r\n        displayName:'Convert Objects',\r\n        type:'boolean',\r\n        default:true,\r\n        set: function(value) {\r\n            this._internal.convertArraysAndObjects = value;\r\n        } \r\n    }*/\r\n  },\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Signals'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Signals'\r\n    },\r\n    result: {\r\n      type: '*',\r\n      displayName: 'Result',\r\n      group: 'Output',\r\n      getter: function () {\r\n        return this._internal.result;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    /* getResultsValue:function(name) {\r\n        return this._internal.resultsValues[name];\r\n    },*/\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      /*  if(name.startsWith('res-')) this.registerOutput(name, {\r\n          getter: this.getResultsValue.bind(this, name.substring('res-'.length))\r\n      });*/\r\n    },\r\n    setParamsValue: function (name, value) {\r\n      this._internal.paramsValues[name] = value;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('pm-'))\r\n        this.registerInput(name, {\r\n          set: this.setParamsValue.bind(this, name.substring('pm-'.length))\r\n        });\r\n    },\r\n    scheduleCall: function () {\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledCall) {\r\n        internal.hasScheduledCall = true;\r\n        this.scheduleAfterInputsHaveUpdated(this.doCall.bind(this));\r\n      }\r\n    },\r\n    doCall: function () {\r\n      this._internal.hasScheduledCall = false;\r\n\r\n      const cloudServices = NoodlRuntime.instance.getMetaData('cloudservices');\r\n      if (cloudServices === undefined) {\r\n        console.log('No cloud services defined in this project.');\r\n        this._internal.lastCallResult = {\r\n          status: 'failure',\r\n          res: 'No active cloud services in this project'\r\n        };\r\n\r\n        this.sendSignalOnOutput('failure');\r\n        return;\r\n      }\r\n\r\n      var appId = cloudServices.appId;\r\n      var endpoint = cloudServices.endpoint;\r\n      // Run before call script\r\n      /*  if(this._internal.scriptBeforeCallFunc !== undefined) {\r\n            this._internal.scriptBeforeCallFunc(this._internal.paramsValues);\r\n        }*/\r\n\r\n      _makeRequest('/functions/' + encodeURIComponent(this._internal.functionName), {\r\n        appId,\r\n        endpoint,\r\n        content: this._internal.paramsValues,\r\n        method: 'POST',\r\n        success: (res) => {\r\n          var res = res.result; // Cloud functions always return \"result\"\r\n          if (res === undefined) {\r\n            this.sendSignalOnOutput('failure');\r\n            return;\r\n          }\r\n\r\n          // Run after call script\r\n          /* if(this._internal.scriptAfterCallFunc !== undefined) {\r\n                    this._internal.scriptAfterCallFunc(res);\r\n                }*/\r\n\r\n          this._internal.result = CloudStore._deserializeJSON(res);\r\n          this.flagOutputDirty('result');\r\n\r\n          this._internal.lastCallResult = {\r\n            status: 'success',\r\n            result: this._internal.result\r\n          };\r\n\r\n          // Deserialize values into Noodl arrays and objects\r\n          /*  if(this._internal.convertArraysAndObjects) {\r\n                    for(var key in res) {\r\n                        if(res[key] !== undefined)\r\n                            res[key] = CloudStore._fromJSON(res[key]);\r\n                    }\r\n                }*/\r\n\r\n          /*this._internal.resultsValues = res;\r\n\r\n                for(var key in res) {\r\n                    if(this.hasOutput('res-'+key)) {\r\n                        this.flagOutputDirty('res-'+key);\r\n                    }\r\n                }*/\r\n\r\n          this.sendSignalOnOutput('success');\r\n        },\r\n        error: (res) => {\r\n          this._internal.lastCallResult = {\r\n            status: 'failure',\r\n            res\r\n          };\r\n\r\n          this.sendSignalOnOutput('failure');\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CloudFunctionNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _updatePorts() {\r\n        var ports = [];\r\n\r\n        // Add results outputs\r\n        /*    var results = node.parameters.results;\r\n                if (results !== undefined) {\r\n                    results = results.split(',');\r\n                    for (var i in results) {\r\n                        var p = results[i];\r\n\r\n                        ports.push({\r\n                            type: {\r\n                                name: '*',\r\n                            },\r\n                            plug: 'output',\r\n                            group: 'Results',\r\n                            name: 'res-' + p,\r\n                            displayName: p\r\n                        });\r\n\r\n                    }\r\n                }*/\r\n\r\n        // Add params inputs\r\n        var params = node.parameters.params;\r\n        if (params !== undefined) {\r\n          params = params.split(',');\r\n          for (var i in params) {\r\n            var p = params[i];\r\n\r\n            ports.push({\r\n              type: '*',\r\n              plug: 'input',\r\n              group: 'Parameters',\r\n              name: 'pm-' + p,\r\n              displayName: p\r\n            });\r\n          }\r\n        }\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on('parameterUpdated', function (event) {\r\n        if (event.name === 'params') {\r\n          _updatePorts();\r\n        }\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.Cloud Function', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('Cloud Function')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","const NoodlRuntime = require('@noodl/runtime');\r\nconst CloudStore = require('@noodl/runtime/src/api/cloudstore');\r\n\r\n('use strict');\r\n\r\nfunction _makeRequest(path, options) {\r\n  var xhr = new XMLHttpRequest();\r\n\r\n  xhr.onreadystatechange = function () {\r\n    if (xhr.readyState === 4) {\r\n      var json;\r\n      try {\r\n        json = JSON.parse(xhr.response);\r\n      } catch (e) {}\r\n\r\n      if (xhr.status === 200 || xhr.status === 201) {\r\n        options.success(json);\r\n      } else options.error(json);\r\n    }\r\n  };\r\n\r\n  xhr.open(options.method || 'GET', options.endpoint + path, true);\r\n\r\n  xhr.setRequestHeader('X-Parse-Application-Id', options.appId);\r\n  xhr.setRequestHeader('Content-Type', 'application/json');\r\n\r\n  const cloudServices = NoodlRuntime.instance.getMetaData('cloudservices');\r\n  if (cloudServices && cloudServices.deployVersion) {\r\n    xhr.setRequestHeader('x-noodl-cloud-version', cloudServices.deployVersion);\r\n  }\r\n\r\n  // Check for current users\r\n  var _cu = localStorage['Parse/' + options.appId + '/currentUser'];\r\n  if (_cu !== undefined) {\r\n    try {\r\n      const currentUser = JSON.parse(_cu);\r\n      xhr.setRequestHeader('X-Parse-Session-Token', currentUser.sessionToken);\r\n    } catch (e) {\r\n      // Failed to extract session token\r\n    }\r\n  }\r\n\r\n  xhr.send(JSON.stringify(options.content));\r\n}\r\n\r\nvar CloudFunctionNode = {\r\n  name: 'CloudFunction2',\r\n  displayName: 'Cloud Function',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  usePortAsLabel: 'function',\r\n  docs: 'https://docs.noodl.net/nodes/data/cloud-data/cloud-function',\r\n  initialize: function () {\r\n    this._internal.paramsValues = {};\r\n    this._internal.resultsValues = {};\r\n  },\r\n  getInspectInfo() {\r\n    const result = this._internal.lastCallResult;\r\n    if (!result) return '[Not executed yet]';\r\n\r\n    return [{ type: 'value', value: result }];\r\n  },\r\n  inputs: {\r\n    call: {\r\n      type: 'signal',\r\n      displayName: 'Call',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleCall();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Signals'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Signals'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setError: function (err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n    },\r\n    getResultsValue: function (name) {\r\n      return this._internal.resultsValues[name];\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('out-'))\r\n        this.registerOutput(name, {\r\n          getter: this.getResultsValue.bind(this, name.substring('out-'.length))\r\n        });\r\n    },\r\n    setParamsValue: function (name, value) {\r\n      this._internal.paramsValues[name] = value;\r\n    },\r\n    setFunctionName: function (value) {\r\n      this._internal.functionName = value;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'function')\r\n        this.registerInput(name, {\r\n          set: this.setFunctionName.bind(this)\r\n        });\r\n\r\n      if (name.startsWith('in-'))\r\n        this.registerInput(name, {\r\n          set: this.setParamsValue.bind(this, name.substring('in-'.length))\r\n        });\r\n    },\r\n    scheduleCall: function () {\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledCall) {\r\n        internal.hasScheduledCall = true;\r\n        this.scheduleAfterInputsHaveUpdated(this.doCall.bind(this));\r\n      }\r\n    },\r\n    doCall: function () {\r\n      this._internal.hasScheduledCall = false;\r\n\r\n      const cloudServices = NoodlRuntime.instance.getMetaData('cloudservices');\r\n      if (this.context.editorConnection) {\r\n        if (cloudServices === undefined || cloudServices.endpoint === undefined) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'cloud-function-2', {\r\n            message: 'No cloud services defined in this project.'\r\n          });\r\n        } else if (this._internal.functionName === undefined) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'cloud-function-2', {\r\n            message: 'No function specified'\r\n          });\r\n        } else {\r\n          this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'cloud-function-2');\r\n        }\r\n      }\r\n\r\n      const appId = cloudServices.appId;\r\n      const endpoint = this.context.editorConnection.isRunningLocally()\r\n        ? `http://${window.location.hostname}:8577`\r\n        : cloudServices.endpoint;\r\n\r\n      _makeRequest('/functions/' + encodeURIComponent(this._internal.functionName), {\r\n        appId,\r\n        endpoint,\r\n        content: this._internal.paramsValues,\r\n        method: 'POST',\r\n        success: (res) => {\r\n          if (res === undefined) {\r\n            // No result, still success\r\n\r\n            this._internal.lastCallResult = {\r\n              status: 'success',\r\n              parameters: this._internal.paramsValues,\r\n              results: 'empty'\r\n            };\r\n          } else {\r\n            const results = res.result || {};\r\n            for (let key in results) {\r\n              this._internal.resultsValues[key] = results[key];\r\n              if (this.hasOutput('out-' + key)) this.flagOutputDirty('out-' + key);\r\n            }\r\n\r\n            this._internal.lastCallResult = {\r\n              status: 'success',\r\n              parameters: this._internal.paramsValues,\r\n              results: this._internal.resultsValues\r\n            };\r\n          }\r\n\r\n          this.sendSignalOnOutput('success');\r\n        },\r\n        error: (e) => {\r\n          const error = typeof e === 'string' ? e : e.error || 'Failed running cloud function.';\r\n          this._internal.lastCallResult = {\r\n            status: 'failure',\r\n            error\r\n          };\r\n\r\n          this.setError(error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CloudFunctionNode,\r\n  setup: function (context, graphModel) {\r\n    // Handled in editor adapter\r\n  }\r\n};\r\n","const Collection = require('@noodl/runtime/src/collection');\r\n\r\nconst CollectionClearNode = {\r\n  name: 'CollectionClear',\r\n  docs: 'https://docs.noodl.net/nodes/data/array/clear-array',\r\n  displayNodeName: 'Clear Array',\r\n  category: 'Data',\r\n  usePortAsLabel: 'collectionId',\r\n  color: 'data',\r\n  inputs: {\r\n    collectionId: {\r\n      type: {\r\n        name: 'string',\r\n        identifierOf: 'CollectionName',\r\n        identifierDisplayName: 'Array Ids'\r\n      },\r\n      displayName: 'Array Id',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value instanceof Collection) value = value.getId(); // Can be passed as collection as well\r\n        this.setCollectionID(value);\r\n      }\r\n    },\r\n    clear: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const collection = this._internal.collection;\r\n\r\n          collection.set([]);\r\n          this.sendSignalOnOutput('modified');\r\n        });\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    modified: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Done'\r\n    }\r\n  },\r\n  methods: {\r\n    setCollectionID: function (id) {\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection: function (collection) {\r\n      this._internal.collection = collection;\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CollectionClearNode\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\n\r\nvar Model = require('@noodl/runtime/src/model'),\r\n  Collection = require('@noodl/runtime/src/collection');\r\n\r\nvar CollectionInsertNode = {\r\n  name: 'CollectionInsert',\r\n  docs: 'https://docs.noodl.net/nodes/data/array/insert-into-array',\r\n  displayNodeName: 'Insert Object Into Array',\r\n  shortDesc: 'A collection of models, mainly used together with a For Each Node.',\r\n  category: 'Data',\r\n  usePortAsLabel: 'collectionId',\r\n  color: 'data',\r\n  initialize: function () {},\r\n  inputs: {\r\n    collectionId: {\r\n      type: {\r\n        name: 'string',\r\n        identifierOf: 'CollectionName',\r\n        identifierDisplayName: 'Array Ids'\r\n      },\r\n      displayName: 'Array Id',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value instanceof Collection) value = value.getId(); // Can be passed as collection as well\r\n        this.setCollectionID(value);\r\n      }\r\n    },\r\n    modifyId: {\r\n      type: { name: 'string', allowConnectionsOnly: true },\r\n      displayName: 'Object Id',\r\n      group: 'Modify',\r\n      set: function (value) {\r\n        this._internal.modifyId = value;\r\n      }\r\n    },\r\n    add: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        var _this = this;\r\n        var internal = this._internal;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          if (this.context.editorConnection) {\r\n            this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'insert-warning');\r\n          }\r\n\r\n          if (internal.modifyId === undefined) {\r\n            if (this.context.editorConnection) {\r\n              this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'insert-warning', {\r\n                showGlobally: true,\r\n                message: 'No Object Id specified'\r\n              });\r\n            }\r\n            return;\r\n          }\r\n\r\n          if (internal.collection === undefined) {\r\n            if (this.context.editorConnection) {\r\n              this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'insert-warning', {\r\n                showGlobally: true,\r\n                message: 'No Array Id specified'\r\n              });\r\n            }\r\n            return;\r\n          }\r\n\r\n          var model = Model.get(internal.modifyId);\r\n          internal.collection.add(model);\r\n          _this.sendSignalOnOutput('modified');\r\n        });\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    modified: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Done'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionID: function (id) {\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection: function (collection) {\r\n      this._internal.collection = collection;\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CollectionInsertNode\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\n\r\nvar Model = require('@noodl/runtime/src/model'),\r\n  Collection = require('@noodl/runtime/src/collection');\r\n\r\nvar CollectionNewNode = {\r\n  name: 'CollectionNew',\r\n  docs: 'https://docs.noodl.net/nodes/data/array/create-new-array',\r\n  displayNodeName: 'Create New Array',\r\n  shortDesc: 'A collection of models, mainly used together with a For Each Node.',\r\n  category: 'Data',\r\n  color: 'data',\r\n  initialize: function () {},\r\n  inputs: {\r\n    new: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleNew();\r\n      }\r\n    },\r\n    items: {\r\n      type: 'array',\r\n      group: 'General',\r\n      displayName: 'Items',\r\n      set: function (value) {\r\n        this._internal.sourceCollection = value;\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: 'string',\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection ? this._internal.collection.getId() : this._internal.collectionId;\r\n      }\r\n    },\r\n    created: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Done'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionID: function (id) {\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection: function (collection) {\r\n      this._internal.collection = collection;\r\n      this.flagOutputDirty('id');\r\n    },\r\n    scheduleNew: function () {\r\n      var _this = this;\r\n\r\n      if (this.hasScheduledNew) return;\r\n      this.hasScheduledNew = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.hasScheduledNew = false;\r\n\r\n        const collection = Collection.get();\r\n        if (this._internal.sourceCollection !== undefined) collection.set(this._internal.sourceCollection);\r\n\r\n        _this.setCollection(collection);\r\n\r\n        _this.sendSignalOnOutput('created');\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CollectionNewNode\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\n\r\nvar Model = require('@noodl/runtime/src/model'),\r\n  Collection = require('@noodl/runtime/src/collection');\r\n\r\nvar CollectionRemoveNode = {\r\n  name: 'CollectionRemove',\r\n  docs: 'https://docs.noodl.net/nodes/data/array/remove-from-array',\r\n  displayNodeName: 'Remove Object From Array',\r\n  shortDesc: 'A collection of models, mainly used together with a For Each Node.',\r\n  category: 'Data',\r\n  usePortAsLabel: 'collectionId',\r\n  color: 'data',\r\n  initialize: function () {},\r\n  inputs: {\r\n    collectionId: {\r\n      type: {\r\n        name: 'string',\r\n        identifierOf: 'CollectionName',\r\n        identifierDisplayName: 'Array Ids'\r\n      },\r\n      displayName: 'Array Id',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value instanceof Collection) value = value.getId(); // Can be passed as collection as well\r\n        this.setCollectionID(value);\r\n      }\r\n    },\r\n    modifyId: {\r\n      type: { name: 'string', allowConnectionsOnly: true },\r\n      displayName: 'Object Id',\r\n      group: 'Modify',\r\n      set: function (value) {\r\n        this._internal.modifyId = value;\r\n      }\r\n    },\r\n    remove: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        var _this = this;\r\n        var internal = this._internal;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          if (internal.modifyId === undefined) return;\r\n          if (internal.collection === undefined) return;\r\n\r\n          var model = Model.get(internal.modifyId);\r\n          internal.collection.remove(model);\r\n          _this.sendSignalOnOutput('modified');\r\n        });\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    modified: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Done'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionID: function (id) {\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection: function (collection) {\r\n      this._internal.collection = collection;\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CollectionRemoveNode\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\n\r\nconst Collection = require('@noodl/runtime/src/collection');\r\n\r\nvar CollectionNode = {\r\n  name: 'Collection2',\r\n  docs: 'https://docs.noodl.net/nodes/data/array/array-node',\r\n  displayNodeName: 'Array',\r\n  shortDesc: 'A collection of models, mainly used together with a For Each Node.',\r\n  category: 'Data',\r\n  usePortAsLabel: 'collectionId',\r\n  color: 'data',\r\n  initialize: function () {\r\n    var _this = this;\r\n\r\n    var collectionChangedScheduled = false;\r\n    this._internal.collectionChangedCallback = function () {\r\n      if (_this.isInputConnected('fetch') === true) return; // Ignore if we have explicit fetch connection\r\n\r\n      //this can be called multiple times when adding/removing more than one item\r\n      //so optimize by only updating outputs once\r\n      if (collectionChangedScheduled) return;\r\n      collectionChangedScheduled = true;\r\n\r\n      _this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.sendSignalOnOutput('changed');\r\n        _this.flagOutputDirty('firstItemId');\r\n        _this.flagOutputDirty('count');\r\n        collectionChangedScheduled = false;\r\n      });\r\n    };\r\n\r\n    // When the source collection has changed, simply copy items into this collection\r\n    this._internal.sourceCollectionChangedCallback = function () {\r\n      if (_this.isInputConnected('store') === true) return; // Ignore if we have explicit store connection\r\n\r\n      _this.scheduleCopyItems();\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    const collection = this._internal.collection;\r\n    if (!collection) {\r\n      return { type: 'text', value: '[No Array]' };\r\n    }\r\n\r\n    return [\r\n      {\r\n        type: 'text',\r\n        value: 'Id: ' + collection.getId()\r\n      },\r\n      {\r\n        type: 'value',\r\n        value: collection.items\r\n      }\r\n    ];\r\n  },\r\n  inputs: {\r\n    collectionId: {\r\n      type: {\r\n        name: 'string',\r\n        identifierOf: 'CollectionName',\r\n        identifierDisplayName: 'Array Ids'\r\n      },\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value instanceof Collection) value = value.getId(); // Can be passed as collection as well\r\n        this._internal.collectionId = value; // Wait to fetch data\r\n        if (this.isInputConnected('fetch') === false) this.setCollectionID(value);\r\n        else {\r\n          this.flagOutputDirty('id');\r\n        }\r\n      }\r\n    },\r\n    items: {\r\n      type: 'array',\r\n      group: 'General',\r\n      displayName: 'Items',\r\n      set: function (value) {\r\n        var _this = this;\r\n        if (value === undefined) return;\r\n        if (value === this._internal.collection) return;\r\n\r\n        this._internal.pendingSourceCollection = value;\r\n        if (this.isInputConnected('store') === false) {\r\n          // Don't auto copy if we have connections to store\r\n          this.scheduleAfterInputsHaveUpdated(function () {\r\n            _this.setSourceCollection(value);\r\n          });\r\n        }\r\n      }\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleSetCollection();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: 'string',\r\n      displayName: 'Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection ? this._internal.collection.getId() : this._internal.collectionId;\r\n      }\r\n    },\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection;\r\n      }\r\n    },\r\n    firstItemId: {\r\n      type: 'string',\r\n      displayName: 'First Item Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        if (this._internal.collection) {\r\n          var firstItem = this._internal.collection.get(0);\r\n          if (firstItem !== undefined) return firstItem.getId();\r\n        }\r\n      }\r\n    },\r\n    count: {\r\n      type: 'number',\r\n      displayName: 'Count',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection ? this._internal.collection.size() : 0;\r\n      }\r\n    },\r\n    changed: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Changed'\r\n    },\r\n    fetched: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Fetched'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionID: function (id) {\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection: function (collection) {\r\n      if (this._internal.collection)\r\n        // Remove old listener if existing\r\n        this._internal.collection.off('change', this._internal.collectionChangedCallback);\r\n\r\n      this._internal.collection = collection;\r\n      this.flagOutputDirty('id');\r\n      collection.on('change', this._internal.collectionChangedCallback);\r\n\r\n      this.flagOutputDirty('items');\r\n      this.flagOutputDirty('firstItemId');\r\n      this.flagOutputDirty('count');\r\n    },\r\n    setSourceCollection: function (collection) {\r\n      var internal = this._internal;\r\n\r\n      if (internal.sourceCollection && internal.sourceCollection instanceof Collection)\r\n        // Remove old listener if existing\r\n        internal.sourceCollection.off('change', internal.sourceCollectionChangedCallback);\r\n\r\n      internal.sourceCollection = collection;\r\n      if (internal.sourceCollection instanceof Collection)\r\n        internal.sourceCollection.on('change', internal.sourceCollectionChangedCallback);\r\n\r\n      this._copySourceItems();\r\n    },\r\n    scheduleSetCollection: function () {\r\n      var _this = this;\r\n\r\n      if (this.hasScheduledSetCollection) return;\r\n      this.hasScheduledSetCollection = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.hasScheduledSetCollection = false;\r\n        _this.setCollectionID(_this._internal.collectionId);\r\n        _this.sendSignalOnOutput('fetched');\r\n      });\r\n    },\r\n    scheduleStore: function () {\r\n      var _this = this;\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.hasScheduledStore = false;\r\n        _this.setSourceCollection(internal.pendingSourceCollection);\r\n      });\r\n    },\r\n    _copySourceItems: function () {\r\n      var internal = this._internal;\r\n\r\n      if (internal.collection === undefined && this.isInputConnected('fetch') === false)\r\n        this.setCollection(Collection.get());\r\n      internal.collection && internal.collection.set(internal.sourceCollection);\r\n    },\r\n    scheduleCopyItems: function () {\r\n      var _this = this;\r\n      var internal = this._internal;\r\n\r\n      if (this.hasScheduledCopyItems) return;\r\n      this.hasScheduledCopyItems = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.hasScheduledCopyItems = false;\r\n        _this._copySourceItems();\r\n      });\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n\r\n      if (this._internal.collection)\r\n        // Remove old listener if existing\r\n        this._internal.collection.off('change', this._internal.collectionChangedCallback);\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CollectionNode\r\n};\r\n","'use strict';\r\n\r\nconst { Node, EdgeTriggeredInput } = require('@noodl/runtime');\r\n\r\nconst Collection = require('@noodl/runtime/src/collection'),\r\n  Model = require('@noodl/runtime/src/model');\r\n\r\nfunction applyFilter(item, filter) {\r\n  for (var key in filter) {\r\n    var op = filter[key];\r\n\r\n    //check neq first, it's the only operation where the key can be undefined\r\n    if (op['$neq'] !== undefined) {\r\n      if (!(item[key] != op['$neq'])) return false;\r\n    } else if (item[key] === undefined) return false;\r\n    // The key does not exist, always return false\r\n    else if (op['$eq'] !== undefined && !(item[key] == op['$eq'])) return false;\r\n    else if (op['$gt'] !== undefined && !(item[key] > op['$gt'])) return false;\r\n    else if (op['$lt'] !== undefined && !(item[key] < op['$lt'])) return false;\r\n    else if (op['$gte'] !== undefined && !(item[key] >= op['$gte'])) return false;\r\n    else if (op['$lte'] !== undefined && !(item[key] <= op['$lte'])) return false;\r\n    else if (op['$regex'] !== undefined) {\r\n      // Test if string matches regex\r\n      var a = item[key] + ''; // Convert to string\r\n      var regex = new RegExp(op['$regex'], op['$case'] !== true ? 'i' : undefined);\r\n\r\n      if (!regex.test(a)) return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction sorter(a, b) {\r\n  if (a instanceof Model) a = a.data;\r\n  if (b instanceof Model) b = b.data;\r\n\r\n  for (var key in this) {\r\n    var _a = a[key];\r\n    var _b = b[key];\r\n    if (_a !== _b) {\r\n      if (typeof _a === 'string' && typeof _b === 'string') {\r\n        if (this[key] === 1) {\r\n          return _a > _b ? 1 : -1;\r\n        } else return _a > _b ? -1 : 1;\r\n      } else if (typeof _a === 'number' && typeof _b === 'number') {\r\n        return this[key] === 1 ? _a - _b : _b - _a;\r\n      } else {\r\n        if (this[key] === 1) {\r\n          return _a > _b ? 1 : -1;\r\n        } else return _a > _b ? -1 : 1;\r\n      }\r\n    }\r\n  }\r\n  return 0;\r\n}\r\n\r\nvar FilterCollectionNode = {\r\n  name: 'Filter Collection',\r\n  docs: 'https://docs.noodl.net/nodes/data/array/array-filter',\r\n  displayNodeName: 'Array Filter',\r\n  shortDesc: 'Filter, sort and limit array',\r\n  category: 'Data',\r\n  color: 'data',\r\n  initialize: function () {\r\n    var _this = this;\r\n\r\n    this._internal.collectionChangedCallback = function () {\r\n      if (_this.isInputConnected('filter') === true) return;\r\n\r\n      _this.scheduleFilter();\r\n    };\r\n\r\n    this._internal.enabled = true;\r\n    this._internal.filterSettings = {};\r\n    //this._internal.filteredCollection = Collection.get();\r\n  },\r\n  getInspectInfo() {\r\n    const collection = this._internal.filteredCollection;\r\n\r\n    if (!collection) {\r\n      return { type: 'text', value: '[Not executed yet]' };\r\n    }\r\n\r\n    return [\r\n      {\r\n        type: 'text',\r\n        value: 'Id: ' + collection.getId()\r\n      },\r\n      {\r\n        type: 'value',\r\n        value: collection.items\r\n      }\r\n    ];\r\n  },\r\n  inputs: {\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      set(value) {\r\n        this.bindCollection(value);\r\n        if (this.isInputConnected('filter') === false) this.scheduleFilter();\r\n      }\r\n    },\r\n    enabled: {\r\n      type: 'boolean',\r\n      group: 'General',\r\n      displayName: 'Enabled',\r\n      default: true,\r\n      set: function (value) {\r\n        this._internal.enabled = value;\r\n        if (this.isInputConnected('filter') === false) this.scheduleFilter();\r\n      }\r\n    },\r\n    filter: {\r\n      type: 'signal',\r\n      group: 'Actions',\r\n      displayName: 'Filter',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleFilter();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.filteredCollection;\r\n      }\r\n    },\r\n    firstItemId: {\r\n      type: 'string',\r\n      displayName: 'First Item Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        if (this._internal.filteredCollection !== undefined) {\r\n          const firstItem = this._internal.filteredCollection.get(0);\r\n          if (firstItem !== undefined) return firstItem.getId();\r\n        }\r\n      }\r\n    },\r\n    /*   firstItem:{\r\n            type: 'object',\r\n            displayName: 'First Item',\r\n            group: 'General',\r\n            getter: function () {\r\n                if(this._internal.filteredCollection !== undefined) {\r\n                    return this._internal.filteredCollection.get(0);\r\n                }\r\n            }            \r\n        },  */\r\n    count: {\r\n      type: 'number',\r\n      displayName: 'Count',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.filteredCollection ? this._internal.filteredCollection.size() : 0;\r\n      }\r\n    },\r\n    modified: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Filtered'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    unbindCurrentCollection: function () {\r\n      var collection = this._internal.collection;\r\n      if (!collection) return;\r\n      collection.off('change', this._internal.collectionChangedCallback);\r\n      this._internal.collection = undefined;\r\n    },\r\n    bindCollection: function (collection) {\r\n      this.unbindCurrentCollection();\r\n      this._internal.collection = collection;\r\n      collection && collection.on('change', this._internal.collectionChangedCallback);\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this.unbindCurrentCollection();\r\n    },\r\n    getFilter: function () {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      const options = ['case']; // List all supported options here\r\n\r\n      if (filterSettings['filterFilter']) {\r\n        const filters = filterSettings['filterFilter'].split(',');\r\n        var _filter = {};\r\n        filters.forEach(function (f) {\r\n          var op = '$' + (filterSettings['filterFilterOp-' + f] || 'eq');\r\n          _filter[f] = {};\r\n          _filter[f][op] = filterSettings['filterFilterValue-' + f];\r\n\r\n          options.forEach((o) => {\r\n            var option = filterSettings['filterFilterOption-' + o + '-' + f];\r\n            if (option) _filter[f]['$' + o] = option;\r\n          });\r\n        });\r\n        return _filter;\r\n      }\r\n    },\r\n    getSort: function () {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      if (filterSettings['filterSort']) {\r\n        const sort = filterSettings['filterSort'].split(',');\r\n        var _sort = {};\r\n        sort.forEach(function (s) {\r\n          _sort[s] = filterSettings['filterSort-' + s] === 'descending' ? -1 : 1;\r\n        });\r\n        return _sort;\r\n      }\r\n    },\r\n    getLimit: function () {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      if (!filterSettings['filterEnableLimit']) return;\r\n      else return filterSettings['filterLimit'] || 10;\r\n    },\r\n    getSkip: function () {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      if (!filterSettings['filterEnableLimit']) return;\r\n      else return filterSettings['filterSkip'] || 0;\r\n    },\r\n    scheduleFilter: function () {\r\n      if (this.collectionChangedScheduled) return;\r\n      this.collectionChangedScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.collectionChangedScheduled = false;\r\n        if (!this._internal.collection) return;\r\n\r\n        // Apply filter and write to output collection\r\n        var filtered = [].concat(this._internal.collection.items); // Make sure we clone the array\r\n\r\n        if (this._internal.enabled) {\r\n          var filter = this.getFilter();\r\n          if (filter) filtered = filtered.filter((m) => applyFilter(m.data, filter));\r\n\r\n          var sort = this.getSort();\r\n          if (sort) filtered.sort(sorter.bind(sort));\r\n\r\n          var skip = this.getSkip();\r\n          if (skip) filtered = filtered.slice(skip, filtered.length);\r\n\r\n          var limit = this.getLimit();\r\n          if (limit) filtered = filtered.slice(0, limit);\r\n        }\r\n\r\n        this._internal.filteredCollection = Collection.create(filtered);\r\n\r\n        this.sendSignalOnOutput('modified');\r\n        this.flagOutputDirty('firstItemId');\r\n        this.flagOutputDirty('items');\r\n        // this.flagOutputDirty('firstItem');\r\n        this.flagOutputDirty('count');\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      var _this = this;\r\n\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerInput(name, {\r\n        set: userInputSetter.bind(this, name)\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nfunction userInputSetter(name, value) {\r\n  /* jshint validthis:true */\r\n  this._internal.filterSettings[name] = value;\r\n  if (this.isInputConnected('filter') === false) this.scheduleFilter();\r\n}\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection, dbCollections) {\r\n  var ports = [];\r\n\r\n  ports.push({\r\n    type: 'boolean',\r\n    plug: 'input',\r\n    group: 'Limit',\r\n    name: 'filterEnableLimit',\r\n    displayName: 'Use limit'\r\n  });\r\n\r\n  if (parameters['filterEnableLimit']) {\r\n    ports.push({\r\n      type: 'number',\r\n      default: 10,\r\n      plug: 'input',\r\n      group: 'Limit',\r\n      name: 'filterLimit',\r\n      displayName: 'Limit'\r\n    });\r\n\r\n    ports.push({\r\n      type: 'number',\r\n      default: 0,\r\n      plug: 'input',\r\n      group: 'Limit',\r\n      name: 'filterSkip',\r\n      displayName: 'Skip'\r\n    });\r\n  }\r\n\r\n  ports.push({\r\n    type: { name: 'stringlist', allowEditOnly: true },\r\n    plug: 'input',\r\n    group: 'Filter',\r\n    name: 'filterFilter',\r\n    displayName: 'Filter'\r\n  });\r\n\r\n  ports.push({\r\n    type: { name: 'stringlist', allowEditOnly: true },\r\n    plug: 'input',\r\n    group: 'Sort',\r\n    name: 'filterSort',\r\n    displayName: 'Sort'\r\n  });\r\n\r\n  const filterOps = {\r\n    string: [\r\n      { value: 'eq', label: 'Equals' },\r\n      { value: 'neq', label: 'Not Equals' },\r\n      { value: 'regex', label: 'Matches RegEx' }\r\n    ],\r\n    boolean: [\r\n      { value: 'eq', label: 'Equals' },\r\n      { value: 'neq', label: 'Not Equals' }\r\n    ],\r\n    number: [\r\n      { value: 'eq', label: 'Equals' },\r\n      { value: 'neq', label: 'Not Equals' },\r\n      { value: 'lt', label: 'Less than' },\r\n      { value: 'gt', label: 'Greater than' },\r\n      { value: 'gte', label: 'Greater than or equal' },\r\n      { value: 'lte', label: 'Less than or equal' }\r\n    ]\r\n  };\r\n\r\n  if (parameters['filterFilter']) {\r\n    var filters = parameters['filterFilter'].split(',');\r\n    filters.forEach((f) => {\r\n      // Type\r\n      ports.push({\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { value: 'string', label: 'String' },\r\n            { value: 'number', label: 'Number' },\r\n            { value: 'boolean', label: 'Boolean' }\r\n          ]\r\n        },\r\n        default: 'string',\r\n        plug: 'input',\r\n        group: f + ' filter',\r\n        displayName: 'Type',\r\n        editorName: f + ' filter | Type',\r\n        name: 'filterFilterType-' + f\r\n      });\r\n\r\n      var type = parameters['filterFilterType-' + f];\r\n\r\n      // String filter type\r\n      ports.push({\r\n        type: { name: 'enum', enums: filterOps[type || 'string'] },\r\n        default: 'eq',\r\n        plug: 'input',\r\n        group: f + ' filter',\r\n        displayName: 'Op',\r\n        editorName: f + ' filter| Op',\r\n        name: 'filterFilterOp-' + f\r\n      });\r\n\r\n      // Case sensitivite option\r\n      if (parameters['filterFilterOp-' + f] === 'regex') {\r\n        ports.push({\r\n          type: 'boolean',\r\n          default: false,\r\n          plug: 'input',\r\n          group: f + ' filter',\r\n          displayName: 'Case sensitive',\r\n          editorName: f + ' filter| Case',\r\n          name: 'filterFilterOption-case-' + f\r\n        });\r\n      }\r\n\r\n      ports.push({\r\n        type: type || 'string',\r\n        plug: 'input',\r\n        group: f + ' filter',\r\n        displayName: 'Value',\r\n        editorName: f + ' Filter Value',\r\n        name: 'filterFilterValue-' + f\r\n      });\r\n    });\r\n  }\r\n\r\n  if (parameters['filterSort']) {\r\n    var filters = parameters['filterSort'].split(',');\r\n    filters.forEach((f) => {\r\n      ports.push({\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { value: 'ascending', label: 'Ascending' },\r\n            { value: 'descending', label: 'Descending' }\r\n          ]\r\n        },\r\n        default: 'ascending',\r\n        plug: 'input',\r\n        group: f + ' sort',\r\n        displayName: 'Sort',\r\n        editorName: f + ' sorting',\r\n        name: 'filterSort-' + f\r\n      });\r\n    });\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nmodule.exports = {\r\n  node: FilterCollectionNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.Filter Collection', function (node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('dbCollections'));\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        if (event.name.startsWith('filter')) {\r\n          updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('dbCollections'));\r\n        }\r\n      });\r\n\r\n      graphModel.on('metadataChanged.dbCollections', function (data) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n      });\r\n    });\r\n  }\r\n};\r\n","const { EdgeTriggeredInput } = require('@noodl/runtime');\r\n\r\nconst ForEachActionsDefinition = {\r\n  name: 'For Each Actions',\r\n  docs: 'https://docs.noodl.net/nodes/ui-controls/repeater-item',\r\n  displayNodeName: 'Repeater Item',\r\n  category: 'Data',\r\n  color: 'data',\r\n  inputs: {\r\n    removeCompleted: {\r\n      type: { name: 'boolean', allowConnectionsOnly: true },\r\n      displayName: 'Remove Completed',\r\n      group: 'Events',\r\n      valueChangedToTrue: function () {\r\n        this._internal.removeCompletedCallback && this._internal.removeCompletedCallback();\r\n      }\r\n    }\r\n    /*   itemActions:{\r\n        type:{name:'stringlist',allowEditOnly:true},\r\n        group:'Actions',\r\n        set:function(value) {\r\n        }\r\n      },\r\n      itemActionParameters:{\r\n        type:{name:'stringlist',allowEditOnly:true},\r\n        group:'Action Parameters',\r\n        set:function(value) {\r\n        }\r\n      }    */\r\n  },\r\n  outputs: {\r\n    added: {\r\n      type: 'signal',\r\n      displayName: 'Added',\r\n      group: 'Events'\r\n    },\r\n    tryRemove: {\r\n      type: 'signal',\r\n      displayName: 'Try Remove',\r\n      group: 'Events'\r\n    },\r\n    itemId: {\r\n      type: 'string',\r\n      displayName: 'Item Id',\r\n      group: 'General',\r\n      get() {\r\n        return this.getItemId();\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    getItemId() {\r\n      const model = this.nodeScope.componentOwner._forEachModel;\r\n      return model && model.getId();\r\n    },\r\n    signalAdded: function () {\r\n      this.sendSignalOnOutput('added');\r\n    },\r\n    tryRemove: function (callback) {\r\n      if (this.getOutput('tryRemove').hasConnections()) {\r\n        this._internal.removeCompletedCallback = callback;\r\n        this.sendSignalOnOutput('tryRemove');\r\n      } else {\r\n        // Schedule for later in this frame so any collection nodes\r\n        // being delete can complete data persistence before being\r\n        // deleted\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          callback();\r\n        });\r\n      }\r\n    },\r\n    itemActionTriggered(name) {\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        const itemId = this.getItemId();\r\n        const parentForEach = this.nodeScope.componentOwner._forEachNode;\r\n        parentForEach.signalItemAction(name, itemId, this._internal.actionParameters || {});\r\n      });\r\n    },\r\n    setItemActionParameter(name) {\r\n      if (!this._internal.actionParameters) this._internal.actionParameters = {};\r\n      this._internal.actionParameters[name] = name;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('itemAction-'))\r\n        return this.registerInput(name, {\r\n          set: EdgeTriggeredInput.createSetter({\r\n            valueChangedToTrue: this.itemActionTriggered.bind(this, name)\r\n          })\r\n        });\r\n\r\n      if (name.startsWith('itemActionParameter-'))\r\n        return this.registerInput(name, {\r\n          set: this.setItemActionParameter.bind(this, name)\r\n        });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: ForEachActionsDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    /*  graphModel.on(\"nodeAdded.For Each Actions\", function (node) {\r\n      function _updatePorts() {\r\n        var ports = [];\r\n\r\n        var actions = node.parameters['itemActions'];\r\n        if(actions) {\r\n          actions.split(',').forEach((a) => {\r\n            ports.push({\r\n              name:'itemAction-' + a,\r\n              displayName:a,\r\n              plug:'input',\r\n              type:'signal',\r\n              group:'Actions',\r\n            })\r\n          })\r\n        }\r\n\r\n        var parameters = node.parameters['itemActionParameters'];\r\n        if(parameters) {\r\n          parameters.split(',').forEach((p) => {\r\n            ports.push({\r\n              name:'itemActionParameter-' + p,\r\n              displayName:p,\r\n              plug:'input',\r\n              type:'*',\r\n              group:'Parameters',\r\n            })\r\n          })\r\n        }\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on('parameterUpdated',function(event) {\r\n        if(event.name === 'itemActions' || event.name === 'itemActionParameters') _updatePorts();\r\n      })\r\n\r\n    })*/\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\n\r\nvar Model = require('@noodl/runtime/src/model'),\r\n  Collection = require('@noodl/runtime/src/collection');\r\n\r\nconst defaultMapCode =\r\n  'map({\\n' +\r\n  '\\t// Here you add mappings between the input object and the mapped output object.\\n' +\r\n  \"\\t//myOutputProp: 'inputProp',\\n\" +\r\n  \"\\t//anotherProperty: function(object) { return object.get('someProperty') + ' ' + object.get('otherProp') }\\n\" +\r\n  '})\\n';\r\n\r\nvar MapCollectionNode = {\r\n  name: 'Map Collection',\r\n  docs: 'https://docs.noodl.net/nodes/data/array/array-map',\r\n  displayNodeName: 'Array Map',\r\n  shortDesc: 'Map array fields',\r\n  category: 'Data',\r\n  color: 'data',\r\n  initialize: function () {\r\n    var _this = this;\r\n\r\n    this._internal.collectionChangedCallback = function () {\r\n      _this.scheduleMap();\r\n    };\r\n\r\n    //     this._internal.mappedCollection = Collection.get();\r\n  },\r\n  inputs: {\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this.setCollection(value);\r\n        this.scheduleMap();\r\n      }\r\n    },\r\n    mapScript: {\r\n      type: {\r\n        name: 'string',\r\n        allowEditOnly: true,\r\n        codeeditor: 'javascript'\r\n      },\r\n      displayName: 'Script',\r\n      default: defaultMapCode,\r\n      set: function (value) {\r\n        this._internal.mapCode = value;\r\n        try {\r\n          this._internal.mapFunc = new Function('map', 'object', this._internal.mapCode);\r\n        } catch (e) {\r\n          this._internal.mapFunc = undefined;\r\n          console.log('Error while parsing map script: ' + e);\r\n        }\r\n        this.scheduleMap();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.mappedCollection;\r\n      }\r\n    },\r\n    count: {\r\n      type: 'number',\r\n      displayName: 'Count',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.mappedCollection ? this._internal.mappedCollection.size() : 0;\r\n      }\r\n    },\r\n    modified: {\r\n      group: 'Events',\r\n      type: 'signal',\r\n      displayName: 'Changed'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    setCollection: function (collection) {\r\n      this.bindCollection(collection);\r\n      this.flagOutputDirty('items');\r\n      this.flagOutputDirty('count');\r\n    },\r\n    unbindCurrentCollection: function () {\r\n      var collection = this._internal.collection;\r\n      if (!collection) return;\r\n      collection.off('change', this._internal.collectionChangedCallback);\r\n      this._internal.collection = undefined;\r\n    },\r\n    bindCollection: function (collection) {\r\n      this.unbindCurrentCollection();\r\n      this._internal.collection = collection;\r\n      collection && collection.on('change', this._internal.collectionChangedCallback);\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this.unbindCurrentCollection();\r\n    },\r\n    scheduleMap: function () {\r\n      if (this.collectionChangedScheduled) return;\r\n      this.collectionChangedScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.collectionChangedScheduled = false;\r\n        if (this._internal.collection === undefined) return;\r\n\r\n        var mappedModels = this._internal.collection.map((model) => {\r\n          var m = Model.create();\r\n          this._internal.mapFunc(function (mappings) {\r\n            for (var key in mappings) {\r\n              if (typeof mappings[key] === 'function') {\r\n                m.set(key, mappings[key](model));\r\n              } else if (typeof mappings[key] === 'string') {\r\n                m.set(key, model.get(mappings[key]));\r\n              }\r\n            }\r\n          }, model);\r\n          return m;\r\n        });\r\n\r\n        this._internal.mappedCollection = Collection.create(mappedModels);\r\n\r\n        this.sendSignalOnOutput('modified');\r\n        this.flagOutputDirty('items');\r\n        this.flagOutputDirty('count');\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: MapCollectionNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst Model = require('@noodl/runtime/src/model');\r\nconst Collection = require('@noodl/runtime/src/collection');\r\n\r\nconst SetVariableNodeDefinition = {\r\n  name: 'Set Variable',\r\n  docs: 'https://docs.noodl.net/nodes/data/variable/set-variable',\r\n  category: 'Data',\r\n  usePortAsLabel: 'name',\r\n  color: 'data',\r\n  initialize: function () {\r\n    const internal = this._internal;\r\n    internal.variablesModel = Model.get('--ndl--global-variables');\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal.name) {\r\n      return this._internal.variablesModel.get(this._internal.name);\r\n    }\r\n\r\n    return '[No value set]';\r\n  },\r\n  outputs: {\r\n    done: {\r\n      type: 'signal',\r\n      displayName: 'Done',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  inputs: {\r\n    name: {\r\n      type: {\r\n        name: 'string',\r\n        identifierOf: 'VariableName',\r\n        identifierDisplayName: 'Variable names'\r\n      },\r\n      displayName: 'Name',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.name = value;\r\n      }\r\n    },\r\n    setWith: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'String', value: 'string' },\r\n          { label: 'Boolean', value: 'boolean' },\r\n          { label: 'Number', value: 'number' },\r\n          { label: 'Empty string', value: 'emptyString' },\r\n          { label: 'Date', value: 'date' },\r\n          { label: 'Object', value: 'object' },\r\n          { label: 'Array', value: 'array' },\r\n          { label: 'Any', value: '*' }\r\n        ],\r\n        allowEditOnly: true\r\n      },\r\n      displayName: 'Set as',\r\n      default: '*',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.setWith = value;\r\n      }\r\n    },\r\n    do: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleStore();\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setValue: function (value) {\r\n      this._internal.value = value;\r\n    },\r\n    scheduleStore: function () {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      const internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        this.hasScheduledStore = false;\r\n\r\n        let value = internal.setWith === 'emptyString' ? '' : internal.value;\r\n\r\n        // Can set arrays with \"id\" or array\r\n        if (internal.setWith === 'object' && typeof value === 'string') value = Model.get(value);\r\n\r\n        // Can set arrays with \"id\" or array\r\n        if (internal.setWith === 'array' && typeof value === 'string') value = Collection.get(value);\r\n\r\n        if (internal.setWith === 'boolean') value = !!value;\r\n\r\n        // use forceChange to always trigger Variable nodes to send the value on\r\n        // their output, even if it's the same value twice\r\n        internal.variablesModel.set(internal.name, value, {\r\n          forceChange: true\r\n        });\r\n        this.sendSignalOnOutput('done');\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === 'value') {\r\n        this.registerInput(name, {\r\n          set: this.setValue.bind(this)\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: SetVariableNodeDefinition,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.Set Variable', function (node) {\r\n      function _updatePorts() {\r\n        var ports = [];\r\n\r\n        if (node.parameters.setWith === 'emptyString') {\r\n          // No ports needed\r\n        } else {\r\n          ports.push({\r\n            type: node.parameters.setWith !== undefined ? node.parameters.setWith : '*',\r\n            plug: 'input',\r\n            group: 'General',\r\n            name: 'value',\r\n            displayName: 'Value'\r\n          });\r\n        }\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        _updatePorts();\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst Collection = require('@noodl/runtime/src/collection');\r\n\r\nfunction CSVToArray(strData, strDelimiter) {\r\n  // Check to see if the delimiter is defined. If not,\r\n  // then default to comma.\r\n  strDelimiter = strDelimiter || ',';\r\n\r\n  // Create a regular expression to parse the CSV values.\r\n  var objPattern = new RegExp(\r\n    // Delimiters.\r\n    '(\\\\' +\r\n      strDelimiter +\r\n      '|\\\\r?\\\\n|\\\\r|^)' +\r\n      // Quoted fields.\r\n      '(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|' +\r\n      // Standard fields.\r\n      '([^\"\\\\' +\r\n      strDelimiter +\r\n      '\\\\r\\\\n]*))',\r\n    'gi'\r\n  );\r\n\r\n  // Create an array to hold our data. Give the array\r\n  // a default empty first row.\r\n  var arrData = [[]];\r\n\r\n  // Create an array to hold our individual pattern\r\n  // matching groups.\r\n  var arrMatches = null;\r\n\r\n  var prevLastIndex;\r\n\r\n  // Keep looping over the regular expression matches\r\n  // until we can no longer find a match.\r\n  while ((arrMatches = objPattern.exec(strData)) && prevLastIndex !== objPattern.lastIndex) {\r\n    prevLastIndex = objPattern.lastIndex;\r\n\r\n    // Get the delimiter that was found.\r\n    var strMatchedDelimiter = arrMatches[1];\r\n\r\n    // Check to see if the given delimiter has a length\r\n    // (is not the start of string) and if it matches\r\n    // field delimiter. If id does not, then we know\r\n    // that this delimiter is a row delimiter.\r\n    if (strMatchedDelimiter.length && strMatchedDelimiter !== strDelimiter) {\r\n      // Since we have reached a new row of data,\r\n      // add an empty row to our data array.\r\n      arrData.push([]);\r\n    }\r\n\r\n    var strMatchedValue;\r\n\r\n    // Now that we have our delimiter out of the way,\r\n    // let's check to see which kind of value we\r\n    // captured (quoted or unquoted).\r\n    if (arrMatches[2]) {\r\n      // We found a quoted value. When we capture\r\n      // this value, unescape any double quotes.\r\n      strMatchedValue = arrMatches[2].replace(new RegExp('\"\"', 'g'), '\"');\r\n    } else {\r\n      // We found a non-quoted value.\r\n      strMatchedValue = arrMatches[3];\r\n    }\r\n\r\n    // Now that we have our value string, let's add\r\n    // it to the data array.\r\n    arrData[arrData.length - 1].push(strMatchedValue);\r\n  }\r\n\r\n  // Return the parsed data.\r\n  return arrData;\r\n}\r\n\r\nvar CSVNode = {\r\n  name: 'Static Data',\r\n  docs: 'https://docs.noodl.net/nodes/data/array/static-array',\r\n  displayNodeName: 'Static Array',\r\n  shortDesc: 'Store static data to populate a Collection with items.',\r\n  category: 'Data',\r\n  color: 'data',\r\n  nodeDoubleClickAction: [\r\n    {\r\n      focusPort: 'JSON'\r\n    },\r\n    {\r\n      focusPort: 'CSV'\r\n    }\r\n  ],\r\n  getInspectInfo() {\r\n    if (this._internal.collection) {\r\n      return [\r\n        {\r\n          type: 'value',\r\n          value: this._internal.collection.items\r\n        }\r\n      ];\r\n    }\r\n  },\r\n  dynamicports: [\r\n    {\r\n      name: 'conditionalports/extended',\r\n      condition: 'type = csv OR type NOT SET',\r\n      inputs: ['csv']\r\n    },\r\n    {\r\n      name: 'conditionalports/extended',\r\n      condition: 'type = json',\r\n      inputs: ['json']\r\n    }\r\n  ],\r\n  inputs: {\r\n    type: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'CSV', value: 'csv' },\r\n          { label: 'JSON', value: 'json' }\r\n        ],\r\n        allowEditOnly: true\r\n      },\r\n      displayName: 'Type',\r\n      group: 'General',\r\n      default: 'csv',\r\n      set: function (value) {\r\n        this._internal.type = value;\r\n      }\r\n    },\r\n    csv: {\r\n      type: { name: 'string', codeeditor: 'text', allowEditOnly: true },\r\n      displayName: 'CSV',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.csv = value;\r\n        this.scheduleParseData();\r\n      }\r\n    },\r\n    json: {\r\n      type: { name: 'string', codeeditor: 'json', allowEditOnly: true },\r\n      displayName: 'JSON',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.json = value;\r\n        this.scheduleParseData();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.collection;\r\n      }\r\n    },\r\n    count: {\r\n      type: 'number',\r\n      displayName: 'Count',\r\n      group: 'General',\r\n      get() {\r\n        return this._internal.collection ? this._internal.collection.size() : 0;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    scheduleParseData: function () {\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledParseData) {\r\n        internal.hasScheduledParseData = true;\r\n        this.scheduleAfterInputsHaveUpdated(this.parseData.bind(this));\r\n      }\r\n    },\r\n    parseData: function () {\r\n      var internal = this._internal;\r\n\r\n      internal.hasScheduledParseData = false;\r\n\r\n      internal.collection = Collection.get();\r\n\r\n      if (internal.type === undefined || internal.type === 'csv') {\r\n        // Data is string, parse it as CSV\r\n        var data = CSVToArray(internal.csv);\r\n        var json = [];\r\n        var fields = data[0];\r\n        for (var i = 1; i < data.length; i++) {\r\n          var row = data[i];\r\n          var obj = {};\r\n          for (var j = 0; j < fields.length; j++) {\r\n            obj[fields[j]] = row[j];\r\n          }\r\n          json.push(obj);\r\n        }\r\n\r\n        internal.collection.set(json);\r\n        this.flagOutputDirty('items');\r\n        this.flagOutputDirty('count');\r\n      } else if (internal.type === 'json') {\r\n        if (this.context.editorConnection) {\r\n          this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'json-parse-warning');\r\n        }\r\n\r\n        try {\r\n          const json = JSON.parse(internal.json);\r\n          internal.collection.set(json);\r\n          this.flagOutputDirty('items');\r\n          this.flagOutputDirty('count');\r\n        } catch (e) {\r\n          if (this.context.editorConnection) {\r\n            this.context.editorConnection.sendWarning(\r\n              this.nodeScope.componentOwner.name,\r\n              this.id,\r\n              'json-parse-warning',\r\n              {\r\n                showGlobally: true,\r\n                message: e.message\r\n              }\r\n            );\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CSVNode\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\n\r\nvar Model = require('@noodl/runtime/src/model');\r\n\r\nvar VariableNodeDefinition = {\r\n  name: 'Variable2',\r\n  displayNodeName: 'Variable',\r\n  docs: 'https://docs.noodl.net/nodes/data/variable/variable-node',\r\n  category: 'Data',\r\n  usePortAsLabel: 'name',\r\n  color: 'data',\r\n  initialize: function () {\r\n    var _this = this;\r\n    var internal = this._internal;\r\n\r\n    this._internal.onModelChangedCallback = function (args) {\r\n      if (!_this.isInputConnected('fetch') && args.name === internal.name) {\r\n        _this.sendSignalOnOutput('changed');\r\n        _this.flagOutputDirty('value');\r\n      }\r\n    };\r\n\r\n    internal.variablesModel = Model.get('--ndl--global-variables');\r\n    internal.variablesModel.on('change', this._internal.onModelChangedCallback);\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal.name) {\r\n      return this._internal.variablesModel.get(this._internal.name);\r\n    }\r\n\r\n    return '[No value set]';\r\n  },\r\n  outputs: {\r\n    name: {\r\n      type: 'string',\r\n      displayName: 'Name',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.name;\r\n      }\r\n    },\r\n    changed: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    },\r\n    fetched: {\r\n      type: 'signal',\r\n      displayName: 'Fetched',\r\n      group: 'Events'\r\n    },\r\n    value: {\r\n      type: '*',\r\n      displayName: 'Value',\r\n      group: 'General',\r\n      getter: function () {\r\n        var internal = this._internal;\r\n        if (!internal.name) return;\r\n\r\n        return internal.variablesModel.get(internal.name);\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    name: {\r\n      type: {\r\n        name: 'string',\r\n        identifierOf: 'VariableName',\r\n        identifierDisplayName: 'Variable names'\r\n      },\r\n      displayName: 'Name',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (this.isInputConnected('fetch') === false) this.setVariableName(value);\r\n        else {\r\n          this._internal.name = value; // Wait to fetch data\r\n          this.flagOutputDirty('name');\r\n        }\r\n      }\r\n    },\r\n    fetch: {\r\n      displayName: 'Fetch',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.setVariableName(this._internal.name);\r\n      }\r\n    },\r\n    value: {\r\n      type: '*',\r\n      displayName: 'Value',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.value = value;\r\n        this.scheduleStore();\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    scheduleStore: function () {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        this.hasScheduledStore = false;\r\n\r\n        internal.variablesModel.set(internal.name, internal.value);\r\n      });\r\n    },\r\n    setVariableName: function (name) {\r\n      this._internal.name = name;\r\n      this.flagOutputDirty('name');\r\n      this.flagOutputDirty('value');\r\n      this.sendSignalOnOutput('fetched');\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this._internal.variablesModel.off('change', this._internal.onModelChangedCallback);\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: VariableNodeDefinition\r\n};\r\n","'use strict';\r\n\r\nconst { Node } = require('@noodl/runtime');\r\n\r\nconst EventReceiver = {\r\n  name: 'Event Receiver',\r\n  docs: 'https://docs.noodl.net/nodes/events/receive-event',\r\n  displayNodeName: 'Receive Event',\r\n  category: 'Events',\r\n  usePortAsLabel: 'channelName',\r\n  color: 'component',\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.outputValues = {};\r\n    internal.outputNames = [];\r\n    internal.eventReceived = false;\r\n    internal._isEnabled = true;\r\n    internal.channelName = '';\r\n  },\r\n  inputs: {\r\n    enabled: {\r\n      displayName: 'Enabled',\r\n      type: 'boolean',\r\n      default: true,\r\n      set: function (value) {\r\n        this._internal._isEnabled = value ? true : false;\r\n      }\r\n    },\r\n    consume: {\r\n      displayName: 'Consume',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Never', value: 'never' },\r\n          { label: 'Always', value: 'always' }\r\n        ]\r\n      },\r\n      default: 'never',\r\n      set: function (value) {\r\n        this._internal.consume = value;\r\n      }\r\n    },\r\n    channelName: {\r\n      type: { name: 'string', identifierOf: 'EventChannelName' },\r\n      displayName: 'Channel',\r\n      set: function (value) {\r\n        if (this._internal.onEventReceivedCallback) {\r\n          //remove old listener\r\n          this.context.eventSenderEmitter.removeListener(\r\n            this._internal.channelName,\r\n            this._internal.onEventReceivedCallback\r\n          );\r\n          this._internal.onEventReceivedCallback = null;\r\n        }\r\n\r\n        this._internal.channelName = value;\r\n        this.registerListenersForChannel(value);\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    eventReceived: {\r\n      displayName: 'Received',\r\n      type: 'signal'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      var self = this;\r\n\r\n      this._internal.outputNames.push(name);\r\n      this.registerOutput(name, {\r\n        getter: function () {\r\n          return self._internal.outputValues[name];\r\n        }\r\n      });\r\n    },\r\n    handleEvent: function (eventData) {\r\n      if (this._internal._isEnabled === false) {\r\n        return;\r\n      }\r\n      this.sendSignalOnOutput('eventReceived');\r\n\r\n      for (var name in eventData) {\r\n        if (this.hasOutput(name)) {\r\n          this._internal.outputValues[name] = eventData[name];\r\n          this.flagOutputDirty(name);\r\n        }\r\n      }\r\n\r\n      return this._internal.consume === 'always';\r\n    },\r\n    onEventReceived: function (eventData) {\r\n      this.handleEvent(eventData);\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      if (this._internal.onEventReceivedCallback) {\r\n        var eventEmitter = this.context.eventSenderEmitter;\r\n        eventEmitter.removeListener(this._internal.channelName, this._internal.onEventReceivedCallback);\r\n      }\r\n    },\r\n    registerListenersForChannel: function (channelName) {\r\n      var eventEmitter = this.context.eventSenderEmitter;\r\n      this._internal.onEventReceivedCallback = this.onEventReceived.bind(this);\r\n      eventEmitter.on(channelName, this._internal.onEventReceivedCallback);\r\n\r\n      var self = this;\r\n      this.context.eventEmitter.once('applicationDataReloaded', function () {\r\n        if (self._internal.onEventReceivedCallback) {\r\n          eventEmitter.removeListener(channelName, self._internal.onEventReceivedCallback);\r\n        }\r\n      });\r\n    },\r\n    getChannelName: function () {\r\n      return this._internal.channelName;\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: EventReceiver\r\n};\r\n\r\nmodule.exports = {\r\n  node: EventReceiver,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function onEventReceiver(node) {\r\n      var channelName = node.parameters.channelName;\r\n\r\n      function _collectPayloadPorts() {\r\n        var eventSenders = graphModel.getNodesWithType('Event Sender');\r\n        var matching = eventSenders.filter((node) => node.parameters.channelName === channelName);\r\n\r\n        var portKeys = {};\r\n        matching.forEach((node) => {\r\n          const ports = node.parameters.payload ? node.parameters.payload.split(',') : [];\r\n          for (let key of ports) {\r\n            portKeys[key] = true;\r\n          }\r\n        });\r\n\r\n        var ports = [];\r\n        for (var key in portKeys) {\r\n          ports.push({\r\n            name: key,\r\n            type: '*',\r\n            plug: 'output',\r\n            displayName: key\r\n          });\r\n        }\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports, {\r\n          detectRenamed: {\r\n            plug: 'output'\r\n          }\r\n        });\r\n      }\r\n\r\n      _collectPayloadPorts();\r\n      node.on('parameterUpdated', function (event) {\r\n        if (event.name === 'channelName') {\r\n          channelName = event.value;\r\n          _collectPayloadPorts();\r\n        }\r\n      });\r\n\r\n      // Track all event senders and update ports when they change\r\n      function _trackEventSender(node) {\r\n        //_collectPayloadPorts();\r\n\r\n        node.on('inputPortAdded', function (event) {\r\n          _collectPayloadPorts();\r\n        });\r\n\r\n        node.on('inputPortRemoved', function (event) {\r\n          _collectPayloadPorts();\r\n        });\r\n\r\n        node.on('parameterUpdated', function (event) {\r\n          if (event.name === 'channelName') {\r\n            _collectPayloadPorts();\r\n          }\r\n        });\r\n      }\r\n\r\n      graphModel.getNodesWithType('Event Sender').forEach(_trackEventSender);\r\n\r\n      graphModel.on('nodeAdded.Event Sender', _trackEventSender);\r\n\r\n      graphModel.on('nodeRemoved.Event Sender', (node) => {\r\n        _collectPayloadPorts();\r\n      });\r\n    }\r\n\r\n    //wait with dynamic ports until the entire graph is loaded\r\n    graphModel.on('editorImportComplete', () => {\r\n      //all future added nodes though delta updates\r\n      graphModel.on('nodeAdded.Event Receiver', (node) => onEventReceiver(node));\r\n\r\n      //existing nodes from the initial export\r\n      graphModel.getNodesWithType('Event Receiver').forEach((node) => onEventReceiver(node));\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst EventSender = {\r\n  name: 'Event Sender',\r\n  docs: 'https://docs.noodl.net/nodes/events/send-event',\r\n  displayNodeName: 'Send Event',\r\n  category: 'Events',\r\n  usePortAsLabel: 'channelName',\r\n  color: 'component',\r\n  exportDynamicPorts: true,\r\n  initialize: function () {\r\n    this._internal.inputValues = {};\r\n    this._internal.channelName = '';\r\n    this._internal.propagation = 'global';\r\n  },\r\n  inputs: {\r\n    sendEvent: {\r\n      displayName: 'Send',\r\n      valueChangedToTrue: function () {\r\n        var self = this;\r\n\r\n        //wait for all other inputs to update before sending\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          if (self._internal.propagation === 'global') {\r\n            self.context.sendGlobalEventFromEventSender(self._internal.channelName, self._internal.inputValues);\r\n          } else {\r\n            self.nodeScope.sendEventFromThisScope(\r\n              self._internal.channelName,\r\n              self._internal.inputValues,\r\n              self._internal.propagation\r\n            );\r\n          }\r\n        });\r\n      }\r\n    },\r\n    channelName: {\r\n      type: {\r\n        name: 'string',\r\n        allowEditOnly: true,\r\n        identifierOf: 'EventChannelName',\r\n        identifierDisplayName: 'Event Channels'\r\n      },\r\n      default: '',\r\n      group: 'Settings',\r\n      displayName: 'Channel Name',\r\n      set: function (value) {\r\n        this._internal.channelName = value;\r\n        this._internal.inputValues._channelName = value;\r\n      }\r\n    },\r\n    propagation: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { value: 'global', label: 'Global' },\r\n          { value: 'parent', label: 'Parent' },\r\n          { value: 'children', label: 'Children' },\r\n          { value: 'siblings', label: 'Siblings' }\r\n        ]\r\n      },\r\n      default: 'global',\r\n      group: 'Settings',\r\n      displayName: 'Send to',\r\n      set: function (value) {\r\n        this._internal.propagation = value;\r\n      }\r\n    },\r\n    payload: {\r\n      type: {\r\n        name: 'stringlist',\r\n        allowEditOnly: true\r\n      },\r\n      group: 'Payload'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    registerInputIfNeeded: {\r\n      value: function (name) {\r\n        if (this.hasInput(name)) {\r\n          return;\r\n        }\r\n        var self = this;\r\n        this.registerInput(name, {\r\n          set: function (value) {\r\n            self._internal.inputValues[name] = value;\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection) {\r\n  var ports = [];\r\n\r\n  // Add payload inputs\r\n  var payload = parameters.payload;\r\n  if (payload) {\r\n    payload = payload.split(',');\r\n    for (const p of payload) {\r\n      ports.push({\r\n        type: {\r\n          name: '*',\r\n          allowConnectionsOnly: true\r\n        },\r\n        plug: 'input',\r\n        group: 'Payload',\r\n        name: p,\r\n        displayName: p\r\n      });\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: 'input'\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: EventSender,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.Event Sender', function (node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n      node.on('parameterUpdated', function (event) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection);\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst Node = require('@noodl/runtime').Node;\r\nconst JavascriptNodeParser = require('@noodl/runtime/src/javascriptnodeparser');\r\nconst { logJavaScriptNodeError } = require('@noodl/runtime/src/utils');\r\nconst guid = require('../../guid');\r\n\r\n/*const defaultCode = \"define({\\n\"+\r\n\"\\t// The input ports of the Javascript node, name of input and type\\n\"+\r\n\"\\tinputs:{\\n\"+\r\n\"\\t    // ExampleInput:'number',\\n\"+\r\n\"\\t    // Available types are 'number', 'string', 'boolean', 'color' and 'signal',\\n\"+\r\n\"\\t    mySignal:'signal',\\n\"+\r\n\"\\t},\\n\"+\r\n\"\\t\\n\"+\r\n\"\\t// The output ports of the Javascript node, name of output and type\\n\"+\r\n\"\\toutputs:{\\n\"+\r\n\"\\t    // ExampleOutput:'string',\\n\"+\r\n\"\\t},\\n\"+\r\n\"\\t\\n\"+\r\n\"\\t// All signal inputs need their own function with the corresponding name that\\n\"+\r\n\"\\t// will be run when a signal is received on the input.\\n\"+\r\n\"\\tmySignal:function(inputs,outputs) {\\n\"+\r\n\"\\t\\t// ...\\n\"+\r\n\"\\t},\\n\"+\r\n\"\\t\\n\"+\r\n\"\\t// This function will be called when any of the inputs have changed\\n\"+\r\n\"\\tchange:function(inputs,outputs) {\\n\"+\r\n\"\\t\\t// ...\\n\"+\r\n\"\\t}\\n\"+\r\n\"})\\n\";*/\r\n\r\n/*\r\nconst defaultCode = \"script({\\n\"+\r\n\"\\t// The input ports of the Javascript node, name of input and type\\n\"+\r\n\"\\tinputs:{\\n\"+\r\n\"\\t    // ExampleInput:'number',\\n\"+\r\n\"\\t    // Available types are 'number', 'string', 'boolean', 'color'\\n\"+\r\n\"\\t    //myNumber:'number',\\n\"+\r\n\"\\t},\\n\"+\r\n\"\\t\\n\"+\r\n\"\\t// The output ports of the Javascript node, name of output and type\\n\"+\r\n\"\\toutputs:{\\n\"+\r\n\"\\t    // ExampleOutput:'string',\\n\"+\r\n\"\\t},\\n\"+\r\n\"\\t\\n\"+\r\n\"\\t// Declare signal handle functions here, each function will be \\n\"+\r\n\"\\t// exposed as a signal input to this node.\\n\"+\r\n\"\\tsignals:{\\n\"+\r\n\"\\t\\t// mySignal:function() {   }\\n\"+\r\n\"\\t},\\n\"+\r\n\"\\t\\n\"+\r\n\"\\t// These functions will be called when the correspinding input\\n\"+\r\n\"\\t// is changed and the new value is provided\\n\"+\r\n\"\\tchanged:{\\n\"+\r\n\"\\t\\t// myNumber:function(value) { }\\n\"+\r\n\"\\t},\\n\"+\r\n\"\\t\\n\"+\r\n\"\\t// Here you can declare any function that will then be available\\n\"+\r\n\"\\t// in this. So you can acces the function below with this.aFunction()\\n\"+\r\n\"\\tmethods:{\\n\"+\r\n\"\\t\\t// aFunction:function(value) { }\\n\"+\r\n\"\\t}\\n\"+\r\n\"})\\n\";\r\n*/\r\n\r\nconst defaultCode = '';\r\n\r\nvar Javascript = {\r\n  name: 'Javascript2',\r\n  docs: 'https://docs.noodl.net/nodes/javascript/script',\r\n  displayNodeName: 'Script',\r\n  category: 'CustomCode',\r\n  color: 'javascript',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'Code'\r\n  },\r\n  searchTags: ['javascript'],\r\n  exportDynamicPorts: true,\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.inputValues = {};\r\n    internal.outputValues = {};\r\n    internal.outputProperties = {};\r\n    internal.runScheduled = false;\r\n    internal.setupScheduled = false;\r\n    internal.runNextFrameScheduled = false;\r\n    internal.isWaitingForExternalFileToLoad = false;\r\n    internal.useExternalFile = false;\r\n    internal.runFunction = undefined;\r\n    internal.destroyFunction = undefined;\r\n    internal.setupFunction = undefined;\r\n    internal.hasParsedCode = false;\r\n    internal.changedInputs = {};\r\n    internal.signalScheduled = {};\r\n    internal.killed = false;\r\n    internal.inputQueue = [];\r\n\r\n    var self = this;\r\n    internal.userFunctionScope = {\r\n      createComponent(componentName) {\r\n        if (componentName && componentName.length > 0 && componentName[0] !== '/') {\r\n          componentName = '/' + componentName;\r\n        }\r\n\r\n        return self.nodeScope.createNode(componentName, guid());\r\n      },\r\n      deleteComponent(component) {\r\n        self.nodeScope.deleteNode(component);\r\n      },\r\n      flagOutputDirty: function (name) {\r\n        if (!name) {\r\n          throw new Error('Output port name must be specified');\r\n        }\r\n        self.flagOutputDirty(name);\r\n      },\r\n      runNextFrame: function () {\r\n        if (internal.runNextFrameScheduled) {\r\n          return;\r\n        }\r\n        internal.runNextFrameScheduled = true;\r\n        self.context.scheduleNextFrame(function () {\r\n          internal.runNextFrameScheduled = false;\r\n\r\n          if (!internal.killed) {\r\n            scheduleRun.call(self);\r\n          }\r\n        });\r\n      },\r\n      sendSignalOnOutput: function (name) {\r\n        self.sendSignalOnOutput(name);\r\n      }\r\n    };\r\n\r\n    internal.onFrameStart = onFrameStart.bind(this);\r\n  },\r\n  dynamicports: [\r\n    {\r\n      condition: 'useExternalFile = no OR useExternalFile NOT SET',\r\n      inputs: ['code']\r\n    },\r\n    {\r\n      condition: 'useExternalFile = yes',\r\n      inputs: ['externalFile']\r\n    }\r\n  ],\r\n  inputs: {\r\n    scriptInputs: {\r\n      type: {\r\n        name: 'proplist',\r\n        allowEditOnly: true\r\n      },\r\n      group: 'Script Inputs',\r\n      set: function (value) {\r\n        //  ignore\r\n      }\r\n    },\r\n    scriptOutputs: {\r\n      type: {\r\n        name: 'proplist',\r\n        allowEditOnly: true\r\n      },\r\n      group: 'Script Outputs',\r\n      set: function (value) {\r\n        //  ignore\r\n      }\r\n    },\r\n    useExternalFile: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          {\r\n            value: 'yes',\r\n            label: 'Yes'\r\n          },\r\n          {\r\n            value: 'no',\r\n            label: 'No'\r\n          }\r\n        ],\r\n        allowEditOnly: true\r\n      },\r\n      default: 'no',\r\n      displayName: 'Use External File',\r\n      group: 'Code',\r\n      set: function (value) {\r\n        this._internal.isWaitingForExternalFileToLoad = value === 'yes';\r\n        this._internal.useExternalFile = value === 'yes';\r\n      }\r\n    },\r\n    code: {\r\n      displayName: 'Code',\r\n      group: 'Code',\r\n      type: {\r\n        name: 'string',\r\n        allowEditOnly: true,\r\n        codeeditor: 'javascript'\r\n      },\r\n      default: defaultCode,\r\n      set: function (value) {\r\n        if (!value) {\r\n          return;\r\n        }\r\n        var self = this;\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          if (this._internal.useExternalFile === false) {\r\n            this._callDestroyFunction();\r\n            var parser = JavascriptNodeParser.createFromCode(value, {\r\n              node: this\r\n            });\r\n            self._onCodeParsed(parser);\r\n          }\r\n        });\r\n      }\r\n    },\r\n    externalFile: {\r\n      displayName: 'File Path',\r\n      group: 'Code',\r\n      type: {\r\n        name: 'source',\r\n        allowEditOnly: true\r\n      },\r\n      set: function (url) {\r\n        if (this._internal.useExternalFile === false) {\r\n          return;\r\n        }\r\n\r\n        var self = this;\r\n        JavascriptNodeParser.createFromURL(\r\n          url,\r\n          function (parser) {\r\n            self._internal.isWaitingForExternalFileToLoad = false;\r\n            self._onCodeParsed(parser);\r\n          },\r\n          {\r\n            node: this\r\n          }\r\n        );\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this._internal.killed = true;\r\n      this._callDestroyFunction();\r\n    },\r\n    update: function () {\r\n      if (this._internal.isWaitingForExternalFileToLoad === true) {\r\n        this._dirty = false;\r\n      } else {\r\n        Node.prototype.update.call(this);\r\n      }\r\n    },\r\n    _onCodeParsed: function (parser) {\r\n      const editorConnection = this.context.editorConnection;\r\n\r\n      if (editorConnection) {\r\n        for (const w of ['js-destroy-waring', 'js-run-waring', 'js-setup-waring']) {\r\n          editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, w);\r\n        }\r\n      }\r\n\r\n      if (parser.error) {\r\n        return;\r\n      }\r\n\r\n      //register all color inputs with type 'color' to enable color resolving\r\n      Object.keys(this.model.inputPorts).forEach((name) => {\r\n        const type = this.model.inputPorts[name].type;\r\n        if (type === 'color' || type.name === 'color') {\r\n          this._internal.inputValues[name] = undefined;\r\n\r\n          if (!this.hasInput(name)) {\r\n            this.registerInput(name, {\r\n              type: 'color',\r\n              set: userInputSetter.bind(this, name)\r\n            });\r\n          } else {\r\n            //input was registered before js was done parsing\r\n            //patch it instead of creating a new one\r\n            this.getInput(name).type = 'color';\r\n          }\r\n        }\r\n      });\r\n\r\n      Object.keys(this.model.outputPorts).forEach((name) => {\r\n        this.registerOutputIfNeeded(name);\r\n      });\r\n\r\n      this._internal.setupFunction = parser.setup;\r\n      this._internal.runFunction = parser.change; // Run function is actually called change\r\n      this._internal.destroyFunction = parser.destroy;\r\n\r\n      this._internal.definedObject = parser.definedObject;\r\n\r\n      if (this._internal.setupFunction) {\r\n        scheduleSetup.call(this);\r\n      }\r\n\r\n      if (this._internal.runFunction) {\r\n        scheduleRun.call(this);\r\n      }\r\n\r\n      this._internal.hasParsedCode = true;\r\n\r\n      //set all the inputs that arrived before the code was parsed\r\n      if (this._internal.inputQueue) {\r\n        for (const { name, value } of this._internal.inputQueue) {\r\n          this.setInputValue(name, value);\r\n        }\r\n\r\n        //delete the queue, not needed anymore\r\n        this._internal.inputQueue = undefined;\r\n      }\r\n\r\n      // Node API\r\n      parser.apis.Node.Inputs = this._internal.inputValues;\r\n      parser.apis.Node.Outputs = this._internal.outputProperties;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      this._internal.inputValues[name] = undefined;\r\n\r\n      this.registerInput(name, {\r\n        set: userInputSetter.bind(this, name)\r\n      });\r\n    },\r\n    registerOutputIfNeeded: function (name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      var self = this;\r\n\r\n      const isSignal = _typename(this.model.outputPorts[name].type) === 'signal';\r\n\r\n      Object.defineProperty(this._internal.outputProperties, name, {\r\n        set: function (value) {\r\n          if (isSignal) return; // Cannot set signal functions\r\n\r\n          self._internal.outputValues[name] = value;\r\n          self.flagOutputDirty(name);\r\n        },\r\n        get: function () {\r\n          if (isSignal)\r\n            return () => {\r\n              if (self.hasOutput(name)) self.sendSignalOnOutput(name);\r\n            };\r\n          return self._internal.outputValues[name];\r\n        }\r\n      });\r\n\r\n      this.registerOutput(name, {\r\n        getter: userOutputGetter.bind(this, name)\r\n      });\r\n    },\r\n    _callRunFunction: function () {\r\n      var internal = this._internal;\r\n      if (!internal.runFunction || internal.killed) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        internal.runFunction.call(\r\n          internal.userFunctionScope,\r\n          internal.inputValues,\r\n          internal.outputProperties,\r\n          internal.changedInputs\r\n        );\r\n      } catch (e) {\r\n        logJavaScriptNodeError(e);\r\n\r\n        if (this.context.editorConnection && this.context.isWarningTypeEnabled('javascriptExecution')) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'js-run-waring', {\r\n            showGlobally: true,\r\n            message: '<strong>run</strong>: ' + e.message\r\n          });\r\n        }\r\n      }\r\n    },\r\n    _callSignalFunction: function (name) {\r\n      var internal = this._internal;\r\n      if (!internal.definedObject || internal.killed) {\r\n        return;\r\n      }\r\n\r\n      if (!internal.definedObject[name] || typeof internal.definedObject[name] !== 'function') {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        internal.definedObject[name].call(internal.userFunctionScope, internal.inputValues, internal.outputProperties);\r\n      } catch (e) {\r\n        console.log(\r\n          'Error in JS node signal function code.',\r\n          Object.getPrototypeOf(e).constructor.name + ': ' + e.message\r\n        );\r\n        if (this.context.editorConnection && this.context.isWarningTypeEnabled('javascriptExecution')) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'js-run-waring', {\r\n            showGlobally: true,\r\n            message: '<strong>run</strong>: ' + e.message\r\n          });\r\n        }\r\n      }\r\n    },\r\n    _callDestroyFunction: function () {\r\n      var internal = this._internal;\r\n\r\n      if (!internal.destroyFunction) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        internal.destroyFunction.call(internal.userFunctionScope, internal.inputValues, internal.outputProperties);\r\n      } catch (e) {\r\n        console.log('Error in JS node destroy code.', Object.getPrototypeOf(e).constructor.name + ': ' + e.message);\r\n        if (this.context.editorConnection && this.context.isWarningTypeEnabled('javascriptExecution')) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'js-destroy-waring', {\r\n            showGlobally: true,\r\n            message: '<strong>setup</strong>: ' + e.message\r\n          });\r\n        }\r\n      }\r\n    },\r\n    _callSetupFunction: function () {\r\n      var internal = this._internal;\r\n      if (!internal.setupFunction || internal.killed) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        internal.setupFunction.call(internal.userFunctionScope, internal.inputValues, internal.outputProperties);\r\n      } catch (e) {\r\n        console.log('Error in JS node setup code.', Object.getPrototypeOf(e).constructor.name + ': ' + e.message);\r\n        if (this.context.editorConnection && this.context.isWarningTypeEnabled('javascriptExecution')) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'js-setup-waring', {\r\n            showGlobally: true,\r\n            message: '<strong>setup</strong>: ' + e.message\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nfunction scheduleSetup() {\r\n  /* jshint validthis:true */\r\n  if (this._internal.setupScheduled) {\r\n    return;\r\n  }\r\n\r\n  this._internal.setupScheduled = true;\r\n  this.scheduleAfterInputsHaveUpdated(function () {\r\n    if (!this._internal.killed) {\r\n      this._callSetupFunction();\r\n      this._internal.setupScheduled = false;\r\n    }\r\n  });\r\n}\r\n\r\nfunction scheduleRun() {\r\n  /* jshint validthis:true */\r\n  if (this._internal.runScheduled || this._internal.killed) {\r\n    return;\r\n  }\r\n\r\n  this._internal.runScheduled = true;\r\n  this.scheduleAfterInputsHaveUpdated(function () {\r\n    if (!this._internal.killed) {\r\n      this._callRunFunction();\r\n      this._internal.changedInputs = {};\r\n      this._internal.runScheduled = false;\r\n    }\r\n  });\r\n}\r\n\r\nfunction scheduleSignal(name) {\r\n  /* jshint validthis:true */\r\n  if (this._internal.signalScheduled[name] || this._internal.killed) {\r\n    return;\r\n  }\r\n\r\n  this._internal.signalScheduled[name] = true;\r\n  this.scheduleAfterInputsHaveUpdated(function () {\r\n    if (!this._internal.killed) {\r\n      this._callSignalFunction(name);\r\n      this._internal.signalScheduled[name] = false;\r\n    }\r\n  });\r\n}\r\n\r\nfunction onFrameStart() {\r\n  /* jshint validthis:true */\r\n  this._internal.runNextFrame = false;\r\n  scheduleRun.call(this);\r\n}\r\n\r\nfunction _typename(type) {\r\n  if (typeof type === 'string') return type;\r\n  else return type.name;\r\n}\r\n\r\nfunction userInputSetter(name, value) {\r\n  /* jshint validthis:true */\r\n\r\n  if (this._internal.hasParsedCode === true) {\r\n    if (this.model.inputPorts[name] !== undefined && _typename(this.model.inputPorts[name].type) === 'signal') {\r\n      // If this is a signal, call the signal function\r\n      if (this._internal.definedObject && typeof this._internal.definedObject[name] === 'function') {\r\n        // This is a signal input, schedule a call to the signal function\r\n        if (value) scheduleSignal.call(this, name);\r\n      }\r\n    } else {\r\n      this._internal.inputValues[name] = value;\r\n      this._internal.changedInputs[name] = true;\r\n      scheduleRun.call(this);\r\n    }\r\n  } else {\r\n    //inputs are arriving before the code is parsed\r\n    //queue them up and set them later to make sure signals are\r\n    //properly recognized\r\n    this._internal.inputQueue.push({\r\n      name,\r\n      value\r\n    });\r\n  }\r\n}\r\n\r\nfunction userOutputGetter(name) {\r\n  /* jshint validthis:true */\r\n  return this._internal.outputValues[name];\r\n}\r\n\r\nfunction _parseAndSourceJavascript(nodeModel, context, fn) {\r\n  var editorConnection = context.editorConnection;\r\n\r\n  if (!nodeModel.parameters) {\r\n    return;\r\n  }\r\n\r\n  function clearWarnings() {\r\n    for (const w of ['js-parse-waring', 'js-destroy-waring', 'js-run-waring', 'js-setup-waring']) {\r\n      editorConnection.clearWarning(nodeModel.component.name, nodeModel.id, w);\r\n    }\r\n  }\r\n\r\n  function onCodeParsed(parser) {\r\n    if (parser.error) {\r\n      editorConnection.sendWarning(nodeModel.component.name, nodeModel.id, 'js-parse-waring', {\r\n        showGlobally: true,\r\n        message: parser.error\r\n      });\r\n    } else {\r\n      clearWarnings();\r\n    }\r\n\r\n    fn(parser.getPorts());\r\n  }\r\n\r\n  if (nodeModel.parameters.externalFile && nodeModel.parameters.useExternalFile === 'yes') {\r\n    var url = nodeModel.parameters.externalFile;\r\n    JavascriptNodeParser.createFromURL(url, onCodeParsed);\r\n  } else if (nodeModel.parameters.code) {\r\n    var parser = JavascriptNodeParser.createFromCode(nodeModel.parameters.code);\r\n    onCodeParsed(parser);\r\n  } else {\r\n    //no code, just send empty port list\r\n    clearWarnings();\r\n    fn([]);\r\n  }\r\n}\r\nmodule.exports = {\r\n  node: Javascript,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _updatePorts() {\r\n        var ports = [];\r\n\r\n        const _inputTypeEnums = [\r\n          {\r\n            value: 'string',\r\n            label: 'String'\r\n          },\r\n          {\r\n            value: 'boolean',\r\n            label: 'Boolean'\r\n          },\r\n          {\r\n            value: 'number',\r\n            label: 'Number'\r\n          },\r\n          {\r\n            value: 'object',\r\n            label: 'Object'\r\n          },\r\n          {\r\n            value: 'array',\r\n            label: 'Array'\r\n          }\r\n        ];\r\n\r\n        const _outputTypeEnums = [\r\n          {\r\n            value: 'string',\r\n            label: 'String'\r\n          },\r\n          {\r\n            value: 'boolean',\r\n            label: 'Boolean'\r\n          },\r\n          {\r\n            value: 'number',\r\n            label: 'Number'\r\n          },\r\n          {\r\n            value: 'object',\r\n            label: 'Object'\r\n          },\r\n          {\r\n            value: 'array',\r\n            label: 'Array'\r\n          },\r\n          {\r\n            value: 'signal',\r\n            label: 'Signal'\r\n          }\r\n        ];\r\n\r\n        // Outputs\r\n        if (node.parameters['scriptOutputs'] !== undefined && node.parameters['scriptOutputs'].length > 0) {\r\n          node.parameters['scriptOutputs'].forEach((p) => {\r\n            // Type for output\r\n            ports.push({\r\n              name: 'outtype-' + p.label,\r\n              displayName: 'Type',\r\n              plug: 'input',\r\n              type: {\r\n                name: 'enum',\r\n                enums: _outputTypeEnums,\r\n                allowEditOnly: true\r\n              },\r\n              default: 'string',\r\n              parent: 'scriptOutputs',\r\n              parentItemId: p.id\r\n            });\r\n\r\n            // Value for output\r\n            ports.push({\r\n              name: p.label,\r\n              plug: 'output',\r\n              type: node.parameters['outtype-' + p.label] || '*',\r\n              group: 'Outputs'\r\n            });\r\n          });\r\n        }\r\n\r\n        // Inputs\r\n        if (node.parameters['scriptInputs'] !== undefined && node.parameters['scriptInputs'].length > 0) {\r\n          node.parameters['scriptInputs'].forEach((p) => {\r\n            // Type for input\r\n            ports.push({\r\n              name: 'intype-' + p.label,\r\n              displayName: 'Type',\r\n              plug: 'input',\r\n              type: {\r\n                name: 'enum',\r\n                enums: _inputTypeEnums,\r\n                allowEditOnly: true\r\n              },\r\n              default: 'string',\r\n              parent: 'scriptInputs',\r\n              parentItemId: p.id\r\n            });\r\n\r\n            // Default Value for input\r\n            ports.push({\r\n              name: p.label,\r\n              plug: 'input',\r\n              type: node.parameters['intype-' + p.label] || 'string',\r\n              group: 'Inputs'\r\n            });\r\n          });\r\n        }\r\n\r\n        _parseAndSourceJavascript(node, context, function (_ports) {\r\n          // Merge in ports from script\r\n          _ports.forEach((p) => {\r\n            if (ports.find((_p) => _p.name === p.name && _p.plug === p.plug)) return; // Port already exists\r\n\r\n            ports.push(p);\r\n          });\r\n\r\n          context.editorConnection.sendDynamicPorts(node.id, ports);\r\n        });\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on('parameterUpdated', function (ev) {\r\n        _updatePorts();\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.Javascript2', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('Javascript2')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst NumberRemapperNode = {\r\n  name: 'Number Remapper',\r\n  docs: 'https://docs.noodl.net/nodes/math/number-remapper',\r\n  category: 'Math',\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal._currentInputValue = 0;\r\n    internal._remappedValue = 0;\r\n    internal._minInputValue = 0;\r\n    internal._maxInputValue = 0;\r\n    internal._minOutputValue = 0;\r\n    internal._maxOutputValue = 1;\r\n    internal._clampOutput = true;\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal._remappedValue;\r\n  },\r\n  inputs: {\r\n    inputValue: {\r\n      group: 'Value to Remap',\r\n      type: {\r\n        name: 'number',\r\n        allowConnectionOnly: true\r\n      },\r\n      default: 0,\r\n      displayName: 'Input Value',\r\n      set: function (value) {\r\n        this._internal._currentInputValue = value;\r\n        this._calculateNewOutputValue();\r\n      }\r\n    },\r\n    minInputValue: {\r\n      group: 'Input Parameters',\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      default: 0,\r\n      displayName: 'Input Minimum',\r\n      set: function (value) {\r\n        this._internal._minInputValue = value;\r\n        this._calculateNewOutputValue();\r\n      }\r\n    },\r\n    maxInputValue: {\r\n      group: 'Input Parameters',\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      default: 0,\r\n      displayName: 'Input Maximum',\r\n      set: function (value) {\r\n        this._internal._maxInputValue = value;\r\n        this._calculateNewOutputValue();\r\n      }\r\n    },\r\n    minOutputValue: {\r\n      group: 'Output Parameters',\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      default: 0,\r\n      displayName: 'Output Minimum',\r\n      set: function (value) {\r\n        this._internal._minOutputValue = value;\r\n        this._calculateNewOutputValue();\r\n      }\r\n    },\r\n    maxOutputValue: {\r\n      group: 'Output Parameters',\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      default: 1,\r\n      displayName: 'Output Maximum',\r\n      set: function (value) {\r\n        this._internal._maxOutputValue = value;\r\n        this._calculateNewOutputValue();\r\n      }\r\n    },\r\n    clamp: {\r\n      group: 'Output Parameters',\r\n      type: {\r\n        name: 'boolean',\r\n        allowEditOnly: true\r\n      },\r\n      default: true,\r\n      displayName: 'Clamp Output',\r\n      set: function (value) {\r\n        this._internal._clampOutput = value ? true : false;\r\n        this._calculateNewOutputValue();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    remappedValue: {\r\n      type: 'number',\r\n      displayName: 'Remapped Value',\r\n      group: 'Outputs',\r\n      getter: function () {\r\n        return this._internal._remappedValue;\r\n      }\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    _calculateNewOutputValue: {\r\n      value: function () {\r\n        var normalizedValue,\r\n          _internal = this._internal;\r\n\r\n        if (_internal._maxInputValue === _internal._minInputValue) {\r\n          normalizedValue = 0;\r\n        } else {\r\n          normalizedValue =\r\n            (_internal._currentInputValue - _internal._minInputValue) /\r\n            (_internal._maxInputValue - _internal._minInputValue);\r\n        }\r\n\r\n        if (_internal._clampOutput) {\r\n          normalizedValue = Math.max(0, Math.min(1, normalizedValue));\r\n        }\r\n        _internal._remappedValue =\r\n          _internal._minOutputValue + normalizedValue * (_internal._maxOutputValue - _internal._minOutputValue);\r\n        this.flagOutputDirty('remappedValue');\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: NumberRemapperNode\r\n};\r\n","'use strict';\r\n\r\nconst OpenFilePicker = {\r\n  name: 'Open File Picker',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/open-file-picker',\r\n  category: 'Utilities',\r\n  getInspectInfo() {\r\n    if (this._internal.file) {\r\n      return this._internal.file.path;\r\n    }\r\n  },\r\n  initialize() {\r\n    //for some reason the input element has to be created here, it doesn't\r\n    //work predictably in Safari when created in the open signal function.\r\n    //Creating it here and reusing it seems to work correctly in all browsers.\r\n    const input = document.createElement('input');\r\n    input.type = 'file';\r\n\r\n    this._internal.inputElement = input;\r\n  },\r\n  inputs: {\r\n    open: {\r\n      type: 'signal',\r\n      displayName: 'Open',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        const input = this._internal.inputElement;\r\n\r\n        const onChange = (e) => {\r\n          this._internal.file = e.target.files[0];\r\n\r\n          this.flagOutputDirty('file');\r\n          this.flagOutputDirty('path');\r\n          this.flagOutputDirty('name');\r\n          this.flagOutputDirty('sizeInBytes');\r\n          this.flagOutputDirty('type');\r\n\r\n          this.sendSignalOnOutput('success');\r\n\r\n          input.onchange = null;\r\n          input.value = ''; //reset value so the same file can be picked again\r\n        };\r\n\r\n        input.accept = this._internal.acceptedFileTypes;\r\n\r\n        if (this._internal.capture) {\r\n          input.capture = this._internal.capture;\r\n        }\r\n\r\n        input.onchange = onChange;\r\n        input.click();\r\n      }\r\n    },\r\n    acceptedFileTypes: {\r\n      group: 'General',\r\n      type: 'string',\r\n      displayName: 'Accepted file types',\r\n      set(value) {\r\n        this._internal.acceptedFileTypes = value;\r\n      }\r\n    },\r\n    capture: {\r\n      group: 'General',\r\n      type: 'string',\r\n      displayName: 'Capture',\r\n      set(value) {\r\n        this._internal.capture = value;\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    file: {\r\n      type: '*',\r\n      displayName: 'File',\r\n      group: 'General',\r\n      get() {\r\n        return this._internal.file;\r\n      }\r\n    },\r\n    path: {\r\n      displayName: 'Path',\r\n      group: 'Metadata',\r\n      type: 'string',\r\n      get() {\r\n        return this._internal.file && this._internal.file.path;\r\n      }\r\n    },\r\n    name: {\r\n      displayName: 'Name',\r\n      group: 'Metadata',\r\n      type: 'string',\r\n      get() {\r\n        return this._internal.file && this._internal.file.name;\r\n      }\r\n    },\r\n    sizeInBytes: {\r\n      displayName: 'Size in bytes',\r\n      group: 'Metadata',\r\n      type: 'number',\r\n      get() {\r\n        return this._internal.file && this._internal.file.size;\r\n      }\r\n    },\r\n    type: {\r\n      displayName: 'Type',\r\n      group: 'Metadata',\r\n      type: 'string',\r\n      get() {\r\n        return this._internal.file && this._internal.file.type;\r\n      }\r\n    },\r\n    success: {\r\n      type: 'signal',\r\n      group: 'Events',\r\n      displayName: 'Success'\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: OpenFilePicker\r\n};\r\n","'use strict';\r\n\r\nconst ScreenResolution = {\r\n  name: 'Screen Resolution',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/screen-resolution',\r\n  category: 'Utilities',\r\n  initialize() {\r\n    // Add SSR Support\r\n    if (typeof window === 'undefined') return;\r\n\r\n    window.addEventListener('resize', () => {\r\n      this._viewportSizeChanged();\r\n    });\r\n    this._viewportSizeChanged();\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.width + ' x ' + this._internal.height;\r\n  },\r\n  outputs: {\r\n    width: {\r\n      type: 'number',\r\n      displayName: 'Width',\r\n      get() {\r\n        return this._internal.width;\r\n      }\r\n    },\r\n    height: {\r\n      type: 'number',\r\n      displayName: 'Height',\r\n      get() {\r\n        return this._internal.height;\r\n      }\r\n    },\r\n    aspectRatio: {\r\n      type: 'number',\r\n      displayName: 'Aspect Ratio',\r\n      get() {\r\n        return this._internal.width / this._internal.height;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    _viewportSizeChanged() {\r\n      this._internal.width = window.innerWidth;\r\n      this._internal.height = window.innerHeight;\r\n      this.flagAllOutputsDirty();\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: ScreenResolution\r\n};\r\n","'use strict';\r\n\r\nconst { EdgeTriggeredInput } = require('@noodl/runtime');\r\nconst EaseCurves = require('../../easecurves');\r\nconst BezierEasing = require('bezier-easing');\r\n\r\nconst defaultDuration = 300;\r\nconst previousStates = {},\r\n  previousValues = {};\r\n\r\nfunction setRGBA(result, hex) {\r\n  if (hex === 'transparent' || !hex) {\r\n    result[3] = 0;\r\n    return;\r\n  }\r\n\r\n  const numComponents = (hex.length - 1) / 2;\r\n\r\n  for (let i = 0; i < numComponents; ++i) {\r\n    const index = 1 + i * 2;\r\n    result[i] = parseInt(hex.substring(index, index + 2), 16);\r\n  }\r\n}\r\n\r\nfunction componentToHex(c) {\r\n  var hex = c.toString(16);\r\n  return hex.length == 1 ? '0' + hex : hex;\r\n}\r\n\r\nfunction rgbaToHex(rgba) {\r\n  return '#' + componentToHex(rgba[0]) + componentToHex(rgba[1]) + componentToHex(rgba[2]) + componentToHex(rgba[3]);\r\n}\r\n\r\nconst StatesNode = {\r\n  name: 'States',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/logic/states',\r\n  shortDesc: 'Define states with values and this node can interpolate between these values when the state is changed.',\r\n  category: 'Animation',\r\n  initialize: function () {\r\n    var _this = this,\r\n      _internal = this._internal;\r\n\r\n    _internal.useTransitions = true;\r\n    _internal.currentValues = {};\r\n    _internal.stateParameters = {};\r\n    _internal.stateParameterTypes = {};\r\n    _internal.startValues = {};\r\n    _internal.bezierEaseCurves = {};\r\n    _internal.transitionFuncs = {};\r\n\r\n    _internal.valuesAreInitialised = false;\r\n    _internal.animation = this.context.timerScheduler.createTimer({\r\n      duration: defaultDuration,\r\n      ease: EaseCurves.easeOut,\r\n      onStart: function () {\r\n        var values = _internal.values;\r\n        var startValues = _internal.startValues;\r\n        var stateValues = _internal.stateParameters;\r\n        var valueTypes = _internal.stateParameterTypes;\r\n        var prefix = 'value-' + _internal.state + '-';\r\n\r\n        this.targetValues = {};\r\n        this.startValues = {};\r\n        this.valueTypes = {};\r\n\r\n        for (var v in this.transitionCurves) {\r\n          // var v = values[i];\r\n\r\n          if (valueTypes['type-' + v] === 'number' || valueTypes['type-' + v] === undefined) {\r\n            this.valueTypes[v] = 'number';\r\n            this.startValues[v] = startValues[v];\r\n            this.targetValues[v] = stateValues[prefix + v] || 0;\r\n          } else if (valueTypes['type-' + v] === 'color') {\r\n            this.valueTypes[v] = 'color';\r\n\r\n            this.startValues[v] = [0, 0, 0, 255];\r\n            setRGBA(this.startValues[v], _this.context.styles.resolveColor(startValues[v] || '#000000'));\r\n\r\n            this.targetValues[v] = [0, 0, 0, 255];\r\n            setRGBA(this.targetValues[v], _this.context.styles.resolveColor(stateValues[prefix + v] || '#000000'));\r\n          }\r\n        }\r\n      },\r\n      onRunning: function (t) {\r\n        var ms = t * this.duration;\r\n        var currentValues = _internal.currentValues;\r\n\r\n        var rgba2 = [0, 0, 0, 255];\r\n        for (var v in this.transitionCurves) {\r\n          var c = this.transitionCurves[v];\r\n          //  var v = values[i];\r\n\r\n          if (ms < c.delay) currentValues[v] = this.startValues[v];\r\n          else if (ms >= c.delay + c.dur)\r\n            currentValues[v] = this.valueTypes[v] === 'color' ? rgbaToHex(this.targetValues[v]) : this.targetValues[v];\r\n          else {\r\n            var _t = _internal.transitionFuncs[v].get((ms - c.delay) / c.dur);\r\n            if (this.valueTypes[v] === 'number') {\r\n              //convert values to Numers, since they might be strings, which can cause NaN\r\n              currentValues[v] = EaseCurves.linear(Number(this.startValues[v]), Number(this.targetValues[v]), _t);\r\n            } else if (this.valueTypes[v] === 'color') {\r\n              let rgba0 = this.startValues[v];\r\n              let rgba1 = this.targetValues[v];\r\n              rgba2[0] = Math.floor(EaseCurves.linear(rgba0[0], rgba1[0], _t));\r\n              rgba2[1] = Math.floor(EaseCurves.linear(rgba0[1], rgba1[1], _t));\r\n              rgba2[2] = Math.floor(EaseCurves.linear(rgba0[2], rgba1[2], _t));\r\n              rgba2[3] = Math.floor(EaseCurves.linear(rgba0[3], rgba1[3], _t));\r\n\r\n              currentValues[v] = rgbaToHex(rgba2);\r\n            }\r\n          }\r\n          _this.flagOutputDirty(v);\r\n        }\r\n      },\r\n      onFinish: function () {\r\n        var port = 'reached-' + _internal.state;\r\n        if (_this.hasOutput(port)) _this.sendSignalOnOutput(port);\r\n      }\r\n    });\r\n  },\r\n  getInspectInfo() {\r\n    return `Current state: ${this._internal.state}`;\r\n  },\r\n  inputs: {\r\n    states: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      displayName: 'States',\r\n      group: 'States',\r\n      set: function (value) {\r\n        this._internal.states = value ? value.split(',') : [];\r\n\r\n        // Set the state to first value if no state change is scheduled during\r\n        // input updates\r\n        if (this._internal.states.length > 0) {\r\n          var _this = this;\r\n          if (!_this._internal.state) this.scheduleGoToState(_this._internal.startState || _this._internal.states[0]);\r\n          /*  this.scheduleAfterInputsHaveUpdated(function () {\r\n                        if (!_this._internal.state) _this.goToState(_this._internal.startState ||_this._internal.states[0]);\r\n                    });*/\r\n        }\r\n      }\r\n    },\r\n    values: {\r\n      type: { name: 'stringlist', allowEditOnly: true },\r\n      displayName: 'Values',\r\n      group: 'Values',\r\n      set: function (value) {\r\n        var internal = this._internal;\r\n        internal.values = value.split(',');\r\n\r\n        // Register output values at this point\r\n        for (var i in internal.values) {\r\n          this.registerOutputIfNeeded(internal.values[i]);\r\n        }\r\n      }\r\n    },\r\n    toggle: {\r\n      group: 'Go to state',\r\n      displayName: 'Toggle',\r\n      valueChangedToTrue: function () {\r\n        var internal = this._internal;\r\n        var _this = this;\r\n\r\n        if (!internal.states) return;\r\n\r\n        // Figure out which state to toggle to\r\n        var idx = internal.states.indexOf(internal.state);\r\n        var nextIdx = (idx + 1) % internal.states.length;\r\n\r\n        // Go to state when all updates have updated\r\n        //this._internal.scheduledToGoToState = internal.states[nextIdx];\r\n        this.scheduleGoToState(internal.states[nextIdx]);\r\n        /*  this.scheduleAfterInputsHaveUpdated(function () {\r\n                    _this.goToState(internal.states[nextIdx]);\r\n                });*/\r\n      }\r\n    },\r\n    useTransitions: {\r\n      type: 'boolean',\r\n      displayName: 'Use Transitions',\r\n      group: 'General',\r\n      default: true,\r\n      set: function (value) {\r\n        var internal = this._internal;\r\n        internal.useTransitions = value;\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    currentState: {\r\n      type: 'string',\r\n      displayName: 'State',\r\n      group: 'Current State',\r\n      getter: function () {\r\n        return this._internal.state;\r\n      }\r\n    },\r\n    stateChanged: {\r\n      type: 'signal',\r\n      displayName: 'State Changed',\r\n      group: 'Current State'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    registerOutputIfNeeded: function (name) {\r\n      var internal = this._internal;\r\n\r\n      if (this.hasOutput(name)) return;\r\n\r\n      this.registerOutput(name, {\r\n        getter: function () {\r\n          return internal.currentValues[name];\r\n        }\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      var _this = this;\r\n      var internal = this._internal;\r\n\r\n      if (this.hasInput(name)) return;\r\n\r\n      if (name.indexOf('to-') === 0) {\r\n        // This is a go to state signal input\r\n        var state = name.substring(3);\r\n        this.registerInput(name, {\r\n          set: EdgeTriggeredInput.createSetter({\r\n            valueChangedToTrue: function () {\r\n              //this._internal.scheduledToGoToState = state;\r\n              this.scheduleGoToState(state);\r\n              //this.scheduleAfterInputsHaveUpdated(function () { _this.goToState(state) });\r\n            }\r\n          })\r\n        });\r\n      } else if (name === 'startState') {\r\n        // Note: this is kept for backwards compatability, but this port is no longer part of the dynamic ports def\r\n        // Other state parameters are stored\r\n        this.registerInput(name, {\r\n          set: function (value) {\r\n            //this._internal.scheduledToGoToState = value;\r\n            this._internal.startState = value;\r\n            this.scheduleGoToState(value);\r\n            //   this.scheduleAfterInputsHaveUpdated(function () { _this.goToState(value); });\r\n          }\r\n        });\r\n      } else if (name === 'currentState') {\r\n        this.registerInput(name, {\r\n          set: this.scheduleGoToState.bind(this)\r\n        });\r\n      } else if (name.indexOf('type-') === 0) {\r\n        this.registerInput(name, {\r\n          set: function (value) {\r\n            internal.stateParameterTypes[name] = value;\r\n          }\r\n        });\r\n      } else if (name.indexOf('value-') === 0) {\r\n        // Other state parameters are stored\r\n        var parts = name.split('-');\r\n        var state = parts[1];\r\n        var valueName = parts[2];\r\n\r\n        this.registerInput(name, {\r\n          set: function (value) {\r\n            internal.stateParameters[name] = value;\r\n            if (internal.state === state) {\r\n              // If we are at the state, update the current value immediately\r\n              internal.currentValues[valueName] = value;\r\n              _this.flagOutputDirty(valueName);\r\n            }\r\n          }\r\n        });\r\n      } else if (name.search(/duration-/g) === 0) {\r\n        this.registerInput(name, {\r\n          set: function (value) {\r\n            internal.stateParameters[name] = value;\r\n          }\r\n        });\r\n      } else if (name.search(/transition/g) === 0) {\r\n        var state = name.substring(11);\r\n        this.registerInput(name, {\r\n          set: function (value) {\r\n            internal.stateParameters[name] = value;\r\n            /*   if (value === 'cubicBezier') {\r\n                            this.updateCubicBezierFunction(state); //create a default bezier easing curve\r\n                        }*/\r\n          }\r\n        });\r\n      }\r\n      /*   else if (name.search(/cubicBezierP[1-2][X-Y]-/g) === 0) {\r\n                var state = name.substring(15);\r\n                this.registerInput(name, {\r\n                    set: function (value) {\r\n                        internal.stateParameters[name] = value;\r\n                        this.updateCubicBezierFunction(state); //update easing curve\r\n                    }\r\n\r\n                });\r\n            }*/\r\n    },\r\n    /*   updateCubicBezierFunction: function (state) {\r\n            var points = [];\r\n            var internal = this._internal;\r\n            ['1X', '1Y', '2X', '2Y'].forEach(function (p, i) {\r\n                var value = internal.stateParameters['cubicBezierP' + p + '-' + state] || 0;\r\n                if (i % 2 === 0) {\r\n                    //X values must equal [0,1]\r\n                    value = Math.min(1, Math.max(0, value));\r\n                }\r\n                points.push(value);\r\n            });\r\n            var cubicBezierEase = BezierEasing(points);\r\n            internal.bezierEaseCurves[state] = function (start, end, t) {\r\n                return EaseCurves.linear(start, end, cubicBezierEase.get(t));\r\n            };\r\n        },*/\r\n    setCurrentState: function (value) {\r\n      this.scheduleGoToState(value);\r\n    },\r\n    jumpToState: function (state) {\r\n      var internal = this._internal;\r\n      if (!internal.states) return;\r\n      if (!state) state = internal.states[0];\r\n      if (internal.state === state) return;\r\n\r\n      internal.animation.stop();\r\n\r\n      var prefix = 'value-' + state + '-';\r\n      for (var i in internal.values) {\r\n        var v = internal.values[i];\r\n\r\n        internal.currentValues[v] = internal.stateParameters[prefix + v] || 0;\r\n\r\n        this.flagOutputDirty(v);\r\n      }\r\n\r\n      internal.state = state;\r\n      //console.log('currentState dirty:' + state);\r\n      this.flagOutputDirty('currentState');\r\n\r\n      if (internal.valuesAreInitialised) {\r\n        // Do not send state changed on first initial state set\r\n        //console.log('stateChanged signal', state);\r\n        this.sendSignalOnOutput('stateChanged');\r\n      }\r\n      internal.valuesAreInitialised = true;\r\n\r\n      this.updateAtStatePorts();\r\n    },\r\n    scheduleGoToState: function (state) {\r\n      var _this = this;\r\n\r\n      this._internal.goToState = state;\r\n\r\n      //console.log('set go to state: ' + state)\r\n      if (this.hasScheduledGoToState) return;\r\n      this.hasScheduledGoToState = true;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        //console.log('changing state: ' + _this._internal.goToState)\r\n        _this.hasScheduledGoToState = false;\r\n        _this.goToState(_this._internal.goToState);\r\n      });\r\n    },\r\n    goToState: function (state) {\r\n      var internal = this._internal;\r\n      if (!internal.states) return;\r\n      if (!state) state = internal.states[0];\r\n      if (internal.state === state) return;\r\n\r\n      //this._internal.scheduledToGoToState = undefined;\r\n      if (!internal.valuesAreInitialised) {\r\n        // First time go to state is called, jump to the state\r\n        this.jumpToState(state);\r\n      } else {\r\n        // Copy current values as start values\r\n        var delay = 0;\r\n        var dur = 0;\r\n        var transitionCurves = {};\r\n        for (var i in internal.values) {\r\n          var v = internal.values[i];\r\n\r\n          internal.startValues[v] = internal.currentValues[v];\r\n\r\n          const parameterType = internal.stateParameterTypes['type-' + v];\r\n          if (parameterType === 'boolean') {\r\n            // These types don't transition, just set them\r\n            var _b = internal.stateParameters['value-' + state + '-' + v];\r\n            internal.currentValues[v] = _b === undefined ? false : !!_b;\r\n            this.flagOutputDirty(v);\r\n          } else if (parameterType === 'string' || parameterType === 'textStyle') {\r\n            // These types don't transition, just set them\r\n            internal.currentValues[v] = internal.stateParameters['value-' + state + '-' + v];\r\n            this.flagOutputDirty(v);\r\n          } else {\r\n            // Figure out transition curve\r\n            var transitionCurve = internal.stateParameters['transition-' + state + '-' + v];\r\n            if (!transitionCurve)\r\n              transitionCurve = internal.stateParameters['transitiondef-' + state] || {\r\n                curve: [0.0, 0.0, 0.58, 1.0],\r\n                dur: 300,\r\n                delay: 0\r\n              };\r\n\r\n            if ((transitionCurve.dur === 0 && transitionCurve.delay === 0) || !internal.useTransitions) {\r\n              // Simply set the target value\r\n              internal.currentValues[v] = internal.stateParameters['value-' + state + '-' + v];\r\n              this.flagOutputDirty(v);\r\n            } else {\r\n              // Calculate total duration and delay\r\n              internal.transitionFuncs[v] = BezierEasing(transitionCurve.curve);\r\n              transitionCurves[v] = transitionCurve;\r\n              delay = Math.min(delay, transitionCurve.delay);\r\n              dur = Math.max(dur, transitionCurve.dur + transitionCurve.delay);\r\n            }\r\n          }\r\n        }\r\n\r\n        // Setup and start animation\r\n        //var easeCurveName = internal.stateParameters['transition-' + state] || 'easeOut';\r\n        //internal.animation.ease = easeCurveName === 'cubicBezier' ? internal.bezierEaseCurves[state] : EaseCurves[easeCurveName];\r\n        //var durationKey = 'duration-' + state;\r\n        //internal.animation.duration = internal.stateParameters.hasOwnProperty(durationKey) ? internal.stateParameters[durationKey] : defaultDuration;\r\n        if (dur > 0 || delay > 0) {\r\n          internal.animation.transitionCurves = transitionCurves;\r\n          internal.animation.duration = dur;\r\n          internal.animation.delay = delay;\r\n          internal.animation.start();\r\n        }\r\n\r\n        internal.state = state;\r\n        //console.log('currentState dirty:' + state);\r\n        this.flagOutputDirty('currentState');\r\n\r\n        //console.log('stateChanged signal', state);\r\n        this.sendSignalOnOutput('stateChanged');\r\n        this.updateAtStatePorts();\r\n\r\n        if (dur == 0 && delay == 0) {\r\n          // Send reached signal if no transition\r\n          var port = 'reached-' + internal.state;\r\n          if (this.hasOutput(port)) this.sendSignalOnOutput(port);\r\n        }\r\n      }\r\n    },\r\n    updateAtStatePorts: function () {\r\n      var internal = this._internal;\r\n      var states = internal.states;\r\n      for (var i in states) {\r\n        var s = states[i];\r\n        var port = 'at-' + s;\r\n\r\n        internal.currentValues[port] = internal.state === s;\r\n        if (this.hasOutput(port)) this.flagOutputDirty(port);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nfunction detectRename(before, after) {\r\n  if (!before || !after) return;\r\n\r\n  if (before.length !== after.length) return; // Must be of same length\r\n\r\n  var res = {};\r\n  for (var i = 0; i < before.length; i++) {\r\n    if (after.indexOf(before[i]) === -1) {\r\n      if (res.before) return; // Can only be one from before that is missing\r\n      res.before = before[i];\r\n    }\r\n\r\n    if (before.indexOf(after[i]) === -1) {\r\n      if (res.after) return; // Only one can be missing,otherwise we cannot match\r\n      res.after = after[i];\r\n    }\r\n  }\r\n\r\n  return res.before && res.after ? res : undefined;\r\n}\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection) {\r\n  var states = parameters.states;\r\n  var values = parameters.values;\r\n\r\n  var ports = [];\r\n\r\n  // Add value outputs\r\n  values = values ? values.split(',') : undefined;\r\n  for (var i in values) {\r\n    var p = values[i];\r\n\r\n    ports.push({\r\n      type: {\r\n        name: parameters['type-' + p] || 'number',\r\n        allowConnectionsOnly: true\r\n      },\r\n      plug: 'output',\r\n      group: 'Values',\r\n      name: p\r\n    });\r\n\r\n    // Type selector\r\n    ports.push({\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Number', value: 'number' },\r\n          { label: 'String', value: 'string' },\r\n          { label: 'Boolean', value: 'boolean' },\r\n          { label: 'Color', value: 'color' },\r\n          { label: 'Text Style', value: 'textStyle' }\r\n        ],\r\n        allowEditOnly: true\r\n      },\r\n      default: 'number',\r\n      plug: 'input',\r\n      group: 'Types',\r\n      displayName: p,\r\n      name: 'type-' + p\r\n    });\r\n  }\r\n\r\n  // Add state value inputs\r\n  states = states ? states.split(',') : undefined;\r\n  states &&\r\n    states.forEach(function (state) {\r\n      values &&\r\n        values.forEach(function (value) {\r\n          ports.push({\r\n            plug: 'input',\r\n            type: parameters['type-' + value] || 'number',\r\n            group: state + ' Values',\r\n            name: 'value-' + state + '-' + value,\r\n            displayName: value,\r\n            editorName: state + '|' + value\r\n          });\r\n        });\r\n\r\n      // State transition\r\n      if (values && parameters['useTransitions'] !== false) {\r\n        ports.push({\r\n          plug: 'input',\r\n          type: 'curve',\r\n          displayName: 'Default',\r\n          default: { curve: [0.0, 0.0, 0.58, 1.0], dur: 300, delay: 0 },\r\n          group: state + ' Transitions',\r\n          name: 'transitiondef-' + state\r\n        });\r\n\r\n        values.forEach(function (value) {\r\n          if (\r\n            parameters['type-' + value] === undefined ||\r\n            parameters['type-' + value] === 'number' ||\r\n            parameters['type-' + value] === 'color'\r\n          ) {\r\n            ports.push({\r\n              plug: 'input',\r\n              type: { name: 'curve' },\r\n              default: parameters['transitiondef-' + state] || {\r\n                curve: [0.0, 0.0, 0.58, 1.0],\r\n                dur: 300,\r\n                delay: 0\r\n              },\r\n              group: state + ' Transitions',\r\n              name: 'transition-' + state + '-' + value,\r\n              displayName: value,\r\n              editorName: 'Transition ' + state + '|' + value\r\n            });\r\n          }\r\n        });\r\n      }\r\n\r\n      /*  ports.push({\r\n            plug: 'input',\r\n            type: {\r\n                name: 'enum',\r\n                enums: [\r\n                    { value: 'easeOut', label: \"Ease Out\" },\r\n                    { value: 'easeIn', label: \"Ease In\" },\r\n                    { value: 'linear', label: \"Linear\" },\r\n                    { value: 'easeInOut', label: \"Ease In Out\" },\r\n                    { value: 'cubicBezier', label: 'Cubic Bezier' }\r\n                ]\r\n            },\r\n            default: 'easeOut',\r\n            displayName: \"Easing Curve\",\r\n            group: state + ' Transition',\r\n            name: 'transition-' + state,\r\n        });\r\n\r\n        //add cubic bezier inputs if transition is set to cubic\r\n        if (parameters['transition-' + state] === 'cubicBezier') {\r\n            ports = ports.concat([\r\n                {\r\n                    name: 'cubicBezierP1X-' + state,\r\n                    editorName: state + '|' + 'P1 X',\r\n                    displayName: 'P1 X',\r\n                    group: state + ' Transition',\r\n                    plug: 'input',\r\n                    type: 'number',\r\n                    default: 0\r\n                },\r\n                {\r\n                    name: 'cubicBezierP1Y-' + state,\r\n                    editorName: state + '|' + 'P1 Y',\r\n                    displayName: 'P1 Y',\r\n                    group: state + ' Transition',\r\n                    plug: 'input',\r\n                    type: 'number',\r\n                    default: 0\r\n                },\r\n                {\r\n                    name: 'cubicBezierP2X-' + state,\r\n                    editorName: state + '|' + 'P2 X',\r\n                    displayName: 'P2 X',\r\n                    group: state + ' Transition',\r\n                    plug: 'input',\r\n                    type: 'number',\r\n                    default: 0\r\n                },\r\n                {\r\n                    name: 'cubicBezierP2Y-' + state,\r\n                    editorName: state + '|' + 'P2 Y',\r\n                    displayName: 'P2 Y',\r\n                    group: state + ' Transition',\r\n                    plug: 'input',\r\n                    type: 'number',\r\n                    default: 0\r\n                }\r\n            ]);\r\n        }\r\n\r\n        ports.push({\r\n            plug: 'input',\r\n            type: 'number',\r\n            default: defaultDuration,\r\n            displayName: \"Duration\",\r\n            group: state + ' Transition',\r\n            name: 'duration-' + state,\r\n        });*/\r\n\r\n      // Go to state port\r\n      ports.push({\r\n        plug: 'input',\r\n        type: { name: 'signal', allowConnectionsOnly: true },\r\n        displayName: 'To ' + state,\r\n        name: 'to-' + state,\r\n        group: 'Go to state'\r\n      });\r\n\r\n      // At state output\r\n      ports.push({\r\n        plug: 'output',\r\n        type: 'boolean',\r\n        displayName: 'At ' + state,\r\n        name: 'at-' + state,\r\n        group: 'Current state'\r\n      });\r\n\r\n      // Has reached state output\r\n      ports.push({\r\n        plug: 'output',\r\n        type: 'signal',\r\n        displayName: 'Has Reached ' + state,\r\n        name: 'reached-' + state,\r\n        group: 'Current state'\r\n      });\r\n    });\r\n\r\n  // Add current state port\r\n  if (states) {\r\n    ports.push({\r\n      plug: 'input',\r\n      type: { name: 'enum', enums: states },\r\n      group: 'States',\r\n      displayName: 'State',\r\n      name: 'currentState',\r\n      default: parameters['startState'] || states[0] // This is kept for backwards compatability, the startState port does no longer exist\r\n    });\r\n  }\r\n\r\n  // Detect state and value rename\r\n  var stateRenamed = detectRename(previousStates[nodeId], states);\r\n  previousStates[nodeId] = states;\r\n\r\n  var valueRenamed = detectRename(previousValues[nodeId], values);\r\n  previousValues[nodeId] = values;\r\n\r\n  let renamed;\r\n  if (stateRenamed) {\r\n    renamed = {\r\n      plug: 'input',\r\n      before: stateRenamed.before,\r\n      after: stateRenamed.after,\r\n      patterns: [\r\n        'transition-{{*}}',\r\n        /*       'duration-{{*}}',\r\n                'cubicBezierP1X-{{*}}',\r\n                'cubicBezierP2X-{{*}}',\r\n                'cubicBezierP1Y-{{*}}',\r\n                'cubicBezierP2Y-{{*}}',*/\r\n        'to-{{*}}',\r\n        'at-{{*}}',\r\n        'reached-{{*}}'\r\n      ]\r\n    };\r\n\r\n    // A state has been renamed\r\n    values &&\r\n      values.forEach(function (value) {\r\n        renamed.patterns.push('value-{{*}}-' + value);\r\n      });\r\n  } else if (valueRenamed) {\r\n    renamed = [\r\n      {\r\n        plug: 'output',\r\n        before: valueRenamed.before,\r\n        after: valueRenamed.after,\r\n        patterns: ['{{*}}']\r\n      },\r\n      {\r\n        plug: 'input',\r\n        before: valueRenamed.before,\r\n        after: valueRenamed.after,\r\n        patterns: ['type-{{*}}']\r\n      },\r\n      {\r\n        plug: 'input',\r\n        before: valueRenamed.before,\r\n        after: valueRenamed.after,\r\n        patterns: states\r\n          ? states.map(function (s) {\r\n              return 'value-' + s + '-' + '{{*}}';\r\n            })\r\n          : undefined\r\n      }\r\n    ];\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, { renamed: renamed });\r\n}\r\n\r\nmodule.exports = {\r\n  node: StatesNode,\r\n  setup: function (context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on('nodeAdded.States', function (node) {\r\n      if (node.parameters.states) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection);\r\n      }\r\n      node.on('parameterUpdated', function (event) {\r\n        if (\r\n          event.name === 'useTransitions' ||\r\n          event.name === 'states' ||\r\n          event.name === 'values' ||\r\n          event.name.startsWith('transition') ||\r\n          event.name.startsWith('type-')\r\n        ) {\r\n          updatePorts(node.id, node.parameters, context.editorConnection);\r\n        }\r\n      });\r\n    });\r\n  }\r\n};\r\n","'use strict';\r\n\r\nconst Switch = {\r\n  name: 'Switch',\r\n  docs: 'https://docs.noodl.net/nodes/logic/switch',\r\n  category: 'Logic',\r\n  initialize() {\r\n    this._internal.state = false;\r\n    this._internal.initialized = false;\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.state;\r\n  },\r\n  inputs: {\r\n    on: {\r\n      displayName: 'On',\r\n      group: 'Change State',\r\n      valueChangedToTrue() {\r\n        if (this._internal.state === true) {\r\n          return;\r\n        }\r\n        this._internal.state = true;\r\n        this.flagOutputDirty('state');\r\n        this.emitSignals();\r\n      }\r\n    },\r\n    off: {\r\n      displayName: 'Off',\r\n      group: 'Change State',\r\n      valueChangedToTrue() {\r\n        if (this._internal.state === false) {\r\n          return;\r\n        }\r\n        this._internal.state = false;\r\n        this.flagOutputDirty('state');\r\n        this.emitSignals();\r\n      }\r\n    },\r\n    flip: {\r\n      displayName: 'Flip',\r\n      group: 'Change State',\r\n      valueChangedToTrue() {\r\n        this._internal.state = !this._internal.state;\r\n        this.flagOutputDirty('state');\r\n        this.emitSignals();\r\n      }\r\n    },\r\n    onFromStart: {\r\n      type: 'boolean',\r\n      displayName: 'State',\r\n      group: 'General',\r\n      default: false,\r\n      set(value) {\r\n        this._internal.state = !!value;\r\n        this.flagOutputDirty('state');\r\n        this.emitSignals();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    state: {\r\n      type: 'boolean',\r\n      displayName: 'Current State',\r\n      getter() {\r\n        return this._internal.state;\r\n      }\r\n    },\r\n    switched: {\r\n      displayName: 'Switched',\r\n      type: 'signal',\r\n      group: 'Signals'\r\n    },\r\n    switchedToOn: {\r\n      displayName: 'Switched To On',\r\n      type: 'signal',\r\n      group: 'Signals'\r\n    },\r\n    switchedToOff: {\r\n      displayName: 'Switched To Off',\r\n      type: 'signal',\r\n      group: 'Signals'\r\n    }\r\n  },\r\n  prototypeExtensions: {\r\n    emitSignals() {\r\n      if (this._internal.state === true) {\r\n        this.sendSignalOnOutput('switchedToOn');\r\n      } else {\r\n        this.sendSignalOnOutput('switchedToOff');\r\n      }\r\n      this.sendSignalOnOutput('switched');\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: Switch\r\n};\r\n","'use strict';\r\n\r\nconst Timer = {\r\n  name: 'Timer',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/delay',\r\n  displayName: 'Delay',\r\n  category: 'Utilities',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'duration'\r\n  },\r\n  initialize: function () {\r\n    var self = this;\r\n    this._internal._animation = this.context.timerScheduler.createTimer({\r\n      duration: 0,\r\n      onStart: function () {\r\n        self.sendSignalOnOutput('timerStarted');\r\n      },\r\n      onFinish: function () {\r\n        self.sendSignalOnOutput('timerFinished');\r\n      }\r\n    });\r\n\r\n    this.addDeleteListener(() => {\r\n      this._internal._animation.stop();\r\n    });\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal._animation.isRunning()) {\r\n      return Math.floor(this._internal._animation.durationLeft() / 10) / 100 + ' seconds';\r\n    }\r\n    return 'Not running';\r\n  },\r\n  inputs: {\r\n    start: {\r\n      displayName: 'Start',\r\n      valueChangedToTrue: function () {\r\n        if (this._internal._animation._isRunning === false) {\r\n          this._internal._animation.start();\r\n        }\r\n      }\r\n    },\r\n    restart: {\r\n      displayName: 'Restart',\r\n      valueChangedToTrue: function () {\r\n        this._internal._animation.start();\r\n      }\r\n    },\r\n    duration: {\r\n      type: 'number',\r\n      displayName: 'Duration',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal._animation.duration = value;\r\n      }\r\n    },\r\n    startDelay: {\r\n      type: 'number',\r\n      displayName: 'Start Delay',\r\n      default: 0,\r\n      set: function (value) {\r\n        this._internal._animation.delay = value;\r\n      }\r\n    },\r\n    stop: {\r\n      displayName: 'Stop',\r\n      valueChangedToTrue: function () {\r\n        this._internal._animation.stop();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    timerStarted: {\r\n      type: 'signal',\r\n      displayName: 'Started'\r\n    },\r\n    timerFinished: {\r\n      type: 'signal',\r\n      displayName: 'Finished'\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: Timer\r\n};\r\n","'use strict';\r\n\r\nconst CloudFile = require('@noodl/runtime/src/api/cloudfile');\r\nconst CloudStore = require('@noodl/runtime/src/api/cloudstore');\r\n\r\nconst UploadFile = {\r\n  name: 'Upload File',\r\n  docs: 'https://docs.noodl.net/nodes/data/cloud-data/upload-file',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  getInspectInfo() {\r\n    return this._internal.response;\r\n  },\r\n  inputs: {\r\n    file: {\r\n      group: 'General',\r\n      displayName: 'File',\r\n      type: '*',\r\n      set(file) {\r\n        this._internal.file = file;\r\n      }\r\n    },\r\n    upload: {\r\n      type: 'signal',\r\n      displayName: 'Upload',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const file = this._internal.file;\r\n\r\n          if (!file) {\r\n            this.setError('No file specified');\r\n            return;\r\n          }\r\n\r\n          CloudStore.instance.uploadFile({\r\n            file,\r\n            onUploadProgress: (p) => {\r\n              this._internal.progressTotal = p.total;\r\n              this._internal.progressLoaded = p.loaded;\r\n\r\n              this.flagOutputDirty('progressTotalBytes');\r\n              this.flagOutputDirty('progressLoadedBytes');\r\n              this.flagOutputDirty('progressLoadedPercent');\r\n              this.sendSignalOnOutput('progressChanged');\r\n            },\r\n            success: (response) => {\r\n              this._internal.cloudFile = new CloudFile(response);\r\n              this.flagOutputDirty('cloudFile');\r\n              this.sendSignalOnOutput('success');\r\n            },\r\n            error: (e) => this.setError(e)\r\n          });\r\n        });\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    cloudFile: {\r\n      group: 'General',\r\n      displayName: 'Cloud File',\r\n      type: 'cloudfile',\r\n      get() {\r\n        return this._internal.cloudFile;\r\n      }\r\n    },\r\n    success: {\r\n      group: 'Events',\r\n      displayName: 'Success',\r\n      type: 'signal'\r\n    },\r\n    failure: {\r\n      group: 'Events',\r\n      displayName: 'Failure',\r\n      type: 'signal'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      get() {\r\n        return this._internal.error;\r\n      }\r\n    },\r\n    errorStatus: {\r\n      type: 'number',\r\n      displayName: 'Error Status Code',\r\n      group: 'Error',\r\n      get() {\r\n        return this._internal.errorStatus;\r\n      }\r\n    },\r\n    progressChanged: {\r\n      type: 'signal',\r\n      displayName: 'Progress Changed',\r\n      group: 'Events'\r\n    },\r\n    progressTotalBytes: {\r\n      type: 'number',\r\n      displayName: 'Total Bytes',\r\n      group: 'Progress',\r\n      get() {\r\n        return this._internal.progressTotal;\r\n      }\r\n    },\r\n    progressLoadedBytes: {\r\n      type: 'number',\r\n      displayName: 'Uploaded Bytes',\r\n      group: 'Progress',\r\n      get() {\r\n        return this._internal.progressLoaded;\r\n      }\r\n    },\r\n    progressLoadedPercent: {\r\n      type: 'number',\r\n      displayName: 'Uploaded Percent',\r\n      group: 'Progress',\r\n      get() {\r\n        if (!this._internal.progressTotal) return 0;\r\n        return (this._internal.progressLoaded / this._internal.progressTotal) * 100;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setError(err) {\r\n      this._internal.error = err.hasOwnProperty('error') ? err.error : err;\r\n      //use the error code. If there is none, use the http status\r\n      this._internal.errorStatus = err.code || err.status || 0;\r\n      this.flagOutputDirty('error');\r\n      this.flagOutputDirty('errorStatus');\r\n      this.sendSignalOnOutput('failure');\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: UploadFile\r\n};\r\n","'use strict';\r\n\r\nconst UserService = require('./userservice');\r\n\r\nconst LoginNodeDefinition = {\r\n  name: 'net.noodl.user.LogIn',\r\n  docs: 'https://docs.noodl.net/nodes/data/user/log-in',\r\n  displayNodeName: 'Log In',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter() {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    login: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleLogIn();\r\n      }\r\n    },\r\n    username: {\r\n      displayName: 'Username',\r\n      type: 'string',\r\n      group: 'General',\r\n      set(value) {\r\n        this._internal.username = value;\r\n      }\r\n    },\r\n    password: {\r\n      displayName: 'Password',\r\n      type: 'string',\r\n      group: 'General',\r\n      set(value) {\r\n        this._internal.password = value;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setError(err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'user-login-warning', {\r\n          message: err,\r\n          showGlobally: true\r\n        });\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'user-login-warning');\r\n      }\r\n    },\r\n    scheduleLogIn() {\r\n      if (this.logInScheduled === true) return;\r\n      this.logInScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.logInScheduled = false;\r\n\r\n        UserService.instance.logIn({\r\n          username: this._internal.username,\r\n          password: this._internal.password,\r\n          success: () => {\r\n            this.sendSignalOnOutput('success');\r\n          },\r\n          error: (e) => {\r\n            this.setError(e);\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: LoginNodeDefinition,\r\n  setup(_context, _graphModel) {}\r\n};\r\n","'use strict';\r\n\r\nconst UserService = require('./userservice');\r\n\r\nconst LogOutNodeDefinition = {\r\n  name: 'net.noodl.user.LogOut',\r\n  docs: 'https://docs.noodl.net/nodes/data/user/log-out',\r\n  displayNodeName: 'Log Out',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter() {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    login: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleLogOut();\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setError(err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'user-login-warning', {\r\n          message: err,\r\n          showGlobally: true\r\n        });\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'user-login-warning');\r\n      }\r\n    },\r\n    scheduleLogOut() {\r\n      if (this.logOutScheduled === true) return;\r\n      this.logOutScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.logOutScheduled = false;\r\n\r\n        UserService.instance.logOut({\r\n          success: () => {\r\n            this.sendSignalOnOutput('success');\r\n          },\r\n          error: (e) => {\r\n            this.setError(e);\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: LogOutNodeDefinition,\r\n  setup(_context, _graphModel) {}\r\n};\r\n","'use strict';\r\n\r\nconst { Node, EdgeTriggeredInput } = require('@noodl/runtime');\r\nconst UserService = require('./userservice');\r\n\r\nvar RequestPasswordResetNodeDefinition = {\r\n  name: 'net.noodl.user.RequestPasswordReset',\r\n  docs: 'https://docs.noodl.net/nodes/data/user/request-password-reset',\r\n  displayNodeName: 'Request Password Reset',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  deprecated: true, // Use cloud functions\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n  },\r\n  getInspectInfo() {},\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    send: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleRequestPasswordReset();\r\n      }\r\n    },\r\n    email: {\r\n      type: 'string',\r\n      displayName: 'Email',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.email = value;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setError: function (err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          'user-send-email-verification-warning',\r\n          {\r\n            message: err,\r\n            showGlobally: true\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          'user-send-email-verification-warning'\r\n        );\r\n      }\r\n    },\r\n    scheduleRequestPasswordReset: function () {\r\n      const internal = this._internal;\r\n\r\n      if (this.sendScheduled === true) return;\r\n      this.sendScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.sendScheduled = false;\r\n\r\n        UserService.instance.requestPasswordReset({\r\n          email: this._internal.email,\r\n          success: () => {\r\n            this.sendSignalOnOutput('success');\r\n          },\r\n          error: (e) => {\r\n            this.setError(e);\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: RequestPasswordResetNodeDefinition,\r\n  setup: function (context, graphModel) {}\r\n};\r\n","'use strict';\r\n\r\nconst { Node, EdgeTriggeredInput } = require('@noodl/runtime');\r\nconst UserService = require('./userservice');\r\n\r\nvar ResetPasswordNodeDefinition = {\r\n  name: 'net.noodl.user.ResetPassword',\r\n  docs: 'https://docs.noodl.net/nodes/data/user/reset-password',\r\n  displayNodeName: 'Reset Password',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  deprecated: true, // Use cloud functions\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n  },\r\n  getInspectInfo() {},\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    reset: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleResetPassword();\r\n      }\r\n    },\r\n    token: {\r\n      type: 'string',\r\n      displayName: 'Token',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.token = value;\r\n      }\r\n    },\r\n    username: {\r\n      type: 'string',\r\n      displayName: 'Username',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.username = value;\r\n      }\r\n    },\r\n    newPassword: {\r\n      type: 'string',\r\n      displayName: 'New Password',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.newPassword = value;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setError: function (err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          'user-verify-email-warning',\r\n          {\r\n            message: err,\r\n            showGlobally: true\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          'user-verify-email-warning'\r\n        );\r\n      }\r\n    },\r\n    scheduleResetPassword: function () {\r\n      const internal = this._internal;\r\n\r\n      if (this.resetPasswordScheduled === true) return;\r\n      this.resetPasswordScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.resetPasswordScheduled = false;\r\n\r\n        UserService.instance.resetPassword({\r\n          token: this._internal.token,\r\n          username: this._internal.username,\r\n          newPassword: this._internal.newPassword,\r\n          success: () => {\r\n            this.sendSignalOnOutput('success');\r\n          },\r\n          error: (e) => {\r\n            this.setError(e);\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: ResetPasswordNodeDefinition,\r\n  setup: function (context, graphModel) {}\r\n};\r\n","'use strict';\r\n\r\nconst { Node, EdgeTriggeredInput } = require('@noodl/runtime');\r\nconst UserService = require('./userservice');\r\n\r\nvar SendEmailVerificationNodeDefinition = {\r\n  name: 'net.noodl.user.SendEmailVerification',\r\n  docs: 'https://docs.noodl.net/nodes/data/user/send-email-verification',\r\n  displayNodeName: 'Send Email Verification',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  deprecated: true, // Use cloud functions\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n  },\r\n  getInspectInfo() {},\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    send: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleSendEmailVerification();\r\n      }\r\n    },\r\n    email: {\r\n      type: 'string',\r\n      displayName: 'Email',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.email = value;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setError: function (err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          'user-send-email-verification-warning',\r\n          {\r\n            message: err,\r\n            showGlobally: true\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          'user-send-email-verification-warning'\r\n        );\r\n      }\r\n    },\r\n    scheduleSendEmailVerification: function () {\r\n      const internal = this._internal;\r\n\r\n      if (this.sendScheduled === true) return;\r\n      this.sendScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.sendScheduled = false;\r\n\r\n        UserService.instance.sendEmailVerification({\r\n          email: this._internal.email,\r\n          success: () => {\r\n            this.sendSignalOnOutput('success');\r\n          },\r\n          error: (e) => {\r\n            this.setError(e);\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: SendEmailVerificationNodeDefinition,\r\n  setup: function (context, graphModel) {}\r\n};\r\n","'use strict';\r\n\r\nconst UserService = require('./userservice');\r\n\r\nconst SignUpNodeDefinition = {\r\n  name: 'net.noodl.user.SignUp',\r\n  docs: 'https://docs.noodl.net/nodes/data/user/sign-up',\r\n  displayNodeName: 'Sign Up',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  initialize() {\r\n    const internal = this._internal;\r\n    internal.userProperties = {};\r\n  },\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter() {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    signup: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        this.scheduleSignUp();\r\n      }\r\n    },\r\n    username: {\r\n      displayName: 'Username',\r\n      type: 'string',\r\n      group: 'General',\r\n      set(value) {\r\n        this._internal.username = value;\r\n      }\r\n    },\r\n    password: {\r\n      displayName: 'Password',\r\n      type: 'string',\r\n      group: 'General',\r\n      set(value) {\r\n        this._internal.password = value;\r\n      }\r\n    },\r\n    email: {\r\n      displayName: 'Email',\r\n      type: 'string',\r\n      group: 'General',\r\n      set(value) {\r\n        this._internal.email = value;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setError(err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'user-login-warning', {\r\n          message: err,\r\n          showGlobally: true\r\n        });\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'user-login-warning');\r\n      }\r\n    },\r\n    scheduleSignUp() {\r\n      const internal = this._internal;\r\n\r\n      if (this.signUpScheduled === true) return;\r\n      this.signUpScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.signUpScheduled = false;\r\n\r\n        UserService.instance.signUp({\r\n          username: this._internal.username,\r\n          password: this._internal.password,\r\n          email: this._internal.email,\r\n          properties: internal.userProperties,\r\n          success: () => {\r\n            this.sendSignalOnOutput('success');\r\n          },\r\n          error: (e) => {\r\n            this.setError(e);\r\n          }\r\n        });\r\n      });\r\n    },\r\n    setUserProperty(name, value) {\r\n      this._internal.userProperties[name] = value;\r\n    },\r\n    registerInputIfNeeded(name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('prop-')) {\r\n        return this.registerInput(name, {\r\n          set: this.setUserProperty.bind(this, name.substring('prop-'.length))\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nfunction updatePorts(nodeId, _parameters, editorConnection, systemCollections) {\r\n  var ports = [];\r\n\r\n  if (systemCollections) {\r\n    // Fetch ports from collection keys\r\n    var c = systemCollections.find((c) => c.name === '_User');\r\n    if (c && c.schema && c.schema.properties) {\r\n      var props = c.schema.properties;\r\n      const _ignoreKeys = ['authData', 'password', 'username', 'createdAt', 'updatedAt', 'emailVerified', 'email'];\r\n      for (var key in props) {\r\n        if (_ignoreKeys.indexOf(key) !== -1) continue;\r\n\r\n        var p = props[key];\r\n        if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n        if (p.type === 'Relation') {\r\n        } else {\r\n          // Other schema type ports\r\n          const _typeMap = {\r\n            String: 'string',\r\n            Boolean: 'boolean',\r\n            Number: 'number',\r\n            Date: 'date'\r\n          };\r\n\r\n          ports.push({\r\n            type: {\r\n              name: _typeMap[p.type] ? _typeMap[p.type] : '*'\r\n            },\r\n            plug: 'input',\r\n            group: 'Properties',\r\n            name: 'prop-' + key,\r\n            displayName: key\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nmodule.exports = {\r\n  node: SignUpNodeDefinition,\r\n  setup(context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('systemCollections'));\r\n\r\n      node.on('parameterUpdated', function (_event) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection, graphModel.getMetaData('systemCollections'));\r\n      });\r\n\r\n      graphModel.on('metadataChanged.systemCollections', function (data) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.net.noodl.user.SignUp', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('net.noodl.user.SignUp')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n","const NoodlRuntime = require('@noodl/runtime');\r\nconst EventEmitter = require('events').EventEmitter;\r\nconst guid = require('../../../guid');\r\nconst CloudStore = require('@noodl/runtime/src/api/cloudstore');\r\n\r\nclass UserService {\r\n  constructor() {\r\n    this._initCloudServices();\r\n\r\n    this.events = new EventEmitter();\r\n    this.events.setMaxListeners(100000);\r\n\r\n    // Check for current user session, and validate if it exists\r\n    const currentUser = this.getUserFromLocalStorage();\r\n\r\n    if (currentUser) {\r\n      this.current = this.getUserModel();\r\n      this.fetchCurrentUser({\r\n        success: () => {},\r\n        error: () => {\r\n          // The session is nolonger valid\r\n          delete localStorage['Parse/' + this.appId + '/currentUser'];\r\n          delete this.current;\r\n          this.events.emit('sessionLost');\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  getUserFromLocalStorage() {\r\n    const currentUser = localStorage['Parse/' + this.appId + '/currentUser'];\r\n    if (currentUser) {\r\n      try {\r\n        return JSON.parse(currentUser);\r\n      } catch (e) {\r\n        //do nothing\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  _initCloudServices() {\r\n    const cloudServices = NoodlRuntime.instance.getMetaData('cloudservices');\r\n\r\n    if (cloudServices) {\r\n      this.appId = cloudServices.appId;\r\n      this.endpoint = cloudServices.endpoint;\r\n    }\r\n  }\r\n\r\n  on() {\r\n    this.events.on.apply(this.events, arguments);\r\n  }\r\n\r\n  off() {\r\n    this.events.off.apply(this.events, arguments);\r\n  }\r\n\r\n  _makeRequest(path, options) {\r\n    if (!this.endpoint) {\r\n      if (options.error) {\r\n        options.error({ error: 'No active cloud service', status: 0 });\r\n      }\r\n      return;\r\n    }\r\n\r\n    var xhr = new XMLHttpRequest();\r\n\r\n    xhr.onreadystatechange = function () {\r\n      if (xhr.readyState === 4) {\r\n        var json;\r\n        try {\r\n          json = JSON.parse(xhr.response);\r\n        } catch (e) {}\r\n\r\n        if (xhr.status === 200 || xhr.status === 201) {\r\n          options.success(json || xhr.response);\r\n        } else options.error(json || { error: xhr.responseText, status: xhr.status });\r\n      }\r\n    };\r\n\r\n    xhr.open(options.method || 'GET', this.endpoint + path, true);\r\n\r\n    xhr.setRequestHeader('X-Parse-Application-Id', this.appId);\r\n\r\n    // Installation Id\r\n    var _iid = localStorage['Parse/' + this.appId + '/installationId'];\r\n    if (_iid === undefined) {\r\n      _iid = localStorage['Parse/' + this.appId + '/installationId'] = guid();\r\n    }\r\n    xhr.setRequestHeader('X-Parse-Installation-Id', _iid);\r\n\r\n    // Check for current users\r\n    if (options.sessionToken) xhr.setRequestHeader('X-Parse-Session-Token', options.sessionToken);\r\n    else {\r\n      var currentUser = this.getUserFromLocalStorage();\r\n      if (currentUser !== undefined) {\r\n        xhr.setRequestHeader('X-Parse-Session-Token', currentUser.sessionToken);\r\n      }\r\n    }\r\n\r\n    xhr.setRequestHeader('Content-Type', 'application/json');\r\n    xhr.send(JSON.stringify(options.content));\r\n  }\r\n\r\n  logIn(options) {\r\n    this._makeRequest('/login', {\r\n      method: 'POST',\r\n      content: {\r\n        username: options.username,\r\n        password: options.password,\r\n        _method: 'GET'\r\n      },\r\n      success: (response) => {\r\n        // Store current user\r\n        localStorage['Parse/' + this.appId + '/currentUser'] = JSON.stringify(response);\r\n        this.current = this.getUserModel(); // Make sure the user model is updated\r\n        options.success(response);\r\n        this.events.emit('loggedIn');\r\n      },\r\n      error: (e) => {\r\n        options.error(e.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  logOut(options) {\r\n    this._makeRequest('/logout', {\r\n      method: 'POST',\r\n      content: {},\r\n      success: (response) => {\r\n        // Store current user\r\n        delete localStorage['Parse/' + this.appId + '/currentUser'];\r\n        delete this.current;\r\n        options.success();\r\n        this.events.emit('loggedOut');\r\n      },\r\n      error: (e) => {\r\n        options.error(e.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  signUp(options) {\r\n    //make a shallow copy to feed through CloudStore._serializeObject, which will modify the object\r\n    const additionalUserProps = options.properties\r\n      ? CloudStore._serializeObject({ ...options.properties }, '_User')\r\n      : {};\r\n\r\n    this._makeRequest('/users', {\r\n      method: 'POST',\r\n      content: Object.assign({}, additionalUserProps, {\r\n        username: options.username,\r\n        password: options.password,\r\n        email: options.email\r\n      }),\r\n      success: (response) => {\r\n        // Store current user\r\n        const _cu = Object.assign(response, { username: options.username }, options.properties);\r\n        localStorage['Parse/' + this.appId + '/currentUser'] = JSON.stringify(_cu);\r\n        this.current = this.getUserModel(); // Make sure the user model is updated\r\n        options.success(response);\r\n        this.events.emit('loggedIn');\r\n      },\r\n      error: (e) => {\r\n        options.error(e.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  setUserProperties(options) {\r\n    const _cu = this.getCurrentUser();\r\n    if (_cu !== undefined) {\r\n      //make a shallow copy to feed through CloudStore._serializeObject, which will modify the object\r\n      const propsToSave = CloudStore._serializeObject({ ...options.properties }, '_User');\r\n\r\n      const _content = Object.assign({}, { email: options.email, username: options.username }, propsToSave);\r\n\r\n      delete _content.emailVerified; // Remove props you cannot set\r\n      delete _content.createdAt;\r\n      delete _content.updatedAt;\r\n      //delete _content.username;\r\n\r\n      this._makeRequest('/users/' + _cu.objectId, {\r\n        method: 'PUT',\r\n        content: _content,\r\n        success: (response) => {\r\n          // Store current user\r\n          Object.assign(_cu, _content);\r\n          localStorage['Parse/' + this.appId + '/currentUser'] = JSON.stringify(_cu);\r\n          this.current = this.getUserModel(); // Make sure the user model is updated\r\n          options.success(response);\r\n        },\r\n        error: (e) => {\r\n          options.error(e.error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  fetchCurrentUser(options) {\r\n    this._makeRequest('/users/me', {\r\n      method: 'GET',\r\n      sessionToken: options.sessionToken,\r\n      success: (response) => {\r\n        // Store current user\r\n        localStorage['Parse/' + this.appId + '/currentUser'] = JSON.stringify(response);\r\n        this.current = this.getUserModel(); // Make sure the user model is updated\r\n        this.events.emit('sessionGained');\r\n        options.success(response);\r\n      },\r\n      error: (e) => {\r\n        if (e.code === 209) {\r\n          delete localStorage['Parse/' + this.appId + '/currentUser'];\r\n          this.events.emit('sessionLost');\r\n        }\r\n        options.error(e.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  verifyEmail(options) {\r\n    this._makeRequest(\r\n      '/apps/' + this.appId + '/verify_email?username=' + options.username + '&token=' + options.token,\r\n      {\r\n        method: 'GET',\r\n        success: (response) => {\r\n          if (response.indexOf('Successfully verified your email') !== -1) {\r\n            options.success();\r\n          } else if (response.indexOf('Invalid Verification Link')) {\r\n            options.error('Invalid verification token');\r\n          } else {\r\n            options.error('Failed to verify email');\r\n          }\r\n        },\r\n        error: (e) => {\r\n          options.error(e.error);\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  sendEmailVerification(options) {\r\n    this._makeRequest('/verificationEmailRequest', {\r\n      method: 'POST',\r\n      content: { email: options.email },\r\n      success: (response) => {\r\n        options.success();\r\n      },\r\n      error: (e) => {\r\n        options.error(e.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  resetPassword(options) {\r\n    this._makeRequest('/apps/' + this.appId + '/request_password_reset', {\r\n      method: 'POST',\r\n      content: {\r\n        username: options.username,\r\n        token: options.token,\r\n        new_password: options.newPassword\r\n      },\r\n      success: (response) => {\r\n        if (\r\n          response.indexOf('Password successfully reset') !== -1 ||\r\n          response.indexOf('Successfully updated your password') !== -1\r\n        ) {\r\n          options.success();\r\n        } else if (response.indexOf('Invalid Link')) {\r\n          options.error('Invalid verification token');\r\n        } else {\r\n          options.error('Failed to verify email');\r\n        }\r\n      },\r\n      error: (e) => {\r\n        options.error(e.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  requestPasswordReset(options) {\r\n    this._makeRequest('/requestPasswordReset', {\r\n      method: 'POST',\r\n      content: { email: options.email },\r\n      success: (response) => {\r\n        options.success();\r\n      },\r\n      error: (e) => {\r\n        options.error(e.error);\r\n      }\r\n    });\r\n  }\r\n\r\n  getCurrentUser() {\r\n    var _cu = localStorage['Parse/' + this.appId + '/currentUser'];\r\n    if (_cu !== undefined) return JSON.parse(_cu);\r\n  }\r\n\r\n  getUserModel() {\r\n    const _cu = this.getCurrentUser();\r\n    if (_cu !== undefined) {\r\n      delete _cu.sessionToken;\r\n      delete _cu.ACL;\r\n      delete _cu.className;\r\n      delete _cu.__type;\r\n      return CloudStore._fromJSON(_cu, '_User');\r\n    }\r\n  }\r\n}\r\n\r\nUserService.forScope = (modelScope) => {\r\n  // On the viewer, always return main scope\r\n  return UserService.instance;\r\n};\r\n\r\nvar _instance;\r\nObject.defineProperty(UserService, 'instance', {\r\n  get: function () {\r\n    if (_instance === undefined) _instance = new UserService();\r\n    return _instance;\r\n  }\r\n});\r\n\r\nNoodlRuntime.Services.UserService = UserService;\r\n\r\nmodule.exports = UserService;\r\n","'use strict';\r\n\r\nconst { Node, EdgeTriggeredInput } = require('@noodl/runtime');\r\nconst UserService = require('./userservice');\r\n\r\nvar VerifyEmailNodeDefinition = {\r\n  name: 'net.noodl.user.VerifyEmail',\r\n  docs: 'https://docs.noodl.net/nodes/data/user/verify-email',\r\n  displayNodeName: 'Verify Email',\r\n  category: 'Cloud Services',\r\n  color: 'data',\r\n  deprecated: true, // Use cloud functions\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n  },\r\n  getInspectInfo() {},\r\n  outputs: {\r\n    success: {\r\n      type: 'signal',\r\n      displayName: 'Success',\r\n      group: 'Events'\r\n    },\r\n    failure: {\r\n      type: 'signal',\r\n      displayName: 'Failure',\r\n      group: 'Events'\r\n    },\r\n    error: {\r\n      type: 'string',\r\n      displayName: 'Error',\r\n      group: 'Error',\r\n      getter: function () {\r\n        return this._internal.error;\r\n      }\r\n    }\r\n  },\r\n  inputs: {\r\n    verify: {\r\n      displayName: 'Do',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleVerifyEmail();\r\n      }\r\n    },\r\n    token: {\r\n      type: 'string',\r\n      displayName: 'Token',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.token = value;\r\n      }\r\n    },\r\n    username: {\r\n      type: 'string',\r\n      displayName: 'Username',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.username = value;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    setError: function (err) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty('error');\r\n      this.sendSignalOnOutput('failure');\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          'user-verify-email-warning',\r\n          {\r\n            message: err,\r\n            showGlobally: true\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          'user-verify-email-warning'\r\n        );\r\n      }\r\n    },\r\n    scheduleVerifyEmail: function () {\r\n      const internal = this._internal;\r\n\r\n      if (this.logOutScheduled === true) return;\r\n      this.logOutScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.logOutScheduled = false;\r\n\r\n        UserService.instance.verifyEmail({\r\n          token: this._internal.token,\r\n          username: this._internal.username,\r\n          success: () => {\r\n            this.sendSignalOnOutput('success');\r\n          },\r\n          error: (e) => {\r\n            this.setError(e);\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: VerifyEmailNodeDefinition,\r\n  setup: function (context, graphModel) {}\r\n};\r\n","'use strict';\r\n\r\nconst ValueChangedNode = {\r\n  name: 'Value Changed',\r\n  docs: 'https://docs.noodl.net/nodes/logic/value-changed',\r\n  category: 'Logic',\r\n  initialize: function () {\r\n    this._internal.lastValue = undefined;\r\n    this._internal.changeCount = 0;\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal.changeCount) {\r\n      return 'Triggered ' + this._internal.changeCount + (this._internal.changeCount === 1 ? ' time' : ' times');\r\n    }\r\n    return 'Not triggered';\r\n  },\r\n  inputs: {\r\n    value: {\r\n      type: '*',\r\n      displayName: 'Input',\r\n      set: function (value) {\r\n        if (this._internal.lastValue === value) {\r\n          return;\r\n        }\r\n\r\n        this._internal.changeCount++;\r\n        this.sendSignalOnOutput('valueChanged');\r\n        this._internal.lastValue = value;\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    valueChanged: {\r\n      type: 'signal',\r\n      displayName: 'Value Changed'\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: ValueChangedNode\r\n};\r\n","'use strict';\r\n\r\nconst VariableBase = require('@noodl/runtime/src/nodes/std-library/variables/variablebase');\r\n\r\nmodule.exports = {\r\n  node: VariableBase.createDefinition({\r\n    name: 'Color',\r\n    docs: 'https://docs.noodl.net/nodes/data/color',\r\n    startValue: '#f1f2f4',\r\n    nodeDoubleClickAction: {\r\n      focusPort: 'value'\r\n    },\r\n    type: {\r\n      name: 'color'\r\n    },\r\n    cast: function (value) {\r\n      return value;\r\n    }\r\n  })\r\n};\r\n","const _refCount = new Map(); //node id to ref count\r\n\r\nconst CSSDefinition = {\r\n  name: 'CSS Definition',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/css-definition',\r\n  category: 'CustomCode',\r\n  color: 'javascript',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'Style'\r\n  },\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.style = '';\r\n\r\n    const styleId = this.getStyleRefId();\r\n\r\n    this.addDeleteListener(() => {\r\n      _refCount.set(styleId, _refCount.get(styleId) - 1);\r\n      if (_refCount.get(styleId) === 0) {\r\n        this.removeStyleDeclaration();\r\n        _refCount.delete(styleId);\r\n      }\r\n    });\r\n\r\n    if (!_refCount.has(styleId)) {\r\n      _refCount.set(styleId, 0);\r\n    }\r\n\r\n    _refCount.set(styleId, _refCount.get(styleId) + 1);\r\n  },\r\n  inputs: {\r\n    style: {\r\n      index: 4005,\r\n      type: { name: 'string', allowEditOnly: true, codeeditor: 'css' },\r\n      displayName: 'Style',\r\n      group: 'Content',\r\n      default: '',\r\n\r\n      set: function (value) {\r\n        this.updateStyle(value);\r\n      }\r\n    }\r\n  },\r\n  outputs: {},\r\n  methods: {\r\n    getStyleRefId: function () {\r\n      return 'style_' + this.id;\r\n    },\r\n    removeStyleDeclaration: function () {\r\n      // Add SSR Support\r\n      if (typeof document === 'undefined') return;\r\n\r\n      var styleRefId = this.getStyleRefId();\r\n      var styleObj = document.getElementById(styleRefId);\r\n      if (styleObj !== null) {\r\n        styleObj.parentNode.removeChild(styleObj);\r\n      }\r\n    },\r\n    updateStyle: function (style) {\r\n      // Add SSR Support\r\n      if (typeof document === 'undefined') return;\r\n\r\n      var internal = this._internal;\r\n      var styleRefId = this.getStyleRefId();\r\n      internal.style = style;\r\n\r\n      if (style !== null) {\r\n        var styleObj = document.getElementById(styleRefId);\r\n        if (styleObj === null) {\r\n          styleObj = document.createElement('style');\r\n          styleObj.id = styleRefId;\r\n          styleObj.type = 'text/css';\r\n          document.head.appendChild(styleObj);\r\n        }\r\n\r\n        styleObj.innerHTML = '\\n' + style + '\\n';\r\n      } else {\r\n        this.removeStyleDeclaration();\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CSSDefinition\r\n};\r\n","module.exports = React;","module.exports = ReactDOM;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.nc = undefined;","export default class GraphWarnings {\r\n  constructor(graphModel, editorConnection) {\r\n    this.graphModel = graphModel;\r\n    this.editorConnection = editorConnection;\r\n\r\n    this.graphModel.getAllComponents().forEach((c) => this._bindComponentModel(c));\r\n    this.graphModel.on('componentAdded', (c) => this._bindComponentModel(c), this);\r\n    this.graphModel.on('componentRemoved', (c) => c.removeListenersWithRef(this), this);\r\n  }\r\n\r\n  _bindComponentModel(c) {\r\n    c.on('rootAdded', () => this._evaluateWarnings(c), this);\r\n    c.on(\r\n      'rootRemoved',\r\n      (root) => {\r\n        this.editorConnection.clearWarning(c.name, root, 'multiple-visual-roots-warning');\r\n        this._evaluateWarnings(c);\r\n      },\r\n      this\r\n    );\r\n    this._evaluateWarnings(c);\r\n  }\r\n\r\n  _evaluateWarnings(c) {\r\n    const roots = c.getRoots();\r\n\r\n    if (roots.lenth === 0) return;\r\n\r\n    this.editorConnection.clearWarning(c.name, roots[0], 'multiple-visual-roots-warning');\r\n    for (let i = 1; i < roots.length; i++) {\r\n      this.editorConnection.sendWarning(c.name, roots[i], 'multiple-visual-roots-warning', {\r\n        message: \"This node is detached from the main node tree<br>and won't be rendered\",\r\n        level: 'info'\r\n      });\r\n    }\r\n  }\r\n\r\n  dispose() {\r\n    this.graphModel.getAllComponents().forEach((c) => {\r\n      c.removeListenersWithRef(this);\r\n    });\r\n\r\n    this.graphModel.removeListenersWithRef(this);\r\n  }\r\n}\r\n","import ReactDOM from 'react-dom';\r\n\r\nexport class Highlighter {\r\n  constructor(noodlRuntime) {\r\n    this.highlightedNodes = new Map();\r\n    this.selectedNodes = new Map();\r\n    this.noodlRuntime = noodlRuntime;\r\n\r\n    this.isUpdatingHighlights = false;\r\n\r\n    //create the div that holds the highlight and selection UI\r\n    const div = document.createElement('div');\r\n    div.style.width = '100%';\r\n    div.style.height = '100%';\r\n    div.style.top = '0';\r\n    div.style.left = '0';\r\n    div.style.overflow = 'hidden';\r\n    div.style.position = 'fixed';\r\n    div.style.zIndex = '1000000000';\r\n    div.style.pointerEvents = 'none';\r\n    document.body.appendChild(div);\r\n    this.highlightRootDiv = div;\r\n\r\n    this.windowBorderDiv = this.createHighlightDiv();\r\n    this.windowBorderDiv.style.position = 'absolute';\r\n    this.windowBorderDiv.style.top = '0';\r\n    this.windowBorderDiv.style.left = '0';\r\n    this.windowBorderDiv.style.boxShadow = 'inset 0 0 0 3px #2CA7BA';\r\n    this.windowBorderDiv.style.opacity = '1.0';\r\n    this.windowBorderDiv.style.width = '100vw';\r\n    this.windowBorderDiv.style.height = '100vh';\r\n  }\r\n\r\n  createHighlightDiv() {\r\n    const div = document.createElement('div');\r\n    div.style.position = 'absolute';\r\n    div.style.top = '0';\r\n    div.style.left = '0';\r\n    div.style.outline = '2px solid #2CA7BA';\r\n    div.style.opacity = '1.0';\r\n    return div;\r\n  }\r\n\r\n  setWindowSelected(enabled) {\r\n    return; //disable this feature for now, needs some iteration\r\n\r\n    /*if (enabled) {\r\n      this.highlightRootDiv.appendChild(this.windowBorderDiv);\r\n    } else {\r\n      this.windowBorderDiv.parentNode && this.windowBorderDiv.parentNode.removeChild(this.windowBorderDiv);\r\n    }*/\r\n  }\r\n\r\n  updateHighlights() {\r\n    const items = Array.from(this.highlightedNodes.entries()).concat(Array.from(this.selectedNodes.entries()));\r\n\r\n    for (const item of items) {\r\n      const domNode = item[0].getRef() && ReactDOM.findDOMNode(item[0].getRef());\r\n\r\n      if (!domNode) {\r\n        //user has deleted this node, just remove it\r\n        this.highlightedNodes.delete(item[0]);\r\n        item[1].remove();\r\n        continue;\r\n      }\r\n\r\n      const rect = domNode.getBoundingClientRect();\r\n      const highlight = item[1];\r\n\r\n      highlight.style.transform = `translateX(${rect.x}px) translateY(${rect.y}px)`;\r\n      highlight.style.width = rect.width + 'px';\r\n      highlight.style.height = rect.height + 'px';\r\n    }\r\n\r\n    this.isUpdatingHighlights = this.highlightedNodes.size > 0 || this.selectedNodes.size > 0;\r\n\r\n    if (this.isUpdatingHighlights) {\r\n      requestAnimationFrame(this.updateHighlights.bind(this));\r\n    }\r\n  }\r\n\r\n  highlightNodesWithId(nodeId) {\r\n    //gather all nodes with a DOM node we can highlight, that aren't already highlighted\r\n    const nodes = getNodes(this.noodlRuntime, nodeId)\r\n      .filter((node) => node.getRef)\r\n      .filter((node) => !this.highlightedNodes.has(node));\r\n\r\n    for (const node of nodes) {\r\n      const highlight = this.createHighlightDiv();\r\n\r\n      this.highlightRootDiv.appendChild(highlight);\r\n      this.highlightedNodes.set(node, highlight);\r\n    }\r\n\r\n    if ((this.selectedNodes.size > 0 || this.highlightedNodes.size > 0) && !this.isUpdatingHighlights) {\r\n      this.updateHighlights();\r\n    }\r\n  }\r\n\r\n  disableHighlight() {\r\n    for (const item of this.highlightedNodes) {\r\n      const highlight = item[1];\r\n      if (highlight) {\r\n        highlight.remove();\r\n      }\r\n    }\r\n    this.highlightedNodes.clear();\r\n  }\r\n\r\n  selectNodesWithId(nodeId) {\r\n    //we don't track when nodes are created, so if there's no root component, wait a while and then highlight so we can get all the instances\r\n    //TODO: track nodes as they're created so newly created nodes can be selected if their IDs match\r\n    if (!this.noodlRuntime.rootComponent) {\r\n      this.noodlRuntime.eventEmitter.once('rootComponentUpdated', () => {\r\n        setTimeout(() => {\r\n          this.selectNodesWithId(nodeId);\r\n        }, 300);\r\n      });\r\n    }\r\n\r\n    const nodes = getNodes(this.noodlRuntime, nodeId)\r\n      .filter((node) => node.getRef)\r\n      .filter((node) => !this.selectedNodes.has(node));\r\n\r\n    for (const node of nodes) {\r\n      const selection = this.createHighlightDiv();\r\n\r\n      this.highlightRootDiv.appendChild(selection);\r\n      this.selectedNodes.set(node, selection);\r\n    }\r\n\r\n    if (this.selectedNodes.size > 0) {\r\n      this.setWindowSelected(false);\r\n    }\r\n\r\n    if ((this.selectedNodes.size > 0 || this.highlightedNodes.size > 0) && !this.isUpdatingHighlights) {\r\n      this.updateHighlights();\r\n    }\r\n\r\n    return nodes;\r\n  }\r\n\r\n  deselectNodes() {\r\n    for (const item of this.selectedNodes) {\r\n      const selection = item[1];\r\n      if (selection) {\r\n        selection.remove();\r\n      }\r\n    }\r\n    this.selectedNodes.clear();\r\n  }\r\n}\r\n\r\nfunction getNodes(noodlRuntime, nodeId) {\r\n  if (!noodlRuntime.rootComponent) {\r\n    return [];\r\n  }\r\n  return noodlRuntime.rootComponent.nodeScope.getNodesWithIdRecursive(nodeId);\r\n}\r\n","export default class Inspector {\r\n  constructor({ onInspect, onHighlight, onDisableHighlight }) {\r\n    this.onMouseMove = (e) => {\r\n      onDisableHighlight();\r\n\r\n      const noodlNode = this.findNoodlNode(e.target);\r\n      if (noodlNode) {\r\n        document.body.style.cursor = 'pointer';\r\n        onHighlight(noodlNode.id);\r\n      } else {\r\n        document.body.style.cursor = 'initial';\r\n      }\r\n\r\n      e.stopPropagation();\r\n    };\r\n\r\n    this.onClick = (e) => {\r\n      onDisableHighlight();\r\n\r\n      const noodlNode = this.findNoodlNode(e.target);\r\n      if (noodlNode) {\r\n        onInspect([noodlNode.id]);\r\n      }\r\n\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n\r\n      //not sure how to stop React input elements from getting focus, so blurring the potential element tha got focus on click\r\n      if (document.activeElement) {\r\n        document.activeElement.blur();\r\n      }\r\n    };\r\n\r\n    this.onContextMenu = (e) => {\r\n      const nodeIds = document\r\n        .elementsFromPoint(e.clientX, e.clientY)\r\n        .map((dom) => this.findNoodlNode(dom))\r\n        .filter((node) => !!node)\r\n        .map((node) => node.id);\r\n\r\n      if (nodeIds.length) {\r\n        onInspect(nodeIds);\r\n      }\r\n\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n\r\n      //not sure how to stop React input elements from getting focus, so blurring the potential element tha got focus on click\r\n      if (document.activeElement) {\r\n        document.activeElement.blur();\r\n      }\r\n    };\r\n\r\n    this.onMouseOut = (e) => {\r\n      onDisableHighlight();\r\n    };\r\n\r\n    this.blockEvent = (e) => {\r\n      e.stopPropagation();\r\n    };\r\n\r\n    this.onDisableHighlight = onDisableHighlight;\r\n  }\r\n\r\n  setComponent(component) {\r\n    this.component = component;\r\n  }\r\n\r\n  enable() {\r\n    //blur active element, if any\r\n    if (document.activeElement) {\r\n      document.activeElement.blur();\r\n    }\r\n\r\n    //get events from capture phase, before they tunnel down the tree\r\n    document.addEventListener('mouseenter', this.blockEvent, true);\r\n    document.addEventListener('mouseover', this.blockEvent, true);\r\n    document.addEventListener('mousedown', this.blockEvent, true);\r\n    document.addEventListener('mouseup', this.blockEvent, true);\r\n    document.addEventListener('mousemove', this.onMouseMove, true);\r\n    document.addEventListener('mouseout', this.onMouseOut, true);\r\n    document.addEventListener('click', this.onClick, true);\r\n    document.addEventListener('contextmenu', this.onContextMenu, true);\r\n  }\r\n\r\n  disable() {\r\n    document.body.style.cursor = 'initial';\r\n\r\n    document.removeEventListener('mouseenter', this.blockEvent, true);\r\n    document.removeEventListener('mouseover', this.blockEvent, true);\r\n    document.removeEventListener('mousedown', this.blockEvent, true);\r\n    document.removeEventListener('mouseup', this.blockEvent, true);\r\n    document.removeEventListener('mousemove', this.onMouseMove, true);\r\n    document.removeEventListener('mouseout', this.onMouseOut, true);\r\n    document.removeEventListener('click', this.onClick, true);\r\n    document.removeEventListener('contextmenu', this.onContextMenu, true);\r\n\r\n    this.onDisableHighlight();\r\n  }\r\n\r\n  findNoodlNode(dom) {\r\n    //walk the dom tree upwards until a dom element with react state is found\r\n    let domFiber;\r\n    while (!domFiber && dom) {\r\n      const key = Object.keys(dom).find((key) => key.startsWith('__reactInternalInstance$'));\r\n      domFiber = dom[key];\r\n      if (!domFiber) dom = dom.parentElement;\r\n    }\r\n\r\n    //found none\r\n    if (!domFiber) {\r\n      return undefined;\r\n    }\r\n\r\n    const GetCompFiber = (fiber) => {\r\n      let parentFiber = fiber.return;\r\n      while (parentFiber && typeof parentFiber.type == 'string') {\r\n        parentFiber = parentFiber.return;\r\n      }\r\n      return parentFiber;\r\n    };\r\n\r\n    //found a react node, now walk the react tree until a noodl node is found\r\n    //(identified by having a noodlNode prop)\r\n    let compFiber = GetCompFiber(domFiber);\r\n    while (compFiber && (!compFiber.stateNode || !compFiber.stateNode.props || !compFiber.stateNode.props.noodlNode)) {\r\n      compFiber = GetCompFiber(compFiber);\r\n    }\r\n\r\n    const noodlNode = compFiber ? compFiber.stateNode.props.noodlNode : undefined;\r\n    if (!noodlNode) return;\r\n\r\n    if (this.component) {\r\n      let node = noodlNode;\r\n\r\n      while (node) {\r\n        if (node.parentNodeScope) {\r\n          if (node.parentNodeScope.componentOwner.name === this.component.name) {\r\n            return node;\r\n          }\r\n          node = node.parentNodeScope.componentOwner;\r\n        } else {\r\n          if (node.nodeScope.componentOwner.name === this.component.name) {\r\n            return node;\r\n          }\r\n          node = node.nodeScope.componentOwner;\r\n        }\r\n      }\r\n\r\n      return node;\r\n    }\r\n\r\n    return noodlNode;\r\n  }\r\n}\r\n","const IS_BROWSER = typeof document !== 'undefined';\r\n\r\nexport class SeoApi {\r\n  private _title = '';\r\n  private _meta: Record<string, string> = {};\r\n\r\n  /** Returns the current document title. */\r\n  get title(): string {\r\n    return IS_BROWSER ? document.title : this._title;\r\n  }\r\n\r\n  /** Set the document title. */\r\n  setTitle(value: string) {\r\n    this._title = value;\r\n\r\n    if (IS_BROWSER) {\r\n      document.title = value;\r\n    }\r\n  }\r\n\r\n  /** Returns all the current meta-tags  */\r\n  get meta(): Readonly<SeoApi['_meta']> {\r\n    return this._meta;\r\n  }\r\n\r\n  /** Clear all the meta-tags. */\r\n  clearMeta(): void {\r\n    if (IS_BROWSER) {\r\n      // Remove all the meta-tags, technically this is useless when running client-side.\r\n      Object.keys(this._meta).forEach((key) => {\r\n        const metaTag = document.querySelector(`meta[name=\"${key}\"]`);\r\n        if (metaTag) {\r\n          metaTag.remove();\r\n        }\r\n      });\r\n    }\r\n\r\n    this._meta = {};\r\n  }\r\n\r\n  /** Returns a specific meta-tag by name. */\r\n  getMeta(key: string) {\r\n    // NOTE: We are not querying if the meta-tag exist, maybe something we would like to do?\r\n    return this._meta[key];\r\n  }\r\n\r\n  /**\r\n   * Set a meta-tag.\r\n   *\r\n   * @param key The 'name' and/or the 'property' key used for the meta-tags.\r\n   * @param value The meta-tag content; if undefined, the meta-tag is removed.\r\n   */\r\n  setMeta(key: string, value: string | undefined): void {\r\n    this._meta[key] = value;\r\n\r\n    if (IS_BROWSER) {\r\n      const metaTag = document.querySelector(`meta[name=\"${key}\"]`);\r\n      if (metaTag) {\r\n        if (!value) {\r\n          metaTag.remove();\r\n        } else {\r\n          metaTag.setAttribute('content', value);\r\n        }\r\n      } else if (value) {\r\n        const newMetaTag = document.createElement('meta');\r\n        newMetaTag.setAttribute('name', key);\r\n        newMetaTag.setAttribute('property', key);\r\n        newMetaTag.setAttribute('content', value);\r\n        document.head.appendChild(newMetaTag);\r\n      }\r\n    }\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport { SeoApi } from './api/seo';\r\n\r\nexport default function createNoodlAPI(noodlRuntime) {\r\n  // Support SSR\r\n  const global = typeof window !== 'undefined' ? window : globalThis;\r\n\r\n  global.Noodl.getProjectSettings = noodlRuntime.getProjectSettings.bind(noodlRuntime);\r\n  global.Noodl.getMetaData = noodlRuntime.getMetaData.bind(noodlRuntime);\r\n  global.Noodl.Collection = global.Noodl.Array = require('@noodl/runtime/src/collection');\r\n  global.Noodl.Model = global.Noodl.Object = require('@noodl/runtime/src/model');\r\n  global.Noodl.Variables = global.Noodl.Object.get('--ndl--global-variables');\r\n  global.Noodl.Events = global.Noodl.eventEmitter = noodlRuntime.context.eventSenderEmitter;\r\n  global.Noodl.Records = require('@noodl/runtime/src/api/records')();\r\n  global.Noodl.Users = require('./api/users');\r\n  global.Noodl.CloudFunctions = require('./api/cloudfunctions');\r\n  global.Noodl.Navigation = require('./api/navigation');\r\n  global.Noodl.Navigation._noodlRuntime = noodlRuntime;\r\n  global.Noodl.Files = require('./api/files');\r\n  global.Noodl.SEO = new SeoApi();\r\n  if (!global.Noodl.Env) {\r\n    global.Noodl.Env = {};\r\n  }\r\n\r\n  global.Noodl.Arrays = new Proxy(global.Noodl.Array, {\r\n    get(target, prop, receiver) {\r\n      return Noodl.Array.get(prop);\r\n    },\r\n    set(obj, prop, value) {\r\n      if (!Array.isArray(value)) {\r\n        throw new Error('Cannot assign non array value to array with id ' + prop);\r\n      }\r\n      Noodl.Array.get(prop).set(value);\r\n    }\r\n  });\r\n\r\n  global.Noodl.Objects = new Proxy(global.Noodl.Object, {\r\n    get(target, prop, receiver) {\r\n      return Noodl.Object.get(prop);\r\n    },\r\n    set(obj, prop, value) {\r\n      Noodl.Object.get(prop).setAll(value);\r\n    }\r\n  });\r\n}\r\n","export default {\r\n  ports: [\r\n    {\r\n      name: 'htmlTitle',\r\n      displayName: 'Title',\r\n      group: 'General',\r\n      plug: 'input',\r\n      type: 'string',\r\n      default: 'Fluxscape Viewer',\r\n      tooltip: 'The title that web browsers show',\r\n      ignoreInExport: true\r\n    },\r\n    {\r\n      name: 'headCode',\r\n      displayName: 'Head Code',\r\n      group: 'Custom Code',\r\n      plug: 'input',\r\n      type: {\r\n        name: 'string',\r\n        codeeditor: 'html'\r\n      },\r\n      tooltip: 'Add custom code to the &lt;head&gt; tag',\r\n      ignoreInExport: true\r\n    },\r\n    {\r\n      name: 'navigationPathType',\r\n      displayName: 'URL Path Type',\r\n      group: 'Navigation',\r\n      plug: 'input',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Hash', value: 'hash' },\r\n          { label: 'Path', value: 'path' }\r\n        ]\r\n      },\r\n      default: 'hash'\r\n    },\r\n    {\r\n      name: 'bodyScroll',\r\n      displayName: 'Body Scroll',\r\n      group: 'Experimental features',\r\n      plug: 'input',\r\n      type: {\r\n        name: 'boolean'\r\n      },\r\n      tooltip: 'Changes so the &lt;body&gt; tag will scroll by default'\r\n    },\r\n    {\r\n      name: 'repeaterDisabledWhenUnmounted',\r\n      displayName: 'Disable when unmounted',\r\n      group: 'Experimental features - Repeater',\r\n      plug: 'input',\r\n      type: {\r\n        name: 'boolean'\r\n      },\r\n      tooltip: \"Repeater will only create components when it's mounted\"\r\n    },\r\n    {\r\n      name: 'repeaterCreateComponentsAsync',\r\n      displayName: 'Create asynchronously',\r\n      group: 'Experimental features - Repeater',\r\n      plug: 'input',\r\n      type: {\r\n        name: 'boolean'\r\n      },\r\n      tooltip: 'Repeater items will be created in chunks to keep UI responsive'\r\n    }\r\n  ]\r\n};\r\n","export default class DOMBoundingBoxObserver {\r\n  constructor(callback, pollDelay) {\r\n    this.isRunning = false;\r\n    this.numBoundingBoxObservers = 0;\r\n    this.callback = callback;\r\n    this.pollDelay = pollDelay;\r\n  }\r\n\r\n  addObserver() {\r\n    this.numBoundingBoxObservers++;\r\n\r\n    if (!this.isRunning) {\r\n      this._startObserver();\r\n    }\r\n  }\r\n\r\n  removeObserver() {\r\n    this.numBoundingBoxObservers--;\r\n    if (this.numBoundingBoxObservers === 0) {\r\n      this._stopObserver();\r\n    }\r\n  }\r\n\r\n  setTarget(target) {\r\n    this.target = target;\r\n    if (this.numBoundingBoxObservers > 0 && !this.isRunning) {\r\n      this._startObserver();\r\n    }\r\n  }\r\n\r\n  _startObserver() {\r\n    if (this.isRunning) return;\r\n    if (!this.target) return;\r\n\r\n    this.isRunning = true;\r\n\r\n    let boundingRect = {};\r\n    const observer = () => {\r\n      if (!this.target) {\r\n        this.isRunning = false;\r\n        return;\r\n      }\r\n\r\n      const bb = this.target.getBoundingClientRect();\r\n      if (boundingRect.x !== bb.x) {\r\n        this.callback('x', bb);\r\n      }\r\n      if (boundingRect.y !== bb.y) {\r\n        this.callback('y', bb);\r\n      }\r\n      if (boundingRect.width !== bb.width) {\r\n        this.callback('width', bb);\r\n      }\r\n      if (boundingRect.height !== bb.height) {\r\n        this.callback('height', bb);\r\n      }\r\n      boundingRect = bb;\r\n\r\n      if (this.isRunning) {\r\n        if (this.pollDelay) {\r\n          setTimeout(observer, this.pollDelay);\r\n        } else {\r\n          //poll as quickly as possible\r\n          window.requestAnimationFrame(observer);\r\n        }\r\n      }\r\n    };\r\n\r\n    window.requestAnimationFrame(observer);\r\n  }\r\n\r\n  _stopObserver() {\r\n    this.isRunning = false;\r\n  }\r\n}\r\n","function isPercentage(size) {\r\n  return size && size[size.length - 1] === '%';\r\n}\r\n\r\nfunction getPercentage(size) {\r\n  return Number(size.slice(0, -1));\r\n}\r\n\r\nfunction getSizeWithMargins(size, startMargin, endMargin) {\r\n  if (!startMargin && !endMargin) {\r\n    return size;\r\n  }\r\n\r\n  let css = `calc(${size}`;\r\n  if (startMargin) {\r\n    css += ` - ${startMargin}`;\r\n  }\r\n  if (endMargin) {\r\n    css += ` - ${endMargin}`;\r\n  }\r\n  css += ')';\r\n\r\n  return css;\r\n}\r\n\r\nexport default {\r\n  size(style, props) {\r\n    if (props.parentLayout === 'none') {\r\n      style.position = 'absolute';\r\n    }\r\n\r\n    if (props.sizeMode === 'explicit') {\r\n      style.width = props.width;\r\n      style.height = props.height;\r\n    } else if (props.sizeMode === 'contentHeight') {\r\n      style.width = props.width;\r\n    } else if (props.sizeMode === 'contentWidth') {\r\n      style.height = props.height;\r\n    }\r\n\r\n    style.flexShrink = 0;\r\n\r\n    if (props.parentLayout === 'row' && style.position === 'relative') {\r\n      if (isPercentage(style.width) && !props.fixedWidth) {\r\n        style.flexGrow = getPercentage(style.width);\r\n        style.flexShrink = 1;\r\n      }\r\n\r\n      if (isPercentage(style.height) && !props.fixedHeight) {\r\n        style.height = getSizeWithMargins(style.height, style.marginTop, style.marginBottom);\r\n      }\r\n    } else if (props.parentLayout === 'column' && style.position === 'relative') {\r\n      if (isPercentage(style.width) && !props.fixedWidth) {\r\n        style.width = getSizeWithMargins(style.width, style.marginLeft, style.marginRight);\r\n      }\r\n\r\n      if (isPercentage(style.height) && !props.fixedHeight) {\r\n        style.flexGrow = getPercentage(style.height);\r\n        style.flexShrink = 1;\r\n      }\r\n    } else if (style.position !== 'relative') {\r\n      if (isPercentage(style.width)) {\r\n        style.width = getSizeWithMargins(style.width, style.marginLeft, style.marginRight);\r\n      }\r\n      if (isPercentage(style.height)) {\r\n        style.height = getSizeWithMargins(style.height, style.marginTop, style.marginBottom);\r\n      }\r\n    }\r\n  },\r\n  align(style, props) {\r\n    const { position } = style;\r\n    let { alignX, alignY } = props;\r\n\r\n    //Elements with position absolute get's a default alignment.\r\n    //This keeps backward compability, and makes sense for most use cases of\r\n    //absolutely positioned elements\r\n    if (position !== 'relative') {\r\n      alignX = alignX || 'left';\r\n      alignY = alignY || 'top';\r\n    }\r\n\r\n    let transform = '';\r\n\r\n    const parentFlexDirection = props.parentLayout || 'column';\r\n    if (alignX) {\r\n      if (position !== 'relative') {\r\n        if (alignX === 'left') {\r\n          style.left = 0;\r\n        } else if (alignX === 'center') {\r\n          style.left = '50%';\r\n          transform += 'translateX(-50%) ';\r\n        } else {\r\n          style.right = 0;\r\n        }\r\n      } else if (position === 'relative' && parentFlexDirection === 'row') {\r\n        switch (alignX) {\r\n          case 'left':\r\n            style.marginRight = style.marginRight ? style.marginRight : 'auto';\r\n            break;\r\n          case 'center':\r\n            style.marginRight = style.marginRight ? style.marginRight : 'auto';\r\n            style.marginLeft = style.marginLeft ? style.marginLeft : 'auto';\r\n            break;\r\n          case 'right':\r\n            style.marginLeft = style.marginLeft ? style.marginLeft : 'auto';\r\n            break;\r\n        }\r\n      } else if (position === 'relative' && parentFlexDirection === 'column') {\r\n        switch (alignX) {\r\n          case 'left':\r\n            style.alignSelf = 'flex-start';\r\n            break;\r\n          case 'center':\r\n            style.alignSelf = 'center';\r\n            break;\r\n          case 'right':\r\n            style.alignSelf = 'flex-end';\r\n            break;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (alignY) {\r\n      if (position !== 'relative') {\r\n        if (alignY === 'top') {\r\n          style.top = 0;\r\n        } else if (alignY === 'center') {\r\n          style.top = '50%';\r\n          transform += 'translateY(-50%)';\r\n        } else {\r\n          style.bottom = 0;\r\n        }\r\n      } else if (position === 'relative' && parentFlexDirection === 'column') {\r\n        switch (alignY) {\r\n          case 'top':\r\n            style.marginBottom = style.marginBottom ? style.marginBottom : 'auto';\r\n            break;\r\n          case 'center':\r\n            style.marginTop = style.marginTop ? style.marginTop : 'auto';\r\n            style.marginBottom = style.marginBottom ? style.marginBottom : 'auto';\r\n            break;\r\n          case 'bottom':\r\n            style.marginTop = style.marginTop ? style.marginTop : 'auto';\r\n            break;\r\n        }\r\n      } else if (position === 'relative' && parentFlexDirection === 'row') {\r\n        switch (alignY) {\r\n          case 'top':\r\n            style.alignSelf = 'flex-start';\r\n            break;\r\n          case 'center':\r\n            style.alignSelf = 'center';\r\n            break;\r\n          case 'bottom':\r\n            style.alignSelf = 'flex-end';\r\n            break;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (transform) {\r\n      style.transform = transform + (style.transform || '');\r\n    }\r\n  }\r\n};\r\n","function isObject(item) {\r\n  return item && typeof item === 'object' && !Array.isArray(item);\r\n}\r\n\r\nexport default function mergeDeep(target, ...sources) {\r\n  if (!sources.length) return target;\r\n  const source = sources.shift();\r\n\r\n  if (isObject(target) && isObject(source)) {\r\n    for (const key in source) {\r\n      if (isObject(source[key])) {\r\n        if (!target[key]) Object.assign(target, { [key]: {} });\r\n        mergeDeep(target[key], source[key]);\r\n      } else {\r\n        Object.assign(target, { [key]: source[key] });\r\n      }\r\n    }\r\n  }\r\n\r\n  return mergeDeep(target, ...sources);\r\n}\r\n","export function createTooltip({ title, body, images }) {\r\n  let html = `<h3>${title}</h3>`;\r\n  if (body) {\r\n    body = Array.isArray(body) ? body : [body];\r\n\r\n    html += body.map((text) => `<p>${text}</p>`).join('');\r\n  }\r\n\r\n  if (images) {\r\n    let imgHtml = '';\r\n\r\n    images.forEach((e) => {\r\n      imgHtml += `<div class=\"popup-layer-image-item\">`;\r\n      imgHtml += `<img src=\"../assets/images/tooltips/${e.src}\">`;\r\n      if (e.label) {\r\n        imgHtml += `<h3>${e.label}</h3>`;\r\n      }\r\n      if (e.body) {\r\n        imgHtml += `<p>${e.body}</p>`;\r\n      }\r\n      imgHtml += `</div>`;\r\n    });\r\n\r\n    html += `<div class=\"popup-layer-image-row\">${imgHtml}</div>`;\r\n  }\r\n\r\n  return html;\r\n}\r\n","import { getAbsoluteUrl } from '@noodl/runtime/src/utils';\r\n\r\nimport FontLoader from './fontloader';\r\nimport { createTooltip } from './tooltips';\r\n\r\nfunction addInputCss(definition, inputs) {\r\n  if (!definition.inputCss) {\r\n    definition.inputCss = {};\r\n  }\r\n\r\n  if (!definition.defaultCss) {\r\n    definition.defaultCss = {};\r\n  }\r\n\r\n  for (const name in inputs) {\r\n    definition.inputCss[name] = inputs[name];\r\n  }\r\n}\r\n\r\nfunction mergeAttribute(definition, attribute, values) {\r\n  if (!definition[attribute]) {\r\n    definition[attribute] = {};\r\n  }\r\n\r\n  for (const name in values) {\r\n    definition[attribute][name] = values[name];\r\n  }\r\n}\r\n\r\nfunction addInputs(definition, values) {\r\n  mergeAttribute(definition, 'inputs', values);\r\n}\r\n\r\nfunction addInputProps(definition, values) {\r\n  mergeAttribute(definition, 'inputProps', values);\r\n}\r\n\r\nfunction addDynamicInputPorts(definition, condition, inputs) {\r\n  if (!definition.dynamicports) {\r\n    definition.dynamicports = [];\r\n  }\r\n\r\n  definition.dynamicports.push({ condition, inputs });\r\n}\r\n\r\nfunction addOutputProps(definition, values) {\r\n  mergeAttribute(definition, 'outputProps', values);\r\n}\r\n\r\nexport default {\r\n  addInputProps,\r\n  addInputs,\r\n  addDynamicInputPorts,\r\n  addInputCss,\r\n  addSharedVisualInputs(definition) {\r\n    addInputCss(definition, {\r\n      opacity: {\r\n        index: 200,\r\n        group: 'Style',\r\n        displayName: 'Opacity',\r\n        type: 'number',\r\n        default: 1,\r\n        allowVisualStates: true\r\n      },\r\n      mixBlendMode: {\r\n        index: 201,\r\n        group: 'Style',\r\n        displayName: 'Blend Mode',\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'Normal', value: 'normal' },\r\n            { label: 'Multiply', value: 'multiply' },\r\n            { label: 'Screen', value: 'screen' },\r\n            { label: 'Overlay', value: 'overlay' },\r\n            { label: 'Darken', value: 'darken' },\r\n            { label: 'Lighten', value: 'lighten' },\r\n            { label: 'Color Dodge', value: 'color-dodge' },\r\n            { label: 'Color Burn', value: 'color-burn' },\r\n            { label: 'Hard Light', value: 'hard-light' },\r\n            { label: 'Soft Light', value: 'soft-light' },\r\n            { label: 'Difference', value: 'difference' },\r\n            { label: 'Exclusion', value: 'exclusion' },\r\n            { label: 'Hue', value: 'hue' },\r\n            { label: 'Saturation', value: 'saturation' },\r\n            { label: 'Color', value: 'color' },\r\n            { label: 'Luminosity', value: 'luminosity' }\r\n          ]\r\n        },\r\n        default: 'normal',\r\n        applyDefault: false,\r\n        allowVisualStates: true\r\n      }\r\n    });\r\n\r\n    addInputs(definition, {\r\n      visible: {\r\n        index: 210,\r\n        displayName: 'Visible',\r\n        group: 'Style',\r\n        default: true,\r\n        type: 'boolean',\r\n        set(value) {\r\n          if (value) {\r\n            this.removeStyle(['visibility']);\r\n          } else {\r\n            this.setStyle({ visibility: 'hidden' });\r\n          }\r\n        }\r\n      },\r\n      zIndex: {\r\n        index: 211,\r\n        displayName: 'zIndex',\r\n        group: 'Style',\r\n        type: 'number',\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          if (value === undefined) {\r\n            this.removeStyle(['zIndex']);\r\n          } else {\r\n            this.setStyle({ zIndex: Number(value) });\r\n          }\r\n        }\r\n      }\r\n    });\r\n  },\r\n  addMarginInputs(definition) {\r\n    addInputCss(definition, {\r\n      marginLeft: {\r\n        index: 1,\r\n        group: 'Margin and padding',\r\n        displayName: 'Margin Left',\r\n        type: {\r\n          name: 'number',\r\n          units: ['px', '%'],\r\n          defaultUnit: 'px',\r\n          marginPaddingComp: 'margin-left'\r\n        },\r\n        allowVisualStates: true\r\n      },\r\n      marginRight: {\r\n        index: 2,\r\n        group: 'Margin and padding',\r\n        displayName: 'Margin Right',\r\n        type: {\r\n          name: 'number',\r\n          units: ['px', '%'],\r\n          defaultUnit: 'px',\r\n          marginPaddingComp: 'margin-right'\r\n        },\r\n        allowVisualStates: true\r\n      },\r\n      marginTop: {\r\n        index: 3,\r\n        group: 'Margin and padding',\r\n        displayName: 'Margin Top',\r\n        type: {\r\n          name: 'number',\r\n          units: ['px', '%'],\r\n          defaultUnit: 'px',\r\n          marginPaddingComp: 'margin-top'\r\n        },\r\n        allowVisualStates: true\r\n      },\r\n      marginBottom: {\r\n        index: 4,\r\n        group: 'Margin and padding',\r\n        displayName: 'Margin Bottom',\r\n        type: {\r\n          name: 'number',\r\n          units: ['px', '%'],\r\n          defaultUnit: 'px',\r\n          marginPaddingComp: 'margin-bottom'\r\n        },\r\n        allowVisualStates: true\r\n      }\r\n    });\r\n  },\r\n  addPaddingInputs(definition, args) {\r\n    args = args || {};\r\n    const defaults = args.defaults ? args.defaults : {};\r\n\r\n    const styleTag = args.styleTag;\r\n\r\n    addInputCss(definition, {\r\n      paddingLeft: {\r\n        index: 64,\r\n        group: 'Margin and padding',\r\n        default: defaults.paddingLeft || 0,\r\n        applyDefault: false,\r\n        displayName: 'Pad Left',\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px',\r\n          marginPaddingComp: 'padding-left'\r\n        },\r\n        allowVisualStates: true,\r\n        styleTag\r\n      },\r\n      paddingRight: {\r\n        index: 65,\r\n        group: 'Margin and padding',\r\n        default: defaults.paddingRight || 0,\r\n        applyDefault: false,\r\n        displayName: 'Pad Right',\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px',\r\n          marginPaddingComp: 'padding-right'\r\n        },\r\n        allowVisualStates: true,\r\n        styleTag\r\n      },\r\n      paddingTop: {\r\n        index: 66,\r\n        group: 'Margin and padding',\r\n        displayName: 'Pad Top',\r\n        default: defaults.paddingTop || 0,\r\n        applyDefault: false,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px',\r\n          marginPaddingComp: 'padding-top'\r\n        },\r\n        allowVisualStates: true,\r\n        styleTag\r\n      },\r\n      paddingBottom: {\r\n        index: 67,\r\n        group: 'Margin and padding',\r\n        displayName: 'Pad Bottom',\r\n        default: defaults.paddingBottom || 0,\r\n        applyDefault: false,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px',\r\n          marginPaddingComp: 'padding-bottom'\r\n        },\r\n        allowVisualStates: true,\r\n        styleTag\r\n      }\r\n    });\r\n  },\r\n  addTransformInputs(definition) {\r\n    addInputs(definition, {\r\n      transformX: {\r\n        group: 'Placement',\r\n        displayName: 'Pos X',\r\n        default: 0,\r\n        index: 300,\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px', '%'],\r\n          defaultUnit: 'px'\r\n        },\r\n        set(value) {\r\n          if (!this.transforms) this.transforms = {};\r\n          this.transforms.x = value.value + value.unit;\r\n          this.updateTransform();\r\n        }\r\n      },\r\n      transformY: {\r\n        group: 'Placement',\r\n        displayName: 'Pos Y',\r\n        default: 0,\r\n        index: 301,\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px', '%'],\r\n          defaultUnit: 'px'\r\n        },\r\n        set(value) {\r\n          if (!this.transforms) this.transforms = {};\r\n          this.transforms.y = value.value + value.unit;\r\n          this.updateTransform();\r\n        }\r\n      },\r\n      transformRotation: {\r\n        index: 302,\r\n        group: 'Placement',\r\n        displayName: 'Rotation',\r\n        default: 0,\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: 'number',\r\n          units: ['deg'],\r\n          defaultUnit: 'deg'\r\n        },\r\n        set(value) {\r\n          if (!this.transforms) this.transforms = {};\r\n          this.transforms.rotation = value.value + value.unit;\r\n          this.updateTransform();\r\n        }\r\n      },\r\n      transformScale: {\r\n        index: 303,\r\n        group: 'Placement',\r\n        displayName: 'Scale',\r\n        default: 1,\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: 'number'\r\n        },\r\n        set(value) {\r\n          if (!this.transforms) this.transforms = {};\r\n          this.transforms.scale = value;\r\n          this.updateTransform();\r\n        }\r\n      },\r\n      transformOriginX: {\r\n        index: 304,\r\n        group: 'Placement',\r\n        displayName: 'Transform Origin X',\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px', '%'],\r\n          defaultUnit: '%'\r\n        },\r\n        default: '50',\r\n        set(value) {\r\n          this.transformOriginX = value.value + value.unit;\r\n          this.updateTransformOrigin();\r\n        }\r\n      },\r\n      transformOriginY: {\r\n        index: 305,\r\n        group: 'Placement',\r\n        displayName: 'Transform Origin Y',\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px', '%'],\r\n          defaultUnit: '%'\r\n        },\r\n        default: '50',\r\n        set(value) {\r\n          this.transformOriginY = value.value + value.unit;\r\n          this.updateTransformOrigin();\r\n        }\r\n      }\r\n    });\r\n\r\n    if (!definition.methods) definition.methods = {};\r\n\r\n    definition.methods.updateTransform = function () {\r\n      let transform = '';\r\n\r\n      const { x, y, rotation, scale } = this.transforms;\r\n\r\n      if (x) transform += `translateX(${x}) `;\r\n      if (y) transform += `translateY(${y}) `;\r\n      if (rotation) transform += `rotate(${rotation}) `;\r\n      if (scale !== undefined) transform += `scale(${scale},${scale})`;\r\n\r\n      this.setStyle({ transform });\r\n    };\r\n\r\n    definition.methods.updateTransformOrigin = function () {\r\n      const x = this.transformOriginX !== undefined ? this.transformOriginX : '50%';\r\n      const y = this.transformOriginY !== undefined ? this.transformOriginY : '50%';\r\n\r\n      this.setStyle({\r\n        transformOrigin: `${x} ${y}`\r\n      });\r\n    };\r\n  },\r\n  addAlignInputs(definition) {\r\n    const positions = [\r\n      { label: 'In Layout', value: 'relative' },\r\n      { label: 'Absolute', value: 'absolute' },\r\n      { label: 'Sticky', value: 'sticky' },\r\n      { label: 'Fixed', value: 'fixed' }\r\n    ];\r\n\r\n    addInputCss(definition, {\r\n      position: {\r\n        index: 11,\r\n        displayName: 'Position',\r\n        group: 'Layout',\r\n        type: {\r\n          name: 'enum',\r\n          enums: positions\r\n        },\r\n        default: 'relative'\r\n      }\r\n    });\r\n\r\n    addInputProps(definition, {\r\n      alignX: {\r\n        index: 5,\r\n        group: 'Alignment',\r\n        displayName: 'Align X',\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'Left', value: 'left' },\r\n            { label: 'Center', value: 'center' },\r\n            { label: 'Right', value: 'right' }\r\n          ],\r\n          alignComp: 'horizontal'\r\n        }\r\n      },\r\n      alignY: {\r\n        index: 6,\r\n        group: 'Alignment',\r\n        displayName: 'Align Y',\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'Top', value: 'top' },\r\n            { label: 'Center', value: 'center' },\r\n            { label: 'Bottom', value: 'bottom' }\r\n          ],\r\n          alignComp: 'vertical'\r\n        }\r\n      }\r\n    });\r\n\r\n    addPositionAndAlignTooltips(definition);\r\n  },\r\n  addPointerEventOutputs(definition) {\r\n    addInputs(definition, {\r\n      pointerEventsMode: {\r\n        index: 403,\r\n        displayName: 'Pointer Events Mode',\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'Inherit', value: 'inherit' },\r\n            { label: 'Explicit', value: 'explicit' }\r\n          ]\r\n        },\r\n        default: 'inherit',\r\n        group: 'Pointer Events',\r\n        set(value) {\r\n          if (value === 'inherit') {\r\n            this.removeStyle(['pointerEvents']);\r\n          } else {\r\n            let pointerEvents = 'auto'; //default to auto\r\n            if (this._internal.pointerEventsEnabled !== undefined) {\r\n              pointerEvents = this._internal.pointerEventsEnabled ? 'auto' : 'none';\r\n            }\r\n            this.setStyle({ pointerEvents });\r\n          }\r\n        }\r\n      },\r\n      pointerEventsEnabled: {\r\n        index: 404,\r\n        displayName: 'Pointer Events Enabled',\r\n        type: 'boolean',\r\n        group: 'Pointer Events',\r\n        default: true,\r\n        set(value) {\r\n          this._internal.pointerEventsEnabled = value ? true : false;\r\n          this.setStyle({\r\n            pointerEvents: this._internal.pointerEventsEnabled ? 'auto' : 'none'\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    addInputProps(definition, {\r\n      blockTouch: {\r\n        index: 450,\r\n        displayName: 'Block Pointer Events',\r\n        group: 'Pointer Events',\r\n        type: 'boolean'\r\n      }\r\n    });\r\n\r\n    addDynamicInputPorts(definition, 'pointerEventsMode = explicit', ['pointerEventsEnabled']);\r\n\r\n    addOutputProps(definition, {\r\n      onClick: {\r\n        displayName: 'Click',\r\n        group: 'Events',\r\n        type: 'signal',\r\n        propPath: 'pointer'\r\n      },\r\n      pointerDown: {\r\n        displayName: 'Pointer Down',\r\n        group: 'Pointer Events',\r\n        type: 'signal',\r\n        propPath: 'pointer',\r\n        props: {\r\n          onMouseDown() {\r\n            this.sendSignalOnOutput('pointerDown');\r\n          },\r\n          onTouchStart() {\r\n            this.sendSignalOnOutput('pointerDown');\r\n          }\r\n        }\r\n      },\r\n      pointerUp: {\r\n        displayName: 'Pointer Up',\r\n        group: 'Pointer Events',\r\n        type: 'signal',\r\n        propPath: 'pointer',\r\n        props: {\r\n          onMouseUp() {\r\n            this.sendSignalOnOutput('pointerUp');\r\n          },\r\n          onTouchEnd() {\r\n            this.sendSignalOnOutput('pointerUp');\r\n          },\r\n          onTouchCancel() {\r\n            this.sendSignalOnOutput('pointerUp');\r\n          }\r\n        }\r\n      },\r\n      pointerEnter: {\r\n        displayName: 'Pointer Enter',\r\n        group: 'Pointer Events',\r\n        type: 'signal',\r\n        propPath: 'pointer',\r\n        props: {\r\n          onMouseEnter() {\r\n            this.sendSignalOnOutput('pointerEnter');\r\n          }\r\n        }\r\n      },\r\n      hoverStart: {\r\n        displayName: 'Hover Start',\r\n        group: 'Hover Events',\r\n        type: 'signal',\r\n        propPath: 'pointer',\r\n        props: {\r\n          onMouseOver() {\r\n            this.sendSignalOnOutput('hoverStart');\r\n            this.setVisualStates(['hover']);\r\n          }\r\n        }\r\n      },\r\n      hoverEnd: {\r\n        displayName: 'Hover End',\r\n        group: 'Hover Events',\r\n        type: 'signal',\r\n        propPath: 'pointer',\r\n        props: {\r\n          onMouseLeave() {\r\n            this.sendSignalOnOutput('hoverEnd');\r\n            this.setVisualStates(['']);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    addPointerEventsTooltips(definition);\r\n  },\r\n  addDimensions(\r\n    definition,\r\n    { defaultSizeMode = 'explicit', contentLabel = 'Content', useDimensionConstraints = true } = {}\r\n  ) {\r\n    let widthCondition = 'sizeMode = explicit OR sizeMode = contentHeight';\r\n    let heightCondition = 'sizeMode = explicit OR sizeMode = contentWidth';\r\n\r\n    if (defaultSizeMode === 'explicit' || defaultSizeMode === 'contentHeight') {\r\n      widthCondition += ' OR sizeMode NOT SET';\r\n    }\r\n\r\n    if (defaultSizeMode === 'explicit' || defaultSizeMode === 'contentWidth') {\r\n      heightCondition += ' OR sizeMode NOT SET';\r\n    }\r\n\r\n    addDynamicInputPorts(definition, widthCondition, ['width']);\r\n    addDynamicInputPorts(definition, heightCondition, ['height']);\r\n\r\n    addInputProps(definition, {\r\n      sizeMode: {\r\n        index: 10,\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { value: 'explicit', label: 'Explicit' },\r\n            { value: 'contentWidth', label: 'Content Width' },\r\n            { value: 'contentHeight', label: 'Content Height' },\r\n            { value: 'contentSize', label: 'Content Size' }\r\n          ],\r\n          allowEditOnly: true,\r\n          sizeComp: 'mode'\r\n        },\r\n        group: 'Dimensions',\r\n        displayName: 'Size Mode',\r\n        default: defaultSizeMode,\r\n        allowVisualStates: true\r\n      },\r\n      width: {\r\n        index: 11,\r\n        group: 'Dimensions',\r\n        displayName: 'Width',\r\n        type: {\r\n          name: 'dimension',\r\n          units: ['%', 'px', 'vw', 'vh'],\r\n          defaultUnit: '%'\r\n        },\r\n        default: 100,\r\n        allowVisualStates: true,\r\n        onChange(value) {\r\n          this.props.fixedWidth = value.isFixed;\r\n        }\r\n      },\r\n      height: {\r\n        index: 13,\r\n        group: 'Dimensions',\r\n        displayName: 'Height',\r\n        type: {\r\n          name: 'dimension',\r\n          units: ['%', 'px', 'vw', 'vh'],\r\n          defaultUnit: '%'\r\n        },\r\n        default: 100,\r\n        allowVisualStates: true,\r\n        onChange(value) {\r\n          this.props.fixedHeight = value.isFixed;\r\n        }\r\n      }\r\n    });\r\n\r\n    if (!Noodl.deployed) {\r\n      addDimensionTooltips(definition, contentLabel);\r\n    }\r\n\r\n    if (useDimensionConstraints) {\r\n      addInputCss(definition, {\r\n        minWidth: {\r\n          index: 400,\r\n          group: 'Dimension Constraints',\r\n          displayName: 'Min Width',\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: 'number',\r\n            units: ['%', 'px', 'vw', 'vh'],\r\n            defaultUnit: '%'\r\n          }\r\n        },\r\n        maxWidth: {\r\n          index: 401,\r\n          group: 'Dimension Constraints',\r\n          displayName: 'Max Width',\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: 'number',\r\n            units: ['%', 'px', 'vw', 'vh'],\r\n            defaultUnit: '%'\r\n          }\r\n        },\r\n        minHeight: {\r\n          index: 402,\r\n          group: 'Dimension Constraints',\r\n          displayName: 'Min Height',\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: 'number',\r\n            units: ['%', 'px', 'vw', 'vh'],\r\n            defaultUnit: '%'\r\n          }\r\n        },\r\n        maxHeight: {\r\n          index: 403,\r\n          group: 'Dimension Constraints',\r\n          displayName: 'Max Height',\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: 'number',\r\n            units: ['%', 'px', 'vw', 'vh'],\r\n            defaultUnit: '%'\r\n          }\r\n        }\r\n      });\r\n\r\n      if (!Noodl.deployed) {\r\n        addDimensionConstraintsTooltips(definition);\r\n      }\r\n    }\r\n  },\r\n  _addCornerRadius(definition, opts) {\r\n    opts = opts || {};\r\n    const defaults = opts.defaults || {};\r\n    const styleTag = opts.styleTag;\r\n\r\n    if (!defaults.borderRadius) defaults.borderRadius = 0;\r\n\r\n    function defineCornerTab(definition, suffix, tabName, indexOffset) {\r\n      const nameWithTab = (name) => `${name} ${suffix ? '(' + suffix + ')' : ''}`;\r\n\r\n      const tab = { group: 'corners', tab: tabName, label: suffix };\r\n      const radiusName = `border${suffix}Radius`;\r\n      addInputs(definition, {\r\n        [radiusName]: {\r\n          index: 240 + indexOffset,\r\n          displayName: 'Corner Radius',\r\n          editorName: nameWithTab('Corner Radius'),\r\n          group: 'Corner Radius',\r\n          type: {\r\n            name: 'number',\r\n            units: ['px', '%'],\r\n            defaultUnit: 'px'\r\n          },\r\n          allowVisualStates: true,\r\n          default: defaults[radiusName],\r\n          tab,\r\n          set(value) {\r\n            this._internal.borderRadius[radiusName] =\r\n              value.value === undefined ? Number(value) + 'px' : value.value + value.unit;\r\n\r\n            this._updateCornerRadii();\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    defineCornerTab(definition, '', 'corners-all', 0);\r\n    defineCornerTab(definition, 'TopLeft', 'corners-top-left', 1);\r\n    defineCornerTab(definition, 'TopRight', 'corners-top-right', 2);\r\n    defineCornerTab(definition, 'BottomRight', 'corners-bottom-right', 3);\r\n    defineCornerTab(definition, 'BottomLeft', 'corners-bottom-left', 4);\r\n\r\n    definition.methods._updateCornerRadii = function () {\r\n      const b = this._internal.borderRadius;\r\n\r\n      function setCorner(style, corner) {\r\n        const r = `border${corner}Radius`;\r\n        style[r] = b[r] || b.borderRadius;\r\n      }\r\n\r\n      const style = {};\r\n      setCorner(style, 'TopLeft');\r\n      setCorner(style, 'TopRight');\r\n      setCorner(style, 'BottomRight');\r\n      setCorner(style, 'BottomLeft');\r\n\r\n      this.setStyle(style, styleTag);\r\n    };\r\n\r\n    const oldInit = definition.initialize;\r\n    definition.initialize = function () {\r\n      oldInit && oldInit.call(this);\r\n      this._internal.borderRadius = { ...defaults };\r\n      if (defaults.borderRadius) this._updateCornerRadii();\r\n    };\r\n  },\r\n  addBorderInputs(definition, opts) {\r\n    opts = opts || {};\r\n    const defaults = opts.defaults || {};\r\n    const styleTag = opts.styleTag;\r\n\r\n    if (defaults.borderStyle === undefined) defaults.borderStyle = 'none';\r\n    if (defaults.borderWidth === undefined) defaults.borderWidth = 2;\r\n    if (defaults.borderColor === undefined) defaults.borderColor = '#000000';\r\n\r\n    function defineBorderTab(definition, suffix, tabName, indexOffset) {\r\n      const styleName = `border${suffix}Style`;\r\n      const widthName = `border${suffix}Width`;\r\n      const colorName = `border${suffix}Color`;\r\n\r\n      let orNotSet = defaults.borderStyle !== 'none' ? 'OR borderStyle NOT SET' : '';\r\n\r\n      if (suffix) {\r\n        if (defaults[styleName] && defaults[styleName] !== 'none') orNotSet += `OR ${styleName} NOT SET`;\r\n        addDynamicInputPorts(\r\n          definition,\r\n          `${styleName} = solid OR ${styleName} = dashed OR ${styleName} = dotted OR borderStyle = solid OR borderStyle = dashed OR borderStyle = dotted ${orNotSet}`,\r\n          [`${widthName}`, `${colorName}`]\r\n        );\r\n      } else {\r\n        addDynamicInputPorts(\r\n          definition,\r\n          `${styleName} = solid OR ${styleName} = dashed OR ${styleName} = dotted ${orNotSet}`,\r\n          [`${widthName}`, `${colorName}`]\r\n        );\r\n      }\r\n\r\n      const tab = { group: 'border-styles', tab: tabName, label: suffix };\r\n\r\n      const nameWithTab = (name) => `${name} ${suffix ? '(' + suffix + ')' : ''}`;\r\n      const index = 202 + indexOffset * 4;\r\n\r\n      addInputs(definition, {\r\n        [styleName]: {\r\n          index: index + 1,\r\n          displayName: 'Border Style',\r\n          editorName: nameWithTab('Border Style'),\r\n          group: 'Border Style',\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: 'enum',\r\n            enums: [\r\n              { label: 'None', value: 'none' },\r\n              { label: 'Solid', value: 'solid' },\r\n              { label: 'Dotted', value: 'dotted' },\r\n              { label: 'Dashed', value: 'dashed' }\r\n            ]\r\n          },\r\n          default: defaults[styleName],\r\n          tab,\r\n          set(value) {\r\n            this._internal.borders[styleName] = value;\r\n            this._updateBorders();\r\n          }\r\n        },\r\n        [widthName]: {\r\n          index: index + 2,\r\n          displayName: 'Border Width',\r\n          editorName: nameWithTab('Border Width'),\r\n          group: 'Border Style',\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: 'number',\r\n            units: ['px'],\r\n            defaultUnit: 'px'\r\n          },\r\n          default: defaults[widthName],\r\n          tab,\r\n          set(value) {\r\n            this._internal.borders[widthName] =\r\n              value.value === undefined ? Number(value) + 'px' : value.value + value.unit;\r\n            this._updateBorders();\r\n          }\r\n        },\r\n        [colorName]: {\r\n          index: index + 3,\r\n          displayName: 'Border Color',\r\n          editorName: nameWithTab('Border Color'),\r\n          group: 'Border Style',\r\n          type: 'color',\r\n          default: defaults[colorName],\r\n          allowVisualStates: true,\r\n          tab,\r\n          set(value) {\r\n            this._internal.borders[colorName] = value;\r\n            this._updateBorders();\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    defineBorderTab(definition, '', 'borders-all', 0);\r\n    defineBorderTab(definition, 'Left', 'borders-left', 1);\r\n    defineBorderTab(definition, 'Top', 'borders-top', 2);\r\n    defineBorderTab(definition, 'Right', 'borders-right', 3);\r\n    defineBorderTab(definition, 'Bottom', 'borders-bottom', 4);\r\n\r\n    definition.methods._updateBorders = function () {\r\n      const b = this._internal.borders;\r\n\r\n      function setBorder(style, group) {\r\n        const width = `border${group}Width`;\r\n        const color = `border${group}Color`;\r\n        const borderStyle = `border${group}Style`;\r\n\r\n        style[width] = b[width] || b.borderWidth;\r\n        style[color] = b[color] || b.borderColor;\r\n        style[borderStyle] = b[borderStyle] || b.borderStyle;\r\n      }\r\n\r\n      const style = {};\r\n      setBorder(style, 'Top');\r\n      setBorder(style, 'Right');\r\n      setBorder(style, 'Bottom');\r\n      setBorder(style, 'Left');\r\n\r\n      this.setStyle(style, styleTag);\r\n    };\r\n\r\n    const oldInit = definition.initialize;\r\n    definition.initialize = function () {\r\n      oldInit && oldInit.call(this);\r\n      this._internal.borders = { ...defaults };\r\n\r\n      const hasDefaultBorders =\r\n        defaults.borderStyle !== 'none' ||\r\n        (defaults.borderTopStyle && defaults.borderTopStyle !== 'none') ||\r\n        (defaults.borderRightStyle && defaults.borderRightStyle !== 'none') ||\r\n        (defaults.borderBottomStyle && defaults.borderBottomStyle !== 'none') ||\r\n        (defaults.borderRightStyle && defaults.borderRightStyle !== 'none');\r\n\r\n      if (hasDefaultBorders) this._updateBorders();\r\n    };\r\n\r\n    this._addCornerRadius(definition, { defaults, styleTag });\r\n  },\r\n  addShadowInputs(definition, args) {\r\n    args = args || {};\r\n    const styleTag = args.styleTag;\r\n\r\n    addDynamicInputPorts(definition, 'boxShadowEnabled = true', [\r\n      'boxShadowOffsetX',\r\n      'boxShadowOffsetY',\r\n      'boxShadowInset',\r\n      'boxShadowBlurRadius',\r\n      'boxShadowSpreadRadius',\r\n      'boxShadowColor'\r\n    ]);\r\n\r\n    addInputs(definition, {\r\n      boxShadowEnabled: {\r\n        index: 250,\r\n        group: 'Box Shadow',\r\n        displayName: 'Shadow Enabled',\r\n        type: 'boolean',\r\n        default: false,\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowEnabled = value;\r\n          this._updateBoxShadow();\r\n        }\r\n      },\r\n      boxShadowOffsetX: {\r\n        index: 251,\r\n        group: 'Box Shadow',\r\n        displayName: 'Offset X',\r\n        default: 0,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px'\r\n        },\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowOffsetX = value.value + value.unit;\r\n          this._updateBoxShadow();\r\n        }\r\n      },\r\n      boxShadowOffsetY: {\r\n        index: 252,\r\n        group: 'Box Shadow',\r\n        displayName: 'Offset Y',\r\n        default: 0,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px'\r\n        },\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowOffsetY = value.value + value.unit;\r\n          this._updateBoxShadow();\r\n        }\r\n      },\r\n      boxShadowBlurRadius: {\r\n        index: 253,\r\n        group: 'Box Shadow',\r\n        displayName: 'Blur Radius',\r\n        default: 5,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px'\r\n        },\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowBlurRadius = value.value + value.unit;\r\n          this._updateBoxShadow();\r\n        }\r\n      },\r\n      boxShadowSpreadRadius: {\r\n        index: 254,\r\n        group: 'Box Shadow',\r\n        displayName: 'Spread Radius',\r\n        default: 2,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px'\r\n        },\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowSpreadRadius = value.value + value.unit;\r\n          this._updateBoxShadow();\r\n        }\r\n      },\r\n      boxShadowInset: {\r\n        index: 255,\r\n        group: 'Box Shadow',\r\n        displayName: 'Inset',\r\n        type: 'boolean',\r\n        default: false,\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowInset = value;\r\n          this._updateBoxShadow();\r\n        }\r\n      },\r\n      boxShadowColor: {\r\n        index: 256,\r\n        group: 'Box Shadow',\r\n        displayName: 'Shadow Color',\r\n        type: 'color',\r\n        default: '#00000033',\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowColor = value;\r\n          this._updateBoxShadow();\r\n        }\r\n      }\r\n    });\r\n\r\n    definition.methods._updateBoxShadow = function () {\r\n      const internal = this._internal;\r\n\r\n      if (internal.boxShadowEnabled) {\r\n        this.setStyle(\r\n          {\r\n            boxShadow: `${internal.boxShadowInset ? 'inset ' : ''}${internal.boxShadowOffsetX} ${\r\n              internal.boxShadowOffsetY\r\n            } ${internal.boxShadowBlurRadius} ${internal.boxShadowSpreadRadius} ${internal.boxShadowColor}`\r\n          },\r\n          styleTag\r\n        );\r\n      } else {\r\n        this.removeStyle(['boxShadow'], styleTag);\r\n      }\r\n    };\r\n\r\n    const oldInit = definition.initialize;\r\n    definition.initialize = function () {\r\n      oldInit && oldInit.call(this);\r\n      this._internal.boxShadowOffsetX = 0;\r\n      this._internal.boxShadowOffsetY = 0;\r\n      this._internal.boxShadowBlurRadius = '5px';\r\n      this._internal.boxShadowSpreadRadius = '2px';\r\n      this._internal.boxShadowColor = '#00000033';\r\n    };\r\n  },\r\n  addIconInputs(definition, args) {\r\n    args = args || {};\r\n\r\n    const index = 20;\r\n\r\n    const defaults = {\r\n      useIcon: true,\r\n      iconColor: '#FFFFFF'\r\n    };\r\n\r\n    if (args.defaults) {\r\n      Object.assign(defaults, args.defaults);\r\n    }\r\n\r\n    let useIconCondition = 'useIcon = true';\r\n    if (defaults.useIcon) {\r\n      useIconCondition += ' OR useIcon NOT SET';\r\n    }\r\n\r\n    const useIconPorts = ['iconSourceType', 'iconSize'];\r\n    if (args.enableIconPlacement) {\r\n      useIconPorts.push('iconPlacement');\r\n      useIconPorts.push('iconSpacing');\r\n    }\r\n\r\n    addDynamicInputPorts(definition, useIconCondition, useIconPorts);\r\n\r\n    if (defaults.useIcon) {\r\n      addDynamicInputPorts(\r\n        definition,\r\n        \"#js (params.useIcon===true || params.useIcon===undefined) && params.iconSourceType === 'image'\",\r\n        ['iconImageSource']\r\n      );\r\n      addDynamicInputPorts(\r\n        definition,\r\n        \"#js (params.useIcon===true || params.useIcon===undefined) && params.iconSourceType === 'icon'\",\r\n        ['iconIconSource', 'iconColor']\r\n      );\r\n    } else {\r\n      addDynamicInputPorts(definition, 'useIcon = true AND iconSourceType = image', ['iconImageSource']);\r\n      addDynamicInputPorts(definition, 'useIcon = true AND iconSourceType = icon', ['iconIconSource', 'iconColor']);\r\n    }\r\n\r\n    if (!args.hideEnableIconInput) {\r\n      addInputProps(definition, {\r\n        useIcon: {\r\n          type: 'boolean',\r\n          group: 'Icon',\r\n          displayName: 'Enable Icon',\r\n          default: defaults.useIcon,\r\n          allowVisualStates: true,\r\n          index: index\r\n        }\r\n      });\r\n    }\r\n\r\n    addInputProps(definition, {\r\n      iconSourceType: {\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'Image', value: 'image' },\r\n            { label: 'Icon', value: 'icon' }\r\n          ]\r\n        },\r\n        group: 'Icon',\r\n        displayName: 'Type',\r\n        default: 'icon',\r\n        allowVisualStates: true,\r\n        index: index + 1\r\n      },\r\n      iconIconSource: {\r\n        type: 'icon',\r\n        displayName: 'Icon Source',\r\n        group: 'Icon',\r\n        allowVisualStates: true,\r\n        index: index + 3\r\n      }\r\n    });\r\n\r\n    addInputs(definition, {\r\n      iconImageSource: {\r\n        type: 'image',\r\n        displayName: 'Image Source',\r\n        group: 'Icon',\r\n        allowVisualStates: true,\r\n        index: index + 2,\r\n        set(iconImageSource) {\r\n          this.props.iconImageSource = getAbsoluteUrl(iconImageSource);\r\n        }\r\n      }\r\n    });\r\n\r\n    if (args.enableIconPlacement) {\r\n      addInputProps(definition, {\r\n        iconSpacing: {\r\n          group: 'Icon',\r\n          displayName: 'Spacing',\r\n          default: 10,\r\n          type: {\r\n            name: 'number',\r\n            units: ['px'],\r\n            defaultUnit: 'px'\r\n          },\r\n          allowVisualStates: true,\r\n          index: index + 4\r\n        },\r\n        iconPlacement: {\r\n          type: {\r\n            name: 'enum',\r\n            enums: [\r\n              { label: 'Left', value: 'left' },\r\n              { label: 'Right', value: 'right' }\r\n            ]\r\n          },\r\n          group: 'Icon',\r\n          displayName: 'Placement',\r\n          default: 'left',\r\n          allowVisualStates: true,\r\n          index: index + 5\r\n        }\r\n      });\r\n    }\r\n\r\n    addInputProps(definition, {\r\n      iconSize: {\r\n        group: 'Icon',\r\n        displayName: 'Size',\r\n        default: 16,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px'\r\n        },\r\n        allowVisualStates: true,\r\n        index: index + 6\r\n      },\r\n      iconColor: {\r\n        group: 'Icon',\r\n        displayName: 'Color',\r\n        editorName: 'Icon Color',\r\n        default: defaults.iconColor,\r\n        type: 'color',\r\n        allowVisualStates: true,\r\n        index: index + 7\r\n      }\r\n    });\r\n  },\r\n\r\n  addLabelInputs(definition, args) {\r\n    args = args || {};\r\n\r\n    const defaults = {\r\n      useLabel: false\r\n    };\r\n\r\n    if (args.defaults) {\r\n      Object.assign(defaults, args.defaults);\r\n    }\r\n\r\n    const condition = defaults.useLabel ? 'useLabel = true OR useLabel NOT SET' : 'useLabel = true';\r\n\r\n    const textStylePortPrefix = args.styleTag || '';\r\n\r\n    const ports = ['label'].concat(\r\n      ['textStyle', 'fontFamily', 'fontSize', 'color', 'letterSpacing', 'lineHeight', 'textTransform'].map(\r\n        (port) => textStylePortPrefix + port\r\n      )\r\n    );\r\n    if (args.enableSpacing) {\r\n      ports.push('labelSpacing');\r\n    }\r\n\r\n    addDynamicInputPorts(definition, condition, ports);\r\n\r\n    addInputProps(definition, {\r\n      useLabel: {\r\n        index: 18,\r\n        type: 'boolean',\r\n        displayName: 'Enable Label',\r\n        group: 'Label',\r\n        default: defaults.useLabel\r\n      },\r\n      label: {\r\n        type: 'string',\r\n        displayName: 'Label',\r\n        group: 'Label',\r\n        default: 'Label'\r\n      }\r\n    });\r\n\r\n    if (args.enableSpacing) {\r\n      addInputProps(definition, {\r\n        labelSpacing: {\r\n          displayName: 'Spacing',\r\n          group: 'Label',\r\n          type: {\r\n            name: 'number',\r\n            units: ['px'],\r\n            defaultUnit: 'px'\r\n          },\r\n          default: 10\r\n        }\r\n      });\r\n    }\r\n\r\n    this.addTextStyleInputs(definition, {\r\n      ...args,\r\n      group: 'Label Text Style',\r\n      popout: {\r\n        group: 'label-text-style',\r\n        label: 'Text Style',\r\n        parentGroup: 'Label'\r\n      }\r\n    });\r\n  },\r\n\r\n  addTextStyleInputs(definition, args) {\r\n    args = args || {};\r\n\r\n    const group = args.group || 'Text Style';\r\n    const styleTag = args.styleTag;\r\n\r\n    const portPrefix = args.hasOwnProperty('portPrefix') ? args.portPrefix : args.styleTag || '';\r\n\r\n    const textStyleInputName = portPrefix + 'textStyle';\r\n\r\n    const index = args.portIndex !== undefined ? args.portIndex : 19;\r\n\r\n    function prettyName(name) {\r\n      return args.displayName ? args.displayName + ' ' + name : name;\r\n    }\r\n\r\n    addInputs(definition, {\r\n      [textStyleInputName]: {\r\n        index: index,\r\n        type: {\r\n          name: 'textStyle',\r\n          childPorts: ['fontFamily', 'fontSize', 'color', 'letterSpacing', 'lineHeight', 'textTransform'],\r\n          childPortPrefix: portPrefix\r\n        },\r\n        group: group,\r\n        displayName: 'Text Style',\r\n        editorName: prettyName('Text Style'),\r\n        default: 'None',\r\n        set(value) {\r\n          this.props[textStyleInputName] = this.context.styles.getTextStyle(value);\r\n          this.forceUpdate();\r\n        },\r\n        allowVisualStates: true,\r\n        popout: args.popout\r\n      },\r\n      [portPrefix + 'fontFamily']: {\r\n        index: index + 1,\r\n        type: {\r\n          name: 'font',\r\n          parentPort: textStyleInputName\r\n        },\r\n        group: group,\r\n        displayName: 'Font Family',\r\n        editorName: prettyName('Font Family'),\r\n        set(value) {\r\n          if (value) {\r\n            let family = value;\r\n            if (family.split('.').length > 1) {\r\n              FontLoader.instance.loadFont(family);\r\n              family = family.replace(/\\.[^/.]+$/, '');\r\n              family = family.split('/').pop();\r\n            }\r\n            this.setStyle({ fontFamily: family }, styleTag);\r\n          } else {\r\n            this.removeStyle(['fontFamily'], styleTag);\r\n          }\r\n\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        },\r\n        allowVisualStates: true,\r\n        popout: args.popout\r\n      }\r\n    });\r\n\r\n    addInputCss(definition, {\r\n      [portPrefix + 'fontSize']: {\r\n        index: index + 2,\r\n        group: group,\r\n        displayName: 'Font Size',\r\n        editorName: prettyName('Font Size'),\r\n        targetStyleProperty: 'fontSize',\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px',\r\n          parentPort: textStyleInputName\r\n        },\r\n        onChange() {\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        },\r\n        allowVisualStates: true,\r\n        popout: args.popout,\r\n        styleTag\r\n      },\r\n      [portPrefix + 'color']: {\r\n        index: index + 3,\r\n        type: {\r\n          name: 'color',\r\n          parentPort: textStyleInputName\r\n        },\r\n        displayName: 'Color',\r\n        editorName: prettyName('Color'),\r\n        group: group,\r\n        targetStyleProperty: 'color',\r\n        allowVisualStates: true,\r\n        popout: args.popout,\r\n        styleTag,\r\n        onChange() {\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        }\r\n      },\r\n      [portPrefix + 'letterSpacing']: {\r\n        index: index + 4,\r\n        group: group,\r\n        displayName: 'Letter Spacing',\r\n        editorName: prettyName('Letter Spacing'),\r\n        targetStyleProperty: 'letterSpacing',\r\n        type: {\r\n          name: 'number',\r\n          units: ['px', 'em'],\r\n          defaultUnit: 'px'\r\n        },\r\n        allowVisualStates: true,\r\n        popout: args.popout,\r\n        styleTag,\r\n        default: 'Auto',\r\n        applyDefault: false,\r\n        onChange() {\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        }\r\n      },\r\n      [portPrefix + 'lineHeight']: {\r\n        index: index + 5,\r\n        group: group,\r\n        displayName: 'Line Height',\r\n        editorName: prettyName('Line Height'),\r\n        targetStyleProperty: 'lineHeight',\r\n        type: {\r\n          name: 'number',\r\n          units: ['', 'px', '%'],\r\n          defaultUnit: '',\r\n          parentPort: textStyleInputName\r\n        },\r\n        allowVisualStates: true,\r\n        onChange() {\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        },\r\n        popout: args.popout,\r\n        styleTag,\r\n        default: 'Auto',\r\n        applyDefault: false\r\n      },\r\n      [portPrefix + 'textTransform']: {\r\n        index: index + 6,\r\n        group: group,\r\n        displayName: 'Case',\r\n        editorName: prettyName('Case'),\r\n        applyDefault: false,\r\n        targetStyleProperty: 'textTransform',\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'None', value: 'none' },\r\n            { label: 'Uppercase', value: 'uppercase' },\r\n            { label: 'Lowercase', value: 'lowercase' },\r\n            { label: 'Capitalize', value: 'capitalize' }\r\n          ],\r\n          parentPort: textStyleInputName\r\n        },\r\n        default: 'none',\r\n        popout: args.popout,\r\n        styleTag,\r\n        allowVisualStates: true,\r\n        onChange() {\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    const fontFamilyPort = portPrefix + 'fontFamily';\r\n\r\n    definition.setup = function (context, graphModel) {\r\n      graphModel.on('nodeAdded.' + definition.name, function (node) {\r\n        if (node.parameters[fontFamilyPort] && node.parameters[fontFamilyPort].split('.').length > 1) {\r\n          FontLoader.instance.loadFont(node.parameters[fontFamilyPort]);\r\n        }\r\n        node.on('parameterUpdated', function (event) {\r\n          if (event.name === fontFamilyPort && event.value) {\r\n            if (event.value.split('.').length > 1) {\r\n              FontLoader.instance.loadFont(event.value);\r\n            }\r\n          }\r\n        });\r\n      });\r\n    };\r\n  }\r\n};\r\n\r\nfunction addDimensionTooltips(definition, contentLabel) {\r\n  definition.inputProps.sizeMode.tooltip = {\r\n    explicit: {\r\n      standard: 'Explicit width & height',\r\n      extended: createTooltip({\r\n        title: 'Explicit width & height',\r\n        body: 'Set width & height explicitly in pixels(px), percentage(%) or viewport size(vh/vw).',\r\n        images: [{ src: 'size-mode-explicit.svg' }]\r\n      })\r\n    },\r\n    contentWidth: {\r\n      standard: `${contentLabel} width & explicit height`,\r\n      extended: createTooltip({\r\n        title: `${contentLabel} width & explicit height`,\r\n        body: `The width will match the width of the ${contentLabel.toLowerCase()}. Height is set explicitly.`,\r\n        images: [{ src: 'size-mode-content-width.svg' }]\r\n      })\r\n    },\r\n    contentHeight: {\r\n      standard: `Explicit width & ${contentLabel.toLowerCase()} height`,\r\n      extended: createTooltip({\r\n        title: `Explicit width & ${contentLabel.toLowerCase()} height`,\r\n        body: `The width is set explicitly. The height will match the height of the ${contentLabel.toLowerCase()}`,\r\n        images: [{ src: 'size-mode-content-height.svg' }]\r\n      })\r\n    },\r\n    contentSize: {\r\n      standard: `${contentLabel} width & height`,\r\n      extended: createTooltip({\r\n        title: `${contentLabel} width & height`,\r\n        body: `The width and height will match the size of the ${contentLabel.toLowerCase()}`,\r\n        images: [{ src: 'size-mode-content-size.svg' }]\r\n      })\r\n    }\r\n  };\r\n\r\n  const unitsBodyText = [\r\n    \"- %: Relative to parents size. If 'fixed' is false this element will resize to share space with siblings. If 'Clip Content' is disabled, it'll also expand to fit the boundaries of all its content\",\r\n    '- px: Pixels',\r\n    '- vw: Relative to viewport width. 100 makes the element the same width as the screen',\r\n    '- vh: Relative to viewport height. 100 makes the element the same height as the screen'\r\n  ];\r\n\r\n  const fixedTooltip = createTooltip({\r\n    title: 'Fixed',\r\n    body: [\r\n      '- Enabled: Elements will be the exact size set',\r\n      '- Disabled: Element will resize to fill up empty space, or shrink to make space for siblings. Use the dimension constraints, min and max size, to control the boundaries'\r\n    ]\r\n  });\r\n\r\n  definition.inputProps.width.tooltip = {\r\n    dimension: createTooltip({\r\n      title: 'Width',\r\n      body: unitsBodyText\r\n    }),\r\n    fixed: fixedTooltip\r\n  };\r\n\r\n  definition.inputProps.height.tooltip = {\r\n    dimension: createTooltip({\r\n      title: 'Height',\r\n      body: unitsBodyText\r\n    }),\r\n    fixed: fixedTooltip\r\n  };\r\n}\r\n\r\nfunction addDimensionConstraintsTooltips(definition) {\r\n  definition.inputCss.minWidth.tooltip = createTooltip({\r\n    title: 'Minimum width',\r\n    body: \"This is prioritized over other properties, so the element won't shrink below this size\"\r\n  });\r\n\r\n  definition.inputCss.minHeight.tooltip = createTooltip({\r\n    title: 'Minimum height',\r\n    body: \"This is prioritized over other properties, so the element won't shrink below this size\"\r\n  });\r\n\r\n  definition.inputCss.maxWidth.tooltip = createTooltip({\r\n    title: 'Maximum width',\r\n    body: \"This is prioritized over other properties, so the element won't grow beyond this size\"\r\n  });\r\n\r\n  definition.inputCss.maxHeight.tooltip = createTooltip({\r\n    title: 'Maximum height',\r\n    body: \"This is prioritized over other properties, so the element won't grow beyond this size\"\r\n  });\r\n}\r\n\r\nfunction addPointerEventsTooltips(definition) {\r\n  definition.inputs.pointerEventsMode.tooltip = createTooltip({\r\n    title: 'Pointer events mode',\r\n    body: [\r\n      'Control if mouse and touch events are enabled on this node',\r\n      '- Inherit: Same settings as parent',\r\n      '- Explicit: Enable control on this element'\r\n    ]\r\n  });\r\n  definition.inputs.pointerEventsEnabled.tooltip = createTooltip({\r\n    title: 'Pointer events enabled',\r\n    body: [\r\n      '- Enabled: This element will receive mouse and touch events',\r\n      '- Disabled: No mouse or touch events will be captured by this element and the element below will receive it instead'\r\n    ]\r\n  });\r\n}\r\n\r\nfunction addPositionAndAlignTooltips(definition) {\r\n  definition.inputCss.position.tooltip = createTooltip({\r\n    title: 'Position',\r\n    images: [\r\n      {\r\n        label: 'Relative',\r\n        body: 'Relative to its siblings',\r\n        src: 'position-relative.svg'\r\n      },\r\n      {\r\n        label: 'Absolute',\r\n        body: \"Not affected by siblings or parent's layout\",\r\n        src: 'position-absolute.svg'\r\n      },\r\n      {\r\n        label: 'Sticky',\r\n        body: \"Stick to parent's edge on overflow\",\r\n        src: 'position-sticky.svg'\r\n      },\r\n      {\r\n        label: 'Fixed',\r\n        body: 'Always stay in the same place and take no space in the layout',\r\n        src: 'position-sticky.svg'\r\n      }\r\n    ]\r\n  });\r\n}\r\n","import BezierEasing from 'bezier-easing';\r\n\r\nconst EaseCurves = require('./easecurves');\r\n\r\nexport default function transitionParameter(node, name, endValue, transition) {\r\n  if (node._transitions && node._transitions[name]) {\r\n    node._transitions[name].stop();\r\n    delete node._transitions[name];\r\n  }\r\n\r\n  const startValue = node.getInputValue(name);\r\n\r\n  const input = node.getInput(name);\r\n\r\n  let animation;\r\n\r\n  if (input && input.type === 'color') {\r\n    animation = colorAnimation(\r\n      node.context.styles.resolveColor(startValue),\r\n      node.context.styles.resolveColor(endValue)\r\n    );\r\n  } else if (typeof startValue === 'number' && typeof endValue === 'number') {\r\n    animation = numberAnimation(startValue, endValue);\r\n  } else if (\r\n    typeof startValue === 'object' &&\r\n    startValue.hasOwnProperty('value') &&\r\n    typeof endValue === 'object' &&\r\n    endValue.hasOwnProperty('value')\r\n  ) {\r\n    animation = numberAnimation(startValue.value, endValue.value);\r\n  }\r\n\r\n  if (animation) {\r\n    if (!node._transitions) node._transitions = {};\r\n\r\n    const ease = BezierEasing(transition.curve);\r\n\r\n    node._transitions[name] = node.context.timerScheduler.createTimer({\r\n      duration: transition.dur,\r\n      onRunning: (t) => {\r\n        const v = animation(ease.get(t));\r\n        node.queueInput(name, v);\r\n      },\r\n      onFinish: () => {\r\n        delete node._transitions[name];\r\n      }\r\n    });\r\n\r\n    node._transitions[name].start();\r\n  } else {\r\n    //no transition supported for this parameter type, so just set it\r\n    node.queueInput(name, endValue);\r\n  }\r\n}\r\n\r\nfunction numberAnimation(start, end) {\r\n  return (t) => {\r\n    return EaseCurves.linear(start, end, t);\r\n  };\r\n}\r\n\r\nfunction setRGBA(result, hex) {\r\n  if (hex === 'transparent' || !hex) {\r\n    result[3] = 0;\r\n    return;\r\n  }\r\n\r\n  const numComponents = (hex.length - 1) / 2;\r\n\r\n  for (let i = 0; i < numComponents; ++i) {\r\n    const index = 1 + i * 2;\r\n    result[i] = parseInt(hex.substring(index, index + 2), 16);\r\n  }\r\n}\r\n\r\nfunction componentToHex(c) {\r\n  var hex = c.toString(16);\r\n  return hex.length == 1 ? '0' + hex : hex;\r\n}\r\n\r\nfunction rgbaToHex(rgba) {\r\n  return '#' + componentToHex(rgba[0]) + componentToHex(rgba[1]) + componentToHex(rgba[2]) + componentToHex(rgba[3]);\r\n}\r\n\r\nfunction colorAnimation(start, end) {\r\n  const rgba0 = [0, 0, 0, 255];\r\n  setRGBA(rgba0, start);\r\n\r\n  const rgba1 = [0, 0, 0, 255];\r\n  setRGBA(rgba1, end);\r\n\r\n  if (!start || start === 'transparent') {\r\n    rgba0[0] = rgba1[0];\r\n    rgba0[1] = rgba1[1];\r\n    rgba0[2] = rgba1[2];\r\n  }\r\n  if (!end || end === 'transparent') {\r\n    rgba1[0] = rgba0[0];\r\n    rgba1[1] = rgba0[1];\r\n    rgba1[2] = rgba0[2];\r\n  }\r\n\r\n  const rgba = [0, 0, 0, 0];\r\n\r\n  return (t) => {\r\n    rgba[0] = Math.floor(EaseCurves.linear(rgba0[0], rgba1[0], t));\r\n    rgba[1] = Math.floor(EaseCurves.linear(rgba0[1], rgba1[1], t));\r\n    rgba[2] = Math.floor(EaseCurves.linear(rgba0[2], rgba1[2], t));\r\n    rgba[3] = Math.floor(EaseCurves.linear(rgba0[3], rgba1[3], t));\r\n\r\n    return rgbaToHex(rgba);\r\n  };\r\n}\r\n","'use strict';\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport DOMBoundingBoxObserver from './dom-boundingbox-oberver';\r\nimport Layout from './layout';\r\nimport mergeDeep from './mergedeep';\r\nimport NodeSharedPortDefinitions from './node-shared-port-definitions';\r\nimport transitionParameter from './node-transitions';\r\n\r\nfunction addOutputPropHandler(node, propCallbacks, propPath) {\r\n  const props = propPath ? node.props[propPath] : node.props;\r\n\r\n  for (const propName in propCallbacks) {\r\n    if (props[propName]) {\r\n      const prevCb = props[propName];\r\n      props[propName] = () => {\r\n        prevCb();\r\n        propCallbacks[propName].call(node);\r\n      };\r\n    } else {\r\n      props[propName] = propCallbacks[propName].bind(node);\r\n    }\r\n  }\r\n  node.forceUpdate();\r\n}\r\n\r\nfunction addPrimitiveOutputPropHandler(node, name, output) {\r\n  let prop;\r\n\r\n  if (output.type === 'signal') {\r\n    prop = () => {\r\n      node.sendSignalOnOutput(name);\r\n    };\r\n  } else {\r\n    prop = (...args) => {\r\n      node.outputPropValues[name] = output.getValue ? output.getValue.call(node, ...args) : args[0];\r\n      node.flagOutputDirty(name);\r\n      output.onChange && output.onChange.call(node, node.outputPropValues[name]);\r\n    };\r\n  }\r\n\r\n  addOutputPropHandler(node, { [name]: prop }, output.propPath);\r\n}\r\n\r\nfunction defineRegularInputProp(input, name) {\r\n  if (!input.type) throw new Error(`input ${name} is missing a type`);\r\n\r\n  if (input.type.units) {\r\n    input.set = function (value) {\r\n      const props = input.propPath ? this.props[input.propPath] : this.props;\r\n      if (value && value.value !== undefined) {\r\n        props[name] = value.value + value.unit;\r\n      } else {\r\n        delete props[name];\r\n      }\r\n      if (input.onChange) {\r\n        input.onChange.call(this, value);\r\n      }\r\n      this.forceUpdate();\r\n    };\r\n  } else {\r\n    input.set = function (value) {\r\n      const props = input.propPath ? this.props[input.propPath] : this.props;\r\n      if (value !== undefined) {\r\n        props[name] = value;\r\n      } else {\r\n        delete props[name];\r\n      }\r\n      if (input.onChange) {\r\n        input.onChange.call(this, value);\r\n      }\r\n      this.forceUpdate();\r\n    };\r\n  }\r\n}\r\n\r\nfunction flattenArray(target, array) {\r\n  for (const e of array) {\r\n    if (Array.isArray(e)) {\r\n      flattenArray(target, e);\r\n    } else if (e !== undefined) {\r\n      target.push(e);\r\n    }\r\n  }\r\n}\r\n\r\nclass NoodlReactComponent extends React.Component {\r\n  componentDidMount() {\r\n    this.props.noodlNode.sendSignalOnOutput('didMount');\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.noodlNode.sendSignalOnOutput('willUnmount');\r\n    //Remove\r\n    const noodlNode = this.props.noodlNode;\r\n    if (noodlNode.currentVisualStates) {\r\n      const statesToRemove = ['hover', 'pressed', 'focused'];\r\n      const vs = noodlNode.currentVisualStates.filter((s) => !statesToRemove.includes(s));\r\n      noodlNode.setVisualStates(vs);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    //So the props are a bit tricky here...\r\n    //this.props consist of:\r\n    // - the props passed by the ReactComponentNode.render() function, just {noodlNode}\r\n    // - any additional third party props coming from the parent react component.\r\n    //E.g. the drag node adds event handlers, style, and className to this.props.\r\n\r\n    const { noodlNode, style, ...otherProps } = this.props;\r\n\r\n    let finalStyle = noodlNode.style;\r\n\r\n    //check if there's additional styling from the react parent\r\n    //if so, we need to combine it with the style from the Noodl node\r\n    //let the extra style take priority over the noodl style, if they share some attributes\r\n    //this is wrapped in an if for performance reasons, \"...\" is quite slow\r\n    if (style) {\r\n      finalStyle = {\r\n        ...noodlNode.style, //styling from the noodl node\r\n        ...style //styling from the react component parent\r\n      };\r\n    }\r\n\r\n    const props = {\r\n      ref: (ref) => {\r\n        noodlNode.innerReactComponentRef = ref;\r\n      },\r\n      style: finalStyle,\r\n      //the noodl props coming from the node\r\n      //some components actually have a \"style\" used for something other than css,\r\n      //so make sure this comes after the \"style\" prop above, so it can overwrite it\r\n      //(e.g. Jesper's Icon Material UI)\r\n      ...noodlNode.props,\r\n\r\n      //otherProps can be empty, but some react components add additional props to their children\r\n      ...otherProps\r\n    };\r\n\r\n    if (noodlNode.noodlNodeAsProp) {\r\n      props.noodlNode = noodlNode;\r\n\r\n      //nodes that want the noodlNode also get the parent layout\r\n      //since it's used by all built in nodes for layout purposes\r\n      const parent = noodlNode.getVisualParentNode();\r\n      if (parent && parent.props.layout) {\r\n        props.parentLayout = parent.props.layout;\r\n      }\r\n    }\r\n\r\n    //optimization. This is used by forceUpdate() to only render this node once per frame.\r\n    noodlNode.renderedAtFrame = noodlNode.context.frameNumber;\r\n\r\n    if (noodlNode.useFrame) {\r\n      if (props.textStyle !== undefined) {\r\n        // Apply text style\r\n        props.style = finalStyle = Object.assign({}, props.textStyle, finalStyle);\r\n      }\r\n      Layout.size(finalStyle, props);\r\n      Layout.align(finalStyle, props);\r\n\r\n      /*  if(finalStyle.opacity === 0) {\r\n                finalStyle.pointerEvents = 'none';\r\n            }*/\r\n    }\r\n\r\n    return React.createElement(noodlNode.reactComponent, props, noodlNode.renderChildren());\r\n  }\r\n}\r\n\r\nfunction setStylesOnDOMNode(rootElement, styles, styleTag) {\r\n  let element = rootElement;\r\n\r\n  if (styleTag) {\r\n    //check if the root element has the style tag, if not, find the child that does\r\n    if (element.getAttribute('noodl-style-tag') !== styleTag) {\r\n      element = rootElement.querySelector(`[noodl-style-tag=${styleTag}]`);\r\n    }\r\n  }\r\n\r\n  if (!element) return;\r\n\r\n  for (const p in styles) {\r\n    element.style[p] = styles[p];\r\n  }\r\n}\r\n\r\nlet reactKeyCounter = 0;\r\n\r\nfunction createNodeFromReactComponent(def) {\r\n  // visual frame props\r\n  const { frame } = def;\r\n  if (frame !== undefined) {\r\n    if (frame.dimensions) {\r\n      NodeSharedPortDefinitions.addDimensions(def, typeof frame.dimensions === 'object' ? frame.dimensions : undefined);\r\n    }\r\n\r\n    if (frame.position) NodeSharedPortDefinitions.addTransformInputs(def);\r\n\r\n    if (frame.margins) NodeSharedPortDefinitions.addMarginInputs(def);\r\n\r\n    if (frame.padding) NodeSharedPortDefinitions.addPaddingInputs(def);\r\n\r\n    if (frame.align) NodeSharedPortDefinitions.addAlignInputs(def);\r\n\r\n    //  NodeSharedPortDefinitions.addSharedVisualInputs(ReactComponentNode);\r\n\r\n    // NodeSharedPortDefinitions.addPointerEventOutputs(ReactComponentNode);\r\n  }\r\n\r\n  const {\r\n    initialize,\r\n    inputs,\r\n    inputProps,\r\n    inputCss,\r\n    outputs,\r\n    outputProps,\r\n    dynamicports,\r\n    defaultCss = {},\r\n    methods\r\n  } = def;\r\n\r\n  //assign default values to style\r\n  const startStyle = Object.assign({}, defaultCss);\r\n  const startStyles = {};\r\n\r\n  for (const name in inputCss) {\r\n    const input = inputCss[name];\r\n\r\n    const hasDefault = input.hasOwnProperty('default') && input.applyDefault !== false;\r\n    if (input.styleTag && !startStyles.hasOwnProperty(input.styleTag)) {\r\n      startStyles[input.styleTag] = {};\r\n    }\r\n\r\n    if (hasDefault) {\r\n      const value = input.type.units ? input.default + input.type.defaultUnit : input.default;\r\n      if (input.styleTag) {\r\n        startStyles[input.styleTag][name] = value;\r\n      } else {\r\n        startStyle[name] = value;\r\n      }\r\n    }\r\n  }\r\n\r\n  function boundingBoxObserverCallback(attribute, rect) {\r\n    this.clientBoundingRect = rect;\r\n    if (attribute === 'x') {\r\n      this.flagOutputDirty('screenPositionX');\r\n    } else if (attribute === 'y') {\r\n      this.flagOutputDirty('screenPositionY');\r\n    } else if (attribute === 'width') {\r\n      this.flagOutputDirty('boundingWidth');\r\n    } else if (attribute === 'height') {\r\n      this.flagOutputDirty('boundingHeight');\r\n    }\r\n  }\r\n\r\n  const useVariants = def.useVariants !== undefined ? def.useVariants : true;\r\n\r\n  const ReactComponentNode = {\r\n    name: def.name,\r\n    docs: def.docs,\r\n    displayNodeName: def.displayNodeName || def.displayName,\r\n    shortDesc: '',\r\n    category: 'Visual',\r\n    allowChildren: def.allowChildren === undefined ? true : def.allowChildren, //default to true\r\n    visualStates: def.visualStates,\r\n    allowAsExportRoot: def.allowAsExportRoot,\r\n    singleton: def.singleton,\r\n    useVariants,\r\n    usePortAsLabel: def.usePortAsLabel,\r\n    portLabelTruncationMode: def.portLabelTruncationMode,\r\n    connectionPanel: def.connectionPanel,\r\n    nodeDoubleClickAction: def.nodeDoubleClickAction,\r\n    initialize() {\r\n      this.reactKey = 'key' + reactKeyCounter;\r\n      reactKeyCounter++;\r\n\r\n      this.children = [];\r\n      if (hasChildCountOutput) {\r\n        this.childrenCount = 0;\r\n      }\r\n\r\n      this.props = { styles: {} };\r\n      this.outputPropValues = {};\r\n      this.style = Object.assign({}, startStyle);\r\n\r\n      for (const styleTag in startStyles) {\r\n        this.props.styles[styleTag] = Object.assign({}, startStyles[styleTag]);\r\n      }\r\n      this.childIndex = 0;\r\n      this.clientBoundingRect = {};\r\n      this.noodlNodeAsProp = def.noodlNodeAsProp ? true : false;\r\n\r\n      const pollDelay = this.context && this.context.runningInCanvas ? 300 : 0;\r\n      this.boundingBoxObserver = new DOMBoundingBoxObserver(boundingBoxObserverCallback.bind(this), pollDelay);\r\n\r\n      this.wantsToBeMounted = true;\r\n\r\n      this.useFrame = !!frame;\r\n\r\n      //assign default values to props\r\n      for (const name in inputProps) {\r\n        const input = inputProps[name];\r\n        if (input.propPath && !this.props.hasOwnProperty(input.propPath)) {\r\n          this.props[input.propPath] = {};\r\n        }\r\n\r\n        const props = input.propPath ? this.props[input.propPath] : this.props;\r\n\r\n        if (input.hasOwnProperty('default')) {\r\n          if (input.type.defaultUnit && input.default !== undefined) {\r\n            props[name] = input.default + input.type.defaultUnit;\r\n          } else {\r\n            props[name] = input.default;\r\n          }\r\n        }\r\n      }\r\n\r\n      //set ut props that send data on noodl outputs\r\n      for (const outputName in outputProps) {\r\n        const output = outputProps[outputName];\r\n        if (output.propPath && !this.props.hasOwnProperty(output.propPath)) {\r\n          this.props[output.propPath] = {};\r\n        }\r\n\r\n        if (!output.props) {\r\n          addPrimitiveOutputPropHandler(this, outputName, output);\r\n        } else {\r\n          addOutputPropHandler(this, output.props, output.propPath);\r\n        }\r\n      }\r\n\r\n      this.reactComponentRef = null;\r\n      this.reactComponent = def.getReactComponent.call(this);\r\n\r\n      if (initialize) {\r\n        initialize.call(this);\r\n      }\r\n    },\r\n    getInspectInfo: def.getInspectInfo,\r\n    nodeScopeDidInitialize: def.nodeScopeDidInitialize,\r\n    dynamicports,\r\n    inputs: {\r\n      cssClassName: {\r\n        index: 100010,\r\n        displayName: 'CSS Class',\r\n        group: 'Advanced HTML',\r\n        type: 'string',\r\n        default: '',\r\n        set(value) {\r\n          this.props.className = value;\r\n          this.forceUpdate();\r\n        }\r\n      },\r\n      styleCss: {\r\n        index: 100011,\r\n        displayName: 'CSS Style',\r\n        group: 'Advanced HTML',\r\n        type: {\r\n          name: 'string',\r\n          codeeditor: 'text',\r\n          allowEditOnly: true\r\n        },\r\n        default: '/* background-color: red; */',\r\n        set(value) {\r\n          this.updateAdvancedStyle({ content: value });\r\n        }\r\n      }\r\n    },\r\n    outputs: {\r\n      childIndex: {\r\n        displayName: 'Child Index',\r\n        type: 'number',\r\n        get() {\r\n          return this.childIndex;\r\n        }\r\n      },\r\n      this: {\r\n        displayName: 'This',\r\n        type: 'reference',\r\n        get() {\r\n          return this;\r\n        }\r\n      },\r\n      screenPositionX: {\r\n        group: 'Bounding Box',\r\n        displayName: 'Screen Position X',\r\n        type: 'number',\r\n        get() {\r\n          return this.clientBoundingRect.x;\r\n        },\r\n        onFirstConnectionAdded() {\r\n          this.boundingBoxObserver.addObserver();\r\n        },\r\n        onLastConnectionRemoved() {\r\n          this.boundingBoxObserver.removeObserver();\r\n        }\r\n      },\r\n      screenPositionY: {\r\n        group: 'Bounding Box',\r\n        displayName: 'Screen Position Y',\r\n        type: 'number',\r\n        get() {\r\n          return this.clientBoundingRect.y;\r\n        },\r\n        onFirstConnectionAdded() {\r\n          this.boundingBoxObserver.addObserver();\r\n        },\r\n        onLastConnectionRemoved() {\r\n          this.boundingBoxObserver.removeObserver();\r\n        }\r\n      },\r\n      boundingWidth: {\r\n        group: 'Bounding Box',\r\n        displayName: 'Width',\r\n        type: 'number',\r\n        get() {\r\n          return this.clientBoundingRect.width;\r\n        },\r\n        onFirstConnectionAdded() {\r\n          this.boundingBoxObserver.addObserver();\r\n        },\r\n        onLastConnectionRemoved() {\r\n          this.boundingBoxObserver.removeObserver();\r\n        }\r\n      },\r\n      boundingHeight: {\r\n        group: 'Bounding Box',\r\n        displayName: 'Height',\r\n        type: 'number',\r\n        get() {\r\n          return this.clientBoundingRect.height;\r\n        },\r\n        onFirstConnectionAdded() {\r\n          this.boundingBoxObserver.addObserver();\r\n        },\r\n        onLastConnectionRemoved() {\r\n          this.boundingBoxObserver.removeObserver();\r\n        }\r\n      },\r\n      didMount: {\r\n        group: 'Mounted',\r\n        displayName: 'Did Mount',\r\n        type: 'signal'\r\n      },\r\n      willUnmount: {\r\n        group: 'Mounted',\r\n        displayName: 'Will Unmount',\r\n        type: 'signal'\r\n      }\r\n    },\r\n    methods: {\r\n      updateAdvancedStyle(params) {\r\n        //remove previous styles first\r\n        if (this.customCssStyles) {\r\n          this.removeStyle(Object.keys(this.customCssStyles));\r\n          this.customCssStyles = undefined;\r\n        }\r\n\r\n        let style;\r\n        let errorMessage = '';\r\n\r\n        let rawCss = (params.content || '').replace('\\n', '');\r\n\r\n        // strip away comments\r\n        let css = '';\r\n        while (rawCss.length) {\r\n          let nextComment = rawCss.indexOf('/*');\r\n          if (nextComment === -1) {\r\n            nextComment = rawCss.length;\r\n          }\r\n          css += rawCss.substring(0, nextComment);\r\n          rawCss = rawCss.substring(nextComment);\r\n\r\n          if (rawCss.length) {\r\n            //were inside a comment\r\n            let endComment = rawCss.indexOf('*/');\r\n            if (endComment === -1) endComment = rawCss.length;\r\n            rawCss = rawCss.substring(endComment + 2);\r\n          }\r\n        }\r\n        function trim(s) {\r\n          return s.replace(/^\\s+|\\s+$/gm, '');\r\n        }\r\n\r\n        const styles = css\r\n          .split(';')\r\n          .map(trim)\r\n          .filter((s) => s.length);\r\n\r\n        style = {};\r\n        for (const s of styles) {\r\n          const parts = s.split(':').map(trim);\r\n\r\n          if (s.indexOf('\\n') !== -1) {\r\n            errorMessage += 'Missing semicolon: ' + s.split('\\n')[0];\r\n          } else if (parts.length !== 2) {\r\n            errorMessage += 'Syntax error: ' + s;\r\n          } else {\r\n            const nameParts = parts[0].split('-');\r\n            for (let i = 1; i < nameParts.length; i++) {\r\n              nameParts[i] = nameParts[i][0].toUpperCase() + nameParts[i].substring(1);\r\n            }\r\n            style[nameParts.join('')] = parts[1];\r\n          }\r\n        }\r\n\r\n        if (errorMessage) {\r\n          this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'css-parse-waring', {\r\n            message: 'Error in CSS Style<br>' + errorMessage\r\n          });\r\n        } else {\r\n          this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'css-parse-waring');\r\n          style && this.setStyle(style);\r\n          this.customCssStyles = style;\r\n        }\r\n      },\r\n      setChildIndex(index) {\r\n        this.childIndex = index;\r\n        this.flagOutputDirty('childIndex');\r\n      },\r\n      updateChildIndices() {\r\n        let indexOffset = 0;\r\n        for (let i = 0; i < this.children.length; i++) {\r\n          const child = this.children[i];\r\n          if (child.name === 'For Each' || child.name === 'Component Children') {\r\n            indexOffset--;\r\n          }\r\n          child.setChildIndex && child.setChildIndex(i + indexOffset);\r\n        }\r\n      },\r\n      updateChildrenCount() {\r\n        let count = 0;\r\n        this.children.forEach((child) => {\r\n          if (child?.model?.type === 'For Each') {\r\n            count += child.model.children.length;\r\n          } else {\r\n            count++;\r\n          }\r\n        });\r\n        this.childrenCount = count;\r\n        this.flagOutputDirty('childrenCount');\r\n      },\r\n      addChild(child, index) {\r\n        if (index === undefined) {\r\n          index = this.children.length;\r\n        }\r\n\r\n        child.parent = this;\r\n        this.children.splice(index, 0, child);\r\n        this.cachedChildren = undefined;\r\n        this.scheduleUpdateChildCountAndIndicies();\r\n        this.forceUpdate();\r\n      },\r\n      removeChild(child) {\r\n        const index = this.children.indexOf(child);\r\n        if (index !== -1) {\r\n          this.children.splice(index, 1);\r\n          child.parent = undefined;\r\n\r\n          this.cachedChildren = undefined;\r\n          this.scheduleUpdateChildCountAndIndicies();\r\n          this.forceUpdate();\r\n        }\r\n      },\r\n      contains(node) {\r\n        //breadth first\r\n        const index = this.children.indexOf(node);\r\n        if (index !== -1) return true;\r\n\r\n        return this.children.some((child) => child.contains && child.contains(node));\r\n      },\r\n      scheduleUpdateChildCountAndIndicies() {\r\n        if (this.updateChildIndiciesScheduled) return;\r\n        this.updateChildIndiciesScheduled = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          this.updateChildIndices();\r\n          if (hasChildCountOutput) {\r\n            this.updateChildrenCount();\r\n          }\r\n          this.updateChildIndiciesScheduled = false;\r\n        });\r\n      },\r\n      getChildren() {\r\n        return this.children;\r\n      },\r\n      isChild(child) {\r\n        return this.children.indexOf(child) !== -1;\r\n      },\r\n      getChildRoot() {\r\n        return this;\r\n      },\r\n      forceUpdate() {\r\n        if (this.forceUpdateScheduled === true) return;\r\n        this.forceUpdateScheduled = true;\r\n\r\n        this.context.eventEmitter.once('frameEnd', () => {\r\n          this.forceUpdateScheduled = false;\r\n\r\n          if (this.renderedAtFrame === this.context.frameNumber) {\r\n            return;\r\n          }\r\n\r\n          this.reactComponentRef && this.reactComponentRef.setState({});\r\n        });\r\n        this.context.scheduleUpdate();\r\n      },\r\n      _resetReactVirtualDOM() {\r\n        //reset the react key to force a full re-render\r\n        //this can be required since we're editing the DOM tree, without React knowing\r\n        //and can confuse React in certain cases\r\n        this.reactKey = 'key' + reactKeyCounter;\r\n        reactKeyCounter++;\r\n        const parent = this.getVisualParentNode();\r\n        if (parent) {\r\n          parent.cachedChildren = undefined;\r\n          parent.forceUpdate();\r\n        }\r\n      },\r\n      /** Added for SSR Support */\r\n      triggerDidMount() {\r\n        if (this.wantsToBeMounted && !this.didCallTriggerDidMount) {\r\n          this.didCallTriggerDidMount = true;\r\n\r\n          if (this.hasOutput('didMount')) {\r\n            this.sendSignalOnOutput('didMount');\r\n          }\r\n\r\n          // HACK: This is requried for the Page Router.\r\n          if (this.props.didMount) {\r\n            this.props.didMount();\r\n          }\r\n\r\n          // HACK: Repeater... same as above\r\n          if (this.didMount) {\r\n            this.didMount();\r\n          }\r\n        }\r\n\r\n        this.children.forEach((child) => {\r\n          // TODO: Repeater is missing triggerDidMount\r\n          child.triggerDidMount && child.triggerDidMount();\r\n        });\r\n      },\r\n      render() {\r\n        if (!this.wantsToBeMounted) {\r\n          return;\r\n        }\r\n\r\n        //these props will only be sent when this component\r\n        //is added to the react tree. Further updates will only call\r\n        //render on the NoodlReactComponent, so make sure these props\r\n        //don't need to change over the lifetime of this node\r\n        return React.createElement(NoodlReactComponent, {\r\n          key: this.reactKey,\r\n          noodlNode: this,\r\n          ref: (ref) => {\r\n            this.reactComponentRef = ref;\r\n            this.boundingBoxObserver.setTarget(ReactDOM.findDOMNode(ref));\r\n          }\r\n        });\r\n      },\r\n      renderChildren() {\r\n        if (!this.cachedChildren) {\r\n          let c = this.children.map((child) => child.render());\r\n\r\n          let children = [];\r\n          flattenArray(children, c);\r\n\r\n          if (children.length === 0) {\r\n            children = null;\r\n          } else if (children.length === 1) {\r\n            //some components expects a single child only, and won't handle arrays\r\n            //and React.Children.only() throws an error on an array with only one child\r\n            children = children[0];\r\n          }\r\n\r\n          this.cachedChildren = children;\r\n        }\r\n\r\n        return this.cachedChildren;\r\n      },\r\n      setStyle(newStyles, styleTag) {\r\n        //this method will try to set css styles directly on the\r\n        //raw DOM elements, circumventing React.\r\n        //However, there's some layout and align attributes that are dependent\r\n        //on each other and need to go through additional processing.\r\n        //This function will detect those and trigger everything to run through the\r\n        //React component when necessary.\r\n\r\n        //TODO: move all these checks to the inputs themselves\r\n        //so the set-method of e.g. marginLeft can do the check and either\r\n        //set the style directly on the dom node, or trigger a react render\r\n        const styleObject = styleTag ? this.props.styles[styleTag] : this.style;\r\n\r\n        for (const p in newStyles) {\r\n          styleObject[p] = newStyles[p];\r\n        }\r\n\r\n        const domElement = this.getDOMElement();\r\n        if (!domElement) return;\r\n\r\n        let forceUpdate = false;\r\n\r\n        if (!styleTag) {\r\n          if (newStyles.hasOwnProperty('opacity')) {\r\n            //opacity change between zero and non-zero can toggle pointer events\r\n            //to be treated differently, so make sure to force update during those transitions\r\n\r\n            //note: properties in domElement.style are all strings\r\n            forceUpdate =\r\n              newStyles.hasOwnProperty('opacity') &&\r\n              ((domElement.style.opacity === '0' && newStyles.opacity > 0) ||\r\n                (domElement.style.opacity !== '0' && newStyles.opacity === 0));\r\n          }\r\n          if (newStyles.transform) {\r\n            let transform = newStyles.transform;\r\n\r\n            const parent = this.getVisualParentNode();\r\n            //three ways we can be position absolute:\r\n            //1. user explicitly set this node to absolute\r\n            //2. parent has no layout, which translate into no flexDirection\r\n            //3. there is no parent, meaning we're a root in the root component\r\n            if (this.style.position === 'absolute' || !parent || !parent.style.flexDirection) {\r\n              if (this.props.alignX === 'center' && !(domElement.style.marginLeft && domElement.style.marginRight))\r\n                transform = 'translateX(-50%) ' + transform;\r\n              if (this.props.alignY === 'center' && !(domElement.style.marginTop && domElement.style.marginBottom))\r\n                transform = 'translateY(-50%) ' + transform;\r\n            }\r\n\r\n            newStyles.transform = transform;\r\n          }\r\n\r\n          const marginsChanged =\r\n            newStyles.hasOwnProperty('marginLeft') ||\r\n            newStyles.hasOwnProperty('marginRight') ||\r\n            newStyles.hasOwnProperty('marginTop') ||\r\n            newStyles.hasOwnProperty('marginBottom');\r\n          const sizeInPercent =\r\n            (this.props.width && this.props.width[this.props.width.length - 1] === '%') ||\r\n            (this.props.height && this.props.height[this.props.height.length - 1] === '%');\r\n          if (sizeInPercent && marginsChanged) {\r\n            forceUpdate = true;\r\n          }\r\n\r\n          if (newStyles.position || newStyles.flexDirection || newStyles.clip) {\r\n            forceUpdate = true;\r\n          }\r\n        }\r\n\r\n        if (forceUpdate) {\r\n          this.forceUpdate();\r\n        } else {\r\n          setStylesOnDOMNode(domElement, newStyles, styleTag);\r\n        }\r\n      },\r\n      removeStyle(styles, styleTag) {\r\n        const styleObject = styleTag ? this.props.styles[styleTag] : this.style;\r\n\r\n        for (const p of styles) {\r\n          delete styleObject[p];\r\n        }\r\n\r\n        const domElement = this.getDOMElement();\r\n\r\n        let forceUpdate = false;\r\n        if (!styleTag && domElement) {\r\n          const forceUpdateAttributes = {\r\n            marginTop: true,\r\n            marginBottom: true,\r\n            marginLeft: true,\r\n            marginRight: true\r\n          };\r\n\r\n          for (const p of styles) {\r\n            if (forceUpdateAttributes[p]) forceUpdate = true;\r\n          }\r\n        }\r\n\r\n        if (domElement) {\r\n          //deleting styles is done by setting them to an empty string\r\n          const newStyles = {};\r\n          for (const p of styles) {\r\n            newStyles[p] = '';\r\n          }\r\n          setStylesOnDOMNode(domElement, newStyles, styleTag);\r\n        }\r\n\r\n        if (forceUpdate) {\r\n          this.forceUpdate();\r\n        }\r\n      },\r\n      getStyle(style) {\r\n        return this.style[style];\r\n      },\r\n      getRef() {\r\n        return this.reactComponentRef;\r\n      },\r\n      getDOMElement() {\r\n        const ref = this.getRef();\r\n        if (!ref) return;\r\n\r\n        return ReactDOM.findDOMNode(ref);\r\n      },\r\n      getVisualParentNode() {\r\n        if (this.parent) return this.parent;\r\n\r\n        //we're a root\r\n        let component = this.nodeScope.componentOwner;\r\n        while (!component.parent && component.parentNodeScope) {\r\n          component = component.parentNodeScope.componentOwner;\r\n        }\r\n\r\n        return component ? component.parent : undefined;\r\n      },\r\n      setVariant(variant) {\r\n        //stop any state transitions that are currently running\r\n        this._stopStateTransitions();\r\n\r\n        this.variant = variant;\r\n\r\n        const parameters = {};\r\n        //apply base variant parameters\r\n        variant && mergeDeep(parameters, variant.parameters);\r\n\r\n        //apply base node parameters\r\n        mergeDeep(parameters, this.model.parameters);\r\n\r\n        //and then states, if any\r\n        if (this.currentVisualStates) {\r\n          const stateParameters = this.getParametersForStates(this.currentVisualStates);\r\n          mergeDeep(parameters, stateParameters);\r\n        }\r\n\r\n        const parametersToSet = Object.keys(parameters).filter((p) => !this._hasInputBeenSetFromAConnection(p));\r\n\r\n        for (const inputName of parametersToSet) {\r\n          this.registerInputIfNeeded(inputName);\r\n\r\n          if (this.hasInput(inputName)) {\r\n            this.queueInput(inputName, parameters[inputName]);\r\n          }\r\n        }\r\n      },\r\n      getParameter(name) {\r\n        if (this.model.parameters.hasOwnProperty(name)) {\r\n          return this.model.parameters[name];\r\n        } else if (this.variant && this.variant.parameters.hasOwnProperty(name)) {\r\n          return this.variant.parameters[name];\r\n        } else {\r\n          return this.context.getDefaultValueForInput(this.model.type, name);\r\n        }\r\n      },\r\n      getParametersForStates(states) {\r\n        const params = {};\r\n\r\n        //1. Get the parameters from the variant\r\n        //2. Then override with all local values from the node's neutral state (so a color in neutral will override all states from the variant)\r\n        //3. then apply the node specific state parameters\r\n\r\n        //1. Apply variant states\r\n        if (this.variant) {\r\n          for (const state of states) {\r\n            if (this.variant.stateParameters && this.variant.stateParameters.hasOwnProperty(state)) {\r\n              mergeDeep(params, this.variant.stateParameters[state]);\r\n            }\r\n          }\r\n        }\r\n\r\n        //2. Override with local values from the nodes neutral state\r\n        for (const param in params) {\r\n          if (this.model.parameters.hasOwnProperty(param)) {\r\n            if (isObject(params[param])) {\r\n              mergeDeep(params[param], this.model.parameters[param]);\r\n            } else {\r\n              params[param] = this.model.parameters[param];\r\n            }\r\n          }\r\n        }\r\n        // mergeDeep(params, this.model.parameters);\r\n\r\n        //3. Apply node specific state paramters\r\n        if (this.model.stateParameters) {\r\n          for (const state of states) {\r\n            if (this.model.stateParameters.hasOwnProperty(state)) {\r\n              mergeDeep(params, this.model.stateParameters[state]);\r\n            }\r\n          }\r\n        }\r\n\r\n        return params;\r\n      },\r\n      _getNewState(prevStates, newStates) {\r\n        const addedStates = newStates.filter((value) => !(prevStates || []).includes(value));\r\n        const newState = addedStates.length ? addedStates[0] : 'neutral';\r\n\r\n        return newState === '' ? 'neutral' : newState;\r\n      },\r\n      _getDefaultTransition(state) {\r\n        if (\r\n          this.model.defaultStateTransitions &&\r\n          this.model.defaultStateTransitions[state] &&\r\n          this.model.defaultStateTransitions[state].curve\r\n        ) {\r\n          return this.model.defaultStateTransitions[state];\r\n        } else if (\r\n          this.variant &&\r\n          this.variant.defaultStateTransitions &&\r\n          this.variant.defaultStateTransitions[state] &&\r\n          this.variant.defaultStateTransitions[state].curve\r\n        ) {\r\n          return this.variant.defaultStateTransitions[state];\r\n        }\r\n      },\r\n      _getStateTransition(state) {\r\n        let transitions = {};\r\n\r\n        if (this.model.stateTransitions && this.model.stateTransitions[state]) {\r\n          Object.assign(transitions, this.model.stateTransitions[state]);\r\n        }\r\n\r\n        if (this.variant && this.variant.stateTransitions && this.variant.stateTransitions[state]) {\r\n          Object.assign(transitions, this.variant.stateTransitions[state]);\r\n        }\r\n\r\n        return transitions;\r\n      },\r\n      setVisualStates(newStates) {\r\n        if (!this.model) {\r\n          //this node has probably been generated by a router or similar, and is an internal node without a model\r\n          //those nodes can't have visual states\r\n          return;\r\n        }\r\n\r\n        const statesAreEqual =\r\n          this.currentVisualStates &&\r\n          newStates.length === this.currentVisualStates.length &&\r\n          newStates.every((val, index) => val === this.currentVisualStates[index]);\r\n        if (statesAreEqual) return;\r\n\r\n        const prevStateParams = this.currentVisualStates ? this.getParametersForStates(this.currentVisualStates) : {};\r\n        const newStateParams = this.getParametersForStates(newStates);\r\n\r\n        const newState = this._getNewState(this.currentVisualStates, newStates);\r\n\r\n        this.currentVisualStates = newStates;\r\n\r\n        const newValues = {};\r\n\r\n        //all params that were in the old states, but not in the new states, needs to be reset back to original state\r\n        for (const param in prevStateParams) {\r\n          if (!newStateParams.hasOwnProperty(param) && !this._hasInputBeenSetFromAConnection(param)) {\r\n            const value = this.getParameter(param);\r\n            if (value !== undefined) {\r\n              newValues[param] = this.getParameter(param);\r\n            }\r\n          }\r\n        }\r\n\r\n        for (const param in newStateParams) {\r\n          if (!this._hasInputBeenSetFromAConnection(param) && newStateParams[param] !== undefined) {\r\n            newValues[param] = newStateParams[param];\r\n          }\r\n        }\r\n\r\n        const defaultTransition = this._getDefaultTransition(newState);\r\n        const stateTransition = this._getStateTransition(newState);\r\n\r\n        for (const param in newValues) {\r\n          if (stateTransition[param] && stateTransition[param].curve) {\r\n            transitionParameter(this, param, newValues[param], stateTransition[param]);\r\n          } else if (!stateTransition[param] && defaultTransition) {\r\n            transitionParameter(this, param, newValues[param], defaultTransition);\r\n          } else {\r\n            //stop any running transition\r\n            if (this._transitions && this._transitions[param]) {\r\n              this._transitions[param].stop();\r\n              delete this._transitions[param];\r\n            }\r\n\r\n            this.queueInput(param, newValues[param]);\r\n          }\r\n        }\r\n      },\r\n      _getVisualStates() {\r\n        return this.currentVisualStates || [];\r\n      },\r\n      _stopStateTransitions() {\r\n        if (!this._transitions) return;\r\n\r\n        for (const name in this._transitions) {\r\n          this._transitions[name].stop();\r\n          delete this._transitions[name];\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  if (useVariants) {\r\n    ReactComponentNode.inputs.variant = {\r\n      displayName: 'Variant',\r\n      group: 'General',\r\n      type: {\r\n        name: 'string',\r\n        allowConnectionsOnly: true\r\n      },\r\n      set(variantName) {\r\n        if (this.variant && this.variant.name === variantName) return;\r\n        const variant = this.context.variants.getVariant(this.model.type, variantName);\r\n        variant && this.setVariant(variant);\r\n      }\r\n    };\r\n  }\r\n\r\n  if (def.mountedInput !== false) {\r\n    ReactComponentNode.inputs.mounted = {\r\n      displayName: 'Mounted',\r\n      index: 9999,\r\n      type: 'boolean',\r\n      group: 'General',\r\n      default: true,\r\n      set(value) {\r\n        value = value ? true : false;\r\n        if (this.wantsToBeMounted !== value) {\r\n          this.wantsToBeMounted = value;\r\n          //either we have a direct parent, or we're a root and need to tell\r\n          //the parent of the component instance instead\r\n          const parent = this.getVisualParentNode();\r\n          if (parent) {\r\n            parent.cachedChildren = undefined;\r\n            parent.forceUpdate();\r\n          }\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  const hasChildCountOutput = ReactComponentNode.allowChildren || ReactComponentNode.displayName;\r\n\r\n  if (hasChildCountOutput) {\r\n    ReactComponentNode.outputs.childrenCount = {\r\n      displayName: 'Children Count',\r\n      type: 'number',\r\n      get() {\r\n        return this.childrenCount;\r\n      }\r\n    };\r\n  }\r\n\r\n  //regular inputs\r\n  for (const name in inputs) {\r\n    ReactComponentNode.inputs[name] = inputs[name];\r\n  }\r\n\r\n  //inputs that set react props\r\n  for (const inputName in inputProps) {\r\n    const input = inputProps[inputName];\r\n    if (input.type === 'node') {\r\n      input.type = 'reference';\r\n      input.set = function (value) {\r\n        const props = input.propPath ? this.props[input.propPath] : this.props;\r\n        if (value !== undefined) {\r\n          props[inputName] = value.render();\r\n        } else {\r\n          delete props[inputName];\r\n        }\r\n        this.forceUpdate();\r\n      };\r\n    } else {\r\n      if (input.type === 'signal') {\r\n        console.error(`Error: Signals not supported as a react prop. node: '${def.name}' input: '${inputName}'`);\r\n      } else {\r\n        defineRegularInputProp(input, inputName);\r\n      }\r\n    }\r\n\r\n    ReactComponentNode.inputs[inputName] = input;\r\n  }\r\n\r\n  //inputs that set a css attribute\r\n  for (const name in inputCss) {\r\n    const input = inputCss[name];\r\n    const styleTargetName = input.targetStyleProperty || name;\r\n\r\n    if (input.type.units) {\r\n      input.set = function (value) {\r\n        if (typeof value !== 'object' && input.type.defaultUnit) {\r\n          value = { value, unit: input.type.defaultUnit };\r\n        }\r\n\r\n        if (typeof value === 'object' && value.value !== undefined) {\r\n          //this is a value with a unit\r\n          this.setStyle({ [styleTargetName]: value.value + value.unit }, input.styleTag);\r\n        } else if (value !== undefined) {\r\n          //value without a unit. One example is line height, that can be unitless\r\n          this.setStyle({ [styleTargetName]: value }, input.styleTag);\r\n        } else {\r\n          //value is undefined, so just reset the style\r\n          this.removeStyle([styleTargetName], input.styleTag);\r\n        }\r\n        if (input.onChange) {\r\n          input.onChange.call(this, value);\r\n        }\r\n      };\r\n    } else {\r\n      input.set = function (value) {\r\n        if (value !== undefined) {\r\n          this.setStyle({ [styleTargetName]: value }, input.styleTag);\r\n        } else {\r\n          this.removeStyle([styleTargetName], input.styleTag);\r\n        }\r\n        if (input.onChange) {\r\n          input.onChange.call(this, value);\r\n        }\r\n      };\r\n    }\r\n\r\n    ReactComponentNode.inputs[name] = input;\r\n  }\r\n\r\n  //regular outputs\r\n  for (const name in outputs) {\r\n    ReactComponentNode.outputs[name] = outputs[name];\r\n  }\r\n\r\n  //outputs triggered by react props\r\n  for (const name in outputProps) {\r\n    const output = outputProps[name];\r\n\r\n    if (output.type !== 'signal') {\r\n      output.get = function () {\r\n        return this.outputPropValues[name];\r\n      };\r\n    }\r\n\r\n    ReactComponentNode.outputs[name] = output;\r\n  }\r\n\r\n  for (const name in methods) {\r\n    ReactComponentNode.methods[name] = methods[name];\r\n  }\r\n\r\n  return {\r\n    node: ReactComponentNode,\r\n    setup: def.setup\r\n  };\r\n}\r\n\r\nfunction isObject(item) {\r\n  return item && typeof item === 'object' && !Array.isArray(item);\r\n}\r\n\r\nexport { createNodeFromReactComponent };\r\n","const pointerEvents = [\r\n  'onClick',\r\n  'onMouseDown',\r\n  'onMouseMove',\r\n  'onMouseUp',\r\n  'onMouseEnter',\r\n  'onMouseLeave',\r\n  'onMouseOver',\r\n  'onMouseOut',\r\n  'onTouchStart',\r\n  'onTouchMove',\r\n  'onTouchEnd',\r\n  'onTouchCancel',\r\n  'onPointerDown',\r\n  'onPointerMove',\r\n  'onPointerUp',\r\n  'onPointerCancel'\r\n];\r\n\r\n//These should not be blocked, it causes some annoying behaviour when using hover\r\nconst pointerEventsNotToBlock = new Set(['onMouseLeave', 'onMouseOut']);\r\n\r\nexport default function pointerProps(props) {\r\n  const newProps = {};\r\n\r\n  for (const eventName of pointerEvents) {\r\n    if (props.blockTouch && !pointerEventsNotToBlock.has(eventName)) {\r\n      //Noodl stores pointer event callbacks in props.pointer\r\n      if (props.pointer && props.pointer[eventName]) {\r\n        newProps[eventName] = (e) => {\r\n          props.pointer[eventName](e);\r\n          e.stopPropagation();\r\n        };\r\n      }\r\n      //some third party library might add pointer event callbacks as well, so look for callbacks directly on the props object\r\n      else if (props[eventName]) {\r\n        newProps[eventName] = (e) => {\r\n          props[eventName](e);\r\n          e.stopPropagation();\r\n        };\r\n      } else {\r\n        //there was no existing listener, so create a new one that just blocks\r\n        newProps[eventName] = (e) => {\r\n          e.stopPropagation();\r\n        };\r\n      }\r\n    }\r\n    //check if third party code added a listener\r\n    else if (props[eventName]) {\r\n      newProps[eventName] = props[eventName];\r\n    }\r\n    //check if Noodl added a listener\r\n    else if (props.pointer) {\r\n      newProps[eventName] = props.pointer[eventName];\r\n    }\r\n  }\r\n\r\n  if (props.noodlNode) {\r\n    for (const p in newProps) {\r\n      const f = newProps[p];\r\n      if (f) {\r\n        newProps[p] = (e) => {\r\n          f.call(this, e);\r\n          props.noodlNode.context.updateDirtyNodes();\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  return newProps;\r\n}\r\n","import PointerListeners from '../../pointerlisteners';\r\n\r\nfunction _shallowCompare(o1, o2) {\r\n  let p;\r\n  for (p in o1) {\r\n    if (o1.hasOwnProperty(p)) {\r\n      if (o1[p] !== o2[p]) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  for (p in o2) {\r\n    if (o2.hasOwnProperty(p)) {\r\n      if (o1[p] !== o2[p]) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nconst _styleSheets = {};\r\n\r\nfunction updateStylesForClass(_class, props, _styleTemplate) {\r\n  if (_styleSheets[_class]) {\r\n    // Check if props have changed\r\n    if (!_shallowCompare(props, _styleSheets[_class].props)) {\r\n      _styleSheets[_class].style.innerHTML = _styleTemplate(_class, props);\r\n      _styleSheets[_class].props = Object.assign({}, props);\r\n    }\r\n  } else {\r\n    // Create a new style sheet if none exists\r\n    const style = document.createElement('style');\r\n    style.innerHTML = _styleTemplate(_class, props);\r\n    document.head.appendChild(style);\r\n\r\n    _styleSheets[_class] = { style, props: Object.assign({}, props) };\r\n  }\r\n}\r\n\r\nfunction mergeAttribute(definition, attribute, values) {\r\n  if (!definition[attribute]) {\r\n    definition[attribute] = {};\r\n  }\r\n\r\n  for (const name in values) {\r\n    definition[attribute][name] = values[name];\r\n  }\r\n}\r\n\r\nfunction addInputs(definition, values) {\r\n  mergeAttribute(definition, 'inputs', values);\r\n}\r\n\r\nfunction addInputProps(definition, values) {\r\n  mergeAttribute(definition, 'inputProps', values);\r\n}\r\n\r\nfunction addOutputProps(definition, values) {\r\n  mergeAttribute(definition, 'outputProps', values);\r\n}\r\n\r\nfunction addOutputs(definition, values) {\r\n  mergeAttribute(definition, 'outputs', values);\r\n}\r\n\r\nfunction addControlEventsAndStates(definition, args?) {\r\n  args = args || {};\r\n\r\n  definition.visualStates = [\r\n    { name: 'neutral', label: 'Neutral' },\r\n    { name: 'hover', label: 'Hover' },\r\n    { name: 'pressed', label: 'Pressed' },\r\n    { name: 'focused', label: 'Focused' },\r\n    { name: 'disabled', label: 'Disabled' }\r\n  ];\r\n\r\n  if (args.checked) {\r\n    definition.visualStates.splice(3, 0, { name: 'checked', label: 'Checked' });\r\n  }\r\n\r\n  addInputs(definition, {\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'General',\r\n      default: true,\r\n      set: function (value) {\r\n        value = !!value;\r\n        const changed = value !== this._internal.enabled;\r\n        this.props.enabled = this._internal.enabled = value;\r\n\r\n        if (changed) {\r\n          this._updateVisualState();\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('enabled');\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  addInputProps(definition, {\r\n    blockTouch: {\r\n      index: 450,\r\n      displayName: 'Block Pointer Events',\r\n      type: 'boolean',\r\n      group: 'Pointer Events'\r\n    }\r\n  });\r\n\r\n  definition.methods._updateVisualState = function () {\r\n    const states = [];\r\n\r\n    //make sure they are in the order they should be applied\r\n    if (this._internal.enabled) {\r\n      if (this.outputPropValues.hoverState) states.push('hover');\r\n      if (this.outputPropValues.pressedState) states.push('pressed');\r\n      if (this.outputPropValues.focusState) states.push('focused');\r\n    }\r\n\r\n    if (args.checked && this._internal.checked) states.push('checked');\r\n    if (!this._internal.enabled) states.push('disabled');\r\n\r\n    this.setVisualStates(states);\r\n  };\r\n\r\n  addOutputProps(definition, {\r\n    // Focus\r\n    focusState: {\r\n      displayName: 'Focused',\r\n      group: 'States',\r\n      type: 'boolean',\r\n      props: {\r\n        onFocus() {\r\n          this.outputPropValues.focusState = true;\r\n          this.flagOutputDirty('focusState');\r\n          this._updateVisualState();\r\n        },\r\n        onBlur() {\r\n          this.outputPropValues.focusState = false;\r\n          this.flagOutputDirty('focusState');\r\n          this._updateVisualState();\r\n        }\r\n      }\r\n    },\r\n    onFocus: {\r\n      displayName: 'Focused',\r\n      group: 'Focus Events',\r\n      type: 'signal',\r\n      props: {\r\n        onFocus() {\r\n          this.sendSignalOnOutput('onFocus');\r\n        }\r\n      }\r\n    },\r\n    onBlur: {\r\n      displayName: 'Blurred',\r\n      group: 'Focus Events',\r\n      type: 'signal',\r\n      props: {\r\n        onBlur() {\r\n          this.sendSignalOnOutput('onBlur');\r\n        }\r\n      }\r\n    },\r\n\r\n    // Hover\r\n    hoverState: {\r\n      displayName: 'Hover',\r\n      group: 'States',\r\n      type: 'boolean',\r\n      props: {\r\n        onMouseOver() {\r\n          this.outputPropValues.hoverState = true;\r\n          this.flagOutputDirty('hoverState');\r\n          this._updateVisualState();\r\n        },\r\n        onMouseLeave() {\r\n          this.outputPropValues.hoverState = false;\r\n          this.flagOutputDirty('hoverState');\r\n          this._updateVisualState();\r\n        }\r\n      }\r\n    },\r\n    hoverStart: {\r\n      displayName: 'Hover Start',\r\n      group: 'Pointer Events',\r\n      type: 'signal',\r\n      props: {\r\n        onMouseOver() {\r\n          this.sendSignalOnOutput('hoverStart');\r\n        }\r\n      }\r\n    },\r\n    hoverEnd: {\r\n      displayName: 'Hover End',\r\n      group: 'Pointer Events',\r\n      type: 'signal',\r\n      props: {\r\n        onMouseLeave() {\r\n          this.sendSignalOnOutput('hoverEnd');\r\n        }\r\n      }\r\n    },\r\n\r\n    // Pressed\r\n    pressedState: {\r\n      displayName: 'Pressed',\r\n      group: 'States',\r\n      type: 'boolean',\r\n      props: {\r\n        onMouseDown() {\r\n          this.outputPropValues.pressedState = true;\r\n          this.flagOutputDirty('pressedState');\r\n          this._updateVisualState();\r\n        },\r\n        onTouchStart() {\r\n          this.outputPropValues.pressedState = true;\r\n          this.flagOutputDirty('pressedState');\r\n          this._updateVisualState();\r\n        },\r\n        onMouseUp() {\r\n          this.outputPropValues.pressedState = false;\r\n          this.flagOutputDirty('pressedState');\r\n          this._updateVisualState();\r\n        },\r\n        onTouchEnd() {\r\n          this.outputPropValues.pressedState = false;\r\n          this.flagOutputDirty('pressedState');\r\n          this._updateVisualState();\r\n        },\r\n        onTouchCancel() {\r\n          this.outputPropValues.pressedState = false;\r\n          this.flagOutputDirty('pressedState');\r\n          this._updateVisualState();\r\n        },\r\n        onMouseLeave() {\r\n          this.outputPropValues.pressedState = false;\r\n          this.flagOutputDirty('pressedState');\r\n          this._updateVisualState();\r\n        }\r\n      }\r\n    },\r\n    pointerDown: {\r\n      displayName: 'Pointer Down',\r\n      group: 'Pointer Events',\r\n      type: 'signal',\r\n      props: {\r\n        onMouseDown() {\r\n          this.sendSignalOnOutput('pointerDown');\r\n        },\r\n        onTouchStart() {\r\n          this.sendSignalOnOutput('pointerDown');\r\n        }\r\n      }\r\n    },\r\n    pointerUp: {\r\n      displayName: 'Pointer Up',\r\n      group: 'Pointer Events',\r\n      type: 'signal',\r\n      props: {\r\n        onMouseUp() {\r\n          this.sendSignalOnOutput('pointerUp');\r\n        },\r\n        onTouchEnd() {\r\n          this.sendSignalOnOutput('pointerUp');\r\n        },\r\n        onTouchCancel() {\r\n          this.sendSignalOnOutput('pointerUp');\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  addOutputs(definition, {\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.enabled;\r\n      }\r\n    }\r\n  });\r\n\r\n  const oldInit = definition.initialize;\r\n  definition.initialize = function () {\r\n    oldInit && oldInit.call(this);\r\n    this.props.enabled = this._internal.enabled = true;\r\n    this.outputPropValues.hoverState = this.outputPropValues.focusState = this.outputPropValues.pressedState = false;\r\n  };\r\n}\r\n\r\nfunction controlEvents(props) {\r\n  return Object.assign(\r\n    {},\r\n    {\r\n      onFocus: props.onFocus,\r\n      onBlur: props.onBlur\r\n    },\r\n    PointerListeners(props)\r\n  );\r\n}\r\n\r\nexport default {\r\n  updateStylesForClass,\r\n  addControlEventsAndStates,\r\n  controlEvents\r\n};\r\n","import React from 'react';\r\n\r\nimport Layout from '../../../layout';\r\nimport Utils from '../../../nodes/controls/utils';\r\nimport { Noodl, Slot } from '../../../types';\r\n\r\nexport interface ButtonProps extends Noodl.ReactProps {\r\n  enabled: boolean;\r\n  buttonType: 'button' | 'submit';\r\n  \r\n  attrs: React.Attributes;\r\n\r\n  textStyle: Noodl.TextStyle;\r\n\r\n  useLabel: boolean;\r\n  label: string;\r\n  labelSpacing: string;\r\n  labeltextStyle: Noodl.TextStyle;\r\n\r\n  useIcon: boolean;\r\n  iconPlacement: 'left' | 'right';\r\n  iconSpacing: string;\r\n  iconSourceType: 'image' | 'icon';\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n\r\n  onClick: () => void;\r\n\r\n  children: Slot;\r\n}\r\n\r\nexport function Button(props: ButtonProps) {\r\n  let style: React.CSSProperties = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (props.textStyle !== undefined) {\r\n    // Apply text style\r\n    style = Object.assign({}, props.textStyle, style);\r\n    style.color = props.noodlNode.context.styles.resolveColor(style.color);\r\n  }\r\n\r\n  function _renderIcon() {\r\n    const iconStyle: React.CSSProperties = {};\r\n\r\n    if (props.useLabel) {\r\n      if (props.iconPlacement === 'left' || props.iconPlacement === undefined) {\r\n        iconStyle.marginRight = props.iconSpacing;\r\n      } else {\r\n        iconStyle.marginLeft = props.iconSpacing;\r\n      }\r\n    }\r\n\r\n    if (props.iconSourceType === 'image' && props.iconImageSource !== undefined) {\r\n      iconStyle.width = props.iconSize;\r\n      iconStyle.height = props.iconSize;\r\n      return <img alt=\"\" src={props.iconImageSource} style={iconStyle} />;\r\n    } else if (props.iconSourceType === 'icon' && props.iconIconSource !== undefined) {\r\n      iconStyle.fontSize = props.iconSize;\r\n      iconStyle.color = props.iconColor;\r\n\r\n      if (props.iconIconSource.codeAsClass === true) {\r\n        return (\r\n          <span className={[props.iconIconSource.class, props.iconIconSource.code].join(' ')} style={iconStyle}></span>\r\n        );\r\n      } else {\r\n        return (\r\n          <span className={props.iconIconSource.class} style={iconStyle}>\r\n            {props.iconIconSource.code}\r\n          </span>\r\n        );\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  let className = 'ndl-controls-button';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  let content = null;\r\n\r\n  if (props.useLabel && props.useIcon) {\r\n    content = (\r\n      <>\r\n        {props.iconPlacement === 'left' ? _renderIcon() : null}\r\n        {String(props.label)}\r\n        {props.iconPlacement === 'right' ? _renderIcon() : null}\r\n      </>\r\n    );\r\n  } else if (props.useLabel) {\r\n    content = String(props.label);\r\n  } else if (props.useIcon) {\r\n    content = _renderIcon();\r\n  }\r\n\r\n  return (\r\n    <button\r\n      {...props.attrs}\r\n      className={className}\r\n      disabled={!props.enabled}\r\n      {...Utils.controlEvents(props)}\r\n      type={props.buttonType}\r\n      style={style}\r\n      onClick={props.onClick}\r\n    >\r\n      {content}\r\n      {props.children}\r\n    </button>\r\n  );\r\n}\r\n","import { Button } from '../../components/controls/Button';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\nconst ButtonNode = {\r\n  name: 'net.noodl.controls.button',\r\n  displayName: 'Button',\r\n  docs: 'https://docs.noodl.net/nodes/ui-controls/button',\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  usePortAsLabel: 'label',\r\n  portLabelTruncationMode: 'length',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'label'\r\n  },\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'States',\r\n      'Mounted',\r\n      'Label',\r\n      'Label Text Style',\r\n      'Hover Events',\r\n      'Pointer Events',\r\n      'Focus Events'\r\n    ]\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n    this.props.layout = 'row'; //Used to tell child nodes what layout to expect\r\n  },\r\n  getReactComponent() {\r\n    return Button;\r\n  },\r\n  inputs: {\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 100,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: '#000000',\r\n      allowVisualStates: true\r\n    }\r\n  },\r\n  outputProps: {\r\n    onClick: {\r\n      displayName: 'Click',\r\n      group: 'Events',\r\n      type: 'signal'\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(ButtonNode, {\r\n  defaultSizeMode: 'contentSize',\r\n  contentLabel: 'Content'\r\n});\r\nNodeSharedPortDefinitions.addTextStyleInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addAlignInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addTransformInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(ButtonNode, {\r\n  defaults: {\r\n    paddingTop: 5,\r\n    paddingRight: 20,\r\n    paddingBottom: 5,\r\n    paddingLeft: 20\r\n  }\r\n});\r\nNodeSharedPortDefinitions.addMarginInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addLabelInputs(ButtonNode, {\r\n  defaults: { useLabel: true }\r\n});\r\nNodeSharedPortDefinitions.addIconInputs(ButtonNode, {\r\n  enableIconPlacement: true,\r\n  defaults: { useIcon: false }\r\n});\r\nNodeSharedPortDefinitions.addSharedVisualInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addBorderInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addShadowInputs(ButtonNode);\r\n\r\nUtils.addControlEventsAndStates(ButtonNode);\r\n\r\nexport default createNodeFromReactComponent(ButtonNode);\r\n","import React, { useEffect, useState } from 'react';\r\n\r\nimport Layout from '../../../layout';\r\nimport Utils from '../../../nodes/controls/utils';\r\nimport { Noodl } from '../../../types';\r\n\r\nexport interface CheckboxProps extends Noodl.ReactProps {\r\n  id: string;\r\n  enabled: boolean;\r\n  checked: boolean;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  useLabel: boolean;\r\n  label: string;\r\n  labelSpacing: string;\r\n  labeltextStyle: Noodl.TextStyle;\r\n\r\n  useIcon: boolean;\r\n  iconPlacement: 'left' | 'right';\r\n  iconSpacing: string;\r\n  iconSourceType: 'image' | 'icon';\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n\r\n  checkedChanged: (checked: boolean) => void;\r\n}\r\n\r\nexport function Checkbox(props: CheckboxProps) {\r\n  const [checked, setChecked] = useState(props.checked);\r\n\r\n  // Report initial values when mounted\r\n  useEffect(() => {\r\n    setChecked(!!props.checked);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setChecked(!!props.checked);\r\n  }, [props.checked]);\r\n\r\n  const style: React.CSSProperties = { ...props.style };\r\n\r\n  if (props.parentLayout === 'none') {\r\n    style.position = 'absolute';\r\n  }\r\n\r\n  Layout.align(style, props);\r\n\r\n  const inputProps = {\r\n    ...props.attrs,\r\n    id: props.id,\r\n    className: [props.className, 'ndl-controls-checkbox-2'].join(' '),\r\n    disabled: !props.enabled,\r\n    style: {\r\n      width: props.styles.checkbox.width,\r\n      height: props.styles.checkbox.height\r\n    }\r\n  };\r\n\r\n  const inputWrapperStyle: React.CSSProperties = {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    flexShrink: 0,\r\n    position: 'relative',\r\n    ...props.styles.checkbox\r\n  };\r\n\r\n  if (!props.useLabel) {\r\n    Object.assign(inputProps, Utils.controlEvents(props));\r\n    Object.assign(inputWrapperStyle, style);\r\n  }\r\n\r\n  function _renderIcon() {\r\n    if (props.iconSourceType === 'image' && props.iconImageSource !== undefined)\r\n      return (\r\n        <img\r\n          alt=\"\"\r\n          src={props.iconImageSource}\r\n          style={{\r\n            width: props.iconSize,\r\n            height: props.iconSize,\r\n            position: 'absolute'\r\n          }}\r\n        />\r\n      );\r\n    else if (props.iconSourceType === 'icon' && props.iconIconSource !== undefined) {\r\n      const style: React.CSSProperties = {\r\n        fontSize: props.iconSize,\r\n        color: props.iconColor,\r\n        position: 'absolute'\r\n      };\r\n\r\n      if (props.iconIconSource.codeAsClass === true) {\r\n        return (\r\n          <span className={[props.iconIconSource.class, props.iconIconSource.code].join(' ')} style={style}></span>\r\n        );\r\n      } else {\r\n        return (\r\n          <span className={props.iconIconSource.class} style={style}>\r\n            {props.iconIconSource.code}\r\n          </span>\r\n        );\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  const checkbox = (\r\n    <div className=\"ndl-controls-pointer\" style={inputWrapperStyle} noodl-style-tag=\"checkbox\">\r\n      {props.useIcon ? _renderIcon() : null}\r\n      <input\r\n        type=\"checkbox\"\r\n        {...inputProps}\r\n        checked={checked}\r\n        onChange={(e) => {\r\n          setChecked(e.target.checked);\r\n          props.checkedChanged && props.checkedChanged(e.target.checked);\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  if (props.useLabel) {\r\n    const labelStyle: React.CSSProperties = {\r\n      marginLeft: props.labelSpacing,\r\n      ...props.labeltextStyle,\r\n      ...props.styles.label\r\n    };\r\n\r\n    if (!props.enabled) {\r\n      labelStyle.cursor = 'default';\r\n    }\r\n\r\n    labelStyle.color = props.noodlNode.context.styles.resolveColor(labelStyle.color);\r\n\r\n    return (\r\n      <div style={{ display: 'flex', alignItems: 'center', ...style }} {...Utils.controlEvents(props)}>\r\n        {checkbox}\r\n        <label className=\"ndl-controls-pointer\" style={labelStyle} htmlFor={props.id} noodl-style-tag=\"label\">\r\n          {props.label}\r\n        </label>\r\n      </div>\r\n    );\r\n  } else {\r\n    return checkbox;\r\n  }\r\n}\r\n","import { Checkbox } from '../../components/controls/Checkbox';\r\nimport guid from '../../guid';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\nconst CheckBoxNode = {\r\n  name: 'net.noodl.controls.checkbox',\r\n  displayName: 'Checkbox',\r\n  docs: 'https://docs.noodl.net/nodes/ui-controls/checkbox',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'label'\r\n  },\r\n  usePortAsLabel: 'label',\r\n  portLabelTruncationMode: 'length',\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'States',\r\n      'Mounted',\r\n      'Label',\r\n      'Label Text Style',\r\n      'Hover Events',\r\n      'Pointer Events',\r\n      'Focus Events'\r\n    ]\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n    this.props.sizeMode = 'explicit';\r\n    this.props.id = 'input-' + guid();\r\n    this.props.checked = this._internal.checked = false;\r\n\r\n    this.props.checkedChanged = (checked) => {\r\n      const changed = this._internal.checked !== checked;\r\n      this._internal.checked = checked;\r\n      if (changed) {\r\n        this.flagOutputDirty('checked');\r\n        this.sendSignalOnOutput('onChange');\r\n        this._updateVisualState();\r\n      }\r\n    };\r\n  },\r\n  getReactComponent() {\r\n    return Checkbox;\r\n  },\r\n  inputs: {\r\n    checked: {\r\n      type: 'boolean',\r\n      displayName: 'Checked',\r\n      group: 'General',\r\n      default: false,\r\n      index: 100,\r\n      set: function (value) {\r\n        value = !!value;\r\n        const changed = value !== this._internal.checked;\r\n        this.props.checked = this._internal.checked = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('checked');\r\n          this._updateVisualState();\r\n        }\r\n      }\r\n    },\r\n    check: {\r\n      type: 'signal',\r\n      displayName: 'Check',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        if (this._internal.checked === true) return;\r\n\r\n        this.props.checked = this._internal.checked = true;\r\n\r\n        this.forceUpdate();\r\n        this.flagOutputDirty('checked');\r\n        this._updateVisualState();\r\n      }\r\n    },\r\n    uncheck: {\r\n      type: 'signal',\r\n      displayName: 'Uncheck',\r\n      group: 'Actions',\r\n      valueChangedToTrue() {\r\n        if (this._internal.checked === false) return;\r\n\r\n        this.props.checked = this._internal.checked = false;\r\n\r\n        this.forceUpdate();\r\n        this.flagOutputDirty('checked');\r\n        this._updateVisualState();\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 201,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: 'transparent',\r\n      applyDefault: false,\r\n      allowVisualStates: true,\r\n      styleTag: 'checkbox'\r\n    },\r\n    width: {\r\n      index: 11,\r\n      group: 'Dimensions',\r\n      displayName: 'Width',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', 'vw', 'vh'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 32,\r\n      allowVisualStates: true,\r\n      styleTag: 'checkbox'\r\n    },\r\n    height: {\r\n      index: 12,\r\n      group: 'Dimensions',\r\n      displayName: 'Height',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', 'vw', 'vh'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 32,\r\n      allowVisualStates: true,\r\n      styleTag: 'checkbox'\r\n    }\r\n  },\r\n  outputs: {\r\n    checked: {\r\n      type: 'boolean',\r\n      displayName: 'Checked',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.checked;\r\n      }\r\n    },\r\n    onChange: {\r\n      displayName: 'Changed',\r\n      group: 'Events',\r\n      type: 'signal'\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addTransformInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addMarginInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addIconInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addLabelInputs(CheckBoxNode, {\r\n  enableSpacing: true,\r\n  styleTag: 'label'\r\n});\r\nNodeSharedPortDefinitions.addSharedVisualInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addBorderInputs(CheckBoxNode, {\r\n  defaults: {\r\n    borderStyle: 'solid',\r\n    borderWidth: 2,\r\n    borderColor: '#000000',\r\n    borderRadius: 3\r\n  },\r\n  styleTag: 'checkbox'\r\n});\r\nNodeSharedPortDefinitions.addShadowInputs(CheckBoxNode, {\r\n  styleTag: 'checkbox'\r\n});\r\nUtils.addControlEventsAndStates(CheckBoxNode, { checked: true });\r\n\r\nexport default createNodeFromReactComponent(CheckBoxNode);\r\n","import React, { useEffect, useState } from 'react';\r\n\r\nimport type { TSFixme } from '../../../../typings/global';\r\nimport Layout from '../../../layout';\r\nimport Utils from '../../../nodes/controls/utils';\r\nimport { Noodl } from '../../../types';\r\n\r\nexport interface SelectProps extends Noodl.ReactProps {\r\n  id: string;\r\n  value: string;\r\n  enabled: boolean;\r\n  textStyle: Noodl.TextStyle;\r\n  items: TSFixme;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  placeholder: string;\r\n  placeholderOpacity: string;\r\n\r\n  useIcon: boolean;\r\n  iconPlacement: 'left' | 'right';\r\n  iconSpacing: string;\r\n  iconSourceType: 'image' | 'icon';\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n\r\n  useLabel: boolean;\r\n  label: string;\r\n  labelSpacing: string;\r\n  labeltextStyle: Noodl.TextStyle;\r\n\r\n  onClick: () => void;\r\n  valueChanged: (value: string) => void;\r\n}\r\n\r\nexport function Select(props: SelectProps) {\r\n  const [value, setValue] = useState(props.value);\r\n\r\n  useEffect(() => {\r\n    setValue(props.value);\r\n    props.valueChanged(props.value);\r\n  }, [props.value, props.items]);\r\n\r\n  let style = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (props.textStyle !== undefined) {\r\n    // Apply text style\r\n    style = Object.assign({}, props.textStyle, style);\r\n    style.color = props.noodlNode.context.styles.resolveColor(style.color);\r\n  }\r\n\r\n  // Hide label if there is no selected value, of if value is not in the items array\r\n  const selectedIndex = !props.items || value === undefined ? -1 : props.items.findIndex((i) => i.Value === value);\r\n\r\n  const { height, ...otherStyles } = style;\r\n\r\n  function _renderIcon() {\r\n    if (props.iconSourceType === 'image' && props.iconImageSource !== undefined)\r\n      return <img alt=\"\" src={props.iconImageSource} style={{ width: props.iconSize, height: props.iconSize }}></img>;\r\n    else if (props.iconSourceType === 'icon' && props.iconIconSource !== undefined) {\r\n      const style: React.CSSProperties = { fontSize: props.iconSize, color: props.iconColor };\r\n      if (props.iconPlacement === 'left' || props.iconPlacement === undefined) style.marginRight = props.iconSpacing;\r\n      else style.marginLeft = props.iconSpacing;\r\n\r\n      if (props.iconIconSource.codeAsClass === true) {\r\n        return (\r\n          <span className={[props.iconIconSource.class, props.iconIconSource.code].join(' ')} style={style}></span>\r\n        );\r\n      } else {\r\n        return (\r\n          <span className={props.iconIconSource.class} style={style}>\r\n            {props.iconIconSource.code}\r\n          </span>\r\n        );\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  const inputProps = {\r\n    ...props.attrs,\r\n    id: props.id,\r\n    className: props.className,\r\n    style: {\r\n      inset: 0,\r\n      opacity: 0,\r\n      position: 'absolute',\r\n      textTransform: 'inherit',\r\n      cursor: props.enabled ? '' : 'default',\r\n      '-webkit-appearance': 'none' //this makes styling possible on Safari, otherwise the size will be incorrect as it will use the native styling\r\n    },\r\n    onClick: props.onClick\r\n  };\r\n\r\n  const inputWrapperStyle = {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    ...props.styles.inputWrapper,\r\n    cursor: props.enabled ? '' : 'default'\r\n  };\r\n\r\n  const heightInPercent = height && height[String(height).length - 1] === '%';\r\n\r\n  if (props.useLabel) {\r\n    if (heightInPercent) {\r\n      inputWrapperStyle.flexGrow = 1;\r\n    } else {\r\n      inputWrapperStyle.height = height;\r\n    }\r\n  } else {\r\n    Object.assign(inputWrapperStyle, otherStyles);\r\n    inputWrapperStyle.height = height;\r\n  }\r\n\r\n  let options = [];\r\n\r\n  if (props.items) {\r\n    options = props.items.map((i) => (\r\n      <option key={i.Value} value={i.Value} disabled={i.Disabled === 'true' || i.Disabled === true ? true : undefined}>\r\n        {i.Label}\r\n      </option>\r\n    ));\r\n    // options.unshift();\r\n  }\r\n\r\n  let label = null;\r\n\r\n  if (selectedIndex >= 0 && selectedIndex < props.items.items.length) {\r\n    label = <span>{props.items.items[selectedIndex].Label}</span>;\r\n  } else if (props.placeholder) {\r\n    label = <span style={{ opacity: props.placeholderOpacity }}>{props.placeholder}</span>;\r\n  }\r\n\r\n  //A hidden first option is preselected and added to the list of options, it makes it possible to select the first item in the dropdown\r\n  const inputWrapper = (\r\n    <div className=\"ndl-controls-pointer\" style={inputWrapperStyle} noodl-style-tag=\"inputWrapper\">\r\n      {props.useIcon && props.iconPlacement === 'left' ? _renderIcon() : null}\r\n      <div\r\n        style={{\r\n          width: '100%',\r\n          height: '100%',\r\n          alignItems: 'center',\r\n          display: 'flex'\r\n        }}\r\n      >\r\n        {label}\r\n      </div>\r\n      {props.useIcon && props.iconPlacement === 'right' ? _renderIcon() : null}\r\n      <select\r\n        {...inputProps}\r\n        disabled={!props.enabled}\r\n        value={options.find((i) => i.props.value === value) ? value : undefined}\r\n        {...Utils.controlEvents(props)}\r\n        onChange={(e) => {\r\n          setValue(e.target.value);\r\n          props.valueChanged && props.valueChanged(e.target.value);\r\n        }}\r\n      >\r\n        <option value=\"\" disabled selected hidden />\r\n        {options}\r\n      </select>\r\n    </div>\r\n  );\r\n\r\n  if (props.useLabel) {\r\n    const outerWrapperStyle: React.CSSProperties = {\r\n      ...otherStyles,\r\n      display: 'flex',\r\n      flexDirection: 'column'\r\n    };\r\n\r\n    if (heightInPercent) {\r\n      outerWrapperStyle.height = height;\r\n    }\r\n\r\n    return (\r\n      <div style={outerWrapperStyle}>\r\n        <label\r\n          htmlFor={props.id}\r\n          style={{\r\n            ...props.labeltextStyle,\r\n            ...props.styles.label,\r\n            marginBottom: props.labelSpacing\r\n          }}\r\n          noodl-style-tag=\"label\"\r\n        >\r\n          {props.label}\r\n        </label>\r\n        {inputWrapper}\r\n      </div>\r\n    );\r\n  } else {\r\n    return inputWrapper;\r\n  }\r\n}\r\n","import { Select } from '../../components/controls/Select';\r\nimport guid from '../../guid';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\nconst OptionsNode = {\r\n  name: 'net.noodl.controls.options',\r\n  displayName: 'Dropdown',\r\n  docs: 'https://docs.noodl.net/nodes/ui-controls/dropdown',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  usePortAsLabel: 'label',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'label'\r\n  },\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'States',\r\n      'Mounted',\r\n      'Text Style',\r\n      'Label',\r\n      'Label Text Style',\r\n      'Hover Events',\r\n      'Pointer Events',\r\n      'Focus Events'\r\n    ]\r\n  },\r\n  initialize: function () {\r\n    this.props.attrs = {};\r\n    this._itemsChanged = () => {\r\n      this.forceUpdate();\r\n    };\r\n\r\n    this.props.id = 'input-' + guid();\r\n\r\n    this.props.valueChanged = (value) => {\r\n      const changed = this._internal.value !== value;\r\n      this._internal.value = value;\r\n      if (changed) {\r\n        this.flagOutputDirty('value');\r\n        this.sendSignalOnOutput('onChange');\r\n      }\r\n    };\r\n  },\r\n  getReactComponent() {\r\n    return Select;\r\n  },\r\n  inputs: {\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      set: function (newValue) {\r\n        if (this._internal.items !== newValue && this._internal.items !== undefined) {\r\n          this._internal.items.off('change', this._itemsChanged);\r\n        }\r\n        this._internal.items = newValue;\r\n        this._internal.items.on('change', this._itemsChanged);\r\n\r\n        this.props.items = this._internal.items;\r\n\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    value: {\r\n      type: 'string',\r\n      displayName: 'Value',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value !== undefined && typeof value !== 'string') {\r\n          if (value?.toString !== undefined) value = value.toString();\r\n          else return;\r\n        }\r\n\r\n        // // if value is passed in before the items, then items is undefined\r\n        // if (this._internal.items) {\r\n        //   //make sure this is a valid value that exists in the dropdown. If it doesn't, deselect all options\r\n        //   value = this._internal.items.find((i) => i.Value === value) ? value : undefined;\r\n        // }\r\n\r\n        const changed = value !== this._internal.value;\r\n        this.props.value = this._internal.value = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('value');\r\n        }\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputProps: {\r\n    placeholder: {\r\n      displayName: 'Placeholder',\r\n      type: 'string',\r\n      group: 'Placeholder'\r\n    },\r\n    placeholderOpacity: {\r\n      group: 'Placeholder',\r\n      displayName: 'Placeholder opacity',\r\n      type: 'number',\r\n      default: 0.5\r\n    }\r\n  },\r\n  outputs: {\r\n    value: {\r\n      type: 'string',\r\n      displayName: 'Value',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.value;\r\n      }\r\n    },\r\n    onChange: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 100,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: 'transparent',\r\n      styleTag: 'inputWrapper',\r\n      allowVisualStates: true\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(OptionsNode, {\r\n  defaultSizeMode: 'contentSize',\r\n  contentLabel: 'Content'\r\n});\r\nNodeSharedPortDefinitions.addAlignInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addTextStyleInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addTransformInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(OptionsNode, {\r\n  styleTag: 'inputWrapper'\r\n});\r\nNodeSharedPortDefinitions.addMarginInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addIconInputs(OptionsNode, {\r\n  enableIconPlacement: true,\r\n  defaults: { useIcon: false, iconColor: '#000000' }\r\n});\r\nNodeSharedPortDefinitions.addLabelInputs(OptionsNode, {\r\n  enableSpacing: true,\r\n  styleTag: 'label'\r\n});\r\nNodeSharedPortDefinitions.addSharedVisualInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addBorderInputs(OptionsNode, {\r\n  defaults: {\r\n    borderStyle: 'solid',\r\n    borderWidth: 2,\r\n    borderColor: '#000000',\r\n    borderRadius: 5\r\n  },\r\n  styleTag: 'inputWrapper'\r\n});\r\n\r\nNodeSharedPortDefinitions.addShadowInputs(OptionsNode, {\r\n  styleTag: 'inputWrapper'\r\n});\r\nUtils.addControlEventsAndStates(OptionsNode);\r\n\r\nexport default createNodeFromReactComponent(OptionsNode);\r\n","import React from 'react';\r\n\r\nexport interface IRadioButtonContext {\r\n  name: string;\r\n  selected: string;\r\n  checkedChanged?: (value: string) => void;\r\n}\r\n\r\nconst RadioButtonContext = React.createContext<IRadioButtonContext>({\r\n  name: undefined,\r\n  selected: undefined,\r\n  checkedChanged: undefined\r\n});\r\n\r\nexport default RadioButtonContext;\r\n","import React, { useContext } from 'react';\r\n\r\nimport RadioButtonContext from '../../../contexts/radiobuttoncontext';\r\nimport Layout from '../../../layout';\r\nimport Utils from '../../../nodes/controls/utils';\r\nimport { Noodl } from '../../../types';\r\n\r\nexport interface RadioButtonProps extends Noodl.ReactProps {\r\n  id: string;\r\n  enabled: boolean;\r\n  value: string;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  useLabel: boolean;\r\n  label: string;\r\n  labelSpacing: string;\r\n  labeltextStyle: Noodl.TextStyle;\r\n\r\n  useIcon: boolean;\r\n  iconPlacement: 'left' | 'right';\r\n  iconSpacing: string;\r\n  iconSourceType: 'image' | 'icon';\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n\r\n  fillSpacing: string;\r\n\r\n  checkedChanged: (value: boolean) => void;\r\n}\r\n\r\nfunction isPercentage(size /* string */) {\r\n  return size && size[size.length - 1] === '%';\r\n}\r\n\r\nexport function RadioButton(props: RadioButtonProps) {\r\n  const radioButtonGroup = useContext(RadioButtonContext);\r\n\r\n  const style = { ...props.style };\r\n\r\n  if (props.parentLayout === 'none') {\r\n    style.position = 'absolute';\r\n  }\r\n\r\n  Layout.align(style, props);\r\n\r\n  props.checkedChanged && props.checkedChanged(radioButtonGroup ? radioButtonGroup.selected === props.value : false);\r\n\r\n  const inputProps = {\r\n    ...props.attrs,\r\n    id: props.id,\r\n    disabled: !props.enabled,\r\n    className: [props.className, 'ndl-controls-radio-2'].join(' '),\r\n    style: {\r\n      width: props.styles.radio.width,\r\n      height: props.styles.radio.height\r\n    }\r\n  };\r\n\r\n  const inputWrapperStyle: React.CSSProperties = {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    position: 'relative',\r\n    flexShrink: 0,\r\n    ...props.styles.radio\r\n  };\r\n\r\n  if (props.useLabel) {\r\n    if (isPercentage(props.styles.radio.width)) {\r\n      delete inputWrapperStyle.width;\r\n      inputWrapperStyle.flexGrow = 1;\r\n    }\r\n  } else {\r\n    Object.assign(inputProps, Utils.controlEvents(props));\r\n    Object.assign(inputWrapperStyle, style);\r\n  }\r\n\r\n  function _renderIcon() {\r\n    if (props.iconSourceType === 'image' && props.iconImageSource !== undefined)\r\n      return <img alt=\"\" src={props.iconImageSource} style={{ width: props.iconSize, height: props.iconSize }} />;\r\n    else if (props.iconSourceType === 'icon' && props.iconIconSource !== undefined) {\r\n      const style = { fontSize: props.iconSize, color: props.iconColor };\r\n      if (props.iconIconSource.codeAsClass === true) {\r\n        return (\r\n          <span\r\n            className={['ndl-controls-abs-center', props.iconIconSource.class, props.iconIconSource.code].join(' ')}\r\n            style={style}\r\n          ></span>\r\n        );\r\n      } else {\r\n        return (\r\n          <span className={['ndl-controls-abs-center', props.iconIconSource.class].join(' ')} style={style}>\r\n            {props.iconIconSource.code}\r\n          </span>\r\n        );\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  const fillStyle: React.CSSProperties = {\r\n    left: props.fillSpacing,\r\n    right: props.fillSpacing,\r\n    top: props.fillSpacing,\r\n    bottom: props.fillSpacing,\r\n    backgroundColor: props.styles.fill.backgroundColor,\r\n    borderRadius: 'inherit',\r\n    position: 'absolute'\r\n  };\r\n\r\n  const radioButton = (\r\n    <div className=\"ndl-controls-pointer\" style={inputWrapperStyle} noodl-style-tag=\"radio\">\r\n      <div style={fillStyle} noodl-style-tag=\"fill\" />\r\n      {props.useIcon ? _renderIcon() : null}\r\n      <input\r\n        type=\"radio\"\r\n        name={radioButtonGroup ? radioButtonGroup.name : undefined}\r\n        {...inputProps}\r\n        checked={radioButtonGroup ? radioButtonGroup.selected === props.value : false}\r\n        onChange={(e) => {\r\n          radioButtonGroup && radioButtonGroup.checkedChanged && radioButtonGroup.checkedChanged(props.value);\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  if (props.useLabel) {\r\n    const labelStyle = {\r\n      marginLeft: props.labelSpacing,\r\n      ...props.labeltextStyle,\r\n      ...props.styles.label,\r\n      cursor: props.enabled ? undefined : 'default'\r\n    };\r\n\r\n    labelStyle.color = props.noodlNode.context.styles.resolveColor(labelStyle.color);\r\n\r\n    const wrapperStyle = { display: 'flex', alignItems: 'center', ...style };\r\n    if (isPercentage(props.styles.radio.width)) {\r\n      wrapperStyle.width = props.styles.radio.width;\r\n    }\r\n    if (isPercentage(props.styles.radio.height)) {\r\n      wrapperStyle.height = props.styles.radio.height;\r\n    }\r\n\r\n    return (\r\n      <div style={wrapperStyle} {...Utils.controlEvents(props)}>\r\n        {radioButton}\r\n        <label className=\"ndl-controls-pointer\" style={labelStyle} htmlFor={props.id} noodl-style-tag=\"label\">\r\n          {props.label}\r\n        </label>\r\n      </div>\r\n    );\r\n  } else {\r\n    return radioButton;\r\n  }\r\n}\r\n","import { RadioButton } from '../../components/controls/RadioButton';\r\nimport guid from '../../guid';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\nconst RadioButtonNode = {\r\n  name: 'net.noodl.controls.radiobutton',\r\n  displayName: 'Radio Button',\r\n  docs: 'https://docs.noodl.net/nodes/ui-controls/radio-button',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  usePortAsLabel: 'label',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'label'\r\n  },\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Style',\r\n      'Fill Style',\r\n      'Actions',\r\n      'Events',\r\n      'States',\r\n      'Mounted',\r\n      'Label',\r\n      'Label Text Style',\r\n      'Hover Events',\r\n      'Pointer Events',\r\n      'Focus Events'\r\n    ]\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n    this.props.sizeMode = 'explicit';\r\n    this.props.id = 'input-' + guid();\r\n\r\n    this._internal.checked = false;\r\n\r\n    this.props.checkedChanged = (checked) => {\r\n      const changed = this._internal.checked !== checked;\r\n      this._internal.checked = checked;\r\n      if (changed) {\r\n        this.flagOutputDirty('checked');\r\n        this._updateVisualState();\r\n      }\r\n    };\r\n\r\n    this.props.styles.fill = {};\r\n  },\r\n  getReactComponent() {\r\n    return RadioButton;\r\n  },\r\n  inputs: {\r\n    fillColor: {\r\n      index: 19,\r\n      displayName: 'Fill Color',\r\n      group: 'Fill Style',\r\n      type: 'color',\r\n      allowVisualStates: true,\r\n      styleTag: 'fill',\r\n      set(value) {\r\n        this.setStyle({ backgroundColor: value }, 'fill');\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputProps: {\r\n    value: {\r\n      type: 'string',\r\n      displayName: 'Value',\r\n      group: 'General',\r\n      index: 100\r\n    },\r\n    fillSpacing: {\r\n      displayName: 'Fill Spacing',\r\n      group: 'Fill Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', 'vw', 'vh'],\r\n        defaultUnit: 'px'\r\n      },\r\n      allowVisualStates: true,\r\n      default: 2\r\n    }\r\n  },\r\n  inputCss: {\r\n    width: {\r\n      index: 11,\r\n      group: 'Dimensions',\r\n      displayName: 'Width',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', '%', 'vw', 'vh'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 32,\r\n      allowVisualStates: true,\r\n      styleTag: 'radio',\r\n      onChange() {\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    height: {\r\n      index: 12,\r\n      group: 'Dimensions',\r\n      displayName: 'Height',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', '%'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 32,\r\n      allowVisualStates: true,\r\n      styleTag: 'radio',\r\n      onChange() {\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    backgroundColor: {\r\n      index: 201,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      allowVisualStates: true,\r\n      styleTag: 'radio',\r\n      default: 'transparent',\r\n      applyDefault: false\r\n    }\r\n  },\r\n  outputs: {\r\n    checked: {\r\n      type: 'boolean',\r\n      displayName: 'Checked',\r\n      group: 'States',\r\n      get() {\r\n        return this._internal.checked;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addTransformInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addMarginInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addIconInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addLabelInputs(RadioButtonNode, {\r\n  enableSpacing: true,\r\n  styleTag: 'label'\r\n});\r\nNodeSharedPortDefinitions.addSharedVisualInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addBorderInputs(RadioButtonNode, {\r\n  defaults: {\r\n    borderStyle: 'solid',\r\n    borderWidth: 2,\r\n    borderRadius: 16\r\n  },\r\n  styleTag: 'radio'\r\n});\r\nNodeSharedPortDefinitions.addShadowInputs(RadioButtonNode, {\r\n  styleTag: 'radio'\r\n});\r\nUtils.addControlEventsAndStates(RadioButtonNode, { checked: true });\r\n\r\nexport default createNodeFromReactComponent(RadioButtonNode);\r\n","import React, { useEffect, useState } from 'react';\r\n\r\nimport RadioButtonContext from '../../../contexts/radiobuttoncontext';\r\nimport Layout from '../../../layout';\r\nimport { Noodl, Slot } from '../../../types';\r\n\r\nexport interface RadioButtonGroupProps extends Noodl.ReactProps {\r\n  name: string;\r\n  value: string;\r\n\r\n  valueChanged?: (value: string) => void;\r\n\r\n  children: Slot;\r\n}\r\n\r\nexport function RadioButtonGroup(props: RadioButtonGroupProps) {\r\n  const [selected, setSelected] = useState(props.value);\r\n  const context = {\r\n    selected: selected,\r\n    name: props.name,\r\n    checkedChanged: (value) => {\r\n      setSelected(value);\r\n      props.valueChanged && props.valueChanged(value);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    setSelected(props.value);\r\n  }, [props.value]);\r\n\r\n  const style: React.CSSProperties = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  let className = 'ndl-controls-radiobuttongroup';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  return (\r\n    <RadioButtonContext.Provider value={context}>\r\n      <div className={className} style={style}>\r\n        {props.children}\r\n      </div>\r\n    </RadioButtonContext.Provider>\r\n  );\r\n}\r\n","export const flexDirectionValues = ['row', 'row-reverse', 'column', 'column-reverse', 'inherit', 'initial', 'revert', 'unset'];","import { RadioButtonGroup } from '../../components/controls/RadioButtonGroup';\r\nimport { flexDirectionValues } from '../../constants/flex';\r\nimport guid from '../../guid';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nlet RadioButtonGroupNode = {\r\n  name: 'Radio Button Group',\r\n  displayName: 'Radio Button Group',\r\n  docs: 'https://docs.noodl.net/nodes/ui-controls/radio-button-group',\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  useVariants: false,\r\n  connectionPanel: {\r\n    groupPriority: ['General', 'Style', 'Actions', 'Events', 'Mounted', 'States']\r\n  },\r\n  initialize() {\r\n    this.props.name = 'radio-' + guid();\r\n\r\n    this.props.valueChanged = (value) => {\r\n      const changed = this._internal.value !== value;\r\n      this._internal.value = value;\r\n      this.props.value = value;\r\n      if (changed) {\r\n        this.forceUpdate();\r\n        this.flagOutputDirty('value');\r\n        this.sendSignalOnOutput('onChange');\r\n      }\r\n    };\r\n  },\r\n  getReactComponent() {\r\n    return RadioButtonGroup;\r\n  },\r\n  defaultCss: {\r\n    display: 'flex',\r\n    position: 'relative',\r\n    flexDirection: 'column'\r\n  },\r\n  inputs: {\r\n    flexDirection: {\r\n      //don't rename for backwards compat\r\n      index: 11,\r\n      displayName: 'Layout',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Vertical', value: 'column' },\r\n          { label: 'Horizontal', value: 'row' }\r\n        ]\r\n      },\r\n      default: 'column',\r\n      set(value) {\r\n        this.props.layout = value;\r\n\r\n        if (value !== 'none') {\r\n          this.setStyle({ flexDirection: value });\r\n        } else {\r\n          this.removeStyle(['flexDirection']);\r\n        }\r\n\r\n        if (this.context.editorConnection) {\r\n          // Send warning if the value is wrong\r\n          if (value !== 'none' && !flexDirectionValues.includes(value)) {\r\n            this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'layout-warning', {\r\n              message: 'Invalid Layout value has to be a valid flex-direction value.'\r\n            });\r\n          } else {\r\n            this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'layout-warning');\r\n          }\r\n        }\r\n\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    value: {\r\n      index: 20,\r\n      type: 'string',\r\n      displayName: 'Value',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (typeof value !== 'string' && value.toString !== undefined) value = value.toString();\r\n        if (typeof value !== 'string') return;\r\n\r\n        const changed = value !== this._internal.value;\r\n        this.props.value = this._internal.value = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('value');\r\n        }\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    value: {\r\n      type: 'string',\r\n      displayName: 'Value',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.value;\r\n      }\r\n    },\r\n    onChange: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  inputProps: {},\r\n  outputProps: {}\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(RadioButtonGroupNode, {\r\n  defaultSizeMode: 'contentSize',\r\n  contentLabel: 'Content'\r\n});\r\nNodeSharedPortDefinitions.addAlignInputs(RadioButtonGroupNode);\r\nNodeSharedPortDefinitions.addTransformInputs(RadioButtonGroupNode);\r\nNodeSharedPortDefinitions.addMarginInputs(RadioButtonGroupNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(RadioButtonGroupNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(RadioButtonGroupNode);\r\n\r\nRadioButtonGroupNode = createNodeFromReactComponent(RadioButtonGroupNode);\r\nexport default RadioButtonGroupNode;\r\n","import React, { useEffect, useState } from 'react';\r\n\r\nimport Layout from '../../../layout';\r\nimport Utils from '../../../nodes/controls/utils';\r\nimport { Noodl } from '../../../types';\r\n\r\nexport interface SliderProps extends Noodl.ReactProps {\r\n  _nodeId: string;\r\n  id: string;\r\n  enabled: boolean;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  value: number;\r\n  min: number;\r\n  max: number;\r\n  step: number;\r\n\r\n  thumbHeight: string;\r\n  thumbWidth: string;\r\n  thumbColor: string;\r\n\r\n  trackHeight: string;\r\n  trackActiveColor: string;\r\n  trackColor: string;\r\n\r\n  onClick: () => void;\r\n  updateOutputValue: (value: number) => void;\r\n}\r\n\r\nfunction _styleTemplate(_class: string, props: SliderProps) {\r\n  return `.${_class}::-webkit-slider-thumb {\r\n  width: ${props.thumbWidth};\r\n}`;\r\n}\r\n\r\nfunction setBorderStyle(style: React.CSSProperties, prefix: string, props: SliderProps) {\r\n  function setBorder(style: React.CSSProperties, group: string) {\r\n    const width = `${prefix}Border${group}Width`;\r\n    const color = `${prefix}Border${group}Color`;\r\n    const borderStyle = `${prefix}Border${group}Style`;\r\n\r\n    const w = props[width] || props[`${prefix}BorderWidth`];\r\n    if (w !== undefined) style[`border${group}Width`] = w;\r\n\r\n    const c = (style[color] = props[color] || props[`${prefix}BorderColor`]);\r\n    if (c !== undefined) style[`border${group}Color`] = c;\r\n\r\n    const s = props[borderStyle] || props[`${prefix}BorderStyle`];\r\n    if (s !== undefined) style[`border${group}Style`] = s;\r\n  }\r\n\r\n  setBorder(style, 'Top');\r\n  setBorder(style, 'Right');\r\n  setBorder(style, 'Bottom');\r\n  setBorder(style, 'Left');\r\n}\r\n\r\nfunction setBorderRadius(style: React.CSSProperties, prefix: string, props: SliderProps) {\r\n  const radius = props[`${prefix}BorderRadius`];\r\n  const tl = props[`${prefix}BorderTopLeftRadius`] || radius;\r\n  const tr = props[`${prefix}BorderTopRightRadius`] || radius;\r\n  const br = props[`${prefix}BorderBottomRightRadius`] || radius;\r\n  const bl = props[`${prefix}BorderBottomLeftRadius`] || radius;\r\n\r\n  style.borderRadius = `${tl} ${tr} ${br} ${bl}`;\r\n}\r\n\r\nfunction setShadow(style: React.CSSProperties, prefix: string, props: SliderProps) {\r\n  if (!props[`${prefix}BoxShadowEnabled`]) return;\r\n\r\n  const inset = props[`${prefix}BoxShadowInset`];\r\n  const x = props[`${prefix}BoxShadowOffsetX`];\r\n  const y = props[`${prefix}BoxShadowOffsetY`];\r\n  const blur = props[`${prefix}BoxShadowBlurRadius`];\r\n  const spread = props[`${prefix}BoxShadowSpreadRadius`];\r\n  const color = props[`${prefix}BoxShadowColor`];\r\n\r\n  style.boxShadow = `${inset ? 'inset ' : ''}${x} ${y} ${blur} ${spread} ${color}`;\r\n}\r\n\r\nfunction hasUnitPx(value: string) {\r\n  return value && value[value.length - 1] === 'x';\r\n}\r\n\r\nexport function Slider(props: SliderProps) {\r\n  const [value, setValue] = useState(props.value);\r\n\r\n  useEffect(() => {\r\n    onValueChanged(props.value);\r\n  }, [props.value]);\r\n\r\n  function onValueChanged(value: number) {\r\n    setValue(value);\r\n    props.updateOutputValue(value);\r\n  }\r\n\r\n  const style: React.CSSProperties = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  const instanceClassId = 'ndl-controls-range-' + props._nodeId;\r\n  Utils.updateStylesForClass(instanceClassId, props, _styleTemplate);\r\n\r\n  const className = `ndl-controls-range2 ${instanceClassId} ${props.className ? props.className : ''} `;\r\n\r\n  const inputProps: React.InputHTMLAttributes<HTMLInputElement> = {\r\n    ...props.attrs,\r\n    id: props.id,\r\n    style: {\r\n      width: '100%',\r\n      opacity: 0\r\n    },\r\n    onClick: props.onClick,\r\n    min: props.min,\r\n    max: props.max\r\n  };\r\n\r\n  if (props.step) {\r\n    inputProps.step = props.step;\r\n  }\r\n\r\n  //make the input as tall as the tallest element, track or thumb, so the entire area becomes interactive\r\n  //Makes it possible to design sliders with thin tracks and tall thumbs\r\n\r\n  if (hasUnitPx(props.thumbHeight)) {\r\n    if (hasUnitPx(props.trackHeight)) {\r\n      const thumbHeight = Number(props.thumbHeight.slice(0, -2));\r\n      const trackHeight = Number(props.trackHeight.slice(0, -2));\r\n      inputProps.style.height = Math.max(thumbHeight, trackHeight) + 'px';\r\n    } else {\r\n      inputProps.style.height = props.thumbHeight;\r\n    }\r\n  } else {\r\n    inputProps.style.height = props.trackHeight;\r\n  }\r\n\r\n  const divStyle = {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    ...style\r\n  };\r\n\r\n  const valueFactor = (value - props.min) / (props.max - props.min);\r\n\r\n  const trackStyle: React.CSSProperties = {\r\n    position: 'absolute',\r\n    width: '100%',\r\n    height: props.trackHeight,\r\n    background: `linear-gradient(to right, ${props.trackActiveColor} 0%, ${props.trackActiveColor} ${\r\n      valueFactor * 100\r\n    }%, ${props.trackColor} ${valueFactor * 100}%, ${props.trackColor} 100%)`\r\n  };\r\n\r\n  setBorderStyle(trackStyle, 'track', props);\r\n  setBorderRadius(trackStyle, 'track', props);\r\n  setShadow(trackStyle, 'track', props);\r\n\r\n  const thumbStyle: React.CSSProperties = {\r\n    position: 'absolute',\r\n    left: 'calc((100% - ' + props.thumbWidth + ') * ' + valueFactor + ')',\r\n    width: props.thumbWidth,\r\n    height: props.thumbHeight,\r\n    backgroundColor: props.thumbColor\r\n  };\r\n\r\n  setBorderStyle(thumbStyle, 'thumb', props);\r\n  setBorderRadius(thumbStyle, 'thumb', props);\r\n  setShadow(thumbStyle, 'thumb', props);\r\n\r\n  return (\r\n    <div style={divStyle}>\r\n      <div style={trackStyle} />\r\n      <div style={thumbStyle} />\r\n      <input\r\n        className={className}\r\n        {...Utils.controlEvents(props)}\r\n        type=\"range\"\r\n        {...inputProps}\r\n        value={value}\r\n        disabled={!props.enabled}\r\n        onChange={(e) => onValueChanged(Number(e.target.value))}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import { Slider } from '../../components/controls/Slider';\r\nimport guid from '../../guid';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\nconst thumbPopout = { group: 'thumb-styles', label: 'Thumb Styles' };\r\nconst trackPopout = { group: 'track-styles', label: 'Track Styles' };\r\n\r\nconst RangeNode = {\r\n  name: 'net.noodl.controls.range',\r\n  displayNodeName: 'Slider',\r\n  docs: 'https://docs.noodl.net/nodes/ui-controls/slider',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'States',\r\n      'Mounted',\r\n      'Hover Events',\r\n      'Pointer Events',\r\n      'Focus Events'\r\n    ]\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n    this.props.sizeMode = 'contentHeight';\r\n    this.props.id = 'input-' + guid();\r\n\r\n    this.props.value = this.props.min;\r\n    this._internal.outputValue = 0;\r\n\r\n    this.props._nodeId = this.id;\r\n\r\n    //this is used by the range to communicate with the node whenever the range changes value\r\n    this.props.updateOutputValue = (value: string | number) => {\r\n      value = typeof value === 'string' ? parseFloat(value) : value;\r\n\r\n      const valueChanged = this._internal.outputValue !== value;\r\n      if (valueChanged) {\r\n        this._internal.outputValue = value;\r\n        this.flagOutputDirty('value');\r\n        this._updateOutputValuePercent(value);\r\n        this.sendSignalOnOutput('onChange');\r\n      }\r\n\r\n      // On first mount, output the initial percentage.\r\n      if (!this._internal.valuePercent) {\r\n        this._updateOutputValuePercent(value);\r\n      }\r\n    };\r\n\r\n    this.props.updateOutputValue(this.props.value); // Set the value output to an initial value\r\n  },\r\n  getReactComponent() {\r\n    return Slider;\r\n  },\r\n  inputs: {\r\n    value: {\r\n      type: 'string',\r\n      displayName: 'Value',\r\n      group: 'General',\r\n      index: 100,\r\n      set(value) {\r\n        this._setInputValue(value);\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    value: {\r\n      type: 'number',\r\n      displayName: 'Value',\r\n      group: 'States',\r\n      get() {\r\n        return this._internal.outputValue;\r\n      }\r\n    },\r\n    valuePercent: {\r\n      type: 'number',\r\n      displayName: 'Value Percent',\r\n      group: 'States',\r\n      get() {\r\n        return this._internal.valuePercent;\r\n      }\r\n    },\r\n    onChange: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  inputProps: {\r\n    min: {\r\n      type: 'number',\r\n      displayName: 'Min',\r\n      group: 'General',\r\n      default: 0,\r\n      index: 100,\r\n      onChange() {\r\n        this._setInputValue(this.props.value);\r\n      }\r\n    },\r\n    max: {\r\n      type: 'number',\r\n      displayName: 'Max',\r\n      group: 'General',\r\n      default: 100,\r\n      index: 100,\r\n      onChange() {\r\n        this._setInputValue(this.props.value);\r\n      }\r\n    },\r\n    step: {\r\n      type: 'number',\r\n      displayName: 'Step',\r\n      group: 'General',\r\n      default: 1,\r\n      index: 100\r\n    },\r\n    width: {\r\n      index: 11,\r\n      group: 'Dimensions',\r\n      displayName: 'Width',\r\n      type: {\r\n        name: 'number',\r\n        units: ['%', 'px', 'vw'],\r\n        defaultUnit: '%'\r\n      },\r\n      default: 100,\r\n      allowVisualStates: true\r\n    },\r\n    // Styles\r\n    thumbWidth: {\r\n      group: 'Thumb Style',\r\n      displayName: 'Width',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', 'vw', '%'],\r\n        defaultUnit: 'px',\r\n        allowEditOnly: true\r\n      },\r\n      default: 16,\r\n      popout: thumbPopout,\r\n      allowVisualStates: true\r\n    },\r\n    thumbHeight: {\r\n      group: 'Thumb Style',\r\n      displayName: 'Height',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', 'vh', '%'],\r\n        defaultUnit: 'px',\r\n        allowEditOnly: true\r\n      },\r\n      default: 16,\r\n      popout: thumbPopout,\r\n      allowVisualStates: true\r\n    },\r\n    thumbColor: {\r\n      group: 'Thumb Style',\r\n      displayName: 'Color',\r\n      type: { name: 'color', allowEditOnly: true },\r\n      default: '#000000',\r\n      popout: thumbPopout,\r\n      allowVisualStates: true\r\n    },\r\n    trackHeight: {\r\n      group: 'Track Style',\r\n      displayName: 'Height',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', 'vh', '%'],\r\n        defaultUnit: 'px',\r\n        allowEditOnly: true\r\n      },\r\n      default: 6,\r\n      popout: trackPopout,\r\n      allowVisualStates: true\r\n    },\r\n    trackColor: {\r\n      group: 'Track Style',\r\n      displayName: 'Inactive Color',\r\n      type: { name: 'color', allowEditOnly: true },\r\n      default: '#f0f0f0',\r\n      popout: trackPopout,\r\n      allowVisualStates: true\r\n    },\r\n    trackActiveColor: {\r\n      group: 'Track Style',\r\n      displayName: 'Active Color',\r\n      type: { name: 'color', allowEditOnly: true },\r\n      default: '#f0f0f0',\r\n      popout: trackPopout,\r\n      allowVisualStates: true\r\n    }\r\n  },\r\n  methods: {\r\n    _updateOutputValuePercent(value: number) {\r\n      const min = this.props.min;\r\n      const max = this.props.max;\r\n      const valuePercent = Math.floor(((value - min) / (max - min)) * 100);\r\n      const valuePercentChanged = this._internal.valuePercentChanged !== valuePercent;\r\n\r\n      this._internal.valuePercent = valuePercent;\r\n      valuePercentChanged && this.flagOutputDirty('valuePercent');\r\n    },\r\n    _setInputValue(newValue) {\r\n      //make sure value never goes out of range\r\n      const value = Math.max(this.props.min, Math.min(this.props.max, newValue || 0));\r\n\r\n      const changed = value !== this.props.value;\r\n\r\n      if (changed) {\r\n        this.props.value = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n//Add borders\r\nfunction addBorderInputs(definition, opts) {\r\n  opts = opts || {};\r\n  const defaults = opts.defaults || {};\r\n  const popout = opts.popout;\r\n\r\n  defaults.borderStyle = 'none';\r\n  defaults.borderWidth = 0;\r\n  defaults.borderColor = '#000000';\r\n\r\n  const prefixLabel = opts.propPrefix[0].toUpperCase() + opts.propPrefix.slice(1);\r\n\r\n  function defineBorderTab(definition, suffix, tabName, indexOffset) {\r\n    const styleName = opts.propPrefix + `Border${suffix}Style`;\r\n    const widthName = opts.propPrefix + `Border${suffix}Width`;\r\n    const colorName = opts.propPrefix + `Border${suffix}Color`;\r\n\r\n    let orNotSet = defaults.borderStyle !== 'none' ? 'OR borderStyle NOT SET' : '';\r\n\r\n    if (suffix) {\r\n      if (defaults[styleName] && defaults[styleName] !== 'none') orNotSet += `OR ${styleName} NOT SET`;\r\n      NodeSharedPortDefinitions.addDynamicInputPorts(\r\n        definition,\r\n        `${styleName} = solid OR ${styleName} = dashed OR ${styleName} = dotted OR borderStyle = solid OR borderStyle = dashed OR borderStyle = dotted ${orNotSet}`,\r\n        [`${widthName}`, `${colorName}`]\r\n      );\r\n    } else {\r\n      NodeSharedPortDefinitions.addDynamicInputPorts(\r\n        definition,\r\n        `${styleName} = solid OR ${styleName} = dashed OR ${styleName} = dotted ${orNotSet}`,\r\n        [`${widthName}`, `${colorName}`]\r\n      );\r\n    }\r\n\r\n    const tab = {\r\n      group: opts.propPrefix + '-border-styles',\r\n      tab: tabName,\r\n      label: suffix\r\n    };\r\n\r\n    const editorName = (name) => `${prefixLabel} ${name} ${suffix ? '(' + suffix + ')' : ''}`;\r\n    const index = 202 + indexOffset * 4;\r\n\r\n    const groupName = prefixLabel + ' Border Style';\r\n\r\n    NodeSharedPortDefinitions.addInputProps(definition, {\r\n      [styleName]: {\r\n        index: index + 1,\r\n        displayName: 'Border Style',\r\n        editorName: editorName('Border Style'),\r\n        group: groupName,\r\n        type: {\r\n          name: 'enum',\r\n          enums: [\r\n            { label: 'None', value: 'none' },\r\n            { label: 'Solid', value: 'solid' },\r\n            { label: 'Dotted', value: 'dotted' },\r\n            { label: 'Dashed', value: 'dashed' }\r\n          ]\r\n        },\r\n        default: defaults[`border${suffix}Style`],\r\n        tab,\r\n        popout,\r\n        allowVisualStates: true\r\n      },\r\n      [widthName]: {\r\n        index: index + 2,\r\n        displayName: 'Border Width',\r\n        editorName: editorName('Border Width'),\r\n        group: groupName,\r\n        type: {\r\n          name: 'number',\r\n          units: ['px'],\r\n          defaultUnit: 'px'\r\n        },\r\n        default: defaults[`border${suffix}Width`],\r\n        tab,\r\n        popout,\r\n        allowVisualStates: true\r\n      },\r\n      [colorName]: {\r\n        index: index + 3,\r\n        displayName: 'Border Color',\r\n        editorName: editorName('Border Color'),\r\n        group: groupName,\r\n        type: 'color',\r\n        default: defaults[`border${suffix}Color`],\r\n        tab,\r\n        popout,\r\n        allowVisualStates: true\r\n      }\r\n    });\r\n  }\r\n\r\n  defineBorderTab(definition, '', 'borders-all', 0);\r\n  defineBorderTab(definition, 'Left', 'borders-left', 1);\r\n  defineBorderTab(definition, 'Top', 'borders-top', 2);\r\n  defineBorderTab(definition, 'Right', 'borders-right', 3);\r\n  defineBorderTab(definition, 'Bottom', 'borders-bottom', 4);\r\n}\r\n\r\nfunction addBorderRadius(definition, opts) {\r\n  opts = opts || {};\r\n  const defaults = opts.defaults || {};\r\n  const popout = opts.popout;\r\n\r\n  if (!defaults.borderRadius) defaults.borderRadius = 0;\r\n\r\n  const prefixLabel = opts.propPrefix[0].toUpperCase() + opts.propPrefix.slice(1);\r\n\r\n  function defineCornerTab(definition, suffix, tabName, indexOffset) {\r\n    const editorName = (name) => `${prefixLabel} ${name} ${suffix ? '(' + suffix + ')' : ''}`;\r\n\r\n    const tab = {\r\n      group: opts.propPrefix + '-corners',\r\n      tab: tabName,\r\n      label: suffix\r\n    };\r\n    const radiusName = `Border${suffix}Radius`;\r\n\r\n    NodeSharedPortDefinitions.addInputProps(definition, {\r\n      [opts.propPrefix + radiusName]: {\r\n        index: 240 + indexOffset,\r\n        displayName: 'Corner Radius',\r\n        editorName: editorName('Corner Radius'),\r\n        group: prefixLabel + ' Corner Radius',\r\n        type: {\r\n          name: 'number',\r\n          units: ['px', '%'],\r\n          defaultUnit: 'px'\r\n        },\r\n        default: defaults[`border${suffix}Radius`],\r\n        tab,\r\n        popout\r\n      }\r\n    });\r\n  }\r\n\r\n  defineCornerTab(definition, '', 'corners-all', 0);\r\n  defineCornerTab(definition, 'TopLeft', 'corners-top-left', 1);\r\n  defineCornerTab(definition, 'TopRight', 'corners-top-right', 2);\r\n  defineCornerTab(definition, 'BottomRight', 'corners-bottom-right', 3);\r\n  defineCornerTab(definition, 'BottomLeft', 'corners-bottom-left', 4);\r\n}\r\n\r\nfunction addShadowInputs(definition, opts) {\r\n  opts = opts || {};\r\n  const popout = opts.popout;\r\n  const prefix = opts.propPrefix;\r\n\r\n  NodeSharedPortDefinitions.addDynamicInputPorts(definition, `${prefix}BoxShadowEnabled = true`, [\r\n    `${prefix}BoxShadowOffsetX`,\r\n    `${prefix}BoxShadowOffsetY`,\r\n    `${prefix}BoxShadowInset`,\r\n    `${prefix}BoxShadowBlurRadius`,\r\n    `${prefix}BoxShadowSpreadRadius`,\r\n    `${prefix}BoxShadowColor`\r\n  ]);\r\n\r\n  const prefixLabel = opts.propPrefix[0].toUpperCase() + opts.propPrefix.slice(1);\r\n  const editorName = (name) => `${prefixLabel} ${name}`;\r\n\r\n  NodeSharedPortDefinitions.addInputProps(definition, {\r\n    [`${prefix}BoxShadowEnabled`]: {\r\n      index: 250,\r\n      group: opts.group || 'Box Shadow',\r\n      displayName: 'Shadow Enabled',\r\n      editorName: editorName('Shadow Enabled'),\r\n      type: 'boolean',\r\n      allowVisualStates: true,\r\n      popout\r\n    },\r\n    [`${prefix}BoxShadowOffsetX`]: {\r\n      index: 251,\r\n      group: opts.group || 'Box Shadow',\r\n      displayName: 'Offset X',\r\n      editorName: editorName('Offset X'),\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      allowVisualStates: true,\r\n      popout\r\n    },\r\n    [`${prefix}BoxShadowOffsetY`]: {\r\n      index: 252,\r\n      group: opts.group || 'Box Shadow',\r\n      displayName: 'Offset Y',\r\n      editorName: editorName('Offset Y'),\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      allowVisualStates: true,\r\n      popout\r\n    },\r\n    [`${prefix}BoxShadowBlurRadius`]: {\r\n      index: 253,\r\n      group: opts.group || 'Box Shadow',\r\n      displayName: 'Blur Radius',\r\n      editorName: editorName('Blur Radius'),\r\n      default: 5,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      allowVisualStates: true,\r\n      popout\r\n    },\r\n    [`${prefix}BoxShadowSpreadRadius`]: {\r\n      index: 254,\r\n      group: opts.group || 'Box Shadow',\r\n      displayName: 'Spread Radius',\r\n      editorName: editorName('Spread Radius'),\r\n      default: 2,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      allowVisualStates: true,\r\n      popout\r\n    },\r\n    [`${prefix}BoxShadowInset`]: {\r\n      index: 255,\r\n      group: opts.group || 'Box Shadow',\r\n      displayName: 'Inset',\r\n      editorName: editorName('Inset'),\r\n      type: 'boolean',\r\n      default: false,\r\n      allowVisualStates: true,\r\n      popout\r\n    },\r\n    [`${prefix}BoxShadowColor`]: {\r\n      index: 256,\r\n      group: opts.group || 'Box Shadow',\r\n      displayName: 'Shadow Color',\r\n      editorName: editorName('Shadow Color'),\r\n      type: 'color',\r\n      default: '#00000033',\r\n      allowVisualStates: true,\r\n      popout\r\n    }\r\n  });\r\n}\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(RangeNode);\r\nNodeSharedPortDefinitions.addTransformInputs(RangeNode);\r\nNodeSharedPortDefinitions.addMarginInputs(RangeNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(RangeNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(RangeNode);\r\naddBorderInputs(RangeNode, { propPrefix: 'track', popout: trackPopout });\r\naddBorderRadius(RangeNode, { propPrefix: 'track', popout: trackPopout });\r\naddShadowInputs(RangeNode, {\r\n  propPrefix: 'track',\r\n  popout: trackPopout,\r\n  group: 'Track Box Shadow'\r\n});\r\n\r\naddBorderInputs(RangeNode, { propPrefix: 'thumb', popout: thumbPopout });\r\naddBorderRadius(RangeNode, { propPrefix: 'thumb', popout: thumbPopout });\r\naddShadowInputs(RangeNode, {\r\n  propPrefix: 'thumb',\r\n  popout: thumbPopout,\r\n  group: 'Thumb Box Shadow'\r\n});\r\n\r\nUtils.addControlEventsAndStates(RangeNode);\r\n\r\nexport default createNodeFromReactComponent(RangeNode);\r\n","import React from 'react';\r\n\r\nimport Layout from '../../../layout';\r\nimport Utils from '../../../nodes/controls/utils';\r\nimport { Noodl, Slot } from '../../../types';\r\n\r\n//this stops a text field from being unfocused by the clickHandler in the viewer that handles focus globally.\r\n//The specific case is when a mouseDown is registered in the input, but the mouseUp is outside.\r\n//It'll trigger a focus change that'll blur the input field, which is annyoing when you're selecting text\r\nfunction preventGlobalFocusChange(e) {\r\n  e.stopPropagation();\r\n  window.removeEventListener('click', preventGlobalFocusChange, true);\r\n}\r\n\r\nexport interface TextInputProps extends Noodl.ReactProps {\r\n  id: string;\r\n  type: 'text' | 'textArea' | 'email' | 'number' | 'password' | 'url';\r\n  textStyle: Noodl.TextStyle;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  enabled: boolean;\r\n\r\n  placeholder: string;\r\n  maxLength: number;\r\n\r\n  startValue: string;\r\n  value: string;\r\n\r\n  useLabel: boolean;\r\n  label: string;\r\n  labelSpacing: string;\r\n  labeltextStyle: Noodl.TextStyle;\r\n\r\n  useIcon: boolean;\r\n  iconPlacement: 'left' | 'right';\r\n  iconSpacing: string;\r\n  iconSourceType: 'image' | 'icon';\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n\r\n  onTextChanged?: (value: string) => void;\r\n  onEnter?: () => void;\r\n\r\n  children: Slot;\r\n}\r\n\r\n// Based on (HTMLTextAreaElement | HTMLInputElement)\r\ntype InputRef = (HTMLTextAreaElement | HTMLInputElement) & {\r\n  noodlNode?: Noodl.ReactProps['noodlNode'];\r\n};\r\n\r\ntype State = {\r\n  value: string;\r\n};\r\n\r\nexport class TextInput extends React.Component<TextInputProps, State> {\r\n  ref: React.MutableRefObject<InputRef>;\r\n\r\n  constructor(props: TextInputProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      value: props.startValue\r\n    } satisfies State;\r\n\r\n    this.ref = React.createRef();\r\n  }\r\n\r\n  setText(value: string) {\r\n    this.setState({ value });\r\n    this.props.onTextChanged && this.props.onTextChanged(value);\r\n  }\r\n\r\n  componentDidMount() {\r\n    //plumbing for the focused signals\r\n    this.ref.current.noodlNode = this.props.noodlNode;\r\n\r\n    this.setText(this.props.startValue);\r\n  }\r\n\r\n  render() {\r\n    const style: React.CSSProperties = { ...this.props.style };\r\n\r\n    Layout.size(style, this.props);\r\n    Layout.align(style, this.props);\r\n\r\n    if (style.opacity === 0) {\r\n      style.pointerEvents = 'none';\r\n    }\r\n\r\n    const { height, ...otherStylesTmp } = style;\r\n    \r\n    // otherStylesTmp is not React.CSSProperties, reassigning it will correct the type.\r\n    const otherStyles: React.CSSProperties = otherStylesTmp;\r\n\r\n    const props = this.props;\r\n\r\n    const _renderIcon = () => {\r\n      if (props.iconSourceType === 'image' && props.iconImageSource !== undefined)\r\n        return (\r\n          <img\r\n            alt=\"\"\r\n            src={props.iconImageSource}\r\n            style={{\r\n              width: props.iconSize,\r\n              height: props.iconSize\r\n            }}\r\n            onClick={() => this.focus()}\r\n          />\r\n        );\r\n      else if (props.iconSourceType === 'icon' && props.iconIconSource !== undefined) {\r\n        const style: React.CSSProperties = {\r\n          userSelect: 'none',\r\n          fontSize: props.iconSize,\r\n          color: props.iconColor\r\n        };\r\n        if (props.iconPlacement === 'left' || props.iconPlacement === undefined) style.marginRight = props.iconSpacing;\r\n        else style.marginLeft = props.iconSpacing;\r\n\r\n        if (props.iconIconSource.codeAsClass === true) {\r\n          return (\r\n            <span className={[props.iconIconSource.class, props.iconIconSource.code].join(' ')} style={style}></span>\r\n          );\r\n        } else {\r\n          return (\r\n            <span className={props.iconIconSource.class} style={style}>\r\n              {props.iconIconSource.code}\r\n            </span>\r\n          );\r\n        }\r\n      }\r\n\r\n      return null;\r\n    };\r\n\r\n    let className = 'ndl-controls-textinput ' + props.id;\r\n    if (props.className) className = className + ' ' + props.className;\r\n\r\n    let inputContent;\r\n\r\n    const inputStyles: React.CSSProperties = {\r\n      ...props.textStyle,\r\n      ...props.styles.input,\r\n      width: '100%',\r\n      height: '100%'\r\n    };\r\n\r\n    inputStyles.color = props.noodlNode.context.styles.resolveColor(inputStyles.color);\r\n\r\n    const inputProps = {\r\n      ...props.attrs,\r\n      id: props.id,\r\n      value: this.state.value,\r\n      ...Utils.controlEvents(props),\r\n      disabled: !props.enabled,\r\n      style: inputStyles,\r\n      className,\r\n      placeholder: props.placeholder,\r\n      maxLength: props.maxLength,\r\n      onChange: (e) => this.onChange(e)\r\n    };\r\n\r\n    if (props.type !== 'textArea') {\r\n      inputContent = (\r\n        <input\r\n          ref={(ref) => (this.ref.current = ref)}\r\n          type={this.props.type}\r\n          {...inputProps}\r\n          onKeyDown={(e) => this.onKeyDown(e)}\r\n          onMouseDown={() => window.addEventListener('click', preventGlobalFocusChange, true)}\r\n          noodl-style-tag=\"input\"\r\n        />\r\n      );\r\n    } else {\r\n      inputProps.style.resize = 'none'; //disable user resizing\r\n      inputContent = (\r\n        <textarea\r\n          ref={(ref) => (this.ref.current = ref)}\r\n          {...inputProps}\r\n          onKeyDown={(e) => this.onKeyDown(e)}\r\n          noodl-style-tag=\"input\"\r\n        />\r\n      );\r\n    }\r\n\r\n    const inputWrapperStyle = {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      ...props.styles.inputWrapper\r\n    };\r\n\r\n    const heightInPercent = height && height[String(height).length - 1] === '%';\r\n\r\n    if (props.useLabel) {\r\n      if (heightInPercent) {\r\n        inputWrapperStyle.flexGrow = 1;\r\n      } else {\r\n        inputWrapperStyle.height = height;\r\n      }\r\n    } else {\r\n      Object.assign(inputWrapperStyle, otherStyles);\r\n      inputWrapperStyle.height = height;\r\n    }\r\n\r\n    if (props.type !== 'textArea') {\r\n      inputWrapperStyle.alignItems = 'center';\r\n    }\r\n\r\n    const inputWithWrapper = (\r\n      <div style={inputWrapperStyle} noodl-style-tag=\"inputWrapper\">\r\n        {props.useIcon && props.iconPlacement === 'left' ? _renderIcon() : null}\r\n        {inputContent}\r\n        {props.useIcon && props.iconPlacement === 'right' ? _renderIcon() : null}\r\n      </div>\r\n    );\r\n\r\n    if (props.useLabel) {\r\n      otherStyles.display = 'flex';\r\n      otherStyles.flexDirection = 'column';\r\n      if (heightInPercent) otherStyles.height = height;\r\n\r\n      const labelStyle: React.CSSProperties = {\r\n        ...props.labeltextStyle,\r\n        ...props.styles.label,\r\n        marginBottom: props.labelSpacing\r\n      };\r\n      labelStyle.color = props.noodlNode.context.styles.resolveColor(labelStyle.color);\r\n\r\n      return (\r\n        <div style={otherStyles}>\r\n          <label htmlFor={props.id} style={labelStyle} noodl-style-tag=\"label\">\r\n            {props.label}\r\n          </label>\r\n          {inputWithWrapper}\r\n        </div>\r\n      );\r\n    } else {\r\n      return inputWithWrapper;\r\n    }\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    if (e.key === 'Enter' || e.which === 13) {\r\n      this.props.onEnter && this.props.onEnter();\r\n    }\r\n  }\r\n\r\n  onChange(event) {\r\n    const value = event.target.value;\r\n    this.setText(value);\r\n  }\r\n\r\n  focus() {\r\n    this.ref.current && this.ref.current.focus();\r\n  }\r\n\r\n  blur() {\r\n    this.ref.current && this.ref.current.blur();\r\n  }\r\n\r\n  hasFocus() {\r\n    return document.activeElement === this.ref.current;\r\n  }\r\n}\r\n","import { TextInput } from '../../components/controls/TextInput';\r\nimport guid from '../../guid';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\nfunction _styleTemplate(className, props) {\r\n  return `\r\n    .${className}::placeholder {\r\n        opacity: ${props.placeholderOpacity};\r\n    }\r\n    `;\r\n}\r\n\r\nconst TextInputNode = {\r\n  name: 'net.noodl.controls.textinput',\r\n  displayName: 'Text Input',\r\n  docs: 'https://docs.noodl.net/nodes/ui-controls/text-input',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  usePortAsLabel: 'label',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'label'\r\n  },\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Text',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'States',\r\n      'Mounted',\r\n      'Text Style',\r\n      'Label',\r\n      'Label Text Style',\r\n      'Hover Events',\r\n      'Pointer Events',\r\n      'Focus Events'\r\n    ]\r\n  },\r\n  getReactComponent() {\r\n    return TextInput;\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n    this.props.startValue = '';\r\n    this.props.id = this._internal.controlId = 'input-' + guid();\r\n  },\r\n  inputProps: {\r\n    type: {\r\n      displayName: 'Type',\r\n      group: 'Text',\r\n      index: 19,\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Text', value: 'text' },\r\n          { label: 'Text Area', value: 'textArea' },\r\n          { label: 'Email', value: 'email' },\r\n          { label: 'Number', value: 'number' },\r\n          { label: 'Password', value: 'password' },\r\n          { label: 'URL', value: 'url' }\r\n        ]\r\n      },\r\n      default: 'text'\r\n    },\r\n    placeholder: {\r\n      index: 22,\r\n      group: 'Text',\r\n      displayName: 'Placeholder',\r\n      default: 'Type here...',\r\n      type: {\r\n        name: 'string'\r\n      }\r\n    },\r\n    maxLength: {\r\n      group: 'Text',\r\n      displayName: 'Max length',\r\n      type: 'number',\r\n      index: 24\r\n    }\r\n  },\r\n  inputs: {\r\n    placeHolderOpacity: {\r\n      index: 23,\r\n      group: 'Text',\r\n      displayName: 'Placeholder opacity',\r\n      type: 'number',\r\n      default: 0.5,\r\n      set(value) {\r\n        const className = this._internal.controlId;\r\n        Utils.updateStylesForClass(className, { placeholderOpacity: value }, _styleTemplate);\r\n      }\r\n    },\r\n    set: {\r\n      group: 'Actions',\r\n      displayName: 'Set',\r\n      type: 'signal',\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          this.setText(this._internal.text);\r\n        });\r\n      }\r\n    },\r\n    startValue: {\r\n      index: 18,\r\n      displayName: 'Text',\r\n      type: 'string',\r\n      group: 'Text',\r\n      set(value) {\r\n        if (this._internal.text === value) return;\r\n\r\n        this._internal.text = value;\r\n        if (this.isInputConnected('set') === false) {\r\n          this.setText(value);\r\n        }\r\n      }\r\n    },\r\n    clear: {\r\n      type: 'signal',\r\n      group: 'Actions',\r\n      displayName: 'Clear',\r\n      valueChangedToTrue() {\r\n        this.clear();\r\n      }\r\n    },\r\n    focus: {\r\n      type: 'signal',\r\n      group: 'Actions',\r\n      displayName: 'Focus',\r\n      valueChangedToTrue() {\r\n        this.context.setNodeFocused(this, true);\r\n      }\r\n    },\r\n    blur: {\r\n      type: 'signal',\r\n      group: 'Actions',\r\n      displayName: 'Blur',\r\n      valueChangedToTrue() {\r\n        this.context.setNodeFocused(this, false);\r\n      }\r\n    },\r\n    textAlignX: {\r\n      group: 'Text Alignment',\r\n      index: 13,\r\n      displayName: 'Text Horizontal Align',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'left', value: 'left' },\r\n          { label: 'center', value: 'center' },\r\n          { label: 'right', value: 'right' }\r\n        ],\r\n        alignComp: 'justify'\r\n      },\r\n      default: 'left',\r\n      set(value) {\r\n        switch (value) {\r\n          case 'left':\r\n            this.setStyle({ textAlign: 'left' }, 'input');\r\n            break;\r\n          case 'center':\r\n            this.setStyle({ textAlign: 'center' }, 'input');\r\n            break;\r\n          case 'right':\r\n            this.setStyle({ textAlign: 'right' }, 'input');\r\n            break;\r\n        }\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 100,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: 'transparent',\r\n      allowVisualStates: true,\r\n      styleTag: 'inputWrapper'\r\n    }\r\n  },\r\n  outputProps: {\r\n    // Value\r\n    onTextChanged: {\r\n      group: 'General',\r\n      displayName: 'Text',\r\n      type: 'string',\r\n      index: 1,\r\n      onChange() {\r\n        this.sendSignalOnOutput('textChanged');\r\n      }\r\n    },\r\n\r\n    // Events\r\n    onEnter: {\r\n      group: 'Events',\r\n      displayName: 'On Enter',\r\n      type: 'signal'\r\n    }\r\n  },\r\n  outputs: {\r\n    textChanged: {\r\n      displayName: 'Text Changed',\r\n      type: 'signal',\r\n      group: 'General',\r\n      index: 2\r\n    }\r\n  },\r\n  methods: {\r\n    _focus() {\r\n      if (!this.innerReactComponentRef) return;\r\n      this.innerReactComponentRef.focus();\r\n    },\r\n    _blur() {\r\n      if (!this.innerReactComponentRef) return;\r\n      this.innerReactComponentRef.blur();\r\n    },\r\n    clear() {\r\n      this.props.startValue = '';\r\n      if (this.innerReactComponentRef) {\r\n        this.innerReactComponentRef.setText('');\r\n      }\r\n    },\r\n    setText(text) {\r\n      this.props.startValue = text;\r\n      if (this.innerReactComponentRef) {\r\n        //the text component is currently mounted, and will signal the onTextChanged output\r\n        if (this.innerReactComponentRef.hasFocus() === false) {\r\n          this.innerReactComponentRef.setText(text);\r\n        }\r\n      } else if (this.outputPropValues['onTextChanged'] !== text) {\r\n        //text component isn't mounted yet, set the output manually\r\n        this.outputPropValues['onTextChanged'] = text;\r\n        this.flagOutputDirty('onTextChanged');\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(TextInputNode, {\r\n  defaultSizeMode: 'contentSize',\r\n  contentLabel: 'Text'\r\n});\r\nNodeSharedPortDefinitions.addIconInputs(TextInputNode, {\r\n  enableIconPlacement: true,\r\n  defaults: { useIcon: false, iconColor: '#000000' }\r\n});\r\nNodeSharedPortDefinitions.addLabelInputs(TextInputNode, {\r\n  enableSpacing: true,\r\n  styleTag: 'label',\r\n  displayName: 'Label'\r\n});\r\n\r\nNodeSharedPortDefinitions.addTextStyleInputs(TextInputNode, {\r\n  styleTag: 'input',\r\n  portPrefix: '',\r\n  portIndex: 18,\r\n  popout: {\r\n    group: 'input-text-style',\r\n    label: 'Text Style',\r\n    parentGroup: 'Text'\r\n  }\r\n});\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(TextInputNode);\r\nNodeSharedPortDefinitions.addTransformInputs(TextInputNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(TextInputNode, {\r\n  styleTag: 'inputWrapper'\r\n});\r\nNodeSharedPortDefinitions.addMarginInputs(TextInputNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(TextInputNode);\r\nNodeSharedPortDefinitions.addBorderInputs(TextInputNode, {\r\n  styleTag: 'inputWrapper'\r\n});\r\nNodeSharedPortDefinitions.addShadowInputs(TextInputNode, {\r\n  styleTag: 'inputWrapper'\r\n});\r\nUtils.addControlEventsAndStates(TextInputNode);\r\n\r\nexport default createNodeFromReactComponent(TextInputNode);\r\n","export default class ASyncQueue {\r\n  constructor() {\r\n    this.queue = [];\r\n    this.pendingPromise = false;\r\n  }\r\n\r\n  enqueue(promise) {\r\n    return new Promise((resolve, reject) => {\r\n      this.queue.push({\r\n        promise,\r\n        resolve,\r\n        reject\r\n      });\r\n      this.dequeue();\r\n    });\r\n  }\r\n\r\n  dequeue() {\r\n    if (this.workingOnPromise) {\r\n      return false;\r\n    }\r\n    const item = this.queue.shift();\r\n    if (!item) {\r\n      return false;\r\n    }\r\n    try {\r\n      this.workingOnPromise = true;\r\n      item\r\n        .promise()\r\n        .then((value) => {\r\n          this.workingOnPromise = false;\r\n          item.resolve(value);\r\n          this.dequeue();\r\n        })\r\n        .catch((err) => {\r\n          this.workingOnPromise = false;\r\n          item.reject(err);\r\n          this.dequeue();\r\n        });\r\n    } catch (err) {\r\n      this.workingOnPromise = false;\r\n      item.reject(err);\r\n      this.dequeue();\r\n    }\r\n    return true;\r\n  }\r\n}\r\n","import React from 'react';\r\n\r\nimport ASyncQueue from '../../async-queue';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst { useEffect } = require('react');\r\n\r\nconst guid = require('../../guid');\r\n\r\nconst NavigationHandler = require('./navigation-handler');\r\nconst NoodlRuntime = require('@noodl/runtime');\r\n\r\nconst Transitions = require('./transitions');\r\n\r\nfunction PageStackReactComponent(props) {\r\n  const { didMount, willUnmount, style, children } = props;\r\n\r\n  useEffect(() => {\r\n    didMount();\r\n    return () => {\r\n      willUnmount();\r\n    };\r\n  }, []);\r\n\r\n  return <div style={style}>{children}</div>;\r\n}\r\n\r\nconst PageStack = {\r\n  name: 'Page Stack',\r\n  displayNodeName: 'Component Stack',\r\n  category: 'Visuals',\r\n  docs: 'https://docs.noodl.net/nodes/component-stack/component-stack-node',\r\n  useVariants: false,\r\n  initialize() {\r\n    this._internal.stack = [];\r\n\r\n    this._internal.topPageName = '';\r\n    this._internal.stackDepth = 0;\r\n\r\n    this._internal.pageInfo = {};\r\n\r\n    this._internal.asyncQueue = new ASyncQueue();\r\n\r\n    this.onScheduleReset = () => {\r\n      this.scheduleReset();\r\n    };\r\n\r\n    this.props.didMount = () => {\r\n      this._internal.isMounted = true;\r\n\r\n      // Listen to push state events and update stack\r\n      if (window.history && window.history.pushState) {\r\n        //this is event is manually sent on push, so covers both pop and push state\r\n        window.addEventListener('popstate', this.onScheduleReset);\r\n      } else {\r\n        // Only hash support\r\n        window.addEventListener('hashchange', this.onScheduleReset);\r\n      }\r\n\r\n      this._registerPageStack();\r\n    };\r\n\r\n    this.props.willUnmount = () => {\r\n      this._internal.isMounted = false;\r\n\r\n      window.removeEventListener('popstate', this.onScheduleReset);\r\n      window.removeEventListener('hashchange', this.onScheduleReset);\r\n\r\n      this._deregisterPageStack();\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal.stack.length === 0) {\r\n      return 'No active page';\r\n    }\r\n\r\n    const info = [{ type: 'text', value: 'Active Components:' }];\r\n\r\n    return info.concat(\r\n      this._internal.stack.map((p) => {\r\n        const pageInfo = this._findPage(p.pageId);\r\n        return {\r\n          type: 'text',\r\n          value: '- ' + pageInfo.label\r\n        };\r\n      })\r\n    );\r\n  },\r\n  defaultCss: {\r\n    width: '100%',\r\n    flex: '1 1 100%',\r\n    position: 'relative',\r\n    display: 'flex',\r\n    flexDirection: 'column'\r\n  },\r\n  getReactComponent() {\r\n    return PageStackReactComponent;\r\n  },\r\n  inputs: {\r\n    name: {\r\n      type: { name: 'string', identifierOf: 'PackStack' },\r\n      displayName: 'Name',\r\n      group: 'General',\r\n      default: 'Main',\r\n      set: function (value) {\r\n        this._deregisterPageStack();\r\n        this._internal.name = value;\r\n\r\n        if (this._internal.isMounted) {\r\n          this._registerPageStack();\r\n        }\r\n      }\r\n    },\r\n    /*\tstartPage: {\r\n\t\t\ttype: 'component',\r\n\t\t\tdisplayName: 'Start Page',\r\n\t\t\tgroup: 'General',\r\n\t\t\tset: function (value) {\r\n\t\t\t\tthis._internal.startPage = value;\r\n\t\t\t\tthis.scheduleReset();\r\n\t\t\t}\r\n\t\t},*/\r\n    useRoutes: {\r\n      type: 'boolean',\r\n      displayName: 'Use Routes',\r\n      group: 'General',\r\n      default: false,\r\n      set: function (value) {\r\n        this._internal.useRoutes = !!value;\r\n      }\r\n    },\r\n    clip: {\r\n      displayName: 'Clip Content',\r\n      type: 'boolean',\r\n      group: 'Layout',\r\n      default: true,\r\n      set(value) {\r\n        if (value) {\r\n          this.setStyle({ overflow: 'hidden' });\r\n        } else {\r\n          this.removeStyle(['overflow']);\r\n        }\r\n      }\r\n    },\r\n    pages: {\r\n      type: 'proplist',\r\n      displayName: 'Components',\r\n      group: 'Components',\r\n      set: function (value) {\r\n        this._internal.pages = value;\r\n        if (this._internal.isMounted) {\r\n          this.scheduleReset();\r\n        }\r\n      }\r\n    },\r\n    reset: {\r\n      type: 'signal',\r\n      displayName: 'Reset',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleReset();\r\n      }\r\n    }\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      type: 'color',\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      default: 'transparent',\r\n      applyDefault: false\r\n    }\r\n  },\r\n  outputs: {\r\n    topPageName: {\r\n      type: 'string',\r\n      displayName: 'Top Component Name',\r\n      group: 'General',\r\n      get() {\r\n        return this._internal.topPageName;\r\n      }\r\n    },\r\n    stackDepth: {\r\n      type: 'number',\r\n      displayName: 'Stack Depth',\r\n      group: 'General',\r\n      get() {\r\n        return this._internal.stackDepth;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    _registerPageStack() {\r\n      NavigationHandler.instance.registerPageStack(this._internal.name, this);\r\n    },\r\n    _deregisterPageStack() {\r\n      NavigationHandler.instance.deregisterPageStack(this._internal.name, this);\r\n    },\r\n    /**\r\n     * @param {String} pageIdOrLabel\r\n     */\r\n    _findPage(pageIdOrLabel) {\r\n      if (this._internal.pageInfo[pageIdOrLabel]) {\r\n        const pageInfo = this._internal.pageInfo[pageIdOrLabel];\r\n        const pageRef = this._internal.pages.find((x) => x.id === pageIdOrLabel);\r\n        return {\r\n          component: String(pageInfo.component),\r\n          label: String(pageRef.label),\r\n          id: String(pageIdOrLabel)\r\n        };\r\n      }\r\n\r\n      const pageRef = this._internal.pages.find((x) => x.label === pageIdOrLabel);\r\n      if (pageRef) {\r\n        const pageInfo = this._internal.pageInfo[pageRef.id];\r\n        return {\r\n          component: String(pageInfo.component),\r\n          label: String(pageRef.label),\r\n          id: String(pageRef.id)\r\n        };\r\n      }\r\n\r\n      return undefined;\r\n    },\r\n    setPageOutputs(outputs) {\r\n      for (const prop in outputs) {\r\n        this._internal[prop] = outputs[prop];\r\n        this.flagOutputDirty(prop);\r\n      }\r\n    },\r\n    scheduleReset() {\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledReset) {\r\n        internal.hasScheduledReset = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          internal.hasScheduledReset = false;\r\n          this.reset();\r\n        });\r\n      }\r\n    },\r\n    createPageContainer() {\r\n      const group = this.nodeScope.createPrimitiveNode('Group');\r\n      group.setStyle({ flex: '1 0 100%' });\r\n      return group;\r\n    },\r\n    reset() {\r\n      this._internal.asyncQueue.enqueue(this.resetAsync.bind(this));\r\n    },\r\n    async resetAsync() {\r\n      var children = this.getChildren();\r\n      for (var i in children) {\r\n        var c = children[i];\r\n        this.removeChild(c);\r\n        this.nodeScope.deleteNode(c);\r\n      }\r\n\r\n      if (this._internal.pages === undefined || this._internal.pages.length === 0) return;\r\n\r\n      let startPageId;\r\n      let params = {};\r\n\r\n      var pageFromUrl = this.matchPageFromUrl();\r\n      if (pageFromUrl !== undefined) {\r\n        // We have an url matching a page, use that page as start page\r\n        startPageId = pageFromUrl.pageId;\r\n\r\n        params = Object.assign({}, pageFromUrl.query, pageFromUrl.params);\r\n      } else {\r\n        startPageId = this._internal.startPageId;\r\n        if (startPageId === undefined) startPageId = this._internal.pages[0].id;\r\n      }\r\n\r\n      // Find the page by either ID or by Label\r\n      const pageInfo = this._findPage(startPageId);\r\n      if (pageInfo === undefined || pageInfo.component === undefined) {\r\n        // No page was found\r\n        return;\r\n      }\r\n\r\n      var content = await this.nodeScope.createNode(pageInfo.component, guid());\r\n\r\n      for (var key in params) {\r\n        content.setInputValue(key, params[key]);\r\n      }\r\n\r\n      const group = this.createPageContainer();\r\n      group.addChild(content);\r\n\r\n      this.addChild(group);\r\n      this._internal.stack = [\r\n        {\r\n          from: null,\r\n          page: group,\r\n          pageId: startPageId,\r\n          pageInfo: pageInfo,\r\n          params: params,\r\n          componentName: this._internal.startPage\r\n        }\r\n      ];\r\n\r\n      this.setPageOutputs({\r\n        topPageName: pageInfo.label,\r\n        stackDepth: this._internal.stack.length\r\n      });\r\n    },\r\n    getRelativeURL() {\r\n      var top = this._internal.stack[this._internal.stack.length - 1];\r\n      if (top === undefined) return;\r\n\r\n      var urlPath = top.pageInfo.path;\r\n      if (urlPath === undefined) {\r\n        var pageItem = this._internal.pages.find((p) => p.id == top.pageId);\r\n        if (pageItem === undefined) return;\r\n\r\n        urlPath = pageItem.label.replace(/\\s+/g, '-').toLowerCase();\r\n      }\r\n\r\n      // First add matching parameters to path\r\n      var paramsInPath = urlPath.match(/{([^}]+)}/g);\r\n\r\n      var params = Object.assign({}, top.params);\r\n      if (paramsInPath) {\r\n        for (var param of paramsInPath) {\r\n          var key = param.replace(/[{}]/g, '');\r\n          if (top.params[key] !== undefined) {\r\n            urlPath = urlPath.replace(param, encodeURIComponent(params[key]));\r\n            delete params[key];\r\n          }\r\n        }\r\n      }\r\n\r\n      // Add other paramters as query\r\n      var query = [];\r\n      for (var key in params) {\r\n        query.push({\r\n          name: key,\r\n          value: params[key]\r\n        });\r\n      }\r\n\r\n      if (urlPath.startsWith('/')) urlPath = urlPath.substring(1);\r\n\r\n      return {\r\n        path: urlPath,\r\n        query: query\r\n      };\r\n    },\r\n    getNavigationAbsoluteURL() {\r\n      var parent = this.parent;\r\n\r\n      while (parent !== undefined && typeof parent.getNavigationAbsoluteURL !== 'function') {\r\n        parent = parent.getVisualParentNode();\r\n      }\r\n\r\n      if (parent === undefined) {\r\n        var parentUrl = { path: '', query: [] };\r\n      } else {\r\n        var parentUrl = parent.getNavigationAbsoluteURL();\r\n      }\r\n\r\n      var thisUrl = this.getRelativeURL();\r\n      if (thisUrl === undefined) return parentUrl;\r\n      else {\r\n        return {\r\n          path: parentUrl.path + (parentUrl.path.endsWith('/') ? '' : '/') + thisUrl.path,\r\n          query: parentUrl.query.concat(thisUrl.query)\r\n        };\r\n      }\r\n    },\r\n    _getLocationPath: function () {\r\n      var navigationPathType = NoodlRuntime.instance.getProjectSettings()['navigationPathType'];\r\n      if (navigationPathType === undefined || navigationPathType === 'hash') {\r\n        // Use hash as path\r\n        var hash = location.hash;\r\n        if (hash) {\r\n          if (hash[0] === '#') hash = hash.substring(1);\r\n          if (hash[0] === '/') hash = hash.substring(1);\r\n        }\r\n        return hash;\r\n      } else {\r\n        // Use url as path\r\n        var path = location.pathname;\r\n        if (path) {\r\n          if (path[0] === '/') path = path.substring(1);\r\n        }\r\n        return path;\r\n      }\r\n    },\r\n    _getSearchParams: function () {\r\n      var match,\r\n        pl = /\\+/g, // Regex for replacing addition symbol with a space\r\n        search = /([^&=]+)=?([^&]*)/g,\r\n        decode = function (s) {\r\n          return decodeURIComponent(s.replace(pl, ' '));\r\n        },\r\n        query = window.location.search.substring(1);\r\n\r\n      var urlParams = {};\r\n      while ((match = search.exec(query))) urlParams[decode(match[1])] = decode(match[2]);\r\n\r\n      return urlParams;\r\n    },\r\n    getNavigationRemainingPath() {\r\n      return this._internal.remainingNavigationPath;\r\n    },\r\n    matchPageFromUrl(url) {\r\n      if (!this._internal.useRoutes) return;\r\n      if (this._internal.pages === undefined || this._internal.pages.length === 0) return;\r\n\r\n      // Attempt to find relative path from closest navigation parent\r\n      var parent = this.parent;\r\n      while (parent !== undefined && typeof parent.getNavigationRemainingPath !== 'function') {\r\n        parent = parent.getVisualParentNode();\r\n      }\r\n\r\n      if (parent === undefined) {\r\n        var urlPath = this._getLocationPath();\r\n        if (urlPath[0] === '/') urlPath = urlPath.substring(1);\r\n        var pathParts = urlPath.split('/');\r\n      } else {\r\n        var pathParts = parent.getNavigationRemainingPath();\r\n      }\r\n      if (pathParts === undefined) return;\r\n\r\n      var urlQuery = this._getSearchParams();\r\n\r\n      function _matchPathParts(path, pattern) {\r\n        var params = {};\r\n        for (var i = 0; i < pattern.length; i++) {\r\n          if (path[i] === undefined) return;\r\n\r\n          var _p = pattern[i];\r\n          if (_p[0] === '{' && _p[_p.length - 1] === '}') {\r\n            // This is a param, collect it\r\n            params[_p.substring(1, _p.length - 1)] = decodeURIComponent(path[i]);\r\n          } else if (_p !== path[i]) return;\r\n        }\r\n        return {\r\n          params: params,\r\n          remainingPathParts: path.splice(pattern.length)\r\n        };\r\n      }\r\n\r\n      for (var page of this._internal.pages) {\r\n        var pageInfo = this._internal.pageInfo[page.id];\r\n        if (pageInfo === undefined) continue;\r\n\r\n        var pagePattern = pageInfo.path;\r\n        if (pagePattern === undefined) {\r\n          pagePattern = page.label.replace(/\\s+/g, '-').toLowerCase();\r\n        }\r\n        if (pagePattern[0] === '/') pagePattern = pagePattern.substring(1);\r\n\r\n        let match = _matchPathParts(pathParts, pagePattern.split('/'));\r\n        if (match) {\r\n          // This page is a match\r\n          this._internal.remainingNavigationPath = match.remainingPathParts;\r\n          return {\r\n            pageId: page.id,\r\n            params: match.params,\r\n            query: urlQuery\r\n          };\r\n        }\r\n      }\r\n    },\r\n    _updateUrlWithTopPage() {\r\n      // Push the state to the browser url\r\n      if (this._internal.useRoutes && window.history !== undefined) {\r\n        var url = this.getNavigationAbsoluteURL();\r\n\r\n        var urlPath, hashPath;\r\n        var navigationPathType = NoodlRuntime.instance.getProjectSettings()['navigationPathType'];\r\n        if (navigationPathType === undefined || navigationPathType === 'hash') hashPath = url.path;\r\n        else urlPath = url.path;\r\n\r\n        var query = url.query.map((q) => q.name + '=' + q.value);\r\n        var compiledUrl =\r\n          (urlPath !== undefined ? urlPath : '') +\r\n          (query.length >= 1 ? '?' + query.join('&') : '') +\r\n          (hashPath !== undefined ? '#' + hashPath : '');\r\n\r\n        this._internal.remainingNavigationPath = undefined; // Reset remaining nav path\r\n        //\tconsole.log(compiledUrl);\r\n        window.history.pushState({}, '', compiledUrl);\r\n      }\r\n    },\r\n    replace(args) {\r\n      this._internal.asyncQueue.enqueue(this.replaceAsync.bind(this, args));\r\n    },\r\n    async replaceAsync(args) {\r\n      if (this._internal.pages === undefined || this._internal.pages.length === 0) {\r\n        return;\r\n      }\r\n\r\n      if (this._internal.isTransitioning) {\r\n        return;\r\n      }\r\n\r\n      const pageId = args.target || this._internal.pages[0].id;\r\n\r\n      // Find the page by either ID or by Label\r\n      const pageInfo = this._findPage(pageId);\r\n      if (pageInfo === undefined || pageInfo.component === undefined) {\r\n        // No page was found\r\n        return;\r\n      }\r\n\r\n      // Remove all current pages in the stack\r\n      var children = this.getChildren();\r\n      for (var i in children) {\r\n        var c = children[i];\r\n        this.removeChild(c);\r\n        this.nodeScope.deleteNode(c);\r\n      }\r\n\r\n      const group = this.createPageContainer();\r\n\r\n      // Create the page content\r\n      const content = await this.nodeScope.createNode(pageInfo.component, guid());\r\n      for (var key in args.params) {\r\n        content.setInputValue(key, args.params[key]);\r\n      }\r\n      group.addChild(content);\r\n\r\n      this.addChild(group);\r\n\r\n      // Replace stack\r\n      this._internal.stack = [\r\n        {\r\n          from: null,\r\n          page: group,\r\n          pageId: pageId,\r\n          pageInfo: pageInfo,\r\n          params: args.params,\r\n          componentName: args.target\r\n        }\r\n      ];\r\n\r\n      this.setPageOutputs({\r\n        topPageName: pageInfo.label,\r\n        stackDepth: this._internal.stack.length\r\n      });\r\n\r\n      this._updateUrlWithTopPage();\r\n\r\n      args.hasNavigated && args.hasNavigated();\r\n    },\r\n    navigate(args) {\r\n      this._internal.asyncQueue.enqueue(this.navigateAsync.bind(this, args));\r\n    },\r\n    async navigateAsync(args) {\r\n      if (this._internal.pages === undefined || this._internal.pages.length === 0) {\r\n        return;\r\n      }\r\n\r\n      if (this._internal.isTransitioning) {\r\n        return;\r\n      }\r\n\r\n      const pageId = args.target || this._internal.pages[0].id;\r\n\r\n      // Find the page by either ID or by Label\r\n      const pageInfo = this._findPage(pageId);\r\n      if (pageInfo === undefined || pageInfo.component === undefined) {\r\n        // No page was found\r\n        return;\r\n      }\r\n\r\n      // Create the container group\r\n      const group = this.createPageContainer();\r\n      group.setInputValue('position', 'absolute');\r\n\r\n      // Create the page content\r\n      const content = await this.nodeScope.createNode(pageInfo.component, guid());\r\n      for (var key in args.params) {\r\n        content.setInputValue(key, args.params[key]);\r\n      }\r\n      group.addChild(content);\r\n\r\n      // Connect navigate back nodes\r\n      const navigateBackNodes = content.nodeScope.getNodesWithType('PageStackNavigateBack');\r\n      if (navigateBackNodes && navigateBackNodes.length > 0) {\r\n        for (var j = 0; j < navigateBackNodes.length; j++) {\r\n          navigateBackNodes[j]._setBackCallback(this.back.bind(this));\r\n        }\r\n      }\r\n\r\n      // Push the new top\r\n      const top = this._internal.stack[this._internal.stack.length - 1];\r\n      const newTop = {\r\n        from: top.page,\r\n        page: group,\r\n        pageInfo: pageInfo,\r\n        pageId: pageId,\r\n        params: args.params,\r\n        transition: new Transitions[args.transition.type || 'Push'](top.page, group, args.transition),\r\n        backCallback: args.backCallback,\r\n        componentName: args.target\r\n      };\r\n      this._internal.stack.push(newTop);\r\n      this.setPageOutputs({\r\n        topPageName: pageInfo.label,\r\n        stackDepth: this._internal.stack.length\r\n      });\r\n      this._updateUrlWithTopPage();\r\n\r\n      newTop.transition.forward(0);\r\n\r\n      this._internal.isTransitioning = true;\r\n      newTop.transition.start({\r\n        end: () => {\r\n          this._internal.isTransitioning = false;\r\n\r\n          // Transition has completed, remove the previous top from the stack\r\n          this.removeChild(top.page);\r\n          group.setInputValue('position', 'relative');\r\n        }\r\n      });\r\n\r\n      this.addChild(group);\r\n\r\n      args.hasNavigated && args.hasNavigated();\r\n    },\r\n    back(args) {\r\n      if (this._internal.stack.length <= 1) return;\r\n      if (this._internal.isTransitioning) return;\r\n\r\n      var top = this._internal.stack[this._internal.stack.length - 1];\r\n\r\n      top.page.setInputValue('position', 'absolute');\r\n      // Insert the destination in the stack again\r\n      this.addChild(top.from, 0);\r\n      top.backCallback && top.backCallback(args.backAction, args.results);\r\n\r\n      // Find the page by either ID or by Label\r\n      const pageInfo = this._findPage(this._internal.stack[this._internal.stack.length - 2].pageId);\r\n\r\n      this.setPageOutputs({\r\n        topPageName: pageInfo.label,\r\n        stackDepth: this._internal.stack.length - 1\r\n      });\r\n\r\n      this._internal.isTransitioning = true;\r\n      top.transition.start({\r\n        end: () => {\r\n          this._internal.isTransitioning = false;\r\n\r\n          top.page.setInputValue('position', 'relative');\r\n          this.removeChild(top.page);\r\n          this.nodeScope.deleteNode(top.page);\r\n          this._internal.stack.pop();\r\n\r\n          this._updateUrlWithTopPage();\r\n        },\r\n        back: true\r\n      });\r\n    },\r\n    setPageComponent(pageId, component) {\r\n      var internal = this._internal;\r\n      if (!internal.pageInfo[pageId]) internal.pageInfo[pageId] = {};\r\n      internal.pageInfo[pageId].component = component;\r\n\r\n      // this.scheduleRefresh();\r\n    },\r\n    setPagePath(pageId, path) {\r\n      var internal = this._internal;\r\n      if (!internal.pageInfo[pageId]) internal.pageInfo[pageId] = {};\r\n      internal.pageInfo[pageId].path = path;\r\n\r\n      //  this.scheduleRefresh();\r\n    },\r\n    setStartPage(pageId) {\r\n      this._internal.startPageId = pageId;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith('pageComp-'))\r\n        return this.registerInput(name, {\r\n          set: this.setPageComponent.bind(this, name.substring('pageComp-'.length))\r\n        });\r\n\r\n      if (name.startsWith('pagePath-'))\r\n        return this.registerInput(name, {\r\n          set: this.setPagePath.bind(this, name.substring('pagePath-'.length))\r\n        });\r\n\r\n      if (name === 'startPage')\r\n        return this.registerInput(name, {\r\n          set: this.setStartPage.bind(this)\r\n        });\r\n    }\r\n  },\r\n  setup(context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _updatePorts() {\r\n        var ports = [];\r\n\r\n        if (node.parameters['pages'] !== undefined && node.parameters['pages'].length > 0) {\r\n          node.parameters['pages'].forEach((p) => {\r\n            // Component for page\r\n            ports.push({\r\n              name: 'pageComp-' + p.id,\r\n              displayName: 'Component',\r\n              editorName: p.label + ' | Component',\r\n              plug: 'input',\r\n              type: 'component',\r\n              parent: 'pages',\r\n              parentItemId: p.id\r\n            });\r\n\r\n            // Path for page\r\n            if (node.parameters['useRoutes'] === true) {\r\n              ports.push({\r\n                name: 'pagePath-' + p.id,\r\n                displayName: 'Path',\r\n                editorName: p.label + ' | Path',\r\n                plug: 'input',\r\n                type: 'string',\r\n                default: p.label.replace(/\\s+/g, '-').toLowerCase(),\r\n                parent: 'pages',\r\n                parentItemId: p.id\r\n              });\r\n            }\r\n          });\r\n\r\n          ports.push({\r\n            plug: 'input',\r\n            type: {\r\n              name: 'enum',\r\n              enums: node.parameters['pages'].map((p) => ({\r\n                label: p.label,\r\n                value: p.id\r\n              })),\r\n              allowEditOnly: true\r\n            },\r\n            group: 'General',\r\n            displayName: 'Start Page',\r\n            name: 'startPage',\r\n            default: node.parameters['pages'][0].id\r\n          });\r\n        }\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on('parameterUpdated', function (ev) {\r\n        if (ev.name === 'pages' || ev.name === 'useRoutes') _updatePorts();\r\n      });\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.Page Stack', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('Page Stack')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n\r\nexport default createNodeFromReactComponent(PageStack);\r\n","import React from 'react';\r\n\r\nimport type { TSFixme } from '../../../../typings/global';\r\nimport Layout from '../../../layout';\r\nimport { Noodl, Slot } from '../../../types';\r\n\r\ntype MetaTag = {\r\n  isProperty: boolean;\r\n  key: string;\r\n  displayName: string;\r\n  editorName?: string;\r\n  group: string;\r\n  type?: string;\r\n  popout?: TSFixme;\r\n};\r\n\r\nconst ogPopout = {\r\n  group: 'seo-og',\r\n  label: 'Open Graph',\r\n  parentGroup: 'Experimental SEO'\r\n};\r\n\r\nconst twitterPopout = {\r\n  group: 'seo-twitter',\r\n  label: 'Twitter',\r\n  parentGroup: 'Experimental SEO'\r\n};\r\n\r\nexport const META_TAGS: MetaTag[] = [\r\n  {\r\n    isProperty: true,\r\n    key: 'description',\r\n    displayName: 'Description',\r\n    group: 'Experimental SEO'\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: 'robots',\r\n    displayName: 'Robots',\r\n    group: 'Experimental SEO'\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: 'og:title',\r\n    displayName: 'Title',\r\n    editorName: 'OG Title',\r\n    group: 'General',\r\n    popout: ogPopout\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: 'og:description',\r\n    displayName: 'Description',\r\n    editorName: 'OG Description',\r\n    group: 'General',\r\n    popout: ogPopout\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: 'og:url',\r\n    displayName: 'Url',\r\n    editorName: 'OG Url',\r\n    group: 'General',\r\n    popout: ogPopout\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: 'og:type',\r\n    displayName: 'Type',\r\n    editorName: 'OG Type',\r\n    group: 'General',\r\n    popout: ogPopout\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: 'og:image',\r\n    displayName: 'Image',\r\n    editorName: 'OG Image',\r\n    group: 'Image',\r\n    popout: ogPopout\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: 'og:image:width',\r\n    displayName: 'Image Width',\r\n    editorName: 'OG Image Width',\r\n    group: 'Image',\r\n    popout: ogPopout\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: 'og:image:height',\r\n    displayName: 'Image Height',\r\n    editorName: 'OG Image Height',\r\n    group: 'Image',\r\n    popout: ogPopout\r\n  },\r\n  {\r\n    isProperty: false,\r\n    key: 'twitter:card',\r\n    displayName: 'Card',\r\n    editorName: 'Twitter Card',\r\n    group: 'General',\r\n    popout: twitterPopout\r\n  },\r\n  {\r\n    isProperty: false,\r\n    key: 'twitter:title',\r\n    displayName: 'Title',\r\n    editorName: 'Twitter Title',\r\n    group: 'General',\r\n    popout: twitterPopout\r\n  },\r\n  {\r\n    isProperty: false,\r\n    key: 'twitter:description',\r\n    displayName: 'Description',\r\n    editorName: 'Twitter Description',\r\n    group: 'General',\r\n    popout: twitterPopout\r\n  },\r\n  {\r\n    isProperty: false,\r\n    key: 'twitter:image',\r\n    displayName: 'Image',\r\n    editorName: 'Twitter Image',\r\n    group: 'General',\r\n    popout: twitterPopout\r\n  }\r\n];\r\n\r\ntype MetaTagKey = typeof META_TAGS[number]['key'];\r\n\r\nexport interface PageProps extends Noodl.ReactProps {\r\n  metatags?: Record<MetaTagKey, string>;\r\n\r\n  children: Slot;\r\n}\r\n\r\nexport function Page(props: PageProps) {\r\n  const { style, children } = props;\r\n\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  // Allow changing the metatags from inputs\r\n  META_TAGS.forEach((item) => {\r\n    const value = props.metatags && props.metatags[item.key];\r\n    // @ts-expect-error Noodl is globally defined.\r\n    Noodl.SEO.setMeta(item.key, value);\r\n  });\r\n\r\n  return (\r\n    <div style={style} className={props.className}>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n","import { META_TAGS, Page } from '../../components/navigation/Page';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst PageNode = {\r\n  name: 'Page',\r\n  displayNodeName: 'Page',\r\n  category: 'Visuals',\r\n  docs: 'https://docs.noodl.net/nodes/navigation/page',\r\n  useVariants: false,\r\n  mountedInput: false,\r\n  allowAsExportRoot: false,\r\n  singleton: true,\r\n  connectionPanel: {\r\n    groupPriority: ['General', 'Mounted']\r\n  },\r\n  initialize: function () {\r\n    this.props.layout = 'column'; //this allows the children to know what type of layout type they're in\r\n    if (this.isInputConnected('onPageReady')) {\r\n      this.nodeScope.context.eventEmitter.emit('SSR_PageLoading', this.id);\r\n    }\r\n  },\r\n  defaultCss: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    position: 'relative',\r\n    alignItems: 'flex-start',\r\n    flex: '1 1',\r\n    alignSelf: 'stretch'\r\n  },\r\n  getReactComponent() {\r\n    return Page;\r\n  },\r\n  inputs: {\r\n    // TODO: Enable with SSR\r\n    // onPageReady: {\r\n    //   displayName: 'Page Ready',\r\n    //   type: 'signal',\r\n    //   valueChangedToTrue() {\r\n    //     this.nodeScope.context.eventEmitter.emit('SSR_PageReady', this.id);\r\n    //   }\r\n    // },\r\n    sitemapIncluded: {\r\n      index: 80001,\r\n      displayName: 'Included',\r\n      group: 'Experimental Sitemap',\r\n      default: true,\r\n      type: {\r\n        name: 'boolean',\r\n        allowEditOnly: true\r\n      }\r\n    },\r\n    sitemapChangefreq: {\r\n      index: 80002,\r\n      displayName: 'Change Freq',\r\n      group: 'Experimental Sitemap',\r\n      default: 'weekly',\r\n      type: {\r\n        name: 'enum',\r\n        allowEditOnly: true,\r\n        enums: [\r\n          { label: 'always', value: 'always' },\r\n          { label: 'hourly', value: 'hourly' },\r\n          { label: 'daily', value: 'daily' },\r\n          { label: 'weekly', value: 'weekly' },\r\n          { label: 'monthly', value: 'monthly' },\r\n          { label: 'yearly', value: 'yearly' },\r\n          { label: 'never', value: 'never' }\r\n        ]\r\n      }\r\n    },\r\n    sitemapPriority: {\r\n      index: 80003,\r\n      displayName: 'Priority',\r\n      group: 'Experimental Sitemap',\r\n      default: 0.5,\r\n      type: {\r\n        name: 'number',\r\n        allowEditOnly: true\r\n      }\r\n    }\r\n    // NOTE: Hide this for now, this is going to be important for SSR\r\n    // sitemapScript: {\r\n    //   index: 80004,\r\n    //   displayName: 'Script',\r\n    //   group: 'Sitemap',\r\n    //   type: {\r\n    //     name: 'string',\r\n    //     allowEditOnly: true,\r\n    //     codeeditor: 'javascript'\r\n    //   }\r\n    // }\r\n  },\r\n  inputProps: META_TAGS.reduce((result, x, index) => {\r\n    result[x.key] = {\r\n      index: 80000 + index,\r\n      displayName: x.displayName,\r\n      editorName: x.editorName || x.displayName,\r\n      propPath: 'metatags',\r\n      group: x.group,\r\n      popout: x.popout,\r\n      type: x.type || 'string'\r\n    };\r\n    return result;\r\n  }, {}),\r\n  methods: {\r\n    getUrlPath: function () {\r\n      return this._internal.urlPath;\r\n    },\r\n    getTitle: function () {\r\n      return this._internal.title;\r\n    },\r\n    /* setRouter:function(value) {\r\n            this._internal.router = value\r\n        },*/\r\n    setTitle: function (value) {\r\n      this._internal.title = value;\r\n    },\r\n    setUrlPath: function (value) {\r\n      this._internal.urlPath = value;\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      /*   if (name === 'router') return this.registerInput(name, {\r\n                set: this.setRouter.bind(this)\r\n            })*/\r\n\r\n      if (name === 'title')\r\n        return this.registerInput(name, {\r\n          set: this.setTitle.bind(this)\r\n        });\r\n\r\n      if (name === 'urlPath')\r\n        return this.registerInput(name, {\r\n          set: this.setUrlPath.bind(this)\r\n        });\r\n    }\r\n  },\r\n  setup(context, graphModel) {\r\n    if (!context.editorConnection || !context.editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _updatePorts() {\r\n        var ports = [];\r\n\r\n        // Show router selector if more that one\r\n        /*\tvar routers = graphModel.getNodesWithType('Router')\r\n                if(routers.length > 1) {\r\n                    ports.push({\r\n                        plug: 'input',\r\n                        type: { name: 'enum', enums: routers.map((r) => ({ label: (r.parameters['name'] || 'Main'), value: (r.parameters['name'] || 'Main') })), allowEditOnly: true },\r\n                        group: 'General',\r\n                        displayName: 'Router',\r\n                        name: 'router',\r\n                        default:'Main'\r\n                    })\r\n                }*/\r\n\r\n        // Title and urlpath ports\r\n        const titleParts = node.component.name.split('/');\r\n        ports.push({\r\n          name: 'title',\r\n          displayName: 'Title',\r\n          type: 'string',\r\n          group: 'General',\r\n          plug: 'input',\r\n          default: titleParts[titleParts.length - 1]\r\n        });\r\n\r\n        const title = node.parameters['title'] || titleParts[titleParts.length - 1];\r\n        const defaultUrlPath = title.replace(/\\s+/g, '-').toLowerCase();\r\n        ports.push({\r\n          name: 'urlPath',\r\n          displayName: 'Url Path',\r\n          type: 'string',\r\n          group: 'General',\r\n          plug: 'input',\r\n          default: defaultUrlPath\r\n        });\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on('parameterUpdated', function (ev) {\r\n        if (ev.name === 'title') _updatePorts();\r\n      });\r\n\r\n      //  graphModel.on(\"nodeAdded.Router\", _updatePorts)\r\n      //  graphModel.on(\"nodeWasRemoved.Router\", _updatePorts)\r\n    }\r\n\r\n    graphModel.on('editorImportComplete', () => {\r\n      graphModel.on('nodeAdded.Page', function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      graphModel.on('componentRenamed', function (component) {\r\n        const page = graphModel.getNodesWithType('Page').filter((x) => component.roots.includes(x.id));\r\n        if (page.length > 0) {\r\n          _managePortsForNode(page[0]);\r\n        }\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType('Page')) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  }\r\n};\r\n\r\n//NodeSharedPortDefinitions.addSharedVisualInputs(PageNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(PageNode);\r\n\r\nexport default createNodeFromReactComponent(PageNode);\r\n","import React, { useEffect } from 'react';\r\nimport NoodlRuntime from '@noodl/runtime';\r\n\r\nimport ASyncQueue from '../../async-queue';\r\nimport guid from '../../guid';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport { Noodl, Slot } from '../../types';\r\nimport { ComponentPageInfo, NavigateArgs, RouterHandler } from './router-handler';\r\n\r\nexport interface RouterReactComponentProps extends Noodl.ReactProps {\r\n  didMount: () => void;\r\n  willUnmount: () => void;\r\n\r\n  children: Slot;\r\n}\r\n\r\nfunction RouterReactComponent(props: RouterReactComponentProps) {\r\n  const { didMount, willUnmount, children, style } = props;\r\n\r\n  useEffect(() => {\r\n    didMount();\r\n    return () => {\r\n      willUnmount();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div className={props.className} style={style}>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction _trimUrlPart(url) {\r\n  if (url[0] === '/') url = url.substring(1);\r\n  if (url[url.length - 1] === '/') url = url.substring(0, url.length - 1);\r\n  return url;\r\n}\r\n\r\nfunction getBaseUrlLength(url: string): number {\r\n  // If the URL is a full URL, then we only want to get the pathname.\r\n  // Otherwise we just return the url length which should be the pathname.\r\n  if (!url.startsWith('/')) {\r\n    try {\r\n      // Lets say the baseUrl is:\r\n      // \"https://collar-zippy-overcome.sandbox.noodl.app/my-folder\"\r\n      // Then we want to remove \"/my-folder\" from the substring\r\n      return new URL(url).pathname.length;\r\n    } catch {\r\n      /* noop */\r\n    }\r\n  }\r\n\r\n  return url.length;\r\n}\r\n\r\nconst RouterNode = {\r\n  name: 'Router',\r\n  displayNodeName: 'Page Router',\r\n  category: 'Visuals',\r\n  docs: 'https://docs.noodl.net/nodes/navigation/page-router',\r\n  useVariants: false,\r\n  connectionPanel: {\r\n    groupPriority: ['General', 'Actions', 'Events', 'Mounted']\r\n  },\r\n  initialize: function () {\r\n    this._internal.asyncQueue = new ASyncQueue();\r\n\r\n    this.onScheduleReset = () => {\r\n      this.scheduleReset();\r\n    };\r\n\r\n    this.props.didMount = () => {\r\n      this._internal.isMounted = true;\r\n\r\n      // SSR Support\r\n      if (typeof window !== 'undefined') {\r\n        // Listen to push state events and update stack\r\n        if (window.history && window.history.pushState) {\r\n          //this is event is manually sent on push, so covers both pop and push state\r\n          window.addEventListener('popstate', this.onScheduleReset);\r\n        } else {\r\n          // Only hash support\r\n          window.addEventListener('hashchange', this.onScheduleReset);\r\n        }\r\n      }\r\n\r\n      this._registerRouter();\r\n    };\r\n\r\n    this.props.willUnmount = () => {\r\n      this._internal.isMounted = false;\r\n\r\n      window.removeEventListener('popstate', this.onScheduleReset);\r\n      window.removeEventListener('hashchange', this.onScheduleReset);\r\n\r\n      this._deregisterRouter();\r\n    };\r\n\r\n    this.props.layout = 'column';\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.currentUrl;\r\n  },\r\n  defaultCss: {\r\n    flex: '1 1',\r\n    alignSelf: 'stretch',\r\n    position: 'relative',\r\n    display: 'flex',\r\n    flexDirection: 'column'\r\n  },\r\n  getReactComponent() {\r\n    return RouterReactComponent;\r\n  },\r\n  inputs: {\r\n    name: {\r\n      type: 'string',\r\n      displayName: 'Name',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._deregisterRouter();\r\n        this._internal.name = value;\r\n\r\n        if (this._internal.isMounted) {\r\n          this._registerRouter();\r\n        }\r\n      }\r\n    },\r\n    pages: {\r\n      type: { name: 'pages', allowEditOnly: true },\r\n      displayName: 'Pages',\r\n      group: 'Pages',\r\n      set: function (value) {\r\n        this._internal.pages = value;\r\n        if (this._internal.isMounted) {\r\n          this.scheduleReset();\r\n        }\r\n      }\r\n    },\r\n    urlPath: {\r\n      type: 'string',\r\n      displayName: 'Url path',\r\n      group: 'General',\r\n      set: function (value) {\r\n        this._internal.urlPath = value;\r\n      }\r\n    },\r\n    clip: {\r\n      displayName: 'Clip Behavior',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { value: 'contentHeight', label: 'Expand to content size' },\r\n          { value: 'scroll', label: 'Scroll' },\r\n          { value: 'clip', label: 'Clip content' }\r\n        ]\r\n      },\r\n      group: 'Layout',\r\n      default: 'contentHeight',\r\n      set(value) {\r\n        switch (value) {\r\n          case 'scroll':\r\n            this.setStyle({ overflow: 'auto' });\r\n            break;\r\n          case 'clip':\r\n            this.setStyle({ overflow: 'hidden' });\r\n            break;\r\n          default:\r\n            this.removeStyle(['overflow']);\r\n            break;\r\n        }\r\n      }\r\n    },\r\n    reset: {\r\n      type: 'signal',\r\n      displayName: 'Reset',\r\n      group: 'Actions',\r\n      valueChangedToTrue: function () {\r\n        this.scheduleReset();\r\n      }\r\n    }\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      type: 'color',\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      default: 'transparent',\r\n      applyDefault: false\r\n    }\r\n  },\r\n  outputs: {\r\n    currentPageTitle: {\r\n      type: 'string',\r\n      group: 'General',\r\n      displayName: 'Current Page Title',\r\n      getter: function () {\r\n        return this._internal.currentPage !== undefined ? this._internal.currentPage.title : undefined;\r\n      }\r\n    },\r\n    currentPageComponent: {\r\n      type: 'string',\r\n      group: 'General',\r\n      displayName: 'Current Page Component',\r\n      getter: function () {\r\n        return this._internal.currentPage !== undefined ? this._internal.currentPage.component : undefined;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    _registerRouter() {\r\n      RouterHandler.instance.registerRouter(this._internal.name, this);\r\n    },\r\n    _deregisterRouter() {\r\n      RouterHandler.instance.deregisterRouter(this._internal.name, this);\r\n    },\r\n    setPageOutputs(outputs) {\r\n      for (const prop in outputs) {\r\n        this._internal[prop] = outputs[prop];\r\n        this.flagOutputDirty(prop);\r\n      }\r\n    },\r\n    scheduleReset() {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledReset) {\r\n        internal.hasScheduledReset = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          internal.hasScheduledReset = false;\r\n          this.reset();\r\n        });\r\n      }\r\n    },\r\n    createPageContainer() {\r\n      const group = this.nodeScope.createPrimitiveNode('Group');\r\n      group.setStyle({ flex: '1 0 100%' });\r\n      return group;\r\n    },\r\n    reset() {\r\n      this._internal.asyncQueue.enqueue(this.resetAsync.bind(this));\r\n    },\r\n    scrollToTop() {\r\n      const dom = this.getDOMElement();\r\n      if (dom) {\r\n        dom.scrollTop = 0;\r\n\r\n        if (NoodlRuntime.instance.getProjectSettings().bodyScroll) {\r\n          //Automatically scroll the page router into view in case it's currently outside the viewport\r\n          //Might want to add an option to disable this\r\n          dom.scrollIntoView();\r\n        }\r\n      }\r\n    },\r\n    async resetAsync() {\r\n      let component: string;\r\n      let params = {};\r\n\r\n      const matchFromUrl = this.matchPageFromUrl();\r\n      if (matchFromUrl) {\r\n        if (!matchFromUrl.page) {\r\n          // Use the start page\r\n          component = this._internal.pages !== undefined ? this._internal.pages.startPage : undefined;\r\n          params = Object.assign({}, matchFromUrl.params, matchFromUrl.query);\r\n        } else {\r\n          // Use the matching page\r\n          component = matchFromUrl.page.component;\r\n          params = Object.assign({}, matchFromUrl.params, matchFromUrl.query);\r\n        }\r\n      } else {\r\n        // TODO: Clean up matchPageFromUrl, in this case it returns undefined.\r\n        //       remainingNavigationPath is undefined, since it have to run\r\n        //       matchPageFromUrl to get the path. So it feels like it needs\r\n        //       some bigger refactoring to make it understandable.\r\n        component = this._internal.pages.startPage;\r\n        params = {};\r\n      }\r\n\r\n      if (component === undefined) return; // No component specified for page\r\n\r\n      const currentPage = RouterHandler.instance.getPageInfoForComponent(component);\r\n\r\n      if (this._internal.currentPage === currentPage) {\r\n        //already at the correct page, keep the current page\r\n        //update page inputs if they have changed\r\n        //TODO: fix if a parameter goes from a value to undefined, the old value will still exist in the connection from previous navigation\r\n        if (!shallowObjectsEqual(this._internal.currentParams, params)) {\r\n          this._internal.currentParams = params;\r\n          this._updatePageInputs(this._internal.currentPageComponent.nodeScope, params);\r\n        }\r\n        return;\r\n      }\r\n\r\n      this.scrollToTop();\r\n\r\n      // Reset the current page for this router\r\n      // First remove all children\r\n      const children = this.getChildren();\r\n      for (const i in children) {\r\n        const c = children[i];\r\n        this.removeChild(c);\r\n        this.nodeScope.deleteNode(c);\r\n      }\r\n\r\n      const content = await this.nodeScope.createNode(component, guid());\r\n      this._internal.currentPageComponent = content;\r\n\r\n      // Find the root page node\r\n      const pageNodes = content.nodeScope.getNodesWithType('Page');\r\n      if (pageNodes === undefined || pageNodes.length !== 1) {\r\n        return; // Should be only one page root\r\n      }\r\n\r\n      this._internal.currentPage = RouterHandler.instance.getPageInfoForComponent(component);\r\n      this._internal.currentParams = params;\r\n\r\n      this.flagOutputDirty('currentPageTitle');\r\n      this.flagOutputDirty('currentPageComponent');\r\n      // @ts-expect-error Noodl is not defined\r\n      Noodl.SEO.setTitle(this._internal.currentPage.title);\r\n\r\n      this._updatePageInputs(this._internal.currentPageComponent.nodeScope, params);\r\n\r\n      const group = this.createPageContainer();\r\n      group.addChild(content);\r\n\r\n      this.addChild(group);\r\n\r\n      /*\tthis.setPageOutputs({\r\n\t\t\t\tcurrentUrl: pageInfo.path,\r\n\t\t\t\tcurrentTitle: pageInfo.title\r\n\t\t\t});*/\r\n    },\r\n    _updatePageInputs(nodeScope, params) {\r\n      for (const pageInputNode of nodeScope.getNodesWithType('PageInputs')) {\r\n        pageInputNode._setPageParams(params);\r\n      }\r\n    },\r\n    getRelativeURL(targetPage: ComponentPageInfo, pageParams: NavigateArgs['params']) {\r\n      if (!targetPage) return;\r\n\r\n      let urlPath = targetPage.path;\r\n      if (urlPath === undefined) return;\r\n\r\n      // First add matching parameters to path\r\n      const paramsInPath = urlPath.match(/{([^}]+)}/g);\r\n\r\n      const params = Object.assign({}, pageParams);\r\n      if (paramsInPath) {\r\n        for (const param of paramsInPath) {\r\n          const key = param.replace(/[{}]/g, '');\r\n          if (pageParams[key] !== undefined) {\r\n            urlPath = urlPath.replace(param, encodeURIComponent(params[key]));\r\n            delete params[key];\r\n          }\r\n        }\r\n      }\r\n\r\n      // Add other paramters as query\r\n      const query = [];\r\n      for (const key in params) {\r\n        query.push({\r\n          name: key,\r\n          value: encodeURIComponent(params[key])\r\n        });\r\n      }\r\n\r\n      urlPath = _trimUrlPart(urlPath);\r\n\r\n      // Prepend this routers url path if there is one\r\n      if (this._internal.urlPath !== undefined) urlPath = _trimUrlPart(this._internal.urlPath) + '/' + urlPath;\r\n\r\n      return {\r\n        path: urlPath,\r\n        query: query\r\n      };\r\n    },\r\n    getNavigationAbsoluteURL(targetPage: ComponentPageInfo, pageParams: NavigateArgs['params']) {\r\n      let parent = this.parent;\r\n      let parentUrl = { path: '', query: [] };\r\n\r\n      while (parent !== undefined && typeof parent.getNavigationAbsoluteURL !== 'function') {\r\n        parent = parent.getVisualParentNode();\r\n      }\r\n\r\n      if (parent) {\r\n        parentUrl = parent.getNavigationAbsoluteURL(parent._internal.currentPage, parent._internal.currentParams);\r\n      }\r\n\r\n      const thisUrl = this.getRelativeURL(targetPage, pageParams);\r\n      if (thisUrl) {\r\n        const haveForwardSlash = parentUrl.path.endsWith('/') || thisUrl.path.startsWith('/');\r\n        return {\r\n          path: parentUrl.path + (haveForwardSlash ? '' : '/') + thisUrl.path,\r\n          query: parentUrl.query.concat(thisUrl.query)\r\n        };\r\n      }\r\n\r\n      return parentUrl;\r\n    },\r\n    _getLocationPath: function () {\r\n      const navigationPathType = NoodlRuntime.instance.getProjectSettings()['navigationPathType'];\r\n      if (navigationPathType === undefined || navigationPathType === 'hash') {\r\n        // Use hash as path\r\n        let hash = location.hash;\r\n        if (hash) {\r\n          if (hash[0] === '#') hash = hash.substring(1);\r\n          if (hash[0] === '/') hash = hash.substring(1);\r\n        }\r\n        return decodeURI(hash);\r\n      } else {\r\n        // Use url as path\r\n        let path = location.pathname;\r\n        if (path) {\r\n          if (path[0] === '/') {\r\n            // @ts-expect-error missing Noodl typings\r\n            const baseUrl = Noodl.Env['BaseUrl'];\r\n            if (baseUrl) {\r\n              const pathnameLength = getBaseUrlLength(baseUrl);\r\n              path = path.substring(pathnameLength);\r\n            } else {\r\n              path = path.substring(1);\r\n            }\r\n          }\r\n        }\r\n        return decodeURI(path);\r\n      }\r\n    },\r\n    _getSearchParams: function () {\r\n      // Regex for replacing addition symbol with a space\r\n      const pl = /\\+/g;\r\n      const search = /([^&=]+)=?([^&]*)/g;\r\n      const decode = function (s) {\r\n        return decodeURIComponent(s.replace(pl, ' '));\r\n      };\r\n      const query = location.search.substring(1);\r\n\r\n      let match: RegExpExecArray;\r\n\r\n      const urlParams = {};\r\n      while ((match = search.exec(query))) urlParams[decode(match[1])] = decode(match[2]);\r\n\r\n      return urlParams;\r\n    },\r\n    getNavigationRemainingPath() {\r\n      return this._internal.remainingNavigationPath;\r\n    },\r\n    matchPageFromUrl() {\r\n      // Attempt to find relative path from closest navigation parent\r\n      let parent = this.parent;\r\n      while (parent !== undefined && typeof parent.getNavigationRemainingPath !== 'function') {\r\n        parent = parent.getVisualParentNode();\r\n      }\r\n\r\n      let pathParts = undefined;\r\n\r\n      // Either use current browser location if we have no parent, or use remaining path\r\n      // from parent\r\n      if (parent === undefined) {\r\n        let urlPath = this._getLocationPath();\r\n        if (urlPath[0] === '/') urlPath = urlPath.substring(1);\r\n        pathParts = urlPath.split('/');\r\n      } else {\r\n        pathParts = parent.getNavigationRemainingPath();\r\n      }\r\n      if (pathParts === undefined) return;\r\n\r\n      const urlQuery = this._getSearchParams();\r\n\r\n      function _matchPathParts(path, pattern) {\r\n        const params = {};\r\n        for (let i = 0; i < pattern.length; i++) {\r\n          const _p = pattern[i];\r\n          if (_p[0] === '{' && _p[_p.length - 1] === '}') {\r\n            // This is a param, collect it\r\n            if (path[i] !== undefined) {\r\n              params[_p.substring(1, _p.length - 1)] = decodeURIComponent(path[i]);\r\n            }\r\n          } else if (path[i] === undefined || _p !== path[i]) return;\r\n        }\r\n        return {\r\n          params: params,\r\n          remainingPathParts: path.slice().splice(pattern.length) // Make copy\r\n        };\r\n      }\r\n\r\n      const pages = RouterHandler.instance.getPagesForRouter(this._internal.name);\r\n      if (pages === undefined || pages.length === 0) return;\r\n\r\n      let matchedPage,\r\n        bestMatchLength = 9999;\r\n      for (const pageInfo of pages) {\r\n        let pagePattern = pageInfo.path;\r\n        if (pagePattern === undefined) continue;\r\n        pagePattern = _trimUrlPart(pagePattern);\r\n\r\n        // Prepend this routers url path if there is one\r\n        if (this._internal.urlPath !== undefined)\r\n          pagePattern = _trimUrlPart(this._internal.urlPath) + '/' + pagePattern;\r\n\r\n        const pagePatternParts = pagePattern.split('/');\r\n        const match = _matchPathParts(pathParts, pagePatternParts);\r\n\r\n        const dist = Math.abs(pagePatternParts.length - pathParts.length);\r\n        if (match && bestMatchLength > dist) {\r\n          // This page is a match\r\n          matchedPage = { match, pageInfo };\r\n          bestMatchLength = dist;\r\n        }\r\n      }\r\n\r\n      if (matchedPage) {\r\n        this._internal.remainingNavigationPath = matchedPage.match.remainingPathParts;\r\n        return {\r\n          page: matchedPage.pageInfo,\r\n          params: matchedPage.match.params,\r\n          query: urlQuery\r\n        };\r\n      } else {\r\n        return {\r\n          page: undefined, // no matched page\r\n          params: {},\r\n          query: urlQuery\r\n        };\r\n      }\r\n    },\r\n    _getCompleteUrlToPage(page: ComponentPageInfo, pageParams: NavigateArgs['params']) {\r\n      const url = this.getNavigationAbsoluteURL(page, pageParams);\r\n\r\n      let urlPath, hashPath;\r\n      const navigationPathType = NoodlRuntime.instance.getProjectSettings()['navigationPathType'];\r\n      if (navigationPathType === undefined || navigationPathType === 'hash') {\r\n        hashPath = url.path;\r\n      } else {\r\n        urlPath = url.path;\r\n      }\r\n\r\n      const query = url.query.map((q) => q.name + '=' + q.value);\r\n      const compiledUrl =\r\n        (urlPath !== undefined ? urlPath : '') +\r\n        (query.length >= 1 ? '?' + query.join('&') : '') +\r\n        (hashPath !== undefined ? '#' + hashPath : '');\r\n\r\n      return compiledUrl;\r\n    },\r\n    _updateUrlWithTopPage() {\r\n      // Push the state to the browser url\r\n      if (window.history !== undefined) {\r\n        this._internal.remainingNavigationPath = undefined; // Reset remaining nav path\r\n\r\n        const url = this._getCompleteUrlToPage(this._internal.currentPage, this._internal.currentParams);\r\n        window.history.pushState({}, '', url);\r\n      }\r\n    },\r\n    navigate(args) {\r\n      this._internal.asyncQueue.enqueue(this.navigateAsync.bind(this, args));\r\n    },\r\n    async navigateAsync(args: NavigateArgs) {\r\n      if (args.target === undefined) return;\r\n\r\n      const newPage = RouterHandler.instance.getPageInfoForComponent(args.target);\r\n      if (!newPage) return; //TODO: send error to editor, \"invalid page component name\"\r\n\r\n      if (args.openInNewTab) {\r\n        const url = this._getCompleteUrlToPage(newPage, args.params);\r\n        window.open(url, '_blank');\r\n        args.hasNavigated && args.hasNavigated();\r\n      } else {\r\n        await this._navigateInCurrentWindow(newPage, args);\r\n      }\r\n    },\r\n    async _navigateInCurrentWindow(newPage: ComponentPageInfo, args: NavigateArgs) {\r\n      this.scrollToTop();\r\n\r\n      // Remove all current pages in the stack\r\n      const children = this.getChildren();\r\n      for (const i in children) {\r\n        const c = children[i];\r\n        this.removeChild(c);\r\n        this.nodeScope.deleteNode(c);\r\n      }\r\n\r\n      const group = this.createPageContainer();\r\n\r\n      // Create the page content\r\n      const content = await this.nodeScope.createNode(args.target, guid());\r\n\r\n      this._internal.currentPage = newPage;\r\n      this._internal.currentParams = args.params;\r\n\r\n      this.flagOutputDirty('currentPageTitle');\r\n      this.flagOutputDirty('currentPageComponent');\r\n      // @ts-expect-error Noodl is not defined\r\n      Noodl.SEO.setTitle(this._internal.currentPage.title);\r\n\r\n      const pageInputNodes = content.nodeScope.getNodesWithType('PageInputs');\r\n      if (pageInputNodes !== undefined && pageInputNodes.length > 0) {\r\n        pageInputNodes.forEach((node) => {\r\n          node._setPageParams(args.params);\r\n        });\r\n      }\r\n\r\n      group.addChild(content);\r\n      this.addChild(group);\r\n\r\n      this._updateUrlWithTopPage();\r\n\r\n      args.hasNavigated && args.hasNavigated();\r\n      RouterHandler.instance.onNavigated(this._internal.name, newPage);\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nfunction shallowObjectsEqual(object1, object2) {\r\n  const keys1 = Object.keys(object1 || {});\r\n  const keys2 = Object.keys(object2 || {});\r\n\r\n  if (keys1.length !== keys2.length) {\r\n    return false;\r\n  }\r\n\r\n  return keys1.every((key) => object1[key] === object2[key]);\r\n}\r\n\r\nexport default createNodeFromReactComponent(RouterNode);\r\n","const ExternalLinkNode = {\r\n  name: 'net.noodl.externallink',\r\n  displayNodeName: 'External Link',\r\n  docs: 'https://docs.noodl.net/nodes/navigation/external-link',\r\n  category: 'Navigation',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'link'\r\n  },\r\n  inputs: {\r\n    link: {\r\n      type: 'string',\r\n      displayName: 'Link'\r\n    },\r\n    openInNewTab: {\r\n      type: 'boolean',\r\n      displayName: 'Open In New Tab',\r\n      default: true\r\n    },\r\n    do: {\r\n      type: 'signal',\r\n      displayName: 'Do',\r\n      valueChangedToTrue() {\r\n        const openInNewTab = this.getInputValue('openInNewTab');\r\n        const params = openInNewTab ? 'noopener,noreferrer' : '';\r\n        const target = openInNewTab === true || openInNewTab === undefined ? '_blank' : '_self';\r\n\r\n        window.open(this.getInputValue('link'), target, params);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nexport default {\r\n  node: ExternalLinkNode\r\n};\r\n","import React from 'react';\r\n\r\nimport Layout from '../../../layout';\r\nimport PointerListeners from '../../../pointerlisteners';\r\nimport { Noodl } from '../../../types';\r\n\r\nexport interface CircleProps extends Noodl.ReactProps {\r\n  size: number;\r\n  startAngle: number;\r\n  endAngle: number;\r\n\r\n  fillEnabled: boolean;\r\n  fillColor: Noodl.Color;\r\n\r\n  strokeEnabled: boolean;\r\n  strokeColor: Noodl.Color;\r\n  strokeWidth: number;\r\n  strokeLineCap: 'butt' | 'round';\r\n\r\n  dom;\r\n}\r\n\r\nfunction polarToCartesian(centerX, centerY, radius, angleInDegrees) {\r\n  const angleInRadians = ((angleInDegrees - 90) * Math.PI) / 180.0;\r\n\r\n  return {\r\n    x: centerX + radius * Math.cos(angleInRadians),\r\n    y: centerY + radius * Math.sin(angleInRadians)\r\n  };\r\n}\r\n\r\nfunction filledArc(x, y, radius, startAngle, endAngle) {\r\n  if (endAngle % 360 === startAngle % 360) {\r\n    endAngle -= 0.0001;\r\n  }\r\n\r\n  const start = polarToCartesian(x, y, radius, endAngle);\r\n  const end = polarToCartesian(x, y, radius, startAngle);\r\n\r\n  const arcSweep = endAngle - startAngle <= 180 ? '0' : '1';\r\n\r\n  return [\r\n    'M',\r\n    start.x,\r\n    start.y,\r\n    'A',\r\n    radius,\r\n    radius,\r\n    0,\r\n    arcSweep,\r\n    0,\r\n    end.x,\r\n    end.y,\r\n    'L',\r\n    x,\r\n    y,\r\n    'L',\r\n    start.x,\r\n    start.y\r\n  ].join(' ');\r\n}\r\n\r\nfunction arc(x, y, radius, startAngle, endAngle) {\r\n  if (endAngle % 360 === startAngle % 360) {\r\n    endAngle -= 0.0001;\r\n  }\r\n\r\n  const start = polarToCartesian(x, y, radius, endAngle);\r\n  const end = polarToCartesian(x, y, radius, startAngle);\r\n\r\n  const arcSweep = endAngle - startAngle <= 180 ? '0' : '1';\r\n\r\n  return ['M', start.x, start.y, 'A', radius, radius, 0, arcSweep, 0, end.x, end.y].join(' ');\r\n}\r\n\r\nexport class Circle extends React.Component<CircleProps> {\r\n  constructor(props: CircleProps) {\r\n    super(props);\r\n  }\r\n\r\n  render() {\r\n    //SVG can only do strokes centered on a path, and we want to render it inside.\r\n    //We'll do it manually by adding another path on top of the filled circle\r\n\r\n    let fill;\r\n    let stroke;\r\n\r\n    const r = this.props.size / 2;\r\n    const { startAngle, endAngle } = this.props;\r\n\r\n    if (this.props.fillEnabled) {\r\n      const r = this.props.size / 2;\r\n      fill = <path d={filledArc(r, r, r, startAngle, endAngle)} fill={this.props.fillColor} />;\r\n    }\r\n\r\n    if (this.props.strokeEnabled) {\r\n      const { strokeColor, strokeWidth, strokeLineCap } = this.props;\r\n      const strokeRadius = r - this.props.strokeWidth / 2;\r\n      const path = arc(r, r, strokeRadius, startAngle, endAngle);\r\n      stroke = (\r\n        <path\r\n          d={path}\r\n          stroke={strokeColor}\r\n          strokeWidth={strokeWidth}\r\n          fill=\"transparent\"\r\n          strokeLinecap={strokeLineCap}\r\n        />\r\n      );\r\n    }\r\n\r\n    const style = { ...this.props.style };\r\n    Layout.size(style, this.props);\r\n    Layout.align(style, this.props);\r\n\r\n    if (style.opacity === 0) {\r\n      style.pointerEvents = 'none';\r\n    }\r\n\r\n    //the SVG element lack some properties like offsetLeft, offsetTop that the drag node depends on.\r\n    //Let's wrap it in a div to make it work properly\r\n    return (\r\n      <div className={this.props.className} {...this.props.dom} {...PointerListeners(this.props)} style={style}>\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width={this.props.size} height={this.props.size}>\r\n          {fill}\r\n          {stroke}\r\n        </svg>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import { Circle } from '../../components/visual/Circle';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst CircleNode = {\r\n  name: 'Circle',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/circle',\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Fill',\r\n      'Stroke',\r\n      'Dimensions',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'Mounted',\r\n      'Margin and padding',\r\n      'Pointer Events',\r\n      'Hover Events'\r\n    ]\r\n  },\r\n  getReactComponent() {\r\n    return Circle;\r\n  },\r\n  noodlNodeAsProp: true,\r\n  allowChildren: false,\r\n  defaultCss: {\r\n    flexShrink: 0,\r\n    position: 'relative',\r\n    display: 'flex'\r\n  },\r\n  inputProps: {\r\n    size: {\r\n      displayName: 'Size',\r\n      default: '100',\r\n      group: 'Dimension',\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      index: 10,\r\n      allowVisualStates: true\r\n    },\r\n    fillEnabled: {\r\n      group: 'Fill',\r\n      displayName: 'Fill',\r\n      default: true,\r\n      type: 'boolean',\r\n      index: 20,\r\n      allowVisualStates: true\r\n    },\r\n    fillColor: {\r\n      group: 'Fill',\r\n      displayName: 'Fill Color',\r\n      default: 'red',\r\n      type: 'color',\r\n      index: 21,\r\n      allowVisualStates: true\r\n    },\r\n    strokeEnabled: {\r\n      index: 23,\r\n      group: 'Stroke',\r\n      default: false,\r\n      displayName: 'Stroke',\r\n      type: 'boolean',\r\n      allowVisualStates: true\r\n    },\r\n    strokeWidth: {\r\n      index: 24,\r\n      group: 'Stroke',\r\n      displayName: 'Stroke Width',\r\n      default: 10,\r\n      type: {\r\n        name: 'number'\r\n      },\r\n      allowVisualStates: true\r\n    },\r\n    strokeColor: {\r\n      index: 25,\r\n      group: 'Stroke',\r\n      displayName: 'Stroke Color',\r\n      type: 'color',\r\n      default: 'black',\r\n      allowVisualStates: true\r\n    },\r\n    strokeLineCap: {\r\n      index: 26,\r\n      group: 'Stroke',\r\n      displayName: 'Line Cap',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Butt', value: 'butt' },\r\n          { label: 'Round', value: 'round' }\r\n        ]\r\n      },\r\n      default: 'butt',\r\n      allowVisualStates: true\r\n    },\r\n    startAngle: {\r\n      displayName: 'Start Angle',\r\n      type: 'number',\r\n      default: 0,\r\n      group: 'Style',\r\n      index: 198,\r\n      allowVisualStates: true\r\n    },\r\n    endAngle: {\r\n      displayName: 'End Angle',\r\n      type: 'number',\r\n      default: 360,\r\n      group: 'Style',\r\n      index: 199,\r\n      allowVisualStates: true\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addTransformInputs(CircleNode);\r\nNodeSharedPortDefinitions.addMarginInputs(CircleNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(CircleNode);\r\nNodeSharedPortDefinitions.addAlignInputs(CircleNode);\r\nNodeSharedPortDefinitions.addPointerEventOutputs(CircleNode);\r\n\r\nexport default createNodeFromReactComponent(CircleNode);\r\n","import React, { useRef, useState, useEffect } from 'react';\r\n\r\nimport { ForEachComponent } from '../../../nodes/std-library/data/foreach';\r\nimport { Noodl, Slot } from '../../../types';\r\n\r\nexport interface ColumnsProps extends Noodl.ReactProps {\r\n  marginX: string;\r\n  marginY: string;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  justifyContent: 'flex-start' | 'flex-end' | 'center';\r\n  direction: 'row' | 'column';\r\n  minWidth: string;\r\n  layoutString: string;\r\n\r\n  children: Slot;\r\n}\r\n\r\nfunction calcAutofold(layout, minWidths, containerWidth, marginX) {\r\n  const first = _calcAutofold(layout, minWidths, containerWidth, marginX);\r\n  const second = _calcAutofold(first.layout, minWidths, containerWidth, marginX);\r\n\r\n  if (first.totalFractions === second.totalFractions) {\r\n    return first;\r\n  } else {\r\n    return calcAutofold(second.layout, minWidths, containerWidth, marginX);\r\n  }\r\n}\r\n\r\nfunction _calcAutofold(layout, minWidth, containerWidth, marginX) {\r\n  const totalFractions = layout.reduce((a, b) => a + b, 0);\r\n  const fractionSize = 100 / totalFractions;\r\n\r\n  const rowWidth = layout.reduce(\r\n    (acc, curr, i) => {\r\n      return {\r\n        expected: acc.expected + (fractionSize / 100) * containerWidth * curr,\r\n        min: acc.min + parseFloat(minWidth) + marginX\r\n      };\r\n    },\r\n    { expected: 0, min: 0, max: null }\r\n  );\r\n\r\n  const newLayout = layout;\r\n\r\n  if (rowWidth.expected < rowWidth.min) {\r\n    newLayout.pop();\r\n  }\r\n\r\n  const newTotalFractions = newLayout.reduce((a, b) => a + b, 0);\r\n  const newFractionSize = 100 / newTotalFractions;\r\n  const newColumnAmount = newLayout.length;\r\n\r\n  return {\r\n    layout: newLayout,\r\n    totalFractions: newTotalFractions,\r\n    fractionSize: newFractionSize,\r\n    columnAmount: newColumnAmount\r\n  };\r\n}\r\n\r\nexport function Columns(props: ColumnsProps) {\r\n  if (!props.children) return null;\r\n  let columnLayout = null;\r\n\r\n  const containerRef = useRef(null);\r\n  const [containerWidth, setContainerWidth] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const container = containerRef?.current;\r\n    if (!container) return;\r\n\r\n    const observer = new ResizeObserver(() => {\r\n      const container = containerRef.current;\r\n      if (!container) return;\r\n      setContainerWidth(container.offsetWidth);\r\n    });\r\n\r\n    observer.observe(container);\r\n\r\n    return () => {\r\n      observer.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  switch (typeof props.layoutString) {\r\n    case 'string':\r\n      columnLayout = props.layoutString.trim();\r\n      break;\r\n\r\n    case 'number':\r\n      columnLayout = String(props.layoutString).trim();\r\n      break;\r\n\r\n    default:\r\n      columnLayout = null;\r\n  }\r\n\r\n  if (!columnLayout) {\r\n    return <>{props.children}</>;\r\n  }\r\n\r\n  // all data for childrens width calculation\r\n  const targetLayout = columnLayout.split(' ').map((number) => parseInt(number));\r\n\r\n  // constraints\r\n  const { layout, columnAmount, fractionSize } = calcAutofold(\r\n    targetLayout,\r\n    props.minWidth,\r\n    containerWidth,\r\n    props.marginX\r\n  );\r\n\r\n  let children = [];\r\n  let forEachComponent = null;\r\n\r\n  // ForEachCompoent breaks the layout but is needed to send onMount/onUnmount\r\n  if (!Array.isArray(props.children)) {\r\n    // @ts-expect-error props.children.type is any\r\n    if (props.children.type !== ForEachComponent) {\r\n      children = [props.children]\r\n    }\r\n  } else {\r\n    children = props.children.filter((child) => child.type !== ForEachComponent);\r\n    forEachComponent = props.children.find((child) => child.type === ForEachComponent);\r\n  }\r\n\r\n  return (\r\n    <div\r\n      {...props.attrs}\r\n      className={['columns-container', props.className].join(' ')}\r\n      ref={containerRef}\r\n      style={{\r\n        visibility: containerWidth === null ? \"hidden\" : \"visible\",\r\n        marginTop: parseFloat(props.marginY) * -1,\r\n        marginLeft: parseFloat(props.marginX) * -1,\r\n        display: 'flex',\r\n        flexWrap: 'wrap',\r\n        alignItems: 'stretch',\r\n        justifyContent: props.justifyContent,\r\n        flexDirection: props.direction,\r\n        width: `calc(100% + (${parseFloat(props.marginX)}px)`,\r\n        boxSizing: 'border-box',\r\n        ...props.style\r\n      }}\r\n    >\r\n      {forEachComponent && forEachComponent}\r\n\r\n      {children.map((child, i) => {\r\n        return (\r\n          <div\r\n            className=\"column-item\"\r\n            key={i}\r\n            style={{\r\n              boxSizing: 'border-box',\r\n              paddingTop: props.marginY,\r\n              paddingLeft: props.marginX,\r\n              width: layout[i % columnAmount] * fractionSize + '%',\r\n              flexShrink: 0,\r\n              flexGrow: 0,\r\n              minWidth: props.minWidth\r\n              // maxWidths needs some more thought\r\n              //maxWidth: getMinMaxInputValues(maxWidths, columnAmount, props.marginX, i)\r\n            }}\r\n          >\r\n            {React.cloneElement(child)}\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import { Columns } from '../../components/visual/Columns';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst ColumnsNode = {\r\n  name: 'net.noodl.visual.columns',\r\n  displayName: 'Columns',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/columns',\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'States',\r\n      'Mounted',\r\n      'Label',\r\n      'Label Text Style',\r\n      'Hover Events',\r\n      'Pointer Events',\r\n      'Focus Events'\r\n    ]\r\n  },\r\n\r\n  initialize() {    this.props.attrs = {};\r\n    this.props.layoutString = '1 2 1';\r\n    this.props.minWidth = 0;\r\n    this.props.marginX = 16;\r\n    this.props.marginY = 16;\r\n    this.props.direction = 'row';\r\n    this.props.justifyContent = 'flex-start';\r\n  },\r\n\r\n  getReactComponent() {\r\n    return Columns;\r\n  },\r\n\r\n  inputs: {\r\n    layoutString: {\r\n      group: 'Layout Settings',\r\n      displayName: 'Layout String',\r\n      type: 'string',\r\n      default: '1 2 1',\r\n      set(value) {\r\n        this.props.layoutString = value;\r\n\r\n        if (typeof value !== 'string') {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            'layout-type-warning',\r\n            {\r\n              message: 'Layout String needs to be a string.'\r\n            }\r\n          );\r\n        } else {\r\n          this.context.editorConnection.clearWarning(\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            'layout-type-warning'\r\n          );\r\n        }\r\n\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n\r\n  inputProps: {\r\n    marginX: {\r\n      group: 'Layout Settings',\r\n      displayName: 'Horizontal Gap',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 16\r\n    },\r\n    marginY: {\r\n      group: 'Layout Settings',\r\n      displayName: 'Vertical Gap',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 16\r\n    },\r\n    minWidth: {\r\n      group: 'Constraints',\r\n      displayName: 'Min Column Width',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 0\r\n    },\r\n    direction: {\r\n      group: 'Layout Settings',\r\n      displayName: 'Layout Direction',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          {\r\n            label: 'Horizontal',\r\n            value: 'row'\r\n          },\r\n          {\r\n            label: 'Vertical',\r\n            value: 'column'\r\n          }\r\n        ]\r\n      },\r\n      default: 'row'\r\n    },\r\n    justifyContent: {\r\n      group: 'Justify Content',\r\n      displayName: 'Justify Content',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Start', value: 'flex-start' },\r\n          { label: 'End', value: 'flex-end' },\r\n          { label: 'Center', value: 'center' }\r\n        ],\r\n        alignComp: 'align-items'\r\n      },\r\n      default: 'flex-start'\r\n    }\r\n  }\r\n};\r\n\r\nexport default createNodeFromReactComponent(ColumnsNode);\r\n","import React from 'react';\r\nimport Draggable from 'react-draggable';\r\n\r\nimport EaseCurves from '../../../easecurves';\r\nimport { Noodl } from '../../../types';\r\n\r\nexport interface DragProps extends Noodl.ReactProps {\r\n  inputPositionX: number;\r\n  inputPositionY: number;\r\n\r\n  enabled: boolean;\r\n  scale: number;\r\n  axis: 'x' | 'y' | 'both';\r\n\r\n  useParentBounds: boolean;\r\n\r\n  onStart?: () => void;\r\n  onStop?: () => void;\r\n  onDrag?: () => void;\r\n\r\n  positionX?: (value: number) => void;\r\n  positionY?: (value: number) => void;\r\n  deltaX?: (value: number) => void;\r\n  deltaY?: (value: number) => void;\r\n}\r\n\r\nfunction setDragValues(event, props) {\r\n  props.positionX && props.positionX(event.x);\r\n  props.positionY && props.positionY(event.y);\r\n  props.deltaX && props.deltaX(event.deltaX);\r\n  props.deltaY && props.deltaY(event.deltaY);\r\n}\r\n\r\ntype State = {\r\n  x: number\r\n  y: number\r\n}\r\n\r\nexport class Drag extends React.Component<DragProps, State> {\r\n  snapToPositionXTimer: any;\r\n  snapToPositionYTimer: any;\r\n\r\n  constructor(props: DragProps) {\r\n    super(props);\r\n    this.state = { x: 0, y: 0 } satisfies State;\r\n  }\r\n\r\n  snapToPosition({ timerScheduler, propCallback, duration, axis, endValue }) {\r\n    const _this = this;\r\n    return timerScheduler\r\n      .createTimer({\r\n        duration: duration === undefined ? 300 : duration,\r\n        startValue: this.state[axis],\r\n        endValue: endValue,\r\n        ease: EaseCurves.easeOut,\r\n        onRunning: function (t) {\r\n          const value = this.ease(this.startValue, this.endValue, t);\r\n          // @ts-expect-error Either x or y...\r\n          _this.setState({ [axis]: value });\r\n          propCallback && propCallback(value);\r\n        }\r\n      })\r\n      .start();\r\n  }\r\n\r\n  componentDidMount() {\r\n    const x = this.props.inputPositionX ? this.props.inputPositionX : 0;\r\n    const y = this.props.inputPositionY ? this.props.inputPositionY : 0;\r\n\r\n    this.setState({ x, y });\r\n    setDragValues({ x, y, deltaX: 0, deltaY: 0 }, this.props);\r\n  }\r\n\r\n  UNSAFE_componentWillReceiveProps(nextProps: DragProps) {\r\n    const props = this.props;\r\n\r\n    if (props.inputPositionX !== nextProps.inputPositionX) {\r\n      this.setState({ x: nextProps.inputPositionX });\r\n      props.positionX && props.positionX(nextProps.inputPositionX);\r\n      props.deltaX && props.deltaX(nextProps.inputPositionX - props.inputPositionX);\r\n    }\r\n    if (props.inputPositionY !== nextProps.inputPositionY) {\r\n      this.setState({ y: nextProps.inputPositionY });\r\n      props.positionY && props.positionY(nextProps.inputPositionY);\r\n      props.deltaY && props.deltaY(nextProps.inputPositionY - props.inputPositionY);\r\n    }\r\n  }\r\n\r\n  snapToPositionX(x, duration) {\r\n    if (this.state.x === x) return;\r\n\r\n    this.snapToPositionXTimer && this.snapToPositionXTimer.stop();\r\n    this.snapToPositionXTimer = this.snapToPosition({\r\n      timerScheduler: this.props.noodlNode.context.timerScheduler,\r\n      propCallback: this.props.positionX,\r\n      duration,\r\n      axis: 'x',\r\n      endValue: x\r\n    });\r\n  }\r\n\r\n  snapToPositionY(y, duration) {\r\n    if (this.state.y === y) return;\r\n\r\n    this.snapToPositionYTimer && this.snapToPositionYTimer.stop();\r\n    this.snapToPositionYTimer = this.snapToPosition({\r\n      timerScheduler: this.props.noodlNode.context.timerScheduler,\r\n      propCallback: this.props.positionY,\r\n      duration,\r\n      axis: 'y',\r\n      endValue: y\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const props = this.props;\r\n    const bounds = props.useParentBounds ? 'parent' : undefined;\r\n\r\n    let child;\r\n    if (React.Children.count(props.children) > 0) {\r\n      child = React.Children.toArray(props.children)[0];\r\n    } else {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <Draggable\r\n        axis={props.axis}\r\n        bounds={bounds}\r\n        disabled={props.enabled === false}\r\n        scale={props.scale || 0}\r\n        position={{ x: this.state.x, y: this.state.y }}\r\n        onStart={(e, data) => {\r\n          setDragValues(data, props);\r\n          props.onStart && props.onStart();\r\n          this.snapToPositionXTimer && this.snapToPositionXTimer.stop();\r\n          this.snapToPositionYTimer && this.snapToPositionYTimer.stop();\r\n        }}\r\n        onStop={(e, data) => {\r\n          if (props.axis === 'x' || props.axis === 'both') {\r\n            this.setState({ x: data.x });\r\n          }\r\n          if (props.axis === 'y' || props.axis === 'both') {\r\n            this.setState({ y: data.y });\r\n          }\r\n          props.positionX && props.positionX(data.x);\r\n          props.positionY && props.positionY(data.y);\r\n          props.onStop && props.onStop();\r\n        }}\r\n        onDrag={(e, data) => {\r\n          setDragValues(data, props);\r\n          props.onDrag && props.onDrag();\r\n        }}\r\n      >\r\n        {React.cloneElement(child, { parentLayout: props.parentLayout })}\r\n      </Draggable>\r\n    );\r\n  }\r\n}\r\n","import { Drag } from '../../components/visual/Drag';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst DragNode = {\r\n  name: 'Drag',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/drag',\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  getReactComponent() {\r\n    return Drag;\r\n  },\r\n  initialize() {\r\n    this._internal.snapPositionX = 0;\r\n    this._internal.snapPositionY = 0;\r\n    this._internal.snapDurationX = 300;\r\n    this._internal.snapDurationY = 300;\r\n  },\r\n  inputs: {\r\n    'snapToPositionX.do': {\r\n      group: 'Snap To Position X',\r\n      displayName: 'Do',\r\n      editorName: 'Do|Snap To Position X',\r\n      type: 'signal',\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const { snapPositionX, snapDurationX } = this._internal;\r\n          this.innerReactComponentRef && this.innerReactComponentRef.snapToPositionX(snapPositionX, snapDurationX);\r\n        });\r\n      }\r\n    },\r\n    'snapToPositionX.value': {\r\n      default: 0,\r\n      group: 'Snap To Position X',\r\n      displayName: 'Value',\r\n      editorName: 'Value|Snap To Position X',\r\n      type: 'number',\r\n      set(value) {\r\n        this._internal.snapPositionX = value;\r\n      }\r\n    },\r\n    'snapToPositionX.duration': {\r\n      default: 300,\r\n      group: 'Snap To Position X',\r\n      displayName: 'Duration',\r\n      editorName: 'Duration|Snap To Position X',\r\n      type: 'number',\r\n      set(value) {\r\n        this._internal.snapDurationX = value;\r\n      }\r\n    },\r\n    'snapToPositionY.do': {\r\n      group: 'Snap To Position Y',\r\n      displayName: 'Do',\r\n      editorName: 'Do|Snap To Position Y',\r\n      type: 'signal',\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const { snapPositionY, snapDurationY } = this._internal;\r\n          this.innerReactComponentRef && this.innerReactComponentRef.snapToPositionY(snapPositionY, snapDurationY);\r\n        });\r\n      }\r\n    },\r\n    'snapToPositionY.value': {\r\n      default: 0,\r\n      group: 'Snap To Position Y',\r\n      displayName: 'Value',\r\n      editorName: 'Value|Snap To Position Y',\r\n      type: 'number',\r\n      set(value) {\r\n        this._internal.snapPositionY = value;\r\n      }\r\n    },\r\n    'snapToPositionY.duration': {\r\n      default: 300,\r\n      group: 'Snap To Position Y',\r\n      displayName: 'Duration',\r\n      editorName: 'Duration|Snap To Position Y',\r\n      type: 'number',\r\n      set(value) {\r\n        this._internal.snapDurationY = value;\r\n      }\r\n    }\r\n  },\r\n  inputProps: {\r\n    enabled: {\r\n      group: 'Drag',\r\n      displayName: 'Enabled',\r\n      type: 'boolean',\r\n      default: true\r\n    },\r\n    axis: {\r\n      group: 'Drag',\r\n      displayName: 'Axis',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'X', value: 'x' },\r\n          { label: 'Y', value: 'y' },\r\n          { label: 'Both', value: 'both' }\r\n        ]\r\n      },\r\n      default: 'x'\r\n    },\r\n    useParentBounds: {\r\n      group: 'Drag',\r\n      displayName: 'Constrain to parent',\r\n      type: 'boolean',\r\n      default: true\r\n    },\r\n    inputPositionX: {\r\n      displayName: 'Start Drag X',\r\n      type: {\r\n        name: 'number'\r\n      }\r\n    },\r\n    inputPositionY: {\r\n      displayName: 'Start Drag Y',\r\n      type: {\r\n        name: 'number'\r\n      }\r\n    },\r\n    scale: {\r\n      displayName: 'Scale',\r\n      default: 1.0,\r\n      type: {\r\n        name: 'number'\r\n      }\r\n    }\r\n  },\r\n  outputProps: {\r\n    onStart: {\r\n      group: 'Signals',\r\n      type: 'signal',\r\n      displayName: 'Drag Started'\r\n    },\r\n    onStop: {\r\n      group: 'Signals',\r\n      type: 'signal',\r\n      displayName: 'Drag Ended'\r\n    },\r\n    onDrag: {\r\n      group: 'Signals',\r\n      type: 'signal',\r\n      displayName: 'Drag Moved'\r\n    },\r\n    positionX: {\r\n      group: 'Values',\r\n      displayName: 'Drag X',\r\n      type: 'number'\r\n    },\r\n    positionY: {\r\n      group: 'Values',\r\n      displayName: 'Drag Y',\r\n      type: 'number'\r\n    },\r\n    deltaX: {\r\n      group: 'Values',\r\n      displayName: 'Delta X',\r\n      type: 'number'\r\n    },\r\n    deltaY: {\r\n      group: 'Values',\r\n      displayName: 'Delta Y',\r\n      type: 'number'\r\n    }\r\n  }\r\n};\r\n\r\nexport default createNodeFromReactComponent(DragNode);\r\n","/*!\n * better-scroll / core\n * (c) 2016-2021 ustbhuangyi\n * Released under the MIT License.\n */\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\nvar propertiesConfig = [\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.currentPos',\r\n        key: 'x'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.currentPos',\r\n        key: 'y'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.hasScroll',\r\n        key: 'hasHorizontalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.hasScroll',\r\n        key: 'hasVerticalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.contentSize',\r\n        key: 'scrollerWidth'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.contentSize',\r\n        key: 'scrollerHeight'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.maxScrollPos',\r\n        key: 'maxScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.maxScrollPos',\r\n        key: 'maxScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.minScrollPos',\r\n        key: 'minScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.minScrollPos',\r\n        key: 'minScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.movingDirection',\r\n        key: 'movingDirectionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.movingDirection',\r\n        key: 'movingDirectionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.direction',\r\n        key: 'directionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.direction',\r\n        key: 'directionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.actions.enabled',\r\n        key: 'enabled'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.pending',\r\n        key: 'pending'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.stop',\r\n        key: 'stop'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollTo',\r\n        key: 'scrollTo'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBy',\r\n        key: 'scrollBy'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollToElement',\r\n        key: 'scrollToElement'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.resetPosition',\r\n        key: 'resetPosition'\r\n    }\r\n];\n\nfunction warn(msg) {\r\n    console.error(\"[BScroll warn]: \" + msg);\r\n}\n\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\nvar isWeChatDevTools = !!(ua && /wechatdevtools/.test(ua));\r\nvar isAndroid = ua && ua.indexOf('android') > 0;\r\n/* istanbul ignore next */\r\nvar isIOSBadVersion = (function () {\r\n    if (typeof ua === 'string') {\r\n        var regex = /os (\\d\\d?_\\d(_\\d)?)/;\r\n        var matches = regex.exec(ua);\r\n        if (!matches)\r\n            return false;\r\n        var parts = matches[1].split('_').map(function (item) {\r\n            return parseInt(item, 10);\r\n        });\r\n        // ios version >= 13.4 issue 982\r\n        return !!(parts[0] === 13 && parts[1] >= 4);\r\n    }\r\n    return false;\r\n})();\r\n/* istanbul ignore next */\r\nvar supportsPassive = false;\r\n/* istanbul ignore next */\r\nif (inBrowser) {\r\n    var EventName = 'test-passive';\r\n    try {\r\n        var opts = {};\r\n        Object.defineProperty(opts, 'passive', {\r\n            get: function () {\r\n                supportsPassive = true;\r\n            },\r\n        }); // https://github.com/facebook/flow/issues/285\r\n        window.addEventListener(EventName, function () { }, opts);\r\n    }\r\n    catch (e) { }\r\n}\n\nfunction getNow() {\r\n    return window.performance &&\r\n        window.performance.now &&\r\n        window.performance.timing\r\n        ? window.performance.now() + window.performance.timing.navigationStart\r\n        : +new Date();\r\n}\r\nvar extend = function (target, source) {\r\n    for (var key in source) {\r\n        target[key] = source[key];\r\n    }\r\n    return target;\r\n};\r\nfunction isUndef(v) {\r\n    return v === undefined || v === null;\r\n}\r\nfunction between(x, min, max) {\r\n    if (x < min) {\r\n        return min;\r\n    }\r\n    if (x > max) {\r\n        return max;\r\n    }\r\n    return x;\r\n}\n\nvar elementStyle = (inBrowser &&\r\n    document.createElement('div').style);\r\nvar vendor = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return false;\r\n    }\r\n    var transformNames = [\r\n        {\r\n            key: 'standard',\r\n            value: 'transform',\r\n        },\r\n        {\r\n            key: 'webkit',\r\n            value: 'webkitTransform',\r\n        },\r\n        {\r\n            key: 'Moz',\r\n            value: 'MozTransform',\r\n        },\r\n        {\r\n            key: 'O',\r\n            value: 'OTransform',\r\n        },\r\n        {\r\n            key: 'ms',\r\n            value: 'msTransform',\r\n        },\r\n    ];\r\n    for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\r\n        var obj = transformNames_1[_i];\r\n        if (elementStyle[obj.value] !== undefined) {\r\n            return obj.key;\r\n        }\r\n    }\r\n    /* istanbul ignore next  */\r\n    return false;\r\n})();\r\n/* istanbul ignore next  */\r\nfunction prefixStyle(style) {\r\n    if (vendor === false) {\r\n        return style;\r\n    }\r\n    if (vendor === 'standard') {\r\n        if (style === 'transitionEnd') {\r\n            return 'transitionend';\r\n        }\r\n        return style;\r\n    }\r\n    return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nfunction getElement(el) {\r\n    return (typeof el === 'string'\r\n        ? document.querySelector(el)\r\n        : el);\r\n}\r\nfunction addEvent(el, type, fn, capture) {\r\n    var useCapture = supportsPassive\r\n        ? {\r\n            passive: false,\r\n            capture: !!capture,\r\n        }\r\n        : !!capture;\r\n    el.addEventListener(type, fn, useCapture);\r\n}\r\nfunction removeEvent(el, type, fn, capture) {\r\n    el.removeEventListener(type, fn, {\r\n        capture: !!capture,\r\n    });\r\n}\r\nfunction offset(el) {\r\n    var left = 0;\r\n    var top = 0;\r\n    while (el) {\r\n        left -= el.offsetLeft;\r\n        top -= el.offsetTop;\r\n        el = el.offsetParent;\r\n    }\r\n    return {\r\n        left: left,\r\n        top: top,\r\n    };\r\n}\r\nvendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle;\r\n// fix issue #361\r\nvar hasTouch = inBrowser && ('ontouchstart' in window || isWeChatDevTools);\r\nvar hasTransition = inBrowser && transition in elementStyle;\r\nvar style = {\r\n    transform: transform,\r\n    transition: transition,\r\n    transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n    transitionDuration: prefixStyle('transitionDuration'),\r\n    transitionDelay: prefixStyle('transitionDelay'),\r\n    transformOrigin: prefixStyle('transformOrigin'),\r\n    transitionEnd: prefixStyle('transitionEnd'),\r\n    transitionProperty: prefixStyle('transitionProperty'),\r\n};\r\nvar eventTypeMap = {\r\n    touchstart: 1,\r\n    touchmove: 1,\r\n    touchend: 1,\r\n    touchcancel: 1,\r\n    mousedown: 2,\r\n    mousemove: 2,\r\n    mouseup: 2,\r\n};\r\nfunction getRect(el) {\r\n    /* istanbul ignore if  */\r\n    if (el instanceof window.SVGElement) {\r\n        var rect = el.getBoundingClientRect();\r\n        return {\r\n            top: rect.top,\r\n            left: rect.left,\r\n            width: rect.width,\r\n            height: rect.height,\r\n        };\r\n    }\r\n    else {\r\n        return {\r\n            top: el.offsetTop,\r\n            left: el.offsetLeft,\r\n            width: el.offsetWidth,\r\n            height: el.offsetHeight,\r\n        };\r\n    }\r\n}\r\nfunction preventDefaultExceptionFn(el, exceptions) {\r\n    for (var i in exceptions) {\r\n        if (exceptions[i].test(el[i])) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nvar tagExceptionFn = preventDefaultExceptionFn;\r\nfunction tap(e, eventName) {\r\n    var ev = document.createEvent('Event');\r\n    ev.initEvent(eventName, true, true);\r\n    ev.pageX = e.pageX;\r\n    ev.pageY = e.pageY;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction click(e, event) {\r\n    if (event === void 0) { event = 'click'; }\r\n    var eventSource;\r\n    if (e.type === 'mouseup') {\r\n        eventSource = e;\r\n    }\r\n    else if (e.type === 'touchend' || e.type === 'touchcancel') {\r\n        eventSource = e.changedTouches[0];\r\n    }\r\n    var posSrc = {};\r\n    if (eventSource) {\r\n        posSrc.screenX = eventSource.screenX || 0;\r\n        posSrc.screenY = eventSource.screenY || 0;\r\n        posSrc.clientX = eventSource.clientX || 0;\r\n        posSrc.clientY = eventSource.clientY || 0;\r\n    }\r\n    var ev;\r\n    var bubbles = true;\r\n    var cancelable = true;\r\n    var ctrlKey = e.ctrlKey, shiftKey = e.shiftKey, altKey = e.altKey, metaKey = e.metaKey;\r\n    var pressedKeysMap = {\r\n        ctrlKey: ctrlKey,\r\n        shiftKey: shiftKey,\r\n        altKey: altKey,\r\n        metaKey: metaKey,\r\n    };\r\n    if (typeof MouseEvent !== 'undefined') {\r\n        try {\r\n            ev = new MouseEvent(event, extend(__assign({ bubbles: bubbles,\r\n                cancelable: cancelable }, pressedKeysMap), posSrc));\r\n        }\r\n        catch (e) {\r\n            /* istanbul ignore next */\r\n            createEvent();\r\n        }\r\n    }\r\n    else {\r\n        createEvent();\r\n    }\r\n    function createEvent() {\r\n        ev = document.createEvent('Event');\r\n        ev.initEvent(event, bubbles, cancelable);\r\n        extend(ev, posSrc);\r\n    }\r\n    // forwardedTouchEvent set to true in case of the conflict with fastclick\r\n    ev.forwardedTouchEvent = true;\r\n    ev._constructed = true;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction dblclick(e) {\r\n    click(e, 'dblclick');\r\n}\n\nvar ease = {\r\n    // easeOutQuint\r\n    swipe: {\r\n        style: 'cubic-bezier(0.23, 1, 0.32, 1)',\r\n        fn: function (t) {\r\n            return 1 + --t * t * t * t * t;\r\n        }\r\n    },\r\n    // easeOutQuard\r\n    swipeBounce: {\r\n        style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n        fn: function (t) {\r\n            return t * (2 - t);\r\n        }\r\n    },\r\n    // easeOutQuart\r\n    bounce: {\r\n        style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\r\n        fn: function (t) {\r\n            return 1 - --t * t * t * t;\r\n        }\r\n    }\r\n};\n\nvar DEFAULT_INTERVAL = 1000 / 60;\r\nvar windowCompat = inBrowser && window;\r\n/* istanbul ignore next */\r\nfunction noop$1() { }\r\nvar requestAnimationFrame = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return noop$1;\r\n    }\r\n    return (windowCompat.requestAnimationFrame ||\r\n        windowCompat.webkitRequestAnimationFrame ||\r\n        windowCompat.mozRequestAnimationFrame ||\r\n        windowCompat.oRequestAnimationFrame ||\r\n        // if all else fails, use setTimeout\r\n        function (callback) {\r\n            return window.setTimeout(callback, callback.interval || DEFAULT_INTERVAL); // make interval as precise as possible.\r\n        });\r\n})();\r\nvar cancelAnimationFrame = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return noop$1;\r\n    }\r\n    return (windowCompat.cancelAnimationFrame ||\r\n        windowCompat.webkitCancelAnimationFrame ||\r\n        windowCompat.mozCancelAnimationFrame ||\r\n        windowCompat.oCancelAnimationFrame ||\r\n        function (id) {\r\n            window.clearTimeout(id);\r\n        });\r\n})();\n\n/* istanbul ignore next */\r\nvar noop = function (val) { };\r\nvar sharedPropertyDefinition = {\r\n    enumerable: true,\r\n    configurable: true,\r\n    get: noop,\r\n    set: noop,\r\n};\r\nvar getProperty = function (obj, key) {\r\n    var keys = key.split('.');\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        obj = obj[keys[i]];\r\n        if (typeof obj !== 'object' || !obj)\r\n            return;\r\n    }\r\n    var lastKey = keys.pop();\r\n    if (typeof obj[lastKey] === 'function') {\r\n        return function () {\r\n            return obj[lastKey].apply(obj, arguments);\r\n        };\r\n    }\r\n    else {\r\n        return obj[lastKey];\r\n    }\r\n};\r\nvar setProperty = function (obj, key, value) {\r\n    var keys = key.split('.');\r\n    var temp;\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        temp = keys[i];\r\n        if (!obj[temp])\r\n            obj[temp] = {};\r\n        obj = obj[temp];\r\n    }\r\n    obj[keys.pop()] = value;\r\n};\r\nfunction propertiesProxy(target, sourceKey, key) {\r\n    sharedPropertyDefinition.get = function proxyGetter() {\r\n        return getProperty(this, sourceKey);\r\n    };\r\n    sharedPropertyDefinition.set = function proxySetter(val) {\r\n        setProperty(this, sourceKey, val);\r\n    };\r\n    Object.defineProperty(target, key, sharedPropertyDefinition);\r\n}\n\nvar EventEmitter = /** @class */ (function () {\r\n    function EventEmitter(names) {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n        this.registerType(names);\r\n    }\r\n    EventEmitter.prototype.on = function (type, fn, context) {\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        if (!this.events[type]) {\r\n            this.events[type] = [];\r\n        }\r\n        this.events[type].push([fn, context]);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.once = function (type, fn, context) {\r\n        var _this = this;\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        var magic = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            _this.off(type, magic);\r\n            var ret = fn.apply(context, args);\r\n            if (ret === true) {\r\n                return ret;\r\n            }\r\n        };\r\n        magic.fn = fn;\r\n        this.on(type, magic);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.off = function (type, fn) {\r\n        if (!type && !fn) {\r\n            this.events = {};\r\n            return this;\r\n        }\r\n        if (type) {\r\n            this.hasType(type);\r\n            if (!fn) {\r\n                this.events[type] = [];\r\n                return this;\r\n            }\r\n            var events = this.events[type];\r\n            if (!events) {\r\n                return this;\r\n            }\r\n            var count = events.length;\r\n            while (count--) {\r\n                if (events[count][0] === fn ||\r\n                    (events[count][0] && events[count][0].fn === fn)) {\r\n                    events.splice(count, 1);\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    EventEmitter.prototype.trigger = function (type) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        this.hasType(type);\r\n        var events = this.events[type];\r\n        if (!events) {\r\n            return;\r\n        }\r\n        var len = events.length;\r\n        var eventsCopy = __spreadArrays(events);\r\n        var ret;\r\n        for (var i = 0; i < len; i++) {\r\n            var event_1 = eventsCopy[i];\r\n            var fn = event_1[0], context = event_1[1];\r\n            if (fn) {\r\n                ret = fn.apply(context, args);\r\n                if (ret === true) {\r\n                    return ret;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    EventEmitter.prototype.registerType = function (names) {\r\n        var _this = this;\r\n        names.forEach(function (type) {\r\n            _this.eventTypes[type] = type;\r\n        });\r\n    };\r\n    EventEmitter.prototype.destroy = function () {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n    };\r\n    EventEmitter.prototype.hasType = function (type) {\r\n        var types = this.eventTypes;\r\n        var isType = types[type] === type;\r\n        if (!isType) {\r\n            warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" +\r\n                (\"\" + Object.keys(types).map(function (_) { return JSON.stringify(_); })) +\r\n                \"]\");\r\n        }\r\n    };\r\n    return EventEmitter;\r\n}());\r\nvar EventRegister = /** @class */ (function () {\r\n    function EventRegister(wrapper, events) {\r\n        this.wrapper = wrapper;\r\n        this.events = events;\r\n        this.addDOMEvents();\r\n    }\r\n    EventRegister.prototype.destroy = function () {\r\n        this.removeDOMEvents();\r\n        this.events = [];\r\n    };\r\n    EventRegister.prototype.addDOMEvents = function () {\r\n        this.handleDOMEvents(addEvent);\r\n    };\r\n    EventRegister.prototype.removeDOMEvents = function () {\r\n        this.handleDOMEvents(removeEvent);\r\n    };\r\n    EventRegister.prototype.handleDOMEvents = function (eventOperation) {\r\n        var _this = this;\r\n        var wrapper = this.wrapper;\r\n        this.events.forEach(function (event) {\r\n            eventOperation(wrapper, event.name, _this, !!event.capture);\r\n        });\r\n    };\r\n    EventRegister.prototype.handleEvent = function (e) {\r\n        var eventType = e.type;\r\n        this.events.some(function (event) {\r\n            if (event.name === eventType) {\r\n                event.handler(e);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    };\r\n    return EventRegister;\r\n}());\n\nvar CustomOptions = /** @class */ (function () {\r\n    function CustomOptions() {\r\n    }\r\n    return CustomOptions;\r\n}());\r\nvar OptionsConstructor = /** @class */ (function (_super) {\r\n    __extends(OptionsConstructor, _super);\r\n    function OptionsConstructor() {\r\n        var _this = _super.call(this) || this;\r\n        _this.startX = 0;\r\n        _this.startY = 0;\r\n        _this.scrollX = false;\r\n        _this.scrollY = true;\r\n        _this.freeScroll = false;\r\n        _this.directionLockThreshold = 0;\r\n        _this.eventPassthrough = \"\" /* None */;\r\n        _this.click = false;\r\n        _this.dblclick = false;\r\n        _this.tap = '';\r\n        _this.bounce = {\r\n            top: true,\r\n            bottom: true,\r\n            left: true,\r\n            right: true,\r\n        };\r\n        _this.bounceTime = 800;\r\n        _this.momentum = true;\r\n        _this.momentumLimitTime = 300;\r\n        _this.momentumLimitDistance = 15;\r\n        _this.swipeTime = 2500;\r\n        _this.swipeBounceTime = 500;\r\n        _this.deceleration = 0.0015;\r\n        _this.flickLimitTime = 200;\r\n        _this.flickLimitDistance = 100;\r\n        _this.resizePolling = 60;\r\n        _this.probeType = 0 /* Default */;\r\n        _this.stopPropagation = false;\r\n        _this.preventDefault = true;\r\n        _this.preventDefaultException = {\r\n            tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/,\r\n        };\r\n        _this.tagException = {\r\n            tagName: /^TEXTAREA$/,\r\n        };\r\n        _this.HWCompositing = true;\r\n        _this.useTransition = true;\r\n        _this.bindToWrapper = false;\r\n        _this.bindToTarget = false;\r\n        _this.disableMouse = hasTouch;\r\n        _this.disableTouch = !hasTouch;\r\n        _this.autoBlur = true;\r\n        _this.autoEndDistance = 5;\r\n        _this.outOfBoundaryDampingFactor = 1 / 3;\r\n        _this.specifiedIndexAsContent = 0;\r\n        _this.quadrant = 1 /* First */;\r\n        return _this;\r\n    }\r\n    OptionsConstructor.prototype.merge = function (options) {\r\n        if (!options)\r\n            return this;\r\n        for (var key in options) {\r\n            if (key === 'bounce') {\r\n                this.bounce = this.resolveBounce(options[key]);\r\n                continue;\r\n            }\r\n            this[key] = options[key];\r\n        }\r\n        return this;\r\n    };\r\n    OptionsConstructor.prototype.process = function () {\r\n        this.translateZ =\r\n            this.HWCompositing && hasPerspective ? ' translateZ(1px)' : '';\r\n        this.useTransition = this.useTransition && hasTransition;\r\n        this.preventDefault = !this.eventPassthrough && this.preventDefault;\r\n        // If you want eventPassthrough I have to lock one of the axes\r\n        this.scrollX =\r\n            this.eventPassthrough === \"horizontal\" /* Horizontal */\r\n                ? false\r\n                : this.scrollX;\r\n        this.scrollY =\r\n            this.eventPassthrough === \"vertical\" /* Vertical */ ? false : this.scrollY;\r\n        // With eventPassthrough we also need lockDirection mechanism\r\n        this.freeScroll = this.freeScroll && !this.eventPassthrough;\r\n        // force true when freeScroll is true\r\n        this.scrollX = this.freeScroll ? true : this.scrollX;\r\n        this.scrollY = this.freeScroll ? true : this.scrollY;\r\n        this.directionLockThreshold = this.eventPassthrough\r\n            ? 0\r\n            : this.directionLockThreshold;\r\n        return this;\r\n    };\r\n    OptionsConstructor.prototype.resolveBounce = function (bounceOptions) {\r\n        var DEFAULT_BOUNCE = {\r\n            top: true,\r\n            right: true,\r\n            bottom: true,\r\n            left: true,\r\n        };\r\n        var NEGATED_BOUNCE = {\r\n            top: false,\r\n            right: false,\r\n            bottom: false,\r\n            left: false,\r\n        };\r\n        var ret;\r\n        if (typeof bounceOptions === 'object') {\r\n            ret = extend(DEFAULT_BOUNCE, bounceOptions);\r\n        }\r\n        else {\r\n            ret = bounceOptions ? DEFAULT_BOUNCE : NEGATED_BOUNCE;\r\n        }\r\n        return ret;\r\n    };\r\n    return OptionsConstructor;\r\n}(CustomOptions));\n\nvar ActionsHandler = /** @class */ (function () {\r\n    function ActionsHandler(wrapper, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'start',\r\n            'move',\r\n            'end',\r\n            'click',\r\n        ]);\r\n        this.handleDOMEvents();\r\n    }\r\n    ActionsHandler.prototype.handleDOMEvents = function () {\r\n        var _a = this.options, bindToWrapper = _a.bindToWrapper, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch, click = _a.click;\r\n        var wrapper = this.wrapper;\r\n        var target = bindToWrapper ? wrapper : window;\r\n        var wrapperEvents = [];\r\n        var targetEvents = [];\r\n        var shouldRegisterTouch = !disableTouch;\r\n        var shouldRegisterMouse = !disableMouse;\r\n        if (click) {\r\n            wrapperEvents.push({\r\n                name: 'click',\r\n                handler: this.click.bind(this),\r\n                capture: true,\r\n            });\r\n        }\r\n        if (shouldRegisterTouch) {\r\n            wrapperEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            targetEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            }, {\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (shouldRegisterMouse) {\r\n            wrapperEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            targetEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            }, {\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.wrapperEventRegister = new EventRegister(wrapper, wrapperEvents);\r\n        this.targetEventRegister = new EventRegister(target, targetEvents);\r\n    };\r\n    ActionsHandler.prototype.beforeHandler = function (e, type) {\r\n        var _a = this.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        var preventDefaultConditions = {\r\n            start: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            end: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            move: function () {\r\n                return preventDefault;\r\n            },\r\n        };\r\n        if (preventDefaultConditions[type]()) {\r\n            e.preventDefault();\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.setInitiated = function (type) {\r\n        if (type === void 0) { type = 0; }\r\n        this.initiated = type;\r\n    };\r\n    ActionsHandler.prototype.start = function (e) {\r\n        var _eventType = eventTypeMap[e.type];\r\n        if (this.initiated && this.initiated !== _eventType) {\r\n            return;\r\n        }\r\n        this.setInitiated(_eventType);\r\n        // if textarea or other html tags in options.tagException is manipulated\r\n        // do not make bs scroll\r\n        if (tagExceptionFn(e.target, this.options.tagException)) {\r\n            this.setInitiated();\r\n            return;\r\n        }\r\n        // only allow mouse left button\r\n        if (_eventType === 2 /* Mouse */ && e.button !== 0 /* Left */)\r\n            return;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeStart, e)) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'start');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ActionsHandler.prototype.move = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'move');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var deltaX = point.pageX - this.pointX;\r\n        var deltaY = point.pageY - this.pointY;\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.move, {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY,\r\n            e: e,\r\n        })) {\r\n            return;\r\n        }\r\n        // auto end when out of viewport\r\n        var scrollLeft = document.documentElement.scrollLeft ||\r\n            window.pageXOffset ||\r\n            document.body.scrollLeft;\r\n        var scrollTop = document.documentElement.scrollTop ||\r\n            window.pageYOffset ||\r\n            document.body.scrollTop;\r\n        var pX = this.pointX - scrollLeft;\r\n        var pY = this.pointY - scrollTop;\r\n        var autoEndDistance = this.options.autoEndDistance;\r\n        if (pX > document.documentElement.clientWidth - autoEndDistance ||\r\n            pY > document.documentElement.clientHeight - autoEndDistance ||\r\n            pX < autoEndDistance ||\r\n            pY < autoEndDistance) {\r\n            this.end(e);\r\n        }\r\n    };\r\n    ActionsHandler.prototype.end = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.setInitiated();\r\n        this.beforeHandler(e, 'end');\r\n        this.hooks.trigger(this.hooks.eventTypes.end, e);\r\n    };\r\n    ActionsHandler.prototype.click = function (e) {\r\n        this.hooks.trigger(this.hooks.eventTypes.click, e);\r\n    };\r\n    ActionsHandler.prototype.setContent = function (content) {\r\n        if (content !== this.wrapper) {\r\n            this.wrapper = content;\r\n            this.rebindDOMEvents();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.rebindDOMEvents = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.handleDOMEvents();\r\n    };\r\n    ActionsHandler.prototype.destroy = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.hooks.destroy();\r\n    };\r\n    return ActionsHandler;\r\n}());\n\nvar translaterMetaData = {\r\n    x: ['translateX', 'px'],\r\n    y: ['translateY', 'px'],\r\n};\r\nvar Translater = /** @class */ (function () {\r\n    function Translater(content) {\r\n        this.setContent(content);\r\n        this.hooks = new EventEmitter(['beforeTranslate', 'translate']);\r\n    }\r\n    Translater.prototype.getComputedPosition = function () {\r\n        var cssStyle = window.getComputedStyle(this.content, null);\r\n        var matrix = cssStyle[style.transform].split(')')[0].split(', ');\r\n        var x = +(matrix[12] || matrix[4]) || 0;\r\n        var y = +(matrix[13] || matrix[5]) || 0;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n        };\r\n    };\r\n    Translater.prototype.translate = function (point) {\r\n        var transformStyle = [];\r\n        Object.keys(point).forEach(function (key) {\r\n            if (!translaterMetaData[key]) {\r\n                return;\r\n            }\r\n            var transformFnName = translaterMetaData[key][0];\r\n            if (transformFnName) {\r\n                var transformFnArgUnit = translaterMetaData[key][1];\r\n                var transformFnArg = point[key];\r\n                transformStyle.push(transformFnName + \"(\" + transformFnArg + transformFnArgUnit + \")\");\r\n            }\r\n        });\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeTranslate, transformStyle, point);\r\n        this.style[style.transform] = transformStyle.join(' ');\r\n        this.hooks.trigger(this.hooks.eventTypes.translate, point);\r\n    };\r\n    Translater.prototype.setContent = function (content) {\r\n        if (this.content !== content) {\r\n            this.content = content;\r\n            this.style = content.style;\r\n        }\r\n    };\r\n    Translater.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Translater;\r\n}());\n\nvar Base = /** @class */ (function () {\r\n    function Base(content, translater, options) {\r\n        this.translater = translater;\r\n        this.options = options;\r\n        this.timer = 0;\r\n        this.hooks = new EventEmitter([\r\n            'move',\r\n            'end',\r\n            'beforeForceStop',\r\n            'forceStop',\r\n            'callStop',\r\n            'time',\r\n            'timeFunction',\r\n        ]);\r\n        this.setContent(content);\r\n    }\r\n    Base.prototype.translate = function (endPoint) {\r\n        this.translater.translate(endPoint);\r\n    };\r\n    Base.prototype.setPending = function (pending) {\r\n        this.pending = pending;\r\n    };\r\n    Base.prototype.setForceStopped = function (forceStopped) {\r\n        this.forceStopped = forceStopped;\r\n    };\r\n    Base.prototype.setCallStop = function (called) {\r\n        this.callStopWhenPending = called;\r\n    };\r\n    Base.prototype.setContent = function (content) {\r\n        if (this.content !== content) {\r\n            this.content = content;\r\n            this.style = content.style;\r\n            this.stop();\r\n        }\r\n    };\r\n    Base.prototype.clearTimer = function () {\r\n        if (this.timer) {\r\n            cancelAnimationFrame(this.timer);\r\n            this.timer = 0;\r\n        }\r\n    };\r\n    Base.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n        cancelAnimationFrame(this.timer);\r\n    };\r\n    return Base;\r\n}());\n\n// iOS 13.6 - 14.x, window.getComputedStyle sometimes will get wrong transform value\r\n// when bs use transition mode\r\n// eg: translateY -100px -> -200px, when the last frame which is about to scroll to -200px\r\n// window.getComputedStyle(this.content) will calculate transformY to be -100px(startPoint)\r\n// it is weird\r\n// so we should validate position caculated by 'window.getComputedStyle'\r\nvar isValidPostion = function (startPoint, endPoint, currentPos, prePos) {\r\n    var computeDirection = function (endValue, startValue) {\r\n        var delta = endValue - startValue;\r\n        var direction = delta > 0\r\n            ? -1 /* Negative */\r\n            : delta < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        return direction;\r\n    };\r\n    var directionX = computeDirection(endPoint.x, startPoint.x);\r\n    var directionY = computeDirection(endPoint.y, startPoint.y);\r\n    var deltaX = currentPos.x - prePos.x;\r\n    var deltaY = currentPos.y - prePos.y;\r\n    return directionX * deltaX <= 0 && directionY * deltaY <= 0;\r\n};\n\nvar Transition = /** @class */ (function (_super) {\r\n    __extends(Transition, _super);\r\n    function Transition() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Transition.prototype.startProbe = function (startPoint, endPoint) {\r\n        var _this = this;\r\n        var prePos = startPoint;\r\n        var probe = function () {\r\n            var pos = _this.translater.getComputedPosition();\r\n            if (isValidPostion(startPoint, endPoint, pos, prePos)) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, pos);\r\n            }\r\n            // call bs.stop() should not dispatch end hook again.\r\n            // forceStop hook will do this.\r\n            /* istanbul ignore if  */\r\n            if (!_this.pending) {\r\n                if (_this.callStopWhenPending) {\r\n                    _this.callStopWhenPending = false;\r\n                }\r\n                else {\r\n                    // transition ends should dispatch end hook.\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.end, pos);\r\n                }\r\n            }\r\n            prePos = pos;\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(probe);\r\n            }\r\n        };\r\n        // when manually call bs.stop(), then bs.scrollTo()\r\n        // we should reset callStopWhenPending to dispatch end hook\r\n        if (this.callStopWhenPending) {\r\n            this.setCallStop(false);\r\n        }\r\n        cancelAnimationFrame(this.timer);\r\n        probe();\r\n    };\r\n    Transition.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.style[style.transitionDuration] = time + 'ms';\r\n        this.hooks.trigger(this.hooks.eventTypes.time, time);\r\n    };\r\n    Transition.prototype.transitionTimingFunction = function (easing) {\r\n        this.style[style.transitionTimingFunction] = easing;\r\n        this.hooks.trigger(this.hooks.eventTypes.timeFunction, easing);\r\n    };\r\n    Transition.prototype.transitionProperty = function () {\r\n        this.style[style.transitionProperty] = style.transform;\r\n    };\r\n    Transition.prototype.move = function (startPoint, endPoint, time, easingFn) {\r\n        this.setPending(time > 0);\r\n        this.transitionTimingFunction(easingFn);\r\n        this.transitionProperty();\r\n        this.transitionTime(time);\r\n        this.translate(endPoint);\r\n        var isRealtimeProbeType = this.options.probeType === 3 /* Realtime */;\r\n        if (time && isRealtimeProbeType) {\r\n            this.startProbe(startPoint, endPoint);\r\n        }\r\n        // if we change content's transformY in a tick\r\n        // such as: 0 -> 50px -> 0\r\n        // transitionend will not be triggered\r\n        // so we forceupdate by reflow\r\n        if (!time) {\r\n            this._reflow = this.content.offsetHeight;\r\n            if (isRealtimeProbeType) {\r\n                this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n        }\r\n    };\r\n    Transition.prototype.doStop = function () {\r\n        var pending = this.pending;\r\n        this.setForceStopped(false);\r\n        this.setCallStop(false);\r\n        // still in transition\r\n        if (pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var _a = this.translater.getComputedPosition(), x = _a.x, y = _a.y;\r\n            this.transitionTime();\r\n            this.translate({ x: x, y: y });\r\n            this.setForceStopped(true);\r\n            this.setCallStop(true);\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, { x: x, y: y });\r\n        }\r\n        return pending;\r\n    };\r\n    Transition.prototype.stop = function () {\r\n        var stopFromTransition = this.doStop();\r\n        if (stopFromTransition) {\r\n            this.hooks.trigger(this.hooks.eventTypes.callStop);\r\n        }\r\n    };\r\n    return Transition;\r\n}(Base));\n\nvar Animation = /** @class */ (function (_super) {\r\n    __extends(Animation, _super);\r\n    function Animation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Animation.prototype.move = function (startPoint, endPoint, time, easingFn) {\r\n        // time is 0\r\n        if (!time) {\r\n            this.translate(endPoint);\r\n            if (this.options.probeType === 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n            return;\r\n        }\r\n        this.animate(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Animation.prototype.animate = function (startPoint, endPoint, duration, easingFn) {\r\n        var _this = this;\r\n        var startTime = getNow();\r\n        var destTime = startTime + duration;\r\n        var isRealtimeProbeType = this.options.probeType === 3 /* Realtime */;\r\n        var step = function () {\r\n            var now = getNow();\r\n            // js animation end\r\n            if (now >= destTime) {\r\n                _this.translate(endPoint);\r\n                if (isRealtimeProbeType) {\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.move, endPoint);\r\n                }\r\n                _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                return;\r\n            }\r\n            now = (now - startTime) / duration;\r\n            var easing = easingFn(now);\r\n            var newPoint = {};\r\n            Object.keys(endPoint).forEach(function (key) {\r\n                var startValue = startPoint[key];\r\n                var endValue = endPoint[key];\r\n                newPoint[key] = (endValue - startValue) * easing + startValue;\r\n            });\r\n            _this.translate(newPoint);\r\n            if (isRealtimeProbeType) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, newPoint);\r\n            }\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(step);\r\n            }\r\n            // call bs.stop() should not dispatch end hook again.\r\n            // forceStop hook will do this.\r\n            /* istanbul ignore if  */\r\n            if (!_this.pending) {\r\n                if (_this.callStopWhenPending) {\r\n                    _this.callStopWhenPending = false;\r\n                }\r\n                else {\r\n                    // raf ends should dispatch end hook.\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                }\r\n            }\r\n        };\r\n        this.setPending(true);\r\n        // when manually call bs.stop(), then bs.scrollTo()\r\n        // we should reset callStopWhenPending to dispatch end hook\r\n        if (this.callStopWhenPending) {\r\n            this.setCallStop(false);\r\n        }\r\n        cancelAnimationFrame(this.timer);\r\n        step();\r\n    };\r\n    Animation.prototype.doStop = function () {\r\n        var pending = this.pending;\r\n        this.setForceStopped(false);\r\n        this.setCallStop(false);\r\n        // still in requestFrameAnimation\r\n        if (pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var pos = this.translater.getComputedPosition();\r\n            this.setForceStopped(true);\r\n            this.setCallStop(true);\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, pos);\r\n        }\r\n        return pending;\r\n    };\r\n    Animation.prototype.stop = function () {\r\n        var stopFromAnimation = this.doStop();\r\n        if (stopFromAnimation) {\r\n            this.hooks.trigger(this.hooks.eventTypes.callStop);\r\n        }\r\n    };\r\n    return Animation;\r\n}(Base));\n\nfunction createAnimater(element, translater, options) {\r\n    var useTransition = options.useTransition;\r\n    var animaterOptions = {};\r\n    Object.defineProperty(animaterOptions, 'probeType', {\r\n        enumerable: true,\r\n        configurable: false,\r\n        get: function () {\r\n            return options.probeType;\r\n        },\r\n    });\r\n    if (useTransition) {\r\n        return new Transition(element, translater, animaterOptions);\r\n    }\r\n    else {\r\n        return new Animation(element, translater, animaterOptions);\r\n    }\r\n}\n\nvar Behavior = /** @class */ (function () {\r\n    function Behavior(wrapper, content, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeComputeBoundary',\r\n            'computeBoundary',\r\n            'momentum',\r\n            'end',\r\n            'ignoreHasScroll'\r\n        ]);\r\n        this.refresh(content);\r\n    }\r\n    Behavior.prototype.start = function () {\r\n        this.dist = 0;\r\n        this.setMovingDirection(0 /* Default */);\r\n        this.setDirection(0 /* Default */);\r\n    };\r\n    Behavior.prototype.move = function (delta) {\r\n        delta = this.hasScroll ? delta : 0;\r\n        this.setMovingDirection(delta);\r\n        return this.performDampingAlgorithm(delta, this.options.outOfBoundaryDampingFactor);\r\n    };\r\n    Behavior.prototype.setMovingDirection = function (delta) {\r\n        this.movingDirection =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.setDirection = function (delta) {\r\n        this.direction =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.performDampingAlgorithm = function (delta, dampingFactor) {\r\n        var newPos = this.currentPos + delta;\r\n        // Slow down or stop if outside of the boundaries\r\n        if (newPos > this.minScrollPos || newPos < this.maxScrollPos) {\r\n            if ((newPos > this.minScrollPos && this.options.bounces[0]) ||\r\n                (newPos < this.maxScrollPos && this.options.bounces[1])) {\r\n                newPos = this.currentPos + delta * dampingFactor;\r\n            }\r\n            else {\r\n                newPos =\r\n                    newPos > this.minScrollPos ? this.minScrollPos : this.maxScrollPos;\r\n            }\r\n        }\r\n        return newPos;\r\n    };\r\n    Behavior.prototype.end = function (duration) {\r\n        var momentumInfo = {\r\n            duration: 0\r\n        };\r\n        var absDist = Math.abs(this.currentPos - this.startPos);\r\n        // start momentum animation if needed\r\n        if (this.options.momentum &&\r\n            duration < this.options.momentumLimitTime &&\r\n            absDist > this.options.momentumLimitDistance) {\r\n            var wrapperSize = (this.direction === -1 /* Negative */ && this.options.bounces[0]) ||\r\n                (this.direction === 1 /* Positive */ && this.options.bounces[1])\r\n                ? this.wrapperSize\r\n                : 0;\r\n            momentumInfo = this.hasScroll\r\n                ? this.momentum(this.currentPos, this.startPos, duration, this.maxScrollPos, this.minScrollPos, wrapperSize, this.options)\r\n                : { destination: this.currentPos, duration: 0 };\r\n        }\r\n        else {\r\n            this.hooks.trigger(this.hooks.eventTypes.end, momentumInfo);\r\n        }\r\n        return momentumInfo;\r\n    };\r\n    Behavior.prototype.momentum = function (current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\r\n        if (options === void 0) { options = this.options; }\r\n        var distance = current - start;\r\n        var speed = Math.abs(distance) / time;\r\n        var deceleration = options.deceleration, swipeBounceTime = options.swipeBounceTime, swipeTime = options.swipeTime;\r\n        var duration = Math.min(swipeTime, (speed * 2) / deceleration);\r\n        var momentumData = {\r\n            destination: current + ((speed * speed) / deceleration) * (distance < 0 ? -1 : 1),\r\n            duration: duration,\r\n            rate: 15\r\n        };\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\r\n        if (momentumData.destination < lowerMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - (wrapperSize / momentumData.rate) * speed)\r\n                : lowerMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        else if (momentumData.destination > upperMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.min(upperMargin + wrapperSize / 4, upperMargin + (wrapperSize / momentumData.rate) * speed)\r\n                : upperMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        momentumData.destination = Math.round(momentumData.destination);\r\n        return momentumData;\r\n    };\r\n    Behavior.prototype.updateDirection = function () {\r\n        var absDist = this.currentPos - this.absStartPos;\r\n        this.setDirection(absDist);\r\n    };\r\n    Behavior.prototype.refresh = function (content) {\r\n        var _a = this.options.rect, size = _a.size, position = _a.position;\r\n        var isWrapperStatic = window.getComputedStyle(this.wrapper, null).position === 'static';\r\n        // Force reflow\r\n        var wrapperRect = getRect(this.wrapper);\r\n        // use client is more fair than offset\r\n        this.wrapperSize = this.wrapper[size === 'width' ? 'clientWidth' : 'clientHeight'];\r\n        this.setContent(content);\r\n        var contentRect = getRect(this.content);\r\n        this.contentSize = contentRect[size];\r\n        this.relativeOffset = contentRect[position];\r\n        /* istanbul ignore if  */\r\n        if (isWrapperStatic) {\r\n            this.relativeOffset -= wrapperRect[position];\r\n        }\r\n        this.computeBoundary();\r\n        this.setDirection(0 /* Default */);\r\n    };\r\n    Behavior.prototype.setContent = function (content) {\r\n        if (content !== this.content) {\r\n            this.content = content;\r\n            this.resetState();\r\n        }\r\n    };\r\n    Behavior.prototype.resetState = function () {\r\n        this.currentPos = 0;\r\n        this.startPos = 0;\r\n        this.dist = 0;\r\n        this.setDirection(0 /* Default */);\r\n        this.setMovingDirection(0 /* Default */);\r\n        this.resetStartPos();\r\n    };\r\n    Behavior.prototype.computeBoundary = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeComputeBoundary);\r\n        var boundary = {\r\n            minScrollPos: 0,\r\n            maxScrollPos: this.wrapperSize - this.contentSize\r\n        };\r\n        if (boundary.maxScrollPos < 0) {\r\n            boundary.maxScrollPos -= this.relativeOffset;\r\n            if (this.options.specifiedIndexAsContent === 0) {\r\n                boundary.minScrollPos = -this.relativeOffset;\r\n            }\r\n        }\r\n        this.hooks.trigger(this.hooks.eventTypes.computeBoundary, boundary);\r\n        this.minScrollPos = boundary.minScrollPos;\r\n        this.maxScrollPos = boundary.maxScrollPos;\r\n        this.hasScroll =\r\n            this.options.scrollable && this.maxScrollPos < this.minScrollPos;\r\n        if (!this.hasScroll && this.minScrollPos < this.maxScrollPos) {\r\n            this.maxScrollPos = this.minScrollPos;\r\n            this.contentSize = this.wrapperSize;\r\n        }\r\n    };\r\n    Behavior.prototype.updatePosition = function (pos) {\r\n        this.currentPos = pos;\r\n    };\r\n    Behavior.prototype.getCurrentPos = function () {\r\n        return this.currentPos;\r\n    };\r\n    Behavior.prototype.checkInBoundary = function () {\r\n        var position = this.adjustPosition(this.currentPos);\r\n        var inBoundary = position === this.getCurrentPos();\r\n        return {\r\n            position: position,\r\n            inBoundary: inBoundary\r\n        };\r\n    };\r\n    // adjust position when out of boundary\r\n    Behavior.prototype.adjustPosition = function (pos) {\r\n        if (!this.hasScroll &&\r\n            !this.hooks.trigger(this.hooks.eventTypes.ignoreHasScroll)) {\r\n            pos = this.minScrollPos;\r\n        }\r\n        else if (pos > this.minScrollPos) {\r\n            pos = this.minScrollPos;\r\n        }\r\n        else if (pos < this.maxScrollPos) {\r\n            pos = this.maxScrollPos;\r\n        }\r\n        return pos;\r\n    };\r\n    Behavior.prototype.updateStartPos = function () {\r\n        this.startPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.updateAbsStartPos = function () {\r\n        this.absStartPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.resetStartPos = function () {\r\n        this.updateStartPos();\r\n        this.updateAbsStartPos();\r\n    };\r\n    Behavior.prototype.getAbsDist = function (delta) {\r\n        this.dist += delta;\r\n        return Math.abs(this.dist);\r\n    };\r\n    Behavior.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Behavior;\r\n}());\n\nvar _a, _b, _c, _d;\r\nvar PassthroughHandlers = (_a = {},\r\n    _a[\"yes\" /* Yes */] = function (e) {\r\n        return true;\r\n    },\r\n    _a[\"no\" /* No */] = function (e) {\r\n        e.preventDefault();\r\n        return false;\r\n    },\r\n    _a);\r\nvar DirectionMap = (_b = {},\r\n    _b[\"horizontal\" /* Horizontal */] = (_c = {},\r\n        _c[\"yes\" /* Yes */] = \"horizontal\" /* Horizontal */,\r\n        _c[\"no\" /* No */] = \"vertical\" /* Vertical */,\r\n        _c),\r\n    _b[\"vertical\" /* Vertical */] = (_d = {},\r\n        _d[\"yes\" /* Yes */] = \"vertical\" /* Vertical */,\r\n        _d[\"no\" /* No */] = \"horizontal\" /* Horizontal */,\r\n        _d),\r\n    _b);\r\nvar DirectionLockAction = /** @class */ (function () {\r\n    function DirectionLockAction(directionLockThreshold, freeScroll, eventPassthrough) {\r\n        this.directionLockThreshold = directionLockThreshold;\r\n        this.freeScroll = freeScroll;\r\n        this.eventPassthrough = eventPassthrough;\r\n        this.reset();\r\n    }\r\n    DirectionLockAction.prototype.reset = function () {\r\n        this.directionLocked = \"\" /* Default */;\r\n    };\r\n    DirectionLockAction.prototype.checkMovingDirection = function (absDistX, absDistY, e) {\r\n        this.computeDirectionLock(absDistX, absDistY);\r\n        return this.handleEventPassthrough(e);\r\n    };\r\n    DirectionLockAction.prototype.adjustDelta = function (deltaX, deltaY) {\r\n        if (this.directionLocked === \"horizontal\" /* Horizontal */) {\r\n            deltaY = 0;\r\n        }\r\n        else if (this.directionLocked === \"vertical\" /* Vertical */) {\r\n            deltaX = 0;\r\n        }\r\n        return {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY\r\n        };\r\n    };\r\n    DirectionLockAction.prototype.computeDirectionLock = function (absDistX, absDistY) {\r\n        // If you are scrolling in one direction, lock it\r\n        if (this.directionLocked === \"\" /* Default */ && !this.freeScroll) {\r\n            if (absDistX > absDistY + this.directionLockThreshold) {\r\n                this.directionLocked = \"horizontal\" /* Horizontal */; // lock horizontally\r\n            }\r\n            else if (absDistY >= absDistX + this.directionLockThreshold) {\r\n                this.directionLocked = \"vertical\" /* Vertical */; // lock vertically\r\n            }\r\n            else {\r\n                this.directionLocked = \"none\" /* None */; // no lock\r\n            }\r\n        }\r\n    };\r\n    DirectionLockAction.prototype.handleEventPassthrough = function (e) {\r\n        var handleMap = DirectionMap[this.directionLocked];\r\n        if (handleMap) {\r\n            if (this.eventPassthrough === handleMap[\"yes\" /* Yes */]) {\r\n                return PassthroughHandlers[\"yes\" /* Yes */](e);\r\n            }\r\n            else if (this.eventPassthrough === handleMap[\"no\" /* No */]) {\r\n                return PassthroughHandlers[\"no\" /* No */](e);\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    return DirectionLockAction;\r\n}());\n\nvar applyQuadrantTransformation = function (deltaX, deltaY, quadrant) {\r\n    if (quadrant === 2 /* Second */) {\r\n        return [deltaY, -deltaX];\r\n    }\r\n    else if (quadrant === 3 /* Third */) {\r\n        return [-deltaX, -deltaY];\r\n    }\r\n    else if (quadrant === 4 /* Forth */) {\r\n        return [-deltaY, deltaX];\r\n    }\r\n    else {\r\n        return [deltaX, deltaY];\r\n    }\r\n};\r\nvar ScrollerActions = /** @class */ (function () {\r\n    function ScrollerActions(scrollBehaviorX, scrollBehaviorY, actionsHandler, animater, options) {\r\n        this.hooks = new EventEmitter([\r\n            'start',\r\n            'beforeMove',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'end',\r\n            'scrollEnd',\r\n            'contentNotMoved',\r\n            'detectMovingDirection',\r\n            'coordinateTransformation',\r\n        ]);\r\n        this.scrollBehaviorX = scrollBehaviorX;\r\n        this.scrollBehaviorY = scrollBehaviorY;\r\n        this.actionsHandler = actionsHandler;\r\n        this.animater = animater;\r\n        this.options = options;\r\n        this.directionLockAction = new DirectionLockAction(options.directionLockThreshold, options.freeScroll, options.eventPassthrough);\r\n        this.enabled = true;\r\n        this.bindActionsHandler();\r\n    }\r\n    ScrollerActions.prototype.bindActionsHandler = function () {\r\n        var _this = this;\r\n        // [mouse|touch]start event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleStart(e);\r\n        });\r\n        // [mouse|touch]move event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move, function (_a) {\r\n            var deltaX = _a.deltaX, deltaY = _a.deltaY, e = _a.e;\r\n            if (!_this.enabled)\r\n                return true;\r\n            var _b = applyQuadrantTransformation(deltaX, deltaY, _this.options.quadrant), transformateDeltaX = _b[0], transformateDeltaY = _b[1];\r\n            var transformateDeltaData = {\r\n                deltaX: transformateDeltaX,\r\n                deltaY: transformateDeltaY,\r\n            };\r\n            _this.hooks.trigger(_this.hooks.eventTypes.coordinateTransformation, transformateDeltaData);\r\n            return _this.handleMove(transformateDeltaData.deltaX, transformateDeltaData.deltaY, e);\r\n        });\r\n        // [mouse|touch]end event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleEnd(e);\r\n        });\r\n        // click\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click, function (e) {\r\n            // handle native click event\r\n            if (_this.enabled && !e._constructed) {\r\n                _this.handleClick(e);\r\n            }\r\n        });\r\n    };\r\n    ScrollerActions.prototype.handleStart = function (e) {\r\n        var timestamp = getNow();\r\n        this.fingerMoved = false;\r\n        this.contentMoved = false;\r\n        this.startTime = timestamp;\r\n        this.directionLockAction.reset();\r\n        this.scrollBehaviorX.start();\r\n        this.scrollBehaviorY.start();\r\n        // force stopping last transition or animation\r\n        this.animater.doStop();\r\n        this.scrollBehaviorX.resetStartPos();\r\n        this.scrollBehaviorY.resetStartPos();\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ScrollerActions.prototype.handleMove = function (deltaX, deltaY, e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeMove, e)) {\r\n            return;\r\n        }\r\n        var absDistX = this.scrollBehaviorX.getAbsDist(deltaX);\r\n        var absDistY = this.scrollBehaviorY.getAbsDist(deltaY);\r\n        var timestamp = getNow();\r\n        // We need to move at least momentumLimitDistance pixels\r\n        // for the scrolling to initiate\r\n        if (this.checkMomentum(absDistX, absDistY, timestamp)) {\r\n            return true;\r\n        }\r\n        if (this.directionLockAction.checkMovingDirection(absDistX, absDistY, e)) {\r\n            this.actionsHandler.setInitiated();\r\n            return true;\r\n        }\r\n        var delta = this.directionLockAction.adjustDelta(deltaX, deltaY);\r\n        var prevX = this.scrollBehaviorX.getCurrentPos();\r\n        var newX = this.scrollBehaviorX.move(delta.deltaX);\r\n        var prevY = this.scrollBehaviorY.getCurrentPos();\r\n        var newY = this.scrollBehaviorY.move(delta.deltaY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.detectMovingDirection)) {\r\n            return;\r\n        }\r\n        if (!this.fingerMoved) {\r\n            this.fingerMoved = true;\r\n        }\r\n        var positionChanged = newX !== prevX || newY !== prevY;\r\n        if (!this.contentMoved && !positionChanged) {\r\n            this.hooks.trigger(this.hooks.eventTypes.contentNotMoved);\r\n        }\r\n        if (!this.contentMoved && positionChanged) {\r\n            this.contentMoved = true;\r\n            this.hooks.trigger(this.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.contentMoved && positionChanged) {\r\n            this.animater.translate({\r\n                x: newX,\r\n                y: newY,\r\n            });\r\n            this.dispatchScroll(timestamp);\r\n        }\r\n    };\r\n    ScrollerActions.prototype.dispatchScroll = function (timestamp) {\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > this.options.momentumLimitTime) {\r\n            // refresh time and starting position to initiate a momentum\r\n            this.startTime = timestamp;\r\n            this.scrollBehaviorX.updateStartPos();\r\n            this.scrollBehaviorY.updateStartPos();\r\n            if (this.options.probeType === 1 /* Throttle */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (this.options.probeType > 1 /* Throttle */) {\r\n            this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n        }\r\n    };\r\n    ScrollerActions.prototype.checkMomentum = function (absDistX, absDistY, timestamp) {\r\n        return (timestamp - this.endTime > this.options.momentumLimitTime &&\r\n            absDistY < this.options.momentumLimitDistance &&\r\n            absDistX < this.options.momentumLimitDistance);\r\n    };\r\n    ScrollerActions.prototype.handleEnd = function (e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeEnd, e)) {\r\n            return;\r\n        }\r\n        var currentPos = this.getCurrentPos();\r\n        this.scrollBehaviorX.updateDirection();\r\n        this.scrollBehaviorY.updateDirection();\r\n        if (this.hooks.trigger(this.hooks.eventTypes.end, e, currentPos)) {\r\n            return true;\r\n        }\r\n        currentPos = this.ensureIntegerPos(currentPos);\r\n        this.animater.translate(currentPos);\r\n        this.endTime = getNow();\r\n        var duration = this.endTime - this.startTime;\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollEnd, currentPos, duration);\r\n    };\r\n    ScrollerActions.prototype.ensureIntegerPos = function (currentPos) {\r\n        this.ensuringInteger = true;\r\n        var x = currentPos.x, y = currentPos.y;\r\n        var _a = this.scrollBehaviorX, minScrollPosX = _a.minScrollPos, maxScrollPosX = _a.maxScrollPos;\r\n        var _b = this.scrollBehaviorY, minScrollPosY = _b.minScrollPos, maxScrollPosY = _b.maxScrollPos;\r\n        x = x > 0 ? Math.ceil(x) : Math.floor(x);\r\n        y = y > 0 ? Math.ceil(y) : Math.floor(y);\r\n        x = between(x, maxScrollPosX, minScrollPosX);\r\n        y = between(y, maxScrollPosY, minScrollPosY);\r\n        return { x: x, y: y };\r\n    };\r\n    ScrollerActions.prototype.handleClick = function (e) {\r\n        if (!preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ScrollerActions.prototype.getCurrentPos = function () {\r\n        return {\r\n            x: this.scrollBehaviorX.getCurrentPos(),\r\n            y: this.scrollBehaviorY.getCurrentPos(),\r\n        };\r\n    };\r\n    ScrollerActions.prototype.refresh = function () {\r\n        this.endTime = 0;\r\n    };\r\n    ScrollerActions.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return ScrollerActions;\r\n}());\n\nfunction createActionsHandlerOptions(bsOptions) {\r\n    var options = [\r\n        'click',\r\n        'bindToWrapper',\r\n        'disableMouse',\r\n        'disableTouch',\r\n        'preventDefault',\r\n        'stopPropagation',\r\n        'tagException',\r\n        'preventDefaultException',\r\n        'autoEndDistance',\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    return options;\r\n}\r\nfunction createBehaviorOptions(bsOptions, extraProp, bounces, rect) {\r\n    var options = [\r\n        'momentum',\r\n        'momentumLimitTime',\r\n        'momentumLimitDistance',\r\n        'deceleration',\r\n        'swipeBounceTime',\r\n        'swipeTime',\r\n        'outOfBoundaryDampingFactor',\r\n        'specifiedIndexAsContent',\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    // add extra property\r\n    options.scrollable = !!bsOptions[extraProp];\r\n    options.bounces = bounces;\r\n    options.rect = rect;\r\n    return options;\r\n}\n\nfunction bubbling(source, target, events) {\r\n    events.forEach(function (event) {\r\n        var sourceEvent;\r\n        var targetEvent;\r\n        if (typeof event === 'string') {\r\n            sourceEvent = targetEvent = event;\r\n        }\r\n        else {\r\n            sourceEvent = event.source;\r\n            targetEvent = event.target;\r\n        }\r\n        source.on(sourceEvent, function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return target.trigger.apply(target, __spreadArrays([targetEvent], args));\r\n        });\r\n    });\r\n}\n\nfunction isSamePoint(startPoint, endPoint) {\r\n    // keys of startPoint and endPoint should be equal\r\n    var keys = Object.keys(startPoint);\r\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n        var key = keys_1[_i];\r\n        if (startPoint[key] !== endPoint[key])\r\n            return false;\r\n    }\r\n    return true;\r\n}\n\nvar MIN_SCROLL_DISTANCE = 1;\r\nvar Scroller = /** @class */ (function () {\r\n    function Scroller(wrapper, content, options) {\r\n        this.wrapper = wrapper;\r\n        this.content = content;\r\n        this.resizeTimeout = 0;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'beforeMove',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'scrollEnd',\r\n            'resize',\r\n            'touchEnd',\r\n            'end',\r\n            'flick',\r\n            'scrollCancel',\r\n            'momentum',\r\n            'scrollTo',\r\n            'minDistanceScroll',\r\n            'scrollToElement',\r\n            'beforeRefresh',\r\n        ]);\r\n        this.options = options;\r\n        var _a = this.options.bounce, left = _a.left, right = _a.right, top = _a.top, bottom = _a.bottom;\r\n        // direction X\r\n        this.scrollBehaviorX = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollX', [left, right], {\r\n            size: 'width',\r\n            position: 'left',\r\n        }));\r\n        // direction Y\r\n        this.scrollBehaviorY = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollY', [top, bottom], {\r\n            size: 'height',\r\n            position: 'top',\r\n        }));\r\n        this.translater = new Translater(this.content);\r\n        this.animater = createAnimater(this.content, this.translater, this.options);\r\n        this.actionsHandler = new ActionsHandler(this.options.bindToTarget ? this.content : wrapper, createActionsHandlerOptions(this.options));\r\n        this.actions = new ScrollerActions(this.scrollBehaviorX, this.scrollBehaviorY, this.actionsHandler, this.animater, this.options);\r\n        var resizeHandler = this.resize.bind(this);\r\n        this.resizeRegister = new EventRegister(window, [\r\n            {\r\n                name: 'orientationchange',\r\n                handler: resizeHandler,\r\n            },\r\n            {\r\n                name: 'resize',\r\n                handler: resizeHandler,\r\n            },\r\n        ]);\r\n        this.registerTransitionEnd();\r\n        this.init();\r\n    }\r\n    Scroller.prototype.init = function () {\r\n        var _this = this;\r\n        this.bindTranslater();\r\n        this.bindAnimater();\r\n        this.bindActions();\r\n        // enable pointer events when scrolling ends\r\n        this.hooks.on(this.hooks.eventTypes.scrollEnd, function () {\r\n            _this.togglePointerEvents(true);\r\n        });\r\n    };\r\n    Scroller.prototype.registerTransitionEnd = function () {\r\n        this.transitionEndRegister = new EventRegister(this.content, [\r\n            {\r\n                name: style.transitionEnd,\r\n                handler: this.transitionEnd.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindTranslater = function () {\r\n        var _this = this;\r\n        var hooks = this.translater.hooks;\r\n        hooks.on(hooks.eventTypes.beforeTranslate, function (transformStyle) {\r\n            if (_this.options.translateZ) {\r\n                transformStyle.push(_this.options.translateZ);\r\n            }\r\n        });\r\n        // disable pointer events when scrolling\r\n        hooks.on(hooks.eventTypes.translate, function (pos) {\r\n            var prevPos = _this.getCurrentPos();\r\n            _this.updatePositions(pos);\r\n            // scrollEnd will dispatch when scroll is force stopping in touchstart handler\r\n            // so in touchend handler, don't toggle pointer-events\r\n            if (_this.actions.ensuringInteger === true) {\r\n                _this.actions.ensuringInteger = false;\r\n                return;\r\n            }\r\n            // a valid translate\r\n            if (pos.x !== prevPos.x || pos.y !== prevPos.y) {\r\n                _this.togglePointerEvents(false);\r\n            }\r\n        });\r\n    };\r\n    Scroller.prototype.bindAnimater = function () {\r\n        var _this = this;\r\n        // reset position\r\n        this.animater.hooks.on(this.animater.hooks.eventTypes.end, function (pos) {\r\n            if (!_this.resetPosition(_this.options.bounceTime)) {\r\n                _this.animater.setPending(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n        });\r\n        bubbling(this.animater.hooks, this.hooks, [\r\n            {\r\n                source: this.animater.hooks.eventTypes.move,\r\n                target: this.hooks.eventTypes.scroll,\r\n            },\r\n            {\r\n                source: this.animater.hooks.eventTypes.forceStop,\r\n                target: this.hooks.eventTypes.scrollEnd,\r\n            },\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindActions = function () {\r\n        var _this = this;\r\n        var actions = this.actions;\r\n        bubbling(actions.hooks, this.hooks, [\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeScrollStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeMove,\r\n                target: this.hooks.eventTypes.beforeMove,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scrollStart,\r\n                target: this.hooks.eventTypes.scrollStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scroll,\r\n                target: this.hooks.eventTypes.scroll,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeEnd,\r\n                target: this.hooks.eventTypes.beforeEnd,\r\n            },\r\n        ]);\r\n        actions.hooks.on(actions.hooks.eventTypes.end, function (e, pos) {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.touchEnd, pos);\r\n            if (_this.hooks.trigger(_this.hooks.eventTypes.end, pos)) {\r\n                return true;\r\n            }\r\n            // check if it is a click operation\r\n            if (!actions.fingerMoved) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollCancel);\r\n                if (_this.checkClick(e)) {\r\n                    return true;\r\n                }\r\n            }\r\n            // reset if we are outside of the boundaries\r\n            if (_this.resetPosition(_this.options.bounceTime, ease.bounce)) {\r\n                _this.animater.setForceStopped(false);\r\n                return true;\r\n            }\r\n        });\r\n        actions.hooks.on(actions.hooks.eventTypes.scrollEnd, function (pos, duration) {\r\n            var deltaX = Math.abs(pos.x - _this.scrollBehaviorX.startPos);\r\n            var deltaY = Math.abs(pos.y - _this.scrollBehaviorY.startPos);\r\n            if (_this.checkFlick(duration, deltaX, deltaY)) {\r\n                _this.animater.setForceStopped(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.flick);\r\n                return;\r\n            }\r\n            if (_this.momentum(pos, duration)) {\r\n                _this.animater.setForceStopped(false);\r\n                return;\r\n            }\r\n            if (actions.contentMoved) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n            if (_this.animater.forceStopped) {\r\n                _this.animater.setForceStopped(false);\r\n            }\r\n        });\r\n    };\r\n    Scroller.prototype.checkFlick = function (duration, deltaX, deltaY) {\r\n        var flickMinMovingDistance = 1; // distinguish flick from click\r\n        if (this.hooks.events.flick.length > 1 &&\r\n            duration < this.options.flickLimitTime &&\r\n            deltaX < this.options.flickLimitDistance &&\r\n            deltaY < this.options.flickLimitDistance &&\r\n            (deltaY > flickMinMovingDistance || deltaX > flickMinMovingDistance)) {\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.momentum = function (pos, duration) {\r\n        var meta = {\r\n            time: 0,\r\n            easing: ease.swiper,\r\n            newX: pos.x,\r\n            newY: pos.y,\r\n        };\r\n        // start momentum animation if needed\r\n        var momentumX = this.scrollBehaviorX.end(duration);\r\n        var momentumY = this.scrollBehaviorY.end(duration);\r\n        meta.newX = isUndef(momentumX.destination)\r\n            ? meta.newX\r\n            : momentumX.destination;\r\n        meta.newY = isUndef(momentumY.destination)\r\n            ? meta.newY\r\n            : momentumY.destination;\r\n        meta.time = Math.max(momentumX.duration, momentumY.duration);\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, meta, this);\r\n        // when x or y changed, do momentum animation now!\r\n        if (meta.newX !== pos.x || meta.newY !== pos.y) {\r\n            // change easing function when scroller goes out of the boundaries\r\n            if (meta.newX > this.scrollBehaviorX.minScrollPos ||\r\n                meta.newX < this.scrollBehaviorX.maxScrollPos ||\r\n                meta.newY > this.scrollBehaviorY.minScrollPos ||\r\n                meta.newY < this.scrollBehaviorY.maxScrollPos) {\r\n                meta.easing = ease.swipeBounce;\r\n            }\r\n            this.scrollTo(meta.newX, meta.newY, meta.time, meta.easing);\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.checkClick = function (e) {\r\n        var cancelable = {\r\n            preventClick: this.animater.forceStopped,\r\n        };\r\n        // we scrolled less than momentumLimitDistance pixels\r\n        if (this.hooks.trigger(this.hooks.eventTypes.checkClick)) {\r\n            this.animater.setForceStopped(false);\r\n            return true;\r\n        }\r\n        if (!cancelable.preventClick) {\r\n            var _dblclick = this.options.dblclick;\r\n            var dblclickTrigged = false;\r\n            if (_dblclick && this.lastClickTime) {\r\n                var _a = _dblclick.delay, delay = _a === void 0 ? 300 : _a;\r\n                if (getNow() - this.lastClickTime < delay) {\r\n                    dblclickTrigged = true;\r\n                    dblclick(e);\r\n                }\r\n            }\r\n            if (this.options.tap) {\r\n                tap(e, this.options.tap);\r\n            }\r\n            if (this.options.click &&\r\n                !preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n                click(e);\r\n            }\r\n            this.lastClickTime = dblclickTrigged ? null : getNow();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Scroller.prototype.resize = function () {\r\n        var _this = this;\r\n        if (!this.actions.enabled) {\r\n            return;\r\n        }\r\n        // fix a scroll problem under Android condition\r\n        /* istanbul ignore if  */\r\n        if (isAndroid) {\r\n            this.wrapper.scrollTop = 0;\r\n        }\r\n        clearTimeout(this.resizeTimeout);\r\n        this.resizeTimeout = window.setTimeout(function () {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.resize);\r\n        }, this.options.resizePolling);\r\n    };\r\n    /* istanbul ignore next */\r\n    Scroller.prototype.transitionEnd = function (e) {\r\n        if (e.target !== this.content || !this.animater.pending) {\r\n            return;\r\n        }\r\n        var animater = this.animater;\r\n        animater.transitionTime();\r\n        if (!this.resetPosition(this.options.bounceTime, ease.bounce)) {\r\n            this.animater.setPending(false);\r\n            if (this.options.probeType !== 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scrollEnd, this.getCurrentPos());\r\n            }\r\n        }\r\n    };\r\n    Scroller.prototype.togglePointerEvents = function (enabled) {\r\n        if (enabled === void 0) { enabled = true; }\r\n        var el = this.content.children.length\r\n            ? this.content.children\r\n            : [this.content];\r\n        var pointerEvents = enabled ? 'auto' : 'none';\r\n        for (var i = 0; i < el.length; i++) {\r\n            var node = el[i];\r\n            // ignore BetterScroll instance's wrapper DOM\r\n            /* istanbul ignore if  */\r\n            if (node.isBScrollContainer) {\r\n                continue;\r\n            }\r\n            node.style.pointerEvents = pointerEvents;\r\n        }\r\n    };\r\n    Scroller.prototype.refresh = function (content) {\r\n        var contentChanged = this.setContent(content);\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeRefresh);\r\n        this.scrollBehaviorX.refresh(content);\r\n        this.scrollBehaviorY.refresh(content);\r\n        if (contentChanged) {\r\n            this.translater.setContent(content);\r\n            this.animater.setContent(content);\r\n            this.transitionEndRegister.destroy();\r\n            this.registerTransitionEnd();\r\n            if (this.options.bindToTarget) {\r\n                this.actionsHandler.setContent(content);\r\n            }\r\n        }\r\n        this.actions.refresh();\r\n        this.wrapperOffset = offset(this.wrapper);\r\n    };\r\n    Scroller.prototype.setContent = function (content) {\r\n        var contentChanged = content !== this.content;\r\n        if (contentChanged) {\r\n            this.content = content;\r\n        }\r\n        return contentChanged;\r\n    };\r\n    Scroller.prototype.scrollBy = function (deltaX, deltaY, time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        var _a = this.getCurrentPos(), x = _a.x, y = _a.y;\r\n        easing = !easing ? ease.bounce : easing;\r\n        deltaX += x;\r\n        deltaY += y;\r\n        this.scrollTo(deltaX, deltaY, time, easing);\r\n    };\r\n    Scroller.prototype.scrollTo = function (x, y, time, easing, extraTransform) {\r\n        if (time === void 0) { time = 0; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        if (extraTransform === void 0) { extraTransform = {\r\n            start: {},\r\n            end: {},\r\n        }; }\r\n        var easingFn = this.options.useTransition ? easing.style : easing.fn;\r\n        var currentPos = this.getCurrentPos();\r\n        var startPoint = __assign({ x: currentPos.x, y: currentPos.y }, extraTransform.start);\r\n        var endPoint = __assign({ x: x,\r\n            y: y }, extraTransform.end);\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollTo, endPoint);\r\n        // it is an useless move\r\n        if (isSamePoint(startPoint, endPoint))\r\n            return;\r\n        var deltaX = Math.abs(endPoint.x - startPoint.x);\r\n        var deltaY = Math.abs(endPoint.y - startPoint.y);\r\n        // considering of browser compatibility for decimal transform value\r\n        // force translating immediately\r\n        if (deltaX < MIN_SCROLL_DISTANCE && deltaY < MIN_SCROLL_DISTANCE) {\r\n            time = 0;\r\n            this.hooks.trigger(this.hooks.eventTypes.minDistanceScroll);\r\n        }\r\n        this.animater.move(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Scroller.prototype.scrollToElement = function (el, time, offsetX, offsetY, easing) {\r\n        var targetEle = getElement(el);\r\n        var pos = offset(targetEle);\r\n        var getOffset = function (offset, size, wrapperSize) {\r\n            if (typeof offset === 'number') {\r\n                return offset;\r\n            }\r\n            // if offsetX/Y are true we center the element to the screen\r\n            return offset ? Math.round(size / 2 - wrapperSize / 2) : 0;\r\n        };\r\n        offsetX = getOffset(offsetX, targetEle.offsetWidth, this.wrapper.offsetWidth);\r\n        offsetY = getOffset(offsetY, targetEle.offsetHeight, this.wrapper.offsetHeight);\r\n        var getPos = function (pos, wrapperPos, offset, scrollBehavior) {\r\n            pos -= wrapperPos;\r\n            pos = scrollBehavior.adjustPosition(pos - offset);\r\n            return pos;\r\n        };\r\n        pos.left = getPos(pos.left, this.wrapperOffset.left, offsetX, this.scrollBehaviorX);\r\n        pos.top = getPos(pos.top, this.wrapperOffset.top, offsetY, this.scrollBehaviorY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.scrollToElement, targetEle, pos)) {\r\n            return;\r\n        }\r\n        this.scrollTo(pos.left, pos.top, time, easing);\r\n    };\r\n    Scroller.prototype.resetPosition = function (time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        var _a = this.scrollBehaviorX.checkInBoundary(), x = _a.position, xInBoundary = _a.inBoundary;\r\n        var _b = this.scrollBehaviorY.checkInBoundary(), y = _b.position, yInBoundary = _b.inBoundary;\r\n        if (xInBoundary && yInBoundary) {\r\n            return false;\r\n        }\r\n        /* istanbul ignore if  */\r\n        if (isIOSBadVersion) {\r\n            // fix ios 13.4 bouncing\r\n            // see it in issues 982\r\n            this.reflow();\r\n        }\r\n        // out of boundary\r\n        this.scrollTo(x, y, time, easing);\r\n        return true;\r\n    };\r\n    /* istanbul ignore next */\r\n    Scroller.prototype.reflow = function () {\r\n        this._reflow = this.content.offsetHeight;\r\n    };\r\n    Scroller.prototype.updatePositions = function (pos) {\r\n        this.scrollBehaviorX.updatePosition(pos.x);\r\n        this.scrollBehaviorY.updatePosition(pos.y);\r\n    };\r\n    Scroller.prototype.getCurrentPos = function () {\r\n        return this.actions.getCurrentPos();\r\n    };\r\n    Scroller.prototype.enable = function () {\r\n        this.actions.enabled = true;\r\n    };\r\n    Scroller.prototype.disable = function () {\r\n        cancelAnimationFrame(this.animater.timer);\r\n        this.actions.enabled = false;\r\n    };\r\n    Scroller.prototype.destroy = function () {\r\n        var _this = this;\r\n        var keys = [\r\n            'resizeRegister',\r\n            'transitionEndRegister',\r\n            'actionsHandler',\r\n            'actions',\r\n            'hooks',\r\n            'animater',\r\n            'translater',\r\n            'scrollBehaviorX',\r\n            'scrollBehaviorY',\r\n        ];\r\n        keys.forEach(function (key) { return _this[key].destroy(); });\r\n    };\r\n    return Scroller;\r\n}());\n\nvar BScrollConstructor = /** @class */ (function (_super) {\r\n    __extends(BScrollConstructor, _super);\r\n    function BScrollConstructor(el, options) {\r\n        var _this = _super.call(this, [\r\n            'refresh',\r\n            'contentChanged',\r\n            'enable',\r\n            'disable',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'scrollEnd',\r\n            'scrollCancel',\r\n            'touchEnd',\r\n            'flick',\r\n            'destroy'\r\n        ]) || this;\r\n        var wrapper = getElement(el);\r\n        if (!wrapper) {\r\n            warn('Can not resolve the wrapper DOM.');\r\n            return _this;\r\n        }\r\n        _this.plugins = {};\r\n        _this.options = new OptionsConstructor().merge(options).process();\r\n        if (!_this.setContent(wrapper).valid) {\r\n            return _this;\r\n        }\r\n        _this.hooks = new EventEmitter([\r\n            'refresh',\r\n            'enable',\r\n            'disable',\r\n            'destroy',\r\n            'beforeInitialScrollTo',\r\n            'contentChanged'\r\n        ]);\r\n        _this.init(wrapper);\r\n        return _this;\r\n    }\r\n    BScrollConstructor.use = function (ctor) {\r\n        var name = ctor.pluginName;\r\n        var installed = BScrollConstructor.plugins.some(function (plugin) { return ctor === plugin.ctor; });\r\n        if (installed)\r\n            return BScrollConstructor;\r\n        if (isUndef(name)) {\r\n            warn(\"Plugin Class must specify plugin's name in static property by 'pluginName' field.\");\r\n            return BScrollConstructor;\r\n        }\r\n        BScrollConstructor.pluginsMap[name] = true;\r\n        BScrollConstructor.plugins.push({\r\n            name: name,\r\n            applyOrder: ctor.applyOrder,\r\n            ctor: ctor\r\n        });\r\n        return BScrollConstructor;\r\n    };\r\n    BScrollConstructor.prototype.setContent = function (wrapper) {\r\n        var contentChanged = false;\r\n        var valid = true;\r\n        var content = wrapper.children[this.options.specifiedIndexAsContent];\r\n        if (!content) {\r\n            warn('The wrapper need at least one child element to be content element to scroll.');\r\n            valid = false;\r\n        }\r\n        else {\r\n            contentChanged = this.content !== content;\r\n            if (contentChanged) {\r\n                this.content = content;\r\n            }\r\n        }\r\n        return {\r\n            valid: valid,\r\n            contentChanged: contentChanged\r\n        };\r\n    };\r\n    BScrollConstructor.prototype.init = function (wrapper) {\r\n        var _this = this;\r\n        this.wrapper = wrapper;\r\n        // mark wrapper to recognize bs instance by DOM attribute\r\n        wrapper.isBScrollContainer = true;\r\n        this.scroller = new Scroller(wrapper, this.content, this.options);\r\n        this.scroller.hooks.on(this.scroller.hooks.eventTypes.resize, function () {\r\n            _this.refresh();\r\n        });\r\n        this.eventBubbling();\r\n        this.handleAutoBlur();\r\n        this.enable();\r\n        this.proxy(propertiesConfig);\r\n        this.applyPlugins();\r\n        // maybe boundary has changed, should refresh\r\n        this.refreshWithoutReset(this.content);\r\n        var _a = this.options, startX = _a.startX, startY = _a.startY;\r\n        var position = {\r\n            x: startX,\r\n            y: startY\r\n        };\r\n        // maybe plugins want to control scroll position\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeInitialScrollTo, position)) {\r\n            return;\r\n        }\r\n        this.scroller.scrollTo(position.x, position.y);\r\n    };\r\n    BScrollConstructor.prototype.applyPlugins = function () {\r\n        var _this = this;\r\n        var options = this.options;\r\n        BScrollConstructor.plugins\r\n            .sort(function (a, b) {\r\n            var _a;\r\n            var applyOrderMap = (_a = {},\r\n                _a[\"pre\" /* Pre */] = -1,\r\n                _a[\"post\" /* Post */] = 1,\r\n                _a);\r\n            var aOrder = a.applyOrder ? applyOrderMap[a.applyOrder] : 0;\r\n            var bOrder = b.applyOrder ? applyOrderMap[b.applyOrder] : 0;\r\n            return aOrder - bOrder;\r\n        })\r\n            .forEach(function (item) {\r\n            var ctor = item.ctor;\r\n            if (options[item.name] && typeof ctor === 'function') {\r\n                _this.plugins[item.name] = new ctor(_this);\r\n            }\r\n        });\r\n    };\r\n    BScrollConstructor.prototype.handleAutoBlur = function () {\r\n        /* istanbul ignore if  */\r\n        if (this.options.autoBlur) {\r\n            this.on(this.eventTypes.beforeScrollStart, function () {\r\n                var activeElement = document.activeElement;\r\n                if (activeElement &&\r\n                    (activeElement.tagName === 'INPUT' ||\r\n                        activeElement.tagName === 'TEXTAREA')) {\r\n                    activeElement.blur();\r\n                }\r\n            });\r\n        }\r\n    };\r\n    BScrollConstructor.prototype.eventBubbling = function () {\r\n        bubbling(this.scroller.hooks, this, [\r\n            this.eventTypes.beforeScrollStart,\r\n            this.eventTypes.scrollStart,\r\n            this.eventTypes.scroll,\r\n            this.eventTypes.scrollEnd,\r\n            this.eventTypes.scrollCancel,\r\n            this.eventTypes.touchEnd,\r\n            this.eventTypes.flick\r\n        ]);\r\n    };\r\n    BScrollConstructor.prototype.refreshWithoutReset = function (content) {\r\n        this.scroller.refresh(content);\r\n        this.hooks.trigger(this.hooks.eventTypes.refresh, content);\r\n        this.trigger(this.eventTypes.refresh, content);\r\n    };\r\n    BScrollConstructor.prototype.proxy = function (propertiesConfig) {\r\n        var _this = this;\r\n        propertiesConfig.forEach(function (_a) {\r\n            var key = _a.key, sourceKey = _a.sourceKey;\r\n            propertiesProxy(_this, sourceKey, key);\r\n        });\r\n    };\r\n    BScrollConstructor.prototype.refresh = function () {\r\n        var _a = this.setContent(this.wrapper), contentChanged = _a.contentChanged, valid = _a.valid;\r\n        if (valid) {\r\n            var content = this.content;\r\n            this.refreshWithoutReset(content);\r\n            if (contentChanged) {\r\n                this.hooks.trigger(this.hooks.eventTypes.contentChanged, content);\r\n                this.trigger(this.eventTypes.contentChanged, content);\r\n            }\r\n            this.scroller.resetPosition();\r\n        }\r\n    };\r\n    BScrollConstructor.prototype.enable = function () {\r\n        this.scroller.enable();\r\n        this.hooks.trigger(this.hooks.eventTypes.enable);\r\n        this.trigger(this.eventTypes.enable);\r\n    };\r\n    BScrollConstructor.prototype.disable = function () {\r\n        this.scroller.disable();\r\n        this.hooks.trigger(this.hooks.eventTypes.disable);\r\n        this.trigger(this.eventTypes.disable);\r\n    };\r\n    BScrollConstructor.prototype.destroy = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.destroy);\r\n        this.trigger(this.eventTypes.destroy);\r\n        this.scroller.destroy();\r\n    };\r\n    BScrollConstructor.prototype.eventRegister = function (names) {\r\n        this.registerType(names);\r\n    };\r\n    BScrollConstructor.plugins = [];\r\n    BScrollConstructor.pluginsMap = {};\r\n    return BScrollConstructor;\r\n}(EventEmitter));\r\nfunction createBScroll(el, options) {\r\n    var bs = new BScrollConstructor(el, options);\r\n    return bs;\r\n}\r\ncreateBScroll.use = BScrollConstructor.use;\r\ncreateBScroll.plugins = BScrollConstructor.plugins;\r\ncreateBScroll.pluginsMap = BScrollConstructor.pluginsMap;\r\nvar BScroll = createBScroll;\n\nexport default BScroll;\nexport { Behavior, CustomOptions, createBScroll };\n","/*!\n * better-scroll / mouse-wheel\n * (c) 2016-2021 ustbhuangyi\n * Released under the MIT License.\n */\nfunction warn(msg) {\r\n    console.error(\"[BScroll warn]: \" + msg);\r\n}\n\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\n!!(ua && /wechatdevtools/.test(ua));\r\nua && ua.indexOf('android') > 0;\r\n/* istanbul ignore next */\r\n((function () {\r\n    if (typeof ua === 'string') {\r\n        var regex = /os (\\d\\d?_\\d(_\\d)?)/;\r\n        var matches = regex.exec(ua);\r\n        if (!matches)\r\n            return false;\r\n        var parts = matches[1].split('_').map(function (item) {\r\n            return parseInt(item, 10);\r\n        });\r\n        // ios version >= 13.4 issue 982\r\n        return !!(parts[0] === 13 && parts[1] >= 4);\r\n    }\r\n    return false;\r\n}))();\r\n/* istanbul ignore next */\r\nvar supportsPassive = false;\r\n/* istanbul ignore next */\r\nif (inBrowser) {\r\n    var EventName = 'test-passive';\r\n    try {\r\n        var opts = {};\r\n        Object.defineProperty(opts, 'passive', {\r\n            get: function () {\r\n                supportsPassive = true;\r\n            },\r\n        }); // https://github.com/facebook/flow/issues/285\r\n        window.addEventListener(EventName, function () { }, opts);\r\n    }\r\n    catch (e) { }\r\n}\n\nvar extend = function (target, source) {\r\n    for (var key in source) {\r\n        target[key] = source[key];\r\n    }\r\n    return target;\r\n};\n\nvar elementStyle = (inBrowser &&\r\n    document.createElement('div').style);\r\nvar vendor = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return false;\r\n    }\r\n    var transformNames = [\r\n        {\r\n            key: 'standard',\r\n            value: 'transform',\r\n        },\r\n        {\r\n            key: 'webkit',\r\n            value: 'webkitTransform',\r\n        },\r\n        {\r\n            key: 'Moz',\r\n            value: 'MozTransform',\r\n        },\r\n        {\r\n            key: 'O',\r\n            value: 'OTransform',\r\n        },\r\n        {\r\n            key: 'ms',\r\n            value: 'msTransform',\r\n        },\r\n    ];\r\n    for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\r\n        var obj = transformNames_1[_i];\r\n        if (elementStyle[obj.value] !== undefined) {\r\n            return obj.key;\r\n        }\r\n    }\r\n    /* istanbul ignore next  */\r\n    return false;\r\n})();\r\n/* istanbul ignore next  */\r\nfunction prefixStyle(style) {\r\n    if (vendor === false) {\r\n        return style;\r\n    }\r\n    if (vendor === 'standard') {\r\n        if (style === 'transitionEnd') {\r\n            return 'transitionend';\r\n        }\r\n        return style;\r\n    }\r\n    return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nfunction addEvent(el, type, fn, capture) {\r\n    var useCapture = supportsPassive\r\n        ? {\r\n            passive: false,\r\n            capture: !!capture,\r\n        }\r\n        : !!capture;\r\n    el.addEventListener(type, fn, useCapture);\r\n}\r\nfunction removeEvent(el, type, fn, capture) {\r\n    el.removeEventListener(type, fn, {\r\n        capture: !!capture,\r\n    });\r\n}\r\nvendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\ninBrowser && prefixStyle('perspective') in elementStyle;\r\n({\r\n    transform: transform,\r\n    transition: transition,\r\n    transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n    transitionDuration: prefixStyle('transitionDuration'),\r\n    transitionDelay: prefixStyle('transitionDelay'),\r\n    transformOrigin: prefixStyle('transformOrigin'),\r\n    transitionEnd: prefixStyle('transitionEnd'),\r\n    transitionProperty: prefixStyle('transitionProperty'),\r\n});\r\nfunction preventDefaultExceptionFn(el, exceptions) {\r\n    for (var i in exceptions) {\r\n        if (exceptions[i].test(el[i])) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\n\nvar EventRegister = /** @class */ (function () {\r\n    function EventRegister(wrapper, events) {\r\n        this.wrapper = wrapper;\r\n        this.events = events;\r\n        this.addDOMEvents();\r\n    }\r\n    EventRegister.prototype.destroy = function () {\r\n        this.removeDOMEvents();\r\n        this.events = [];\r\n    };\r\n    EventRegister.prototype.addDOMEvents = function () {\r\n        this.handleDOMEvents(addEvent);\r\n    };\r\n    EventRegister.prototype.removeDOMEvents = function () {\r\n        this.handleDOMEvents(removeEvent);\r\n    };\r\n    EventRegister.prototype.handleDOMEvents = function (eventOperation) {\r\n        var _this = this;\r\n        var wrapper = this.wrapper;\r\n        this.events.forEach(function (event) {\r\n            eventOperation(wrapper, event.name, _this, !!event.capture);\r\n        });\r\n    };\r\n    EventRegister.prototype.handleEvent = function (e) {\r\n        var eventType = e.type;\r\n        this.events.some(function (event) {\r\n            if (event.name === eventType) {\r\n                event.handler(e);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    };\r\n    return EventRegister;\r\n}());\n\nvar MouseWheel = /** @class */ (function () {\r\n    function MouseWheel(scroll) {\r\n        this.scroll = scroll;\r\n        this.wheelEndTimer = 0;\r\n        this.wheelMoveTimer = 0;\r\n        this.wheelStart = false;\r\n        this.init();\r\n    }\r\n    MouseWheel.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n        this.registerEvent();\r\n    };\r\n    MouseWheel.prototype.handleBScroll = function () {\r\n        this.scroll.registerType([\r\n            'alterOptions',\r\n            'mousewheelStart',\r\n            'mousewheelMove',\r\n            'mousewheelEnd',\r\n        ]);\r\n    };\r\n    MouseWheel.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.mouseWheel === true\r\n            ? {}\r\n            : this.scroll.options.mouseWheel);\r\n        var defaultOptions = {\r\n            speed: 20,\r\n            invert: false,\r\n            easeTime: 300,\r\n            discreteTime: 400,\r\n            throttleTime: 0,\r\n            dampingFactor: 0.1,\r\n        };\r\n        this.mouseWheelOpt = extend(defaultOptions, userOptions);\r\n    };\r\n    MouseWheel.prototype.handleHooks = function () {\r\n        this.hooksFn = [];\r\n        this.registerHooks(this.scroll.hooks, 'destroy', this.destroy);\r\n    };\r\n    MouseWheel.prototype.registerEvent = function () {\r\n        this.eventRegister = new EventRegister(this.scroll.scroller.wrapper, [\r\n            {\r\n                name: 'wheel',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n            {\r\n                name: 'mousewheel',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n            {\r\n                name: 'DOMMouseScroll',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    MouseWheel.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    MouseWheel.prototype.wheelHandler = function (e) {\r\n        if (!this.scroll.enabled) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e);\r\n        // start\r\n        if (!this.wheelStart) {\r\n            this.wheelStartHandler(e);\r\n            this.wheelStart = true;\r\n        }\r\n        // move\r\n        var delta = this.getWheelDelta(e);\r\n        this.wheelMoveHandler(delta);\r\n        // end\r\n        this.wheelEndDetector(delta);\r\n    };\r\n    MouseWheel.prototype.wheelStartHandler = function (e) {\r\n        this.cleanCache();\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        scrollBehaviorX.setMovingDirection(0 /* Default */);\r\n        scrollBehaviorY.setMovingDirection(0 /* Default */);\r\n        scrollBehaviorX.setDirection(0 /* Default */);\r\n        scrollBehaviorY.setDirection(0 /* Default */);\r\n        this.scroll.trigger(this.scroll.eventTypes.alterOptions, this.mouseWheelOpt);\r\n        this.scroll.trigger(this.scroll.eventTypes.mousewheelStart);\r\n    };\r\n    MouseWheel.prototype.cleanCache = function () {\r\n        this.deltaCache = [];\r\n    };\r\n    MouseWheel.prototype.wheelMoveHandler = function (delta) {\r\n        var _this = this;\r\n        var _a = this.mouseWheelOpt, throttleTime = _a.throttleTime, dampingFactor = _a.dampingFactor;\r\n        if (throttleTime && this.wheelMoveTimer) {\r\n            this.deltaCache.push(delta);\r\n        }\r\n        else {\r\n            var cachedDelta = this.deltaCache.reduce(function (prev, current) {\r\n                return {\r\n                    x: prev.x + current.x,\r\n                    y: prev.y + current.y,\r\n                };\r\n            }, { x: 0, y: 0 });\r\n            this.cleanCache();\r\n            var _b = this.scroll.scroller, scrollBehaviorX = _b.scrollBehaviorX, scrollBehaviorY = _b.scrollBehaviorY;\r\n            scrollBehaviorX.setMovingDirection(-delta.directionX);\r\n            scrollBehaviorY.setMovingDirection(-delta.directionY);\r\n            scrollBehaviorX.setDirection(delta.x);\r\n            scrollBehaviorY.setDirection(delta.y);\r\n            // when out of boundary, perform a damping scroll\r\n            var newX = scrollBehaviorX.performDampingAlgorithm(Math.round(delta.x) + cachedDelta.x, dampingFactor);\r\n            var newY = scrollBehaviorY.performDampingAlgorithm(Math.round(delta.y) + cachedDelta.x, dampingFactor);\r\n            if (!this.scroll.trigger(this.scroll.eventTypes.mousewheelMove, {\r\n                x: newX,\r\n                y: newY,\r\n            })) {\r\n                var easeTime = this.getEaseTime();\r\n                if (newX !== this.scroll.x || newY !== this.scroll.y) {\r\n                    this.scroll.scrollTo(newX, newY, easeTime);\r\n                }\r\n            }\r\n            if (throttleTime) {\r\n                this.wheelMoveTimer = window.setTimeout(function () {\r\n                    _this.wheelMoveTimer = 0;\r\n                }, throttleTime);\r\n            }\r\n        }\r\n    };\r\n    MouseWheel.prototype.wheelEndDetector = function (delta) {\r\n        var _this = this;\r\n        window.clearTimeout(this.wheelEndTimer);\r\n        this.wheelEndTimer = window.setTimeout(function () {\r\n            _this.wheelStart = false;\r\n            window.clearTimeout(_this.wheelMoveTimer);\r\n            _this.wheelMoveTimer = 0;\r\n            _this.scroll.trigger(_this.scroll.eventTypes.mousewheelEnd, delta);\r\n        }, this.mouseWheelOpt.discreteTime);\r\n    };\r\n    MouseWheel.prototype.getWheelDelta = function (e) {\r\n        var _a = this.mouseWheelOpt, speed = _a.speed, invert = _a.invert;\r\n        var wheelDeltaX = 0;\r\n        var wheelDeltaY = 0;\r\n        var direction = invert ? -1 /* Negative */ : 1 /* Positive */;\r\n        switch (true) {\r\n            case 'deltaX' in e:\r\n                if (e.deltaMode === 1) {\r\n                    wheelDeltaX = -e.deltaX * speed;\r\n                    wheelDeltaY = -e.deltaY * speed;\r\n                }\r\n                else {\r\n                    wheelDeltaX = -e.deltaX;\r\n                    wheelDeltaY = -e.deltaY;\r\n                }\r\n                break;\r\n            case 'wheelDeltaX' in e:\r\n                wheelDeltaX = (e.wheelDeltaX / 120) * speed;\r\n                wheelDeltaY = (e.wheelDeltaY / 120) * speed;\r\n                break;\r\n            case 'wheelDelta' in e:\r\n                wheelDeltaX = wheelDeltaY = (e.wheelDelta / 120) * speed;\r\n                break;\r\n            case 'detail' in e:\r\n                wheelDeltaX = wheelDeltaY = (-e.detail / 3) * speed;\r\n                break;\r\n        }\r\n        wheelDeltaX *= direction;\r\n        wheelDeltaY *= direction;\r\n        if (!this.scroll.hasVerticalScroll) {\r\n            if (Math.abs(wheelDeltaY) > Math.abs(wheelDeltaX)) {\r\n                wheelDeltaX = wheelDeltaY;\r\n            }\r\n            wheelDeltaY = 0;\r\n        }\r\n        if (!this.scroll.hasHorizontalScroll) {\r\n            wheelDeltaX = 0;\r\n        }\r\n        var directionX = wheelDeltaX > 0\r\n            ? -1 /* Negative */\r\n            : wheelDeltaX < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        var directionY = wheelDeltaY > 0\r\n            ? -1 /* Negative */\r\n            : wheelDeltaY < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        return {\r\n            x: wheelDeltaX,\r\n            y: wheelDeltaY,\r\n            directionX: directionX,\r\n            directionY: directionY,\r\n        };\r\n    };\r\n    MouseWheel.prototype.beforeHandler = function (e) {\r\n        var _a = this.scroll.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        if (preventDefault &&\r\n            !preventDefaultExceptionFn(e.target, preventDefaultException)) {\r\n            e.preventDefault();\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    MouseWheel.prototype.getEaseTime = function () {\r\n        var SAFE_EASETIME = 100;\r\n        var easeTime = this.mouseWheelOpt.easeTime;\r\n        // scrollEnd event will be triggered in every calling of scrollTo when easeTime is too small\r\n        // easeTime needs to be greater than 100\r\n        if (easeTime < SAFE_EASETIME) {\r\n            warn(\"easeTime should be greater than 100.\" +\r\n                \"If mouseWheel easeTime is too small,\" +\r\n                \"scrollEnd will be triggered many times.\");\r\n        }\r\n        return Math.max(easeTime, SAFE_EASETIME);\r\n    };\r\n    MouseWheel.prototype.destroy = function () {\r\n        this.eventRegister.destroy();\r\n        window.clearTimeout(this.wheelEndTimer);\r\n        window.clearTimeout(this.wheelMoveTimer);\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n    };\r\n    MouseWheel.pluginName = 'mouseWheel';\r\n    MouseWheel.applyOrder = \"pre\" /* Pre */;\r\n    return MouseWheel;\r\n}());\n\nexport default MouseWheel;\n","/*!\n * better-scroll / scroll-bar\n * (c) 2016-2021 ustbhuangyi\n * Released under the MIT License.\n */\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\nfunction warn(msg) {\r\n    console.error(\"[BScroll warn]: \" + msg);\r\n}\n\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\n!!(ua && /wechatdevtools/.test(ua));\r\nua && ua.indexOf('android') > 0;\r\n/* istanbul ignore next */\r\n((function () {\r\n    if (typeof ua === 'string') {\r\n        var regex = /os (\\d\\d?_\\d(_\\d)?)/;\r\n        var matches = regex.exec(ua);\r\n        if (!matches)\r\n            return false;\r\n        var parts = matches[1].split('_').map(function (item) {\r\n            return parseInt(item, 10);\r\n        });\r\n        // ios version >= 13.4 issue 982\r\n        return !!(parts[0] === 13 && parts[1] >= 4);\r\n    }\r\n    return false;\r\n}))();\r\n/* istanbul ignore next */\r\nvar supportsPassive = false;\r\n/* istanbul ignore next */\r\nif (inBrowser) {\r\n    var EventName = 'test-passive';\r\n    try {\r\n        var opts = {};\r\n        Object.defineProperty(opts, 'passive', {\r\n            get: function () {\r\n                supportsPassive = true;\r\n            },\r\n        }); // https://github.com/facebook/flow/issues/285\r\n        window.addEventListener(EventName, function () { }, opts);\r\n    }\r\n    catch (e) { }\r\n}\n\nfunction getNow() {\r\n    return window.performance &&\r\n        window.performance.now &&\r\n        window.performance.timing\r\n        ? window.performance.now() + window.performance.timing.navigationStart\r\n        : +new Date();\r\n}\r\nvar extend = function (target, source) {\r\n    for (var key in source) {\r\n        target[key] = source[key];\r\n    }\r\n    return target;\r\n};\r\nfunction between(x, min, max) {\r\n    if (x < min) {\r\n        return min;\r\n    }\r\n    if (x > max) {\r\n        return max;\r\n    }\r\n    return x;\r\n}\n\nvar elementStyle = (inBrowser &&\r\n    document.createElement('div').style);\r\nvar vendor = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return false;\r\n    }\r\n    var transformNames = [\r\n        {\r\n            key: 'standard',\r\n            value: 'transform',\r\n        },\r\n        {\r\n            key: 'webkit',\r\n            value: 'webkitTransform',\r\n        },\r\n        {\r\n            key: 'Moz',\r\n            value: 'MozTransform',\r\n        },\r\n        {\r\n            key: 'O',\r\n            value: 'OTransform',\r\n        },\r\n        {\r\n            key: 'ms',\r\n            value: 'msTransform',\r\n        },\r\n    ];\r\n    for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\r\n        var obj = transformNames_1[_i];\r\n        if (elementStyle[obj.value] !== undefined) {\r\n            return obj.key;\r\n        }\r\n    }\r\n    /* istanbul ignore next  */\r\n    return false;\r\n})();\r\n/* istanbul ignore next  */\r\nfunction prefixStyle(style) {\r\n    if (vendor === false) {\r\n        return style;\r\n    }\r\n    if (vendor === 'standard') {\r\n        if (style === 'transitionEnd') {\r\n            return 'transitionend';\r\n        }\r\n        return style;\r\n    }\r\n    return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nfunction addEvent(el, type, fn, capture) {\r\n    var useCapture = supportsPassive\r\n        ? {\r\n            passive: false,\r\n            capture: !!capture,\r\n        }\r\n        : !!capture;\r\n    el.addEventListener(type, fn, useCapture);\r\n}\r\nfunction removeEvent(el, type, fn, capture) {\r\n    el.removeEventListener(type, fn, {\r\n        capture: !!capture,\r\n    });\r\n}\r\nvendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\ninBrowser && prefixStyle('perspective') in elementStyle;\r\nvar style = {\r\n    transform: transform,\r\n    transition: transition,\r\n    transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n    transitionDuration: prefixStyle('transitionDuration'),\r\n    transitionDelay: prefixStyle('transitionDelay'),\r\n    transformOrigin: prefixStyle('transformOrigin'),\r\n    transitionEnd: prefixStyle('transitionEnd'),\r\n    transitionProperty: prefixStyle('transitionProperty'),\r\n};\n\nvar EventEmitter = /** @class */ (function () {\r\n    function EventEmitter(names) {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n        this.registerType(names);\r\n    }\r\n    EventEmitter.prototype.on = function (type, fn, context) {\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        if (!this.events[type]) {\r\n            this.events[type] = [];\r\n        }\r\n        this.events[type].push([fn, context]);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.once = function (type, fn, context) {\r\n        var _this = this;\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        var magic = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            _this.off(type, magic);\r\n            var ret = fn.apply(context, args);\r\n            if (ret === true) {\r\n                return ret;\r\n            }\r\n        };\r\n        magic.fn = fn;\r\n        this.on(type, magic);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.off = function (type, fn) {\r\n        if (!type && !fn) {\r\n            this.events = {};\r\n            return this;\r\n        }\r\n        if (type) {\r\n            this.hasType(type);\r\n            if (!fn) {\r\n                this.events[type] = [];\r\n                return this;\r\n            }\r\n            var events = this.events[type];\r\n            if (!events) {\r\n                return this;\r\n            }\r\n            var count = events.length;\r\n            while (count--) {\r\n                if (events[count][0] === fn ||\r\n                    (events[count][0] && events[count][0].fn === fn)) {\r\n                    events.splice(count, 1);\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    EventEmitter.prototype.trigger = function (type) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        this.hasType(type);\r\n        var events = this.events[type];\r\n        if (!events) {\r\n            return;\r\n        }\r\n        var len = events.length;\r\n        var eventsCopy = __spreadArrays(events);\r\n        var ret;\r\n        for (var i = 0; i < len; i++) {\r\n            var event_1 = eventsCopy[i];\r\n            var fn = event_1[0], context = event_1[1];\r\n            if (fn) {\r\n                ret = fn.apply(context, args);\r\n                if (ret === true) {\r\n                    return ret;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    EventEmitter.prototype.registerType = function (names) {\r\n        var _this = this;\r\n        names.forEach(function (type) {\r\n            _this.eventTypes[type] = type;\r\n        });\r\n    };\r\n    EventEmitter.prototype.destroy = function () {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n    };\r\n    EventEmitter.prototype.hasType = function (type) {\r\n        var types = this.eventTypes;\r\n        var isType = types[type] === type;\r\n        if (!isType) {\r\n            warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" +\r\n                (\"\" + Object.keys(types).map(function (_) { return JSON.stringify(_); })) +\r\n                \"]\");\r\n        }\r\n    };\r\n    return EventEmitter;\r\n}());\r\nvar EventRegister = /** @class */ (function () {\r\n    function EventRegister(wrapper, events) {\r\n        this.wrapper = wrapper;\r\n        this.events = events;\r\n        this.addDOMEvents();\r\n    }\r\n    EventRegister.prototype.destroy = function () {\r\n        this.removeDOMEvents();\r\n        this.events = [];\r\n    };\r\n    EventRegister.prototype.addDOMEvents = function () {\r\n        this.handleDOMEvents(addEvent);\r\n    };\r\n    EventRegister.prototype.removeDOMEvents = function () {\r\n        this.handleDOMEvents(removeEvent);\r\n    };\r\n    EventRegister.prototype.handleDOMEvents = function (eventOperation) {\r\n        var _this = this;\r\n        var wrapper = this.wrapper;\r\n        this.events.forEach(function (event) {\r\n            eventOperation(wrapper, event.name, _this, !!event.capture);\r\n        });\r\n    };\r\n    EventRegister.prototype.handleEvent = function (e) {\r\n        var eventType = e.type;\r\n        this.events.some(function (event) {\r\n            if (event.name === eventType) {\r\n                event.handler(e);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    };\r\n    return EventRegister;\r\n}());\n\nvar EventHandler = /** @class */ (function () {\r\n    function EventHandler(indicator, options) {\r\n        this.indicator = indicator;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter(['touchStart', 'touchMove', 'touchEnd']);\r\n        this.registerEvents();\r\n    }\r\n    EventHandler.prototype.registerEvents = function () {\r\n        var _a = this.options, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch;\r\n        var startEvents = [];\r\n        var moveEvents = [];\r\n        var endEvents = [];\r\n        if (!disableMouse) {\r\n            startEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (!disableTouch) {\r\n            startEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.startEventRegister = new EventRegister(this.indicator.indicatorEl, startEvents);\r\n        this.moveEventRegister = new EventRegister(window, moveEvents);\r\n        this.endEventRegister = new EventRegister(window, endEvents);\r\n    };\r\n    EventHandler.prototype.BScrollIsDisabled = function () {\r\n        return !this.indicator.scroll.enabled;\r\n    };\r\n    EventHandler.prototype.start = function (e) {\r\n        if (this.BScrollIsDisabled()) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.initiated = true;\r\n        this.lastPoint = point[this.indicator.keysMap.point];\r\n        this.hooks.trigger(this.hooks.eventTypes.touchStart);\r\n    };\r\n    EventHandler.prototype.move = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var pointPos = point[this.indicator.keysMap.point];\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        var delta = pointPos - this.lastPoint;\r\n        this.lastPoint = pointPos;\r\n        this.hooks.trigger(this.hooks.eventTypes.touchMove, delta);\r\n    };\r\n    EventHandler.prototype.end = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        this.initiated = false;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.hooks.trigger(this.hooks.eventTypes.touchEnd);\r\n    };\r\n    EventHandler.prototype.destroy = function () {\r\n        this.startEventRegister.destroy();\r\n        this.moveEventRegister.destroy();\r\n        this.endEventRegister.destroy();\r\n    };\r\n    return EventHandler;\r\n}());\n\nvar Indicator = /** @class */ (function () {\r\n    function Indicator(scroll, options) {\r\n        this.scroll = scroll;\r\n        this.options = options;\r\n        this.hooksFn = [];\r\n        this.wrapper = options.wrapper;\r\n        this.direction = options.direction;\r\n        this.indicatorEl = this.wrapper.children[0];\r\n        this.keysMap = this.getKeysMap();\r\n        this.handleFade();\r\n        this.handleHooks();\r\n    }\r\n    Indicator.prototype.handleFade = function () {\r\n        if (this.options.fade) {\r\n            this.wrapper.style.opacity = '0';\r\n        }\r\n    };\r\n    Indicator.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var _a = this.options, fade = _a.fade, interactive = _a.interactive, scrollbarTrackClickable = _a.scrollbarTrackClickable;\r\n        var scroll = this.scroll;\r\n        var scrollHooks = scroll.hooks;\r\n        var translaterHooks = scroll.scroller.translater.hooks;\r\n        var animaterHooks = scroll.scroller.animater.hooks;\r\n        this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refresh);\r\n        this.registerHooks(translaterHooks, translaterHooks.eventTypes.translate, function (pos) {\r\n            var hasScrollKey = _this.keysMap.hasScroll;\r\n            if (_this.scroll[hasScrollKey]) {\r\n                _this.updatePosition(pos);\r\n            }\r\n        });\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.time, this.transitionTime);\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.timeFunction, this.transitionTimingFunction);\r\n        if (fade) {\r\n            this.registerHooks(scroll, scroll.eventTypes.scrollEnd, function () {\r\n                _this.fade();\r\n            });\r\n            this.registerHooks(scroll, scroll.eventTypes.scrollStart, function () {\r\n                _this.fade(true);\r\n            });\r\n            // for mousewheel event\r\n            if (scroll.eventTypes.mousewheelStart &&\r\n                scroll.eventTypes.mousewheelEnd) {\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelStart, function () {\r\n                    _this.fade(true);\r\n                });\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelMove, function () {\r\n                    _this.fade(true);\r\n                });\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelEnd, function () {\r\n                    _this.fade();\r\n                });\r\n            }\r\n        }\r\n        if (interactive) {\r\n            var _b = this.scroll.options, disableMouse = _b.disableMouse, disableTouch = _b.disableTouch;\r\n            this.eventHandler = new EventHandler(this, {\r\n                disableMouse: disableMouse,\r\n                disableTouch: disableTouch,\r\n            });\r\n            var eventHandlerHooks = this.eventHandler.hooks;\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchStart, this.startHandler);\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchMove, this.moveHandler);\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchEnd, this.endHandler);\r\n        }\r\n        if (scrollbarTrackClickable) {\r\n            this.bindClick();\r\n        }\r\n    };\r\n    Indicator.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Indicator.prototype.bindClick = function () {\r\n        var wrapper = this.wrapper;\r\n        this.clickEventRegister = new EventRegister(wrapper, [\r\n            {\r\n                name: 'click',\r\n                handler: this.handleClick.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    Indicator.prototype.handleClick = function (e) {\r\n        var newPos = this.calculateclickOffsetPos(e);\r\n        var _a = this.scroll, x = _a.x, y = _a.y;\r\n        x = this.direction === \"horizontal\" /* Horizontal */ ? newPos : x;\r\n        y = this.direction === \"vertical\" /* Vertical */ ? newPos : y;\r\n        this.scroll.scrollTo(x, y, this.options.scrollbarTrackOffsetTime);\r\n    };\r\n    Indicator.prototype.calculateclickOffsetPos = function (e) {\r\n        var _a = this.keysMap, poinKey = _a.point, domRectKey = _a.domRect;\r\n        var scrollbarTrackOffsetType = this.options.scrollbarTrackOffsetType;\r\n        var clickPointOffset = e[poinKey] - this.wrapperRect[domRectKey];\r\n        var scrollToWhere = clickPointOffset < this.currentPos ? -1 /* Up */ : 1 /* Down */;\r\n        var delta = 0;\r\n        var currentPos = this.currentPos;\r\n        if (scrollbarTrackOffsetType === \"step\" /* Step */) {\r\n            delta = this.scrollInfo.baseSize * scrollToWhere;\r\n        }\r\n        else {\r\n            delta = 0;\r\n            currentPos = clickPointOffset;\r\n        }\r\n        return this.newPos(currentPos, delta, this.scrollInfo);\r\n    };\r\n    Indicator.prototype.getKeysMap = function () {\r\n        if (this.direction === \"vertical\" /* Vertical */) {\r\n            return {\r\n                hasScroll: 'hasVerticalScroll',\r\n                size: 'height',\r\n                wrapperSize: 'clientHeight',\r\n                scrollerSize: 'scrollerHeight',\r\n                maxScrollPos: 'maxScrollY',\r\n                pos: 'y',\r\n                point: 'pageY',\r\n                translateProperty: 'translateY',\r\n                domRect: 'top',\r\n            };\r\n        }\r\n        return {\r\n            hasScroll: 'hasHorizontalScroll',\r\n            size: 'width',\r\n            wrapperSize: 'clientWidth',\r\n            scrollerSize: 'scrollerWidth',\r\n            maxScrollPos: 'maxScrollX',\r\n            pos: 'x',\r\n            point: 'pageX',\r\n            translateProperty: 'translateX',\r\n            domRect: 'left',\r\n        };\r\n    };\r\n    Indicator.prototype.fade = function (visible) {\r\n        var _a = this.options, fadeInTime = _a.fadeInTime, fadeOutTime = _a.fadeOutTime;\r\n        var time = visible ? fadeInTime : fadeOutTime;\r\n        var wrapper = this.wrapper;\r\n        wrapper.style[style.transitionDuration] = time + 'ms';\r\n        wrapper.style.opacity = visible ? '1' : '0';\r\n    };\r\n    Indicator.prototype.refresh = function () {\r\n        var hasScrollKey = this.keysMap.hasScroll;\r\n        var scroll = this.scroll;\r\n        var x = scroll.x, y = scroll.y;\r\n        this.wrapperRect = this.wrapper.getBoundingClientRect();\r\n        if (this.canScroll(scroll[hasScrollKey])) {\r\n            var _a = this.keysMap, wrapperSizeKey = _a.wrapperSize, scrollerSizeKey = _a.scrollerSize, maxScrollPosKey = _a.maxScrollPos;\r\n            this.scrollInfo = this.refreshScrollInfo(this.wrapper[wrapperSizeKey], scroll[scrollerSizeKey], scroll[maxScrollPosKey], this.indicatorEl[wrapperSizeKey]);\r\n            this.updatePosition({\r\n                x: x,\r\n                y: y,\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.indicatorEl.style[style.transitionDuration] = time + 'ms';\r\n    };\r\n    Indicator.prototype.transitionTimingFunction = function (easing) {\r\n        this.indicatorEl.style[style.transitionTimingFunction] = easing;\r\n    };\r\n    Indicator.prototype.canScroll = function (hasScroll) {\r\n        this.wrapper.style.display = hasScroll ? 'block' : 'none';\r\n        return hasScroll;\r\n    };\r\n    Indicator.prototype.refreshScrollInfo = function (wrapperSize, scrollerSize, maxScrollPos, indicatorElSize) {\r\n        var baseSize = Math.max(Math.round((wrapperSize * wrapperSize) / (scrollerSize || wrapperSize || 1)), this.options.minSize);\r\n        if (this.options.isCustom) {\r\n            baseSize = indicatorElSize;\r\n        }\r\n        var maxIndicatorScrollPos = wrapperSize - baseSize;\r\n        // sizeRatio is negative\r\n        var sizeRatio = maxIndicatorScrollPos / maxScrollPos;\r\n        return {\r\n            baseSize: baseSize,\r\n            maxScrollPos: maxIndicatorScrollPos,\r\n            minScrollPos: 0,\r\n            sizeRatio: sizeRatio,\r\n        };\r\n    };\r\n    Indicator.prototype.updatePosition = function (point) {\r\n        var _a = this.caculatePosAndSize(point, this.scrollInfo), pos = _a.pos, size = _a.size;\r\n        this.refreshStyle(size, pos);\r\n        this.currentPos = pos;\r\n    };\r\n    Indicator.prototype.caculatePosAndSize = function (point, scrollInfo) {\r\n        var posKey = this.keysMap.pos;\r\n        var sizeRatio = scrollInfo.sizeRatio, baseSize = scrollInfo.baseSize, maxScrollPos = scrollInfo.maxScrollPos, minScrollPos = scrollInfo.minScrollPos;\r\n        var minSize = this.options.minSize;\r\n        var pos = Math.round(sizeRatio * point[posKey]);\r\n        var size;\r\n        // when out of boundary, slow down size reduction\r\n        if (pos < minScrollPos) {\r\n            size = Math.max(baseSize + pos * 3, minSize);\r\n            pos = minScrollPos;\r\n        }\r\n        else if (pos > maxScrollPos) {\r\n            size = Math.max(baseSize - (pos - maxScrollPos) * 3, minSize);\r\n            pos = maxScrollPos + baseSize - size;\r\n        }\r\n        else {\r\n            size = baseSize;\r\n        }\r\n        return {\r\n            pos: pos,\r\n            size: size,\r\n        };\r\n    };\r\n    Indicator.prototype.refreshStyle = function (size, pos) {\r\n        var _a = this.keysMap, translatePropertyKey = _a.translateProperty, sizeKey = _a.size;\r\n        var translateZ = this.scroll.options.translateZ;\r\n        this.indicatorEl.style[sizeKey] = size + \"px\";\r\n        this.indicatorEl.style[style.transform] = translatePropertyKey + \"(\" + pos + \"px)\" + translateZ;\r\n    };\r\n    Indicator.prototype.startHandler = function () {\r\n        this.moved = false;\r\n        this.startTime = getNow();\r\n        this.transitionTime();\r\n        this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.beforeScrollStart);\r\n    };\r\n    Indicator.prototype.moveHandler = function (delta) {\r\n        if (!this.moved && !this.indicatorNotMoved(delta)) {\r\n            this.moved = true;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.moved) {\r\n            var newPos = this.newPos(this.currentPos, delta, this.scrollInfo);\r\n            this.syncBScroll(newPos);\r\n        }\r\n    };\r\n    Indicator.prototype.endHandler = function () {\r\n        if (this.moved) {\r\n            var _a = this.scroll, x = _a.x, y = _a.y;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollEnd, {\r\n                x: x,\r\n                y: y,\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.indicatorNotMoved = function (delta) {\r\n        var currentPos = this.currentPos;\r\n        var _a = this.scrollInfo, maxScrollPos = _a.maxScrollPos, minScrollPos = _a.minScrollPos;\r\n        var notMoved = (currentPos === minScrollPos && delta <= 0) ||\r\n            (currentPos === maxScrollPos && delta >= 0);\r\n        return notMoved;\r\n    };\r\n    Indicator.prototype.syncBScroll = function (newPos) {\r\n        var timestamp = getNow();\r\n        var _a = this.scroll, x = _a.x, y = _a.y, options = _a.options, scroller = _a.scroller, maxScrollY = _a.maxScrollY, minScrollY = _a.minScrollY, maxScrollX = _a.maxScrollX, minScrollX = _a.minScrollX;\r\n        var probeType = options.probeType, momentumLimitTime = options.momentumLimitTime;\r\n        var position = { x: x, y: y };\r\n        if (this.direction === \"vertical\" /* Vertical */) {\r\n            position.y = between(newPos, maxScrollY, minScrollY);\r\n        }\r\n        else {\r\n            position.x = between(newPos, maxScrollX, minScrollX);\r\n        }\r\n        scroller.translater.translate(position);\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > momentumLimitTime) {\r\n            this.startTime = timestamp;\r\n            if (probeType === 1 /* Throttle */) {\r\n                scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (probeType > 1 /* Throttle */) {\r\n            scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\r\n        }\r\n    };\r\n    Indicator.prototype.newPos = function (currentPos, delta, scrollInfo) {\r\n        var maxScrollPos = scrollInfo.maxScrollPos, sizeRatio = scrollInfo.sizeRatio, minScrollPos = scrollInfo.minScrollPos;\r\n        var newPos = currentPos + delta;\r\n        newPos = between(newPos, minScrollPos, maxScrollPos);\r\n        return Math.round(newPos / sizeRatio);\r\n    };\r\n    Indicator.prototype.destroy = function () {\r\n        var _a = this.options, interactive = _a.interactive, scrollbarTrackClickable = _a.scrollbarTrackClickable, isCustom = _a.isCustom;\r\n        if (interactive) {\r\n            this.eventHandler.destroy();\r\n        }\r\n        if (scrollbarTrackClickable) {\r\n            this.clickEventRegister.destroy();\r\n        }\r\n        if (!isCustom) {\r\n            this.wrapper.parentNode.removeChild(this.wrapper);\r\n        }\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    return Indicator;\r\n}());\n\nvar ScrollBar = /** @class */ (function () {\r\n    function ScrollBar(scroll) {\r\n        this.scroll = scroll;\r\n        this.handleOptions();\r\n        this.createIndicators();\r\n        this.handleHooks();\r\n    }\r\n    ScrollBar.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scroll = this.scroll;\r\n        scroll.hooks.on(scroll.hooks.eventTypes.destroy, function () {\r\n            for (var _i = 0, _a = _this.indicators; _i < _a.length; _i++) {\r\n                var indicator = _a[_i];\r\n                indicator.destroy();\r\n            }\r\n        });\r\n    };\r\n    ScrollBar.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.scrollbar === true\r\n            ? {}\r\n            : this.scroll.options.scrollbar);\r\n        var defaultOptions = {\r\n            fade: true,\r\n            fadeInTime: 250,\r\n            fadeOutTime: 500,\r\n            interactive: false,\r\n            customElements: [],\r\n            minSize: 8,\r\n            scrollbarTrackClickable: false,\r\n            scrollbarTrackOffsetType: \"step\" /* Step */,\r\n            scrollbarTrackOffsetTime: 300,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n    };\r\n    ScrollBar.prototype.createIndicators = function () {\r\n        var indicatorOptions;\r\n        var scroll = this.scroll;\r\n        var indicators = [];\r\n        var scrollDirectionConfigKeys = ['scrollX', 'scrollY'];\r\n        var indicatorDirections = [\r\n            \"horizontal\" /* Horizontal */,\r\n            \"vertical\" /* Vertical */,\r\n        ];\r\n        var customScrollbarEls = this.options.customElements;\r\n        for (var i = 0; i < scrollDirectionConfigKeys.length; i++) {\r\n            var key = scrollDirectionConfigKeys[i];\r\n            // wanna scroll in specified direction\r\n            if (scroll.options[key]) {\r\n                var customElement = customScrollbarEls.shift();\r\n                var direction = indicatorDirections[i];\r\n                var isCustom = false;\r\n                var scrollbarWrapper = customElement\r\n                    ? customElement\r\n                    : this.createScrollbarElement(direction);\r\n                // internal scrollbar\r\n                if (scrollbarWrapper !== customElement) {\r\n                    scroll.wrapper.appendChild(scrollbarWrapper);\r\n                }\r\n                else {\r\n                    // custom scrollbar passed by users\r\n                    isCustom = true;\r\n                }\r\n                indicatorOptions = __assign(__assign({ wrapper: scrollbarWrapper, direction: direction }, this.options), { isCustom: isCustom });\r\n                indicators.push(new Indicator(scroll, indicatorOptions));\r\n            }\r\n        }\r\n        this.indicators = indicators;\r\n    };\r\n    ScrollBar.prototype.createScrollbarElement = function (direction, scrollbarTrackClickable) {\r\n        if (scrollbarTrackClickable === void 0) { scrollbarTrackClickable = this.options.scrollbarTrackClickable; }\r\n        var scrollbarWrapperEl = document.createElement('div');\r\n        var scrollbarIndicatorEl = document.createElement('div');\r\n        scrollbarWrapperEl.style.cssText =\r\n            'position:absolute;z-index:9999;overflow:hidden;';\r\n        scrollbarIndicatorEl.style.cssText =\r\n            'box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px;';\r\n        scrollbarIndicatorEl.className = 'bscroll-indicator';\r\n        if (direction === \"horizontal\" /* Horizontal */) {\r\n            scrollbarWrapperEl.style.cssText +=\r\n                'height:7px;left:2px;right:2px;bottom:0;';\r\n            scrollbarIndicatorEl.style.height = '100%';\r\n            scrollbarWrapperEl.className = 'bscroll-horizontal-scrollbar';\r\n        }\r\n        else {\r\n            scrollbarWrapperEl.style.cssText +=\r\n                'width:7px;bottom:2px;top:2px;right:1px;';\r\n            scrollbarIndicatorEl.style.width = '100%';\r\n            scrollbarWrapperEl.className = 'bscroll-vertical-scrollbar';\r\n        }\r\n        if (!scrollbarTrackClickable) {\r\n            scrollbarWrapperEl.style.cssText += 'pointer-events:none;';\r\n        }\r\n        scrollbarWrapperEl.appendChild(scrollbarIndicatorEl);\r\n        return scrollbarWrapperEl;\r\n    };\r\n    ScrollBar.pluginName = 'scrollbar';\r\n    return ScrollBar;\r\n}());\n\nexport default ScrollBar;\n","/*!\r\n * better-scroll / nested-scroll\r\n * (c) 2016-2020 ustbhuangyi\r\n * Released under the MIT License.\r\n */\r\n\r\n// Slightly modified to for Noodl to fix a problem:\r\n// - click bug. Click could be disabled and never enabled again when scrolling\r\n// - click bug 2. Click option didn't support the scroller being moved around in the dom tree\r\n//                It assumed the nested scroll relationships always stay the same\r\n//                (so doesn't work with delta updates)\r\n\r\nvar compatibleFeatures = {\r\n  duplicateClick: function (_a) {\r\n    var parentScroll = _a[0],\r\n      childScroll = _a[1];\r\n    // no need to make childScroll's click true\r\n    if (parentScroll.options.click && childScroll.options.click) {\r\n      childScroll.options.click = false;\r\n    }\r\n  },\r\n  nestedScroll: function (scrollsPair) {\r\n    var parentScroll = scrollsPair[0],\r\n      childScroll = scrollsPair[1];\r\n    var parentScrollX = parentScroll.options.scrollX;\r\n    var parentScrollY = parentScroll.options.scrollY;\r\n    var childScrollX = childScroll.options.scrollX;\r\n    var childScrollY = childScroll.options.scrollY;\r\n    // vertical nested in vertical scroll and horizontal nested in horizontal\r\n    // otherwise, no need to handle.\r\n    if (parentScrollX === childScrollX || parentScrollY === childScrollY) {\r\n      scrollsPair.forEach(function (scroll, index) {\r\n        var oppositeScroll = scrollsPair[(index + 1) % 2];\r\n        scroll.on('scrollStart', function () {\r\n          if (oppositeScroll.pending) {\r\n            oppositeScroll.stop();\r\n            oppositeScroll.resetPosition();\r\n          }\r\n          setupData(oppositeScroll);\r\n          oppositeScroll.disable();\r\n        });\r\n        scroll.on('touchEnd', function () {\r\n          oppositeScroll.enable();\r\n        });\r\n      });\r\n      childScroll.on('scrollStart', function () {\r\n        if (checkBeyondBoundary(childScroll)) {\r\n          childScroll.disable();\r\n          parentScroll.enable();\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\nvar NestedScroll = /** @class */ (function () {\r\n  function NestedScroll(scroll) {\r\n    var singleton = NestedScroll.nestedScroll;\r\n    if (!(singleton instanceof NestedScroll)) {\r\n      singleton = NestedScroll.nestedScroll = this;\r\n      singleton.stores = [];\r\n    }\r\n    singleton.setup(scroll);\r\n    singleton.addHooks(scroll);\r\n    return singleton;\r\n  }\r\n  NestedScroll.prototype.setup = function (scroll) {\r\n    this.appendBScroll(scroll);\r\n    this.handleContainRelationship();\r\n    this.handleCompatible();\r\n  };\r\n  NestedScroll.prototype.addHooks = function (scroll) {\r\n    var _this = this;\r\n    scroll.on('destroy', function () {\r\n      _this.teardown(scroll);\r\n    });\r\n  };\r\n  NestedScroll.prototype.teardown = function (scroll) {\r\n    this.removeBScroll(scroll);\r\n    this.handleContainRelationship();\r\n    this.handleCompatible();\r\n  };\r\n  NestedScroll.prototype.appendBScroll = function (scroll) {\r\n    this.stores.push(scroll);\r\n  };\r\n  NestedScroll.prototype.removeBScroll = function (scroll) {\r\n    var index = this.stores.indexOf(scroll);\r\n    if (index === -1) return;\r\n    scroll.wrapper.isBScrollContainer = undefined;\r\n    this.stores.splice(index, 1);\r\n  };\r\n  NestedScroll.prototype.handleContainRelationship = function () {\r\n    // bs's length <= 1\r\n    var stores = this.stores;\r\n    if (stores.length <= 1) {\r\n      // there is only a childBScroll left.\r\n      if (stores[0] && stores[0].__parentInfo) {\r\n        stores[0].__parentInfo = undefined;\r\n      }\r\n      return;\r\n    }\r\n    var outerBS;\r\n    var outerBSWrapper;\r\n    var innerBS;\r\n    var innerBSWrapper;\r\n    // Need two layers of \"For loop\" to calculate parent-child relationship\r\n    for (var i = 0; i < stores.length; i++) {\r\n      outerBS = stores[i];\r\n      outerBSWrapper = outerBS.wrapper;\r\n      for (var j = 0; j < stores.length; j++) {\r\n        innerBS = stores[j];\r\n        innerBSWrapper = innerBS.wrapper;\r\n        // same bs\r\n        if (outerBS === innerBS) continue;\r\n        // now start calculating\r\n        if (!innerBSWrapper.contains(outerBSWrapper)) continue;\r\n        // now innerBS contains outerBS\r\n        // no parentInfo yet\r\n        if (!outerBS.__parentInfo) {\r\n          outerBS.__parentInfo = {\r\n            parent: innerBS,\r\n            depth: calculateDepths(outerBSWrapper, innerBSWrapper)\r\n          };\r\n        } else {\r\n          // has parentInfo already!\r\n          // just judge the \"true\" parent by depth\r\n          // we regard the latest node as parent, not the furthest\r\n          var currentDepths = calculateDepths(outerBSWrapper, innerBSWrapper);\r\n          var prevDepths = outerBS.__parentInfo.depth;\r\n          // refresh currentBS as parentScroll\r\n          if (prevDepths > currentDepths) {\r\n            outerBS.__parentInfo = {\r\n              parent: innerBS,\r\n              depth: currentDepths\r\n            };\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n  NestedScroll.prototype.handleCompatible = function () {\r\n    var pairs = this.availableBScrolls();\r\n    var keys = ['duplicateClick', 'nestedScroll'];\r\n    pairs.forEach(function (pair) {\r\n      keys.forEach(function (key) {\r\n        compatibleFeatures[key](pair);\r\n      });\r\n    });\r\n  };\r\n  NestedScroll.prototype.availableBScrolls = function () {\r\n    var ret = [];\r\n    ret = this.stores\r\n      .filter(function (bs) {\r\n        return !!bs.__parentInfo;\r\n      })\r\n      .map(function (bs) {\r\n        return [bs.__parentInfo.parent, bs];\r\n      });\r\n    return ret;\r\n  };\r\n  NestedScroll.pluginName = 'nestedScroll';\r\n  return NestedScroll;\r\n})();\r\nfunction calculateDepths(childNode, parentNode) {\r\n  var depth = 0;\r\n  var parent = childNode.parentNode;\r\n  while (parent && parent !== parentNode) {\r\n    depth++;\r\n    parent = parent.parentNode;\r\n  }\r\n  return depth;\r\n}\r\nfunction checkBeyondBoundary(scroll) {\r\n  var _a = hasScroll(scroll),\r\n    hasHorizontalScroll = _a.hasHorizontalScroll,\r\n    hasVerticalScroll = _a.hasVerticalScroll;\r\n  var _b = scroll.scroller,\r\n    scrollBehaviorX = _b.scrollBehaviorX,\r\n    scrollBehaviorY = _b.scrollBehaviorY;\r\n  var hasReachLeft = scroll.x >= scroll.minScrollX && scrollBehaviorX.movingDirection === -1;\r\n  var hasReachRight = scroll.x <= scroll.maxScrollX && scrollBehaviorX.movingDirection === 1;\r\n  var hasReachTop = scroll.y >= scroll.minScrollY && scrollBehaviorY.movingDirection === -1;\r\n  var hasReachBottom = scroll.y <= scroll.maxScrollY && scrollBehaviorY.movingDirection === 1;\r\n  if (hasVerticalScroll) {\r\n    return hasReachTop || hasReachBottom;\r\n  } else if (hasHorizontalScroll) {\r\n    return hasReachLeft || hasReachRight;\r\n  }\r\n  return false;\r\n}\r\nfunction setupData(scroll) {\r\n  var _a = hasScroll(scroll),\r\n    hasHorizontalScroll = _a.hasHorizontalScroll,\r\n    hasVerticalScroll = _a.hasVerticalScroll;\r\n  var _b = scroll.scroller,\r\n    actions = _b.actions,\r\n    scrollBehaviorX = _b.scrollBehaviorX,\r\n    scrollBehaviorY = _b.scrollBehaviorY;\r\n  actions.startTime = +new Date();\r\n  if (hasVerticalScroll) {\r\n    scrollBehaviorY.startPos = scrollBehaviorY.currentPos;\r\n  } else if (hasHorizontalScroll) {\r\n    scrollBehaviorX.startPos = scrollBehaviorX.currentPos;\r\n  }\r\n}\r\nfunction hasScroll(scroll) {\r\n  return {\r\n    hasHorizontalScroll: scroll.scroller.scrollBehaviorX.hasScroll,\r\n    hasVerticalScroll: scroll.scroller.scrollBehaviorY.hasScroll\r\n  };\r\n}\r\n\r\nexport default NestedScroll;\r\n","/*!\r\n * better-scroll / slide\r\n * (c) 2016-2020 ustbhuangyi\r\n * Released under the MIT License.\r\n */\r\n\r\n//adapted to Noodl's more dynamic delta update environment:\r\n// - A scroll refresh doesn't reset the current slide page position\r\n// - Horizontal slider doesn't break when there are no children\r\n\r\nfunction warn(msg) {\r\n  console.error('[BScroll warn]: ' + msg);\r\n}\r\n\r\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\nvar isWeChatDevTools = ua && /wechatdevtools/.test(ua);\r\nvar isAndroid = ua && ua.indexOf('android') > 0;\r\n\r\nfunction extend(target) {\r\n  var rest = [];\r\n  for (var _i = 1; _i < arguments.length; _i++) {\r\n    rest[_i - 1] = arguments[_i];\r\n  }\r\n  for (var i = 0; i < rest.length; i++) {\r\n    var source = rest[i];\r\n    for (var key in source) {\r\n      target[key] = source[key];\r\n    }\r\n  }\r\n  return target;\r\n}\r\nfunction fixInboundValue(x, min, max) {\r\n  if (x < min) {\r\n    return min;\r\n  }\r\n  if (x > max) {\r\n    return max;\r\n  }\r\n  return x;\r\n}\r\n\r\nvar elementStyle = inBrowser && document.createElement('div').style;\r\nvar vendor = (function () {\r\n  if (!inBrowser) {\r\n    return false;\r\n  }\r\n  var transformNames = {\r\n    webkit: 'webkitTransform',\r\n    Moz: 'MozTransform',\r\n    O: 'OTransform',\r\n    ms: 'msTransform',\r\n    standard: 'transform'\r\n  };\r\n  for (var key in transformNames) {\r\n    if (elementStyle[transformNames[key]] !== undefined) {\r\n      return key;\r\n    }\r\n  }\r\n  return false;\r\n})();\r\nfunction prefixStyle(style) {\r\n  if (vendor === false) {\r\n    return style;\r\n  }\r\n  if (vendor === 'standard') {\r\n    if (style === 'transitionEnd') {\r\n      return 'transitionend';\r\n    }\r\n    return style;\r\n  }\r\n  return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nvar cssVendor = vendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle;\r\nvar style = {\r\n  transform: transform,\r\n  transition: transition,\r\n  transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n  transitionDuration: prefixStyle('transitionDuration'),\r\n  transitionDelay: prefixStyle('transitionDelay'),\r\n  transformOrigin: prefixStyle('transformOrigin'),\r\n  transitionEnd: prefixStyle('transitionEnd')\r\n};\r\nfunction getRect(el) {\r\n  if (el instanceof window.SVGElement) {\r\n    var rect = el.getBoundingClientRect();\r\n    return {\r\n      top: rect.top,\r\n      left: rect.left,\r\n      width: rect.width,\r\n      height: rect.height\r\n    };\r\n  } else {\r\n    return {\r\n      top: el.offsetTop,\r\n      left: el.offsetLeft,\r\n      width: el.offsetWidth,\r\n      height: el.offsetHeight\r\n    };\r\n  }\r\n}\r\nfunction prepend(el, target) {\r\n  var firstChild = target.firstChild;\r\n  if (firstChild) {\r\n    before(el, firstChild);\r\n  } else {\r\n    target.appendChild(el);\r\n  }\r\n}\r\nfunction before(el, target) {\r\n  target.parentNode.insertBefore(el, target);\r\n}\r\nfunction removeChild(el, child) {\r\n  el.removeChild(child);\r\n}\r\n\r\nvar ease = {\r\n  // easeOutQuint\r\n  swipe: {\r\n    style: 'cubic-bezier(0.23, 1, 0.32, 1)',\r\n    fn: function (t) {\r\n      return 1 + --t * t * t * t * t;\r\n    }\r\n  },\r\n  // easeOutQuard\r\n  swipeBounce: {\r\n    style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n    fn: function (t) {\r\n      return t * (2 - t);\r\n    }\r\n  },\r\n  // easeOutQuart\r\n  bounce: {\r\n    style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\r\n    fn: function (t) {\r\n      return 1 - --t * t * t * t;\r\n    }\r\n  }\r\n};\r\n\r\nvar DEFAULT_INTERVAL = 100 / 60;\r\nvar windowCompat = inBrowser && window;\r\nfunction noop() {}\r\nvar requestAnimationFrame = (function () {\r\n  if (!inBrowser) {\r\n    /* istanbul ignore if */\r\n    return noop;\r\n  }\r\n  return (\r\n    windowCompat.requestAnimationFrame ||\r\n    windowCompat.webkitRequestAnimationFrame ||\r\n    windowCompat.mozRequestAnimationFrame ||\r\n    windowCompat.oRequestAnimationFrame ||\r\n    // if all else fails, use setTimeout\r\n    function (callback) {\r\n      return window.setTimeout(callback, (callback.interval || DEFAULT_INTERVAL) / 2); // make interval as precise as possible.\r\n    }\r\n  );\r\n})();\r\nvar cancelAnimationFrame = (function () {\r\n  if (!inBrowser) {\r\n    /* istanbul ignore if */\r\n    return noop;\r\n  }\r\n  return (\r\n    windowCompat.cancelAnimationFrame ||\r\n    windowCompat.webkitCancelAnimationFrame ||\r\n    windowCompat.mozCancelAnimationFrame ||\r\n    windowCompat.oCancelAnimationFrame ||\r\n    function (id) {\r\n      window.clearTimeout(id);\r\n    }\r\n  );\r\n})();\r\n\r\nvar PagesPos = /** @class */ (function () {\r\n  function PagesPos(scroll, slideOpt) {\r\n    this.scroll = scroll;\r\n    this.slideOpt = slideOpt;\r\n    this.slideEl = null;\r\n    this.init();\r\n  }\r\n  PagesPos.prototype.init = function () {\r\n    var scrollerIns = this.scroll.scroller;\r\n    var scrollBehaviorX = scrollerIns.scrollBehaviorX;\r\n    var scrollBehaviorY = scrollerIns.scrollBehaviorY;\r\n    var wrapper = getRect(scrollerIns.wrapper);\r\n    var scroller = getRect(scrollerIns.content);\r\n    this.wrapperWidth = wrapper.width;\r\n    this.wrapperHeight = wrapper.height;\r\n    this.scrollerHeight = scrollBehaviorY.hasScroll ? scroller.height : wrapper.height;\r\n    this.scrollerWidth = scrollBehaviorX.hasScroll ? scroller.width : wrapper.width;\r\n    var stepX = this.slideOpt.stepX || this.wrapperWidth;\r\n    var stepY = this.slideOpt.stepY || this.wrapperHeight;\r\n    var slideEls = scrollerIns.content;\r\n    var el = this.slideOpt.el;\r\n    if (typeof el === 'string') {\r\n      this.slideEl = slideEls.querySelectorAll(el);\r\n    }\r\n    this.pages = this.slideEl ? this.computePagePosInfoByEl(this.slideEl) : this.computePagePosInfo(stepX, stepY);\r\n    this.xLen = this.pages ? this.pages.length : 0;\r\n    this.yLen = this.pages && this.pages[0] ? this.pages[0].length : 0;\r\n  };\r\n  PagesPos.prototype.hasInfo = function () {\r\n    if (!this.pages || !this.pages.length) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  PagesPos.prototype.getPos = function (x, y) {\r\n    return this.pages[x] ? this.pages[x][y] : null;\r\n  };\r\n  PagesPos.prototype.getNearestPage = function (x, y) {\r\n    if (!this.hasInfo()) {\r\n      return;\r\n    }\r\n    var pageX = 0;\r\n    var pageY = 0;\r\n    var l = this.pages.length;\r\n    for (; pageX < l - 1; pageX++) {\r\n      if (x >= this.pages[pageX][0].cx) {\r\n        break;\r\n      }\r\n    }\r\n    l = this.pages[pageX].length;\r\n    for (; pageY < l - 1; pageY++) {\r\n      if (y >= this.pages[0][pageY].cy) {\r\n        break;\r\n      }\r\n    }\r\n    return {\r\n      pageX: pageX,\r\n      pageY: pageY\r\n    };\r\n  };\r\n  PagesPos.prototype.computePagePosInfo = function (stepX, stepY) {\r\n    var pages = [];\r\n    var x = 0;\r\n    var y;\r\n    var cx;\r\n    var cy;\r\n    var i = 0;\r\n    var l;\r\n    var maxScrollPosX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\r\n    var maxScrollPosY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\r\n    cx = Math.round(stepX / 2);\r\n    cy = Math.round(stepY / 2);\r\n    while (x > -this.scrollerWidth) {\r\n      pages[i] = [];\r\n      l = 0;\r\n      y = 0;\r\n      while (y > -this.scrollerHeight) {\r\n        pages[i][l] = {\r\n          x: Math.max(x, maxScrollPosX),\r\n          y: Math.max(y, maxScrollPosY),\r\n          width: stepX,\r\n          height: stepY,\r\n          cx: x - cx,\r\n          cy: y - cy\r\n        };\r\n        y -= stepY;\r\n        l++;\r\n      }\r\n      x -= stepX;\r\n      i++;\r\n    }\r\n    return pages;\r\n  };\r\n  PagesPos.prototype.computePagePosInfoByEl = function (el) {\r\n    var pages = [];\r\n    var x = 0;\r\n    var y = 0;\r\n    var cx;\r\n    var cy;\r\n    var i = 0;\r\n    var l = el.length;\r\n    var m = 0;\r\n    var n = -1;\r\n    var rect;\r\n    var maxScrollX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\r\n    var maxScrollY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\r\n    for (; i < l; i++) {\r\n      rect = getRect(el[i]);\r\n      if (i === 0 || rect.left <= getRect(el[i - 1]).left) {\r\n        m = 0;\r\n        n++;\r\n      }\r\n      if (!pages[m]) {\r\n        pages[m] = [];\r\n      }\r\n      x = Math.max(-rect.left, maxScrollX);\r\n      y = Math.max(-rect.top, maxScrollY);\r\n      cx = x - Math.round(rect.width / 2);\r\n      cy = y - Math.round(rect.height / 2);\r\n      pages[m][n] = {\r\n        x: x,\r\n        y: y,\r\n        width: rect.width,\r\n        height: rect.height,\r\n        cx: cx,\r\n        cy: cy\r\n      };\r\n      if (x > maxScrollX) {\r\n        m++;\r\n      }\r\n    }\r\n    return pages;\r\n  };\r\n  return PagesPos;\r\n})();\r\n\r\nvar PageInfo = /** @class */ (function () {\r\n  function PageInfo(scroll, slideOpt) {\r\n    this.scroll = scroll;\r\n    this.slideOpt = slideOpt;\r\n  }\r\n  PageInfo.prototype.init = function () {\r\n    this.currentPage = {\r\n      x: 0,\r\n      y: 0,\r\n      pageX: 0,\r\n      pageY: 0\r\n    };\r\n    this.pagesPos = new PagesPos(this.scroll, this.slideOpt);\r\n    this.checkSlideLoop();\r\n  };\r\n  PageInfo.prototype.changeCurrentPage = function (newPage) {\r\n    this.currentPage = newPage;\r\n  };\r\n  PageInfo.prototype.change2safePage = function (pageX, pageY) {\r\n    if (!this.pagesPos.hasInfo()) {\r\n      return;\r\n    }\r\n    if (pageX >= this.pagesPos.xLen) {\r\n      pageX = this.pagesPos.xLen - 1;\r\n    } else if (pageX < 0) {\r\n      pageX = 0;\r\n    }\r\n    if (pageY >= this.pagesPos.yLen) {\r\n      pageY = this.pagesPos.yLen - 1;\r\n    } else if (pageY < 0) {\r\n      pageY = 0;\r\n    }\r\n    var _a = this.pagesPos.getPos(pageX, pageY);\r\n    return {\r\n      pageX: pageX,\r\n      pageY: pageY,\r\n      x: _a ? _a.x : 0,\r\n      y: _a ? _a.y : 0\r\n    };\r\n  };\r\n  PageInfo.prototype.getInitPage = function () {\r\n    var initPageX = this.loopX ? 1 : 0;\r\n    var initPageY = this.loopY ? 1 : 0;\r\n    return {\r\n      pageX: initPageX,\r\n      pageY: initPageY\r\n    };\r\n  };\r\n  PageInfo.prototype.getRealPage = function (page) {\r\n    var fixedPage = function (page, realPageLen) {\r\n      var pageIndex = [];\r\n      for (var i = 0; i < realPageLen; i++) {\r\n        pageIndex.push(i);\r\n      }\r\n      pageIndex.unshift(realPageLen - 1);\r\n      pageIndex.push(0);\r\n      return pageIndex[page];\r\n    };\r\n    var currentPage = page ? extend({}, page) : extend({}, this.currentPage);\r\n    if (this.loopX) {\r\n      currentPage.pageX = fixedPage(currentPage.pageX, this.pagesPos.xLen - 2);\r\n    }\r\n    if (this.loopY) {\r\n      currentPage.pageY = fixedPage(currentPage.pageY, this.pagesPos.yLen - 2);\r\n    }\r\n    return {\r\n      pageX: currentPage.pageX,\r\n      pageY: currentPage.pageY\r\n    };\r\n  };\r\n  PageInfo.prototype.getPageSize = function () {\r\n    return this.pagesPos.getPos(this.currentPage.pageX, this.currentPage.pageY);\r\n  };\r\n  PageInfo.prototype.realPage2Page = function (x, y) {\r\n    if (!this.pagesPos.hasInfo()) {\r\n      return;\r\n    }\r\n    var lastX = this.pagesPos.xLen - 1;\r\n    var lastY = this.pagesPos.yLen - 1;\r\n    var firstX = 0;\r\n    var firstY = 0;\r\n    if (this.loopX) {\r\n      x += 1;\r\n      firstX = firstX + 1;\r\n      lastX = lastX - 1;\r\n    }\r\n    if (this.loopY) {\r\n      y += 1;\r\n      firstY = firstY + 1;\r\n      lastY = lastY - 1;\r\n    }\r\n    x = fixInboundValue(x, firstX, lastX);\r\n    y = fixInboundValue(y, firstY, lastY);\r\n    return {\r\n      realX: x,\r\n      realY: y\r\n    };\r\n  };\r\n  PageInfo.prototype.nextPage = function () {\r\n    return this.changedPageNum('positive' /* Positive */);\r\n  };\r\n  PageInfo.prototype.prevPage = function () {\r\n    return this.changedPageNum('negative' /* Negative */);\r\n  };\r\n  PageInfo.prototype.nearestPage = function (x, y, directionX, directionY) {\r\n    var pageInfo = this.pagesPos.getNearestPage(x, y);\r\n    if (!pageInfo) {\r\n      return {\r\n        x: 0,\r\n        y: 0,\r\n        pageX: 0,\r\n        pageY: 0\r\n      };\r\n    }\r\n    var pageX = pageInfo.pageX;\r\n    var pageY = pageInfo.pageY;\r\n    var newX;\r\n    var newY;\r\n    if (pageX === this.currentPage.pageX) {\r\n      pageX += directionX;\r\n      pageX = fixInboundValue(pageX, 0, this.pagesPos.xLen - 1);\r\n    }\r\n    if (pageY === this.currentPage.pageY) {\r\n      pageY += directionY;\r\n      pageY = fixInboundValue(pageInfo.pageY, 0, this.pagesPos.yLen - 1);\r\n    }\r\n    newX = this.pagesPos.getPos(pageX, 0).x;\r\n    newY = this.pagesPos.getPos(0, pageY).y;\r\n    return {\r\n      x: newX,\r\n      y: newY,\r\n      pageX: pageX,\r\n      pageY: pageY\r\n    };\r\n  };\r\n  PageInfo.prototype.getLoopStage = function () {\r\n    if (!this.needLoop) {\r\n      return 'middle' /* Middle */;\r\n    }\r\n    if (this.loopX) {\r\n      if (this.currentPage.pageX === 0) {\r\n        return 'head' /* Head */;\r\n      }\r\n      if (this.currentPage.pageX === this.pagesPos.xLen - 1) {\r\n        return 'tail' /* Tail */;\r\n      }\r\n    }\r\n    if (this.loopY) {\r\n      if (this.currentPage.pageY === 0) {\r\n        return 'head' /* Head */;\r\n      }\r\n      if (this.currentPage.pageY === this.pagesPos.yLen - 1) {\r\n        return 'tail' /* Tail */;\r\n      }\r\n    }\r\n    return 'middle' /* Middle */;\r\n  };\r\n  PageInfo.prototype.resetLoopPage = function () {\r\n    if (this.loopX) {\r\n      if (this.currentPage.pageX === 0) {\r\n        return {\r\n          pageX: this.pagesPos.xLen - 2,\r\n          pageY: this.currentPage.pageY\r\n        };\r\n      }\r\n      if (this.currentPage.pageX === this.pagesPos.xLen - 1) {\r\n        return {\r\n          pageX: 1,\r\n          pageY: this.currentPage.pageY\r\n        };\r\n      }\r\n    }\r\n    if (this.loopY) {\r\n      if (this.currentPage.pageY === 0) {\r\n        return {\r\n          pageX: this.currentPage.pageX,\r\n          pageY: this.pagesPos.yLen - 2\r\n        };\r\n      }\r\n      if (this.currentPage.pageY === this.pagesPos.yLen - 1) {\r\n        return {\r\n          pageX: this.currentPage.pageX,\r\n          pageY: 1\r\n        };\r\n      }\r\n    }\r\n  };\r\n  PageInfo.prototype.isSameWithCurrent = function (page) {\r\n    if (page.pageX !== this.currentPage.pageX || page.pageY !== this.currentPage.pageY) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  PageInfo.prototype.changedPageNum = function (direction) {\r\n    var x = this.currentPage.pageX;\r\n    var y = this.currentPage.pageY;\r\n    if (this.slideX) {\r\n      x = direction === 'negative' /* Negative */ ? x - 1 : x + 1;\r\n    }\r\n    if (this.slideY) {\r\n      y = direction === 'negative' /* Negative */ ? y - 1 : y + 1;\r\n    }\r\n    return {\r\n      pageX: x,\r\n      pageY: y\r\n    };\r\n  };\r\n  PageInfo.prototype.checkSlideLoop = function () {\r\n    this.needLoop = this.slideOpt.loop;\r\n    if (this.pagesPos.xLen > 1) {\r\n      this.slideX = true;\r\n    }\r\n    if (this.pagesPos.pages[0] && this.pagesPos.yLen > 1) {\r\n      this.slideY = true;\r\n    }\r\n    this.loopX = this.needLoop && this.slideX;\r\n    this.loopY = this.needLoop && this.slideY;\r\n    if (this.slideX && this.slideY) {\r\n      warn('slide does not support two direction at the same time.');\r\n    }\r\n  };\r\n  return PageInfo;\r\n})();\r\n\r\nvar sourcePrefix = 'plugins.slide';\r\nvar propertiesMap = [\r\n  {\r\n    key: 'next',\r\n    name: 'next'\r\n  },\r\n  {\r\n    key: 'prev',\r\n    name: 'prev'\r\n  },\r\n  {\r\n    key: 'goToPage',\r\n    name: 'goToPage'\r\n  },\r\n  {\r\n    key: 'getCurrentPage',\r\n    name: 'getCurrentPage'\r\n  }\r\n];\r\nvar propertiesConfig = propertiesMap.map(function (item) {\r\n  return {\r\n    key: item.key,\r\n    sourceKey: sourcePrefix + '.' + item.name\r\n  };\r\n});\r\n\r\nvar Slide = /** @class */ (function () {\r\n  function Slide(scroll) {\r\n    this.scroll = scroll;\r\n    this.resetLooping = false;\r\n    this.isTouching = false;\r\n    this.scroll.proxy(propertiesConfig);\r\n    this.scroll.registerType(['slideWillChange']);\r\n    this.slideOpt = this.scroll.options.slide;\r\n    this.page = new PageInfo(scroll, this.slideOpt);\r\n    this.hooksFn = [];\r\n    this.willChangeToPage = {\r\n      pageX: 0,\r\n      pageY: 0\r\n    };\r\n    this.init();\r\n  }\r\n  Slide.prototype.init = function () {\r\n    var _this = this;\r\n    var slide = this.slideOpt;\r\n    var slideEls = this.scroll.scroller.content;\r\n    var lazyInitByRefresh = false;\r\n    if (slide.loop) {\r\n      var children = slideEls.children;\r\n      if (children.length > 1) {\r\n        this.cloneSlideEleForLoop(slideEls);\r\n        lazyInitByRefresh = true;\r\n      } else {\r\n        // Loop does not make any sense if there is only one child.\r\n        slide.loop = false;\r\n      }\r\n    }\r\n    var shouldRefreshByWidth = this.setSlideWidth(slideEls);\r\n    var shouldRefreshByHeight = this.setSlideHeight(this.scroll.scroller.wrapper, slideEls);\r\n    var shouldRefresh = shouldRefreshByWidth || shouldRefreshByHeight;\r\n    var scrollHooks = this.scroll.hooks;\r\n    var scrollerHooks = this.scroll.scroller.hooks;\r\n    this.registorHooks(scrollHooks, 'refresh', this.initSlideState);\r\n    this.registorHooks(scrollHooks, 'destroy', this.destroy);\r\n    this.registorHooks(scrollerHooks, 'momentum', this.modifyScrollMetaHandler);\r\n    // scrollEnd handler should be called before customized handlers\r\n    this.registorHooks(this.scroll, 'scrollEnd', this.amendCurrentPage);\r\n    this.registorHooks(scrollerHooks, 'beforeStart', this.setTouchFlag);\r\n    this.registorHooks(scrollerHooks, 'scroll', this.scrollMoving);\r\n    this.registorHooks(scrollerHooks, 'resize', this.resize);\r\n    // for mousewheel event\r\n    if (this.scroll.eventTypes.mousewheelMove && this.scroll.eventTypes.mousewheelEnd) {\r\n      this.registorHooks(this.scroll, 'mousewheelMove', function () {\r\n        // prevent default action of mousewheelMove\r\n        return true;\r\n      });\r\n      this.registorHooks(this.scroll, 'mousewheelEnd', function (delta) {\r\n        if (delta.directionX === 1 /* Positive */ || delta.directionY === 1 /* Positive */) {\r\n          _this.next();\r\n        }\r\n        if (delta.directionX === -1 /* Negative */ || delta.directionY === -1 /* Negative */) {\r\n          _this.prev();\r\n        }\r\n      });\r\n    }\r\n    if (slide.listenFlick !== false) {\r\n      this.registorHooks(scrollerHooks, 'flick', this.flickHandler);\r\n    }\r\n    if (!lazyInitByRefresh && !shouldRefresh) {\r\n      this.initSlideState();\r\n    } else {\r\n      this.scroll.refresh();\r\n    }\r\n  };\r\n  Slide.prototype.resize = function () {\r\n    var _this = this;\r\n    var slideEls = this.scroll.scroller.content;\r\n    var slideWrapper = this.scroll.scroller.wrapper;\r\n    clearTimeout(this.resizeTimeout);\r\n    this.resizeTimeout = window.setTimeout(function () {\r\n      _this.clearSlideWidth(slideEls);\r\n      _this.clearSlideHeight(slideEls);\r\n      _this.setSlideWidth(slideEls);\r\n      _this.setSlideHeight(slideWrapper, slideEls);\r\n      _this.scroll.refresh();\r\n    }, this.scroll.options.resizePolling);\r\n    return true;\r\n  };\r\n  Slide.prototype.next = function (time, easing) {\r\n    var _a = this.page.nextPage(),\r\n      pageX = _a.pageX,\r\n      pageY = _a.pageY;\r\n    this.goTo(pageX, pageY, time, easing);\r\n  };\r\n  Slide.prototype.prev = function (time, easing) {\r\n    var _a = this.page.prevPage(),\r\n      pageX = _a.pageX,\r\n      pageY = _a.pageY;\r\n    this.goTo(pageX, pageY, time, easing);\r\n  };\r\n  Slide.prototype.goToPage = function (x, y, time, easing) {\r\n    var pageInfo = this.page.realPage2Page(x, y);\r\n    if (!pageInfo) {\r\n      return;\r\n    }\r\n    this.goTo(pageInfo.realX, pageInfo.realY, time, easing);\r\n  };\r\n  Slide.prototype.getCurrentPage = function () {\r\n    return this.page.getRealPage();\r\n  };\r\n  Slide.prototype.nearestPage = function (x, y) {\r\n    var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\r\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n    var triggerThreshold = true;\r\n    if (\r\n      Math.abs(x - scrollBehaviorX.absStartPos) <= this.thresholdX &&\r\n      Math.abs(y - scrollBehaviorY.absStartPos) <= this.thresholdY\r\n    ) {\r\n      triggerThreshold = false;\r\n    }\r\n    if (!triggerThreshold) {\r\n      return this.page.currentPage;\r\n    }\r\n    return this.page.nearestPage(\r\n      fixInboundValue(x, scrollBehaviorX.maxScrollPos, scrollBehaviorX.minScrollPos),\r\n      fixInboundValue(y, scrollBehaviorY.maxScrollPos, scrollBehaviorY.minScrollPos),\r\n      scrollBehaviorX.direction,\r\n      scrollBehaviorY.direction\r\n    );\r\n  };\r\n  Slide.prototype.destroy = function () {\r\n    var slideEls = this.scroll.scroller.content;\r\n    if (this.slideOpt.loop) {\r\n      var children = slideEls.children;\r\n      if (children.length > 2) {\r\n        removeChild(slideEls, children[children.length - 1]);\r\n        removeChild(slideEls, children[0]);\r\n      }\r\n    }\r\n    this.hooksFn.forEach(function (item) {\r\n      var hooks = item[0];\r\n      var hooksName = item[1];\r\n      var handlerFn = item[2];\r\n      if (hooks.eventTypes[hooksName]) {\r\n        hooks.off(hooksName, handlerFn);\r\n      }\r\n    });\r\n    this.hooksFn.length = 0;\r\n  };\r\n  Slide.prototype.initSlideState = function () {\r\n    const prevPage = this.page.currentPage;\r\n    this.page.init();\r\n    if (prevPage) {\r\n      this.page.currentPage = prevPage;\r\n    } else {\r\n      var initPage = this.page.getInitPage();\r\n      this.goTo(initPage.pageX, initPage.pageY, 0);\r\n    }\r\n\r\n    this.initThreshold();\r\n  };\r\n  Slide.prototype.initThreshold = function () {\r\n    var slideThreshold = this.slideOpt.threshold || 0.1;\r\n    if (slideThreshold % 1 === 0) {\r\n      this.thresholdX = slideThreshold;\r\n      this.thresholdY = slideThreshold;\r\n    } else {\r\n      var pageSize = this.page.getPageSize();\r\n      if (pageSize) {\r\n        this.thresholdX = Math.round(pageSize.width * slideThreshold);\r\n        this.thresholdY = Math.round(pageSize.height * slideThreshold);\r\n      }\r\n    }\r\n  };\r\n  Slide.prototype.cloneSlideEleForLoop = function (slideEls) {\r\n    var children = slideEls.children;\r\n    prepend(children[children.length - 1].cloneNode(true), slideEls);\r\n    slideEls.appendChild(children[1].cloneNode(true));\r\n  };\r\n  Slide.prototype.amendCurrentPage = function () {\r\n    this.isTouching = false;\r\n    if (!this.slideOpt.loop) {\r\n      return;\r\n    }\r\n    // triggered by resetLoop\r\n    if (this.resetLooping) {\r\n      this.resetLooping = false;\r\n      return;\r\n    }\r\n    // fix bug: scroll two page or even more page at once and fetch the boundary.\r\n    // In this case, momentum won't be trigger, so the pageIndex will be wrong and won't be trigger reset.\r\n    var isScrollToBoundary = false;\r\n    if (\r\n      this.page.loopX &&\r\n      (this.scroll.x === this.scroll.scroller.scrollBehaviorX.minScrollPos ||\r\n        this.scroll.x === this.scroll.scroller.scrollBehaviorX.maxScrollPos)\r\n    ) {\r\n      isScrollToBoundary = true;\r\n    }\r\n    if (\r\n      this.page.loopY &&\r\n      (this.scroll.y === this.scroll.scroller.scrollBehaviorY.minScrollPos ||\r\n        this.scroll.y === this.scroll.scroller.scrollBehaviorY.maxScrollPos)\r\n    ) {\r\n      isScrollToBoundary = true;\r\n    }\r\n    if (isScrollToBoundary) {\r\n      var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\r\n      var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n      var newPos = this.page.nearestPage(\r\n        fixInboundValue(this.scroll.x, scrollBehaviorX.maxScrollPos, scrollBehaviorX.minScrollPos),\r\n        fixInboundValue(this.scroll.y, scrollBehaviorY.maxScrollPos, scrollBehaviorY.minScrollPos),\r\n        0,\r\n        0\r\n      );\r\n      var newPage = {\r\n        x: newPos.x,\r\n        y: newPos.y,\r\n        pageX: newPos.pageX,\r\n        pageY: newPos.pageY\r\n      };\r\n      if (!this.page.isSameWithCurrent(newPage)) {\r\n        this.page.changeCurrentPage(newPage);\r\n      }\r\n    }\r\n    var changePage = this.page.resetLoopPage();\r\n    if (changePage) {\r\n      this.resetLooping = true;\r\n      this.goTo(changePage.pageX, changePage.pageY, 0);\r\n      return true; // stop trigger chain\r\n    }\r\n    // amend willChangeToPage, because willChangeToPage maybe wrong when sliding quickly\r\n    this.pageWillChangeTo(this.page.currentPage);\r\n  };\r\n  Slide.prototype.shouldSetWidthHeight = function (checkType) {\r\n    var checkMap = {\r\n      width: ['scrollX', 'disableSetWidth'],\r\n      height: ['scrollY', 'disableSetHeight']\r\n    };\r\n    var checkOption = checkMap[checkType];\r\n    if (!this.scroll.options[checkOption[0]]) {\r\n      return false;\r\n    }\r\n    if (this.slideOpt[checkOption[1]]) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  Slide.prototype.clearSlideWidth = function (slideEls) {\r\n    if (!this.shouldSetWidthHeight('width')) {\r\n      return;\r\n    }\r\n    var children = slideEls.children;\r\n    for (var i = 0; i < children.length; i++) {\r\n      var slideItemDom = children[i];\r\n      slideItemDom.removeAttribute('style');\r\n    }\r\n    slideEls.removeAttribute('style');\r\n  };\r\n  Slide.prototype.setSlideWidth = function (slideEls) {\r\n    if (!this.shouldSetWidthHeight('width')) {\r\n      return false;\r\n    }\r\n    var children = slideEls.children;\r\n    var slideItemWidth = children[0].clientWidth;\r\n    for (var i = 0; i < children.length; i++) {\r\n      var slideItemDom = children[i];\r\n      slideItemDom.style.width = slideItemWidth + 'px';\r\n    }\r\n    slideEls.style.width = slideItemWidth * children.length + 'px';\r\n    return true;\r\n  };\r\n  Slide.prototype.clearSlideHeight = function (slideEls) {\r\n    if (!this.shouldSetWidthHeight('height')) {\r\n      return;\r\n    }\r\n    var children = slideEls.children;\r\n    for (var i = 0; i < children.length; i++) {\r\n      var slideItemDom = children[i];\r\n      slideItemDom.removeAttribute('style');\r\n    }\r\n    slideEls.removeAttribute('style');\r\n  };\r\n  // height change will not effect minScrollY & maxScrollY\r\n  Slide.prototype.setSlideHeight = function (slideWrapper, slideEls) {\r\n    if (!this.shouldSetWidthHeight('height')) {\r\n      return false;\r\n    }\r\n    var wrapperHeight = slideWrapper.clientHeight;\r\n    var children = slideEls.children;\r\n    for (var i = 0; i < children.length; i++) {\r\n      var slideItemDom = children[i];\r\n      slideItemDom.style.height = wrapperHeight + 'px';\r\n    }\r\n    slideEls.style.height = wrapperHeight * children.length + 'px';\r\n    return true;\r\n  };\r\n  Slide.prototype.goTo = function (pageX, pageY, time, easing) {\r\n    if (pageY === void 0) {\r\n      pageY = 0;\r\n    }\r\n    var newPageInfo = this.page.change2safePage(pageX, pageY);\r\n    if (!newPageInfo) {\r\n      return;\r\n    }\r\n    var scrollEasing = easing || this.slideOpt.easing || ease.bounce;\r\n    var posX = newPageInfo.x;\r\n    var posY = newPageInfo.y;\r\n    var deltaX = posX - this.scroll.scroller.scrollBehaviorX.currentPos;\r\n    var deltaY = posY - this.scroll.scroller.scrollBehaviorY.currentPos;\r\n    if (!deltaX && !deltaY) {\r\n      return;\r\n    }\r\n    time = time === undefined ? this.getAnimateTime(deltaX, deltaY) : time;\r\n    this.page.changeCurrentPage({\r\n      x: posX,\r\n      y: posY,\r\n      pageX: newPageInfo.pageX,\r\n      pageY: newPageInfo.pageY\r\n    });\r\n    this.pageWillChangeTo(this.page.currentPage);\r\n    this.scroll.scroller.scrollTo(posX, posY, time, scrollEasing);\r\n  };\r\n  Slide.prototype.flickHandler = function () {\r\n    var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\r\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n    var deltaX = scrollBehaviorX.currentPos - scrollBehaviorX.startPos;\r\n    var deltaY = scrollBehaviorY.currentPos - scrollBehaviorY.startPos;\r\n    var time = this.getAnimateTime(deltaX, deltaY);\r\n    this.goTo(\r\n      this.page.currentPage.pageX + scrollBehaviorX.direction,\r\n      this.page.currentPage.pageY + scrollBehaviorY.direction,\r\n      time\r\n    );\r\n  };\r\n  Slide.prototype.getAnimateTime = function (deltaX, deltaY) {\r\n    if (this.slideOpt.speed) {\r\n      return this.slideOpt.speed;\r\n    }\r\n    return Math.max(Math.max(Math.min(Math.abs(deltaX), 1000), Math.min(Math.abs(deltaY), 1000)), 300);\r\n  };\r\n  Slide.prototype.modifyScrollMetaHandler = function (scrollMeta) {\r\n    var newPos = this.nearestPage(scrollMeta.newX, scrollMeta.newY);\r\n    scrollMeta.time = this.getAnimateTime(scrollMeta.newX - newPos.x, scrollMeta.newY - newPos.y);\r\n    scrollMeta.newX = newPos.x;\r\n    scrollMeta.newY = newPos.y;\r\n    scrollMeta.easing = this.slideOpt.easing || ease.bounce;\r\n    this.page.changeCurrentPage({\r\n      x: scrollMeta.newX,\r\n      y: scrollMeta.newY,\r\n      pageX: newPos.pageX,\r\n      pageY: newPos.pageY\r\n    });\r\n    this.pageWillChangeTo(this.page.currentPage);\r\n  };\r\n  Slide.prototype.scrollMoving = function (point) {\r\n    if (this.isTouching) {\r\n      var newPos = this.nearestPage(point.x, point.y);\r\n      this.pageWillChangeTo(newPos);\r\n    }\r\n  };\r\n  Slide.prototype.pageWillChangeTo = function (newPage) {\r\n    var changeToPage = this.page.getRealPage(newPage);\r\n    if (changeToPage.pageX === this.willChangeToPage.pageX && changeToPage.pageY === this.willChangeToPage.pageY) {\r\n      return;\r\n    }\r\n    this.willChangeToPage = changeToPage;\r\n    this.scroll.trigger('slideWillChange', this.willChangeToPage);\r\n  };\r\n  Slide.prototype.setTouchFlag = function () {\r\n    this.isTouching = true;\r\n  };\r\n  Slide.prototype.registorHooks = function (hooks, name, handler) {\r\n    hooks.on(name, handler, this);\r\n    this.hooksFn.push([hooks, name, handler]);\r\n  };\r\n  Slide.pluginName = 'slide';\r\n  return Slide;\r\n})();\r\n\r\nexport default Slide;\r\n","import BScroll from '@better-scroll/core';\r\nimport MouseWheel from '@better-scroll/mouse-wheel';\r\nimport ScrollBar from '@better-scroll/scroll-bar';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport Layout from '../../../layout';\r\nimport PointerListeners from '../../../pointerlisteners';\r\nimport { Noodl } from '../../../types';\r\nimport NestedScroll from './scroll-plugins/nested-scroll-plugin';\r\nimport patchedMomentum from './scroll-plugins/patched-momentum-scroll';\r\nimport Slide from './scroll-plugins/slide-scroll-plugin';\r\n\r\nBScroll.use(ScrollBar);\r\nBScroll.use(NestedScroll);\r\nBScroll.use(MouseWheel);\r\nBScroll.use(Slide);\r\n\r\nexport interface GroupProps extends Noodl.ReactProps {\r\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<unknown>;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  scrollSnapEnabled: boolean;\r\n  showScrollbar: boolean;\r\n  scrollEnabled: boolean;\r\n  nativeScroll: boolean;\r\n  scrollSnapToEveryItem: boolean;\r\n  flexWrap: 'nowrap' | 'wrap' | 'wrap-reverse';\r\n  scrollBounceEnabled: boolean;\r\n  clip: boolean;\r\n\r\n  layout: 'none' | 'row' | 'column';\r\n  dom;\r\n\r\n  onScrollPositionChanged?: (value: number) => void;\r\n  onScrollStart?: () => void;\r\n  onScrollEnd?: () => void;\r\n}\r\n\r\ntype ScrollRef = HTMLDivElement & { noodlNode?: Noodl.ReactProps['noodlNode'] };\r\n\r\nexport class Group extends React.Component<GroupProps> {\r\n  scrollNeedsToInit: boolean;\r\n  scrollRef: React.RefObject<ScrollRef>;\r\n  iScroll?: BScroll;\r\n\r\n  constructor(props: GroupProps) {\r\n    super(props);\r\n    this.scrollNeedsToInit = false;\r\n    this.scrollRef = React.createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (this.props.scrollEnabled && this.props.nativeScroll !== true) {\r\n      this.setupIScroll();\r\n    }\r\n\r\n    //plumbing for the focused signals\r\n    this.scrollRef.current.noodlNode = this.props.noodlNode;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.iScroll) {\r\n      this.iScroll.destroy();\r\n      this.iScroll = undefined;\r\n    }\r\n\r\n    this.props.noodlNode.context.setNodeFocused(this.props.noodlNode, false);\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    if (this.scrollNeedsToInit) {\r\n      this.setupIScroll();\r\n      this.scrollNeedsToInit = false;\r\n    }\r\n\r\n    if (this.iScroll) {\r\n      setTimeout(() => {\r\n        this.iScroll && this.iScroll.refresh();\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n  scrollToIndex(index, duration) {\r\n    if (this.iScroll) {\r\n      const child = this.scrollRef.current.children[0].children[index] as HTMLElement;\r\n      if (child) {\r\n        this.iScroll.scrollToElement(child, duration, 0, 0);\r\n      }\r\n    } else {\r\n      const child = this.scrollRef.current.children[index];\r\n      child &&\r\n        child.scrollIntoView({\r\n          behavior: 'smooth'\r\n        });\r\n    }\r\n  }\r\n\r\n  scrollToElement(noodlChild, duration) {\r\n    if (!noodlChild) return;\r\n    // eslint-disable-next-line react/no-find-dom-node\r\n    const element = ReactDOM.findDOMNode(noodlChild.getRef()) as HTMLElement;\r\n    if (element && element.scrollIntoView) {\r\n      if (this.iScroll) {\r\n        this.iScroll.scrollToElement(element, duration, 0, 0);\r\n      } else {\r\n        element.scrollIntoView({\r\n          behavior: 'smooth'\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  setupIScroll() {\r\n    const { scrollSnapEnabled } = this.props;\r\n    const scrollDirection = this.getScrollDirection();\r\n\r\n    const snapOptions = {\r\n      disableSetWidth: true,\r\n      disableSetHeight: true,\r\n      loop: false\r\n    };\r\n\r\n    const domElement = this.scrollRef.current;\r\n    this.iScroll = new BScroll(domElement, {\r\n      bounceTime: 500,\r\n      swipeBounceTime: 300,\r\n      scrollbar: this.props.showScrollbar ? {} : undefined,\r\n      momentum: scrollSnapEnabled ? !this.props.scrollSnapToEveryItem : true,\r\n      bounce: this.props.scrollBounceEnabled && !(scrollSnapEnabled && snapOptions.loop),\r\n      scrollX: scrollDirection === 'x' || scrollDirection === 'both',\r\n      scrollY: scrollDirection === 'y' || scrollDirection === 'both',\r\n      slide: scrollSnapEnabled ? snapOptions : undefined,\r\n      probeType: this.props.onScrollPositionChanged ? 3 : 1,\r\n      click: true,\r\n      nestedScroll: true,\r\n      //disable CSS animation, they can cause a flicker on iOS,\r\n      //and cause problems with probing the scroll position during an animation\r\n      useTransition: false\r\n    });\r\n\r\n    //the scroll behavior when doing a momentum scroll that reaches outside the bounds\r\n    //does a slow and unpleasant animation. Let's patch it to make it behave more like iScroll.\r\n    const scroller = this.iScroll.scroller;\r\n    // @ts-expect-error momentum does exist\r\n    scroller.scrollBehaviorX && (scroller.scrollBehaviorX.momentum = patchedMomentum.bind(scroller.scrollBehaviorX));\r\n    // @ts-expect-error momentum does exist\r\n    scroller.scrollBehaviorY && (scroller.scrollBehaviorY.momentum = patchedMomentum.bind(scroller.scrollBehaviorY));\r\n\r\n    //refresh the scroll view in case a child has changed height, e.g. an image loaded\r\n    //seem to be very performant, no observed problem so far\r\n    this.iScroll.on('beforeScrollStart', () => {\r\n      this.iScroll.refresh();\r\n    });\r\n\r\n    this.iScroll.on('scrollStart', () => {\r\n      this.props.onScrollStart && this.props.onScrollStart();\r\n    });\r\n\r\n    this.iScroll.on('scrollEnd', () => {\r\n      this.props.onScrollEnd && this.props.onScrollEnd();\r\n    });\r\n\r\n    if (this.props.onScrollPositionChanged) {\r\n      this.iScroll.on('scroll', () => {\r\n        this.props.onScrollPositionChanged(scrollDirection === 'x' ? -this.iScroll.x : -this.iScroll.y);\r\n      });\r\n    }\r\n  }\r\n\r\n  UNSAFE_componentWillReceiveProps(nextProps: GroupProps) {\r\n    const scrollHasUpdated =\r\n      this.props.scrollSnapEnabled !== nextProps.scrollSnapEnabled ||\r\n      this.props.onScrollPositionChanged !== nextProps.onScrollPositionChanged ||\r\n      this.props.onScrollStart !== nextProps.onScrollStart ||\r\n      this.props.onScrollEnd !== nextProps.onScrollEnd ||\r\n      this.props.showScrollbar !== nextProps.showScrollbar ||\r\n      this.props.scrollEnabled !== nextProps.scrollEnabled ||\r\n      this.props.nativeScroll !== nextProps.nativeScroll ||\r\n      this.props.scrollSnapToEveryItem !== nextProps.scrollSnapToEveryItem ||\r\n      this.props.layout !== nextProps.layout ||\r\n      this.props.flexWrap !== nextProps.flexWrap ||\r\n      this.props.scrollBounceEnabled !== nextProps.scrollBounceEnabled;\r\n\r\n    if (scrollHasUpdated) {\r\n      if (this.iScroll) {\r\n        this.iScroll.destroy();\r\n        this.iScroll = undefined;\r\n      }\r\n\r\n      this.scrollNeedsToInit = nextProps.scrollEnabled && !nextProps.nativeScroll;\r\n    }\r\n  }\r\n\r\n  renderIScroll() {\r\n    const { flexDirection, flexWrap } = this.props.style;\r\n\r\n    const childStyle: React.CSSProperties = {\r\n      display: 'inline-flex',\r\n      flexShrink: 0,\r\n      flexDirection,\r\n      flexWrap,\r\n      touchAction: 'none'\r\n      // pointerEvents: this.state.isScrolling ? 'none' : undefined\r\n    };\r\n\r\n    if (flexDirection === 'row') {\r\n      if (flexWrap === 'wrap') {\r\n        childStyle.width = '100%';\r\n      } else {\r\n        childStyle.height = '100%';\r\n      }\r\n    } else {\r\n      if (flexWrap === 'wrap') {\r\n        childStyle.height = '100%';\r\n      } else {\r\n        childStyle.width = '100%';\r\n      }\r\n    }\r\n\r\n    return (\r\n      <div className=\"scroll-wrapper-internal\" style={childStyle}>\r\n        {this.props.children}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getScrollDirection(): 'x' | 'y' | 'both' {\r\n    // TODO: This never returns both, why?\r\n\r\n    if (this.props.flexWrap === 'wrap' || this.props.flexWrap === 'wrap-reverse') {\r\n      return this.props.layout === 'row' ? 'y' : 'x';\r\n    }\r\n\r\n    return this.props.layout === 'row' ? 'x' : 'y';\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      as: Component = 'div',\r\n      ...props\r\n    } = this.props;\r\n\r\n    const children = props.scrollEnabled && !props.nativeScroll ? this.renderIScroll() : props.children;\r\n    \r\n    const style = { ...props.style };\r\n    Layout.size(style, props);\r\n    Layout.align(style, props);\r\n\r\n    if (props.clip) {\r\n      style.overflowX = 'hidden';\r\n      style.overflowY = 'hidden';\r\n    }\r\n\r\n    if (props.scrollEnabled && props.nativeScroll) {\r\n      const scrollDirection = this.getScrollDirection();\r\n      if (scrollDirection === 'y') {\r\n        style.overflowY = 'auto';\r\n      } else if (scrollDirection === 'x') {\r\n        style.overflowX = 'auto';\r\n      } else if (scrollDirection === 'both') {\r\n        style.overflowX = 'auto';\r\n        style.overflowY = 'auto';\r\n      }\r\n    }\r\n\r\n    if (style.opacity === 0) {\r\n      style.pointerEvents = 'none';\r\n    }\r\n\r\n    return (\r\n      <Component\r\n        // @ts-expect-error Lets hope that the type passed here is always static!\r\n        className={props.className}\r\n        {...props.attrs}\r\n        {...props.dom}\r\n        {...PointerListeners(props)}\r\n        style={style}\r\n        ref={this.scrollRef}\r\n      >\r\n        {children}\r\n      </Component>\r\n    );\r\n  }\r\n}\r\n","import { Group } from '../../components/visual/Group';\r\nimport { flexDirectionValues } from '../../constants/flex';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport { createTooltip } from '../../tooltips';\r\n\r\nconst GroupNode = {\r\n  name: 'Group',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/group',\r\n  connectionPanel: {\r\n    groupPriority: ['General', 'Style', 'Events', 'Mounted', 'Hover Events', 'Pointer Events', 'Focus', 'Scroll']\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n    this._internal = {\r\n      scrollElementDuration: 500,\r\n      scrollIndexDuration: 500,\r\n      scrollIndex: 0\r\n    };\r\n    this.props.layout = 'column';\r\n  },\r\n  getReactComponent() {\r\n    return Group;\r\n  },\r\n  noodlNodeAsProp: true,\r\n  visualStates: [\r\n    { name: 'neutral', label: 'Neutral' },\r\n    { name: 'hover', label: 'Hover' }\r\n  ],\r\n  defaultCss: {\r\n    display: 'flex',\r\n    position: 'relative',\r\n    flexDirection: 'column'\r\n  },\r\n  inputs: {\r\n    flexDirection: {\r\n      //don't rename for backwards compat\r\n      index: 12,\r\n      displayName: 'Layout',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'None', value: 'none' },\r\n          { label: 'Vertical', value: 'column' },\r\n          { label: 'Horizontal', value: 'row' }\r\n        ]\r\n      },\r\n      default: 'column',\r\n      set(value) {\r\n        this.props.layout = value;\r\n\r\n        if (value !== 'none') {\r\n          this.setStyle({ flexDirection: value });\r\n        } else {\r\n          this.removeStyle(['flexDirection']);\r\n        }\r\n\r\n        if (this.context.editorConnection) {\r\n          // Send warning if the value is wrong\r\n          if (value !== 'none' && !flexDirectionValues.includes(value)) {\r\n            this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'layout-warning', {\r\n              message: 'Invalid Layout value has to be a valid flex-direction value.'\r\n            });\r\n          } else {\r\n            this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'layout-warning');\r\n          }\r\n        }\r\n\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    'scrollToIndex.do': {\r\n      displayName: 'Scroll To Index - Do',\r\n      group: 'Scroll To Index',\r\n      type: 'signal',\r\n      index: 505,\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          if (!this.innerReactComponentRef) return;\r\n          const childIndex = this._internal.scrollIndex;\r\n          const duration = this._internal.scrollIndexDuration;\r\n          this.innerReactComponentRef.scrollToIndex(childIndex, duration);\r\n        });\r\n      }\r\n    },\r\n    'scrollToElement.do': {\r\n      displayName: 'Scroll To Element - Do',\r\n      group: 'Scroll To Element',\r\n      type: 'signal',\r\n      index: 500,\r\n      valueChangedToTrue() {\r\n        if (!this.innerReactComponentRef) return;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const element = this._internal.scrollElement;\r\n          const duration = this._internal.scrollElementDuration;\r\n          this.innerReactComponentRef.scrollToElement(element, duration);\r\n        });\r\n      }\r\n    },\r\n    'scrollToElement.element': {\r\n      displayName: 'Scroll To Element - Element',\r\n      group: 'Scroll To Element',\r\n      type: 'reference',\r\n      index: 501,\r\n      set(value) {\r\n        this._internal.scrollElement = value;\r\n      }\r\n    },\r\n    'scrollToElement.duration': {\r\n      displayName: 'Scroll To Element - Duration',\r\n      group: 'Scroll To Element',\r\n      type: 'number',\r\n      default: 500,\r\n      index: 502,\r\n      set(value) {\r\n        this._internal.scrollElementDuration = value;\r\n      }\r\n    },\r\n    'scrollToIndex.index': {\r\n      displayName: 'Scroll To Index - Index',\r\n      group: 'Scroll To Index',\r\n      type: 'number',\r\n      default: 0,\r\n      index: 506,\r\n      set(value) {\r\n        this._internal.scrollIndex = value;\r\n      }\r\n    },\r\n    'scrollToIndex.duration': {\r\n      displayName: 'Scroll To Index - Duration',\r\n      group: 'Scroll To Index',\r\n      type: 'number',\r\n      default: 500,\r\n      index: 507,\r\n      set(value) {\r\n        this._internal.scrollIndexDuration = value;\r\n      }\r\n    },\r\n    focus: {\r\n      displayName: 'Focus',\r\n      type: 'signal',\r\n      group: 'Focus',\r\n      valueChangedToTrue() {\r\n        this.context.setNodeFocused(this, true);\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputProps: {\r\n    clip: {\r\n      index: 19,\r\n      displayName: 'Clip Content',\r\n      type: 'boolean',\r\n      group: 'Layout',\r\n      default: false\r\n    },\r\n    scrollEnabled: {\r\n      index: 54,\r\n      group: 'Scroll',\r\n      displayName: 'Enable Scroll',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    scrollSnapEnabled: {\r\n      index: 55,\r\n      displayName: 'Snap',\r\n      group: 'Scroll',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    scrollSnapToEveryItem: {\r\n      index: 56,\r\n      displayName: 'Snap To Every Item',\r\n      group: 'Scroll',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    showScrollbar: {\r\n      index: 57,\r\n      displayName: 'Show Scrollbar',\r\n      group: 'Scroll',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    scrollBounceEnabled: {\r\n      index: 58,\r\n      displayName: 'Bounce at boundaries',\r\n      group: 'Scroll',\r\n      type: 'boolean',\r\n      default: true\r\n    },\r\n    nativeScroll: {\r\n      index: 60,\r\n      group: 'Scroll',\r\n      displayName: 'Native platform scroll',\r\n      type: 'boolean',\r\n      default: true\r\n    },\r\n    as: {\r\n      index: 100000,\r\n      group: 'Advanced HTML',\r\n      displayName: 'Tag',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: '<div>', value: 'div' },\r\n          { label: '<section>', value: 'section' },\r\n          { label: '<article>', value: 'article' },\r\n          { label: '<aside>', value: 'aside' },\r\n          { label: '<nav>', value: 'nav' },\r\n          { label: '<header>', value: 'header' },\r\n          { label: '<footer>', value: 'footer' },\r\n          { label: '<main>', value: 'main' },\r\n          { label: '<span>', value: 'span' }\r\n        ]\r\n      },\r\n      default: 'div'\r\n    }\r\n  },\r\n  inputCss: {\r\n    alignItems: {\r\n      index: 13,\r\n      group: 'Align and justify content',\r\n      displayName: 'Align Items',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Start', value: 'flex-start' },\r\n          { label: 'End', value: 'flex-end' },\r\n          { label: 'Center', value: 'center' }\r\n        ],\r\n        alignComp: 'align-items'\r\n      },\r\n      default: 'flex-start'\r\n    },\r\n    justifyContent: {\r\n      index: 14,\r\n      group: 'Align and justify content',\r\n      displayName: 'Justify Content',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Start', value: 'flex-start' },\r\n          { label: 'End', value: 'flex-end' },\r\n          { label: 'Center', value: 'center' },\r\n          { label: 'Space Between', value: 'space-between' },\r\n          { label: 'Space Around', value: 'space-around' },\r\n          { label: 'Space Evenly', value: 'space-evenly' }\r\n        ],\r\n        alignComp: 'justify-content'\r\n      },\r\n      default: 'flex-start',\r\n      applyDefault: false\r\n    },\r\n    flexWrap: {\r\n      index: 15,\r\n      displayName: 'Multi Line Wrap',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Off', value: 'nowrap' },\r\n          { label: 'On', value: 'wrap' },\r\n          { label: 'On Reverse', value: 'wrap-reverse' }\r\n        ]\r\n      },\r\n      default: 'nowrap',\r\n      onChange(value) {\r\n        this.props.flexWrap = value;\r\n        this.forceUpdate(); //scroll direction needs to be recomputed\r\n      },\r\n      applyDefault: false\r\n    },\r\n    alignContent: {\r\n      index: 16,\r\n      group: 'Layout',\r\n      displayName: 'Align Content',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Start', value: 'flex-start' },\r\n          { label: 'End', value: 'flex-end' },\r\n          { label: 'Center', value: 'center' },\r\n          { label: 'Space Between', value: 'space-between' },\r\n          { label: 'Space Around', value: 'space-around' },\r\n          { label: 'Space Evenly', value: 'space-evenly' }\r\n        ],\r\n        alignComp: 'align-content'\r\n      }\r\n      // default: 'flex-start'\r\n    },\r\n    rowGap: {\r\n      index: 17,\r\n      displayName: 'Vertical Gap',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', '%', 'em'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 0,\r\n      applyDefault: false\r\n    },\r\n    columnGap: {\r\n      index: 18,\r\n      displayName: 'Horizontal Gap',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', '%', 'em'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 0,\r\n      applyDefault: false\r\n    },\r\n    backgroundColor: {\r\n      index: 201,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: 'transparent',\r\n      applyDefault: false,\r\n      allowVisualStates: true\r\n    }\r\n  },\r\n  outputProps: {\r\n    onScrollPositionChanged: {\r\n      displayName: 'Scroll Position',\r\n      type: 'number',\r\n      group: 'Scroll'\r\n    },\r\n    onScrollStart: {\r\n      displayName: 'Scroll Start',\r\n      type: 'signal',\r\n      group: 'Scroll'\r\n    },\r\n    onScrollEnd: {\r\n      displayName: 'Scroll End',\r\n      type: 'signal',\r\n      group: 'Scroll'\r\n    }\r\n  },\r\n  outputs: {\r\n    focused: {\r\n      displayName: 'Focused',\r\n      type: 'signal',\r\n      group: 'Focus'\r\n    },\r\n    focusLost: {\r\n      displayName: 'Focus Lost',\r\n      type: 'signal',\r\n      group: 'Focus'\r\n    }\r\n  },\r\n  dynamicports: [\r\n    {\r\n      condition: 'flexDirection != none',\r\n      inputs: ['scrollEnabled']\r\n    },\r\n    {\r\n      condition: 'flexDirection != none AND scrollEnabled = true',\r\n      inputs: ['nativeScroll']\r\n    },\r\n    {\r\n      condition: 'flexDirection != none AND scrollEnabled = true AND nativeScroll = false',\r\n      inputs: [\r\n        'scrollBounceEnabled',\r\n        'scrollSnapEnabled',\r\n        'showScrollbar',\r\n        'scrollToElement.do',\r\n        'scrollToElement.element',\r\n        'scrollToElement.duration',\r\n        'scrollToIndex.do',\r\n        'scrollToIndex.index',\r\n        'scrollToIndex.duration'\r\n      ]\r\n    },\r\n    {\r\n      condition: 'flexDirection != none AND scrollEnabled = true AND scrollSnapEnabled = true',\r\n      inputs: ['scrollSnapToEveryItem']\r\n    },\r\n    {\r\n      condition: 'flexDirection != none',\r\n      inputs: ['flexWrap']\r\n    },\r\n    {\r\n      condition: 'flexWrap = wrap OR flexWrap = wrap-reverse',\r\n      inputs: ['alignContent']\r\n    },\r\n    {\r\n      condition: 'flexDirection = row OR flexWrap = wrap OR flexWrap = wrap-reverse',\r\n      inputs: ['columnGap']\r\n    },\r\n    {\r\n      condition: 'flexDirection = column OR flexWrap = wrap OR flexWrap = wrap-reverse',\r\n      inputs: ['rowGap']\r\n    }\r\n  ],\r\n  methods: {\r\n    _focus() {\r\n      this.sendSignalOnOutput('focused');\r\n    },\r\n    _blur() {\r\n      this.sendSignalOnOutput('focusLost');\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(GroupNode);\r\nNodeSharedPortDefinitions.addTransformInputs(GroupNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(GroupNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(GroupNode);\r\nNodeSharedPortDefinitions.addMarginInputs(GroupNode);\r\nNodeSharedPortDefinitions.addAlignInputs(GroupNode);\r\nNodeSharedPortDefinitions.addPointerEventOutputs(GroupNode);\r\nNodeSharedPortDefinitions.addBorderInputs(GroupNode);\r\nNodeSharedPortDefinitions.addShadowInputs(GroupNode);\r\n\r\nfunction defineTooltips(node) {\r\n  node.inputProps.clip.tooltip = createTooltip({\r\n    title: 'Clip content',\r\n    body: 'Controls if elements that are too big to fit will be clipped',\r\n    images: [\r\n      { src: 'clip-enabled.svg', label: 'Enabled' },\r\n      { src: 'clip-disabled.svg', label: 'Disabled' }\r\n    ]\r\n  });\r\n\r\n  node.inputCss.flexWrap.tooltip = createTooltip({\r\n    title: 'Multiline wrap',\r\n    body: \"Elements will wrap to the next line when there's not enough space\",\r\n    images: [\r\n      { src: 'multiline-h.svg', body: 'Using a horizontal layout' },\r\n      { src: 'multiline-v.svg', body: 'Using a vertical layout' }\r\n    ]\r\n  });\r\n}\r\n\r\n// eslint-disable-next-line no-undef\r\nif (!Noodl.runDeployed) {\r\n  defineTooltips(GroupNode);\r\n}\r\n\r\nexport default createNodeFromReactComponent(GroupNode);\r\n","import React from 'react';\r\n\r\nimport Layout from '../../../layout';\r\nimport { Noodl } from '../../../types';\r\n\r\nexport interface IconProps extends Noodl.ReactProps {\r\n  iconSourceType: 'image' | 'icon';\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n}\r\n\r\nexport function Icon(props: IconProps) {\r\n  const style: React.CSSProperties = { userSelect: 'none', ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  function _renderIcon() {\r\n    const style: React.CSSProperties = {};\r\n    if (props.iconSourceType === 'image' && props.iconImageSource !== undefined) {\r\n      style.width = props.iconSize;\r\n      style.height = props.iconSize;\r\n      return <img alt=\"\" src={props.iconImageSource} style={style} />;\r\n    } else if (props.iconSourceType === 'icon' && props.iconIconSource !== undefined) {\r\n      style.fontSize = props.iconSize;\r\n      style.color = props.iconColor;\r\n      style.lineHeight = 1;\r\n      return (\r\n        <div style={{ lineHeight: 0 }}>\r\n          {props.iconIconSource.codeAsClass === true ? (\r\n            <span className={[props.iconIconSource.class, props.iconIconSource.code].join(' ')} style={style}></span>\r\n          ) : (\r\n            <span className={props.iconIconSource.class} style={style}>\r\n              {props.iconIconSource.code}\r\n            </span>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  let className = 'ndl-visual-icon';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  return (\r\n    <div className={className} style={style}>\r\n      {_renderIcon()}\r\n    </div>\r\n  );\r\n}\r\n","import { Icon } from '../../components/visual/Icon';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst IconNode = {\r\n  name: 'net.noodl.visual.icon',\r\n  displayName: 'Icon',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/icon',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'States',\r\n      'Mounted',\r\n      'Hover Events',\r\n      'Pointer Events',\r\n      'Focus Events'\r\n    ]\r\n  },\r\n  getReactComponent() {\r\n    return Icon;\r\n  }\r\n};\r\nNodeSharedPortDefinitions.addAlignInputs(IconNode);\r\nNodeSharedPortDefinitions.addTransformInputs(IconNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(IconNode, {\r\n  defaults: {\r\n    paddingTop: 5,\r\n    paddingRight: 5,\r\n    paddingBottom: 5,\r\n    paddingLeft: 5\r\n  }\r\n});\r\nNodeSharedPortDefinitions.addMarginInputs(IconNode);\r\nNodeSharedPortDefinitions.addIconInputs(IconNode, {\r\n  hideEnableIconInput: true,\r\n  defaults: { useIcon: true }\r\n});\r\nNodeSharedPortDefinitions.addSharedVisualInputs(IconNode);\r\n\r\nexport default createNodeFromReactComponent(IconNode);\r\n","import React from 'react';\r\n\r\nimport Layout from '../../../layout';\r\nimport PointerListeners from '../../../pointerlisteners';\r\nimport { Noodl } from '../../../types';\r\n\r\nexport interface ImageProps extends Noodl.ReactProps {\r\n  dom: {\r\n    alt?: string;\r\n    src: string;\r\n    onLoad?: () => void;\r\n  };\r\n  attrs: React.Attributes;\r\n}\r\n\r\nexport function Image(props: ImageProps) {\r\n  const style = { ...props.style };\r\n\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (style.opacity === 0) {\r\n    style.pointerEvents = 'none';\r\n  }\r\n\r\n  if (props.dom?.src?.startsWith('/')) {\r\n    // @ts-expect-error missing Noodl typings\r\n    const baseUrl = Noodl.Env['BaseUrl'];\r\n    if (baseUrl) {\r\n      props.dom.src = baseUrl + props.dom.src.substring(1);\r\n    }\r\n  }\r\n\r\n  return <img {...props.attrs} className={props.className} {...props.dom} {...PointerListeners(props)} style={style} />;\r\n}\r\n","import { getAbsoluteUrl } from '@noodl/runtime/src/utils';\r\n\r\nimport { Image } from '../../components/visual/Image';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst ImageNode = {\r\n  name: 'Image',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/image',\r\n  noodlNodeAsProp: true,\r\n  visualStates: [\r\n    { name: 'neutral', label: 'Neutral' },\r\n    { name: 'hover', label: 'Hover' }\r\n  ],\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Image',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'Mounted',\r\n      'Pointer Events',\r\n      'Hover Events',\r\n      'Dimensions',\r\n      'Margin and padding'\r\n    ]\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n    this.props.default = '';\r\n  },\r\n  getReactComponent() {\r\n    return Image;\r\n  },\r\n  getInspectInfo() {\r\n    if (this.props.dom.srcSet) {\r\n      return this.props.dom.srcSet;\r\n    } else if (this.props.dom.src) {\r\n      const src = this.props.dom.src.toString();\r\n      return [\r\n        { type: 'text', value: src },\r\n        { type: 'image', value: src }\r\n      ];\r\n    }\r\n  },\r\n  allowChildren: false,\r\n  defaultCss: {\r\n    display: 'block',\r\n    flexShrink: 0\r\n  },\r\n  inputCss: {\r\n    objectFit: {\r\n      displayName: 'Image Fit',\r\n      group: 'Dimensions',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Fill', value: 'fill' },\r\n          { label: 'Contain', value: 'contain' },\r\n          { label: 'Cover', value: 'cover' },\r\n          { label: 'None', value: 'none' },\r\n          { label: 'Scale Down', value: 'scale-down' }\r\n        ]\r\n      },\r\n      default: 'contain',\r\n      allowVisualStates: true\r\n    }\r\n  },\r\n  dynamicports: [\r\n    {\r\n      condition: 'sizeMode = explicit',\r\n      inputs: ['objectFit']\r\n    }\r\n  ],\r\n  inputs: {\r\n    src: {\r\n      displayName: 'Source',\r\n      group: 'Image',\r\n      propPath: 'dom',\r\n      type: {\r\n        name: 'image'\r\n      },\r\n      index: 30,\r\n      allowVisualStates: true,\r\n      set(url) {\r\n        this.props.dom.src = getAbsoluteUrl(url);\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputProps: {\r\n    srcSet: {\r\n      displayName: 'Source Set',\r\n      group: 'Image',\r\n      propPath: 'dom',\r\n      type: {\r\n        name: 'string'\r\n      },\r\n      index: 31,\r\n      allowVisualStates: true\r\n    },\r\n    alt: {\r\n      displayName: 'Alternate text',\r\n      tooltip: \"The alt text is used by screen readers, or if the image can't be downloaded or displayed\",\r\n      type: 'string',\r\n      propPath: 'dom',\r\n      index: 1000,\r\n      default: ''\r\n    }\r\n  },\r\n  outputProps: {\r\n    onLoad: {\r\n      displayName: 'On Load',\r\n      propPath: 'dom',\r\n      type: 'signal',\r\n      group: 'Events'\r\n    },\r\n    onError: {\r\n      displayName: 'On Error',\r\n      propPath: 'dom',\r\n      type: 'signal',\r\n      group: 'Events'\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(ImageNode, {\r\n  defaultSizeMode: 'contentSize',\r\n  contentLabel: 'Image'\r\n});\r\nNodeSharedPortDefinitions.addTransformInputs(ImageNode);\r\nNodeSharedPortDefinitions.addMarginInputs(ImageNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(ImageNode);\r\nNodeSharedPortDefinitions.addAlignInputs(ImageNode);\r\nNodeSharedPortDefinitions.addPointerEventOutputs(ImageNode);\r\nNodeSharedPortDefinitions.addBorderInputs(ImageNode);\r\nNodeSharedPortDefinitions.addShadowInputs(ImageNode);\r\n\r\nexport default createNodeFromReactComponent(ImageNode);\r\n","import React from 'react';\r\n\r\nimport Layout from '../../../layout';\r\nimport PointerListeners from '../../../pointerlisteners';\r\nimport { Noodl } from '../../../types';\r\n\r\nexport interface TextProps extends Noodl.ReactProps {\r\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<unknown>;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  textStyle: Noodl.TextStyle;\r\n  text: string;\r\n\r\n  sizeMode?: Noodl.SizeMode;\r\n  width?: string;\r\n  height?: string;\r\n  fixedWidth?: boolean;\r\n  fixedHeight?: boolean;\r\n\r\n  // Extra Attributes\r\n  dom: Record<string, unknown>;\r\n}\r\n\r\nexport function Text(props: TextProps) {\r\n  const { as: Component = 'div' } = props;\r\n\r\n  const style = {\r\n    ...props.textStyle,\r\n    ...props.style\r\n  };\r\n\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  style.color = props.noodlNode.context.styles.resolveColor(style.color);\r\n\r\n  // Respect '\\n' in the string\r\n  if (props.sizeMode === 'contentSize' || props.sizeMode === 'contentWidth') {\r\n    style.whiteSpace = 'pre';\r\n  } else {\r\n    style.whiteSpace = 'pre-wrap';\r\n    style.overflowWrap = 'anywhere';\r\n  }\r\n\r\n  if (style.opacity === 0) {\r\n    style.pointerEvents = 'none';\r\n  }\r\n\r\n  return (\r\n    <Component\r\n      className={['ndl-visual-text', props.className].join(' ')}\r\n      {...props.attrs}\r\n      {...props.dom}\r\n      {...PointerListeners(props)}\r\n      style={style}\r\n    >\r\n      {String(props.text)}\r\n    </Component>\r\n  );\r\n}\r\n","import { Text } from '../../components/visual/Text';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport { createTooltip } from '../../tooltips';\r\n\r\nconst TextNode = {\r\n  name: 'Text',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/text',\r\n  visualStates: [\r\n    { name: 'neutral', label: 'Neutral' },\r\n    { name: 'hover', label: 'Hover' }\r\n  ],\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  usePortAsLabel: 'text',\r\n  portLabelTruncationMode: 'length',\r\n  connectionPanel: {\r\n    groupPriority: ['General', 'Text', 'Text Style', 'Style', 'Events', 'Mounted', 'Hover Events', 'Pointer Events']\r\n  },\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'text'\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n  },\r\n  getReactComponent() {\r\n    return Text;\r\n  },\r\n  getInspectInfo() {\r\n    return this.props.text;\r\n  },\r\n  defaultCss: {\r\n    position: 'relative',\r\n    display: 'flex'\r\n  },\r\n  inputProps: {\r\n    text: {\r\n      index: 19,\r\n      group: 'Text',\r\n      displayName: 'Text',\r\n      default: 'Text',\r\n      type: {\r\n        name: 'string',\r\n        multiline: true\r\n      }\r\n    },\r\n    as: {\r\n      index: 100000,\r\n      group: 'Advanced HTML',\r\n      displayName: 'Tag',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: '<div>', value: 'div' },\r\n          { label: '<h1>', value: 'h1' },\r\n          { label: '<h2>', value: 'h2' },\r\n          { label: '<h3>', value: 'h3' },\r\n          { label: '<h4>', value: 'h4' },\r\n          { label: '<h5>', value: 'h5' },\r\n          { label: '<h6>', value: 'h6' },\r\n          { label: '<p>', value: 'p' },\r\n          { label: '<span>', value: 'span' }\r\n          // { label: '<a>', value: 'a' },\r\n        ]\r\n      },\r\n      default: 'div'\r\n    }\r\n  },\r\n  inputCss: {\r\n    wordBreak: {\r\n      index: 27,\r\n      group: 'Text',\r\n      displayName: 'Word Break',\r\n      applyDefault: false,\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Normal', value: 'normal' },\r\n          { label: 'Break All', value: 'break-all' }\r\n        ]\r\n      },\r\n      default: 'normal'\r\n    }\r\n  },\r\n  inputs: {\r\n    textAlignX: {\r\n      group: 'Text Alignment',\r\n      index: 13,\r\n      displayName: 'Text Horizontal Align',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'left', value: 'left' },\r\n          { label: 'center', value: 'center' },\r\n          { label: 'right', value: 'right' }\r\n        ],\r\n        alignComp: 'justify'\r\n      },\r\n      default: 'left',\r\n      set(value) {\r\n        switch (value) {\r\n          case 'left':\r\n            this.setStyle({ textAlign: 'left', justifyContent: 'flex-start' });\r\n            break;\r\n          case 'center':\r\n            this.setStyle({ textAlign: 'center', justifyContent: 'center' });\r\n            break;\r\n          case 'right':\r\n            this.setStyle({ textAlign: 'right', justifyContent: 'flex-end' });\r\n            break;\r\n        }\r\n      }\r\n    },\r\n    textAlignY: {\r\n      group: 'Text Alignment',\r\n      index: 14,\r\n      displayName: 'Text Vertical Align',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Top', value: 'top' },\r\n          { label: 'Center', value: 'center' },\r\n          { label: 'Bottom', value: 'bottom' }\r\n        ],\r\n        alignComp: 'vertical'\r\n      },\r\n      default: 'top',\r\n      set(value) {\r\n        switch (value) {\r\n          case 'top':\r\n            this.setStyle({ alignItems: 'flex-start' });\r\n            break;\r\n          case 'center':\r\n            this.setStyle({ alignItems: 'center' });\r\n            break;\r\n          case 'bottom':\r\n            this.setStyle({ alignItems: 'flex-end' });\r\n            break;\r\n        }\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(TextNode, {\r\n  defaultSizeMode: 'contentHeight',\r\n  contentLabel: 'Text'\r\n});\r\nNodeSharedPortDefinitions.addTextStyleInputs(TextNode);\r\nNodeSharedPortDefinitions.addAlignInputs(TextNode);\r\nNodeSharedPortDefinitions.addTransformInputs(TextNode);\r\nNodeSharedPortDefinitions.addMarginInputs(TextNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(TextNode);\r\nNodeSharedPortDefinitions.addPointerEventOutputs(TextNode);\r\n\r\nfunction defineTooltips(node) {\r\n  node.inputCss.wordBreak.tooltip = createTooltip({\r\n    title: 'Word break',\r\n    body: [\r\n      'Control where line breaks are allowed',\r\n      '- Normal: Break on spaces and other whitespace characters',\r\n      '- Break All: Allow line breaks between any two characters, including inside words'\r\n    ]\r\n  });\r\n}\r\n\r\n// eslint-disable-next-line no-undef\r\nif (!Noodl.runDeployed) {\r\n  defineTooltips(TextNode);\r\n}\r\n\r\nexport default createNodeFromReactComponent(TextNode);\r\n","import React from 'react';\n\nimport Layout from '../../../layout';\nimport PointerListeners from '../../../pointerlisteners';\nimport { Noodl } from '../../../types';\n\nexport interface VideoProps extends Noodl.ReactProps {\n  objectPositionX: string;\n  objectPositionY: string;\n\n  dom: Exclude<CachedVideoProps, 'innerRef' | 'onCanPlay'>;\n\n  onCanPlay?: () => void;\n  videoWidth?: (value: number) => void;\n  videoHeight?: (value: number) => void;\n  onVideoElementCreated?: (video) => void;\n}\n\nexport interface CachedVideoProps {\n  className?: string;\n  style?: React.CSSProperties;\n\n  muted?: boolean;\n  loop?: boolean;\n  volume?: number;\n  autoplay?: boolean;\n  controls?: boolean;\n  src: string;\n\n  innerRef: (video: HTMLVideoElement) => void;\n  onCanPlay: () => void;\n}\n\nclass CachedVideo extends React.PureComponent<CachedVideoProps> {\n  video: HTMLVideoElement;\n\n  componentDidUpdate() {\n    if (this.video) {\n      this.video.muted = this.props.muted;\n      this.video.loop = this.props.loop;\n      this.video.volume = this.props.volume;\n      this.video.autoplay = this.props.autoplay;\n      this.video.controls = this.props.controls;\n    }\n  }\n\n  render() {\n    let src = this.props.src ? this.props.src.toString() : undefined;\n\n    if (src) {\n      if (src.indexOf('#t=') === -1) {\n        src += '#t=0.01'; //force Android to render the first frame\n      }\n      if (src.startsWith('/')) {\n        // @ts-expect-error missing Noodl typings\n        const baseUrl = Noodl.Env['BaseUrl'];\n        if (baseUrl) {\n          src = baseUrl + src.substring(1);\n        }\n      }\n    }\n\n    return (\n      <video\n        {...this.props}\n        playsInline={true}\n        src={src}\n        {...PointerListeners(this.props)}\n        ref={(video) => {\n          this.video = video;\n          this.props.innerRef(video);\n        }}\n      />\n    );\n  }\n}\n\nexport class Video extends React.Component<VideoProps> {\n  wantToPlay: boolean;\n  canPlay: boolean;\n  video: HTMLVideoElement;\n\n  constructor(props: VideoProps) {\n    super(props);\n\n    this.wantToPlay = false;\n    this.canPlay = false;\n  }\n\n  componentWillUnmount() {\n    this.canPlay = false;\n  }\n\n  setSourceObject(src) {\n    if (this.video.srcObject !== src) {\n      this.video.srcObject = src;\n      this.canPlay = false; //wait for can play event\n    }\n  }\n\n  play() {\n    this.wantToPlay = true;\n    if (this.canPlay) {\n      this.video.play();\n    }\n  }\n\n  restart() {\n    this.wantToPlay = true;\n    if (this.canPlay) {\n      this.video.currentTime = 0;\n      this.video.play();\n    }\n  }\n\n  pause() {\n    this.wantToPlay = false;\n    this.video && this.video.pause();\n  }\n\n  reset() {\n    this.wantToPlay = false;\n    if (this.video) {\n      this.video.currentTime = 0;\n      this.video.pause();\n    }\n  }\n\n  render() {\n    const props = this.props;\n    const style = {\n      ...props.style\n    };\n\n    Layout.size(style, props);\n    Layout.align(style, props);\n\n    if (style.opacity === 0) {\n      style.pointerEvents = 'none';\n    }\n\n    style.objectPosition = `${props.objectPositionX} ${props.objectPositionY}`;\n\n    return (\n      <CachedVideo\n        {...props.dom}\n        className={props.className}\n        style={style}\n        innerRef={(video) => {\n          this.video = video;\n          this.props.onVideoElementCreated && this.props.onVideoElementCreated(video);\n        }}\n        onCanPlay={() => {\n          this.canPlay = true;\n          if (this.wantToPlay) {\n            this.video.play();\n          }\n          this.props.onCanPlay && this.props.onCanPlay();\n          this.props.videoWidth && this.props.videoWidth(this.video.videoWidth);\n          this.props.videoHeight && this.props.videoHeight(this.video.videoHeight);\n        }}\n      />\n    );\n  }\n}\n","import { getAbsoluteUrl } from '@noodl/runtime/src/utils';\r\n\r\nimport { Video } from '../../components/visual/Video';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst VideoNode = {\r\n  name: 'Video',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/video',\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Video',\r\n      'Video Actions',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'Mounted',\r\n      'Playback',\r\n      'Pointer Events',\r\n      'Hover Events',\r\n      'Dimensions',\r\n      'Margin and padding'\r\n    ]\r\n  },\r\n  getReactComponent() {\r\n    return Video;\r\n  },\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  defaultCss: {\r\n    display: 'block'\r\n  },\r\n  inputs: {\r\n    srcObject: {\r\n      displayName: 'Source Object',\r\n      group: 'Video',\r\n      type: 'mediastream',\r\n      default: null,\r\n      set(value) {\r\n        this.innerReactComponentRef && this.innerReactComponentRef.setSourceObject(value);\r\n      }\r\n    },\r\n    play: {\r\n      type: 'signal',\r\n      group: 'Video Actions',\r\n      displayName: 'Play',\r\n      tooltip: {\r\n        standard: 'Play the video'\r\n      },\r\n      valueChangedToTrue() {\r\n        this.innerReactComponentRef && this.innerReactComponentRef.play();\r\n      }\r\n    },\r\n    restart: {\r\n      type: 'signal',\r\n      group: 'Video Actions',\r\n      displayName: 'Restart',\r\n      tooltip: {\r\n        standard: 'Restart the video from the beginning'\r\n      },\r\n      valueChangedToTrue() {\r\n        this.innerReactComponentRef && this.innerReactComponentRef.restart();\r\n      }\r\n    },\r\n    pause: {\r\n      type: 'boolean',\r\n      group: 'Video Actions',\r\n      displayName: 'Pause',\r\n      valueChangedToTrue() {\r\n        this.innerReactComponentRef && this.innerReactComponentRef.pause();\r\n      }\r\n    },\r\n    reset: {\r\n      type: 'boolean',\r\n      group: 'Video Actions',\r\n      displayName: 'Reset',\r\n      valueChangedToTrue() {\r\n        this.innerReactComponentRef && this.innerReactComponentRef.reset();\r\n      }\r\n    },\r\n    src: {\r\n      displayName: 'Source',\r\n      group: 'Video',\r\n      type: 'string',\r\n      set(src) {\r\n        this.props.dom.src = getAbsoluteUrl(src);\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    poster: {\r\n      displayName: 'Poster',\r\n      group: 'Video',\r\n      type: 'image',\r\n      set(src) {\r\n        this.props.dom.poster = getAbsoluteUrl(src);\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputProps: {\r\n    autoplay: {\r\n      displayName: 'Autoplay',\r\n      propPath: 'dom',\r\n      group: 'Video',\r\n      type: 'boolean'\r\n    },\r\n    controls: {\r\n      displayName: 'Controls',\r\n      propPath: 'dom',\r\n      group: 'Video',\r\n      type: 'boolean'\r\n    },\r\n    volume: {\r\n      displayName: 'Volume',\r\n      propPath: 'dom',\r\n      group: 'Video',\r\n      type: 'number',\r\n      default: 1\r\n    },\r\n    muted: {\r\n      displayName: 'Muted',\r\n      propPath: 'dom',\r\n      group: 'Video',\r\n      type: 'boolean'\r\n    },\r\n    loop: {\r\n      displayName: 'Loop',\r\n      propPath: 'dom',\r\n      group: 'Video',\r\n      type: 'boolean'\r\n    },\r\n    objectPositionX: {\r\n      displayName: 'Video Position X',\r\n      group: 'Video Layout',\r\n      type: {\r\n        name: 'number',\r\n        units: ['%', 'px'],\r\n        defaultUnit: '%'\r\n      },\r\n      default: 50\r\n    },\r\n    objectPositionY: {\r\n      displayName: 'Video Position Y',\r\n      group: 'Video Layout',\r\n      type: {\r\n        name: 'number',\r\n        units: ['%', 'px'],\r\n        defaultUnit: '%'\r\n      },\r\n      default: 50\r\n    }\r\n  },\r\n  inputCss: {\r\n    objectFit: {\r\n      displayName: 'Object Fit',\r\n      group: 'Video Layout',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          {\r\n            label: 'Contain',\r\n            value: 'contain'\r\n          },\r\n          {\r\n            label: 'Cover',\r\n            value: 'cover'\r\n          },\r\n          {\r\n            label: 'Fill',\r\n            value: 'fill'\r\n          },\r\n          {\r\n            label: 'None',\r\n            value: 'none'\r\n          }\r\n        ]\r\n      },\r\n      default: 'contain'\r\n    }\r\n  },\r\n  outputProps: {\r\n    onCanPlay: {\r\n      type: 'signal',\r\n      group: 'Events',\r\n      displayName: 'On Can Play'\r\n    },\r\n    onTimeUpdate: {\r\n      group: 'Playback',\r\n      displayName: 'Playback Position',\r\n      type: 'number',\r\n      propPath: 'dom',\r\n      getValue(event) {\r\n        return event.target.currentTime;\r\n      }\r\n    },\r\n    onPlay: {\r\n      group: 'Events',\r\n      displayName: 'On Play',\r\n      type: 'signal',\r\n      propPath: 'dom'\r\n    },\r\n    onPause: {\r\n      group: 'Events',\r\n      displayName: 'On Pause',\r\n      type: 'signal',\r\n      propPath: 'dom'\r\n    },\r\n    onVideoElementCreated: {\r\n      type: 'domelement',\r\n      displayName: 'DOM Element'\r\n    },\r\n    videoWidth: {\r\n      group: 'Playback',\r\n      type: 'number',\r\n      displayName: 'Video Width'\r\n    },\r\n    videoHeight: {\r\n      group: 'Playback',\r\n      type: 'number',\r\n      displayName: 'Video Height'\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(VideoNode, {\r\n  defaultSizeMode: 'contentSize',\r\n  contentLabel: 'Video'\r\n});\r\nNodeSharedPortDefinitions.addTransformInputs(VideoNode);\r\nNodeSharedPortDefinitions.addMarginInputs(VideoNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(VideoNode);\r\nNodeSharedPortDefinitions.addAlignInputs(VideoNode);\r\nNodeSharedPortDefinitions.addPointerEventOutputs(VideoNode);\r\nNodeSharedPortDefinitions.addBorderInputs(VideoNode);\r\n\r\nexport default createNodeFromReactComponent(VideoNode);\r\n","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./style.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","// Exports\nexport default {\n\t\"ndl-visual-text\": \"sRLD0J+nZ4sPvp36mrZsrg==\",\n\t\"ndl-controls-pointer\": \"ptcTI6fR7Un4i0FW+114oA==\",\n\t\"ndl-controls-abs-center\": \"jh5S+pf-gvwQxdq2aMQCAA==\",\n\t\"ndl-controls-button\": \"rfLUsb5TfiZaf4SPvSWDtg==\",\n\t\"ndl-controls-checkbox\": \"SwrhZDxQKb8HKvnyq9opVw==\",\n\t\"ndl-controls-radiobutton\": \"uneUU4h3Oyabzwi4bK7Knw==\",\n\t\"ndl-controls-radio-2\": \"nH35SOGmvnPuJruycnLFVQ==\",\n\t\"ndl-controls-checkbox-2\": \"Tz5djuOceu+FGL2g4IVizA==\",\n\t\"ndl-controls-select\": \"pkKqJQ-8t9bIvYJTgg+W9g==\",\n\t\"ndl-controls-range2\": \"uPPpBnbaVcf0cZ9ylfeVtQ==\",\n\t\"ndl-controls-range\": \"xF1eWIyuNixFE6fCWK0u8Q==\",\n\t\"ndl-controls-fieldset\": \"lZiuSOMZitj8oHTFRSGr6g==\",\n\t\"ndl-controls-textinput\": \"yis1iZ43jTTGG5t-wiOLXw==\"\n};\n","import PointerListeners from '../../pointerlisteners';\r\n\r\nfunction _shallowCompare(o1, o2) {\r\n  for (var p in o1) {\r\n    if (o1.hasOwnProperty(p)) {\r\n      if (o1[p] !== o2[p]) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  for (var p in o2) {\r\n    if (o2.hasOwnProperty(p)) {\r\n      if (o1[p] !== o2[p]) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nconst _styleSheets = {};\r\n\r\nfunction updateStylesForClass(_class, props, _styleTemplate) {\r\n  if (_styleSheets[_class]) {\r\n    // Check if props have changed\r\n    if (!_shallowCompare(props, _styleSheets[_class].props)) {\r\n      _styleSheets[_class].style.innerHTML = _styleTemplate(_class, props);\r\n      _styleSheets[_class].props = Object.assign({}, props);\r\n    }\r\n  } else {\r\n    // Create a new style sheet if none exists\r\n    var style = document.createElement('style');\r\n    style.innerHTML = _styleTemplate(_class, props);\r\n    document.head.appendChild(style);\r\n\r\n    _styleSheets[_class] = { style, props: Object.assign({}, props) };\r\n  }\r\n}\r\n\r\nfunction addInputCss(definition, inputs) {\r\n  if (!definition.inputCss) {\r\n    definition.inputCss = {};\r\n  }\r\n\r\n  if (!definition.defaultCss) {\r\n    definition.defaultCss = {};\r\n  }\r\n\r\n  for (const name in inputs) {\r\n    definition.inputCss[name] = inputs[name];\r\n    if (inputs[name].hasOwnProperty('default') && inputs[name].applyDefault !== false) {\r\n      definition.defaultCss[name] = inputs[name].default;\r\n    }\r\n  }\r\n}\r\n\r\nfunction mergeAttribute(definition, attribute, values) {\r\n  if (!definition[attribute]) {\r\n    definition[attribute] = {};\r\n  }\r\n\r\n  for (const name in values) {\r\n    definition[attribute][name] = values[name];\r\n  }\r\n}\r\n\r\nfunction addInputs(definition, values) {\r\n  mergeAttribute(definition, 'inputs', values);\r\n}\r\n\r\nfunction addInputProps(definition, values) {\r\n  mergeAttribute(definition, 'inputProps', values);\r\n}\r\n\r\nfunction addDynamicInputPorts(definition, condition, inputs) {\r\n  if (!definition.dynamicports) {\r\n    definition.dynamicports = [];\r\n  }\r\n\r\n  definition.dynamicports.push({ condition, inputs });\r\n}\r\n\r\nfunction addOutputProps(definition, values) {\r\n  mergeAttribute(definition, 'outputProps', values);\r\n}\r\n\r\nfunction addControlEventsAndStates(definition) {\r\n  addInputProps(definition, {\r\n    blockTouch: {\r\n      index: 450,\r\n      displayName: 'Block Pointer Events',\r\n      type: 'boolean'\r\n    }\r\n  });\r\n\r\n  addOutputProps(definition, {\r\n    // Focus\r\n    focusState: {\r\n      displayName: 'Focused',\r\n      group: 'States',\r\n      type: 'boolean',\r\n      props: {\r\n        onFocus() {\r\n          this.outputPropValues.focusState = true;\r\n          this.flagOutputDirty('focusState');\r\n          this.hasOutput('onFocus') && this.sendSignalOnOutput('onFocus');\r\n        },\r\n        onBlur() {\r\n          this.outputPropValues.focusState = false;\r\n          this.flagOutputDirty('focusState');\r\n          this.hasOutput('onBlur') && this.sendSignalOnOutput('onBlur');\r\n        }\r\n      }\r\n    },\r\n    onFocus: {\r\n      displayName: 'Focused',\r\n      group: 'Events',\r\n      type: 'signal',\r\n      props: {\r\n        onFocus() {\r\n          this.outputPropValues.focusState = true;\r\n          this.flagOutputDirty('focusState');\r\n          this.sendSignalOnOutput('onFocus');\r\n        }\r\n      }\r\n    },\r\n    onBlur: {\r\n      displayName: 'Blurred',\r\n      group: 'Events',\r\n      type: 'signal',\r\n      props: {\r\n        onBlur() {\r\n          this.outputPropValues.focusState = false;\r\n          this.flagOutputDirty('focusState');\r\n          this.sendSignalOnOutput('onBlur');\r\n        }\r\n      }\r\n    },\r\n\r\n    // Hover\r\n    hoverState: {\r\n      displayName: 'Hover',\r\n      group: 'States',\r\n      type: 'boolean',\r\n      props: {\r\n        onMouseOver() {\r\n          this.outputPropValues.hoverState = true;\r\n          this.flagOutputDirty('hoverState');\r\n          this.hasOutput('hoverStart') && this.sendSignalOnOutput('hoverStart');\r\n        },\r\n        onMouseLeave() {\r\n          this.outputPropValues.hoverState = false;\r\n          this.flagOutputDirty('hoverState');\r\n          this.hasOutput('hoverEnd') && this.sendSignalOnOutput('hoverEnd');\r\n        }\r\n      }\r\n    },\r\n    hoverStart: {\r\n      displayName: 'Hover Start',\r\n      group: 'Events',\r\n      type: 'signal',\r\n      props: {\r\n        onMouseOver() {\r\n          this.outputPropValues.hoverState = true;\r\n          this.flagOutputDirty('hoverState');\r\n          this.sendSignalOnOutput('hoverStart');\r\n        }\r\n      }\r\n    },\r\n    hoverEnd: {\r\n      displayName: 'Hover End',\r\n      group: 'Events',\r\n      type: 'signal',\r\n      props: {\r\n        onMouseLeave() {\r\n          this.outputPropValues.hoverState = false;\r\n          this.flagOutputDirty('hoverState');\r\n          this.sendSignalOnOutput('hoverEnd');\r\n        }\r\n      }\r\n    },\r\n\r\n    // Pressed\r\n    pressedState: {\r\n      displayName: 'Pressed',\r\n      group: 'States',\r\n      type: 'boolean',\r\n      props: {\r\n        onMouseDown() {\r\n          this.outputPropValues.pressedState = true;\r\n          this.flagOutputDirty('pressedState');\r\n          this.hasOutput('pointerDown') && this.sendSignalOnOutput('pointerDown');\r\n        },\r\n        onTouchStart() {\r\n          this.outputPropValues.pressedState = true;\r\n          this.flagOutputDirty('pressedState');\r\n          this.hasOutput('pointerDown') && this.sendSignalOnOutput('pointerDown');\r\n        },\r\n        onMouseUp() {\r\n          this.outputPropValues.pressedState = false;\r\n          this.flagOutputDirty('pressedState');\r\n          this.hasOutput('pointerUp') && this.sendSignalOnOutput('pointerUp');\r\n        },\r\n        onTouchEnd() {\r\n          this.outputPropValues.pressedState = false;\r\n          this.flagOutputDirty('pressedState');\r\n          this.hasOutput('pointerUp') && this.sendSignalOnOutput('pointerUp');\r\n        },\r\n        onTouchCancel() {\r\n          this.outputPropValues.pressedState = false;\r\n          this.flagOutputDirty('pressedState');\r\n          this.hasOutput('pointerUp') && this.sendSignalOnOutput('pointerUp');\r\n        }\r\n      }\r\n    },\r\n    pointerDown: {\r\n      displayName: 'Pointer Down',\r\n      group: 'Events',\r\n      type: 'signal',\r\n      props: {\r\n        onMouseDown() {\r\n          this.outputPropValues.pressedState = true;\r\n          this.flagOutputDirty('pressedState');\r\n          this.sendSignalOnOutput('pointerDown');\r\n        },\r\n        onTouchStart() {\r\n          this.outputPropValues.pressedState = true;\r\n          this.flagOutputDirty('pressedState');\r\n          this.sendSignalOnOutput('pointerDown');\r\n        }\r\n      }\r\n    },\r\n    pointerUp: {\r\n      displayName: 'Pointer Up',\r\n      group: 'Events',\r\n      type: 'signal',\r\n      props: {\r\n        onMouseUp() {\r\n          this.outputPropValues.pressedState = false;\r\n          this.flagOutputDirty('pressedState');\r\n          this.sendSignalOnOutput('pointerUp');\r\n        },\r\n        onTouchEnd() {\r\n          this.outputPropValues.pressedState = false;\r\n          this.flagOutputDirty('pressedState');\r\n          this.sendSignalOnOutput('pointerUp');\r\n        },\r\n        onTouchCancel() {\r\n          this.outputPropValues.pressedState = false;\r\n          this.flagOutputDirty('pressedState');\r\n          this.sendSignalOnOutput('pointerUp');\r\n        }\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nfunction controlEvents(props) {\r\n  return Object.assign(\r\n    {},\r\n    {\r\n      onFocus: props.onFocus,\r\n      onBlur: props.onBlur\r\n    },\r\n    PointerListeners(props)\r\n  );\r\n}\r\n\r\nexport default {\r\n  updateStylesForClass,\r\n  addControlEventsAndStates,\r\n  controlEvents\r\n};\r\n","import React, { useEffect } from 'react';\r\n\r\nimport FontLoader from '../../fontloader';\r\nimport guid from '../../guid';\r\nimport Layout from '../../layout';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Button\r\n// --------------------------------------------------------------------------------------\r\nfunction Button(props) {\r\n  // On mount\r\n  useEffect(() => {\r\n    props.focusChanged && props.focusChanged(false);\r\n    props.hoverChanged && props.hoverChanged(false);\r\n    props.pressedChanged && props.pressedChanged(false);\r\n  }, []);\r\n\r\n  var style = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (props.textStyle !== undefined) {\r\n    // Apply text style\r\n    style = Object.assign({}, props.textStyle, style);\r\n  }\r\n\r\n  if (props.boxShadowEnabled) {\r\n    style.boxShadow = `${props.boxShadowInset ? 'inset ' : ''}${props.boxShadowOffsetX} ${props.boxShadowOffsetY} ${\r\n      props.boxShadowBlurRadius\r\n    } ${props.boxShadowSpreadRadius} ${props.boxShadowColor}`;\r\n  }\r\n\r\n  let className = 'ndl-controls-button';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  return (\r\n    <button\r\n      className={className}\r\n      disabled={!props.enabled}\r\n      {...Utils.controlEvents(props)}\r\n      type={props.buttonType}\r\n      style={style}\r\n      onClick={props.onClick}\r\n    >\r\n      {props.label}\r\n      {props.children}\r\n    </button>\r\n  );\r\n}\r\n\r\nvar ButtonNode = {\r\n  name: 'Button',\r\n  docs: 'https://docs.noodl.net/nodes/visual/button',\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  initialize() {\r\n    this.outputPropValues.hoverState = this.outputPropValues.focusState = this.outputPropValues.pressedState = false;\r\n    this.props.id = this._internal.controlId = 'input-' + guid();\r\n    this.props.enabled = this._internal.enabled = true;\r\n  },\r\n  getReactComponent() {\r\n    return Button;\r\n  },\r\n  inputs: {\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'General',\r\n      default: true,\r\n      set: function (value) {\r\n        value = !!value;\r\n        const changed = value !== this._internal.enabled;\r\n        this.props.enabled = this._internal.enabled = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('enabled');\r\n        }\r\n      }\r\n    },\r\n\r\n    // Text style\r\n    textStyle: {\r\n      index: 20,\r\n      type: 'textStyle',\r\n      group: 'Text',\r\n      displayName: 'Text Style',\r\n      default: 'None',\r\n      set(value) {\r\n        this.props.textStyle = this.context.styles.getTextStyle(value);\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    fontFamily: {\r\n      index: 21,\r\n      type: 'font',\r\n      group: 'Text',\r\n      displayName: 'Font Family',\r\n      set(value) {\r\n        if (value) {\r\n          let family = value;\r\n          if (family.split('.').length > 1) {\r\n            family = family.replace(/\\.[^/.]+$/, '');\r\n            family = family.split('/').pop();\r\n          }\r\n          this.setStyle({ fontFamily: family });\r\n        } else {\r\n          this.removeStyle(['fontFamily']);\r\n        }\r\n\r\n        if (this.props.textStyle) {\r\n          this.forceUpdate();\r\n        }\r\n      }\r\n    }\r\n    /*  textAlignX: {\r\n            group: 'Text Alignment',\r\n            index: 13,\r\n            displayName: 'Text Horizontal Align',\r\n            type: {\r\n                name: 'enum',\r\n                enums: [\r\n                    {label: 'left', value: 'left'},\r\n                    {label: 'center', value: 'center'},\r\n                    {label: 'right', value: 'right'}\r\n                ],\r\n                alignComp: 'justify'\r\n            },\r\n            default: 'left',\r\n            set(value) {\r\n                switch(value) {\r\n                    case 'left': this.setStyle({textAlign: 'left', justifyContent: 'flex-start'}); break;\r\n                    case 'center': this.setStyle({textAlign: 'center', justifyContent: 'center'}); break;\r\n                    case 'right': this.setStyle({textAlign: 'right', justifyContent: 'flex-end'}); break;\r\n                }\r\n            }\r\n        },\r\n        textAlignY: {\r\n            group: 'Text Alignment',\r\n            index: 14,\r\n            displayName: 'Text Vertical Align',\r\n            type: {\r\n                name: 'enum',\r\n                enums: [\r\n                    {label: 'Top', value: 'top'},\r\n                    {label: 'Center', value: 'center'},\r\n                    {label: 'Bottom', value: 'bottom'}\r\n                ],\r\n                alignComp: 'vertical'\r\n            },\r\n            default: 'top',\r\n            set(value) {\r\n                switch(value) {\r\n                    case 'top': this.setStyle({alignItems: 'flex-start'}); break;\r\n                    case 'center': this.setStyle({alignItems: 'center'}); break;\r\n                    case 'bottom': this.setStyle({alignItems: 'flex-end'}); break;\r\n                }\r\n            }\r\n        }*/\r\n  },\r\n  outputs: {\r\n    controlId: {\r\n      type: 'string',\r\n      displayName: 'Control Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.controlId;\r\n      }\r\n    },\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.enabled;\r\n      }\r\n    }\r\n  },\r\n  inputCss: {\r\n    fontSize: {\r\n      index: 21,\r\n      group: 'Text',\r\n      displayName: 'Font Size',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      onChange() {\r\n        if (this.props.textStyle) {\r\n          this.forceUpdate();\r\n        }\r\n      }\r\n    },\r\n    color: {\r\n      index: 24,\r\n      group: 'Text',\r\n      displayName: 'Color',\r\n      type: 'color',\r\n      default: '#FFFFFF'\r\n    },\r\n    backgroundColor: {\r\n      index: 100,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: '#000000'\r\n    },\r\n\r\n    // Padding\r\n    paddingLeft: {\r\n      index: 64,\r\n      group: 'Margin and padding',\r\n      default: 20,\r\n      applyDefault: false,\r\n      displayName: 'Pad Left',\r\n      type: { name: 'number', units: ['px'], defaultUnit: 'px', marginPaddingComp: 'padding-left' }\r\n    },\r\n    paddingRight: {\r\n      index: 65,\r\n      group: 'Margin and padding',\r\n      default: 20,\r\n      applyDefault: false,\r\n      displayName: 'Pad Right',\r\n      type: { name: 'number', units: ['px'], defaultUnit: 'px', marginPaddingComp: 'padding-right' }\r\n    },\r\n    paddingTop: {\r\n      index: 66,\r\n      group: 'Margin and padding',\r\n      displayName: 'Pad Top',\r\n      default: 5,\r\n      applyDefault: false,\r\n      type: { name: 'number', units: ['px'], defaultUnit: 'px', marginPaddingComp: 'padding-top' }\r\n    },\r\n    paddingBottom: {\r\n      index: 67,\r\n      group: 'Margin and padding',\r\n      displayName: 'Pad Bottom',\r\n      default: 5,\r\n      applyDefault: false,\r\n      type: { name: 'number', units: ['px'], defaultUnit: 'px', marginPaddingComp: 'padding-bottom' }\r\n    },\r\n\r\n    // Border styles\r\n    borderRadius: {\r\n      index: 202,\r\n      displayName: 'Border Radius',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 0,\r\n      applyDefault: false\r\n    },\r\n    borderStyle: {\r\n      index: 203,\r\n      displayName: 'Border Style',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'None', value: 'none' },\r\n          { label: 'Solid', value: 'solid' },\r\n          { label: 'Dotted', value: 'dotted' },\r\n          { label: 'Dashed', value: 'dashed' }\r\n        ]\r\n      },\r\n      default: 'none',\r\n      applyDefault: false\r\n    },\r\n    borderWidth: {\r\n      index: 204,\r\n      displayName: 'Border Width',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 0,\r\n      applyDefault: false\r\n    },\r\n    borderColor: {\r\n      index: 205,\r\n      displayName: 'Border Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: '#000000'\r\n    }\r\n  },\r\n  inputProps: {\r\n    label: {\r\n      type: 'string',\r\n      displayName: 'Label',\r\n      group: 'General',\r\n      default: 'Label'\r\n    },\r\n    buttonType: {\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Button', value: 'button' },\r\n          { label: 'Submit', value: 'submit' }\r\n        ]\r\n      },\r\n      displayName: 'Type',\r\n      default: 'button',\r\n      group: 'General'\r\n    },\r\n\r\n    // Box shadow\r\n    boxShadowEnabled: {\r\n      index: 250,\r\n      group: 'Box Shadow',\r\n      displayName: 'Shadow Enabled',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    boxShadowOffsetX: {\r\n      index: 251,\r\n      group: 'Box Shadow',\r\n      displayName: 'Offset X',\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowOffsetY: {\r\n      index: 252,\r\n      group: 'Box Shadow',\r\n      displayName: 'Offset Y',\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowBlurRadius: {\r\n      index: 253,\r\n      group: 'Box Shadow',\r\n      displayName: 'Blur Radius',\r\n      default: 5,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowSpreadRadius: {\r\n      index: 254,\r\n      group: 'Box Shadow',\r\n      displayName: 'Spread Radius',\r\n      default: 2,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowInset: {\r\n      index: 255,\r\n      group: 'Box Shadow',\r\n      displayName: 'Inset',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    boxShadowColor: {\r\n      index: 256,\r\n      group: 'Box Shadow',\r\n      displayName: 'Shadow Color',\r\n      type: 'color',\r\n      default: 'rgba(0,0,0,0.2)'\r\n    }\r\n  },\r\n  outputProps: {\r\n    // Click\r\n    onClick: {\r\n      displayName: 'Click',\r\n      group: 'Events',\r\n      type: 'signal'\r\n    }\r\n  },\r\n  dynamicports: [\r\n    {\r\n      condition: 'boxShadowEnabled = true',\r\n      inputs: [\r\n        'boxShadowOffsetX',\r\n        'boxShadowOffsetY',\r\n        'boxShadowInset',\r\n        'boxShadowBlurRadius',\r\n        'boxShadowSpreadRadius',\r\n        'boxShadowColor'\r\n      ]\r\n    }\r\n  ],\r\n  methods: {}\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(ButtonNode, {\r\n  defaultSizeMode: 'contentSize',\r\n  contentLabel: 'Content',\r\n  useDimensionConstraints: false\r\n});\r\nNodeSharedPortDefinitions.addAlignInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addTransformInputs(ButtonNode);\r\n//NodeSharedPortDefinitions.addPaddingInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addMarginInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(ButtonNode);\r\nUtils.addControlEventsAndStates(ButtonNode);\r\n\r\nButtonNode = createNodeFromReactComponent(ButtonNode);\r\nButtonNode.setup = function (context, graphModel) {\r\n  graphModel.on('nodeAdded.Button', function (node) {\r\n    if (node.parameters.fontFamily && node.parameters.fontFamily.split('.').length > 1) {\r\n      FontLoader.instance.loadFont(node.parameters.fontFamily);\r\n    }\r\n    node.on('parameterUpdated', function (event) {\r\n      if (event.name === 'fontFamily' && event.value) {\r\n        if (event.value.split('.').length > 1) {\r\n          FontLoader.instance.loadFont(event.value);\r\n        }\r\n      }\r\n    });\r\n  });\r\n};\r\n\r\nexport default ButtonNode;\r\n","import React, { useEffect, useState } from 'react';\r\n\r\nimport guid from '../../guid';\r\nimport Layout from '../../layout';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\nfunction _styleTemplate(_class, props) {\r\n  return `\r\n    .${_class}:checked {\r\n        background-color: ${props.checkedBackgroundColor};\r\n    }  \r\n    `;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n// CheckBox\r\n// --------------------------------------------------------------------------------------\r\nfunction CheckBox(props) {\r\n  const [checked, setChecked] = useState(props.checked);\r\n\r\n  // Report initial values when mounted\r\n  useEffect(() => {\r\n    setChecked(!!props.checked);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setChecked(!!props.checked);\r\n  }, [props.checked]);\r\n\r\n  var style = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (props.boxShadowEnabled) {\r\n    style.boxShadow = `${props.boxShadowInset ? 'inset ' : ''}${props.boxShadowOffsetX} ${props.boxShadowOffsetY} ${\r\n      props.boxShadowBlurRadius\r\n    } ${props.boxShadowSpreadRadius} ${props.boxShadowColor}`;\r\n  }\r\n\r\n  const tagProps = { id: props.id, style: style };\r\n\r\n  Utils.updateStylesForClass(\r\n    'ndl-controls-checkbox-' + props._nodeId,\r\n    { checkedBackgroundColor: props.checkedBackgroundColor },\r\n    _styleTemplate\r\n  );\r\n\r\n  let className = 'ndl-controls-checkbox-' + props._nodeId + ' ndl-controls-checkbox';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  return (\r\n    <input\r\n      className={className}\r\n      type=\"checkbox\"\r\n      {...tagProps}\r\n      {...Utils.controlEvents(props)}\r\n      checked={checked}\r\n      disabled={!props.enabled}\r\n      onChange={(e) => {\r\n        setChecked(e.target.checked);\r\n        props.checkedChanged && props.checkedChanged(e.target.checked);\r\n      }}\r\n    ></input>\r\n  );\r\n}\r\n\r\nvar CheckBoxNode = {\r\n  name: 'Checkbox',\r\n  displayName: 'Checkbox',\r\n  docs: 'https://docs.noodl.net/nodes/visual/checkbox',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  initialize() {\r\n    this.props.sizeMode = 'explicit';\r\n    this.props.id = this._internal.controlId = 'input-' + guid();\r\n    this.props.enabled = this._internal.enabled = true;\r\n    this.props.checked = this._internal.checked = false;\r\n    this.props._nodeId = this.id;\r\n\r\n    this.outputPropValues.hoverState = this.outputPropValues.focusState = this.outputPropValues.pressedState = false;\r\n\r\n    this.props.checkedChanged = (checked) => {\r\n      const changed = this._internal.checked !== checked;\r\n      this._internal.checked = checked;\r\n      if (changed) {\r\n        this.flagOutputDirty('checked');\r\n        this.sendSignalOnOutput('onChange');\r\n      }\r\n    };\r\n  },\r\n  getReactComponent() {\r\n    return CheckBox;\r\n  },\r\n  inputs: {\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'General',\r\n      default: true,\r\n      set: function (value) {\r\n        value = !!value;\r\n        const changed = value !== this._internal.enabled;\r\n        this.props.enabled = this._internal.enabled = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('enabled');\r\n        }\r\n      }\r\n    },\r\n    checked: {\r\n      type: 'boolean',\r\n      displayName: 'Checked',\r\n      group: 'General',\r\n      default: false,\r\n      set: function (value) {\r\n        value = !!value;\r\n        const changed = value !== this._internal.checked;\r\n        this.props.checked = this._internal.checked = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('checked');\r\n        }\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    controlId: {\r\n      type: 'string',\r\n      displayName: 'Control Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.controlId;\r\n      }\r\n    },\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.enabled;\r\n      }\r\n    },\r\n    checked: {\r\n      type: 'boolean',\r\n      displayName: 'Checked',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.checked;\r\n      }\r\n    },\r\n    // Change\r\n    onChange: {\r\n      displayName: 'Changed',\r\n      group: 'Events',\r\n      type: 'signal'\r\n    }\r\n  },\r\n  inputProps: {\r\n    width: {\r\n      index: 11,\r\n      group: 'Dimensions',\r\n      displayName: 'Width',\r\n      type: {\r\n        name: 'number',\r\n        units: ['%', 'px', 'vw'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 32\r\n    },\r\n    height: {\r\n      index: 12,\r\n      group: 'Dimensions',\r\n      displayName: 'Height',\r\n      type: {\r\n        name: 'number',\r\n        units: ['%', 'px', 'vh'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 32\r\n    },\r\n\r\n    // Styles\r\n    checkedBackgroundColor: {\r\n      displayName: 'Background color',\r\n      group: 'Checked Style',\r\n      type: { name: 'color', allowEditOnly: true },\r\n      default: '#000000'\r\n    },\r\n\r\n    // Box shadow\r\n    boxShadowEnabled: {\r\n      index: 250,\r\n      group: 'Box Shadow',\r\n      displayName: 'Shadow Enabled',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    boxShadowOffsetX: {\r\n      index: 251,\r\n      group: 'Box Shadow',\r\n      displayName: 'Offset X',\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowOffsetY: {\r\n      index: 252,\r\n      group: 'Box Shadow',\r\n      displayName: 'Offset Y',\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowBlurRadius: {\r\n      index: 253,\r\n      group: 'Box Shadow',\r\n      displayName: 'Blur Radius',\r\n      default: 5,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowSpreadRadius: {\r\n      index: 254,\r\n      group: 'Box Shadow',\r\n      displayName: 'Spread Radius',\r\n      default: 2,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowInset: {\r\n      index: 255,\r\n      group: 'Box Shadow',\r\n      displayName: 'Inset',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    boxShadowColor: {\r\n      index: 256,\r\n      group: 'Box Shadow',\r\n      displayName: 'Shadow Color',\r\n      type: 'color',\r\n      default: 'rgba(0,0,0,0.2)'\r\n    }\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 201,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color'\r\n    },\r\n\r\n    // Border styles\r\n    borderRadius: {\r\n      index: 202,\r\n      displayName: 'Border Radius',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 2,\r\n      applyDefault: false\r\n    },\r\n    borderStyle: {\r\n      index: 203,\r\n      displayName: 'Border Style',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'None', value: 'none' },\r\n          { label: 'Solid', value: 'solid' },\r\n          { label: 'Dotted', value: 'dotted' },\r\n          { label: 'Dashed', value: 'dashed' }\r\n        ]\r\n      },\r\n      default: 'solid',\r\n      applyDefault: false\r\n    },\r\n    borderWidth: {\r\n      index: 204,\r\n      displayName: 'Border Width',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 1,\r\n      applyDefault: false\r\n    },\r\n    borderColor: {\r\n      index: 205,\r\n      displayName: 'Border Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: '#000000'\r\n    }\r\n  },\r\n  outputProps: {},\r\n  methods: {}\r\n};\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addTransformInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addMarginInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(CheckBoxNode);\r\nUtils.addControlEventsAndStates(CheckBoxNode);\r\n\r\nCheckBoxNode = createNodeFromReactComponent(CheckBoxNode);\r\nexport default CheckBoxNode;\r\n","import React from 'react';\r\n\r\nimport { flexDirectionValues } from '../../constants/flex';\r\nimport Layout from '../../layout';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nfunction FieldSet(props) {\r\n  var style = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  let className = 'ndl-controls-fieldset';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  return (\r\n    <fieldset className={className} style={style}>\r\n      {props.children}\r\n    </fieldset>\r\n  );\r\n}\r\n\r\nvar FieldSetNode = {\r\n  name: 'Field Set',\r\n  docs: 'https://docs.noodl.net/nodes/visual/fieldset',\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  deprecated: true,\r\n  initialize() {},\r\n  defaultCss: {\r\n    display: 'flex',\r\n    position: 'relative',\r\n    flexDirection: 'column'\r\n  },\r\n  getReactComponent() {\r\n    return FieldSet;\r\n  },\r\n  inputs: {\r\n    flexDirection: {\r\n      //don't rename for backwards compat\r\n      index: 11,\r\n      displayName: 'Layout',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Vertical', value: 'column' },\r\n          { label: 'Horizontal', value: 'row' }\r\n        ]\r\n      },\r\n      default: 'column',\r\n      set(value) {\r\n        this.props.layout = value;\r\n\r\n        if (value !== 'none') {\r\n          this.setStyle({ flexDirection: value });\r\n        } else {\r\n          this.removeStyle(['flexDirection']);\r\n        }\r\n\r\n        if (this.context.editorConnection) {\r\n          // Send warning if the value is wrong\r\n          if (value !== 'none' && !flexDirectionValues.includes(value)) {\r\n            this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'layout-warning', {\r\n              message: 'Invalid Layout value has to be a valid flex-direction value.'\r\n            });\r\n          } else {\r\n            this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'layout-warning');\r\n          }\r\n        }\r\n\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputProps: {},\r\n  outputProps: {}\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(FieldSetNode, { defaultSizeMode: 'contentSize', contentLabel: 'Content' });\r\nNodeSharedPortDefinitions.addAlignInputs(FieldSetNode);\r\nNodeSharedPortDefinitions.addTransformInputs(FieldSetNode);\r\nNodeSharedPortDefinitions.addMarginInputs(FieldSetNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(FieldSetNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(FieldSetNode);\r\n\r\nFieldSetNode = createNodeFromReactComponent(FieldSetNode);\r\nexport default FieldSetNode;\r\n","import React from 'react';\r\n\r\nimport { flexDirectionValues } from '../../constants/flex';\r\nimport Layout from '../../layout';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nfunction Form(props) {\r\n  var style = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  let className = 'ndl-controls-form';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  return (\r\n    <form\r\n      className={className}\r\n      style={style}\r\n      onSubmit={(e) => {\r\n        e.preventDefault();\r\n        props.onSubmit && props.onSubmit();\r\n      }}\r\n    >\r\n      {props.children}\r\n    </form>\r\n  );\r\n}\r\n\r\nvar FormNode = {\r\n  name: 'Form',\r\n  docs: 'https://docs.noodl.net/nodes/visual/form',\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  deprecated: true,\r\n  initialize() {},\r\n  defaultCss: {\r\n    display: 'flex',\r\n    position: 'relative',\r\n    flexDirection: 'column'\r\n  },\r\n  getReactComponent() {\r\n    return Form;\r\n  },\r\n  inputs: {\r\n    flexDirection: {\r\n      //don't rename for backwards compat\r\n      index: 11,\r\n      displayName: 'Layout',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'None', value: 'none' },\r\n          { label: 'Vertical', value: 'column' },\r\n          { label: 'Horizontal', value: 'row' }\r\n        ]\r\n      },\r\n      default: 'column',\r\n      set(value) {\r\n        this.props.layout = value;\r\n\r\n        if (value !== 'none') {\r\n          this.setStyle({ flexDirection: value });\r\n        } else {\r\n          this.removeStyle(['flexDirection']);\r\n        }\r\n\r\n        if (this.context.editorConnection) {\r\n          // Send warning if the value is wrong\r\n          if (value !== 'none' && !flexDirectionValues.includes(value)) {\r\n            this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'layout-warning', {\r\n              message: 'Invalid Layout value has to be a valid flex-direction value.'\r\n            });\r\n          } else {\r\n            this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'layout-warning');\r\n          }\r\n        }\r\n\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputProps: {},\r\n  outputProps: {\r\n    onSubmit: { type: 'signal', displayName: 'Submit', group: 'Events' }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(FormNode, { defaultSizeMode: 'contentSize', contentLabel: 'Content' });\r\nNodeSharedPortDefinitions.addAlignInputs(FormNode);\r\nNodeSharedPortDefinitions.addTransformInputs(FormNode);\r\nNodeSharedPortDefinitions.addMarginInputs(FormNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(FormNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(FormNode);\r\n\r\nFormNode = createNodeFromReactComponent(FormNode);\r\nexport default FormNode;\r\n","import React from 'react';\r\n\r\nimport Layout from '../../layout';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nfunction Label(props) {\r\n  var style = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (props.textStyle !== undefined) {\r\n    // Apply text style\r\n    style = Object.assign({}, props.textStyle, style);\r\n  }\r\n\r\n  const tagProps = {\r\n    for: props.for,\r\n    onClick: props.onClick\r\n  };\r\n\r\n  let className = 'ndl-controls-label';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  return (\r\n    <label className={className} style={style} {...tagProps}>\r\n      {props.text}\r\n    </label>\r\n  );\r\n}\r\n\r\nconst LabelNode = {\r\n  name: 'Label',\r\n  displayName: 'Label',\r\n  docs: 'https://docs.noodl.net/nodes/visual/label',\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  deprecated: true,\r\n  getReactComponent() {\r\n    return Label;\r\n  },\r\n  defaultCss: {\r\n    position: 'relative',\r\n    display: 'flex'\r\n  },\r\n  inputProps: {\r\n    for: { type: 'string', displayName: 'For', group: 'General' },\r\n    text: { type: 'string', displayName: 'Text', group: 'General' }\r\n  }\r\n};\r\nNodeSharedPortDefinitions.addDimensions(LabelNode, { defaultSizeMode: 'contentSize', contentLabel: 'Content' });\r\nNodeSharedPortDefinitions.addAlignInputs(LabelNode);\r\nNodeSharedPortDefinitions.addTextStyleInputs(LabelNode);\r\nNodeSharedPortDefinitions.addTransformInputs(LabelNode);\r\n//NodeSharedPortDefinitions.addPaddingInputs(LabelNode);\r\nNodeSharedPortDefinitions.addMarginInputs(LabelNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(LabelNode);\r\nNodeSharedPortDefinitions.addBorderInputs(LabelNode);\r\n\r\nexport default createNodeFromReactComponent(LabelNode);\r\n","import React, { useEffect, useState } from 'react';\r\n\r\nimport FontLoader from '../../fontloader';\r\nimport guid from '../../guid';\r\nimport Layout from '../../layout';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\nfunction Options(props) {\r\n  const [value, setValue] = useState(props.value);\r\n\r\n  // Must update value output on both \"mount\" and when it's changed\r\n  useEffect(() => {\r\n    setValue(props.value);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setValue(props.value);\r\n  }, [props.value]);\r\n\r\n  var style = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (props.textStyle !== undefined) {\r\n    // Apply text style\r\n    style = Object.assign({}, props.textStyle, style);\r\n  }\r\n\r\n  if (props.boxShadowEnabled) {\r\n    style.boxShadow = `${props.boxShadowInset ? 'inset ' : ''}${props.boxShadowOffsetX} ${props.boxShadowOffsetY} ${\r\n      props.boxShadowBlurRadius\r\n    } ${props.boxShadowSpreadRadius} ${props.boxShadowColor}`;\r\n  }\r\n\r\n  // Hide label if there is no selected value, of if value is not in the items array\r\n  const selectedIndex =\r\n    value === undefined || value === ''\r\n      ? -1\r\n      : props.items === undefined\r\n      ? -1\r\n      : props.items.findIndex((i) => i.Value === value);\r\n\r\n  const tagProps = { id: props.id, style: style, onClick: props.onClick };\r\n\r\n  let className = 'ndl-controls-select';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  return (\r\n    <select\r\n      className={className}\r\n      ref={(el) => {\r\n        if (el) el.selectedIndex = selectedIndex;\r\n      }}\r\n      {...tagProps}\r\n      disabled={!props.enabled}\r\n      value={value}\r\n      {...Utils.controlEvents(props)}\r\n      onChange={(e) => {\r\n        setValue(e.target.value);\r\n        props.valueChanged && props.valueChanged(e.target.value);\r\n      }}\r\n    >\r\n      {props.items !== undefined\r\n        ? props.items.map((i) => (\r\n            <option\r\n              value={i.Value}\r\n              disabled={i.Disabled === 'true' || i.Disabled === true ? true : undefined}\r\n              selected={i.Value === value}\r\n            >\r\n              {i.Label}\r\n            </option>\r\n          ))\r\n        : null}\r\n    </select>\r\n  );\r\n}\r\n\r\nvar OptionsNode = {\r\n  name: 'Options',\r\n  displayName: 'Options',\r\n  docs: 'https://docs.noodl.net/nodes/visual/options',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  initialize: function () {\r\n    this._itemsChanged = () => {\r\n      this.forceUpdate();\r\n    };\r\n\r\n    this.props.id = this._internal.controlId = 'input-' + guid();\r\n    this.props.enabled = this._internal.enabled = true;\r\n\r\n    this.outputPropValues.hoverState = this.outputPropValues.focusState = this.outputPropValues.pressedState = false;\r\n\r\n    this.props.valueChanged = (value) => {\r\n      const changed = this._internal.value !== value;\r\n      this._internal.value = value;\r\n      if (changed) {\r\n        this.flagOutputDirty('value');\r\n        this.sendSignalOnOutput('onChange');\r\n      }\r\n    };\r\n  },\r\n  getReactComponent() {\r\n    return Options;\r\n  },\r\n  inputs: {\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'General',\r\n      default: true,\r\n      set: function (value) {\r\n        value = !!value;\r\n        const changed = value !== this._internal.enabled;\r\n        this.props.enabled = this._internal.enabled = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('enabled');\r\n        }\r\n      }\r\n    },\r\n    items: {\r\n      type: 'array',\r\n      displayName: 'Items',\r\n      group: 'General',\r\n      set: function (newValue) {\r\n        if (this._internal.items !== newValue && this._internal.items !== undefined) {\r\n          this._internal.items.off('change', this._itemsChanged);\r\n        }\r\n        this._internal.items = newValue;\r\n        this._internal.items.on('change', this._itemsChanged);\r\n\r\n        this.props.items = this._internal.items;\r\n      }\r\n    },\r\n    value: {\r\n      type: '*',\r\n      displayName: 'Value',\r\n      group: 'General',\r\n      set: function (value) {\r\n        if (value !== undefined && typeof value !== 'string') {\r\n          if (value.toString !== undefined) value = value.toString();\r\n          else return;\r\n        }\r\n\r\n        const changed = value !== this._internal.value;\r\n        this.props.value = this._internal.value = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('value');\r\n        }\r\n      }\r\n    },\r\n\r\n    // Text style\r\n    textStyle: {\r\n      index: 20,\r\n      type: 'textStyle',\r\n      group: 'Text',\r\n      displayName: 'Text Style',\r\n      default: 'None',\r\n      set(value) {\r\n        this.props.textStyle = this.context.styles.getTextStyle(value);\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    fontFamily: {\r\n      index: 21,\r\n      type: 'font',\r\n      group: 'Text',\r\n      displayName: 'Font Family',\r\n      set(value) {\r\n        if (value) {\r\n          let family = value;\r\n          if (family.split('.').length > 1) {\r\n            family = family.replace(/\\.[^/.]+$/, '');\r\n            family = family.split('/').pop();\r\n          }\r\n          this.setStyle({ fontFamily: family });\r\n        } else {\r\n          this.removeStyle(['fontFamily']);\r\n        }\r\n\r\n        if (this.props.textStyle) {\r\n          this.forceUpdate();\r\n        }\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    controlId: {\r\n      type: 'string',\r\n      displayName: 'Control Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.controlId;\r\n      }\r\n    },\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.enabled;\r\n      }\r\n    },\r\n    value: {\r\n      type: 'string',\r\n      displayName: 'Value',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.value;\r\n      }\r\n    },\r\n    onChange: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  inputCss: {\r\n    fontSize: {\r\n      index: 21,\r\n      group: 'Text',\r\n      displayName: 'Font Size',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      onChange() {\r\n        if (this.props.textStyle) {\r\n          this.forceUpdate();\r\n        }\r\n      }\r\n    },\r\n    color: {\r\n      index: 24,\r\n      group: 'Text',\r\n      displayName: 'Color',\r\n      type: 'color'\r\n    },\r\n    backgroundColor: {\r\n      index: 100,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: 'transparent'\r\n    },\r\n\r\n    // Border styles\r\n    borderRadius: {\r\n      index: 202,\r\n      displayName: 'Border Radius',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 0,\r\n      applyDefault: false\r\n    },\r\n    borderStyle: {\r\n      index: 203,\r\n      displayName: 'Border Style',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'None', value: 'none' },\r\n          { label: 'Solid', value: 'solid' },\r\n          { label: 'Dotted', value: 'dotted' },\r\n          { label: 'Dashed', value: 'dashed' }\r\n        ]\r\n      },\r\n      default: 'solid',\r\n      applyDefault: false\r\n    },\r\n    borderWidth: {\r\n      index: 204,\r\n      displayName: 'Border Width',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 1,\r\n      applyDefault: false\r\n    },\r\n    borderColor: {\r\n      index: 205,\r\n      displayName: 'Border Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: '#000000'\r\n    }\r\n  },\r\n  inputProps: {\r\n    // Box shadow\r\n    boxShadowEnabled: {\r\n      index: 250,\r\n      group: 'Box Shadow',\r\n      displayName: 'Shadow Enabled',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    boxShadowOffsetX: {\r\n      index: 251,\r\n      group: 'Box Shadow',\r\n      displayName: 'Offset X',\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowOffsetY: {\r\n      index: 252,\r\n      group: 'Box Shadow',\r\n      displayName: 'Offset Y',\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowBlurRadius: {\r\n      index: 253,\r\n      group: 'Box Shadow',\r\n      displayName: 'Blur Radius',\r\n      default: 5,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowSpreadRadius: {\r\n      index: 254,\r\n      group: 'Box Shadow',\r\n      displayName: 'Spread Radius',\r\n      default: 2,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowInset: {\r\n      index: 255,\r\n      group: 'Box Shadow',\r\n      displayName: 'Inset',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    boxShadowColor: {\r\n      index: 256,\r\n      group: 'Box Shadow',\r\n      displayName: 'Shadow Color',\r\n      type: 'color',\r\n      default: 'rgba(0,0,0,0.2)'\r\n    }\r\n  },\r\n  outputProps: {},\r\n  dynamicports: [\r\n    {\r\n      condition: 'boxShadowEnabled = true',\r\n      inputs: [\r\n        'boxShadowOffsetX',\r\n        'boxShadowOffsetY',\r\n        'boxShadowInset',\r\n        'boxShadowBlurRadius',\r\n        'boxShadowSpreadRadius',\r\n        'boxShadowColor'\r\n      ]\r\n    }\r\n  ],\r\n  methods: {}\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(OptionsNode, { defaultSizeMode: 'contentSize', contentLabel: 'Content' });\r\nNodeSharedPortDefinitions.addAlignInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addTransformInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addMarginInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(OptionsNode);\r\nUtils.addControlEventsAndStates(OptionsNode);\r\n\r\nOptionsNode = createNodeFromReactComponent(OptionsNode);\r\nOptionsNode.setup = function (context, graphModel) {\r\n  graphModel.on('nodeAdded.Options', function (node) {\r\n    if (node.parameters.fontFamily && node.parameters.fontFamily.split('.').length > 1) {\r\n      FontLoader.instance.loadFont(node.parameters.fontFamily);\r\n    }\r\n    node.on('parameterUpdated', function (event) {\r\n      if (event.name === 'fontFamily' && event.value) {\r\n        if (event.value.split('.').length > 1) {\r\n          FontLoader.instance.loadFont(event.value);\r\n        }\r\n      }\r\n    });\r\n  });\r\n};\r\n\r\nexport default OptionsNode;\r\n","import React, { useContext } from 'react';\r\n\r\nimport RadioButtonContext from '../../contexts/radiobuttoncontext';\r\nimport guid from '../../guid';\r\nimport Layout from '../../layout';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\nfunction _styleTemplate(_class, props) {\r\n  return `\r\n    .${_class}:checked {\r\n        background-color: ${props.checkedBackgroundColor};\r\n    }  \r\n    `;\r\n}\r\n\r\nfunction RadioButton(props) {\r\n  const radioButtonGroup = useContext(RadioButtonContext);\r\n\r\n  var style = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (props.boxShadowEnabled) {\r\n    style.boxShadow = `${props.boxShadowInset ? 'inset ' : ''}${props.boxShadowOffsetX} ${props.boxShadowOffsetY} ${\r\n      props.boxShadowBlurRadius\r\n    } ${props.boxShadowSpreadRadius} ${props.boxShadowColor}`;\r\n  }\r\n\r\n  const tagProps = { id: props.id, style: style };\r\n\r\n  props.checkedChanged && props.checkedChanged(radioButtonGroup ? radioButtonGroup.selected === props.value : false);\r\n\r\n  Utils.updateStylesForClass(\r\n    'ndl-controls-radiobutton-' + props._nodeId,\r\n    { checkedBackgroundColor: props.checkedBackgroundColor },\r\n    _styleTemplate\r\n  );\r\n\r\n  let className = 'ndl-controls-radiobutton-' + props._nodeId + ' ndl-controls-radiobutton';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  return (\r\n    <input\r\n      className={className}\r\n      {...Utils.controlEvents(props)}\r\n      type=\"radio\"\r\n      name={radioButtonGroup ? radioButtonGroup.name : undefined}\r\n      {...tagProps}\r\n      disabled={!props.enabled}\r\n      checked={radioButtonGroup ? radioButtonGroup.selected === props.value : false}\r\n      onChange={(e) => {\r\n        radioButtonGroup && radioButtonGroup.checkedChanged && radioButtonGroup.checkedChanged(props.value);\r\n      }}\r\n    ></input>\r\n  );\r\n}\r\n\r\nvar RadioButtonNode = {\r\n  name: 'Radio Button',\r\n  displayName: 'Radio Button',\r\n  docs: 'https://docs.noodl.net/nodes/visual/radiobutton',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  initialize() {\r\n    this.props.sizeMode = 'explicit';\r\n    this.props.id = this._internal.controlId = 'input-' + guid();\r\n    this.props.enabled = this._internal.enabled = true;\r\n    this.props._nodeId = this.id;\r\n    this._internal.checked = false;\r\n\r\n    this.outputPropValues.hoverState = this.outputPropValues.focusState = this.outputPropValues.pressedState = false;\r\n\r\n    this.props.checkedChanged = (checked) => {\r\n      const changed = this._internal.checked !== checked;\r\n      this._internal.checked = checked;\r\n      if (changed) {\r\n        this.flagOutputDirty('checked');\r\n      }\r\n    };\r\n  },\r\n  getReactComponent() {\r\n    return RadioButton;\r\n  },\r\n  inputs: {\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'General',\r\n      default: true,\r\n      set: function (value) {\r\n        value = !!value;\r\n        const changed = value !== this._internal.enabled;\r\n        this.props.enabled = this._internal.enabled = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('enabled');\r\n        }\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    controlId: {\r\n      type: 'string',\r\n      displayName: 'Control Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.controlId;\r\n      }\r\n    },\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.enabled;\r\n      }\r\n    },\r\n    checked: {\r\n      type: 'boolean',\r\n      displayName: 'Checked',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.checked;\r\n      }\r\n    }\r\n  },\r\n  inputProps: {\r\n    value: { type: 'string', displayName: 'Value', group: 'General' },\r\n    width: {\r\n      index: 11,\r\n      group: 'Dimensions',\r\n      displayName: 'Width',\r\n      type: {\r\n        name: 'number',\r\n        units: ['%', 'px', 'vw'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 32\r\n    },\r\n    height: {\r\n      index: 12,\r\n      group: 'Dimensions',\r\n      displayName: 'Height',\r\n      type: {\r\n        name: 'number',\r\n        units: ['%', 'px', 'vh'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 32\r\n    },\r\n\r\n    // Styles\r\n    checkedBackgroundColor: {\r\n      displayName: 'Background color',\r\n      group: 'Checked Style',\r\n      type: { name: 'color', allowEditOnly: true },\r\n      default: '#000000'\r\n    },\r\n\r\n    // Box shadow\r\n    boxShadowEnabled: {\r\n      index: 250,\r\n      group: 'Box Shadow',\r\n      displayName: 'Shadow Enabled',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    boxShadowOffsetX: {\r\n      index: 251,\r\n      group: 'Box Shadow',\r\n      displayName: 'Offset X',\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowOffsetY: {\r\n      index: 252,\r\n      group: 'Box Shadow',\r\n      displayName: 'Offset Y',\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowBlurRadius: {\r\n      index: 253,\r\n      group: 'Box Shadow',\r\n      displayName: 'Blur Radius',\r\n      default: 5,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowSpreadRadius: {\r\n      index: 254,\r\n      group: 'Box Shadow',\r\n      displayName: 'Spread Radius',\r\n      default: 2,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowInset: {\r\n      index: 255,\r\n      group: 'Box Shadow',\r\n      displayName: 'Inset',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    boxShadowColor: {\r\n      index: 256,\r\n      group: 'Box Shadow',\r\n      displayName: 'Shadow Color',\r\n      type: 'color',\r\n      default: 'rgba(0,0,0,0.2)'\r\n    }\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 201,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color'\r\n    },\r\n\r\n    // Border styles\r\n    borderRadius: {\r\n      index: 202,\r\n      displayName: 'Border Radius',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 16,\r\n      applyDefault: false\r\n    },\r\n    borderStyle: {\r\n      index: 203,\r\n      displayName: 'Border Style',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'None', value: 'none' },\r\n          { label: 'Solid', value: 'solid' },\r\n          { label: 'Dotted', value: 'dotted' },\r\n          { label: 'Dashed', value: 'dashed' }\r\n        ]\r\n      },\r\n      default: 'solid',\r\n      applyDefault: false\r\n    },\r\n    borderWidth: {\r\n      index: 204,\r\n      displayName: 'Border Width',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 1,\r\n      applyDefault: false\r\n    },\r\n    borderColor: {\r\n      index: 205,\r\n      displayName: 'Border Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: '#000000'\r\n    }\r\n  },\r\n  outputProps: {},\r\n  methods: {}\r\n};\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addTransformInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addMarginInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(RadioButtonNode);\r\nUtils.addControlEventsAndStates(RadioButtonNode);\r\n\r\nRadioButtonNode = createNodeFromReactComponent(RadioButtonNode);\r\n\r\nexport default RadioButtonNode;\r\n","import React, { useEffect, useState } from 'react';\r\n\r\nimport guid from '../../guid';\r\nimport Layout from '../../layout';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\nfunction _styleTemplate(_class, props) {\r\n  return `\r\n    .${_class}::-webkit-slider-thumb {\r\n        width: ${props.thumbWidth};\r\n        height: ${props.thumbHeight};\r\n        background: ${props.thumbColor};\r\n        border: 0;\r\n        border-radius: ${props.thumbRadius};\r\n        cursor: pointer;\r\n        -webkit-appearance: none;\r\n        margin-top:calc(${props.trackHeight}/2 - ${props.thumbHeight}/2);\r\n    }\r\n    \r\n    .${_class}::-moz-range-thumb {\r\n        width: ${props.thumbWidth};\r\n        height: ${props.thumbHeight};\r\n        background: ${props.thumbColor};\r\n        border: none;\r\n        border-radius: ${props.thumbRadius};\r\n        cursor: pointer;\r\n    }\r\n    \r\n    .${_class}::-ms-thumb {\r\n        width: ${props.thumbWidth};\r\n        height: ${props.thumbHeight};\r\n        background: ${props.thumbColor};\r\n        border: none;\r\n        border-radius: ${props.thumbRadius};\r\n        cursor: pointer;\r\n        margin-top: 0px;\r\n    }\r\n    \r\n    .${_class}::-webkit-slider-runnable-track {\r\n        background: ${props.trackColor};\r\n        border: none;\r\n        width: 100%;\r\n        height: ${props.trackHeight};\r\n        cursor: pointer;\r\n        margin-top:0px;\r\n    }\r\n    \r\n    .${_class}:focus::-webkit-slider-runnable-track {\r\n        background: ${props.trackColor};\r\n    }\r\n    \r\n    .${_class}::-moz-range-track {\r\n        background: ${props.trackColor};\r\n        border: none;\r\n        width: 100%;\r\n        height: ${props.trackHeight};\r\n        cursor: pointer;\r\n    }\r\n    \r\n    .${_class}::-ms-track {\r\n        background: transparent;\r\n        border:none;\r\n        color: transparent;\r\n        width: 100%;\r\n        height: ${props.trackHeight};\r\n        cursor: pointer;\r\n    }\r\n    \r\n    .${_class}::-ms-fill-lower {\r\n        background: ${props.trackColor};\r\n        border: none;\r\n    }\r\n    .${_class}::-ms-fill-upper {\r\n        background: ${props.trackColor};\r\n        border: none;\r\n    }    \r\n    `;\r\n}\r\n\r\n// --------------------------------------------------------------------------------------\r\n// Range\r\n// --------------------------------------------------------------------------------------\r\nfunction Range(props) {\r\n  const [value, setValue] = useState(props.value);\r\n\r\n  // Report initial values when mounted\r\n  useEffect(() => {\r\n    setValue(props.value);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setValue(props.value);\r\n  }, [props.value]);\r\n\r\n  var style = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  const tagProps = { id: props.id, min: props.min, max: props.max, step: props.step, style: style };\r\n\r\n  Utils.updateStylesForClass('ndl-controls-range-' + props._nodeId, props, _styleTemplate);\r\n\r\n  let className = 'ndl-controls-range-' + props._nodeId + ' ndl-controls-range';\r\n  if (props.className) className = className + ' ' + props.className;\r\n\r\n  return (\r\n    <input\r\n      className={className}\r\n      {...Utils.controlEvents(props)}\r\n      type=\"range\"\r\n      {...tagProps}\r\n      value={value}\r\n      disabled={!props.enabled}\r\n      onChange={(e) => {\r\n        setValue(e.target.value);\r\n        props.valueChanged && props.valueChanged(e.target.value);\r\n      }}\r\n    ></input>\r\n  );\r\n}\r\n\r\nvar RangeNode = {\r\n  name: 'Range',\r\n  docs: 'https://docs.noodl.net/nodes/visual/range',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  initialize() {\r\n    this.props.sizeMode = 'explicit';\r\n    this.props.id = this._internal.controlId = 'input-' + guid();\r\n    this.props.enabled = this._internal.enabled = true;\r\n    this._internal.value = this.props.value = this.props.min;\r\n    this.props._nodeId = this.id;\r\n    this.props.valueChanged = (value) => {\r\n      value = typeof value === 'string' ? parseFloat(value) : value;\r\n      const valueChanged = this._internal.value !== value;\r\n      this._internal.value = value;\r\n\r\n      this._updateValuePercent(value);\r\n\r\n      if (valueChanged) {\r\n        this.flagOutputDirty('value');\r\n        this.sendSignalOnOutput('onChange');\r\n      }\r\n    };\r\n    this.props.valueChanged(this.props.value); // Update initial values\r\n\r\n    this.outputPropValues.hoverState = this.outputPropValues.focusState = this.outputPropValues.pressedState = false;\r\n  },\r\n  getReactComponent() {\r\n    return Range;\r\n  },\r\n  inputs: {\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'General',\r\n      default: true,\r\n      set: function (value) {\r\n        value = !!value;\r\n        const changed = value !== this._internal.enabled;\r\n        this.props.enabled = this._internal.enabled = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('enabled');\r\n        }\r\n      }\r\n    },\r\n    value: {\r\n      type: 'string',\r\n      displayName: 'Value',\r\n      group: 'General',\r\n      set: function (value) {\r\n        const changed = value !== this._internal.value;\r\n        this.props.value = this._internal.value = value;\r\n        this._updateValuePercent(value);\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('value');\r\n        }\r\n      }\r\n    }\r\n  },\r\n  outputs: {\r\n    controlId: {\r\n      type: 'string',\r\n      displayName: 'Control Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.controlId;\r\n      }\r\n    },\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.enabled;\r\n      }\r\n    },\r\n    value: {\r\n      type: 'number',\r\n      displayName: 'Value',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.value;\r\n      }\r\n    },\r\n    valuePercent: {\r\n      type: 'number',\r\n      displayName: 'Value Percent',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.valuePercent;\r\n      }\r\n    },\r\n    onChange: {\r\n      type: 'signal',\r\n      displayName: 'Changed',\r\n      group: 'Events'\r\n    }\r\n  },\r\n  inputProps: {\r\n    min: { type: 'number', displayName: 'Min', group: 'General', default: 0 },\r\n    max: { type: 'number', displayName: 'Max', group: 'General', default: 100 },\r\n    step: { type: 'number', displayName: 'Step', group: 'General', default: 1 },\r\n    width: {\r\n      index: 11,\r\n      group: 'Dimensions',\r\n      displayName: 'Width',\r\n      type: {\r\n        name: 'number',\r\n        units: ['%', 'px', 'vw'],\r\n        defaultUnit: '%'\r\n      },\r\n      default: 100\r\n    },\r\n    height: {\r\n      index: 12,\r\n      group: 'Dimensions',\r\n      displayName: 'Height',\r\n      type: {\r\n        name: 'number',\r\n        units: ['%', 'px', 'vh'],\r\n        defaultUnit: '%'\r\n      },\r\n      default: 100\r\n    },\r\n\r\n    // Styles\r\n    thumbWidth: {\r\n      group: 'Thumb Style',\r\n      displayName: 'Width',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', 'vw', '%'],\r\n        defaultUnit: 'px',\r\n        allowEditOnly: true\r\n      },\r\n      default: 16\r\n    },\r\n    thumbHeight: {\r\n      group: 'Thumb Style',\r\n      displayName: 'Height',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', 'vh', '%'],\r\n        defaultUnit: 'px',\r\n        allowEditOnly: true\r\n      },\r\n      default: 16\r\n    },\r\n    thumbRadius: {\r\n      group: 'Thumb Style',\r\n      displayName: 'Radius',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', '%'],\r\n        defaultUnit: 'px',\r\n        allowEditOnly: true\r\n      },\r\n      default: 8\r\n    },\r\n    thumbColor: {\r\n      group: 'Thumb Style',\r\n      displayName: 'Color',\r\n      type: { name: 'color', allowEditOnly: true },\r\n      default: '#000000'\r\n    },\r\n    trackHeight: {\r\n      group: 'Track Style',\r\n      displayName: 'Height',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', 'vh', '%'],\r\n        defaultUnit: 'px',\r\n        allowEditOnly: true\r\n      },\r\n      default: 6\r\n    },\r\n    trackColor: {\r\n      group: 'Track Style',\r\n      displayName: 'Color',\r\n      type: { name: 'color', allowEditOnly: true },\r\n      default: '#f0f0f0'\r\n    }\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 201,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color'\r\n    },\r\n\r\n    // Border styles\r\n    borderRadius: {\r\n      index: 202,\r\n      displayName: 'Border Radius',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 1,\r\n      applyDefault: false\r\n    },\r\n    borderStyle: {\r\n      index: 203,\r\n      displayName: 'Border Style',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'None', value: 'none' },\r\n          { label: 'Solid', value: 'solid' },\r\n          { label: 'Dotted', value: 'dotted' },\r\n          { label: 'Dashed', value: 'dashed' }\r\n        ]\r\n      },\r\n      default: 'none',\r\n      applyDefault: false\r\n    },\r\n    borderWidth: {\r\n      index: 204,\r\n      displayName: 'Border Width',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 1,\r\n      applyDefault: false\r\n    },\r\n    borderColor: {\r\n      index: 205,\r\n      displayName: 'Border Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: '#000000'\r\n    }\r\n  },\r\n  outputProps: {},\r\n  methods: {\r\n    _updateValuePercent(value) {\r\n      const min = this.props.min;\r\n      const max = this.props.max;\r\n      const valuePercent = Math.floor(((value - min) / (max - min)) * 100);\r\n      const valuePercentChanged = this._internal.valuePercentChanged !== valuePercent;\r\n\r\n      this._internal.valuePercent = valuePercent;\r\n      valuePercentChanged && this.flagOutputDirty('valuePercent');\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(RangeNode);\r\nNodeSharedPortDefinitions.addTransformInputs(RangeNode);\r\nNodeSharedPortDefinitions.addMarginInputs(RangeNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(RangeNode);\r\nUtils.addControlEventsAndStates(RangeNode);\r\n\r\nRangeNode = createNodeFromReactComponent(RangeNode);\r\n\r\nexport default RangeNode;\r\n","import React from 'react';\r\n\r\nimport FontLoader from '../../fontloader';\r\nimport guid from '../../guid';\r\nimport Layout from '../../layout';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport Utils from './utils';\r\n\r\n//this stops a text field from being unfocused by the clickHandler in the viewer that handles focus globally.\r\n//The specific case is when a mouseDown is registered in the input, but the mouseUp is outside.\r\n//It'll trigger a focus change that'll blur the input field, which is annyoing when you're selecting text\r\nfunction preventGlobalFocusChange(e) {\r\n  e.stopPropagation();\r\n  window.removeEventListener('click', preventGlobalFocusChange, true);\r\n}\r\n\r\nclass TextFieldComponent extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      value: props.startValue\r\n    };\r\n    this.ref = React.createRef();\r\n  }\r\n\r\n  setText(value) {\r\n    this.setState({ value });\r\n    this.props.onTextChanged && this.props.onTextChanged(value);\r\n  }\r\n\r\n  componentDidMount() {\r\n    //plumbing for the focused signals\r\n    this.ref.current.noodlNode = this.props.noodlNode;\r\n\r\n    this.setText(this.props.startValue);\r\n  }\r\n\r\n  render() {\r\n    const style = { ...this.props.textStyle, ...this.props.style };\r\n    Layout.size(style, this.props);\r\n    Layout.align(style, this.props);\r\n\r\n    if (style.opacity === 0) {\r\n      style.pointerEvents = 'none';\r\n    }\r\n\r\n    const props = this.props;\r\n\r\n    const sharedProps = {\r\n      id: props.id,\r\n      value: this.state.value,\r\n      ...Utils.controlEvents(props),\r\n      disabled: !props.enabled,\r\n      style,\r\n      className: props.className,\r\n      placeholder: props.placeholder,\r\n      onChange: (e) => this.onChange(e)\r\n    };\r\n\r\n    if (this.props.type !== 'textArea') {\r\n      return (\r\n        <input\r\n          ref={this.ref}\r\n          type={this.props.type}\r\n          {...sharedProps}\r\n          onKeyDown={(e) => this.onKeyDown(e)}\r\n          onMouseDown={() => window.addEventListener('click', preventGlobalFocusChange, true)}\r\n        />\r\n      );\r\n    } else {\r\n      sharedProps.style.resize = 'none'; //disable user resizing\r\n      return <textarea ref={this.ref} {...sharedProps} onKeyDown={(e) => this.onKeyDown(e)} />;\r\n    }\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    if (e.key === 'Enter' || e.which === 13) {\r\n      this.props.onEnter && this.props.onEnter();\r\n    }\r\n  }\r\n\r\n  onChange(event) {\r\n    const value = event.target.value;\r\n    this.setText(value);\r\n  }\r\n\r\n  focus() {\r\n    this.ref.current && this.ref.current.focus();\r\n  }\r\n\r\n  blur() {\r\n    this.ref.current && this.ref.current.blur();\r\n  }\r\n}\r\n\r\nconst TextInput = {\r\n  name: 'Text Input',\r\n  docs: 'https://docs.noodl.net/nodes/visual/text-input',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  getReactComponent() {\r\n    return TextFieldComponent;\r\n  },\r\n  defaultCss: {\r\n    outline: 'none',\r\n    borderStyle: 'solid',\r\n    padding: 0\r\n  },\r\n  initialize() {\r\n    this.props.startValue = '';\r\n\r\n    this.props.id = this._internal.controlId = 'input-' + guid();\r\n    this.props.enabled = this._internal.enabled = true;\r\n    this.outputPropValues.hoverState = this.outputPropValues.focusState = this.outputPropValues.pressedState = false;\r\n  },\r\n  inputProps: {\r\n    type: {\r\n      displayName: 'Type',\r\n      group: 'Text',\r\n      index: 19,\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Text', value: 'text' },\r\n          { label: 'Text Area', value: 'textArea' },\r\n          { label: 'Email', value: 'email' },\r\n          { label: 'Number', value: 'number' },\r\n          { label: 'Password', value: 'password' },\r\n          { label: 'URL', value: 'url' }\r\n        ]\r\n      },\r\n      default: 'text'\r\n    },\r\n    placeholder: {\r\n      index: 22,\r\n      group: 'Text',\r\n      displayName: 'Placeholder',\r\n      default: 'Type here...',\r\n      type: {\r\n        name: 'string'\r\n      }\r\n    },\r\n    /* disabled: {\r\n            group: 'Text',\r\n            index: 23,\r\n            displayName: 'Disabled',\r\n            propPath: 'dom',\r\n            default: false,\r\n            type: 'boolean'\r\n        }*/\r\n\r\n    // Box shadow\r\n    boxShadowEnabled: {\r\n      index: 250,\r\n      group: 'Box Shadow',\r\n      displayName: 'Shadow Enabled',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    boxShadowOffsetX: {\r\n      index: 251,\r\n      group: 'Box Shadow',\r\n      displayName: 'Offset X',\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowOffsetY: {\r\n      index: 252,\r\n      group: 'Box Shadow',\r\n      displayName: 'Offset Y',\r\n      default: 0,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowBlurRadius: {\r\n      index: 253,\r\n      group: 'Box Shadow',\r\n      displayName: 'Blur Radius',\r\n      default: 5,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowSpreadRadius: {\r\n      index: 254,\r\n      group: 'Box Shadow',\r\n      displayName: 'Spread Radius',\r\n      default: 2,\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      }\r\n    },\r\n    boxShadowInset: {\r\n      index: 255,\r\n      group: 'Box Shadow',\r\n      displayName: 'Inset',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    boxShadowColor: {\r\n      index: 256,\r\n      group: 'Box Shadow',\r\n      displayName: 'Shadow Color',\r\n      type: 'color',\r\n      default: 'rgba(0,0,0,0.2)'\r\n    }\r\n  },\r\n  inputs: {\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'General',\r\n      default: true,\r\n      set: function (value) {\r\n        value = !!value;\r\n        const changed = value !== this._internal.enabled;\r\n        this.props.enabled = this._internal.enabled = value;\r\n\r\n        if (changed) {\r\n          this.forceUpdate();\r\n          this.flagOutputDirty('enabled');\r\n        }\r\n      }\r\n    },\r\n\r\n    set: {\r\n      group: 'Actions',\r\n      displayName: 'Set',\r\n      type: 'signal',\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          this.setText(this._internal.text);\r\n        });\r\n      }\r\n    },\r\n    startValue: {\r\n      index: 18,\r\n      displayName: 'Text',\r\n      type: 'string',\r\n      group: 'Text',\r\n      set(value) {\r\n        if (this._internal.text === value) return;\r\n\r\n        this._internal.text = value;\r\n        if (this.isInputConnected('set') === false) {\r\n          this.setText(value);\r\n        }\r\n      }\r\n    },\r\n    textStyle: {\r\n      index: 19,\r\n      type: 'textStyle',\r\n      group: 'Text',\r\n      displayName: 'Text Style',\r\n      default: 'None',\r\n      set(value) {\r\n        this.props.textStyle = this.context.styles.getTextStyle(value);\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    fontFamily: {\r\n      index: 20,\r\n      type: 'font',\r\n      group: 'Text',\r\n      displayName: 'Font Family',\r\n      set(value) {\r\n        if (value) {\r\n          let family = value;\r\n          if (family.split('.').length > 1) {\r\n            family = family.replace(/\\.[^/.]+$/, '');\r\n            family = family.split('/').pop();\r\n          }\r\n          this.setStyle({ fontFamily: family });\r\n        } else {\r\n          this.removeStyle(['fontFamily']);\r\n        }\r\n\r\n        if (this.props.textStyle) {\r\n          this.forceUpdate();\r\n        }\r\n      }\r\n    },\r\n    clear: {\r\n      type: 'signal',\r\n      group: 'Actions',\r\n      displayName: 'Clear',\r\n      valueChangedToTrue() {\r\n        this.setText('');\r\n      }\r\n    },\r\n    focus: {\r\n      type: 'signal',\r\n      group: 'Actions',\r\n      displayName: 'Focus',\r\n      valueChangedToTrue() {\r\n        this.context.setNodeFocused(this, true);\r\n      }\r\n    },\r\n    blur: {\r\n      type: 'signal',\r\n      group: 'Actions',\r\n      displayName: 'Blur',\r\n      valueChangedToTrue() {\r\n        this.context.setNodeFocused(this, false);\r\n      }\r\n    }\r\n  },\r\n  inputCss: {\r\n    fontSize: {\r\n      index: 21,\r\n      group: 'Text',\r\n      displayName: 'Font Size',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      onChange() {\r\n        if (this.props.textStyle) {\r\n          this.forceUpdate();\r\n        }\r\n      }\r\n    },\r\n    color: {\r\n      index: 99,\r\n      type: 'color',\r\n      displayName: 'Font Color',\r\n      group: 'Style'\r\n    },\r\n    backgroundColor: {\r\n      index: 100,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: 'transparent'\r\n    },\r\n    borderColor: {\r\n      index: 101,\r\n      displayName: 'Border Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: 'black'\r\n    },\r\n    borderWidth: {\r\n      index: 102,\r\n      displayName: 'Border Width',\r\n      group: 'Style',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 0\r\n    }\r\n  },\r\n  outputs: {\r\n    controlId: {\r\n      type: 'string',\r\n      displayName: 'Control Id',\r\n      group: 'General',\r\n      getter: function () {\r\n        return this._internal.controlId;\r\n      }\r\n    },\r\n    enabled: {\r\n      type: 'boolean',\r\n      displayName: 'Enabled',\r\n      group: 'States',\r\n      getter: function () {\r\n        return this._internal.enabled;\r\n      }\r\n    }\r\n  },\r\n  outputProps: {\r\n    // Value\r\n    onTextChanged: {\r\n      group: 'Value',\r\n      displayName: 'Text',\r\n      type: 'string'\r\n    },\r\n\r\n    // Events\r\n    onEnter: {\r\n      group: 'Events',\r\n      displayName: 'On Enter',\r\n      type: 'signal'\r\n    }\r\n  },\r\n  dynamicports: [\r\n    {\r\n      condition: 'boxShadowEnabled = true',\r\n      inputs: [\r\n        'boxShadowOffsetX',\r\n        'boxShadowOffsetY',\r\n        'boxShadowInset',\r\n        'boxShadowBlurRadius',\r\n        'boxShadowSpreadRadius',\r\n        'boxShadowColor'\r\n      ]\r\n    }\r\n  ],\r\n  methods: {\r\n    _focus() {\r\n      if (!this.innerReactComponentRef) return;\r\n      this.innerReactComponentRef.focus();\r\n    },\r\n    _blur() {\r\n      if (!this.innerReactComponentRef) return;\r\n      this.innerReactComponentRef.blur();\r\n    },\r\n    setText(text) {\r\n      this.props.startValue = text;\r\n      if (this.innerReactComponentRef) {\r\n        //the text component is mounted, and will signal the onTextChanged output\r\n        this.innerReactComponentRef.setText(text);\r\n      } else if (this.outputPropValues['onTextChanged'] !== text) {\r\n        //text component isn't mounted, set the output manually\r\n        this.outputPropValues['onTextChanged'] = text;\r\n        this.flagOutputDirty('onTextChanged');\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(TextInput, { defaultSizeMode: 'contentSize', contentLabel: 'Text' });\r\nNodeSharedPortDefinitions.addAlignInputs(TextInput);\r\nNodeSharedPortDefinitions.addTransformInputs(TextInput);\r\nNodeSharedPortDefinitions.addPaddingInputs(TextInput);\r\nNodeSharedPortDefinitions.addMarginInputs(TextInput);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(TextInput);\r\nUtils.addControlEventsAndStates(TextInput);\r\n\r\nconst definition = createNodeFromReactComponent(TextInput);\r\ndefinition.setup = function (context, graphModel) {\r\n  graphModel.on('nodeAdded.Text Input', function (node) {\r\n    if (node.parameters.fontFamily && node.parameters.fontFamily.split('.').length > 1) {\r\n      FontLoader.instance.loadFont(node.parameters.fontFamily);\r\n    }\r\n    node.on('parameterUpdated', function (event) {\r\n      if (event.name === 'fontFamily' && event.value) {\r\n        if (event.value.split('.').length > 1) {\r\n          FontLoader.instance.loadFont(event.value);\r\n        }\r\n      }\r\n    });\r\n  });\r\n};\r\n\r\nexport default definition;\r\n","// Controls\r\nimport Button from './nodes/controls/button.ts';\r\nimport CheckBox from './nodes/controls/checkbox.ts';\r\nimport Options from './nodes/controls/options.ts';\r\nimport RadioButton from './nodes/controls/radiobutton.ts';\r\nimport RadioButtonGroup from './nodes/controls/radiobuttongroup.ts';\r\nimport Range from './nodes/controls/slider.ts';\r\nimport TextInput from './nodes/controls/text-input.ts';\r\nimport NavigationStack from './nodes/navigation/navigation-stack.jsx';\r\nimport Page from './nodes/navigation/page.js';\r\nimport Router from './nodes/navigation/router.tsx';\r\nimport ExternalLink from './nodes/std-library/externallink';\r\nimport Circle from './nodes/visual/circle.js';\r\nimport Columns from './nodes/visual/columns.js';\r\nimport CSSDefinition from './nodes/visual/css-definition';\r\nimport DragNode from './nodes/visual/drag.js';\r\nimport Group from './nodes/visual/group.js';\r\nimport Icon from './nodes/visual/icon.js';\r\nimport Image from './nodes/visual/image.js';\r\nimport TextNode from './nodes/visual/text.js';\r\nimport Video from './nodes/visual/video.js';\r\nimport './assets/style.css';\r\n//Deprecated\r\nimport ButtonOld from './nodes-deprecated/controls/button.jsx';\r\nimport CheckBoxOld from './nodes-deprecated/controls/checkbox.jsx';\r\nimport FieldSet from './nodes-deprecated/controls/fieldset.jsx';\r\nimport Form from './nodes-deprecated/controls/form.jsx';\r\nimport Label from './nodes-deprecated/controls/label.jsx';\r\nimport OptionsOld from './nodes-deprecated/controls/options.jsx';\r\nimport RadioButtonOld from './nodes-deprecated/controls/radiobutton.jsx';\r\nimport RangeOld from './nodes-deprecated/controls/range.jsx';\r\nimport TextInputOld from './nodes-deprecated/controls/text-input.jsx';\r\n\r\nexport default function registerNodes(noodlRuntime) {\r\n  [\r\n    // require('./nodes/std-library/counter'), // moved to runtime\r\n    //  require('./nodes/std-library/expression'), // moved to runtime\r\n    //require('./nodes/std-library/condition'),\r\n    //require('./nodes/std-library/and'),\r\n    //require('./nodes/std-library/or'),\r\n    require('./nodes/std-library/switch'),\r\n    //require('./nodes/std-library/booleantostring'), // moved to runtime\r\n    //require('./nodes/std-library/datetostring'),\r\n    //require('./nodes/std-library/stringmapper'),\r\n    //require('./nodes/std-library/inverter'),\r\n    require('./nodes/std-library/timer'),\r\n    require('./nodes/std-library/variables/color'),\r\n    //require('./nodes/std-library/substring'), // moved to runtime\r\n    require('./nodes/std-library/eventsender'),\r\n    require('./nodes/std-library/eventreceiver'),\r\n    require('./nodes/std-library/screenresolution'),\r\n    require('./nodes/std-library/javascript'),\r\n    //require('./nodes/std-library/simplejavascript'), // moved to runtime\r\n    require('./nodes/std-library/numberremapper'),\r\n    require('./nodes/std-library/valuechanged'),\r\n    require('./nodes/std-library/states'),\r\n    //require('./nodes/std-library/stringformat'), // moved to runtime\r\n    require('./nodes/std-library/data/foreach'),\r\n    require('./nodes/std-library/data/foreachactions'),\r\n    require('./nodes/std-library/colorblend'),\r\n    require('./nodes/std-library/animate-to-value'),\r\n\r\n    //require('./nodes/std-library/variables/number'), // moved to runtime\r\n    //require('./nodes/std-library/variables/string'),\r\n    //require('./nodes/std-library/variables/boolean'),\r\n    require('./nodes/std-library/variables/color'),\r\n\r\n    // Component Object\r\n    require('./nodes/std-library/componentutils/componentobject'),\r\n    require('./nodes/std-library/componentutils/parentcomponentobject'),\r\n    require('./nodes/std-library/componentutils/setcomponentobjectproperties'),\r\n    require('./nodes/std-library/componentutils/setparentcomponentobjectproperties'),\r\n\r\n    // Variable\r\n    require('./nodes/std-library/data/variablenode2'),\r\n    require('./nodes/std-library/data/setvariablenode'),\r\n\r\n    // New object\r\n    // require('./nodes/std-library/data/modelnode2'), // moved to runtime\r\n    // require('./nodes/std-library/data/setmodelpropertiesnode'),\r\n    // require('./nodes/std-library/data/newmodelnode'),\r\n\r\n    // New record\r\n    //require('./nodes/std-library/data/dbmodelnode2'), // moved to runtime\r\n    //require('./nodes/std-library/data/dbcollectionnode2'), // moved to runtime\r\n    // require('./nodes/std-library/data/setdbmodelpropertiesnode'),\r\n    // require('./nodes/std-library/data/deletedbmodelpropertiesnode'),\r\n    // require('./nodes/std-library/data/newdbmodelpropertiesnode'),\r\n    // require('./nodes/std-library/data/dbmodelnode-addrelation'),\r\n    // require('./nodes/std-library/data/dbmodelnode-removerelation'),\r\n    // require('./nodes/std-library/data/filterdbmodelsnode'),\r\n\r\n    // New array\r\n    require('./nodes/std-library/data/collectionnode2'),\r\n    require('./nodes/std-library/data/collectionnode-insert'),\r\n    require('./nodes/std-library/data/collectionnode-remove'),\r\n    require('./nodes/std-library/data/collectionnode-clear'),\r\n    require('./nodes/std-library/data/collectionnode-new'),\r\n    require('./nodes/std-library/data/filtercollectionnode'),\r\n\r\n    require('./nodes/std-library/data/staticdata'),\r\n\r\n    require('./nodes/std-library/data/mapcollectionnode'),\r\n    //require('./nodes/std-library/data/restnode'), // moved to runtime\r\n    require('./nodes/std-library/data/cloudfunction2'),\r\n    //require('./nodes/std-library/uniqueid'), // moved to runtime\r\n\r\n    // Files\r\n    require('./nodes/std-library/openfilepicker'),\r\n    require('./nodes/std-library/uploadfile'),\r\n    //require('./nodes/std-library/data/cloudfilenode'), // moved to runtime\r\n\r\n    // Navigation\r\n    require('./nodes/navigation/navigate-back'),\r\n    require('./nodes/navigation/navigate-to-path'),\r\n    require('./nodes/navigation/navigate'),\r\n    require('./nodes/navigation/showpopup'),\r\n    require('./nodes/navigation/closepopup'),\r\n\r\n    require('./nodes/navigation/page-inputs'),\r\n    require('./nodes/navigation/router-navigate'),\r\n\r\n    // User\r\n    require('./nodes/std-library/user/login'),\r\n    require('./nodes/std-library/user/logout'),\r\n    require('./nodes/std-library/user/signup'),\r\n    //require('./nodes/std-library/user/user'), // moved to runtime\r\n    //require('./nodes/std-library/user/setuserproperties'), // moved to runtime\r\n    require('./nodes/std-library/user/verifyemail'),\r\n    require('./nodes/std-library/user/sendemailverification'),\r\n    require('./nodes/std-library/user/resetpassword'),\r\n    require('./nodes/std-library/user/requestpasswordreset'),\r\n\r\n    // Deprecated\r\n    require('./nodes/std-library/data/cloudfunction'),\r\n    require('./nodes-deprecated/std-library/componentstate'),\r\n    require('./nodes-deprecated/std-library/parentcomponentstate'),\r\n    require('./nodes-deprecated/std-library/data/modelnode'),\r\n    require('./nodes-deprecated/std-library/data/variablenode'),\r\n    require('./nodes-deprecated/std-library/gyroscope'),\r\n    require('./nodes-deprecated/std-library/globals'),\r\n    require('./nodes-deprecated/std-library/signaltoindex'),\r\n    require('./nodes-deprecated/std-library/numberblend'),\r\n    require('./nodes-deprecated/std-library/stringselector'),\r\n    require('./nodes-deprecated/std-library/animation'),\r\n    require('./nodes-deprecated/std-library/transition'),\r\n    require('./nodes-deprecated/std-library/data/dbmodelnode'),\r\n    require('./nodes-deprecated/std-library/data/dbcollectionnode'),\r\n    require('./nodes-deprecated/std-library/data/collectionnode'),\r\n    require('./nodes-deprecated/std-library/scriptdownloader')\r\n  ].forEach(function (nodeDefinition) {\r\n    noodlRuntime.registerNode(nodeDefinition);\r\n  });\r\n\r\n  noodlRuntime.registerNode(CSSDefinition);\r\n  noodlRuntime.registerNode(Group);\r\n  noodlRuntime.registerNode(TextNode);\r\n  noodlRuntime.registerNode(Image);\r\n  noodlRuntime.registerNode(Icon);\r\n  noodlRuntime.registerNode(Circle);\r\n  noodlRuntime.registerNode(Video);\r\n  noodlRuntime.registerNode(DragNode);\r\n  noodlRuntime.registerNode(ExternalLink);\r\n  noodlRuntime.registerNode(Columns);\r\n\r\n  // Deprecated UI Controls\r\n  noodlRuntime.registerNode(ButtonOld);\r\n  noodlRuntime.registerNode(CheckBoxOld);\r\n  noodlRuntime.registerNode(RadioButtonOld);\r\n  noodlRuntime.registerNode(OptionsOld);\r\n  noodlRuntime.registerNode(RangeOld);\r\n  noodlRuntime.registerNode(Label);\r\n  noodlRuntime.registerNode(TextInputOld);\r\n  noodlRuntime.registerNode(Form);\r\n  noodlRuntime.registerNode(FieldSet);\r\n\r\n  // UI Controls\r\n  noodlRuntime.registerNode(Button);\r\n  noodlRuntime.registerNode(CheckBox);\r\n  noodlRuntime.registerNode(RadioButtonGroup);\r\n  noodlRuntime.registerNode(RadioButton);\r\n  noodlRuntime.registerNode(Options);\r\n  noodlRuntime.registerNode(Range);\r\n  noodlRuntime.registerNode(TextInput);\r\n\r\n  // Navigation\r\n  noodlRuntime.registerNode(NavigationStack);\r\n  noodlRuntime.registerNode(Page);\r\n  noodlRuntime.registerNode(Router);\r\n}\r\n","import type { NodeRegister, GraphModel, TSFixme } from '../typings/global';\r\nimport FontLoader from './fontloader';\r\n\r\nfunction getInputsWithType(nodeScope, inputType) {\r\n  const result = [];\r\n\r\n  const nodes = nodeScope.getAllNodesRecursive();\r\n  nodes.forEach((node) => {\r\n    const inputs = [];\r\n\r\n    for (const inputName in node._inputs) {\r\n      const input = node._inputs[inputName];\r\n      if (input.type === inputType) {\r\n        inputs.push(inputName);\r\n      }\r\n    }\r\n\r\n    if (inputs.length) {\r\n      result.push({ node, inputs });\r\n    }\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\ntype TextStyleData = {\r\n  letterSpacing: string;\r\n  lineHeight: { value: string; unit: string };\r\n  textTransform: string;\r\n  fontSize: { value: string; unit: string };\r\n  fontFamily: string;\r\n  color: string;\r\n};\r\n\r\ntype StylesData = {\r\n  text?: Record<string, TextStyleData>;\r\n  colors?: Record<string, string>;\r\n};\r\n\r\nexport default class Styles {\r\n  getNodeScope: () => TSFixme;\r\n  graphModel: GraphModel;\r\n  nodeRegister: NodeRegister;\r\n  styles: StylesData;\r\n\r\n  constructor({ graphModel, nodeRegister, getNodeScope }) {\r\n    this.getNodeScope = getNodeScope;\r\n    this.graphModel = graphModel;\r\n    this.nodeRegister = nodeRegister;\r\n\r\n    this.setStyles(graphModel.getMetaData('styles') || {});\r\n    graphModel.on('metadataChanged.styles', (styles) => this.setStyles(styles));\r\n  }\r\n\r\n  setStyles(styles: StylesData) {\r\n    // Brute force update all styles, no delta check\r\n    this.styles = styles;\r\n\r\n    // Process text styles\r\n    const textStyles = styles.text || {};\r\n\r\n    // Format font family\r\n    Object.values(textStyles)\r\n      .filter((style) => style.fontFamily)\r\n      .forEach((textStyle) => {\r\n        let family = textStyle.fontFamily;\r\n\r\n        // Load files and create font css\r\n        if (family.split('.').length > 1) {\r\n          FontLoader.instance.loadFont(family);\r\n          family = family.replace(/\\.[^/.]+$/, '');\r\n          family = family.split('/').pop();\r\n\r\n          // Update the style to the font css instead of the file name\r\n          textStyle.fontFamily = family;\r\n        }\r\n      });\r\n\r\n    // Format values with units (to css strings)\r\n    for (const name in textStyles) {\r\n      const style = textStyles[name];\r\n      for (const prop in style) {\r\n        const value = style[prop];\r\n        if (typeof value === 'object') {\r\n          style[prop] = value.value + value.unit;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Remove colors with empty strings\r\n    for (const name in textStyles) {\r\n      const style = textStyles[name];\r\n      if (style.hasOwnProperty('color') && !style.color) {\r\n        delete style.color;\r\n      }\r\n    }\r\n\r\n    const nodeScope = this.getNodeScope && this.getNodeScope();\r\n    if (!nodeScope) return;\r\n\r\n    const variants = this.graphModel.getVariants();\r\n    for (const variant of variants) {\r\n      if (this._variantHasInputsWithTypes(variant, ['color', 'textStyle'])) {\r\n        const nodes = nodeScope.getAllNodesWithVariantRecursive(variant);\r\n        nodes.forEach((node) => node.setVariant(variant));\r\n      }\r\n    }\r\n\r\n    //set all inputs with types using styles\r\n    //just re-apply the previous value to trigger a new style resolve\r\n    ['color', 'textStyle'].forEach((inputType) => {\r\n      getInputsWithType(nodeScope, inputType).forEach(({ node, inputs }) => {\r\n        inputs.forEach((inputName) => {\r\n          if (node.getInputValue(inputName)) {\r\n            node.setInputValue(inputName, node.getInputValue(inputName));\r\n          }\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  resolveColor(color: string) {\r\n    if (!this.styles.colors) return color;\r\n\r\n    const resolvedColor = this.styles.colors[color];\r\n    return resolvedColor ? resolvedColor : color;\r\n  }\r\n\r\n  getTextStyle(styleName: string) {\r\n    if (!this.styles.text) return {};\r\n    return this.styles.text[styleName] || {};\r\n  }\r\n\r\n  //checks if a variant includes inputs with the specified types\r\n  _variantHasInputsWithTypes(variant, types) {\r\n    if (!this.nodeRegister.hasNode(variant.typename)) return;\r\n\r\n    //get the metadata for the node this variant is used by\r\n    const metadata = this.nodeRegister.getNodeMetadata(variant.typename);\r\n\r\n    //get all the inputs this variant affects...\r\n    const parameterNames = new Set(Object.keys(variant.parameters));\r\n    for (const state in variant.stateParameters) {\r\n      Object.keys(variant.stateParameters[state]).forEach((param) => parameterNames.add(param));\r\n    }\r\n\r\n    //...and check if the inputs are of the supplied types\r\n    for (const param of Array.from(parameterNames)) {\r\n      const inputType = metadata.inputs[param] && metadata.inputs[param].type;\r\n      if (types.includes(inputType)) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n}\r\n","import React from 'react';\r\n\r\nimport { NoHomeError } from './components/common/NoHomeError';\r\nimport GraphWarnings from './graph-warnings';\r\nimport { Highlighter } from './highlighter';\r\nimport Inspector from './inspector';\r\nimport NoodlJSAPI from './noodl-js-api';\r\nimport projectSettings from './project-settings';\r\nimport { createNodeFromReactComponent } from './react-component-node';\r\nimport registerNodes from './register-nodes';\r\nimport Styles from './styles';\r\n\r\nif (typeof window !== 'undefined' && window.NoodlEditor) {\r\n  window.NoodlEditorInspectorAPI = {\r\n    enabled: false,\r\n    inspector: null,\r\n    setInspector(inspector) {\r\n      this.inspector = inspector;\r\n      this.enabled ? this.inspector.enable() : this.inspector.disable();\r\n    },\r\n    setEnabled(enabled) {\r\n      this.enabled = enabled;\r\n      if (this.inspector) {\r\n        this.enabled ? this.inspector.enable() : this.inspector.disable();\r\n      }\r\n\r\n      if (window.NoodlEditorHighlightAPI.highlighter) {\r\n        window.NoodlEditorHighlightAPI.highlighter.setWindowSelected(enabled);\r\n      }\r\n    }\r\n  };\r\n\r\n  window.NoodlEditorHighlightAPI = {\r\n    highlighter: null,\r\n    setHighlighter(highlighter) {\r\n      this.highlighter = highlighter;\r\n\r\n      this.highlighter.setWindowSelected(window.NoodlEditorInspectorAPI.enabled);\r\n    },\r\n    selectNode(nodeId) {\r\n      this.highlighter.deselectNodes();\r\n\r\n      if (nodeId && nodeId !== 'null') {\r\n        this.highlighter.selectNodesWithId(nodeId);\r\n      } else if (window.NoodlEditorInspectorAPI.enabled) {\r\n        this.highlighter.setWindowSelected(true);\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nexport function ssrSetupRuntime(noodlRuntime, noodlModules, projectData) {\r\n  registerNodes(noodlRuntime);\r\n\r\n  // Noodl static API\r\n  NoodlJSAPI(noodlRuntime);\r\n\r\n  noodlRuntime.setProjectSettings(projectSettings);\r\n\r\n  // Register module nodes\r\n  if (noodlModules) {\r\n    for (const module of noodlModules) {\r\n      if (module.reactNodes) {\r\n        const reactNodes = [];\r\n        for (const nodeDefinition of module.reactNodes) {\r\n          reactNodes.push(createNodeFromReactComponent(nodeDefinition));\r\n        }\r\n        const nodes = module.nodes || [];\r\n        module.nodes = nodes.concat(reactNodes);\r\n      }\r\n      noodlRuntime.registerModule(module);\r\n    }\r\n  }\r\n\r\n  const styles = new Styles({\r\n    graphModel: noodlRuntime.graphModel,\r\n    getNodeScope: () => noodlRuntime.context.rootComponent && noodlRuntime.context.rootComponent.nodeScope,\r\n    nodeRegister: noodlRuntime.context.nodeRegister\r\n  });\r\n\r\n  //make the styles available to all nodes via `this.context.styles`\r\n  noodlRuntime.context.styles = styles;\r\n\r\n  noodlRuntime.setData(projectData);\r\n  noodlRuntime._disableLoad = true;\r\n}\r\n\r\nexport default class Viewer extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      popups: []\r\n    };\r\n\r\n    const { noodlRuntime } = props;\r\n    this.runningDeployed = this.props.projectData !== undefined;\r\n    this.focusedNoodlNodes = [];\r\n\r\n    noodlRuntime.context.setNodeFocused = this.setNodeFocused.bind(this);\r\n\r\n    const enableDebugInspectors =\r\n      (typeof document !== 'undefined' && document.location.href.indexOf('forceDebugger=true') !== -1) ||\r\n      Noodl.enableDebugInspectors;\r\n    noodlRuntime.setDebugInspectorsEnabled(enableDebugInspectors);\r\n\r\n    noodlRuntime.context.setPopupCallbacks({\r\n      onShow: (popup) => {\r\n        const newPopupArray = this.state.popups.concat([popup]);\r\n\r\n        const bodyScroll = noodlRuntime.getProjectSettings().bodyScroll;\r\n\r\n        //Disable body scroll when showing a popup\r\n        if (bodyScroll && newPopupArray.length === 1) {\r\n          document.body.style.width = document.body.clientWidth + 'px';\r\n          document.body.style.top = `-${window.scrollY}px`;\r\n          document.body.style.position = 'fixed';\r\n        }\r\n\r\n        this.setState({\r\n          popups: newPopupArray\r\n        });\r\n      },\r\n      onClose: (popup) => {\r\n        const newPopupArray = this.state.popups.filter((p) => p !== popup);\r\n\r\n        this.setState({\r\n          popups: newPopupArray\r\n        });\r\n\r\n        const bodyScroll = noodlRuntime.getProjectSettings().bodyScroll;\r\n\r\n        //Enable body scroll when hiding all popups\r\n        if (bodyScroll && newPopupArray.length === 0) {\r\n          const scrollY = document.body.style.top;\r\n          document.body.style.position = '';\r\n          document.body.style.top = '';\r\n          document.body.style.width = '100%';\r\n          window.scrollTo(0, parseInt(scrollY || '0') * -1);\r\n        }\r\n      }\r\n    });\r\n\r\n    registerNodes(noodlRuntime);\r\n\r\n    // Noodl static API\r\n    NoodlJSAPI(noodlRuntime);\r\n\r\n    noodlRuntime.setProjectSettings(projectSettings);\r\n\r\n    // Register module nodes\r\n    if (this.props.noodlModules) {\r\n      for (const module of this.props.noodlModules) {\r\n        if (module.reactNodes) {\r\n          const reactNodes = [];\r\n          for (const nodeDefinition of module.reactNodes) {\r\n            reactNodes.push(createNodeFromReactComponent(nodeDefinition));\r\n          }\r\n          const nodes = module.nodes || [];\r\n          module.nodes = nodes.concat(reactNodes);\r\n        }\r\n        noodlRuntime.registerModule(module);\r\n      }\r\n    }\r\n\r\n    noodlRuntime.eventEmitter.on('rootComponentUpdated', () => {\r\n      //wait until next frame to trigger a react update, so inputs etc have a chance to settle\r\n      //(forceUpdate is synchronous)\r\n      requestAnimationFrame(() => this.forceUpdate());\r\n    });\r\n\r\n    noodlRuntime.graphModel.on('projectSettingsChanged', (settings) => {\r\n      // Suppport SSR\r\n      if (typeof document === 'undefined') return;\r\n\r\n      if (settings.bodyScroll) {\r\n        document.body.classList.add('body-scroll');\r\n      } else {\r\n        document.body.classList.remove('body-scroll');\r\n      }\r\n    });\r\n\r\n    this.styles = new Styles({\r\n      graphModel: noodlRuntime.graphModel,\r\n      getNodeScope: () => noodlRuntime.context.rootComponent && noodlRuntime.context.rootComponent.nodeScope,\r\n      nodeRegister: noodlRuntime.context.nodeRegister\r\n    });\r\n\r\n    //make the styles available to all nodes via `this.context.styles`\r\n    noodlRuntime.context.styles = this.styles;\r\n\r\n    this.state.waitingForExport = !this.runningDeployed;\r\n\r\n    if (this.runningDeployed) {\r\n      this.props.noodlRuntime.setData(this.props.projectData);\r\n\r\n      //start pre-fetching the rest of the bundles after a while, if there arent too many of them\r\n      const allBundles = Object.keys(this.props.projectData.componentIndex);\r\n      if (allBundles.length < 30) {\r\n        setTimeout(() => {\r\n          this.props.noodlRuntime.prefetchBundles(allBundles, 3);\r\n        }, 10000);\r\n      }\r\n    } else {\r\n      noodlRuntime.graphModel.on('editorImportComplete', () => {\r\n        this.setState({ waitingForExport: false });\r\n      });\r\n      this.connectToEditor();\r\n    }\r\n\r\n    this.focusedNoodlNodes = [];\r\n  }\r\n\r\n  connectToEditor() {\r\n    const { noodlRuntime } = this.props;\r\n\r\n    // Remove hash if it is in location href\r\n    var href =\r\n      (Noodl.host || location.protocol + '//' + location.host) +\r\n      location.pathname +\r\n      (location.search ? location.search : '');\r\n\r\n    const address = href.replace('http', 'ws');\r\n    noodlRuntime.connectToEditor(address);\r\n\r\n    this.highlightedNodes = new Map();\r\n    this.isUpdatingHighlights = false;\r\n\r\n    if (typeof window !== 'undefined' && window.NoodlEditor) {\r\n      this.highlighter = new Highlighter(noodlRuntime);\r\n      NoodlEditorHighlightAPI.setHighlighter(this.highlighter);\r\n\r\n      noodlRuntime.editorConnection.on('hoverStart', (id) => {\r\n        this.highlighter.highlightNodesWithId(id);\r\n      });\r\n      noodlRuntime.editorConnection.on('hoverEnd', (id) => {\r\n        this.highlighter.disableHighlight();\r\n      });\r\n\r\n      this.inspector = new Inspector({\r\n        onDisableHighlight: () => this.highlighter.disableHighlight(),\r\n        onHighlight: (id) => this.highlighter.highlightNodesWithId(id),\r\n        onInspect: (ids) => {\r\n          NoodlEditor.inspectNodes(ids);\r\n        }\r\n      });\r\n      NoodlEditorInspectorAPI.setInspector(this.inspector);\r\n    }\r\n\r\n    noodlRuntime.editorConnection.on('debuggingEnabledChanged', (enabled) => {\r\n      noodlRuntime.setDebugInspectorsEnabled(enabled);\r\n    });\r\n\r\n    this.graphWarnings = new GraphWarnings(noodlRuntime.graphModel, noodlRuntime.editorConnection);\r\n  }\r\n\r\n  setNodeFocused(node, focused) {\r\n    if (focused && this.focusedNoodlNodes.indexOf(node) === -1) {\r\n      //blur nodes that don't contain this new node\r\n      this.focusedNoodlNodes\r\n        .filter((focusedNode) => !focusedNode.contains(node))\r\n        .forEach((blurredNode) => {\r\n          blurredNode._blur();\r\n        });\r\n\r\n      node._focus();\r\n      this.focusedNoodlNodes.push(node);\r\n    } else if (!focused) {\r\n      const index = this.focusedNoodlNodes.indexOf(node);\r\n      if (index !== -1) {\r\n        return;\r\n      }\r\n\r\n      node._blur();\r\n\r\n      //also blur nodes that contain this node\r\n      this.focusedNoodlNodes\r\n        .filter((focusedNode) => focusedNode.contains(node))\r\n        .forEach((blurredNode) => {\r\n          blurredNode._blur();\r\n        });\r\n\r\n      this.focusedNoodlNodes.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  onClickCapture(e) {\r\n    const focusedNoodlNodes = [];\r\n\r\n    //walk up the dom tree and collect all noodl nodes\r\n    let elem = e.target;\r\n    while (elem) {\r\n      if (elem.noodlNode && elem.noodlNode._focus) focusedNoodlNodes.push(elem.noodlNode);\r\n      elem = elem.parentNode;\r\n    }\r\n\r\n    //blur nodes that weren't part of this click\r\n    this.focusedNoodlNodes.filter((node) => focusedNoodlNodes.indexOf(node) === -1).forEach((node) => node._blur());\r\n\r\n    //focus all new focused nodes\r\n    focusedNoodlNodes.filter((node) => this.focusedNoodlNodes.indexOf(node) === -1).forEach((node) => node._focus());\r\n\r\n    this.focusedNoodlNodes = focusedNoodlNodes;\r\n  }\r\n\r\n  render() {\r\n    const rootComponent = this.props.noodlRuntime.rootComponent;\r\n    if (this.state.waitingForExport) return null;\r\n\r\n    if (!rootComponent) {\r\n      if (this.runningDeployed) {\r\n        return null;\r\n      } else {\r\n        return NoHomeError();\r\n      }\r\n    }\r\n\r\n    const bodyScroll = this.props.noodlRuntime.getProjectSettings().bodyScroll;\r\n\r\n    if (bodyScroll) {\r\n      const style = {\r\n        margin: 0,\r\n        padding: 0,\r\n        minHeight: '100vh',\r\n        alignSelf: 'stretch',\r\n        display: 'flex',\r\n        flexDirection: 'column'\r\n      };\r\n      return (\r\n        <div style={style} onClickCapture={(e) => this.onClickCapture(e)}>\r\n          <div style={{ ...style, isolation: 'isolate' }}>{rootComponent.render()}</div>\r\n          {this.state.popups.length ? (\r\n            <div style={{ ...style, isolation: 'isolate' }}>{this.state.popups.map((p) => p.render())}</div>\r\n          ) : null}\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <div\r\n          style={{\r\n            margin: 0,\r\n            padding: 0,\r\n            overflow: 'hidden',\r\n            width: '100%',\r\n            height: '100%'\r\n          }}\r\n          onClickCapture={(e) => this.onClickCapture(e)}\r\n        >\r\n          {rootComponent.render()}\r\n          {this.state.popups.map((p) => p.render())}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n","import React from 'react';\r\n\r\nexport function NoHomeError() {\r\n  return (\r\n    <div\r\n      style={{\r\n        overflowY: 'auto',\r\n        padding: '24px',\r\n        fontFamily: 'Open Sans',\r\n        fontSize: '16px',\r\n        width: '100vw',\r\n        height: '100vh',\r\n        backgroundColor: '#F57569'\r\n      }}\r\n    >\r\n      <div style={{ marginBottom: '50px', fontWeight: 'bold', display: 'flex', alignItems: 'center' }}>\r\n        <span>ERROR</span>\r\n        <img src=\"ndl_assets/noodl-logo-black.svg\" style={{ marginLeft: 'auto' }} />\r\n      </div>\r\n      <div style={{ margin: '0 auto', alignItems: 'center', display: 'flex', flexDirection: 'column' }}>\r\n        <div style={{ fontSize: '24px', textAlign: 'center', marginBottom: '50px' }}>\r\n          No <img src=\"ndl_assets/home-icon.svg\" style={{ marginRight: '-6px' }} />{' '}\r\n          <span style={{ fontWeight: 'bold' }}>HOME</span> component selected\r\n        </div>\r\n\r\n        <div style={{ textAlign: 'center' }}>\r\n          Click <span style={{ fontWeight: 'bold' }}>Make home</span> as shown below.\r\n        </div>\r\n\r\n        <img style={{ marginTop: '24px' }} srcSet=\"ndl_assets/make-home-instructions@2x.png 2x\" />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport NoodlRuntime from '@noodl/runtime';\r\n\r\nimport registerPolyfills from './src/polyfills';\r\nimport Viewer, { ssrSetupRuntime } from './src/viewer.jsx';\r\n\r\nregisterPolyfills();\r\n\r\nfunction createArgs() {\r\n  // Support SSR\r\n  if (typeof window === 'undefined') {\r\n    return {\r\n      type: 'browser',\r\n      platform: {\r\n        requestUpdate: (callback) => setImmediate(callback),\r\n        getCurrentTime: () => 0,\r\n        objectToString: (o) => JSON.stringify(o, null, 2)\r\n      },\r\n      componentFilter: (c) => !c.name.startsWith('/#__cloud__/')\r\n    };\r\n  }\r\n\r\n  return {\r\n    type: 'browser',\r\n    platform: {\r\n      requestUpdate: (callback) => window.requestAnimationFrame(callback),\r\n      getCurrentTime: () => window.performance.now(),\r\n      objectToString: (o) => JSON.stringify(o, null, 2)\r\n    },\r\n    componentFilter: (c) => !c.name.startsWith('/#__cloud__/')\r\n  };\r\n}\r\n\r\nexport { ssrSetupRuntime };\r\n\r\nexport default {\r\n  render(element, noodlModules, { isLocal = false }) {\r\n    const runtimeArgs = createArgs();\r\n\r\n    if (isLocal) {\r\n      runtimeArgs.platform.isRunningLocally = () => true;\r\n    }\r\n\r\n    const noodlRuntime = new NoodlRuntime(runtimeArgs);\r\n\r\n    ReactDOM.render(React.createElement(Viewer, { noodlRuntime, noodlModules }, null), element);\r\n  },\r\n  renderDeployed(element, noodlModules, projectData) {\r\n    // React SSR adds a 'data-reactroot' attribute on the root element to be able to hydrate the app.\r\n    if (element.children.length > 0 && !!element.children[0].hasAttribute('data-reactroot')) {\r\n      ReactDOM.hydrate(this.createElement(noodlModules, projectData), element);\r\n    } else {\r\n      ReactDOM.render(this.createElement(noodlModules, projectData), element);\r\n    }\r\n  },\r\n  /** This can be called for server side rendering too. */\r\n  createElement(noodlModules, projectData) {\r\n    const noodlRuntime = new NoodlRuntime({\r\n      ...createArgs(),\r\n      runDeployed: true\r\n    });\r\n\r\n    return React.createElement(Viewer, { noodlRuntime, noodlModules, projectData }, null);\r\n  }\r\n};\r\n","export default function registerPolyfills() {\r\n  if (!String.prototype.matchAll) {\r\n    //old iPads and browsers (~2018 or earlier)\r\n    String.prototype.matchAll = function matchAll(pattern) {\r\n      var regex = new RegExp(pattern, 'g');\r\n      var matches = [];\r\n\r\n      var match_result = this.match(regex);\r\n\r\n      for (let index in match_result) {\r\n        var item = match_result[index];\r\n        matches[index] = item.match(new RegExp(pattern));\r\n      }\r\n      return matches;\r\n    };\r\n  }\r\n}\r\n","import NoodlViewerReact, { ssrSetupRuntime } from './noodl-viewer-react';\r\n\r\nexport { NoodlViewerReact, ssrSetupRuntime };\r\nglobalThis.NoodlSSR = { createElement: NoodlViewerReact.createElement, ssrSetupRuntime };\r\n"],"names":["Node","require","guid","Collection","React","NoodlRuntime","useEffect","ForEachComponent","props","didMount","willUnmount","ForEachDefinition","name","displayNodeName","docs","color","category","dynamicports","condition","inputs","initialize","this","_internal","itemNodes","itemOutputSignals","itemOutputs","collection","get","queuedOperations","mountedOperations","on","async","target","_queueOperation","baseIndex","getChildren","indexOf","addItem","args","item","index","removeItem","onItemsCollectionChanged","instance","getProjectSettings","repeaterDisabledWhenUnmounted","isMounted","push","set","items","addDeleteListener","_deleteAllItemNodes","group","displayName","type","value","bindCollection","templateType","enums","label","default","scheduleRefresh","template","templateScript","codeeditor","allowEditOnly","templateFunction","Function","e","console","log","context","editorConnection","sendWarning","nodeScope","componentOwner","id","message","refresh","valueChangedToTrue","outputs","itemActionItemId","getter","prototypeExtensions","updateTarget","targetId","getNodeWithId","undefined","setNodeModel","nodeModel","prototype","call","parent","self","newParent","internal","hasScheduledRefresh","scheduleAfterInputsHaveUpdated","unbindCurrentCollection","instanceOf","off","scheduleCopyItems","getTemplateForModel","model","startsWith","component","substring","pathParts","split","slice","length","join","_mapInputs","itemNode","inputMapFunc","mappings","key","hasInput","setInputValue","createNode","_forEachModel","_forEachNode","inputKey","getId","_inputs","data","_forEachModelChangeListener","ev","componentModel","port","creatorCallbacks","onOutputChanged","oldValue","itemOutputSignalTriggered","forEachActions","getNodesWithType","j","signalAdded","addChild","child","children","i","c","_forEachRemoveInProgress","findChild","tryRemove","_deleteItem","idx","splice","removeListenersWithRef","_deleted","removeChild","deleteNode","size","op","_runQueueOperations","runningOperations","repeaterCreateComponentsAsync","runOps","start","performance","now","shift","setTimeout","_onNodeDeleted","render","createElement","getItemActionParameter","itemActionParameters","hasScheduledCopyItems","itemActionSignal","flagOutputDirty","hasScheduledTriggerItemOutputSignal","scheduleAfterUpdate","_outputs","_output","hasOutput","sendSignalOnOutput","getItemOutput","registerOutputIfNeeded","registerOutput","bind","setInputMappingScript","clearWarning","inputMappingScript","registerInputIfNeeded","registerInput","_typeName","t","module","exports","node","setup","graphModel","_managePortsForNode","_collectPortsInTemplateComponent","templateComponentName","parameters","ports","components","outputName","outputPorts","o","plug","defaultMappings","inputName","inputPorts","replace","sendDynamicPorts","detectRenamed","prefix","_trackComponentOutputs","componentName","event","isRunningLocally","kSampleStepSize","float32ArraySupported","Float32Array","A","aA1","aA2","B","C","calcBezier","aT","getSlope","BezierEasing","points","b","d","arguments","Error","isNaN","isFinite","_str","_css","_p","_mSampleValues","Array","_precomputed","x","mX1","mY1","mX2","mY2","_precompute","_getTForX","getPoints","toString","toCSS","_calcSampleValues","aX","mSampleValues","intervalStart","currentSample","kSplineTableSize","guessForT","initialSlope","aGuessT","currentSlope","newtonRaphsonIterate","aA","aB","currentX","currentT","Math","abs","binarySubdivide","css","ease","linear","easeIn","easeOut","easeInOut","r","f","n","isArray","clsx","ReflectOwnKeys","R","Reflect","ReflectApply","apply","receiver","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","EventEmitter","init","once","emitter","Promise","resolve","reject","errorListener","err","removeListener","resolver","eventTargetAgnosticAddListener","handler","flags","addErrorHandlerIfEventEmitter","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","prepend","m","events","existing","warning","create","newListener","emit","unshift","warned","w","String","count","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","arr","ret","unwrapListeners","arrayClone","listenerCount","copy","addEventListener","wrapListener","arg","removeEventListener","defineProperty","enumerable","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","len","listeners","addListener","prependListener","prependOnceListener","list","position","originalListener","pop","spliceOne","removeAllListeners","keys","rawListeners","eventNames","HASH_UNDEFINED","MAX_SAFE_INTEGER","argsTag","funcTag","genTag","reIsHostCtor","freeGlobal","g","freeSelf","root","arrayIncludes","array","fromIndex","predicate","fromRight","baseFindIndex","baseIsNaN","baseIndexOf","arrayIncludesWith","comparator","arrayPush","values","offset","cacheHas","cache","has","uid","arrayProto","funcProto","objectProto","coreJsData","maskSrcKey","exec","IE_PROTO","funcToString","hasOwnProperty","objectToString","reIsNative","RegExp","Symbol","propertyIsEnumerable","spreadableSymbol","isConcatSpreadable","nativeMax","max","Map","getNative","nativeCreate","Hash","entries","clear","entry","ListCache","MapCache","SetCache","__data__","add","assocIndexOf","other","baseFlatten","depth","isStrict","result","isFlattenable","getMapData","map","object","getValue","isObject","pattern","isFunction","isHostObject","test","func","toSource","baseIsNative","isArrayLikeObject","isArguments","difference","iteratee","includes","isCommon","valuesLength","arrayMap","outer","computed","valuesIndex","baseDifference","otherArgs","thisArg","isObjectLike","isLength","isArrayLike","tag","COMPARE_PARTIAL_FLAG","COMPARE_UNORDERED_FLAG","arrayTag","asyncTag","boolTag","dateTag","errorTag","mapTag","numberTag","nullTag","objectTag","promiseTag","proxyTag","regexpTag","setTag","stringTag","undefinedTag","weakMapTag","arrayBufferTag","dataViewTag","reIsUint","typedArrayTags","freeExports","nodeType","freeModule","moduleExports","freeProcess","process","nodeUtil","binding","nodeIsTypedArray","isTypedArray","arraySome","mapToArray","forEach","setToArray","transform","nativeObjectToString","Buffer","Uint8Array","symToStringTag","toStringTag","nativeGetSymbols","nativeIsBuffer","isBuffer","nativeKeys","DataView","Set","WeakMap","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","symbolProto","symbolValueOf","valueOf","Stack","eq","baseGetTag","isOwn","unmasked","getRawTag","baseIsArguments","baseIsEqual","bitmask","customizer","stack","equalFunc","objIsArr","othIsArr","objTag","getTag","othTag","objIsObj","othIsObj","isSameTag","equalArrays","byteLength","byteOffset","buffer","convert","isPartial","stacked","equalByTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","getAllKeys","objLength","skipCtor","objValue","othValue","compared","objCtor","constructor","othCtor","equalObjects","baseIsEqualDeep","arrLength","othLength","seen","arrValue","othIndex","keysFunc","symbolsFunc","baseGetAllKeys","getSymbols","isMasked","pairs","LARGE_ARRAY_SIZE","resIndex","symbol","arrayFilter","isIndex","ArrayBuffer","Ctor","ctorString","baseUnary","inherited","isArr","isArg","isBuff","isType","skipIndexes","baseTimes","arrayLikeKeys","baseKeys","ReactPropTypesSecret","emptyFunction","emptyFunctionWithReset","resetWarningCache","shim","propName","location","propFullName","secret","getShim","isRequired","ReactPropTypes","bigint","bool","number","string","any","arrayOf","element","elementType","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","_typeof","obj","iterator","_DraggableCore","nodeInterop","__esModule","_getRequireWildcardCache","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","desc","_interopRequireWildcard","_propTypes","_interopRequireDefault","_reactDom","_clsx2","_domFns","_positionFns","_shims","_log","_excluded","cacheBabelInterop","cacheNodeInterop","_extends","assign","source","enumerableOnly","symbols","filter","sym","_objectSpread","_defineProperty","getOwnPropertyDescriptors","defineProperties","_arrayLikeToArray","arr2","_defineProperties","descriptor","configurable","writable","_setPrototypeOf","p","setPrototypeOf","__proto__","_assertThisInitialized","ReferenceError","_getPrototypeOf","Draggable","_React$Component","subClass","superClass","_inherits","Constructor","protoProps","staticProps","Derived","hasNativeReflectConstruct","_super","construct","sham","Proxy","Boolean","_isNativeReflectConstruct","Super","NewTarget","_possibleConstructorReturn","_this","_classCallCheck","coreData","onStart","createDraggableData","setState","dragging","dragged","uiData","newState","y","bounds","slackX","slackY","_getBoundPosition2","getBoundPosition","_arrayWithHoles","_i","_s","_e","_arr","_n","_d","next","done","_iterableToArrayLimit","minLen","from","_unsupportedIterableToArray","_nonIterableRest","newStateX","newStateY","deltaX","deltaY","onDrag","onStop","_this$props$position","defaultPosition","prevPropsPosition","isElementSVG","_ref","_ref2","window","SVGElement","findDOMNode","_this$props$nodeRef$c","_this$props","_this$props$nodeRef","nodeRef","current","_clsx","_this$props2","axis","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","positionOffset","draggableCoreProps","scale","excluded","sourceKeys","_objectWithoutPropertiesLoose","sourceSymbolKeys","_objectWithoutProperties","style","svgTransform","draggable","validPosition","transformOpts","canDragX","canDragY","createSVGTransform","createCSSTransform","className","onDragStart","onDragStop","cloneElement","Children","only","Component","propTypes","left","right","top","bottom","dontSetMe","defaultProps","_slicedToArray","eventsFor","move","stop","dragEventFor","DraggableCore","_len","_key","lastX","NaN","lastY","touchIdentifier","onMouseDown","allowAnyClick","button","thisNode","ownerDocument","body","disabled","defaultView","handle","matchesSelectorAndParentsTo","cancel","preventDefault","getTouchIdentifier","getControlPosition","coreEvent","createCoreData","mounted","enableUserSelectHack","addUserSelectStyles","addEvent","handleDrag","handleDragStop","grid","_snapToGrid2","snapToGrid","MouseEvent","document","createEvent","initMouseEvent","_snapToGrid4","removeUserSelectStyles","removeEvent","handleDragStart","onTouchStart","passive","_this$props2$nodeRef","onMouseUp","onTouchEnd","offsetParent","_require","addClassName","el","inputOptions","options","capture","attachEvent","doc","styleEl","getElementById","innerHTML","getElementsByTagName","appendChild","controlPos","translation","getTranslation","_getPrefix","browserPrefixToKey","getTouch","identifier","targetTouches","findInArray","changedTouches","innerHeight","height","clientHeight","computedStyle","getComputedStyle","int","paddingTop","paddingBottom","innerWidth","width","clientWidth","paddingLeft","paddingRight","matchesSelector","selector","baseNode","parentNode","offsetXYFromParent","evt","offsetParentRect","getBoundingClientRect","clientX","scrollLeft","clientY","scrollTop","outerHeight","borderTopWidth","borderBottomWidth","outerWidth","borderLeftWidth","borderRightWidth","removeClassName","detachEvent","selection","empty","getSelection","removeAllRanges","matchesSelectorFunc","method","unitSuffix","defaultX","defaultY","classList","match","remove","browserPrefixToStyle","prop","toLowerCase","getPrefix","prefixes","_window$document","_window$document$docu","documentElement","str","out","shouldCapitalize","toUpperCase","kebabToTitleCase","_default","isStart","isNum","cloneBounds","boundNode","ownerWindow","querySelector","HTMLElement","boundNodeEl","nodeStyle","boundNodeStyle","offsetLeft","marginLeft","offsetTop","marginTop","marginRight","marginBottom","min","draggableCore","touchObj","pendingX","pendingY","round","callback","a","parseInt","num","_routers","_navigationQueue","navigate","routerNames","registerRouter","router","hasNavigated","reset","deregisterRouter","getPagesForRouter","routers","matchingRouters","pageComponents","pages","routes","getPageInfoForComponent","find","onNavigated","routerName","page","Noodl","Events","RouterHandler","aa","ba","q","Date","ca","da","FontFace","cssText","setAttribute","createTextNode","u","insertBefore","lastChild","v","z","rel","href","media","onload","onerror","src","onreadystatechange","readyState","tagName","D","E","F","G","I","J","H","ga","substr","ha","h","classes","L","K","ja","M","N","O","P","Q","s","fonts","load","fa","then","race","clearTimeout","S","T","navigator","userAgent","la","U","offsetWidth","serif","V","ma","W","X","na","oa","qa","l","k","xa","vendor","ra","sa","ta","ua","timeout","ia","ka","pa","fontfamily","fontStyle","fontWeight","projectId","version","api","urls","families","testStrings","ya","za","latin","cyrillic","greek","khmer","Hanuman","Aa","thin","extralight","ultralight","light","regular","book","medium","semibold","demibold","bold","extrabold","ultrabold","black","heavy","Ba","italic","normal","Ca","Ea","Fa","Arimo","Cousine","Tinos","Ga","Ha","text","va","Da","encodeURIComponent","wa","Typekit","config","fn","__webfontfontdeckmodule__","weight","hostname","ea","Y","custom","fontdeck","monotype","typekit","google","Z","NodeContext","EditorConnection","generateNodeLibrary","ProjectSettings","GraphModel","NodeDefinition","EditorModelEventsHandler","Services","EdgeTriggeredInput","asyncPool","platform","noodlModules","eventEmitter","updateScheduled","rootComponent","_currentLoadedData","isWaitingForExport","errorHandlers","frameNumber","dontCreateRootComponent","componentFilter","runningInEditor","runDeployed","requestUpdate","getCurrentTime","webSocketOptions","noodlRuntime","runtimeType","scheduleUpdate","_setupEditorCommunication","registerGraphModelListeners","registerNode","prefetchBundles","bundleNames","numParallelFetches","fetchComponentBundle","objectEquals","every","exportData","isEmpty","setData","componentIndex","allBundles","reload","onModelUpdateReceived","onMetaDataUpdateReceived","sendNodeLibrary","setDebugInspectorsEnabled","enabled","registerModule","nodes","nodeDefinition","registerComponentModel","deregisterComponentModel","definedNode","defineNode","nodeRegister","register","setupNumberedInputDynamicPorts","_setRootComponent","rootComponentName","createComponentInstanceNode","setRootComponent","graphData","_disableLoad","importEditorData","_doUpdate","currentFrameTime","update","setProjectSettings","settings","projectSettings","getNodeLibrary","generateProjectSettings","getSettings","nodeLibrary","projectsettings","JSON","stringify","lastSentNodeLibrary","connectToEditor","address","connect","EditorMetaDataEventsHandler","handleEvent","addErrorHandler","reportError","eh","getMetaData","url","getUrl","getName","Model","CloudFile","_protectedFields","_common","_User","_removeProtectedFields","_data","CloudStore","modelScope","_initCloudServices","_fromJSON","collectionName","_deserializeJSON","_serializeObject","_collections","cloudServices","appId","endpoint","dbVersionMajor","_makeRequest","path","_noodl_cloud_runtime_version","xhr","XMLHttpRequest","json","parse","response","responseText","status","success","open","setRequestHeader","_noodl_cloudservices","masterKey","_cu","localStorage","currentUser","sessionToken","onUploadProgress","upload","onprogress","pe","content","File","send","fetch","headers","catch","query","_method","where","limit","skip","include","select","order","sort","results","aggregate","grouping","_g","_id","objectId","res","distinct","property","excludeKeys","ACL","acl","_obj","increment","properties","__op","amount","save","createdAt","updatedAt","delete","addRelation","_content","objects","__type","targetObjectId","targetClass","removeRelation","uploadFile","file","contentType","deleteFile","_toJSON","schema","_type","iso","toISOString","cloudFile","exists","latitude","longitude","_isArrayOfObjects","_class","_instance","forScope","_cloudStore","invalidateCollections","ConfigService","cacheDuration","_getConfig","params","configCachePending","configCache","ttl","clearCache","_value","convertVisualFilter","queryParameters","combinator","rules","_res","_op","cond","operator","input","$relatedTo","relatedTo","relationProperty","$exists","$gt","$gte","$lt","$lte","$eq","$ne","$regex","$options","compareObjects","matchesQuery","convertVisualSorting","sorting","convertFilterOp","$in","modelId","relationKey","opAndValue","$nin","_v","$text","$search","$term","$caseSensitive","term","$language","language","caseSensitive","$diacriticSensitive","diacriticSensitive","$nearSphere","$maxDistanceInMiles","$maxDistanceInKilometers","maxDistanceInKilometers","$maxDistanceInRadians","maxDistanceInRadians","$within","$box","gp","$geoWithin","$polygon","QueryUtils","_cloudstore","cloudstore","_results","objectOrId","record","notify","recordId","targetRecordId","targetRecord","targetClassName","poolLimit","iteratorFn","executing","all","bItems","aItems","aKeys","keyIndex","bKeys","removeAtIndex","addAtIndex","contains","collections","createSetter","currentValue","currentWarnings","setWarning","nodeId","warningKeys","clearWarnings","EventSender","ActiveWarnings","opts","_opts","ws","webSocketClass","WebSocket","wsOptions","reconnectOnClose","enableDebugger","lastSendTimestamp","sendQueue","sendTimer","activeWarnings","socket","clientId","cmd","reconnect","code","reason","debugInspectorsEnabled","inspectors","connectionId","pubsub","routeMessage","isConnected","OPEN","dt","trySend","msg","WeakSet","getCircularReplacer","chunk","sendInspectId","sendSelectComponent","sendPulsingConnections","connectionMap","connectionsToPulse","connection","connections","sendDebugInspectorValues","sendConnectionValue","dynamicPortsHash","hash","renamed","before","after","_detectRename","patterns","nodeid","sendPatches","patches","requestFullExport","requestNoodlModules","serviceRequests","sendServiceRequest","request","token","close","nodelibrary","sendComponentMetadata","sendProjectMetadata","array1","array2","valueSet","applyPortDelta","newPorts","existingInputs","getInputPorts","inputPortsToRemove","inputPortsToAdd","updateInputPortTypes","removeInputPortWithName","portName","addInputPort","setInputValueOnNodeInstancesWithModel","updateOutputPortTypes","existingOutputs","getOutputPorts","outputPortsToRemove","outputPortsToAdd","removeOutputPortWithName","addOutputPort","getNodesWithIdRecursive","queueInput","getComponentWithName","eventHandlers","nodeAdded","importEditorNodeData","parentId","childIndex","nodeRemoved","hasNodeWithId","removeNodeWithId","connectionAdded","addConnection","connectionRemoved","removeConnection","targetNodeModel","getConnectionsToPort","targetPort","getDefaultValueForInput","parameterChanged","allParams","oldParameters","param","setParameter","parameterName","parameterValue","nodeAttached","setNodeParent","nodeDetached","addRootId","componentAdded","importComponentFromEditorData","componentRemoved","removeComponentWithName","rootAdded","portAdded","portRemoved","nodePortRenamed","renameInputPortOnNodeWithId","oldName","renameOutputPortOnNodeWithId","componentInstance","componentPortsUpdated","instancePortsChanged","componentRenamed","renameComponent","newName","settingsChanged","setSettings","metadataChanged","setMetaData","componentMetadataChanged","setMetadata","variantParametersChanged","variant","updateVariant","updateVariantParameter","variantName","variantTypeName","getVariant","getAllNodesWithVariantRecursive","getParameter","variantDeleted","deleteVariant","variantChanged","setVariant","variantRenamed","oldVariantName","defaultStateTransitionChanged","setDefaultStateTransition","curve","stateTransitionsChanged","setStateTransitionParamter","variantDefaultStateTransitionChanged","updateVariantDefaultStateTransition","variantStateTransitionsChanged","updateVariantStateTransition","routerIndexChanged","routerIndex","listenersWithRefs","eventName","ref","callbacks","s4","floor","random","getAbsoluteUrl","userFunctionsCache","JavascriptNodeParser","_initializeAPIs","userCode","getCodePrefix","define","script","apis","getComponentScopeForNode","_afterSourced","userObject","change","run","destroy","definedObject","_userObjectExtended","_extended","setOutputs","states","methods","old","_oldInputs","changed","changedFunction","signals","_scriptExtend","Inputs","Outputs","Signals","Setters","_Node","OnInit","OnDestroy","destory","changedInputs","OnInputsChanged","createFromCode","createFromURL","DONE","parseAndAddPortsFromScript","_addPortsFromMatch","unique","skipInputs","matchAll","inputType","inputGroup","inputPrefix","skipOutputs","skipOutputSignals","outputPrefix","skipRegularOutputs","getPorts","inputPort","_componentScopes","componentId","getInstanceId","componentObject","parentComponentObjectId","getParentComponent","getRoots","getVisualParentNode","parentNodeScope","_findParentComponentStateModelId","parentComponentObject","ParentObject","RepeaterObject","_findForEachModel","createNoodlAPI","models","_models","proxies","_modelProxyHandler","_randomString","chars","modelData","setAll","fill","temp","forceChange","silent","toJSON","Scope","NodeModel","ComponentModel","roots","metadata","addNode","getAllNodes","findIndex","con","sourceId","sourcePort","getConnectionsFromPort","sourcePortName","targetPortName","getConnectionsFrom","getConnectionsTo","rootId","removeRootId","getAllConnections","getInputPort","getOutputPort","childModel","newParentModel","nodeData","createFromExportData","rename","getMetadata","componentData","addComponent","getBundleContainingComponent","componentToBundleMap","getBundlesContainingSheet","sheetName","bundles","isOnDefaultSheet","getBundleDependencies","bundleName","recurse","bundle","dep","dependencies","variants","setAllMetaData","setRootComponentName","componentNames","hasComponentWithName","getAllComponents","_addComponentPorts","_onNodeAdded","_onNodeRemoved","_onNodeWasRemoved","getVariants","typename","stateParameters","transition","defaultStateTransitions","stateTransitions","setParameters","setStateParameters","setStateTransitions","parameter","stateTransition","OutputProperty","_dirty","_inputValues","_inputConnections","_outputList","_isUpdating","_inputValuesQueue","_afterInputsHaveUpdatedCallbacks","_signalsSentThisUpdate","_deleteListeners","_isFirstUpdate","_valuesFromConnections","updateOnDirtyFlagging","getInputValue","units","defaultUnit","deregisterInput","registerInputs","getInput","currentInputValue","unit","newValue","styles","resolveColor","eval","showGlobally","output","newOutput","owner","onFirstConnectionAdded","onLastConnectionRemoved","deregisterOutput","hasConnections","registerOutputs","getOutput","connectInput","sourceNode","registerConnection","_setValueFromConnection","outputValue","connectionSentValue","flagDirty","removeInputConnection","sourceNodeId","inputsToPort","deregisterConnection","isInputConnected","some","_updatedAtIteration","updateIteration","_updateIteration","_cyclicLoop","_updateDependencies","inputNames","hasMoreInputs","queue","afterInputCallbacks","scheduleNextFrame","nodeIsDirty","_cyclicWarningSent","isWarningTypeEnabled","connectedPorts","_performDirtyUpdate","flagDependeesDirty","sendValue","flagAllOutputsDirty","connectionSentSignal","_hasInputBeenSetFromAConnection","queueValue","_onNodeModelParameterUpdated","_onNodeModelVariantUpdated","deleteListener","_getVisualStates","defaultValue","_resetReactVirtualDOM","NodeRegister","TimerScheduler","Variants","_dirtyNodes","callbacksAfterUpdate","eventSenderEmitter","globalValues","globalsEventEmitter","timerScheduler","componentModels","connectionsToPulseChanged","debugInspectors","connectionPulsingCallbackScheduled","_outputHistory","_signalHistory","warningTypes","bundleFetchesInFlight","getNodeScope","onDebugInspectorsUpdated","inspector","fromId","fromProperty","updateDirtyNodes","loop","iterations","isUpdating","dirtyNodes","hasPendingTimers","runTimers","runningTimers","newTimers","clearDebugInspectors","setGlobalValue","getGlobalValue","fetchBundle","bundleUrl","Env","promise","getComponentModel","bundleDep","hasComponentModelWithName","extraProps","setComponentModel","_formatConnectionValue","timestamp","inputPortName","clearOldConnectionPulsing","_getDebugInspectorValueForNode","getInspectInfo","info","valuesToSend","inspectorValue","sendGlobalEventFromEventSender","channelName","inputValues","setPopupCallbacks","onShow","onClose","onShowPopup","onClosePopup","showPopup","popupComponent","popupNode","popupParent","senderNode","createPrimitiveNode","bodyScroll","closePopupNodes","_setCloseCallback","action","requestAnimationFrame","setWarningTypes","hasNode","inputMetadata","getNodeMetadata","registerNumberedInput","oldRegisterInputIfNeeded","exportDynamicPorts","useVariants","allowChildren","allowChildrenWithCategory","singleton","connectionPanel","allowAsChild","visualStates","panels","usePortAsLabel","portLabelTruncationMode","deprecated","haveComponentPorts","allowAsExportRoot","nodeDoubleClickAction","searchTags","NodeConstructor","setUnitType","editorName","exportToEditor","inputPriority","tooltip","tab","popout","allowVisualStates","allowConnectionsOnly","registerOutputsMetadata","nodeScopeDidInitialize","defaultValues","inputsMetadata","numberedInputs","registerNumberedInputs","updatePorts","portNames","numPorts","displayPrefix","collectPorts","flat","registerSetupFunctionForNumberedInputs","extend","obj1","obj2","oldInit","formatPort","portData","plugType","description","typecasts","to","colors","base","baseHighlighted","header","headerHighlighted","outline","outlineHighlighted","visual","javascript","signal","highlighted","pulsing","nodetypes","shortDesc","haveComponentChildren","nodeTypes","_constructors","nodeMetadata","nodeObj","shortDocs","dp","channelPort","dynamicPortGroup","formatDynamicPorts","selectorNames","conditionalPortNames","nodeIndex","coreNodes","subCategories","moduleNodes","getInputType","title","canArrangeInGroups","hidden","NodeScope","componentIdCounter","ComponentInstanceNode","childRoot","componentOutputValues","componentOutputs","componentInputs","instanceId","registerComponentInputPort","registerComponentOutputPort","forceUpdate","removeNodesWithId","componentInput","setOutputFromComponentOutput","setChildRoot","prevChildRoot","newChildRoot","isChild","getChildRootIndex","getChildRoot","triggerDidMount","setChildIndex","componentOutput","getRef","cachedChildren","AndNode","and","currentSelectedIndex","indexChanged","trueString","falseString","currentInput","inputChanged","ConditionNode","scheduleEvaluate","ontrue","onfalse","isfalse","CounterNode","startValue","startValueSet","limitsEnabled","limitsMin","limitsMax","increase","decrease","currentCount","countChanged","CloudFileNode","DbCollectionNode","collectionChangedScheduled","collectionChangedCallback","cloudStoreEvents","currentQuery","_addModelAtCorrectIndex","storageSettings","firstItemId","firstItem","fetched","failure","setCollectionName","scheduleFetch","setCollection","setError","fetchScheduled","_c","getStorageFilter","getStorageLimit","getStorageSkip","getStorageFetchTotalCount","storageTotalCount","visualFilter","visualSorting","filterFunc","filterCode","filterVariables","_filter","_sort","_filterCb","filterFuncArgs","userOutputGetter","setVisualFilter","setVisualSorting","setQueryParameter","dynamicSignals","storageFetch","dynamicSetters","visualSort","userInputSetter","dbCollections","systemCollections","_findRelations","relations","uniqueInputs","_collectInputs","variables","ConfigNodeDefinition","getConfig","useDevValue","devValue","configKey","setInternal","configSchema","valueType","isCloud","masterKeyOnly","addInputProperties","def","_def","_methods","_setInputValue","addModelId","_includeInputs","includeInputs","_includeOutputs","includeOutputs","idSource","setModel","identifierOf","identifierDisplayName","setModelID","setCollectionID","collectionId","addBaseInfo","_includeInputProperties","includeInputProperties","_includeRelations","includeRelations","scheduleOnce","cb","checkWarningsBeforeCloudOp","_updatePorts","_typeMap","_additionalDynamicPorts","addRelationProperty","targetModelId","setRelationProperty","addAccessControl","accessControl","autoName","accessControlRules","ac","parentItemId","setAccessControl","_getACL","_rule","rule","read","write","currentUserId","UserId","cu","_getCurrentUser","userId","userid","role","_parts","DbModelCRUDBase","AddDbModelRelationNodeDefinition","store","scheduleAddRelation","relationAdded","validateInputs","_warning","scheduleRemoveRelation","relationRemoved","ModelNodeDefinition","relationModelIds","onModelChangedCallback","scheduleStore","DeleteDbModelPropertiedNodeDefinition","storageDelete","deleted","ModelScope","FilterDBModelsNode","scheduleFilter","filterSettings","filterParameters","filteredCollection","modified","getLimit","getSkip","filtered","setFilterParameter","_supportedTypes","Pointer","_addBaseInfo","_addModelId","_addInputProperties","_types","inputTypes","_pushInputValues","_defaultValueForType","boolean","date","_allKeys","validProperties","keysToSet","hasScheduledStore","_setInputType","dirtyValues","scheduleSetModel","hasScheduledSetModel","NewDbModelPropertiedNodeDefinition","storageInsert","sourceObjectId","created","initValues","ModelCRUDBase","NewModelNodeDefinition","new","scheduleNew","hasScheduledNew","newModel","RestNode","outputValues","outputValuesProxy","inspectData","resource","requestScript","requestFunc","responseScript","responseFunc","cancelFetch","canceled","getScriptOutputValue","setScriptInputValue","hasScheduledFetch","doFetch","doResponse","doExternalFetch","_xhr","sentResponse","statusCode","responseType","getResponseHeader","rawResponse","responseData","onabort","raw","abort","_parseScriptForErrors","_exists","scriptWithoutComments","SetDbModelPropertiedNodeDefinition","storeType","scheduleSave","storeProperties","stored","SetModelPropertiedNodeDefinition","DateToStringNode","formatString","_format","dateString","onError","format","getDate","month","getMonth","monthShort","Intl","DateTimeFormat","year","getFullYear","yearShort","hours","getHours","minutes","getMinutes","seconds","getSeconds","ExpressionNode","focusPort","scope","hasScheduledEvaluation","cachedValue","currentExpression","compiledFunction","expression","functionPreamble","newInputs","parsePorts","inputsToAdd","inputsToRemove","_scheduleEvaluateExpression","isTrue","isFalse","isTrueEv","isFalseEv","lastValue","_calculateExpression","_compileFunction","inputValue","compiledFunctionsCache","portsToIgnore","addPort","identifiers","editAsType","evalCompileWarnings","invert","InverterNode","OrNode","RunTasksDefinition","maxRunningTasks","activeTasks","stopOnFailure","taskTemplate","scheduleRun","scheduleAbort","aborted","hasScheduledRun","hasScheduledAbort","_isInputConnected","task","taskComponent","createTaskComponent","runningTasks","numTasks","failedTasks","completedTasks","queuedTasks","startTask","checkDone","_deleteAllTasks","logJavaScriptNodeError","SimpleJavascriptNode","scriptInputs","scriptOutputs","functionScript","parseScript","runScheduled","runScript","_isSignalType","_sendSignal","setScriptInputType","setScriptOutputType","outputTypes","AsyncFunction","inputTypeEnums","_outputTypeEnums","_parseScriptForErrorsAndPorts","StringFormatDefinition","cachedResult","resultDirty","formatValue","multiline","scheduleFormat","formatted","matches","formatScheduled","StringMapperNode","mappedString","scheduleMapping","inputString","currentInputString","defaultMapping","doMapping","startIndex","endIndex","end","UniqueIdNode","SetUserPropertiesNodeDefinition","userProperties","email","username","storeScheduled","UserService","setUserProperties","setUserProperty","_ignoreKeys","UserNodeDefinition","userService","setUserModel","authenticated","fetchCurrentUser","getUserProperty","BooleanNode","createDefinition","cast","NumberNode","VariableBase","StringNode","onChanged","latestValue","setValueTo","saveValue","savedValue","componentInstanceChildren","connectionData","targetNode","setNodeParameters","inputA","inputB","createNodeFromModel","insertNodeInTree","parentInstance","nodeInstance","findNodesWithIdRec","getNodesWithTypeRecursive","getAllNodesRecursive","getAllNodesRec","onNodeModelRemoved","connectionModel","conn","connectionFrom","connectionTo","sendEventFromThisScope","propagation","sendEventInThisScope","_exclude","eventReceivers","eventReceiver","getChannelName","_lastUpdateIteration","valuesSendThisIteration","modules","addModuleSettings","Timer","scheduler","duration","_isRunning","_hasCalledOnStart","repeatCount","delay","requestFrameCallback","requestFrame","scheduleTimer","stopTimer","_wasStopped","isRunning","durationLeft","_durationLeft","createTimer","timer","currentTime","remainingTimers","finishedTimers","timersThisFrame","_start","localT","onRunning","onFinish","_url","baseUrl","onVariantUpdated","nodesWithVariant","memo","getTarget","styleTarget","HTMLIFrameElement","contentDocument","head","stylesInDom","getIndexByIdentifier","modulesToDom","idCountMap","sourceMap","references","updater","addStyle","insertStyleElement","attributes","nonce","insert","textStore","replaceText","replacement","applyToSingletonTag","styleSheet","cssNode","childNodes","applyToTag","removeAttribute","btoa","unescape","firstChild","singletonCounter","styleIndex","removeStyleElement","atob","lastIdentifiers","newList","newLastIdentifiers","_index","cloudfunctions","functionName","deployVersion","files","onProgress","navigation","_noodlRuntime","componentPath","targetPageName","navigateToPath","hashPath","urlPath","navigationPathType","compiledUrl","history","pushState","dispatchEvent","PopStateEvent","users","logIn","password","signUp","_currentUser","logOut","Properties","_user","emailVerified","time","lowerMargin","upperMargin","wrapperSize","distance","speed","deceleration","momentumData","swipeBounceTime","destination","swipeTime","rate","hooks","trigger","eventTypes","momentum","EaseCurves","easeOutQuartic","easeInQuartic","easeInOutQuartic","easeOutCubic","easeInCubic","easeInOutCubic","easeOutQuadratic","easeInQuadratic","easeInOutQuadratic","FontLoader","loadedFontFamilies","fontCssFamiliesAdded","fontCallbacks","fontFamily","loadFont","fontURL","family","newStyle","fontactive","callWhenFontIsActive","SubAnimation","endValue","startMode","hasSampledStartValue","animation","setCurrentValue","play","playToEnd","updateStartValue","getTargetsCurrentValue","playToStart","replayToEnd","replayToStart","valueConnections","jumpToStart","jumpToEnd","AnimationNode","_isPlayingToEnd","animations","cubicBezierPoints","cubicBezierFunction","easingCurve","easeCurve","updateCubicBezierFunction","cubicBezierP1X","cubicBezierP1Y","cubicBezierP2X","cubicBezierP2Y","hasReachedStart","hasReachedEnd","indexStep","cubicBezierEase","_registerAnimationGroup","subAnimation","dotIndex","animationName","ComponentState","propertyName","CollectionNode","sourceCollectionChangedCallback","pendingSourceCollection","setSourceCollection","modifyId","scheduleSetCollection","sourceCollection","_copySourceItems","hasScheduledSetCollection","_convertFilterOp","filters","_filters","_where","$and","filterOps","isEqual","modelPortsHash","previousProperties","saved","storageSave","storageNew","_hasChangesPending","_getModelInitData","onRelationAdd","onRelationRemove","setRelationModelId","modelInitCode","initCode","setModelInitCode","$ndlCollectionName","$ndlModelInitCode","propertyRenamed","detectRename","modelInfo","VariableNodeDefinition","variablesModel","setVariableName","GlobalsNode","globalsEmitter","_newOutputValueReceived","_cachedInputValues","newOutputValueReceivedCallback","GyroscopeNode","alpha","beta","gamma","onEvent","onDeviceOrientation","rotationX","rotationY","rotationZ","NumberBlend","blendValue","clamp","updateResult","graphEventEmitter","ParentComponentState","onComponentStateNodesChanged","findParentComponentStateModelId","setModelId","updateComponentState","parentComponentName","ScriptDownloadDefinition","loaded","scripts","loadedScripts","startLoad","scheduleUpdateScripts","loadStarted","updateScripts","removeLoadTerminator","terminatorId","elem","updateScriptsScheduled","scriptElements","scriptsInHead","trim","scriptObj","onLoadedScript","SignalToIndexNode","currentIndex","onValueChangedToTrue","selectors","signalTriggered","StringSelectorNode","TransitionNode","currentNumber","numberInitialized","animationStarted","setCurrentNumberEnabled","overrideValue","_animation","targetValue","setCurrentNumber","atTargetValue","ClosePopupNode","resultValues","closeActions","scheduleClose","setResultValue","closeCallback","hasScheduledClose","closeAction","closeActionTriggered","NavigateBack","scheduleNavigate","backActions","hasScheduledNavigate","_setBackCallback","backCallback","backAction","backActionTriggered","NavigateToPathNode","openInNewTab","queryNames","formattedPath","setParam","setQuery","Transitions","NavigationHandler","Navigate","transitionParams","pageParams","backResults","mode","navigationMode","navigated","setTransitionParam","setPageParam","getBackResult","setTargetPageId","pageId","setTransition","pageStack","ps","targetPageId","targetComponentName","backNode","_trackTargetComponent","targetCompoment","_trackPageStack","_pageStacks","_performNavigation","registerPageStack","hasReset","deregisterPageStack","pathParams","queryParams","_setPageParams","getPageParam","RouterNavigate","setTargetPage","setRouter","popupParams","closeResults","show","scheduleShow","Closed","setPopupParam","getCloseResult","hasScheduledShow","None","Push","Popup","Transition","super","timing","dur","forward","back","static","direction","fadein","zoom","setStyle","opacity","crossfade","dist","targets","Up","Down","Left","Right","_t","darkOverlay","darkoverlay","darkOverlayAmount","darkoverlayamount","_frame","frame","transitionForward","startTime","AnimateToValue","setRGB","hex","componentToHex","rgb0","rgb1","rgb2","ColorBlendNode","resultColor","updateColor","rgb","clampedBlendValue","getColor","extendSetComponentObjectProperties","getComponentObjectId","ComponentObject","ParentComponentObject","Base","CloudFunctionNode","paramsValues","lastCallResult","scheduleCall","setParamsValue","hasScheduledCall","doCall","resultsValues","getResultsValue","setFunctionName","CollectionClearNode","CollectionInsertNode","CollectionNewNode","CollectionRemoveNode","sorter","_a","_b","FilterCollectionNode","getFilter","option","getSort","applyFilter","ForEachActionsDefinition","removeCompleted","removeCompletedCallback","added","itemId","getItemId","itemActionTriggered","signalItemAction","actionParameters","setItemActionParameter","MapCollectionNode","scheduleMap","mapScript","mapCode","mapFunc","mappedCollection","mappedModels","SetVariableNodeDefinition","setWith","do","setValue","CSVNode","csv","scheduleParseData","hasScheduledParseData","parseData","strData","strDelimiter","prevLastIndex","objPattern","arrData","arrMatches","lastIndex","strMatchedValue","strMatchedDelimiter","CSVToArray","fields","row","EventReceiver","outputNames","eventReceived","_isEnabled","consume","onEventReceivedCallback","registerListenersForChannel","eventData","onEventReceived","onEventReceiver","_collectPayloadPorts","matching","portKeys","payload","_trackEventSender","sendEvent","_channelName","Javascript","outputProperties","setupScheduled","runNextFrameScheduled","isWaitingForExternalFileToLoad","useExternalFile","runFunction","destroyFunction","setupFunction","hasParsedCode","signalScheduled","killed","inputQueue","userFunctionScope","createComponent","deleteComponent","runNextFrame","onFrameStart","_callDestroyFunction","parser","_onCodeParsed","externalFile","scheduleSetup","isSignal","_typename","_callRunFunction","_callSignalFunction","_callSetupFunction","scheduleSignal","_inputTypeEnums","onCodeParsed","_parseAndSourceJavascript","_ports","NumberRemapperNode","_currentInputValue","_remappedValue","_minInputValue","_maxInputValue","_minOutputValue","_maxOutputValue","_clampOutput","allowConnectionOnly","_calculateNewOutputValue","minInputValue","maxInputValue","minOutputValue","maxOutputValue","remappedValue","normalizedValue","OpenFilePicker","inputElement","accept","acceptedFileTypes","onchange","click","sizeInBytes","ScreenResolution","_viewportSizeChanged","aspectRatio","previousStates","previousValues","setRGBA","numComponents","rgbaToHex","rgba","StatesNode","useTransitions","currentValues","stateParameterTypes","startValues","bezierEaseCurves","transitionFuncs","valuesAreInitialised","stateValues","valueTypes","targetValues","transitionCurves","ms","rgba2","rgba0","rgba1","scheduleGoToState","startState","toggle","nextIdx","currentState","stateChanged","parts","valueName","search","setCurrentState","jumpToState","updateAtStatePorts","goToState","hasScheduledGoToState","parameterType","transitionCurve","stateRenamed","valueRenamed","Switch","initialized","emitSignals","flip","onFromStart","switched","switchedToOn","switchedToOff","restart","startDelay","timerStarted","timerFinished","UploadFile","progressTotal","total","progressLoaded","errorStatus","progressChanged","progressTotalBytes","progressLoadedBytes","progressLoadedPercent","LoginNodeDefinition","login","scheduleLogIn","logInScheduled","_context","_graphModel","LogOutNodeDefinition","scheduleLogOut","logOutScheduled","RequestPasswordResetNodeDefinition","scheduleRequestPasswordReset","sendScheduled","requestPasswordReset","ResetPasswordNodeDefinition","scheduleResetPassword","newPassword","resetPasswordScheduled","resetPassword","SendEmailVerificationNodeDefinition","scheduleSendEmailVerification","sendEmailVerification","SignUpNodeDefinition","signup","scheduleSignUp","signUpScheduled","_parameters","_event","getUserFromLocalStorage","getUserModel","_iid","additionalUserProps","getCurrentUser","propsToSave","verifyEmail","new_password","VerifyEmailNodeDefinition","verify","scheduleVerifyEmail","ValueChangedNode","changeCount","valueChanged","_refCount","CSSDefinition","styleId","getStyleRefId","removeStyleDeclaration","updateStyle","styleRefId","styleObj","ReactDOM","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","globalThis","nmd","paths","nc","GraphWarnings","_bindComponentModel","_evaluateWarnings","lenth","level","dispose","Highlighter","highlightedNodes","selectedNodes","isUpdatingHighlights","div","overflow","zIndex","pointerEvents","highlightRootDiv","windowBorderDiv","createHighlightDiv","boxShadow","setWindowSelected","updateHighlights","domNode","rect","highlight","highlightNodesWithId","getNodes","disableHighlight","selectNodesWithId","deselectNodes","Inspector","onInspect","onHighlight","onDisableHighlight","onMouseMove","noodlNode","findNoodlNode","cursor","stopPropagation","onClick","activeElement","blur","onContextMenu","nodeIds","elementsFromPoint","dom","onMouseOut","blockEvent","setComponent","enable","disable","domFiber","parentElement","GetCompFiber","fiber","parentFiber","return","compFiber","stateNode","IS_BROWSER","_title","_meta","setTitle","clearMeta","metaTag","getMeta","setMeta","newMetaTag","global","Variables","Records","Users","CloudFunctions","Navigation","Files","SEO","SeoApi","Arrays","Objects","ignoreInExport","DOMBoundingBoxObserver","pollDelay","numBoundingBoxObservers","addObserver","_startObserver","removeObserver","_stopObserver","setTarget","boundingRect","observer","bb","isPercentage","getPercentage","getSizeWithMargins","startMargin","endMargin","parentLayout","sizeMode","flexShrink","fixedWidth","flexGrow","fixedHeight","align","alignX","alignY","parentFlexDirection","alignSelf","mergeDeep","sources","createTooltip","images","html","imgHtml","addInputCss","inputCss","defaultCss","mergeAttribute","attribute","addInputs","addInputProps","addDynamicInputPorts","addSharedVisualInputs","mixBlendMode","applyDefault","visible","removeStyle","visibility","addMarginInputs","marginPaddingComp","addPaddingInputs","defaults","styleTag","addTransformInputs","transformX","transforms","updateTransform","transformY","transformRotation","rotation","transformScale","transformOriginX","updateTransformOrigin","transformOriginY","transformOrigin","addAlignInputs","alignComp","addPositionAndAlignTooltips","addPointerEventOutputs","pointerEventsMode","pointerEventsEnabled","blockTouch","propPath","pointerDown","pointerUp","onTouchCancel","pointerEnter","onMouseEnter","hoverStart","onMouseOver","setVisualStates","hoverEnd","onMouseLeave","addOutputProps","addPointerEventsTooltips","addDimensions","defaultSizeMode","contentLabel","useDimensionConstraints","widthCondition","heightCondition","sizeComp","onChange","isFixed","deployed","inputProps","explicit","standard","extended","contentWidth","contentHeight","contentSize","unitsBodyText","fixedTooltip","dimension","fixed","addDimensionTooltips","minWidth","maxWidth","minHeight","maxHeight","addDimensionConstraintsTooltips","_addCornerRadius","defineCornerTab","suffix","tabName","indexOffset","radiusName","borderRadius","_updateCornerRadii","setCorner","corner","addBorderInputs","defineBorderTab","styleName","widthName","colorName","orNotSet","borderStyle","nameWithTab","borders","_updateBorders","borderWidth","borderColor","setBorder","borderTopStyle","borderRightStyle","borderBottomStyle","addShadowInputs","boxShadowEnabled","_updateBoxShadow","boxShadowOffsetX","boxShadowOffsetY","boxShadowBlurRadius","boxShadowSpreadRadius","boxShadowInset","boxShadowColor","addIconInputs","useIcon","iconColor","useIconCondition","useIconPorts","enableIconPlacement","hideEnableIconInput","iconSourceType","iconIconSource","iconImageSource","iconSpacing","iconPlacement","iconSize","addLabelInputs","useLabel","textStylePortPrefix","enableSpacing","labelSpacing","addTextStyleInputs","parentGroup","portPrefix","textStyleInputName","portIndex","prettyName","childPorts","childPortPrefix","getTextStyle","parentPort","targetStyleProperty","fontFamilyPort","transitionParameter","_transitions","colorAnimation","numberAnimation","addOutputPropHandler","propCallbacks","prevCb","addPrimitiveOutputPropHandler","outputPropValues","defineRegularInputProp","flattenArray","NoodlReactComponent","componentDidMount","componentWillUnmount","currentVisualStates","statesToRemove","vs","otherProps","finalStyle","innerReactComponentRef","noodlNodeAsProp","layout","renderedAtFrame","useFrame","textStyle","reactComponent","renderChildren","setStylesOnDOMNode","rootElement","getAttribute","reactKeyCounter","createNodeFromReactComponent","dimensions","margins","padding","outputProps","startStyle","startStyles","hasDefault","boundingBoxObserverCallback","clientBoundingRect","ReactComponentNode","reactKey","hasChildCountOutput","childrenCount","runningInCanvas","boundingBoxObserver","wantsToBeMounted","reactComponentRef","getReactComponent","cssClassName","styleCss","updateAdvancedStyle","screenPositionX","screenPositionY","boundingWidth","boundingHeight","customCssStyles","errorMessage","rawCss","nextComment","endComment","nameParts","updateChildIndices","updateChildrenCount","scheduleUpdateChildCountAndIndicies","updateChildIndiciesScheduled","forceUpdateScheduled","didCallTriggerDidMount","newStyles","styleObject","domElement","getDOMElement","flexDirection","marginsChanged","clip","forceUpdateAttributes","getStyle","_stopStateTransitions","getParametersForStates","parametersToSet","_getNewState","prevStates","newStates","addedStates","_getDefaultTransition","_getStateTransition","transitions","val","prevStateParams","newStateParams","newValues","defaultTransition","mountedInput","styleTargetName","pointerEventsNotToBlock","pointerProps","newProps","pointer","_styleSheets","_styleTemplate","o1","o2","_shallowCompare","checked","_updateVisualState","hoverState","pressedState","focusState","onFocus","onBlur","addOutputs","Button","_renderIcon","iconStyle","alt","fontSize","codeAsClass","class","attrs","buttonType","ButtonNode","groupPriority","testId","backgroundColor","Checkbox","useState","setChecked","checkbox","inputWrapperStyle","display","alignItems","justifyContent","checkedChanged","labelStyle","labeltextStyle","htmlFor","CheckBoxNode","check","uncheck","Select","selectedIndex","Value","otherStyles","inset","textTransform","inputWrapper","heightInPercent","Disabled","Label","placeholder","placeholderOpacity","selected","outerWrapperStyle","OptionsNode","_itemsChanged","RadioButton","radioButtonGroup","useContext","radio","fillStyle","fillSpacing","radioButton","wrapperStyle","RadioButtonNode","fillColor","RadioButtonGroup","setSelected","flexDirectionValues","RadioButtonGroupNode","thumbWidth","setBorderStyle","setBorderRadius","radius","tl","tr","br","bl","setShadow","spread","hasUnitPx","Slider","onValueChanged","updateOutputValue","instanceClassId","_nodeId","step","thumbHeight","trackHeight","divStyle","valueFactor","trackStyle","background","trackActiveColor","trackColor","thumbStyle","thumbColor","thumbPopout","trackPopout","RangeNode","parseFloat","_updateOutputValuePercent","valuePercent","valuePercentChanged","prefixLabel","propPrefix","groupName","addBorderRadius","preventGlobalFocusChange","setText","onTextChanged","inputContent","focus","userSelect","inputStyles","maxLength","onKeyDown","resize","inputWithWrapper","which","onEnter","hasFocus","TextInputNode","TextInput","controlId","placeHolderOpacity","setNodeFocused","textAlignX","textAlign","textChanged","_focus","_blur","ASyncQueue","pendingPromise","enqueue","dequeue","workingOnPromise","PageStackReactComponent","PageStack","topPageName","stackDepth","pageInfo","asyncQueue","onScheduleReset","scheduleReset","_registerPageStack","_deregisterPageStack","_findPage","flex","useRoutes","pageIdOrLabel","pageRef","setPageOutputs","hasScheduledReset","createPageContainer","resetAsync","startPageId","pageFromUrl","matchPageFromUrl","startPage","getRelativeURL","pageItem","paramsInPath","getNavigationAbsoluteURL","parentUrl","thisUrl","endsWith","_getLocationPath","pathname","_getSearchParams","pl","decode","decodeURIComponent","urlParams","getNavigationRemainingPath","remainingNavigationPath","urlQuery","pagePattern","_matchPathParts","remainingPathParts","_updateUrlWithTopPage","replaceAsync","isTransitioning","navigateAsync","navigateBackNodes","newTop","setPageComponent","setPagePath","setStartPage","ogPopout","twitterPopout","META_TAGS","isProperty","Page","metatags","PageNode","sitemapIncluded","sitemapChangefreq","sitemapPriority","reduce","getUrlPath","getTitle","setUrlPath","titleParts","defaultUrlPath","RouterReactComponent","_trimUrlPart","RouterNode","_registerRouter","_deregisterRouter","currentUrl","currentPageTitle","currentPage","currentPageComponent","scrollToTop","scrollIntoView","matchFromUrl","object1","currentParams","object2","keys1","keys2","_updatePageInputs","pageNodes","targetPage","haveForwardSlash","decodeURI","pathnameLength","URL","getBaseUrlLength","matchedPage","bestMatchLength","pagePatternParts","_getCompleteUrlToPage","newPage","_navigateInCurrentWindow","pageInputNodes","link","polarToCartesian","centerX","centerY","angleInDegrees","angleInRadians","PI","cos","sin","filledArc","startAngle","endAngle","arcSweep","stroke","fillEnabled","strokeEnabled","strokeColor","strokeWidth","strokeLineCap","arc","strokeLinecap","xmlns","CircleNode","Circle","calcAutofold","minWidths","containerWidth","marginX","first","_calcAutofold","second","totalFractions","fractionSize","rowWidth","acc","curr","expected","newLayout","newTotalFractions","columnAmount","Columns","columnLayout","containerRef","useRef","setContainerWidth","container","ResizeObserver","observe","disconnect","layoutString","forEachComponent","marginY","flexWrap","boxSizing","setDragValues","positionX","positionY","snapToPosition","propCallback","inputPositionX","inputPositionY","UNSAFE_componentWillReceiveProps","nextProps","snapToPositionX","snapToPositionXTimer","snapToPositionY","snapToPositionYTimer","useParentBounds","Drag","snapPositionX","snapPositionY","snapDurationX","snapDurationY","extendStatics","__","__spreadArrays","il","jl","propertiesConfig","sourceKey","inBrowser","isWeChatDevTools","isAndroid","isIOSBadVersion","supportsPassive","getNow","navigationStart","isUndef","between","elementStyle","transformNames_1","prefixStyle","charAt","getElement","useCapture","hasPerspective","hasTouch","hasTransition","transitionTimingFunction","transitionDuration","transitionDelay","transitionEnd","transitionProperty","eventTypeMap","touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseup","getRect","offsetHeight","preventDefaultExceptionFn","exceptions","tagExceptionFn","eventSource","posSrc","screenX","screenY","pressedKeysMap","ctrlKey","shiftKey","altKey","metaKey","bubbles","cancelable","initEvent","forwardedTouchEvent","_constructed","swipe","swipeBounce","bounce","windowCompat","noop$1","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","interval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","noop","sharedPropertyDefinition","names","registerType","hasType","magic","eventsCopy","event_1","types","_","EventRegister","wrapper","addDOMEvents","removeDOMEvents","handleDOMEvents","eventOperation","eventType","OptionsConstructor","startX","startY","scrollX","scrollY","freeScroll","directionLockThreshold","eventPassthrough","dblclick","tap","bounceTime","momentumLimitTime","momentumLimitDistance","flickLimitTime","flickLimitDistance","resizePolling","probeType","preventDefaultException","tagException","HWCompositing","useTransition","bindToWrapper","bindToTarget","disableMouse","disableTouch","autoBlur","autoEndDistance","outOfBoundaryDampingFactor","specifiedIndexAsContent","quadrant","merge","resolveBounce","translateZ","bounceOptions","DEFAULT_BOUNCE","ActionsHandler","wrapperEvents","targetEvents","shouldRegisterTouch","shouldRegisterMouse","wrapperEventRegister","targetEventRegister","beforeHandler","setInitiated","initiated","_eventType","beforeStart","point","touches","pointX","pageX","pointY","pageY","pageXOffset","pageYOffset","pX","pY","setContent","rebindDOMEvents","translaterMetaData","Translater","getComputedPosition","matrix","translate","transformStyle","transformFnName","transformFnArgUnit","transformFnArg","beforeTranslate","translater","endPoint","setPending","pending","setForceStopped","forceStopped","setCallStop","called","callStopWhenPending","clearTimer","startProbe","startPoint","prePos","probe","pos","currentPos","computeDirection","delta","directionX","directionY","isValidPostion","transitionTime","easing","timeFunction","easingFn","isRealtimeProbeType","_reflow","doStop","forceStop","callStop","Animation","animate","destTime","newPoint","Behavior","setMovingDirection","setDirection","hasScroll","performDampingAlgorithm","movingDirection","dampingFactor","newPos","minScrollPos","maxScrollPos","bounces","momentumInfo","absDist","startPos","updateDirection","absStartPos","isWrapperStatic","wrapperRect","contentRect","relativeOffset","computeBoundary","resetState","resetStartPos","beforeComputeBoundary","boundary","scrollable","updatePosition","getCurrentPos","checkInBoundary","adjustPosition","inBoundary","ignoreHasScroll","updateStartPos","updateAbsStartPos","getAbsDist","PassthroughHandlers","DirectionMap","DirectionLockAction","directionLocked","checkMovingDirection","absDistX","absDistY","computeDirectionLock","handleEventPassthrough","adjustDelta","handleMap","ScrollerActions","scrollBehaviorX","scrollBehaviorY","actionsHandler","animater","directionLockAction","bindActionsHandler","handleStart","applyQuadrantTransformation","transformateDeltaData","coordinateTransformation","handleMove","handleEnd","handleClick","fingerMoved","contentMoved","beforeMove","checkMomentum","prevX","newX","prevY","newY","detectMovingDirection","positionChanged","contentNotMoved","scrollStart","dispatchScroll","scroll","endTime","beforeEnd","ensureIntegerPos","scrollEnd","ensuringInteger","minScrollPosX","maxScrollPosX","minScrollPosY","maxScrollPosY","ceil","createBehaviorOptions","bsOptions","extraProp","prev","cur","bubbling","sourceEvent","targetEvent","Scroller","resizeTimeout","animaterOptions","createAnimater","actions","resizeHandler","resizeRegister","registerTransitionEnd","bindTranslater","bindAnimater","bindActions","togglePointerEvents","transitionEndRegister","prevPos","updatePositions","resetPosition","beforeScrollStart","touchEnd","scrollCancel","checkClick","checkFlick","flick","meta","swiper","momentumX","momentumY","scrollTo","_dblclick","dblclickTrigged","lastClickTime","isBScrollContainer","contentChanged","beforeRefresh","wrapperOffset","scrollBy","extraTransform","keys_1","isSamePoint","minDistanceScroll","scrollToElement","offsetX","offsetY","targetEle","getOffset","getPos","wrapperPos","scrollBehavior","xInBoundary","yInBoundary","reflow","BScrollConstructor","plugins","valid","use","ctor","pluginName","plugin","pluginsMap","applyOrder","scroller","eventBubbling","handleAutoBlur","proxy","applyPlugins","refreshWithoutReset","beforeInitialScrollTo","applyOrderMap","lastKey","getProperty","setProperty","propertiesProxy","eventRegister","createBScroll","MouseWheel","wheelEndTimer","wheelMoveTimer","wheelStart","handleBScroll","handleOptions","handleHooks","registerEvent","userOptions","mouseWheel","mouseWheelOpt","easeTime","discreteTime","throttleTime","hooksFn","registerHooks","wheelHandler","wheelStartHandler","getWheelDelta","wheelMoveHandler","wheelEndDetector","cleanCache","alterOptions","mousewheelStart","deltaCache","cachedDelta","mousewheelMove","getEaseTime","mousewheelEnd","wheelDeltaX","wheelDeltaY","deltaMode","wheelDelta","detail","hasVerticalScroll","hasHorizontalScroll","hooksName","handlerFn","EventHandler","indicator","registerEvents","startEvents","moveEvents","endEvents","startEventRegister","indicatorEl","moveEventRegister","endEventRegister","BScrollIsDisabled","lastPoint","keysMap","touchStart","pointPos","touchMove","Indicator","getKeysMap","handleFade","fade","interactive","scrollbarTrackClickable","scrollHooks","translaterHooks","animaterHooks","hasScrollKey","eventHandler","eventHandlerHooks","startHandler","moveHandler","endHandler","bindClick","clickEventRegister","calculateclickOffsetPos","scrollbarTrackOffsetTime","poinKey","domRectKey","domRect","scrollbarTrackOffsetType","clickPointOffset","scrollToWhere","scrollInfo","baseSize","scrollerSize","translateProperty","fadeInTime","fadeOutTime","canScroll","wrapperSizeKey","scrollerSizeKey","maxScrollPosKey","refreshScrollInfo","indicatorElSize","minSize","isCustom","maxIndicatorScrollPos","sizeRatio","caculatePosAndSize","refreshStyle","posKey","translatePropertyKey","sizeKey","moved","indicatorNotMoved","syncBScroll","maxScrollY","minScrollY","maxScrollX","minScrollX","ScrollBar","createIndicators","indicators","scrollbar","customElements","indicatorOptions","scrollDirectionConfigKeys","indicatorDirections","customScrollbarEls","customElement","scrollbarWrapper","createScrollbarElement","scrollbarWrapperEl","scrollbarIndicatorEl","compatibleFeatures","duplicateClick","parentScroll","childScroll","nestedScroll","scrollsPair","parentScrollX","parentScrollY","childScrollX","childScrollY","oppositeScroll","setupData","hasReachLeft","hasReachRight","hasReachTop","hasReachBottom","checkBeyondBoundary","calculateDepths","childNode","NestedScroll","stores","addHooks","appendBScroll","handleContainRelationship","handleCompatible","teardown","removeBScroll","__parentInfo","outerBS","outerBSWrapper","innerBS","innerBSWrapper","currentDepths","availableBScrolls","pair","bs","fixInboundValue","transformNames","webkit","Moz","PagesPos","slideOpt","slideEl","scrollerIns","wrapperWidth","wrapperHeight","scrollerHeight","scrollerWidth","stepX","stepY","slideEls","querySelectorAll","computePagePosInfoByEl","computePagePosInfo","xLen","yLen","hasInfo","getNearestPage","cx","cy","PageInfo","pagesPos","checkSlideLoop","changeCurrentPage","change2safePage","getInitPage","loopX","loopY","getRealPage","fixedPage","realPageLen","pageIndex","rest","getPageSize","realPage2Page","firstX","firstY","realX","realY","nextPage","changedPageNum","prevPage","nearestPage","getLoopStage","needLoop","resetLoopPage","isSameWithCurrent","slideX","slideY","sourcePrefix","Slide","resetLooping","isTouching","slide","willChangeToPage","lazyInitByRefresh","cloneSlideEleForLoop","shouldRefreshByWidth","setSlideWidth","shouldRefreshByHeight","setSlideHeight","shouldRefresh","scrollerHooks","registorHooks","initSlideState","modifyScrollMetaHandler","amendCurrentPage","setTouchFlag","scrollMoving","listenFlick","flickHandler","slideWrapper","clearSlideWidth","clearSlideHeight","goTo","goToPage","getCurrentPage","triggerThreshold","thresholdX","thresholdY","initPage","initThreshold","slideThreshold","threshold","pageSize","cloneNode","isScrollToBoundary","changePage","pageWillChangeTo","shouldSetWidthHeight","checkType","checkOption","slideItemWidth","newPageInfo","scrollEasing","posX","posY","getAnimateTime","scrollMeta","changeToPage","scrollNeedsToInit","scrollRef","scrollEnabled","nativeScroll","setupIScroll","iScroll","componentDidUpdate","scrollToIndex","behavior","noodlChild","scrollSnapEnabled","scrollDirection","getScrollDirection","snapOptions","disableSetWidth","disableSetHeight","showScrollbar","scrollSnapToEveryItem","scrollBounceEnabled","onScrollPositionChanged","onScrollStart","onScrollEnd","renderIScroll","childStyle","touchAction","as","overflowX","overflowY","GroupNode","scrollElementDuration","scrollIndexDuration","scrollIndex","Group","scrollElement","alignContent","rowGap","columnGap","focused","focusLost","Icon","lineHeight","IconNode","Image","ImageNode","srcSet","objectFit","onLoad","Text","whiteSpace","overflowWrap","TextNode","wordBreak","textAlignY","video","muted","volume","autoplay","controls","playsInline","innerRef","wantToPlay","canPlay","setSourceObject","srcObject","pause","objectPosition","objectPositionX","objectPositionY","CachedVideo","onVideoElementCreated","onCanPlay","videoWidth","videoHeight","VideoNode","Video","poster","onTimeUpdate","onPlay","onPause","focusChanged","hoverChanged","pressedChanged","Layout","Utils","NodeSharedPortDefinitions","checkedBackgroundColor","CheckBox","tagProps","FieldSet","FieldSetNode","Form","onSubmit","FormNode","for","LabelNode","Options","RadioButtonContext","thumbRadius","Range","_updateValuePercent","TextFieldComponent","sharedProps","registerNodes","setStyles","textStyles","_variantHasInputsWithTypes","getInputsWithType","parameterNames","NoodlEditor","NoodlEditorInspectorAPI","setInspector","setEnabled","NoodlEditorHighlightAPI","highlighter","setHighlighter","selectNode","Viewer","popups","runningDeployed","projectData","focusedNoodlNodes","enableDebugInspectors","popup","newPopupArray","NoodlJSAPI","reactNodes","Styles","waitingForExport","host","protocol","ids","inspectNodes","graphWarnings","focusedNode","blurredNode","onClickCapture","margin","isolation","createArgs","setImmediate","regex","match_result","isLocal","runtimeArgs","renderDeployed","hasAttribute","NoodlSSR","ssrSetupRuntime"],"sourceRoot":""}