{"version":3,"file":"noodl.deploy.js","mappings":"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CA,OACA,QACA,QACA,SACA,0BAGJ,CACElgB,KAAM,cACNkgB,MAAO,CACL,4BACA,8BACA,6BACA,iCACA,qBACA,2BACA,mCAKR,CACElgB,KAAM,sBACN2c,YAAa,mCACbjc,KAAM,QACNuf,cAAe,CACb,CACEjgB,KAAM,aACNkgB,MAAO,CACL,SACA,iBACA,aACA,yBACA,4BAGJ,CACElgB,KAAM,kBACNkgB,MAAO,CAAC,aAAc,oBAAqB,0BAE7C,CACElgB,KAAM,SACNkgB,MAAO,CAAC,sBAAuB,2BAIrC,CACElgB,KAAM,oBACN2c,YAAa,qCACbjc,KAAM,QACNuf,cAAe,CACb,CACEjgB,KAAM,gBACNkgB,MAAO,CACL,SACA,gBACA,QACA,cACA,kBACA,UACA,OACA,6BAGJ,CACElgB,KAAM,QACNkgB,MAAO,CACL,oBACA,SACA,MACA,KACA,YACA,aAGJ,CACElgB,KAAM,SACNkgB,MAAO,CAAC,eAAgB,mBAE1B,CACElgB,KAAM,sBACNkgB,MAAO,CACL,YACA,gBACA,gBACA,iBACA,cAGJ,CACElgB,KAAM,SACNkgB,MAAO,CAAC,oBAAqB,qBAE/B,CACElgB,KAAM,YACNkgB,MAAO,CAAC,SAAU,UAAW,QAAS,aAI5C,CACElgB,KAAM,sBACN2c,YAAa,qCACbjc,KAAM,YACNuf,cAAe,CACb,CACEjgB,KAAM,GACNkgB,MAAO,CACL,mBACA,oBACA,qBACA,4BACA,kCACA,yCACA,mDAKR,CACElgB,KAAM,oBACN2c,YAAa,8BACbjc,KAAM,OACNuf,cAAe,CACb,CACEjgB,KAAM,GACNkgB,MAAO,CACL,WACA,WACA,mBACA,SACA,qBACA,WACA,eACA,cAGJ,CACElgB,KAAM,QACNkgB,MAAO,CACL,cACA,gBACA,mBACA,kBACA,mBACA,oBACA,iBACA,gBAGJ,CACElgB,KAAM,aACNkgB,MAAO,CACL,WACA,uBACA,iBACA,uBACA,gBACA,0BACA,qBACA,wBACA,aACA,cACA,iBACA,aAGJ,CACElgB,KAAM,OACNkgB,MAAO,CACL,uBACA,wBACA,wBACA,sBACA,mCA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","sources":["webpack://@noodl/noodl-viewer-react/../noodl-runtime/dist/noodl-runtime.esm.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/node_modules/eventemitter3/index.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/node_modules/lodash.difference/index.js","webpack://@noodl/noodl-viewer-react/./node_modules/bezier-easing/index.js","webpack://@noodl/noodl-viewer-react/./node_modules/clsx/dist/clsx.m.js","webpack://@noodl/noodl-viewer-react/./src/assets/style.css","webpack://@noodl/noodl-viewer-react/./node_modules/css-loader/dist/runtime/api.js","webpack://@noodl/noodl-viewer-react/./node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack://@noodl/noodl-viewer-react/./node_modules/events/events.js","webpack://@noodl/noodl-viewer-react/./node_modules/prop-types/factoryWithThrowingShims.js","webpack://@noodl/noodl-viewer-react/./node_modules/prop-types/index.js","webpack://@noodl/noodl-viewer-react/./node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack://@noodl/noodl-viewer-react/./node_modules/react-draggable/build/cjs/Draggable.js","webpack://@noodl/noodl-viewer-react/./node_modules/react-draggable/build/cjs/DraggableCore.js","webpack://@noodl/noodl-viewer-react/./node_modules/react-draggable/build/cjs/cjs.js","webpack://@noodl/noodl-viewer-react/./node_modules/react-draggable/build/cjs/utils/domFns.js","webpack://@noodl/noodl-viewer-react/./node_modules/react-draggable/build/cjs/utils/getPrefix.js","webpack://@noodl/noodl-viewer-react/./node_modules/react-draggable/build/cjs/utils/log.js","webpack://@noodl/noodl-viewer-react/./node_modules/react-draggable/build/cjs/utils/positionFns.js","webpack://@noodl/noodl-viewer-react/./node_modules/react-draggable/build/cjs/utils/shims.js","webpack://@noodl/noodl-viewer-react/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/api/cloudfile.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/api/cloudstore.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/collection.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/edgetriggeredinput.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/model.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/node.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/modelcrudbase.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/outputproperty.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/noderegister.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/timerscheduler.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/variants.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodescope.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/componentinstance.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodecontext.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/eventsender.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/editorconnection.activewarnings.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/editorconnection.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodelibraryexport.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/models/nodemodel.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/models/componentmodel.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/models/graphmodel.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/editormodeleventshandler.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/services.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodedefinition.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/componentinputs.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/componentoutputs.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/runtasks.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/restnode.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/expression.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/javascriptnodeparser.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/simplejavascript.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/api/queryutils.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbcollectionnode2.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbmodelnode2.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbmodelcrudbase.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/setdbmodelpropertiesnode.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/deletedbmodelpropertiesnode.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/newdbmodelpropertiesnode.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbmodelnode-addrelation.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbmodelnode-removerelation.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/filterdbmodelsnode.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/modelnode2.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/setmodelpropertiesnode.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/newmodelnode.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/cloudfilenode.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/api/configservice.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/data/dbconfig.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/variables/variablebase.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/variables/number.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/variables/string.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/variables/boolean.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/condition.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/and.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/or.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/booleantostring.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/datetostring.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/stringmapper.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/inverter.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/substring.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/stringformat.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/counter.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/uniqueid.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/user/setuserproperties.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/nodes/std-library/user/user.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/runtime.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/runtime.nodes.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/async-pool.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/projectsettings.ts","webpack://@noodl/noodl-viewer-react/../noodl-runtime/src/utils.ts","webpack://@noodl/noodl-viewer-react/./src/easecurves.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/closepopup.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/navigate-back.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/navigate-to-path.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/navigate.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/navigation-handler.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/page-inputs.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/router-handler.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/router-navigate.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/showpopup.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/transitions/transition.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/transitions.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/transitions/none-transition.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/transitions/push-transition.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/transitions/popup-transition.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/animate-to-value.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/colorblend.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/cloudfunction2.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/collectionnode-clear.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/collectionnode-insert.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/collectionnode-new.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/collectionnode-remove.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/collectionnode2.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/filtercollectionnode.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/foreach.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/foreachactions.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/mapcollectionnode.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/setvariablenode.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/staticdata.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/data/variablenode2.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/eventreceiver.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/eventsender.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/javascript.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/numberremapper.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/openfilepicker.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/screenresolution.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/states.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/switch.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/timer.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/uploadfile.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/login.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/logout.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/signup.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/user/userservice.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/valuechanged.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/variables/color.ts","webpack://@noodl/noodl-viewer-react/./node_modules/webfontloader/webfontloader.js","webpack://@noodl/noodl-viewer-react/./src/api/cloudfunctions.js","webpack://@noodl/noodl-viewer-react/./src/api/users.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Group/scroll-plugins/patched-momentum-scroll.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/componentutils/base.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/componentutils/componentobject.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/componentutils/parentcomponentobject.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/componentutils/setcomponentobjectproperties.js","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/componentutils/setparentcomponentobjectproperties.js","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/css-definition.js","webpack://@noodl/noodl-viewer-react/external var \"React\"","webpack://@noodl/noodl-viewer-react/external var \"ReactDOM\"","webpack://@noodl/noodl-viewer-react/webpack/bootstrap","webpack://@noodl/noodl-viewer-react/webpack/runtime/compat get default export","webpack://@noodl/noodl-viewer-react/webpack/runtime/define property getters","webpack://@noodl/noodl-viewer-react/webpack/runtime/global","webpack://@noodl/noodl-viewer-react/webpack/runtime/hasOwnProperty shorthand","webpack://@noodl/noodl-viewer-react/webpack/runtime/make namespace object","webpack://@noodl/noodl-viewer-react/webpack/runtime/nonce","webpack://@noodl/noodl-viewer-react/./src/graph-warnings.ts","webpack://@noodl/noodl-viewer-react/./src/highlighter.ts","webpack://@noodl/noodl-viewer-react/./src/inspector.ts","webpack://@noodl/noodl-viewer-react/./src/api/seo.ts","webpack://@noodl/noodl-viewer-react/./src/api/navigation.ts","webpack://@noodl/noodl-viewer-react/./src/api/files.ts","webpack://@noodl/noodl-viewer-react/./src/project-settings.ts","webpack://@noodl/noodl-viewer-react/./src/dom-boundingbox-oberver.ts","webpack://@noodl/noodl-viewer-react/./src/layout.ts","webpack://@noodl/noodl-viewer-react/./src/mergedeep.ts","webpack://@noodl/noodl-viewer-react/./src/fontloader.ts","webpack://@noodl/noodl-viewer-react/./src/tooltips.ts","webpack://@noodl/noodl-viewer-react/./src/node-shared-port-definitions.js","webpack://@noodl/noodl-viewer-react/./src/node-transitions.ts","webpack://@noodl/noodl-viewer-react/./src/react-component-node.js","webpack://@noodl/noodl-viewer-react/./src/pointerlisteners.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/utils.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/Button/Button.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/button.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/Checkbox/Checkbox.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/checkbox.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/Select/Select.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/options.ts","webpack://@noodl/noodl-viewer-react/./src/contexts/radiobuttoncontext.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/RadioButton/RadioButton.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/radiobutton.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/RadioButtonGroup/RadioButtonGroup.tsx","webpack://@noodl/noodl-viewer-react/./src/constants/flex.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/radiobuttongroup.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/Slider/Slider.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/slider.ts","webpack://@noodl/noodl-viewer-react/./src/components/controls/TextInput/TextInput.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/controls/text-input.ts","webpack://@noodl/noodl-viewer-react/./src/async-queue.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/navigation-stack.tsx","webpack://@noodl/noodl-viewer-react/./src/components/navigation/Page/Page.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/page.ts","webpack://@noodl/noodl-viewer-react/./src/nodes/navigation/router.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/std-library/externallink.ts","webpack://@noodl/noodl-viewer-react/./src/components/visual/Circle/Circle.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/circle.ts","webpack://@noodl/noodl-viewer-react/./src/components/visual/Columns/Columns.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/columns.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Drag/Drag.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/drag.js","webpack://@noodl/noodl-viewer-react/./node_modules/@better-scroll/core/dist/core.esm.js","webpack://@noodl/noodl-viewer-react/./node_modules/@better-scroll/mouse-wheel/dist/mouse-wheel.esm.js","webpack://@noodl/noodl-viewer-react/./node_modules/@better-scroll/scroll-bar/dist/scroll-bar.esm.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Group/scroll-plugins/nested-scroll-plugin.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Group/scroll-plugins/slide-scroll-plugin.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Group/Group.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/group.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Icon/Icon.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/icon.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Image/Image.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/image.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Text/Text.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/text.js","webpack://@noodl/noodl-viewer-react/./src/components/visual/Video/Video.tsx","webpack://@noodl/noodl-viewer-react/./src/nodes/visual/video.js","webpack://@noodl/noodl-viewer-react/./src/assets/style.css?76bd","webpack://@noodl/noodl-viewer-react/./src/styles.ts","webpack://@noodl/noodl-viewer-react/./src/viewer.jsx","webpack://@noodl/noodl-viewer-react/./src/register-nodes.ts","webpack://@noodl/noodl-viewer-react/./src/noodl-js-api.ts","webpack://@noodl/noodl-viewer-react/./src/components/common/NoHomeError/NoHomeError.tsx","webpack://@noodl/noodl-viewer-react/./noodl-viewer-react.js","webpack://@noodl/noodl-viewer-react/./src/polyfills.ts","webpack://@noodl/noodl-viewer-react/./index.deploy.js"],"sourcesContent":["import{EventEmitter}from\"eventemitter3\";import difference$1 from\"lodash.difference\";class NodeRegister{constructor(e){this._constructors={},this.context=e}register(e){const t=e.metadata.name;this._constructors[t]=e}createNode(e,t,n){if(!this._constructors.hasOwnProperty(e))throw new Error(\"Unknown node type with name \"+e);return this._constructors[e](this.context,t,n)}getNodeMetadata(e){if(!this._constructors.hasOwnProperty(e))throw new Error(\"Unknown node type with name \"+e);return this._constructors[e].metadata}hasNode(e){return this._constructors.hasOwnProperty(e)}getInputType(e,t){var n,o;return null===(o=null===(n=this.getNodeMetadata(e).inputs)||void 0===n?void 0:n[t])||void 0===o?void 0:o.type}}class Timer{constructor(e,t){this._hasCalledOnStart=!1,this._wasStopped=!1,this._start=0,this._durationLeft=0,this.duration=t.duration||0,this._isRunning=!1,this._hasCalledOnStart=!1,this.scheduler=e,this.repeatCount=1,this.delay=0;for(const e in t)this[e]=t[e]}start(){return this._isRunning&&this.stop(),this.scheduler.scheduleTimer(this),this}stop(){this.scheduler.stopTimer(this),this._hasCalledOnStart=!1,this._isRunning=!1,this._wasStopped=!0}isRunning(){return this._isRunning}durationLeft(){return this._durationLeft}}class TimerScheduler{constructor(e){this.requestFrame=e,this.runningTimers=[],this.newTimers=[]}createTimer(e){return new Timer(this,e)}scheduleTimer(e){-1===this.newTimers.indexOf(e)&&(0===e.repeatCount&&(e.repeatCount=1e5),this.newTimers.push(e),this.requestFrame())}stopTimer(e){let t;e._isRunning?(t=this.runningTimers.indexOf(e),-1!==t&&this.runningTimers.splice(t,1),e.onStop&&!e._wasStopped&&e.onStop()):(t=this.newTimers.indexOf(e),-1!==t&&this.newTimers.splice(t,1))}runTimers(e){var t,n;const o=[],i=[],s=[];let r;const a=this.runningTimers.length;let d;for(r=0;r<a;++r)s[r]=this.runningTimers[r];for(r=0;r<a;++r)if(d=s[r],d&&e>=d._start){let t;!1===d._hasCalledOnStart&&d.onStart&&(d.onStart(),d._hasCalledOnStart=!0),t=d.duration>0?(e-d._start)/(d.duration*d.repeatCount):1,d._durationLeft=d.duration*(1-t);let n=t*d.repeatCount-Math.floor(t*d.repeatCount);t>=1&&(n=1),d.onRunning&&d.onRunning(n),t<1&&d._isRunning?o.push(d):d._wasStopped||i.push(d)}else o.push(d);for(this.runningTimers=o,r=0;r<i.length;++r)i[r]._isRunning=!1,i[r]._hasCalledOnStart=!1,null===(n=null===(t=i[r])||void 0===t?void 0:t.onFinish)||void 0===n||n.call(t);if(this.newTimers.length>0){for(r=0;r<this.newTimers.length;++r)d=this.newTimers[r],d._start=e+d.delay,d._isRunning=!0,d._wasStopped=!1,this.runningTimers.push(d),0===d.delay&&(d.onStart&&(d.onStart(),d._hasCalledOnStart=!0),d.onRunning&&d.onRunning(0));this.newTimers.length=0}}hasPendingTimers(){return this.runningTimers.length>0||this.newTimers.length>0}}class Variants{constructor({graphModel:e,getNodeScope:t}){this.getNodeScope=t,e&&(this.graphModel=e,e.on(\"variantUpdated\",(e=>this.onVariantUpdated(e))))}getVariant(e,t){if(this.graphModel&&t)return this.graphModel.getVariant(e,t)}onVariantUpdated(e){const t=this.getNodeScope();if(!t)return;const n=t.getNodesWithTypeRecursive(e.typename).filter((t=>\"object\"==typeof t.variant?t.variant.name===e.name:\"string\"==typeof t.variant?t.variant===e.name:t.model&&t.model.variant===e.name));for(const t of n)t.setVariant(e)}}class OutputProperty{constructor(e){if(this.valuesSendThisIteration=0,!e.owner)throw new Error(\"Owner must be set\");this.getter=e.getter||(()=>{}),this.connections=[],this._owner=e.owner,this._name=e.name,this.onFirstConnectionAdded=e.onFirstConnectionAdded,this.onLastConnectionRemoved=e.onLastConnectionRemoved}get name(){return this._name}get owner(){return this._owner}get value(){return this.getter.call(this.owner)}get id(){return this._id||(this._id=this.owner.id+this.name),this._id}registerConnection(e,t){this.connections.push({node:e,inputPortName:t}),1===this.connections.length&&this.onFirstConnectionAdded&&this.onFirstConnectionAdded.call(this.owner)}deregisterConnection(e,t){for(let n=0;n<this.connections.length;n++){const o=this.connections[n];if(o.node===e&&o.inputPortName===t){this.connections.splice(n,1);break}}0===this.connections.length&&this.onLastConnectionRemoved&&this.onLastConnectionRemoved.call(this.owner)}flagDependeesDirty(e){for(let e=0,t=this.connections.length;e<t;e++)this.connections[e].node.flagDirty()}sendValue(e){this._lastUpdateIteration!==this.owner._updatedAtIteration?(this._lastUpdateIteration=this.owner._updatedAtIteration,this.valuesSendThisIteration=0):this.valuesSendThisIteration++,this.valuesSendThisIteration>500&&(this.owner._cyclicLoop=!0);for(let t=0,n=this.connections.length;t<n;t++){const n=this.connections[t];n.node._setValueFromConnection(n.inputPortName,e)}}hasConnections(){return this.connections.length>0}}class Node$1{constructor(e,t){this.updateOnDirtyFlagging=!0,this.children=[],this._internal={},this._dirty=!1,this._inputs={},this._inputValues={},this._outputs={},this._inputConnections={},this._outputList=[],this._isUpdating=!1,this._inputValuesQueue={},this._afterInputsHaveUpdatedCallbacks=[],this._signalsSentThisUpdate={},this._deleted=!1,this._deleteListeners=[],this._isFirstUpdate=!0,this._valuesFromConnections={},this._updateIteration=0,this.id=t,this.context=e}getInputValue(e){return this._inputValues[e]}registerInput(e,t){var n;if(this.hasInput(e))throw new Error(\"Input property \"+e+\" already registered\");if(this._inputs[e]=t,t.type&&\"object\"==typeof t.type&&\"units\"in t.type){const o=t.type.defaultUnit||(null===(n=t.type.units)||void 0===n?void 0:n[0])||\"\";this._inputValues[e]={value:t.default,type:o}}else t.hasOwnProperty(\"default\")&&(this._inputValues[e]=t.default)}deregisterInput(e){if(!1===this.hasInput(e))throw new Error(\"Input property \"+e+\" doesn't exist\");delete this._inputs[e],delete this._inputValues[e]}registerInputs(e){for(const t in e)this.registerInput(t,e[t])}getInput(e){if(!1!==this.hasInput(e))return this._inputs[e];console.log(\"Node \"+this.name+\": Invalid input property \"+e)}hasInput(e){return e in this._inputs}registerInputIfNeeded(e){}setInputValue(name,value){var _a,_b,_c,_d,_e;const input=this.getInput(name);if(input){if(\"object\"==typeof input.type&&\"array\"===input.type.name&&\"string\"==typeof value)try{const e=JSON.parse(value);input.set.call(this,e),input.value=e,this._inputValues[name]=e}catch(e){}else input.set.call(this,value),input.value=value,this._inputValues[name]=value;if(\"color\"===input.type&&this.context&&this.context.styles)value=this.context.styles.resolveColor(value);else if(\"array\"===input.type&&\"string\"==typeof value)try{value=eval(value),null===(_a=this.context.editorConnection)||void 0===_a||_a.clearWarning(null===(_c=null===(_b=this.nodeScope)||void 0===_b?void 0:_b.componentOwner)||void 0===_c?void 0:_c.name,this.id,\"invalid-array-\"+name)}catch(e){const t=e;value=[],console.log(e),this.context.editorConnection&&this.context.editorConnection.sendWarning(null===(_e=null===(_d=this.nodeScope)||void 0===_d?void 0:_d.componentOwner)||void 0===_e?void 0:_e.name,this.id,\"invalid-array-\"+name,{showGlobally:!0,message:\"Invalid array<br>\"+t.toString()})}input.set.call(this,value)}else console.log(\"node doesn't have input\",name)}hasOutput(e){return e in this._outputs}registerOutput(e,t){if(this.hasOutput(e))throw new Error(\"Output property \"+e+\" already registered\");const n=new OutputProperty({owner:this,getter:t.get||t.getter,name:e,onFirstConnectionAdded:t.onFirstConnectionAdded,onLastConnectionRemoved:t.onLastConnectionRemoved});this._outputs[e]=n,this._outputList.push(n)}deregisterOutput(e){if(!1===this.hasOutput(e))throw new Error(\"Output property \"+e+\" isn't registered\");const t=this._outputs[e];if(t.hasConnections())throw new Error(\"Output property \"+e+\" has connections and can't be removed\");delete this._outputs[e];const n=this._outputList.indexOf(t);this._outputList.splice(n,1)}registerOutputs(e){for(const t in e)this.registerOutput(t,e[t])}registerOutputIfNeeded(){}getOutput(e){if(!1===this.hasOutput(e))throw new Error(\"Node \"+this.name+\" doesn't have a port named \"+e);return this._outputs[e]}connectInput(e,t,n){if(!1===this.hasInput(e))throw new Error(\"Invalid connection, input doesn't exist. Trying to connect from \"+t.name+\" output \"+n+\" to \"+this.name+\" input \"+e);const o=t.getOutput(n);if(o.registerConnection(this,e),this._inputConnections[e]||(this._inputConnections[e]=[]),this._inputConnections[e].push(o),t._signalsSentThisUpdate[n])this._setValueFromConnection(e,!0),this._setValueFromConnection(e,!1);else{const t=o.value;void 0!==t&&(this._setValueFromConnection(e,t),this.context&&this.context.connectionSentValue(o,o.value))}this.flagDirty()}removeInputConnection(e,t,n){if(!this._inputConnections[e])throw new Error(\"Node removeInputConnection: Input doesn't exist\");const o=this._inputConnections[e];for(let i=0;i<o.length;i++){const s=o[i];if(s.owner.id===t&&s.name===n){o.splice(i,1);s.owner.getOutput(n).deregisterConnection(this,e);break}}0===o.length&&delete this._valuesFromConnections[e]}isInputConnected(e){return!!this._inputConnections.hasOwnProperty(e)&&this._inputConnections[e].some((e=>{var t;if(\"Component Inputs\"!==e.owner.name)return!0;const n=null===(t=e.owner.nodeScope)||void 0===t?void 0:t.componentOwner;return null==n?void 0:n.isInputConnected(e.name)}))}update(){var e,t,n,o;if(this._isUpdating||!1===this._dirty)return;this._updatedAtIteration!==this.context.updateIteration&&(this._updatedAtIteration=this.context.updateIteration,this._updateIteration=0,this._cyclicLoop&&(this._cyclicLoop=!1)),this._isUpdating=!0;try{for(;this._dirty&&!this._cyclicLoop;){this._updateDependencies(),this._dirty=!1;const e=Object.keys(this._inputValuesQueue);let t=!0;for(;t&&!this._cyclicLoop;){t=!1;for(let n=0;n<e.length;n++){const o=e[n],i=this._inputValuesQueue[o];i.length>0&&(this.setInputValue(o,i.shift()),i.length>0&&(t=!0))}const n=this._afterInputsHaveUpdatedCallbacks;this._afterInputsHaveUpdatedCallbacks=[];for(let e=0;e<n.length;e++)n[e].call(this)}this._updateIteration++,this._updateIteration>=100&&(this._cyclicLoop=!0)}}catch(e){throw this._isUpdating=!1,e}this._cyclicLoop&&(this.context.scheduleNextFrame((()=>{this.context.nodeIsDirty(this)})),this.context.editorConnection&&!this._cyclicWarningSent&&this.context.isWarningTypeEnabled(\"cyclicLoops\")&&(this.context.editorConnection.sendWarning(null===(t=null===(e=this.nodeScope)||void 0===e?void 0:e.componentOwner)||void 0===t?void 0:t.name,this.id,\"cyclic-loop\",{showGlobally:!0,message:\"Cyclic loop detected\"}),this._cyclicWarningSent=!0,console.log(\"cycle detected\",{id:this.id,name:this.name,component:null===(o=null===(n=this.nodeScope)||void 0===n?void 0:n.componentOwner)||void 0===o?void 0:o.name}))),this._isFirstUpdate=!1,this._isUpdating=!1}_updateDependencies(){for(const e in this._inputConnections){const t=this._inputConnections[e];for(let e=0;e<t.length;++e)t[e].owner.update()}}flagDirty(){this._dirty||(this._dirty=!0,this.updateOnDirtyFlagging&&this._performDirtyUpdate())}_performDirtyUpdate(){this.context&&this.context.nodeIsDirty(this);for(let e=0;e<this._outputList.length;++e)this._outputList[e].flagDependeesDirty()}sendValue(e,t){if(!1===this.hasOutput(e))return void console.log(\"Error: Node\",this.name,\"doesn't have a output named\",e);if(void 0===t)return;const n=this.getOutput(e);n.sendValue(t),this.context&&this.context.connectionSentValue(n,t)}flagOutputDirty(e){const t=this.getOutput(e);this.sendValue(e,t.value)}flagAllOutputsDirty(){for(const e of this._outputList)this.sendValue(e.name,e.value)}sendSignalOnOutput(e){if(!1===this.hasOutput(e))return void console.log(\"Error: Node\",this.name,\"doesn't have a output named\",e);const t=this.getOutput(e);t.sendValue(!0),t.sendValue(!1),this._signalsSentThisUpdate[e]=!0,this.scheduleAfterInputsHaveUpdated((function(){this._signalsSentThisUpdate[e]=!1})),this.context&&this.context.connectionSentSignal(t)}_setValueFromConnection(e,t){this._valuesFromConnections[e]=t,this.queueInput(e,t)}_hasInputBeenSetFromAConnection(e){return this._valuesFromConnections.hasOwnProperty(e)}queueInput(e,t){if(this._inputValuesQueue[e]||(this._inputValuesQueue[e]=[]),this._isFirstUpdate){const n=this._inputValuesQueue[e][0];!0===n||(n instanceof Object&&n.unit&&t instanceof Object==!1&&(t={value:t,unit:n.unit}),this._inputValuesQueue[e].length=0)}this._inputValuesQueue[e].push(t),this.flagDirty()}scheduleAfterInputsHaveUpdated(e){this._afterInputsHaveUpdatedCallbacks.push(e),this.flagDirty()}setNodeModel(e){this.model=e,e.on(\"parameterUpdated\",this._onNodeModelParameterUpdated,this),e.on(\"variantUpdated\",this._onNodeModelVariantUpdated,this),e.on(\"inputPortRemoved\",(e=>{this.hasInput(e.name)&&this.deregisterInput(e.name)}),this),e.on(\"outputPortRemoved\",(e=>{this.hasOutput(e.name)&&this.deregisterOutput(e.name)}),this)}addDeleteListener(e){this._deleteListeners.push(e)}_onNodeDeleted(){this.model&&(this.model.removeListenersWithRef(this),this.model=void 0),this._deleted=!0;for(const e of this._deleteListeners)e.call(this)}_onNodeModelParameterUpdated(e){var t;if(this.registerInputIfNeeded(e.name),void 0!==e.value)if(e.state){if(!this._getVisualStates)return void console.log(\"Node has nos visual states, but got a parameter for state\",e.state);-1!==this._getVisualStates().indexOf(e.state)&&this.queueInput(e.name,e.value)}else this.queueInput(e.name,e.value);else{let n;const o=this.variant;\"object\"==typeof o&&(e.state?o&&o.stateParameters.hasOwnProperty(e.state)&&o.stateParameters[e.state].hasOwnProperty(e.name)?n=o.stateParameters[e.state][e.name]:(null===(t=this.model)||void 0===t?void 0:t.parameters.hasOwnProperty(e.name))?n=this.model.parameters[e.name]:o&&o.parameters.hasOwnProperty(e.name)&&(n=o.parameters[e.name]):o&&o.parameters.hasOwnProperty(e.name)&&(n=o.parameters[e.name])),void 0===n&&(n=this.context.getDefaultValueForInput(this.model.type,e.name),this._resetReactVirtualDOM&&this._resetReactVirtualDOM()),this.queueInput(e.name,n)}}_onNodeModelVariantUpdated(e){this.setVariant(e)}setVariant(e){this.variant=e}}function getAbsoluteUrl(e){if(null==e||\"\"===e)return window.Noodl.baseUrl||\"/\";const t=String(e);return!t||\"/\"===t[0]||t.includes(\"://\")||t.startsWith(\"data:\")?t:(window.Noodl.baseUrl||\"/\")+t}function logJavaScriptNodeError(e){\"string\"==typeof e?console.log(\"Error in JS node run code.\",e):e instanceof Error&&console.log(\"Error in JS node run code.\",Object.getPrototypeOf(e).constructor.name+\": \"+e.message,e.stack)}function guid(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+\"-\"+e()+\"-\"+e()+\"-\"+e()+\"-\"+e()+e()+e()}function randomString(e){if(0===e)throw new Error(\"Zero-length randomString is useless.\");const t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";let n=\"\";for(let o=0;o<e;++o)n+=t[Math.floor(65536*(1+Math.random()))%62];return n}class NodeScope{constructor(e,t){this.context=e,this.nodes={},this.componentOwner=t,this.componentInstanceChildren={}}verifyData(e,t){t.forEach((t=>{if(!e[t])throw new Error(\"Missing \"+t)}))}addConnection(e){try{this.verifyData(e,[\"sourceId\",\"sourcePort\",\"targetId\",\"targetPort\"])}catch(e){throw new Error(\"Error in connection: \"+e.message)}try{const t=this.getNodeWithId(e.sourceId),n=this.getNodeWithId(e.targetId);n.registerInputIfNeeded(e.targetPort),t.registerOutputIfNeeded(e.sourcePort),n.connectInput(e.targetPort,t,e.sourcePort)}catch(e){console.error(e.message)}}setNodeParameters(e,t){const n=this.context.variants.getVariant(t.type,t.variant);if(n)e.setVariant(n);else{const n=t.parameters||{};let o=Object.keys(n);if(this.context.nodeRegister.hasNode(e.name)){const t=this.context.nodeRegister.getNodeMetadata(e.name);t.inputs&&o.sort(((e,n)=>{var o,i;const s=t.inputs[e],r=t.inputs[n];return(null!==(o=null==r?void 0:r.inputPriority)&&void 0!==o?o:0)-(null!==(i=null==s?void 0:s.inputPriority)&&void 0!==i?i:0)}))}o.forEach((t=>{e.registerInputIfNeeded(t),!1!==e.hasInput(t)&&e.queueInput(t,n[t])}))}}async createNodeFromModel(e,t){if(\"Component Children\"===e.type){if(e.parent){const t=this.getNodeWithId(e.parent.id);this.componentOwner.setChildRoot(t)}return}let n;try{n=await this.createNode(e.type,e.id),n.updateOnDirtyFlagging=!1!==t,n.setNodeModel(e)}catch(t){return console.error(t.message),void(this.context.editorConnection&&this.context.isWarningTypeEnabled(\"nodescope\")&&this.context.editorConnection.sendWarning(this.componentOwner.name,e.id,\"nodelibrary-unknown-node\",{message:t.message,showGlobally:!0}))}return e.variant&&n.setVariant&&n.setVariant(e.variant),this.setNodeParameters(n,e),e.parent&&this.insertNodeInTree(n,e),n}insertNodeInTree(e,t){if(!t.parent)throw new Error(\"Cannot insert node without parent\");const n=this.getNodeWithId(t.parent.id),o=t.parent.children.indexOf(t);if(!n.addChild)throw new Error(\"Node \"+n.id+\" of type \"+n.constructor.name+\" can't have children\");n.addChild(e,o)}getNodeWithId(e){if(!this.nodes.hasOwnProperty(e))throw new Error(\"Unknown node id \"+e);return this.nodes[e]}hasNodeWithId(e){return this.nodes.hasOwnProperty(e)}createPrimitiveNode(e,t,n){if(t||(t=guid()),this.nodes.hasOwnProperty(t))throw Error(\"duplicate id \"+t);const o=this.context.nodeRegister.createNode(e,t,this);if(n)for(const e in n)o[e]=n[e];return this.nodes[t]=o,o}async createNode(e,t,n){if(t||(t=guid()),this.nodes.hasOwnProperty(t))throw Error(\"duplicate id \"+t);let o;if(this.context.nodeRegister.hasNode(e)){if(o=this.context.nodeRegister.createNode(e,t,this),n)for(const e in n)o[e]=n[e]}else o=await this.context.createComponentInstanceNode(e,t,this,n),this.componentInstanceChildren[t]=o;return this.nodes[t]=o,o}getNodesWithIdRecursive(e){const t=[];return function e(t,n,o){t.nodes.hasOwnProperty(n)&&o.push(t.nodes[n]),Object.keys(t.nodes).filter((e=>t.nodes[e]instanceof ComponentInstanceNode)).forEach((i=>{const s=t.nodes[i].nodeScope;s&&e(s,n,o)}))}(this,e,t),t}getNodesWithType(e){return Object.keys(this.nodes).filter((t=>this.nodes[t].name===e)).map((e=>this.nodes[e]))}getNodesWithTypeRecursive(e){let t=[];return(()=>{t=t.concat(this.getNodesWithType(e));Object.keys(this.nodes).filter((e=>this.nodes[e]instanceof ComponentInstanceNode)).forEach((n=>{const o=this.nodes[n];if(o&&o.nodeScope){const n=o.nodeScope.getNodesWithTypeRecursive(e);t=t.concat(n)}}))})(),t}getAllNodesRecursive(){let e=[];return(()=>{e=e.concat(Object.values(this.nodes));Object.keys(this.nodes).filter((e=>this.nodes[e]instanceof ComponentInstanceNode)).forEach((t=>{const n=this.nodes[t];if(n&&n.nodeScope){const t=n.nodeScope.getAllNodesRecursive();e=e.concat(t)}}))})(),e}getAllNodesWithVariantRecursive(e){return this.getAllNodesRecursive().filter((t=>t.variant===e))}onNodeModelRemoved(e){const t=this.getNodeWithId(e.id);if(e.parent){this.getNodeWithId(e.parent.id).removeChild(t)}t._onNodeDeleted(),delete this.nodes[t.id],delete this.componentInstanceChildren[t.id]}removeConnection(e){this.getNodeWithId(e.targetId).removeInputConnection(e.targetPort,e.sourceId,e.sourcePort)}async setComponentModel(e){var t;this.componentModel=e;const n=[];for(const t of e.getAllNodes()){const e=await this.createNodeFromModel(t,!1);e&&n.push(e)}e.getAllConnections().forEach((e=>this.addConnection(e))),n.forEach((e=>e.updateOnDirtyFlagging=!0)),n.forEach((e=>{e._dirty&&e._performDirtyUpdate()})),e.on(\"connectionAdded\",(e=>this.addConnection(e)),this),e.on(\"connectionRemoved\",this.removeConnection,this),e.on(\"nodeAdded\",this.createNodeFromModel,this),e.on(\"nodeParentWillBeRemoved\",(e=>{if(\"Component Children\"===e.type)return void(e.parent&&this.componentOwner.setChildRoot(null));const t=this.getNodeWithId(e.id);t.parent&&t.parent.removeChild(t)}),this),e.on(\"nodeParentUpdated\",(e=>{if(\"Component Children\"===e.type){const t=e.parent?this.getNodeWithId(e.parent.id):null;this.componentOwner.setChildRoot(t)}else{const t=this.getNodeWithId(e.id);this.insertNodeInTree(t,e)}}),this),e.on(\"nodeRemoved\",(e=>{\"Component Children\"!==e.type&&this.onNodeModelRemoved(e)}),this);for(const e in this.nodes){const n=this.nodes[e];null===(t=null==n?void 0:n.nodeScopeDidInitialize)||void 0===t||t.call(n)}}reset(){this.componentModel&&(this.componentModel.removeListenersWithRef(this),this.componentModel=void 0),Object.keys(this.nodes).forEach((e=>{this.nodes.hasOwnProperty(e)&&this.deleteNode(this.nodes[e])}))}deleteNode(e){if(this.nodes.hasOwnProperty(e.id)){if(e.parent&&e.parent.removeChild(e),e.getChildren&&e.getChildren().forEach((t=>{e.removeChild(t);(t.parentNodeScope||t.nodeScope).deleteNode(t)})),this.componentModel){const t=this.componentModel.getConnectionsFrom(e.id),n=this.componentModel.getConnectionsTo(e.id);t.concat(n).forEach((e=>{this.nodes.hasOwnProperty(e.targetId)&&this.nodes.hasOwnProperty(e.sourceId)&&this.removeConnection(e)}))}e._onNodeDeleted(),delete this.nodes[e.id],delete this.componentInstanceChildren[e.id]}else console.error(\"Node doesn't belong to this scope\",e.id,e.name)}sendEventFromThisScope(e,t,n,o){var i,s;if(o){const n=this.getNodesWithType(\"Event Receiver\").filter((t=>t.getChannelName()===e));for(let e=0;e<n.length;e++){if(n[e].handleEvent(t))return!0}}if(\"parent\"===n&&this.componentOwner.parentNodeScope){const o=this.componentOwner.parent?this.componentOwner.parent.nodeScope:this.componentOwner.parentNodeScope;return!!o&&o.sendEventFromThisScope(e,t,n,!0)}if(\"children\"===n){const o=this.nodes;for(const s in o){const r=o[s].children;if(r)for(const o of r)if(o.name&&this.context.hasComponentModelWithName(o.name)){if(null===(i=o.nodeScope)||void 0===i?void 0:i.sendEventFromThisScope(e,t,n,!0))return!0}}}else if(\"siblings\"===n){let n;if(n=this.componentOwner.parent?this.componentOwner.parent.nodeScope:this.componentOwner.parentNodeScope,!n)return!1;const o=n.nodes;for(const n in o){const i=o[n].children;if(i){const n=i.filter((e=>e.name&&this.context.hasComponentModelWithName(e.name)&&e.nodeScope!==this));for(const o of n){if(null===(s=o.nodeScope)||void 0===s?void 0:s.sendEventFromThisScope(e,t,void 0,!0))return!0}}}}return!1}}let componentIdCounter=0;class ComponentInstanceNode extends Node$1{constructor(e,t,n){super(e,t),this.nodeScope=new NodeScope(e,this),this.parentNodeScope=n,this._internal={childRoot:null,componentOutputValues:{},componentOutputs:[],componentInputs:[],inputValues:{},roots:[],instanceId:\"__$ndl_componentInstaceId\"+componentIdCounter},this.nodeScope.modelScope=n?n.modelScope:void 0,componentIdCounter++}async setComponentModel(e){this.componentModel=e;const t=this;await this.nodeScope.setComponentModel(e),this._internal.componentInputs=this.nodeScope.getNodesWithType(\"Component Inputs\"),this._internal.componentOutputs=this.nodeScope.getNodesWithType(\"Component Outputs\"),Object.values(e.getInputPorts()).forEach(this.registerComponentInputPort.bind(this)),Object.values(e.getOutputPorts()).forEach(this.registerComponentOutputPort.bind(this));const n=e.roots||[];this._internal.roots=n.map((e=>this.nodeScope.getNodeWithId(e))),e.on(\"rootAdded\",(e=>{this._internal.roots.push(this.nodeScope.getNodeWithId(e)),this.forceUpdate()}),this),e.on(\"rootRemoved\",(function(e){const t=this._internal.roots.findIndex((t=>t.id===e));-1!==t&&this._internal.roots.splice(t,1),this.forceUpdate()}),this),e.on(\"inputPortAdded\",this.registerComponentInputPort.bind(this),this),e.on(\"outputPortAdded\",this.registerComponentOutputPort.bind(this),this),e.on(\"inputPortRemoved\",(function(e){t.hasInput(e.name)&&t.deregisterInput(e.name)}),this),e.on(\"outputPortRemoved\",(function(e){this.hasOutput(e.name)&&t.deregisterOutput(e.name)}),this),e.on(\"nodeAdded\",(function(e){\"Component Inputs\"===e.type?t._internal.componentInputs.push(t.nodeScope.getNodeWithId(e.id)):\"Component Outputs\"===e.type&&t._internal.componentOutputs.push(t.nodeScope.getNodeWithId(e.id))}),this),e.on(\"nodeRemoved\",(function(e){function n(e,t){return e.filter((e=>e.id!==t))}\"Component Inputs\"===e.type?t._internal.componentInputs=n(t._internal.componentInputs,e.id):\"Component Outputs\"===e.type&&(t._internal.componentOutputs=n(t._internal.componentOutputs,e.id))}),this),e.on(\"renamed\",(function(e){t.name=e.newName}),this)}_onNodeDeleted(){this.componentModel&&(this.componentModel.removeListenersWithRef(this),this.componentModel=void 0),this.nodeScope.reset(),super._onNodeDeleted()}registerComponentInputPort(e){this.registerInput(e.name,{set:function(t){this._internal.inputValues[e.name]=t,this._internal.componentInputs.forEach((function(t){t.registerOutputIfNeeded(e.name),t.flagOutputDirty(e.name)}))}})}registerComponentOutputPort(e){this.registerOutput(e.name,{getter(){return this._internal.componentOutputValues[e.name]}})}setOutputFromComponentOutput(e,t){var n,o;!1!==this.hasOutput(e)&&(null===(o=null===(n=this._internal.creatorCallbacks)||void 0===n?void 0:n.onOutputChanged)||void 0===o||o.call(n,e,t,this._internal.componentOutputValues[e]),this._internal.componentOutputValues[e]=t,this.flagOutputDirty(e))}setChildRoot(e){const t=this._internal.childRoot,n=e;if(this._internal.childRoot=n,this.model&&this.model.children){const e=this.parentNodeScope,o=this.model.children.filter((e=>\"Component Children\"!==e.type)).map((t=>null==e?void 0:e.getNodeWithId(t.id)));if(t)for(let e=0;e<o.length;e++)t.isChild(o[e])&&t.removeChild(o[e]);if(n)for(let e=0;e<o.length;e++){const t=o[e],n=t.model.parent.children.indexOf(t.model);this.addChild(t,n)}}}getChildRootIndex(){var e,t;if(!(null===(t=null===(e=this._internal.childRoot)||void 0===e?void 0:e.model)||void 0===t?void 0:t.children))return 0;const n=this._internal.childRoot.model.children;for(let e=0;e<n.length;e++)if(\"Component Children\"===n[e].type)return e;return 0}getChildRoot(){return this._internal.childRoot?this._internal.childRoot:null}getRoots(){return this._internal.roots}triggerDidMount(){this._internal.roots.forEach((e=>{var t;null===(t=e.triggerDidMount)||void 0===t||t.call(e)}))}render(){return 0===this._internal.roots.length?null:this._internal.roots[0].render()}setChildIndex(e){this.getRoots().forEach((t=>{var n;return null===(n=t.setChildIndex)||void 0===n?void 0:n.call(t,e)}))}addChild(e,t){this.getChildRoot().addChild(e,t+this.getChildRootIndex())}removeChild(e){this.getChildRoot().removeChild(e)}getChildren(){const e=this.getChildRoot();return e?e.getChildren():[]}isChild(e){return!!this.getChildRoot()&&this.getChildRoot().isChild(e)}contains(e){return this.getRoots().some((t=>{var n;return null===(n=t.contains)||void 0===n?void 0:n.call(t,e)}))}_performDirtyUpdate(){super._performDirtyUpdate();const e=this._internal.componentInputs;for(let t=0,n=e.length;t<n;t++)e[t].flagDirty();this._internal.componentOutputs.forEach((function(e){e.flagDirty()}))}getRef(){const e=this._internal.roots[0];return e?e.getRef():void 0}update(){super.update(),this._internal.componentOutputs.forEach((function(e){e.update()}))}forceUpdate(){this.parent&&(this.parent.cachedChildren=void 0,this.parent.forceUpdate())}getInstanceId(){return this._internal.instanceId}}class NodeContext{constructor(e={}){var t;this.isUpdating=!1;const n=!!e.hasOwnProperty(\"runningInEditor\")&&e.runningInEditor;this._dirtyNodes=[],this.callbacksAfterUpdate=[],this.graphModel=e.graphModel,this.platform=e.platform,this.eventEmitter=new EventEmitter,this.eventSenderEmitter=new EventEmitter,this.globalValues={},this.globalsEventEmitter=new EventEmitter,this.runningInEditor=!!n,this.currentFrameTime=0,this.frameNumber=0,this.updateIteration=0,this.nodeRegister=new NodeRegister(this),this.timerScheduler=new TimerScheduler(this.scheduleUpdate.bind(this)),this.componentModels={},this.debugInspectorsEnabled=!1,this.connectionsToPulse={},this.connectionsToPulseChanged=!1,this.debugInspectors={},this.connectionPulsingCallbackScheduled=!1,this.editorConnection=e.editorConnection,this.rootComponent=void 0,this._outputHistory={},this._signalHistory={},this.warningTypes={},this.bundleFetchesInFlight=new Map,this.variants=new Variants({graphModel:this.graphModel,getNodeScope:()=>this.rootComponent?this.rootComponent.nodeScope:null}),this.editorConnection&&(this.editorConnection.on(\"debugInspectorsUpdated\",(e=>{this.onDebugInspectorsUpdated(e)})),null===(t=this.editorConnection)||void 0===t||t.on(\"getConnectionValue\",(({clientId:e,connectionId:t})=>{var n,o;if((null===(n=this.editorConnection)||void 0===n?void 0:n.clientId)!==e)return;const i=this._outputHistory[t];null===(o=this.editorConnection)||void 0===o||o.sendConnectionValue(t,i?i.value:void 0)})))}setRootComponent(e){this.rootComponent=e}getCurrentTime(){return this.platform.getCurrentTime()}onDebugInspectorsUpdated(e){this.debugInspectorsEnabled&&(e=e.map((e=>{if(\"connection\"===e.type&&e.connection){const t=e.connection;e.id=t.fromId+t.fromProperty}else\"node\"===e.type&&e.nodeId&&(e.id=e.nodeId);return e})),this.debugInspectors={},e.forEach((e=>this.debugInspectors[e.id]=e)),this.sendDebugInspectorValues())}updateDirtyNodes(){let e,t,n=!0,o=0;for(this.updateIteration++,this.isUpdating=!0;n&&o<10;){const i=this._dirtyNodes;for(this._dirtyNodes=[],e=0,t=i.length;e<t;++e)try{i[e]._deleted||i[e].update()}catch(e){console.error(e)}const s=this.callbacksAfterUpdate;for(this.callbacksAfterUpdate=[],e=0,t=s.length;e<t;e++)try{s[e]()}catch(e){console.error(e)}n=this.callbacksAfterUpdate.length>0||this._dirtyNodes.length>0,o++}this.isUpdating=!1}update(){this.frameNumber++,this.updateDirtyNodes(),this.timerScheduler.hasPendingTimers()&&(this.scheduleUpdate(),this.timerScheduler.runTimers(this.currentFrameTime)),this.debugInspectorsEnabled&&this.sendDebugInspectorValues()}reset(){this.eventEmitter.emit(\"applicationDataReloaded\");const e=this.eventEmitter;[\"frameStart\",\"frameEnd\"].forEach((function(t){e.removeAllListeners(t)})),this.globalValues={},this._dirtyNodes.length=0,this.callbacksAfterUpdate.length=0,this.timerScheduler.runningTimers=[],this.timerScheduler.newTimers=[],this.rootComponent=void 0,this.clearDebugInspectors()}nodeIsDirty(e){this._dirtyNodes.push(e),this.scheduleUpdate()}scheduleUpdate(){this.eventEmitter.emit(\"scheduleUpdate\")}scheduleAfterUpdate(e){this.callbacksAfterUpdate.push(e),this.scheduleUpdate()}scheduleNextFrame(e){this.eventEmitter.once(\"frameStart\",e),this.scheduleUpdate()}setGlobalValue(e,t){this.globalValues[e]=t,this.globalsEventEmitter.emit(e)}getGlobalValue(e){return this.globalValues[e]}registerComponentModel(e){if(this.componentModels.hasOwnProperty(e.name))throw new Error(\"Duplicate component name \"+e.name);this.componentModels[e.name]=e,e.on(\"renamed\",(t=>{delete this.componentModels[t.oldName],this.componentModels[t.newName]=e}),this)}deregisterComponentModel(e){this.componentModels.hasOwnProperty(e.name)&&(this.componentModels[e.name].removeListenersWithRef(this),delete this.componentModels[e.name])}async fetchComponentBundle(e){const t=async e=>{const t=`${window.Noodl.Env.BaseUrl||\"/\"}noodl_bundles/${e}.json`,n=await fetch(t);if(404===n.status)throw new Error(\"Component not found \"+e);const o=await n.json();for(const e of o)!1===this.graphModel.hasComponentWithName(e.name)&&await this.graphModel.importComponentFromEditorData(e)};if(this.bundleFetchesInFlight.has(e))await this.bundleFetchesInFlight.get(e);else{const n=t(e);this.bundleFetchesInFlight.set(e,n),await n}}async getComponentModel(e){if(!e)throw new Error(\"Component instance must have a name\");if(!1===this.componentModels.hasOwnProperty(e)){const t=this.graphModel.getBundleContainingComponent(e);if(!t)throw new Error(\"Can't find component model for \"+e);for(const e of this.graphModel.getBundleDependencies(t))this.fetchComponentBundle(e);await this.fetchComponentBundle(t)}return this.componentModels[e]}hasComponentModelWithName(e){return this.componentModels.hasOwnProperty(e)}async createComponentInstanceNode(e,t,n,o){const i=new ComponentInstanceNode(this,t,n);if(i.name=e,o)for(const e in o)i[e]=o[e];const s=await this.getComponentModel(e);return await i.setComponentModel(s),i}_formatConnectionValue(e){if(\"object\"==typeof e&&e&&e.constructor&&\"Node\"===e.constructor.name)e=\"<Node> \"+e.name;else if(\"object\"==typeof e&&\"undefined\"!=typeof window&&e instanceof HTMLElement)e=`DOM Node <${e.tagName}>`;else{if(\"string\"==typeof e&&!e.startsWith(\"[Signal]\"))return'\"'+e+'\"';if(Number.isNaN(e))return\"NaN\"}return e}connectionSentValue(e,t){if(!this.editorConnection||!this.editorConnection.isConnected()||!this.debugInspectorsEnabled)return;const n=this.getCurrentTime();if(this._outputHistory[e.id]={value:t,timestamp:n},this.connectionsToPulse.hasOwnProperty(e.id))return void(this.connectionsToPulse[e.id].timestamp=n);const o=[];e.connections.forEach((t=>{o.push(e.owner.id+e.name+t.node.id+t.inputPortName)})),this.connectionsToPulse[e.id]={timestamp:n,connections:o},this.connectionsToPulseChanged=!0,!1===this.connectionPulsingCallbackScheduled&&(this.connectionPulsingCallbackScheduled=!0,setTimeout(this.clearOldConnectionPulsing.bind(this),100))}connectionSentSignal(e){const t=e.id;this._signalHistory.hasOwnProperty(t)||(this._signalHistory[t]={count:0}),this._signalHistory[t].count++,this.connectionSentValue(e,\"[Signal] Trigger count \"+this._signalHistory[t].count)}clearDebugInspectors(){var e;this.debugInspectors={},this.connectionsToPulse={},null===(e=this.editorConnection)||void 0===e||e.sendPulsingConnections(this.connectionsToPulse)}clearOldConnectionPulsing(){var e;this.connectionPulsingCallbackScheduled=!1;const t=this.getCurrentTime();Object.keys(this.connectionsToPulse).forEach((e=>{const n=this.connectionsToPulse[e];t-n.timestamp>100&&(this.connectionsToPulseChanged=!0,delete this.connectionsToPulse[e])})),this.connectionsToPulseChanged&&(this.connectionsToPulseChanged=!1,null===(e=this.editorConnection)||void 0===e||e.sendPulsingConnections(this.connectionsToPulse)),Object.keys(this.connectionsToPulse).length>0&&(this.connectionPulsingCallbackScheduled=!0,setTimeout(this.clearOldConnectionPulsing.bind(this),500))}_getDebugInspectorValueForNode(e){if(!this.rootComponent)return;const t=this.rootComponent.nodeScope.getNodesWithIdRecursive(e),n=t[t.length-1];if(n&&n.getInspectInfo){const t=n.getInspectInfo();if(void 0!==t)return{type:\"node\",id:e,value:t}}}sendDebugInspectorValues(){var e,t;const n=[];for(const e in this.debugInspectors){const t=this.debugInspectors[e];if(\"connection\"===t.type&&this._outputHistory.hasOwnProperty(e)){const t=this._outputHistory[e].value;n.push({type:\"connection\",id:e,value:this._formatConnectionValue(t)})}else if(\"node\"===t.type){const t=this._getDebugInspectorValueForNode(e);t&&n.push(t)}}n.length>0&&(null===(e=this.editorConnection)||void 0===e||e.sendDebugInspectorValues(n)),this.connectionsToPulseChanged&&(this.connectionsToPulseChanged=!1,null===(t=this.editorConnection)||void 0===t||t.sendPulsingConnections(this.connectionsToPulse))}setDebugInspectorsEnabled(e){this.debugInspectorsEnabled=e,this.editorConnection,e&&this.sendDebugInspectorValues()}sendGlobalEventFromEventSender(e,t){this.eventSenderEmitter.emit(e,t)}setPopupCallbacks(e){this.onShowPopup=e.onShow,this.onClosePopup=e.onClose}async showPopup(e,t,n){if(!this.onShowPopup)return;const o=this.rootComponent.nodeScope,i=await o.createNode(e);for(const e in t)i.setInputValue(e,t[e]);i.popupParent=(null==n?void 0:n.senderNode)||null;const s=o.createPrimitiveNode(\"Group\");s.setInputValue(\"flexDirection\",\"node\"),s.setInputValue(\"cssClassName\",\"noodl-popup\");const r=this.graphModel.getSettings().bodyScroll;s.setInputValue(\"position\",r?\"fixed\":\"absolute\");const a=i.nodeScope.getNodesWithType(\"NavigationClosePopup\");if(a&&a.length>0)for(let e=0;e<a.length;e++)a[e]._setCloseCallback(((e,t)=>{this.scheduleNextFrame((()=>{var i,r;o.hasNodeWithId(s.id)&&(null===(i=this.onClosePopup)||void 0===i||i.call(this,s),o.deleteNode(s),null===(r=null==n?void 0:n.onClosePopup)||void 0===r||r.call(n,e,t||{}))}))}));this.onShowPopup(s),requestAnimationFrame((()=>{s.addChild(i)}))}setWarningTypes(e){Object.assign(this.warningTypes,e)}isWarningTypeEnabled(e){return!this.warningTypes.hasOwnProperty(e)||!!this.warningTypes[e]}getDefaultValueForInput(e,t){var n;if(!1===this.nodeRegister.hasNode(e))return;const o=null===(n=this.nodeRegister.getNodeMetadata(e).inputs)||void 0===n?void 0:n[t];return o?o.type.defaultUnit?{value:o.default,unit:o.type.defaultUnit}:o.default:void 0}}class EventSender{constructor(){this.listeners={},this.listenersWithRefs={}}on(e,t,n){n?(this.listenersWithRefs.hasOwnProperty(e)||(this.listenersWithRefs[e]=new Map),this.listenersWithRefs[e].get(n)||this.listenersWithRefs[e].set(n,[]),this.listenersWithRefs[e].get(n).push(t)):(this.listeners.hasOwnProperty(e)||(this.listeners[e]=[]),this.listeners[e].push(t))}removeListenersWithRef(e){Object.keys(this.listenersWithRefs).forEach((t=>{const n=this.listenersWithRefs[t];n.has(e)&&n.delete(e)}))}removeAllListeners(e){e?(delete this.listeners[e],delete this.listenersWithRefs[e]):(this.listeners={},this.listenersWithRefs={})}async emit(e,t){const n=this.listeners[e];if(n){const e=[...n];for(const n of e)await Promise.resolve(n(t))}const o=this.listenersWithRefs[e];if(o)for(const[e,n]of o)for(const o of n)await Promise.resolve(o.call(e,t))}}class ActiveWarnings{constructor(){this.currentWarnings=new Map}setWarning(e,t,n){if(this.currentWarnings.has(e)){const o=this.currentWarnings.get(e);return(!o||o[t]!==n)&&(o&&(o[t]=n),!0)}return this.currentWarnings.set(e,{[t]:n}),!0}clearWarning(e,t){const n=this.currentWarnings.get(e);return!(!n||!n[t])&&(delete n[t],0===Object.keys(n).length&&this.currentWarnings.delete(e),!0)}clearWarnings(e){return!1!==this.currentWarnings.has(e)&&(this.currentWarnings.delete(e),!0)}}class EditorConnection extends EventSender{constructor(e={}){var t,n;super(),this.clientId=\"\",this.dynamicPortsHash={},this.serviceRequests={},this.runtimeType=e.runtimeType,this.platform=e.platform||{getCurrentTime:()=>Date.now()},this.ws=(null===(t=e.platform)||void 0===t?void 0:t.webSocketClass)||(\"undefined\"!=typeof WebSocket?WebSocket:void 0),this.wsOptions=null===(n=e.platform)||void 0===n?void 0:n.webSocketOptions,this.reconnectOnClose=!0,this.enableDebugger=!1,this.lastSendTimestamp=0,this.sendQueue=[],this.sendTimer=void 0,this.activeWarnings=new ActiveWarnings}isRunningLocally(){return this.platform.isRunningLocally&&this.platform.isRunningLocally()||\"undefined\"!=typeof document&&(\"localhost\"===document.location.hostname||\"127.0.0.1\"===document.location.hostname)}connect(e){this.socket=this.wsOptions?new this.ws(e,this.wsOptions):new this.ws(e),this.socket.addEventListener(\"open\",(()=>{var e;this.clientId=guid(),null===(e=this.socket)||void 0===e||e.send(JSON.stringify({cmd:\"register\",type:\"viewer\",clientId:this.clientId})),this.emit(\"connected\")})),this.socket.addEventListener(\"close\",(t=>{this.reconnectOnClose&&this.reconnect(e),console.log(\"Editor connection closed\",t.code,t.reason),this.emit(\"connectionClosed\")})),this.socket.addEventListener(\"error\",(()=>{console.log(\"Editor connection error, trying to reconnect\")})),this.socket.addEventListener(\"message\",(async e=>{const t=\"string\"==typeof e.data?e.data:await e.data.text(),n=JSON.parse(t);let o;\"registered\"===n.cmd||(\"export\"===n.cmd?(o=JSON.parse(n.content),\"full\"===n.type&&n.target===this.clientId&&this.emit(\"exportDataFull\",o)):\"hoverStart\"===n.cmd?this.emit(\"hoverStart\",n.content.id):\"hoverEnd\"===n.cmd?this.emit(\"hoverEnd\",n.content.id):\"refresh\"===n.cmd?this.emit(\"reload\"):\"debugInspectors\"===n.cmd?this.debugInspectorsEnabled&&(o=JSON.parse(n.content),this.emit(\"debugInspectorsUpdated\",o.inspectors)):\"debuggingEnabled\"===n.cmd?this.isRunningLocally()&&(o=JSON.parse(n.content),this.emit(\"debuggingEnabledChanged\",o.enabled)):\"getConnectionValue\"===n.cmd?this.isRunningLocally()&&(o=JSON.parse(n.content),await this.emit(\"getConnectionValue\",{clientId:o.clientId,connectionId:o.connectionId})):\"modelUpdate\"===n.cmd?await this.emit(\"modelUpdate\",n.content):\"publish\"===n.cmd||(\"noodlModules\"===n.cmd?this.emit(\"noodlModules\",JSON.parse(n.content)):\"mqttUpdate\"===n.cmd?this.emit(\"mqttUpdate\",n.content):\"activeComponentChanged\"===n.cmd?this.emit(\"activeComponentChanged\",n.component):console.log(\"Command not implemented\",n)))}))}reconnect(e){setTimeout((()=>{this.connect(e)}),2e3)}isConnected(){return void 0!==this.socket&&this.socket.readyState===this.ws.OPEN}getCircularReplacer(){const e=new WeakSet;return(t,n)=>{if(\"object\"==typeof n&&null!==n){if(e.has(n))return\"[Circular]\";e.add(n)}return n}}send(e){const t=this.platform.getCurrentTime(),n=t-this.lastSendTimestamp,o=e=>{var t,n;try{null===(t=this.socket)||void 0===t||t.send(JSON.stringify(e))}catch(t){if(t.message&&t.message.startsWith(\"Converting circular\"))try{null===(n=this.socket)||void 0===n||n.send(JSON.stringify(e,this.getCircularReplacer()))}catch(t){console.log(\"failed to send message to editor\",e,t)}else console.log(\"failed to send message to editor\",e,t)}};n<200||this.sendTimer||!this.isConnected()?(this.sendQueue.push(e),this.sendTimer||(this.sendTimer=setTimeout((()=>{if(!1===this.isConnected())return;for(let e=0;e<this.sendQueue.length;e+=50){const t=this.sendQueue.slice(e,e+50);o(t)}this.sendQueue=[],this.sendTimer=void 0,this.lastSendTimestamp=this.platform.getCurrentTime()}),100))):(this.lastSendTimestamp=t,o(e))}sendInspectId(e){this.send({cmd:\"select\",type:\"viewer\",content:JSON.stringify({id:e})})}sendSelectComponent(e){this.send({cmd:\"select\",type:\"viewer\",content:JSON.stringify({componentName:e})})}sendPulsingConnections(e){const t=[];Object.keys(e).forEach((n=>{const o=e[n];t.push(...o.connections)})),this.send({cmd:\"connectiondebugpulse\",type:\"viewer\",content:JSON.stringify({connectionsToPulse:t})})}sendDebugInspectorValues(e){this.send({cmd:\"debuginspectorvalues\",type:\"viewer\",content:{inspectors:e}})}sendConnectionValue(e,t){this.send({cmd:\"connectionValue\",type:\"viewer\",content:{connectionId:e,value:t}})}_detectRename(e,t){if(!e||!t)return;if(e.length!==t.length)return;const n={};for(let o=0;o<e.length;o++){if(-1===t.indexOf(e[o])){if(n.before)return;n.before=e[o]}if(-1===e.indexOf(t[o])){if(n.after)return;n.after=t[o]}}return n.before&&n.after?{before:n.before,after:n.after}:void 0}sendDynamicPorts(e,t,n){const o=JSON.stringify(t);if(this.dynamicPortsHash[e]!==o){if(this.dynamicPortsHash[e]&&t&&n&&n.detectRenamed){const o=Array.isArray(n.detectRenamed)?n.detectRenamed:[n.detectRenamed],i=[];o.forEach((n=>{let o=JSON.parse(this.dynamicPortsHash[e]),s=[...t];n.prefix&&(o=o.filter((e=>e.name.startsWith(n.prefix))),s=s.filter((e=>e.name.startsWith(n.prefix)))),n.plug&&(o=o.filter((e=>e.plug===n.plug)),s=s.filter((e=>e.plug===n.plug))),s=s.map((e=>e.name.substring((n.prefix||\"\").length))),o=o.map((e=>e.name.substring((n.prefix||\"\").length)));const r=this._detectRename(o,s);r&&i.push({plug:n.plug,patterns:[(n.prefix||\"\")+\"{{*}}\"],before:r.before,after:r.after})})),i.length>0&&(n.renamed=i),delete n.detectRenamed}this.dynamicPortsHash[e]=o,this.send({cmd:\"instanceports\",type:\"viewer\",content:JSON.stringify({nodeid:e,ports:t,options:n})})}}sendWarning(e,t,n,o){this.activeWarnings.setWarning(t,n,o)&&this.send({cmd:\"showwarning\",type:\"viewer\",content:JSON.stringify({componentName:e,nodeId:t,key:n,warning:o})})}clearWarning(e,t,n){this.activeWarnings.clearWarning(t,n)&&this.send({cmd:\"showwarning\",type:\"viewer\",content:JSON.stringify({componentName:e,nodeId:t,key:n,warning:void 0})})}clearWarnings(e,t){this.activeWarnings.clearWarnings(t)&&this.send({cmd:\"clearwarnings\",type:\"viewer\",content:JSON.stringify({componentName:e,nodeId:t})})}sendPatches(e){this.send({cmd:\"patchproject\",type:\"viewer\",content:JSON.stringify(e)})}requestFullExport(){this.send({cmd:\"register\",type:\"viewer\"})}requestNoodlModules(){this.send({cmd:\"getNoodlModules\",type:\"viewer\"})}sendServiceRequest(e,t){e.token=guid(),e.clientId=this.clientId,this.serviceRequests[e.token]=t,this.send(e)}close(){var e;this.reconnectOnClose=!1,!1!==this.isConnected()&&(null===(e=this.socket)||void 0===e||e.close())}sendNodeLibrary(e){this.send({cmd:\"nodelibrary\",type:\"viewer\",runtimeType:this.runtimeType,content:e,clientId:this.clientId})}sendComponentMetadata(e,t,n){this.send({cmd:\"componentMetadata\",type:\"viewer\",content:JSON.stringify({componentName:e,key:t,data:n})})}sendProjectMetadata(e,t){this.send({cmd:\"projectMetadata\",type:\"viewer\",content:JSON.stringify({key:e,data:t})})}}function formatDynamicPorts(e){var t,n;const o=[];for(const i of e.dynamicports||[])if(i.ports||i.template||i.port||i.channelPort)o.push(i);else if(i.inputs||i.outputs){const s=[];if(i.inputs)for(const n of i.inputs){const o=null===(t=e.inputs)||void 0===t?void 0:t[n];o&&s.push(formatPort(n,o,\"input\"))}if(i.outputs)for(const t of i.outputs){const o=null===(n=e.outputs)||void 0===n?void 0:n[t];o&&s.push(formatPort(t,o,\"output\"))}const r={name:i.name||\"conditionalports/basic\",condition:i.condition,ports:s};o.push(r)}return o}function formatPort(e,t,n){const o={name:e,type:t.type,plug:n};return t.group&&(o.group=t.group),t.displayName&&(o.displayName=t.displayName),t.description&&(o.description=t.description),t.editorName&&(o.editorName=t.editorName),void 0!==t.default&&(o.default=t.default),t.hasOwnProperty(\"index\")&&(o.index=t.index),t.tooltip&&(o.tooltip=t.tooltip),t.tab&&(o.tab=t.tab),t.popout&&(o.popout=t.popout),t.allowVisualStates&&(o.allowVisualStates=t.allowVisualStates),o}function generateNodeLibrary(e){const t={typecasts:[{from:\"string\",to:[\"number\",\"boolean\",\"image\",\"color\",\"enum\",\"textStyle\",\"dimension\",\"array\",\"object\"]},{from:\"boolean\",to:[\"number\",\"string\",\"signal\"]},{from:\"number\",to:[\"boolean\",\"string\",\"dimension\"]},{from:\"date\",to:[\"string\"]},{from:\"signal\",to:[\"boolean\",\"number\"]},{from:\"image\",to:[]},{from:\"cloudfile\",to:[\"string\",\"image\"]},{from:\"color\",to:[]},{from:\"enum\",to:[]},{from:\"object\",to:[]},{from:\"domelement\",to:[]},{from:\"reference\",to:[]},{from:\"font\",to:[]},{from:\"textStyle\",to:[\"string\"]},{from:\"collection\",to:[\"array\"]},{from:\"array\",to:[\"collection\"]}],dynamicports:[{type:\"conditionalports\",name:\"basic\"},{type:\"expand\",name:\"basic\"}],colors:{nodes:{component:{base:\"#643D8B\",baseHighlighted:\"#79559b\",header:\"#4E2877\",headerHighlighted:\"#643d8b\",outline:\"#4E2877\",outlineHighlighted:\"#b58900\",text:\"#dbd0e4\"},visual:{base:\"#315272\",baseHighlighted:\"#4d6784\",header:\"#173E5D\",headerHighlighted:\"#315272\",outline:\"#173E5D\",outlineHighlighted:\"#b58900\",text:\"#cfd5de\"},data:{base:\"#465524\",baseHighlighted:\"#5b6a37\",header:\"#314110\",headerHighlighted:\"#465524\",outline:\"#314110\",outlineHighlighted:\"#b58900\",text:\"#d2d6c5\"},javascript:{base:\"#7E3660\",baseHighlighted:\"#944e74\",header:\"#67214B\",headerHighlighted:\"#7e3660\",outline:\"#67214B\",outlineHighlighted:\"#d57bab\",text:\"#e4cfd9\"},default:{base:\"#4C4F59\",baseHighlighted:\"#62656e\",header:\"#373B45\",headerHighlighted:\"#4c4f59\",outline:\"#373B45\",outlineHighlighted:\"#b58900\",text:\"#d3d4d6\"}},connections:{signal:{normal:\"#006f82\",highlighted:\"#7ec2cf\",pulsing:\"#ffffff\"},default:{normal:\"#875d00\",highlighted:\"#e5ae32\",pulsing:\"#ffffff\"}}},nodetypes:[{name:\"Component Children\",shortDesc:\"This node is a placeholder for where children of this component will be inserted.\",docs:\"https://docs.noodl.net/nodes/component-utilities/component-children\",color:\"component\",allowAsChild:!0,category:\"Visual\",haveComponentChildren:[\"Visual\"]}]},n=Object.keys(e._constructors);n.forEach((function(n){const o=e._constructors[n].metadata,i={name:n,searchTags:o.searchTags};t.nodetypes.push(i),o.version&&(i.version=o.version),o.displayNodeName&&(i.displayNodeName=o.displayNodeName),o.nodeDoubleClickAction&&(i.nodeDoubleClickAction=o.nodeDoubleClickAction),o.shortDesc&&(i.shortDesc=o.shortDesc),o.module&&(i.module=o.module),o.deprecated&&(i.deprecated=!0),o.haveComponentPorts&&(i.haveComponentPorts=!0),\"Visual\"===o.category&&(i.allowAsChild=!0,i.allowAsExportRoot=!0,i.color=\"visual\"),void 0!==o.allowAsExportRoot&&(i.allowAsExportRoot=o.allowAsExportRoot),o.allowChildren&&(i.allowChildrenWithCategory=[\"Visual\"],i.color=\"visual\"),o.allowChildrenWithCategory&&(i.allowChildrenWithCategory=o.allowChildrenWithCategory),o.singleton&&(i.singleton=!0),o.allowAsChild&&(i.allowAsChild=!0),o.docs&&(i.docs=o.docs),o.shortDocs?i.shortDocs=o.shortDocs:o.docs&&0===o.docs.indexOf(\"https://docs.noodl.net\")&&(i.shortDocs=o.docs.replace(\"/#\",\"\")+\"-short.md\"),i.category=o.category,o.panels&&(i.panels=o.panels),o.usePortAsLabel&&(i.usePortAsLabel=o.usePortAsLabel,i.portLabelTruncationMode=o.portLabelTruncationMode),o.color&&(i.color=o.color),o.dynamicports&&(i.dynamicports=formatDynamicPorts(o)),o.exportDynamicPorts&&(i.exportDynamicPorts=o.exportDynamicPorts),o.visualStates&&(i.visualStates=o.visualStates),o.useVariants&&(i.useVariants=o.useVariants),o.connectionPanel&&(i.connectionPanel=o.connectionPanel),i.ports=[];const s=i.dynamicports||[],r={},a={};s.filter((e=>void 0!==e.channelPort)).forEach((e=>{a[e.channelPort.plug+\"/\"+e.channelPort.name]=!0})),s.length&&(i.dynamicports=s),Object.keys(o.inputs||{}).forEach((function(e){var t;if(r.hasOwnProperty(\"input/\"+e)||a.hasOwnProperty(\"input/\"+e))return;const n=null===(t=o.inputs)||void 0===t?void 0:t[e];n&&!1!==n.exportToEditor&&(i.ports||(i.ports=[]),i.ports.push(formatPort(e,n,\"input\")))})),Object.keys(o.outputs||{}).forEach((function(e){var t;if(r.hasOwnProperty(\"output/\"+e)||a.hasOwnProperty(\"output/\"+e))return;const n=null===(t=o.outputs)||void 0===t?void 0:t[e];n&&function(e,t){const n={name:e,type:t.type,plug:\"output\"};t.group&&(n.group=t.group),t.displayName&&(n.displayName=t.displayName),t.editorName&&(n.editorName=t.editorName),t.hasOwnProperty(\"index\")&&(n.index=t.index),i.ports||(i.ports=[]),i.ports.push(n)}(e,n)}))}));t.nodeIndex={coreNodes:[{name:\"UI Elements\",description:\"Buttons, inputs, containers, media\",type:\"visual\",subCategories:[{name:\"Basic Elements\",items:[\"Group\",\"net.noodl.visual.columns\",\"Text\",\"Image\",\"Video\",\"Circle\",\"net.noodl.visual.icon\"]},{name:\"UI Controls\",items:[\"net.noodl.controls.button\",\"net.noodl.controls.checkbox\",\"net.noodl.controls.options\",\"net.noodl.controls.radiobutton\",\"Radio Button Group\",\"net.noodl.controls.range\",\"net.noodl.controls.textinput\"]}]},{name:\"Navigation & Popups\",description:\"Page routing, navigation, popups\",type:\"logic\",subCategories:[{name:\"Navigation\",items:[\"Router\",\"RouterNavigate\",\"PageInputs\",\"net.noodl.externallink\",\"PageStackNavigateToPath\"]},{name:\"Component Stack\",items:[\"Page Stack\",\"PageStackNavigate\",\"PageStackNavigateBack\"]},{name:\"Popups\",items:[\"NavigationShowPopup\",\"NavigationClosePopup\"]}]},{name:\"Logic & Utilities\",description:\"Logic, events, string manipulation\",type:\"logic\",subCategories:[{name:\"General Utils\",items:[\"States\",\"Value Changed\",\"Timer\",\"Color Blend\",\"Number Remapper\",\"Counter\",\"Drag\",\"net.noodl.animatetovalue\"]},{name:\"Logic\",items:[\"Boolean To String\",\"Switch\",\"And\",\"Or\",\"Condition\",\"Inverter\"]},{name:\"Events\",items:[\"Event Sender\",\"Event Receiver\"]},{name:\"String Manipulation\",items:[\"Substring\",\"String Mapper\",\"String Format\",\"Date To String\",\"Unique Id\"]},{name:\"System\",items:[\"Screen Resolution\",\"Open File Picker\"]},{name:\"Variables\",items:[\"String\",\"Boolean\",\"Color\",\"Number\"]}]},{name:\"Component Utilities\",description:\"Component inputs, outputs & object\",type:\"component\",subCategories:[{name:\"\",items:[\"Component Inputs\",\"Component Outputs\",\"Component Children\",\"net.noodl.ComponentObject\",\"net.noodl.ParentComponentObject\",\"net.noodl.SetComponentObjectProperties\",\"net.noodl.SetParentComponentObjectProperties\"]}]},{name:\"Read & Write Data\",description:\"Arrays, objects, cloud data\",type:\"data\",subCategories:[{name:\"\",items:[\"RunTasks\",\"For Each\",\"For Each Actions\",\"Model2\",\"SetModelProperties\",\"NewModel\",\"Set Variable\",\"Variable2\"]},{name:\"Array\",items:[\"Collection2\",\"CollectionNew\",\"CollectionRemove\",\"CollectionClear\",\"CollectionInsert\",\"Filter Collection\",\"Map Collection\",\"Static Data\"]},{name:\"Cloud Data\",items:[\"DbModel2\",\"NewDbModelProperties\",\"FilterDBModels\",\"SetDbModelProperties\",\"DbCollection2\",\"DeleteDbModelProperties\",\"AddDbModelRelation\",\"RemoveDbModelRelation\",\"Cloud File\",\"Upload File\",\"CloudFunction2\",\"DbConfig\"]},{name:\"User\",items:[\"net.noodl.user.LogIn\",\"net.noodl.user.LogOut\",\"net.noodl.user.SignUp\",\"net.noodl.user.User\",\"net.noodl.user.SetUserProperties\",\"net.noodl.user.VerifyEmail\",\"net.noodl.user.SendEmailVerification\",\"net.noodl.user.ResetPassword\",\"net.noodl.user.RequestPasswordReset\"]},{name:\"External Data\",items:[\"REST2\"]}]},{name:\"Custom Code\",description:\"Custom JavaScript and CSS\",type:\"javascript\",subCategories:[{name:\"\",items:[\"Expression\",\"JavaScriptFunction\",\"Javascript2\",\"CSS Definition\"]}]},{name:\"Cloud Functions\",description:\"Nodes to be used in cloud functions\",type:\"data\",subCategories:[{name:\"\",items:[\"noodl.cloud.request\",\"noodl.cloud.response\"]},{name:\"Cloud Data\",items:[\"noodl.cloud.aggregate\"]}]}]};const o=[];return n.forEach((t=>{e._constructors[t].metadata.module&&o.push(t)})),o.length&&(t.nodeIndex.moduleNodes=[{name:\"\",items:o}]),t}function addModuleSettings(e,t){for(let n=0;n<t.length;n++){const o=t[n];o.settings&&o.settings.forEach((t=>{e.ports.push(t)}))}}function generateProjectSettings(e,t){const n={dynamicports:[],ports:[]};return addModuleSettings(n,t),n}class NodeModel extends EventSender{constructor(e,t){super(),this.id=e,this.type=t,this.inputs=[],this.outputs=[],this.children=[],this.parameters={},this.inputPorts={},this.outputPorts={}}setParameter(e,t,n){n?(this.stateParameters||(this.stateParameters={}),this.stateParameters[n]||(this.stateParameters[n]={}),void 0===t?delete this.stateParameters[n][e]:this.stateParameters[n][e]=t):void 0===t?delete this.parameters[e]:this.parameters[e]=t,this.emit(\"parameterUpdated\",{name:e,value:t,state:n})}setParameters(e){Object.keys(e).forEach((t=>{this.setParameter(t,e[t])}))}setStateParameters(e){this.stateParameters=e}setStateTransitions(e){this.stateTransitions=e}setStateTransitionParamter(e,t,n){this.stateTransitions||(this.stateTransitions={}),t?this.stateTransitions[n][e]=t:delete this.stateTransitions[n][e]}setDefaultStateTransition(e,t){this.defaultStateTransitions||(this.defaultStateTransitions={}),this.defaultStateTransitions[t]=e}addInputPort(e){this.inputPorts[e.name]=e,this.emit(\"inputPortAdded\",e)}getInputPort(e){return this.inputPorts[e]}getInputPorts(){return this.inputPorts}removeInputPortWithName(e){if(this.inputPorts.hasOwnProperty(e)){const t=this.inputPorts[e];delete this.inputPorts[e],this.emit(\"inputPortRemoved\",t)}}updateInputPortTypes(e){let t=!1;for(const n in e)void 0!==this.inputPorts[n]&&(this.inputPorts[n].type=e[n].type,t=!0);t&&this.emit(\"inputPortTypesUpdated\")}addOutputPort(e){this.outputPorts[e.name]=e,this.emit(\"outputPortAdded\",e)}getOutputPort(e){return this.outputPorts[e]}getOutputPorts(){return this.outputPorts}removeOutputPortWithName(e){if(this.outputPorts.hasOwnProperty(e)){const t=this.outputPorts[e];delete this.outputPorts[e],this.emit(\"outputPortRemoved\",t)}}updateOutputPortTypes(e){let t=!1;for(const n in e)void 0!==this.outputPorts[n]&&(this.outputPorts[n].type=e[n].type,t=!0);t&&this.emit(\"outputPortTypesUpdated\")}addChild(e,t){e.parent=this,void 0===t?this.children.push(e):this.children.splice(t,0,e),this.emit(\"childAdded\",e)}removeChild(e){e.parent=void 0;const t=this.children.indexOf(e);this.children.splice(t,1),this.emit(\"childRemoved\",e)}reset(){this.removeAllListeners()}setVariant(e){this.variant=e,this.emit(\"variantUpdated\",e)}static createFromExportData(e){const t=new NodeModel(e.id,e.type);if(e.parameters&&t.setParameters(e.parameters),e.stateParameters&&t.setStateParameters(e.stateParameters),e.stateTransitions&&t.setStateTransitions(e.stateTransitions),e.defaultStateTransitions)for(const n in e.defaultStateTransitions)t.setDefaultStateTransition(e.defaultStateTransitions[n],n);return e.ports&&e.ports.forEach((e=>{\"input\"!==e.plug&&\"input/output\"!==e.plug||t.addInputPort(e),\"output\"!==e.plug&&\"input/output\"!==e.plug||t.addOutputPort(e)})),e.variant&&t.setVariant(e.variant),t}}class ComponentModel extends EventSender{constructor(e){super(),this.name=e,this.nodes={},this.connections=[],this.roots=[],this.inputPorts={},this.outputPorts={},this.metadata={}}async addNode(e){e.component=this,this.nodes[e.id]=e,await this.emit(\"nodeAdded\",e)}hasNodeWithId(e){return void 0!==this.getNodeWithId(e)}getNodeWithId(e){if(e)return this.nodes[e]}getAllNodes(){return Object.values(this.nodes)}getNodesWithType(e){const t=[];return Object.keys(this.nodes).forEach((n=>{const o=this.nodes[n];o.type===e&&t.push(o)})),t}addConnection(e){if(this.connections.push(e),this.emit(\"connectionAdded\",e),e.targetId){const t=this.getNodeWithId(e.targetId);t&&t.emit(\"inputConnectionAdded\",e)}}removeConnection(e){const t=this.connections.findIndex((t=>t.sourceId===e.sourceId&&t.sourcePort===e.sourcePort&&t.targetId===e.targetId&&t.targetPort===e.targetPort));if(-1!==t&&(this.connections.splice(t,1),this.emit(\"connectionRemoved\",e),e.targetId)){const t=this.getNodeWithId(e.targetId);t&&t.emit(\"inputConnectionRemoved\",e)}}getConnectionsFromPort(e,t){return this.connections.filter((n=>n.sourceId===e&&n.sourcePort===t))}getConnectionsToPort(e,t){return this.connections.filter((n=>n.targetId===e&&n.targetPort===t))}getConnectionsFrom(e){return this.connections.filter((t=>t.sourceId===e))}getConnectionsTo(e){return this.connections.filter((t=>t.targetId===e))}addRootId(e){e&&-1===this.roots.indexOf(e)&&(this.roots.push(e),this.emit(\"rootAdded\",e))}removeRootId(e){const t=this.roots.indexOf(e);-1!==t&&(this.roots.splice(t,1),this.emit(\"rootRemoved\",e))}getRoots(){return this.roots}async removeNodeWithId(e){const t=this.getNodeWithId(e);if(!t)return console.warn(\"ERROR: Attempted to remove non-existing node with ID:\",e),!1;for(;t.children.length>0;){const e=t.children[0];await this.removeNodeWithId(e.id)||t.children.shift()}const n=this.getConnectionsTo(e).concat(this.getConnectionsFrom(e));for(let e=0;e<n.length;e++)this.removeConnection(n[e]);return this.setNodeParent(t,void 0),-1!==this.roots.indexOf(t.id)&&this.removeRootId(t.id),await this.emit(\"nodeRemoved\",t),t.removeAllListeners(),delete this.nodes[e],await this.emit(\"nodeWasRemoved\",t),!0}getAllConnections(){return this.connections}getInputPorts(){return this.inputPorts}getOutputPorts(){return this.outputPorts}addInputPort(e){this.inputPorts[e.name]=e,this.emit(\"inputPortAdded\",e)}addOutputPort(e){this.outputPorts[e.name]=e,this.emit(\"outputPortAdded\",e)}removeOutputPortWithName(e){if(this.outputPorts.hasOwnProperty(e)){const t=this.outputPorts[e];delete this.outputPorts[e],this.emit(\"outputPortRemoved\",t)}}removeInputPortWithName(e){if(this.inputPorts.hasOwnProperty(e)){const t=this.inputPorts[e];delete this.inputPorts[e],this.emit(\"inputPortRemoved\",t)}}updateInputPortTypes(e){let t=!1;for(const n in e)void 0!==this.inputPorts[n]&&(this.inputPorts[n].type=e[n].type,t=!0);t&&this.emit(\"inputPortTypesUpdated\")}updateOutputPortTypes(e){let t=!1;for(const n in e)void 0!==this.outputPorts[n]&&(this.outputPorts[n].type=e[n].type,t=!0);t&&this.emit(\"outputPortTypesUpdated\")}renameInputPortOnNodeWithId(e,t,n){const o=this.getConnectionsToPort(e,t);o.forEach(this.removeConnection.bind(this));const i=this.getNodeWithId(e);if(!i)return;const s={...i.getInputPort(t)};s&&(i.removeInputPortWithName(t),s.name=n,i.addInputPort(s)),o.forEach((e=>{e.targetPort=n})),o.forEach(this.addConnection.bind(this))}renameOutputPortOnNodeWithId(e,t,n){const o=this.getConnectionsFromPort(e,t);o.forEach(this.removeConnection.bind(this));const i=this.getNodeWithId(e);if(!i)return;const s={...i.getOutputPort(t)};i.removeOutputPortWithName(t),s.name=n,i.addOutputPort(s),o.forEach((e=>{e.sourcePort=n})),o.forEach(this.addConnection.bind(this))}setNodeParent(e,t,n){e&&(-1!==this.roots.indexOf(e.id)&&this.removeRootId(e.id),e.parent&&(this.emit(\"nodeParentWillBeRemoved\",e),e.parent.removeChild(e)),e.emit(\"parentUpdated\",t),t&&(t.addChild(e,n),this.emit(\"nodeParentUpdated\",e)))}async importEditorNodeData(e,t,n){const o=NodeModel.createFromExportData(e);if(await this.addNode(o),t&&this.setNodeParent(o,this.getNodeWithId(t),n),e.children)for(let t=0;t<e.children.length;t++){const n=e.children[t];await this.importEditorNodeData(n,o.id,t)}}async reset(){for(;this.roots.length;)await this.removeNodeWithId(this.roots[0]);for(const e of Object.keys(this.nodes))this.hasNodeWithId(e)&&await this.removeNodeWithId(e);if(Object.keys(this.nodes).length>0)throw new Error(\"Not all nodes were removed during a reset\");if(this.connections.length>0)throw new Error(\"Not all connections were removed during a reset\")}rename(e){const t=this.name;this.name=e,this.emit(\"renamed\",{oldName:t,newName:e})}setMetadata(e,t){this.metadata[e]=t}getMetadata(e){return e?this.metadata[e]:this.metadata}static async createFromExportData(e){const t=new ComponentModel(e.name);if(e.metadata)for(const n in e.metadata)t.setMetadata(n,e.metadata[n]);if(e.ports&&e.ports.forEach((e=>{\"input\"!==e.plug&&\"input/output\"!==e.plug||t.addInputPort(e),\"output\"!==e.plug&&\"input/output\"!==e.plug||t.addOutputPort(e)})),e.nodes)for(const n of e.nodes)await t.importEditorNodeData(n);return e.connections&&e.connections.forEach((e=>t.addConnection(e))),e.roots&&e.roots.forEach((e=>t.addRootId(e))),t}}class GraphModel extends EventSender{constructor(){super(),this.componentToBundleMap=new Map,this.variants=[],this.components={},this.settings={},this.metadata={}}async importComponentFromEditorData(e){const t=await ComponentModel.createFromExportData(e);this.addComponent(t)}getBundleContainingComponent(e){return this.componentToBundleMap.get(e)}getBundlesContainingSheet(e){const t=new Set;for(const n of this.componentToBundleMap.keys()){const o=0!==n.indexOf(\"/#\");(o&&\"Default\"===e||!o&&0===n.indexOf(\"/#\"+e))&&t.add(this.componentToBundleMap.get(n))}return Array.from(t)}getBundleDependencies(e){const t=new Set,n=e=>{var o;const i=null===(o=this.componentIndex)||void 0===o?void 0:o[e];if(i)for(const e of i.dependencies)t.has(e)||(t.add(e),n(e))};return n(e),Array.from(t)}async importEditorData(e){this.componentIndex=e.componentIndex,this.routerIndex=e.routerIndex,this.componentToBundleMap=new Map;for(const t in e.componentIndex){const n=e.componentIndex[t];for(const e of n.components)this.componentToBundleMap.set(e,t)}this.variants=e.variants||[],e.settings&&this.setSettings(e.settings),e.metadata&&this.setAllMetaData(e.metadata);for(const t of e.components)await this.importComponentFromEditorData(t);this.setRootComponentName(e.rootComponent)}setRootComponentName(e){this.rootComponent=e,this.emit(\"rootComponentNameUpdated\",e)}getNodesWithType(e){let t=[];const n=Object.keys(this.components);for(let o=0;o<n.length;o++){const i=this.components[n[o]];t=t.concat(i.getNodesWithType(e))}return t}getComponentWithName(e){return this.components[e]}hasComponentWithName(e){return!!this.components[e]}getAllComponents(){return Object.keys(this.components).map((e=>this.components[e]))}getAllNodes(){let e=[];const t=Object.keys(this.components);for(let n=0;n<t.length;n++){const o=this.components[t[n]];e=e.concat(o.getAllNodes())}return e}addComponent(e){this.components[e.name]=e,this.getNodesWithType(e.name).forEach(this._addComponentPorts.bind(this)),e.getAllNodes().forEach(this._onNodeAdded.bind(this)),e.on(\"nodeAdded\",this._onNodeAdded.bind(this),this),e.on(\"nodeRemoved\",this._onNodeRemoved.bind(this),this),e.on(\"nodeWasRemoved\",this._onNodeWasRemoved.bind(this),this),this.emit(\"componentAdded\",e)}async removeComponentWithName(e){if(!e)return;if(!1===this.components.hasOwnProperty(e))return void console.error(\"GraphModel: Component with name \"+e+\" not in graph\");const t=this.components[e];await t.reset(),t.removeAllListeners(),delete this.components[t.name],this.emit(\"componentRemoved\",t)}renameComponent(e,t){if(!1===this.components.hasOwnProperty(e))return void console.error(\"GraphModel: Component with name \"+e+\" not in graph\");this.getNodesWithType(e).forEach((function(e){e.type=t}));const n=this.components[e];n.rename(t),delete this.components[e],this.components[t]=n,this.emit(\"componentRenamed\",n)}_addComponentPorts(e){if(this.components.hasOwnProperty(e.type)){const t=this.components[e.type],n=t.getInputPorts(),o=t.getOutputPorts();Object.keys(n).forEach((t=>{e.addInputPort(n[t])})),Object.keys(o).forEach((t=>{e.addOutputPort(o[t])}))}}_onNodeAdded(e){this._addComponentPorts(e),this.emit(\"nodeAdded\",e),this.emit(\"nodeAdded.\"+e.type,e)}_onNodeRemoved(e){this.emit(\"nodeRemoved\",e),this.emit(\"nodeRemoved.\"+e.type,e)}_onNodeWasRemoved(e){this.emit(\"nodeWasRemoved\",e),this.emit(\"nodeWasRemoved.\"+e.type,e)}async reset(){for(const e of Object.keys(this.components))await this.removeComponentWithName(e);this.setSettings({})}isEmpty(){return 0===Object.keys(this.components).length}setSettings(e){this.settings=e,this.emit(\"projectSettingsChanged\",e)}getSettings(){return this.settings}setAllMetaData(e){for(const t in e)this.setMetaData(t,e[t])}setMetaData(e,t){this.metadata[e]&&JSON.stringify(this.metadata[e])===JSON.stringify(t)||(this.metadata[e]=t,this.emit(\"metadataChanged\",{key:e,data:t}),this.emit(\"metadataChanged.\"+e,t))}getMetaData(e){return e?this.metadata[e]:this.metadata}getVariants(){return this.variants||[]}getVariant(e,t){return this.variants.find((n=>n.name===t&&n.typename===e))}updateVariant(e){const t=this.variants.findIndex((t=>t.name===e.name&&t.typename===e.typename));-1!==t&&this.variants.splice(t,1),this.variants.push(e),this.emit(\"variantUpdated\",e)}updateVariantParameter(e,t,n,o,i){const s=this.getVariant(t,e);s?(i?(s.stateParameters.hasOwnProperty(i)||(s.stateParameters[i]={}),void 0===o?delete s.stateParameters[i][n]:s.stateParameters[i][n]=o):void 0===o?delete s.parameters[n]:s.parameters[n]=o,this.emit(\"variantUpdated\",s)):console.log(\"updateVariantParameter: can't find variant\",e,t)}updateVariantDefaultStateTransition(e,t,n,o){const i=this.getVariant(t,e);i&&(i.defaultStateTransitions[o]=n,this.emit(\"variantUpdated\",i))}updateVariantStateTransition(e){const{variantTypeName:t,variantName:n,state:o,parameterName:i,curve:s}=e,r=this.getVariant(t,n);r&&(r.stateTransitions[o]||(r.stateTransitions[o]={}),r.stateTransitions[o][i]=s)}deleteVariant(e,t){const n=this.variants.findIndex((n=>n.name===t&&n.typename===e));-1!==n&&this.variants.splice(n,1)}}function difference(e,t){const n=new Set(t);return e.filter((e=>!n.has(e)))}async function handleEvent(e,t,n){function o(t,n){const o={},s={};n.forEach((e=>{\"input\"!==e.plug&&\"input/output\"!==e.plug||(o[e.name]=e),\"output\"!==e.plug&&\"input/output\"!==e.plug||(s[e.name]=e)}));const r=Object.keys(t.getInputPorts()),a=difference(r,Object.keys(o)),d=difference(Object.keys(o),r);t.updateInputPortTypes(o),a.forEach(t.removeInputPortWithName.bind(t)),d.forEach((n=>{var s;t.addInputPort(o[n]),t instanceof NodeModel&&(null===(s=t.parameters)||void 0===s?void 0:s.hasOwnProperty(n))&&i(e.rootComponent.nodeScope,t,n,t.parameters[n])})),t.updateOutputPortTypes(s);const l=Object.keys(t.getOutputPorts()),u=difference(l,Object.keys(s)),c=difference(Object.keys(s),l);u.forEach(t.removeOutputPortWithName.bind(t)),c.forEach((e=>{t.addOutputPort(s[e])}))}function i(e,t,n,o){e.getNodesWithIdRecursive(t.id).forEach((e=>{e.queueInput(n,o)}))}let s;if(n.componentName&&(s=t.getComponentWithName(n.componentName),!s))return;if(!s)throw new Error(\"Component model not found\");const r={nodeAdded:e=>{null==s||s.importEditorNodeData(e.model,e.parentId,e.childIndex)},nodeRemoved:async e=>{(null==s?void 0:s.hasNodeWithId(e.model.id))&&await s.removeNodeWithId(e.model.id)},connectionAdded:e=>{null==s||s.addConnection(e.model)},connectionRemoved:t=>{if(!s)return;s.removeConnection(t.model);const n=s.getNodeWithId(t.model.targetId);if(0===s.getConnectionsToPort(n.id,t.model.targetId).length){let o=n.parameters[t.model.targetPort];void 0===o&&(o=e.getDefaultValueForInput(n.type,t.model.targetPort)),i(e.rootComponent.nodeScope,n,t.model.targetPort,o)}},parameterChanged:e=>{if(!s)return;const t=s.getNodeWithId(e.nodeId);if(void 0!==t){if(e.parameters){const n=new Set([...Object.keys(e.parameters),...Object.keys(e.oldParameters)]);for(const o of n)t.setParameter(o,e.parameters[o])}e.parameterName&&t.setParameter(e.parameterName,e.parameterValue,e.state)}else console.log(\"parameterChanged: Unknown node id\",e)},nodeAttached:e=>{s&&s.setNodeParent(s.getNodeWithId(e.nodeId),s.getNodeWithId(e.parentId),e.childIndex)},nodeDetached:e=>{s&&(s.setNodeParent(s.getNodeWithId(e.nodeId),null),s.addRootId(e.nodeId))},componentAdded:e=>{t.importComponentFromEditorData(e.model)},componentRemoved:async e=>{await t.removeComponentWithName(e.componentName)},rootAdded:e=>{null==s||s.addRootId(e.nodeId)},portAdded:t=>{if(!s)return;const n=s.getNodeWithId(t.nodeId);t.port&&n&&(\"input\"!==t.port.plug&&\"input/output\"!==t.port.plug||(n.addInputPort(t.port),n.parameters.hasOwnProperty(t.port.name)&&i(e.rootComponent.nodeScope,n,t.port.name,n.parameters[t.port.name])),\"output\"!==t.port.plug&&\"input/output\"!==t.port.plug||n.addOutputPort(t.port))},portRemoved:e=>{if(!s)return;const t=s.getNodeWithId(e.nodeId);e.port&&t&&(\"input\"!==e.port.plug&&\"input/output\"!==e.port.plug||t.removeInputPortWithName(e.port.name),\"output\"!==e.port.plug&&\"input/output\"!==e.port.plug||t.removeOutputPortWithName(e.port.name))},nodePortRenamed:e=>{if(!e.port||!s)return;\"input\"!==e.port.plug&&\"input/output\"!==e.port.plug||e.nodeId&&e.oldName&&s.renameInputPortOnNodeWithId(e.nodeId,e.oldName,e.port.name),e.nodeId&&e.oldName&&(\"output\"===e.port.plug||\"input/output\"===e.port.plug)&&s.renameOutputPortOnNodeWithId(e.nodeId,e.oldName,e.port.name);const n=s.getNodeWithId(e.nodeId);\"Component Inputs\"===(null==n?void 0:n.type)?(s.addInputPort(e.port),t.getNodesWithType(s.name).forEach((t=>{var n;t.component.renameInputPortOnNodeWithId(t.id,e.oldName,null===(n=e.port)||void 0===n?void 0:n.name)})),s.removeInputPortWithName(e.oldName)):\"Component Outputs\"===(null==n?void 0:n.type)&&(s.addOutputPort(e.port),t.getNodesWithType(s.name).forEach((t=>{var n;t.component.renameOutputPortOnNodeWithId(t.id,e.oldName,null===(n=e.port)||void 0===n?void 0:n.name)})),s.removeOutputPortWithName(e.oldName))},componentPortsUpdated:e=>{s&&o(s,e.ports)},instancePortsChanged:e=>{if(!s.hasNodeWithId(e.nodeId))return;const t=s.getNodeWithId(e.nodeId);t&&o(t,e.ports)},componentRenamed:e=>{t.renameComponent(e.oldName,e.newName)},settingsChanged:e=>{t.setSettings(e.settings)},metadataChanged:e=>{t.setMetaData(e.key,e.data)},componentMetadataChanged:e=>{const n=t.getComponentWithName(e.componentName);n&&n.setMetadata(e.key,e.data)},variantParametersChanged:n=>{if(n.variant)t.updateVariant(n.variant);else if(t.updateVariantParameter(n.variantName,n.variantTypeName,n.parameterName,n.parameterValue,n.state),void 0===n.parameterValue){const o=t.getVariant(n.variantTypeName,n.variantName);e.rootComponent.nodeScope.getAllNodesWithVariantRecursive(o).forEach((e=>{e.queueInput(n.parameterName,e.getParameter(n.parameterName))}))}},variantDeleted:e=>{t.deleteVariant(e.variantTypeName,e.variantName)},variantChanged:e=>{const n=s.getNodeWithId(e.nodeId);if(n){const o=t.getVariant(n.type,e.variantName);n.setVariant(o)}},variantRenamed:e=>{const n=t.getVariant(e.variantTypeName,e.oldVariantName);(null==n?void 0:n.variantName)&&(n.name=n.variantName)},defaultStateTransitionChanged:e=>{const t=s.getNodeWithId(e.nodeId);null==t||t.setDefaultStateTransition(e.curve,e.state)},stateTransitionsChanged:e=>{const t=s.getNodeWithId(e.nodeId);t&&e.parameterName&&t.setStateTransitionParamter(e.parameterName,e.curve,e.state)},variantDefaultStateTransitionChanged:e=>{t.updateVariantDefaultStateTransition(e.variantName,e.variantTypeName,e.curve,e.state)},variantStateTransitionsChanged:e=>{t.updateVariantStateTransition(e)},routerIndexChanged:e=>{t.routerIndex=e.data}};r.hasOwnProperty(n.type)?(await r[n.type](n),e.scheduleUpdate()):console.log(\"Unknown event\",n)}class Services{}function createSetter(e){let t=!1;return function(n){(n=!!n)&&!1===t&&e.valueChangedToTrue.call(this),t=n}}async function asyncPool(e,t,n){const o=[],i=[];for(const s of t){const r=Promise.resolve().then((()=>n(s,t)));if(o.push(r),e<=t.length){const t=r.then((()=>{i.splice(i.indexOf(t),1)}));i.push(t),i.length>=e&&await Promise.race(i)}}return Promise.all(o)}function registerInput(e,t,n,o){if(e.hasOwnProperty(n))throw new Error(\"Input property \"+n+\" already registered\");if(o.set||o.valueChangedToTrue||(o.set=()=>{}),o.set){e[n]={set:o.set};[\"color\",\"textStyle\",\"array\"].forEach((t=>{!o.type||o.type!==t&&o.type.name!==t||(e[n].type=t)}))}o.setUnitType&&(e[n].setUnitType=o.setUnitType),t.inputs=t.inputs||{},t.inputs[n]={displayName:o.displayName,editorName:o.editorName,group:o.group,type:o.type,default:o.default,index:o.index,exportToEditor:!o.hasOwnProperty(\"exportToEditor\")||o.exportToEditor,inputPriority:o.inputPriority||0,tooltip:o.tooltip,tab:o.tab,popout:o.popout,allowVisualStates:o.allowVisualStates,nodeDoubleClickAction:o.nodeDoubleClickAction},o.valueChangedToTrue&&(t.inputs[n].type={name:\"signal\",allowConnectionsOnly:!0})}function registerInputs(e,t,n){Object.keys(n).forEach((function(o){registerInput(e,t,o,n[o])}))}function registerNumberedInputs(e,t){for(const n of Object.keys(t))registerNumberedInput(e,n,t[n])}function registerNumberedInput(e,t,n){const o=e.registerInputIfNeeded;e.registerInputIfNeeded=function(i){if(o&&o.call(e,i),e.hasInput(i)||!i.startsWith(t))return;const s=Number(i.slice(t.length+1));e.registerInput(i,{type:n.type,set:n.createSetter.call(e,s)})}}function registerOutputsMetadata(e,t){Object.keys(t).forEach((function(n){const o=t[n];e.outputs=e.outputs||{},e.outputs[n]={displayName:o.displayName,editorName:o.editorName,group:o.group,type:o.type,index:o.index,exportToEditor:!o.hasOwnProperty(\"exportToEditor\")||o.exportToEditor}}))}function initializeDefaultValues(e,t){Object.keys(t).forEach((n=>{const o=t[n].default;void 0!==o&&(t[n].type.defaultUnit?e[n]={unit:t[n].type.defaultUnit,value:o}:e[n]=o)}))}function defineNode(e){if(!e.category)throw new Error(\"Node must have a category\");if(!e.name)throw new Error(\"Node must have a name\");const t={inputs:{},outputs:{},category:e.category,dynamicports:e.dynamicports,exportDynamicPorts:e.exportDynamicPorts,useVariants:e.useVariants,allowChildren:e.allowChildren,allowChildrenWithCategory:e.allowChildrenWithCategory,singleton:e.singleton,connectionPanel:e.connectionPanel,allowAsChild:e.allowAsChild,visualStates:e.visualStates,panels:e.panels,color:e.color,usePortAsLabel:e.usePortAsLabel,portLabelTruncationMode:e.portLabelTruncationMode,name:e.name,displayNodeName:e.displayNodeName||e.displayName,deprecated:e.deprecated,haveComponentPorts:e.haveComponentPorts,version:e.version,module:e.module,docs:e.docs,allowAsExportRoot:e.allowAsExportRoot,nodeDoubleClickAction:e.nodeDoubleClickAction,searchTags:e.searchTags};e._internal=e._internal||{},e.prototypeExtensions=e.methods||e.prototypeExtensions||{},e.inputs=e.inputs||{},e.outputs=e.outputs||{},e.initialize=e.initialize||function(){};const n={};registerInputs(n,t,e.inputs),registerOutputsMetadata(t,e.outputs);class o extends Node$1{constructor(e,t){super(e,t)}}e.prototypeExtensions&&Object.keys(e.prototypeExtensions).forEach((function(t){e.prototypeExtensions[t].value||(e.prototypeExtensions[t]={value:e.prototypeExtensions[t]})})),Object.defineProperties(o.prototype,e.prototypeExtensions),Object.defineProperty(o.prototype,\"name\",{value:e.name}),e.getInspectInfo&&(o.prototype.getInspectInfo=e.getInspectInfo),e.nodeScopeDidInitialize&&(o.prototype.nodeScopeDidInitialize=e.nodeScopeDidInitialize);const i=function(s,r,a){var d;const l=new o(s,r);if(l._inputs=Object.create(n),e.inputs)return Object.keys(e.inputs).forEach((function(t){const n=e.inputs[t];n.valueChangedToTrue&&(l._inputs[t]={set:createSetter({valueChangedToTrue:n.valueChangedToTrue})})})),e.outputs?(Object.keys(e.outputs).forEach((function(t){const n=e.outputs[t];\"signal\"===n.type?l.registerOutput(t,{getter(){}}):l.registerOutput(t,n)})),e.numberedInputs&&registerNumberedInputs(l,e.numberedInputs),l.nodeScope=a,initializeDefaultValues(l._inputValues,t.inputs||{}),null===(d=e.initialize)||void 0===d||d.call(l),l):(Object.assign(i,{metadata:t}),e.numberedInputs&&registerSetupFunctionForNumberedInputs(i,e.name,e.numberedInputs),i)};return i.metadata=t,i}function registerSetupFunctionForNumberedInputs(e,t,n){const o=Object.keys(n);o.length&&(e.setupNumberedInputDynamicPorts=function(e,i){const s=e.editorConnection;function r(e){const t=o.map((t=>function(e,t,n){const o=e.component.getConnectionsTo(e.id).map((e=>e.targetPort)),i=Object.keys(e.parameters).concat(o).filter((e=>e.startsWith(t+\" \"))),s=(i.length?1+Math.max(...i.map((e=>Number(e.slice(t.length+1))))):0)+1,r=[];for(let e=0;e<s;e++){const o={name:t+\" \"+e,displayName:(n.displayPrefix||t)+\" \"+e,type:n.type,plug:\"input\",group:n.group};n.hasOwnProperty(\"index\")&&(o.index=n.index+e),r.push(o)}return r}(e,t,n[t]))).flat();null==s||s.sendDynamicPorts(e.id,t)}s&&s.isRunningLocally()&&i.on(\"nodeAdded.\"+t,(e=>{r(e),e.on(\"parameterUpdated\",(()=>{r(e)})),e.on(\"inputConnectionAdded\",(()=>{r(e)})),e.on(\"inputConnectionRemoved\",(()=>{r(e)}))}))})}function extend(e,t){for(const n in t)if(\"initialize\"===n&&e.initialize){const n=e.initialize;e.initialize=function(){n.call(this),t.initialize.call(this)}}else t[n]&&t[n].constructor===Object?e[n]=extend(e[n]||{},t[n]):t[n]&&t[n].constructor===Array&&e[n]&&e[n].constructor==Array?e[n]=e[n].concat(t[n]):e[n]=t[n];return e}Services.events=new EventEmitter;const node$y={name:\"Component Inputs\",shortDesc:\"This node is used to define the inputs of a component.\",docs:\"https://docs.noodl.net/nodes/component-utilities/component-inputs\",panels:[{name:\"PortEditor\",context:[\"select\",\"connectFrom\"],title:\"Inputs\",plug:\"output\",type:{name:\"*\"},canArrangeInGroups:!0},{name:\"PropertyEditor\",hidden:!0}],getInspectInfo(){var e;return{type:\"value\",value:null===(e=this.nodeScope)||void 0===e?void 0:e.componentOwner._internal.inputValues}},color:\"component\",haveComponentPorts:!0,category:\"Component Utilities\",methods:{registerOutputIfNeeded(e){this.hasOutput(e)||this.registerOutput(e,{getter(){var t;return null===(t=this.nodeScope)||void 0===t?void 0:t.componentOwner._internal.inputValues[e]}})},_updateDependencies(){var e,t;null===(t=null===(e=this.nodeScope)||void 0===e?void 0:e.componentOwner)||void 0===t||t.update()}}};var componentinputs=Object.freeze({__proto__:null,node:node$y});const node$x={category:\"Component Utilities\",name:\"Component Outputs\",shortDesc:\"This node is used to define the outputs of a component.\",docs:\"https://docs.noodl.net/nodes/component-utilities/component-outputs\",panels:[{name:\"PortEditor\",context:[\"select\",\"connectTo\"],title:\"Outputs\",plug:\"input\",type:{name:\"*\"},canArrangeInGroups:!0},{name:\"PropertyEditor\",hidden:!0}],color:\"component\",haveComponentPorts:!0,prototypeExtensions:{registerInputIfNeeded:function(e){this.hasInput(e)||this.registerInput(e,{set(t){var n,o;null===(o=null===(n=this.nodeScope)||void 0===n?void 0:n.componentOwner)||void 0===o||o.setOutputFromComponentOutput(e,t)}})}}};var componentoutputs=Object.freeze({__proto__:null,node:node$x});class Model{constructor(e,t){this.id=e,this.data=t}static get(e){return void 0===e&&(e=Model.guid()),Model.models[e]||(Model.models[e]=new Model(e,{}),Model.proxies[e]=new Proxy(Model.models[e],Model._modelProxyHandler)),Model.proxies[e]}static create(e){const t=e||{},n=Model.get(t.id);for(const e in t)\"id\"!==e&&n.set(e,t[e]);return n}static exists(e){return void 0!==Model.models[e]}static instanceOf(e){return e instanceof Model||e.target instanceof Model}static guid(){return randomString(10)}on(e,t){this.listeners||(this.listeners={}),this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}off(e,t){if(!this.listeners)return;if(!this.listeners[e])return;const n=this.listeners[e].indexOf(t);-1!==n&&this.listeners[e].splice(n,1)}notify(e,t){if(!this.listeners)return;if(!this.listeners[e])return;const n=this.listeners[e].slice();for(let e=0;e<n.length;e++)n[e](t)}setAll(e){for(const t in e)if(\"id\"!==t&&this.data[t]!==e[t]){const n=this.data[t];this.data[t]=e[t],this.notify(\"change\",{name:t,value:e[t],old:n})}}fill(e=null){for(const t in this.data){if(\"id\"===t)continue;const n=this.data[t];this.data[t]=e,this.notify(\"change\",{name:t,value:this.data[t],old:n})}}set(e,t,n){if((null==n?void 0:n.resolve)&&-1!==e.indexOf(\".\")){const n=e.split(\".\");let o=this;for(let e=0;e<n.length-1;e++){const t=o.get(n[e]);if(!Model.instanceOf(t))return;o=t}return void o.set(n[n.length-1],t)}const o=null==n?void 0:n.forceChange,i=this.data[e];this.data[e]=t,!o&&i===t||(null==n?void 0:n.silent)||this.notify(\"change\",{name:e,value:t,old:i})}getId(){return this.id}get(e,t){if((null==t?void 0:t.resolve)&&-1!==e.indexOf(\".\")){const t=e.split(\".\");let n=this;for(let e=0;e<t.length-1;e++){const o=n.get(t[e]);if(!Model.instanceOf(o))return;n=o}return n.get(t[t.length-1])}return this.data[e]}toJSON(){return Object.assign({},this.data,{id:this.id})}}Model._models={},Model.models=Model._models,Model.proxies={},Model._modelProxyHandler={get:function(e,t,n){return\"function\"==typeof e[t]?e[t].bind(e):t in e?Reflect.get(e,t,n):e.get(t.toString())},set:function(e,t,n){if(\"_class\"===t)e._class=n;else{if(\"id\"===t)return console.log(`Noodl.Object warning: id is readonly (Id is ${e.id}, trying to set to ${n})`),!0;e.set(t.toString(),n)}return!0},ownKeys:e=>Reflect.ownKeys(e.data),getOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e.data,t.toString())};class ModelScope{constructor(){this.models={},this.proxies={}}get(e){return void 0===e&&(e=Model.guid()),this.models[e]||(this.models[e]=new Model(e,{}),this.proxies[e]=new Proxy(this.models[e],Model._modelProxyHandler)),this.proxies[e]}create(e){const t=e||{},n=this.get(t.id);for(const e in t)\"id\"!==e&&n.set(e,t[e]);return n}exists(e){return void 0!==this.models[e]}instanceOf(e){return e instanceof Model||e.target instanceof Model}guid(){return randomString(10)}reset(){this.models={},this.proxies={},delete this._cloudStore}}function sendSignalOnInput(e,t){e.queueInput(t,!0),e.queueInput(t,!1)}const node$w={name:\"RunTasks\",displayNodeName:\"Run Tasks\",docs:\"https://docs.noodl.net/nodes/data/run-tasks\",color:\"data\",category:\"Data\",initialize(){this._internal={queuedOperations:[],state:\"idle\",maxRunningTasks:10,activeTasks:new Map}},inputs:{items:{group:\"Data\",displayName:\"Items\",type:\"array\",set(e){e&&e!==this._internal.items&&(this._internal.items=e)}},stopOnFailure:{group:\"General\",displayName:\"Stop On Failure\",type:\"boolean\",default:!1,set(e){this._internal.stopOnFailure=e}},maxRunningTasks:{group:\"General\",displayName:\"Max Running Tasks\",type:\"number\",default:10,set(e){this._internal.maxRunningTasks=e}},taskTemplate:{type:\"component\",displayName:\"Template\",group:\"General\",set(e){this._internal.template=e}},run:{group:\"General\",displayName:\"Do\",type:\"signal\",valueChangedToTrue(){this.scheduleRun()}},abort:{group:\"General\",displayName:\"Abort\",type:\"signal\",valueChangedToTrue(){this.scheduleAbort()}}},outputs:{success:{type:\"signal\",group:\"Events\",displayName:\"Success\"},failure:{type:\"signal\",group:\"Events\",displayName:\"Failure\"},done:{type:\"signal\",group:\"Events\",displayName:\"Done\"},aborted:{type:\"signal\",group:\"Events\",displayName:\"Aborted\"}},methods:{scheduleRun(){const e=this._internal;e.hasScheduledRun||(e.hasScheduledRun=!0,this.scheduleAfterInputsHaveUpdated((()=>{this._queueOperation((()=>{e.hasScheduledRun=!1,this.run()}))})))},scheduleAbort(){const e=this._internal;e.hasScheduledAbort||(e.hasScheduledAbort=!0,this.scheduleAfterInputsHaveUpdated((()=>{this._queueOperation((()=>{e.hasScheduledAbort=!1,this.abort()}))})))},async createTaskComponent(e){const t=this._internal,n=(this.nodeScope.modelScope||Model).create(e),o=await this.nodeScope.createNode(t.template,guid(),{_forEachModel:n,_forEachNode:this}),i=o.isInputConnected.bind(o);o.isInputConnected=e=>\"Do\"===e||i(e),o.hasInput(\"Id\")&&o.setInputValue(\"Id\",n.getId()),o.hasInput(\"id\")&&o.setInputValue(\"id\",n.getId());for(const e in o._inputs)void 0!==n.data[e]&&o.setInputValue(e,n.data[e]);return o._internal.creatorCallbacks={onOutputChanged:(e,t,i)=>{!1!==i&&void 0!==i||!0!==t||this.itemOutputSignalTriggered(e,n,o)}},o},async startTask(e){const t=this._internal;try{const n=await this.createTaskComponent(e);t.runningTasks++,sendSignalOnInput(n,\"Do\"),t.activeTasks.set(n.id,n)}catch(e){console.log(e)}},async run(){const e=this._internal;if(this.context.editorConnection&&(\"idle\"!==e.state?this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"run-tasks\",{message:\"Cannot start when not in idle mode\"}):e.template?e.items?this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name,this.id,\"run-tasks\"):this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"run-tasks\",{message:\"No items array provided.\"}):this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"run-tasks\",{message:\"No task template specified.\"})),\"idle\"===e.state&&e.template&&e.items){e.state=\"running\",e.numTasks=e.items.length,e.failedTasks=0,e.completedTasks=0,e.queuedTasks=[].concat(e.items),e.runningTasks=0,0===e.items.length&&(this.sendSignalOnOutput(\"success\"),e.state=\"idle\");for(let t=0;t<Math.min(e.maxRunningTasks,e.queuedTasks.length);t++){const t=e.queuedTasks.shift();if(!t)break;this.startTask(t)}}},abort(){this._internal.state=\"aborted\"},itemOutputSignalTriggered(e,t,n){const o=this._internal;if(\"idle\"===o.state)return;const i=()=>{if(\"aborted\"===o.state)return this.sendSignalOnOutput(\"aborted\"),void(o.state=\"idle\");if(o.completedTasks===o.numTasks)0===o.failedTasks?this.sendSignalOnOutput(\"success\"):this.sendSignalOnOutput(\"failure\"),this.sendSignalOnOutput(\"done\"),o.state=\"idle\";else if(o.stopOnFailure)if(0===o.failedTasks){o.runningTasks++;const e=o.queuedTasks.shift();e&&this.startTask(e)}else this.sendSignalOnOutput(\"failure\"),this.sendSignalOnOutput(\"aborted\");else{o.runningTasks++;const e=o.queuedTasks.shift();e&&this.startTask(e)}};\"Success\"===e?(o.completedTasks++,o.runningTasks--,i()):\"Failure\"===e&&(o.completedTasks++,o.failedTasks++,o.runningTasks--,i()),o.activeTasks.delete(n.id),this.nodeScope.deleteNode(n)},_queueOperation(e){this._internal.queuedOperations.push(e),this._runQueueOperations()},async _runQueueOperations(){if(!this.runningOperations){for(this.runningOperations=!0;this._internal.queuedOperations.length;){const e=this._internal.queuedOperations.shift();await e()}this.runningOperations=!1}}},_deleteAllTasks(){for(const e of this._internal.activeTasks)this.nodeScope.deleteNode(e);this._internal.activeTasks.clear()},_onNodeDeleted(){Node.prototype._onNodeDeleted.call(this),this._deleteAllTasks()}};var runtasks=Object.freeze({__proto__:null,node:node$w});const defaultRequestScript=\"//Add custom code to setup the request object before the request\\n//is made.\\n//\\n//*Request.resource     contains the resource path of the request.\\n//*Request.method       contains the method, GET, POST, PUT or DELETE.\\n//*Request.headers      is a map where you can add additional headers.\\n//*Request.parameters   is a map the parameters that will be appended\\n//                      to the url.\\n//*Request.content      contains the content of the request as a javascript\\n//                      object.\\n//\\n//*Inputs and *Outputs contain the inputs and outputs of the node.\\n\",defaultResponseScript=\"// Add custom code to convert the response content to outputs\\n//\\n//*Response.status    The status code of the response\\n//*Response.content   The content of the response as a javascript\\n//                    object.\\n//*Response.request   The request object that resulted in the response.\\n//\\n//*Inputs and *Outputs contain the inputs and outputs of the node.\\n\",node$v={name:\"REST2\",displayNodeName:\"REST\",docs:\"https://docs.noodl.net/nodes/data/rest\",category:\"Data\",color:\"data\",searchTags:[\"http\",\"request\",\"fetch\"],initialize(){this._internal.inputValues={},this._internal.outputValues={},this._internal.outputValuesProxy=new Proxy(this._internal.outputValues,{set:(e,t,n)=>(n!==this._internal.outputValues[t]&&(this.registerOutputIfNeeded(\"out-\"+t),this._internal.outputValues[t]=n,this.flagOutputDirty(\"out-\"+t)),!0)}),this._internal.self={}},getInspectInfo(){return this._internal.inspectData?{type:\"value\",value:this._internal.inspectData}:{type:\"text\",value:\"[Not executed yet]\"}},inputs:{resource:{type:\"string\",displayName:\"Resource\",group:\"Request\",default:\"/\",set(e){this._internal.resource=e}},method:{type:{name:\"enum\",enums:[{label:\"GET\",value:\"GET\"},{label:\"POST\",value:\"POST\"},{label:\"PUT\",value:\"PUT\"},{label:\"PATCH\",value:\"PATCH\"},{label:\"DELETE\",value:\"DELETE\"}]},displayName:\"Method\",group:\"Request\",default:\"GET\",set(e){this._internal.method=e}},requestScript:{type:{name:\"string\",allowEditOnly:!0,codeeditor:\"javascript\"},displayName:\"Request\",default:defaultRequestScript,group:\"Scripts\",set(e){try{this._internal.requestFunc=new Function(\"Inputs\",\"Outputs\",\"Request\",e)}catch(e){console.log(e)}}},responseScript:{type:{name:\"string\",allowEditOnly:!0,codeeditor:\"javascript\"},displayName:\"Response\",default:defaultResponseScript,group:\"Scripts\",set(e){try{this._internal.responseFunc=new Function(\"Inputs\",\"Outputs\",\"Response\",e)}catch(e){console.log(e)}}},fetch:{type:\"signal\",displayName:\"Fetch\",group:\"Actions\",valueChangedToTrue(){this.scheduleFetch()}},cancel:{type:\"signal\",displayName:\"Cancel\",group:\"Actions\",valueChangedToTrue(){this.cancelFetch()}}},outputs:{failure:{type:\"signal\",displayName:\"Failure\",group:\"Events\"},success:{type:\"signal\",displayName:\"Success\",group:\"Events\"},canceled:{type:\"signal\",displayName:\"Canceled\",group:\"Events\"}},prototypeExtensions:{getScriptOutputValue(e){return this._internal.outputValues[e]},setScriptInputValue(e,t){return this._internal.inputValues[e]=t},registerOutputIfNeeded(e){if(!this.hasOutput(e))return e.startsWith(\"out-\")?this.registerOutput(e,{getter:this.getScriptOutputValue.bind(this,e.substring(4))}):void 0},registerInputIfNeeded(e){if(!this.hasInput(e))return e.startsWith(\"in-\")?this.registerInput(e,{set:this.setScriptInputValue.bind(this,e.substring(3))}):void 0},scheduleFetch(){const e=this._internal;e.hasScheduledFetch||(e.hasScheduledFetch=!0,this.scheduleAfterInputsHaveUpdated(this.doFetch.bind(this)))},doResponse(e,t,n){this._internal.responseFunc&&this._internal.responseFunc.apply(this._internal.self,[this._internal.inputValues,this._internal.outputValuesProxy,{status:e,content:t,request:n}]),this._internal.inspectData={status:e,content:t},e>=200&&e<300?this.sendSignalOnOutput(\"success\"):this.sendSignalOnOutput(\"failure\")},doExternalFetch(e){let t=e.resource;if(Object.keys(e.parameters).length>0){const n=Object.keys(e.parameters).map((t=>t+\"=\"+encodeURIComponent(e.parameters[t])));t+=\"?\"+n.join(\"&\")}if(\"undefined\"==typeof _noodl_cloud_runtime_version){const n=new XMLHttpRequest;this._xhr=n,n.open(e.method,t,!0);for(const t in e.headers)n.setRequestHeader(t,e.headers[t]);n.onreadystatechange=()=>{let t=!1;if(4===n.readyState){const o=n.status,i=n.getResponseHeader(\"content-type\"),s=n.response;if(delete this._xhr,i){i=i.toLowerCase();const n=-1!==i.indexOf(\"json\")?JSON.parse(s):s;this.doResponse(o,n,e),t=!0}!1===t&&this.doResponse(o,s,e)}},n.onerror=()=>{delete this._xhr,this.sendSignalOnOutput(\"failure\")},n.onabort=()=>{delete this._xhr,this.sendSignalOnOutput(\"canceled\")},e.content?(n.setRequestHeader(\"Content-Type\",\"application/json\"),n.send(JSON.stringify(e.content))):n.send()}else{const n={...e.headers,...e.content?{\"Content-Type\":\"application/json\"}:{}};fetch(t,{method:e.method,headers:n,body:e.content?JSON.stringify(e.content):void 0}).then((t=>{const n=t.headers.get(\"content-type\");n?-1!==n.indexOf(\"/json\")?t.json().then((n=>{this.doResponse(t.status,n,e)})):this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"rest-run-waring-\",{message:\"REST only supports json content type in response.\"}):t.text().then((n=>{this.doResponse(t.status,n,e)}))})).catch((e=>{console.log(\"REST: Failed to request\",t),console.log(e),this.sendSignalOnOutput(\"failure\")}))}},doFetch(){this._internal.hasScheduledFetch=!1;let e=this._internal.resource;if(e)for(const t in this._internal.inputValues)e=e.replace(\"{\"+t+\"}\",this._internal.inputValues[t]);const t={resource:e,headers:{},method:void 0!==this._internal.method?this._internal.method:\"GET\",parameters:{}};this._internal.requestFunc&&this._internal.requestFunc.apply(this._internal.self,[this._internal.inputValues,this._internal.outputValuesProxy,t]),this.doExternalFetch(t)},cancelFetch(){\"undefined\"==typeof _noodl_cloud_runtime_version?this._xhr&&this._xhr.abort():this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"rest-run-waring-\",{message:\"REST doesn't support cancel in cloud functions.\"})}}};function parseScriptForErrors(e,t,n,o,i,s){if(!i.editorConnection)return;if(i.editorConnection.clearWarning(o.component.name,o.id,\"rest-run-waring-\"+n),void 0===e)return void i.editorConnection.clearWarning(o.component.name,o.id,\"rest-parse-waring-\"+n);try{new Function(...t,e),i.editorConnection.clearWarning(o.component.name,o.id,\"rest-parse-waring-\"+n)}catch(e){i.editorConnection.sendWarning(o.component.name,o.id,\"rest-parse-waring-\"+n,{message:\"<strong>\"+n+\"</strong>: \"+e.message,showGlobally:!0})}function r(e){return void 0!==s.find((t=>t.name===e))}const a=e.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g,\"\"),d=a.match(/Inputs\\.[A-Za-z0-9]+/g);if(d){const e={};d.forEach((t=>{e[t.substring(7)]=!0})),Object.keys(e).forEach((e=>{r(\"in-\"+e)||s.push({name:\"in-\"+e,displayName:e,plug:\"input\",type:\"*\",group:\"Inputs\"})}))}const l=a.match(/Outputs\\.[A-Za-z0-9]+/g);if(l){const e={};l.forEach((t=>{e[t.substring(8)]=!0})),Object.keys(e).forEach((e=>{r(\"out-\"+e)||s.push({name:\"out-\"+e,displayName:e,plug:\"output\",type:\"*\",group:\"Outputs\"})}))}}function setup$a(e,t){function n(t){function n(){if(!t.parameters)return;const n=[];function o(e){for(let t=0;t<n.length;t++)if(n[t].name===e&&\"input\"===n[t].plug)return!0;return!1}if(t.parameters.resource){const e=t.parameters.resource.match(/\\{[A-Za-z0-9_]*\\}/g);if(e)for(const t of e){const e=t.replace(\"{\",\"\").replace(\"}\",\"\");o(\"in-\"+e)||n.push({name:\"in-\"+e,displayName:e,type:\"string\",plug:\"input\",group:\"Inputs\"})}}t.parameters.requestScript&&parseScriptForErrors(t.parameters.requestScript,[\"Inputs\",\"Outputs\",\"Request\"],\"Request script\",t,e,n),t.parameters.responseScript&&parseScriptForErrors(t.parameters.responseScript,[\"Inputs\",\"Outputs\",\"Response\"],\"Response script\",t,e,n),e.editorConnection.sendDynamicPorts(t.id,n)}n(),t.on(\"parameterUpdated\",(()=>{n()}))}e.editorConnection&&t.on(\"editorImportComplete\",(()=>{t.on(\"nodeAdded.REST2\",(e=>{n(e)}));for(const e of t.getNodesWithType(\"REST2\"))n(e)}))}var restnode=Object.freeze({__proto__:null,node:node$v,setup:setup$a});const node$u={name:\"Expression\",docs:\"https://docs.noodl.net/nodes/math/expression\",usePortAsLabel:\"expression\",category:\"CustomCode\",color:\"javascript\",nodeDoubleClickAction:{focusPort:\"Expression\"},searchTags:[\"javascript\"],initialize(){const e=this._internal;e.scope={},e.hasScheduledEvaluation=!1,e.code=void 0,e.cachedValue=0,e.currentExpression=\"\",e.compiledFunction=void 0,e.inputNames=[],e.inputValues=[]},getInspectInfo(){return this._internal.cachedValue},inputs:{expression:{group:\"General\",inputPriority:1,type:{name:\"string\",allowEditOnly:!0,codeeditor:\"javascript\"},displayName:\"Expression\",set(e){const t=this._internal;t.currentExpression=functionPreamble+\"return (\"+e+\");\",t.compiledFunction=void 0;const n=parsePorts(e),o=difference$1(n,t.inputNames),i=difference$1(t.inputNames,n),s=this;i.forEach((function(e){s.deregisterInput(e),delete t.scope[e]})),o.forEach((function(e){s.hasInput(e)||(s.registerInput(e,{set(n){t.scope[e]=n,this.isInputConnected(\"run\")||this._scheduleEvaluateExpression()}}),t.scope[e]=0,s._inputValues[e]=0)})),t.inputNames=Object.keys(t.scope),this.isInputConnected(\"run\")||this._scheduleEvaluateExpression()}},run:{group:\"Actions\",displayName:\"Run\",type:\"signal\",valueChangedToTrue(){this._scheduleEvaluateExpression()}}},outputs:{result:{group:\"Result\",type:\"*\",displayName:\"Result\",getter(){return this._internal.currentExpression?this._internal.cachedValue:0}},isTrue:{group:\"Result\",type:\"boolean\",displayName:\"Is True\",getter(){return!!this._internal.currentExpression&&!!this._internal.cachedValue}},isFalse:{group:\"Result\",type:\"boolean\",displayName:\"Is False\",getter(){return!this._internal.currentExpression||!this._internal.cachedValue}},isTrueEv:{group:\"Events\",type:\"signal\",displayName:\"On True\"},isFalseEv:{group:\"Events\",type:\"signal\",displayName:\"On False\"}},prototypeExtensions:{registerInputIfNeeded(e){this.hasInput(e)||(this._internal.scope[e]=0,this._inputValues[e]=0,this.registerInput(e,{set(t){this._internal.scope[e]=t,this.isInputConnected(\"run\")||this._scheduleEvaluateExpression()}}))},_scheduleEvaluateExpression(){const e=this._internal;!1===e.hasScheduledEvaluation&&(e.hasScheduledEvaluation=!0,this.flagDirty(),this.scheduleAfterInputsHaveUpdated((function(){const t=e.cachedValue;e.cachedValue=this._calculateExpression(),t!==e.cachedValue&&(this.flagOutputDirty(\"result\"),this.flagOutputDirty(\"isTrue\"),this.flagOutputDirty(\"isFalse\")),e.cachedValue?this.sendSignalOnOutput(\"isTrueEv\"):this.sendSignalOnOutput(\"isFalseEv\"),e.hasScheduledEvaluation=!1})))},_calculateExpression(){const e=this._internal;e.compiledFunction||(e.compiledFunction=this._compileFunction());for(let t=0;t<e.inputNames.length;++t){const n=e.scope[e.inputNames[t]];e.inputValues[t]=n}try{if(!e.compiledFunction)throw new Error(\"Compiled function is undefined\");return e.compiledFunction.apply(null,e.inputValues)}catch(e){e instanceof Error&&console.error(\"Error in expression:\",e.message)}},_compileFunction(){const e=this._internal.currentExpression,t=Object.keys(this._internal.scope),n=e+t.join(\" \");if(!compiledFunctionsCache[n]){t.push(e);try{compiledFunctionsCache[n]=construct(Function,t)}catch(e){e instanceof Error&&console.error(\"Failed to compile JS function\",e.message)}}return compiledFunctionsCache[n]}}},functionPreamble=[\"var min = Math.min,    max = Math.max,    cos = Math.cos,    sin = Math.sin,    tan = Math.tan,    sqrt = Math.sqrt,    pi = Math.PI,    round = Math.round,    floor = Math.floor,    ceil = Math.ceil,    abs = Math.abs,    random = Math.random;\"].join(\"\");function construct(e,t){function n(){return e.apply(this,t)}return n.prototype=e.prototype,new n}const compiledFunctionsCache={},portsToIgnore=[\"min\",\"max\",\"cos\",\"sin\",\"tan\",\"sqrt\",\"pi\",\"round\",\"floor\",\"ceil\",\"abs\",\"random\",\"Math\",\"window\",\"document\",\"undefined\",\"Vars\",\"true\",\"false\",\"null\",\"Boolean\"];function parsePorts(e){const t=[];function n(e){-1===portsToIgnore.indexOf(e)&&(t.some((t=>t===e))||t.push(e))}const o=(e=e.replace(/\\\"([^\\\"]*)\\\"/g,\"\").replace(/\\'([^\\']*)\\'/g,\"\")).matchAll(/[a-zA-Z\\_\\$][a-zA-Z0-9\\.\\_\\$]*/g);for(const e of o){let t=e[0];-1!==t.indexOf(\".\")&&(t=t.split(\".\")[0]),n(t)}return t}function updatePorts$7(e,t,n){const o=parsePorts(t).map((e=>({group:\"Parameters\",name:e,type:{name:\"*\",editAsType:\"string\"},plug:\"input\"})));n.sendDynamicPorts(e,o)}function evalCompileWarnings(e,t){try{new Function(t.parameters.expression),e.clearWarning(t.component.name,t.id,\"expression-compile-error\")}catch(n){n instanceof Error&&e.sendWarning(t.component.name,t.id,\"expression-compile-error\",{message:n.message})}}function setup$9(e,t){e.editorConnection&&e.editorConnection.isRunningLocally()&&t.on(\"nodeAdded.Expression\",(t=>{t.parameters.expression&&(updatePorts$7(t.id,t.parameters.expression,e.editorConnection),evalCompileWarnings(e.editorConnection,t)),t.on(\"parameterUpdated\",(n=>{\"expression\"===n.name&&(updatePorts$7(t.id,t.parameters.expression,e.editorConnection),evalCompileWarnings(e.editorConnection,t))}))}))}var expression=Object.freeze({__proto__:null,node:node$u,setup:setup$9});const userFunctionsCache={};class JavascriptNodeParser{constructor(e,t){this.inputs={},this.outputs={},this.code=e;const n=t?t.node:void 0;this._initializeAPIs();let o=userFunctionsCache[e];if(!o)try{o=new Function([\"define\",\"script\",\"Node\",\"Component\"],JavascriptNodeParser.getCodePrefix()+e),userFunctionsCache[e]=o}catch(e){this.error=e instanceof Error?e.message:String(e),console.error(e)}if(o)try{o(this.define.bind(this),this.script.bind(this),this.apis.Node,n?JavascriptNodeParser.getComponentScopeForNode(n):{}),this._afterSourced()}catch(e){this.error=e instanceof Error?e.message:String(e),console.error(e)}}define(e){this.inputs=e.inputs||{},this.outputs=e.outputs||{},this.setup=e.setup,this.change=e.run||e.change,this.destroy=e.destroy,this.definedObject=e}script(e){const t=_scriptExtend(e);this.inputs=t.inputs||{},this.outputs=t.outputs||{},this.setup=t.setup,this.change=t.run||t.change,this.destroy=t.destroy,this.definedObject=t}_initializeAPIs(){this.apis={Node:{Inputs:{},Outputs:{},Signals:{},Setters:{}}}}_afterSourced(){if(void 0!==this.definedObject)return;const e=this.apis.Node;if(this.inputs=Object.assign({},e.Inputs||{}),this.outputs=Object.assign({},e.Outputs||{}),this.setup=function(t,n){const o=this;e.setOutputs=function(e){for(const t in e)n[t]=e[t],o.flagOutputDirty(t)},e.OnInit&&e.OnInit.apply(this)},this.destroy=e.OnDestroy||this.destroy,this.change=(t,n,o)=>{for(const n in o)\"function\"==typeof e.Setters[n]&&e.Setters[n](t[n]);\"function\"==typeof e.OnInputsChanged&&e.OnInputsChanged()},this.definedObject={inputs:this.inputs,outputs:this.outputs,setup:this.setup,destroy:this.destroy,change:this.change},void 0!==e.Signals)for(const t in e.Signals)\"function\"==typeof e.Signals[t]&&(this.inputs[t]=\"signal\",this.definedObject[t]=e.Signals[t])}getPorts(){const e=[];return Object.keys(this.inputs).forEach((t=>{const n=this.inputs[t],o={name:t,plug:\"input\",type:void 0,group:\"Inputs\"};\"string\"==typeof n?o.type={name:n}:Object.assign(o,n),e.push(o)})),Object.keys(this.outputs).forEach((t=>{e.push({name:t,type:{name:this.outputs[t]},plug:\"output\",group:\"Outputs\"})})),JavascriptNodeParser.parseAndAddPortsFromScript(this.code,e,{}),e}static createFromCode(e,t){return new JavascriptNodeParser(e,t)}static createFromURL(e,t,n){e=getAbsoluteUrl(e);const o=new XMLHttpRequest;o.open(\"GET\",e,!0),o.onreadystatechange=function(){4!==this.readyState&&this.readyState!==XMLHttpRequest.DONE||t(new JavascriptNodeParser(this.response))},o.onerror=function(){console.log(\"Failed to request\",e)},o.send()}static parseAndAddPortsFromScript(e,t,n){function o(e,n){if(null==e)return;const o={};for(const t of e){let e=t[1];void 0!==e&&(o[e]=!0)}Object.keys(o).forEach((e=>{var o;(\"string\"==typeof(o={name:n.prefix+e,plug:n.plug})?void 0===t.find((e=>e.name===o)):void 0===t.find((e=>e.name===o.name&&e.plug===o.plug)))&&t.push({name:n.prefix+e,displayName:e,plug:n.plug,type:n.type,group:n.group})}))}n.skipInputs||(o(e.matchAll(/Inputs\\.([A-Za-z0-9_]+)/g),{type:n.inputType||\"*\",plug:\"input\",group:n.inputGroup||\"Inputs\",prefix:n.inputPrefix||\"\"}),o(e.matchAll(/Inputs\\s*\\[\\s*(?:'|\")(.*)(?:'|\")\\s*\\]/g),{type:n.inputType||\"*\",plug:\"input\",group:n.inputGroup||\"Inputs\",prefix:n.inputPrefix||\"\"})),n.skipOutputs||(n.skipOutputSignals||(o(e.matchAll(/Outputs\\.([A-Za-z0-9]+)\\s*\\(\\s*\\)/g),{type:\"signal\",plug:\"output\",group:\"Outputs\",prefix:n.outputPrefix||\"\"}),o(e.matchAll(/Outputs\\s*\\[\\s*(?:'|\")(.*)(?:'|\")\\s*\\]\\(\\s*\\)/g),{type:\"signal\",plug:\"output\",group:\"Outputs\",prefix:n.outputPrefix||\"\"})),n.skipRegularOutputs||(o(e.matchAll(/Outputs\\.([A-Za-z0-9_]+)/g),{type:\"*\",plug:\"output\",group:\"Outputs\",prefix:n.outputPrefix||\"\"}),o(e.matchAll(/Outputs\\s*\\[\\s*\\\"([^\\\"]*)\\\"\\s*\\]/g),{type:\"*\",plug:\"output\",group:\"Outputs\",prefix:n.outputPrefix||\"\"})))}static getCodePrefix(){return\"const Script = (typeof Node !== 'undefined')?Node:undefined;\\n\"}static createNoodlAPI(){return\"undefined\"!=typeof window&&void 0!==window.Noodl?window.Noodl:{}}static getComponentScopeForNode(e){const t=e.nodeScope.componentOwner.getInstanceId();if(void 0===_componentScopes[t]){_componentScopes[t]={};const n=(e.nodeScope.modelScope||Model).get(\"componentState\"+t);_componentScopes[t].Object=n}const n=_findParentComponentStateModelId(e),o=void 0!==n?(e.nodeScope.modelScope||Model).get(n):void 0;return _componentScopes[t].ParentObject=o,_componentScopes[t].RepeaterObject=_findForEachModel(e),_componentScopes[t]}}function _scriptExtend(e){const t={inputs:e.inputs||{},outputs:e.outputs||{},setup:function(t,n){if(this.inputs=t,this.outputs=n,this.setOutputs=function(e){for(const t in e)this.outputs[t]=e[t],this.flagOutputDirty(t)},e.methods)for(const t in e.methods)this[t]=e.methods[t];e.setup&&e.setup.apply(this)},destroy:function(t,n){this.inputs=t,this.outputs=n,e.destroy&&e.destroy.apply(this)},change:function(t,n){this.inputs=t,this.outputs=n;const o=this._oldInputs||{};if(e.changed)for(const n in t)if(t[n]!==o[n]){const i=e.changed[n];\"function\"==typeof i&&i.apply(this,[t[n],o[n]])}this._oldInputs=Object.assign({},t)}};if(e.signals)for(const n in e.signals)t[n]=e.signals[n],t.inputs[n]=\"signal\";return t}const _componentScopes={};function _findParentComponentStateModelId(e){const t=function e(t){let n;if(t.getRoots().length>0){const e=t.getRoots()[0];e.getVisualParentNode?e.getVisualParentNode()&&(n=e.getVisualParentNode().nodeScope.componentOwner):e.parentNodeScope&&(n=t.parentNodeScope.componentOwner)}else t.parentNodeScope&&(n=t.parentNodeScope.componentOwner);if(n&&n.nodeScope&&n.nodeScope.componentOwner!==t)return n.nodeScope.getNodesWithType(\"net.noodl.ComponentObject\").length>0||n.nodeScope.getNodesWithType(\"Component State\").length>0?n:e(n)}(e.nodeScope.componentOwner);if(t)return\"componentState\"+t.getInstanceId()}function _findForEachModel(e){let t=e.nodeScope.componentOwner;for(;void 0!==t&&void 0===t._forEachModel&&t.parentNodeScope;)t=t.parentNodeScope.componentOwner;return void 0!==t?t._forEachModel:void 0}const node$t={name:\"JavaScriptFunction\",displayNodeName:\"Function\",docs:\"https://docs.noodl.net/nodes/javascript/function\",category:\"CustomCode\",color:\"javascript\",nodeDoubleClickAction:{focusPort:\"Script\"},searchTags:[\"javascript\"],exportDynamicPorts:!0,initialize:function(){this._internal={},this._internal.inputValues={},this._internal.outputValues={},this._internal.inputTypes={},this._internal.outputTypes={},this._internal.outputValuesProxy=new Proxy(this._internal.outputValues,{set:(e,t,n)=>(this._deleted||n!==this._internal.outputValues[t]&&(this.registerOutputIfNeeded(\"out-\"+t),this._internal.outputValues[t]=n,this.flagOutputDirty(\"out-\"+t)),!0)}),this._internal._this={}},getInspectInfo(){return[{type:\"value\",value:{inputs:this._internal.inputValues,outputs:this._internal.outputValues}}]},inputs:{scriptInputs:{type:{name:\"proplist\",allowEditOnly:!0},group:\"Script Inputs\",set(e){}},scriptOutputs:{type:{name:\"proplist\",allowEditOnly:!0},group:\"Script Outputs\",set(e){}},functionScript:{displayName:\"Script\",plug:\"input\",type:{name:\"string\",allowEditOnly:!0,codeeditor:\"javascript\"},group:\"General\",set(e){void 0!==e?(this._internal.func=this.parseScript(e),this.isInputConnected(\"run\")||this.scheduleRun()):this._internal.func=void 0}},run:{type:\"signal\",displayName:\"Run\",group:\"Actions\",valueChangedToTrue:function(){this.scheduleRun()}}},outputs:{},methods:{scheduleRun(){this.runScheduled||(this.runScheduled=!0,this.scheduleAfterInputsHaveUpdated((()=>{this.runScheduled=!1,this._deleted||this.runScript()})))},async runScript(){const e=this._internal.func;if(void 0===e)return;const t=this._internal.inputValues,n=this._internal.outputValuesProxy;for(const e in this.model.outputPorts)if(this._isSignalType(e)){const t=()=>{this.hasOutput(e)&&this.sendSignalOnOutput(e)};this._internal.outputValues[e.substring(4)]=t,this._internal.outputValues[e.substring(4)].send=t}try{await e.apply(this._internal._this,[t,n,JavascriptNodeParser.createNoodlAPI(this.nodeScope.modelScope),JavascriptNodeParser.getComponentScopeForNode(this)])}catch(e){logJavaScriptNodeError(e),this.context.editorConnection&&this.context.isWarningTypeEnabled(\"javascriptExecution\")&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"js-function-run-waring\",{showGlobally:!0,message:e.message,stack:e.stack})}},setScriptInputValue(e,t){this._internal.inputValues[e]=t,this.isInputConnected(\"run\")||this.scheduleRun()},getScriptOutputValue(e){if(!this._isSignalType(e))return this._internal.outputValues[e]},setScriptInputType(e,t){this._internal.inputTypes[e]=t},setScriptOutputType(e,t){this._internal.outputTypes[e]=t},parseScript(e){let t;try{t=new(0,Object.getPrototypeOf((async function(){})).constructor)(\"Inputs\",\"Outputs\",\"Noodl\",\"Component\",JavascriptNodeParser.getCodePrefix()+e)}catch(e){console.log(\"Error while parsing action script: \"+e)}return t},_isSignalType(e){return this.model.outputPorts[e]&&\"signal\"===this.model.outputPorts[e].type},registerInputIfNeeded(e){if(!this.hasInput(e)){if(e.startsWith(\"in-\")){const t=e.substring(3),n={set:this.setScriptInputValue.bind(this,t)};this.model&&this.model.parameters[\"intype-\"+t]&&(n.type=this.model.parameters[\"intype-\"+t]),this.registerInput(e,n)}if(e.startsWith(\"intype-\")){const t=e.substring(7);this.registerInput(e,{set(e){this.hasInput(\"in\"+t)&&(this.getInput(\"in\"+t).type=e)}})}e.startsWith(\"outtype-\")&&this.registerInput(e,{set(){}})}},registerOutputIfNeeded(e){if(!this.hasOutput(e))return e.startsWith(\"out-\")?this.registerOutput(e,{getter:this.getScriptOutputValue.bind(this,e.substring(4))}):void 0}}};function _parseScriptForErrorsAndPorts(e,t,n,o,i){if(o.editorConnection.clearWarning(n.component.name,n.id,\"js-function-run-waring\"),void 0!==e){try{new(0,Object.getPrototypeOf((async function(){})).constructor)(\"Inputs\",\"Outputs\",\"Noodl\",\"Component\",e),o.editorConnection.clearWarning(n.component.name,n.id,\"js-function-parse-waring\")}catch(e){o.editorConnection.sendWarning(n.component.name,n.id,\"js-function-parse-waring\",{showGlobally:!0,message:e.message})}JavascriptNodeParser.parseAndAddPortsFromScript(e,i,{inputPrefix:\"in-\",outputPrefix:\"out-\"})}else o.editorConnection.clearWarning(n.component.name,n.id,\"js-function-parse-waring\")}const inputTypeEnums=[{value:\"string\",label:\"String\"},{value:\"boolean\",label:\"Boolean\"},{value:\"number\",label:\"Number\"},{value:\"object\",label:\"Object\"},{value:\"date\",label:\"Date\"},{value:\"array\",label:\"Array\"},{value:\"color\",label:\"Color\"}];function setup$8(e,t){function n(t){function n(){var n;const o=[],i=inputTypeEnums.concat([{value:\"signal\",label:\"Signal\"}]);void 0!==t.parameters.scriptOutputs&&t.parameters.scriptOutputs.length>0&&t.parameters.scriptOutputs.forEach((e=>{o.push({name:\"outtype-\"+e.label,displayName:\"Type\",editorName:e.label+\" | Type\",plug:\"input\",type:{name:\"enum\",enums:i,allowEditOnly:!0},default:\"string\",parent:\"scriptOutputs\",parentItemId:e.id}),o.push({name:\"out-\"+e.label,displayName:e.label,plug:\"output\",type:t.parameters[\"outtype-\"+e.label]||\"*\",group:\"Outputs\"})})),void 0!==t.parameters.scriptInputs&&t.parameters.scriptInputs.length>0&&t.parameters.scriptInputs.forEach((e=>{o.push({name:\"intype-\"+e.label,displayName:\"Type\",editorName:e.label+\" | Type\",plug:\"input\",type:{name:\"enum\",enums:inputTypeEnums,allowEditOnly:!0},default:\"string\",parent:\"scriptInputs\",parentItemId:e.id}),o.push({name:\"in-\"+e.label,displayName:e.label,plug:\"input\",type:t.parameters[\"intype-\"+e.label]||\"string\",group:\"Inputs\"})})),_parseScriptForErrorsAndPorts(t.parameters.functionScript,\"Script \",t,e,o),o.forEach((e=>{\"signal\"===e.type&&\"output\"===e.plug&&(t.outputPorts[e.name]=e)})),null===(n=e.editorConnection)||void 0===n||n.sendDynamicPorts(t.id,o)}n(),t.on(\"parameterUpdated\",(function(){n()}))}e.editorConnection&&e.editorConnection.isRunningLocally()&&t.on(\"editorImportComplete\",(()=>{t.on(\"nodeAdded.JavaScriptFunction\",(function(e){n(e)}));for(const e of t.getNodesWithType(\"JavaScriptFunction\"))n(e)}))}var simplejavascript=Object.freeze({__proto__:null,node:node$t,setup:setup$8});Object.prototype.hasOwnProperty.call(Array.prototype,\"items\")||Object.defineProperty(Array.prototype,\"items\",{enumerable:!1,get(){return this},set(e){this.set(e)}}),Object.defineProperty(Array.prototype,\"each\",{enumerable:!1,writable:!1,value:Array.prototype.forEach}),Object.prototype.hasOwnProperty.call(Array.prototype,\"size\")||Object.defineProperty(Array.prototype,\"size\",{enumerable:!1,writable:!1,value:function(){return this.length}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"get\")||Object.defineProperty(Array.prototype,\"get\",{enumerable:!1,writable:!1,value:function(e){return this[e]}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"getId\")||Object.defineProperty(Array.prototype,\"getId\",{enumerable:!1,writable:!1,value:function(){return this._id}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"id\")||Object.defineProperty(Array.prototype,\"id\",{enumerable:!1,get(){return this.getId()}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"set\")||Object.defineProperty(Array.prototype,\"set\",{enumerable:!1,writable:!1,value:function(e){let t,n;if(e===this)return;function o(e){const t={},n=e.length;for(let o=0;o<n;o++){const n=e[o];t[n.getId()]=n}return t}const i=[];for(t=(e=e||[]).length,n=0;n<t;n++){const t=e[n];Model.instanceOf(t)?i.push(t):i.push(Model.create(t))}const s=this.items,r=o(s),a=o(i);for(t=s.length,n=0;n<t;n++)a.hasOwnProperty(s[n].getId())||(this.removeAtIndex(n),n--,t--);for(n=0;n<Math.min(s.length,i.length);n++)s[n]!==i[n]&&(r.hasOwnProperty(i[n].getId())&&this.remove(i[n]),this.addAtIndex(i[n],n));for(n=s.length;n<i.length;n++)this.add(i[n])}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"notify\")||Object.defineProperty(Array.prototype,\"notify\",{enumerable:!1,writable:!1,value:async function(e,t){if(!this._listeners)return;if(!this._listeners[e])return;const n=this._listeners[e].slice();for(let e=0;e<n.length;e++)await n[e](t)}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"contains\")||Object.defineProperty(Array.prototype,\"contains\",{enumerable:!1,writable:!1,value:function(e){return-1!==this.indexOf(e)}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"add\")||Object.defineProperty(Array.prototype,\"add\",{enumerable:!1,writable:!1,value:async function(e){this.contains(e)||(this.items.push(e),await this.notify(\"add\",{item:e,index:this.items.length-1}),await this.notify(\"change\"),e.notify(\"add\",{collection:this}))}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"remove\")||Object.defineProperty(Array.prototype,\"remove\",{enumerable:!1,writable:!1,value:function(e){const t=this.items.indexOf(e);-1!==t&&this.removeAtIndex(t)}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"addAtIndex\")||Object.defineProperty(Array.prototype,\"addAtIndex\",{enumerable:!1,writable:!1,value:async function(e,t){this.contains(e)||(this.items.splice(t,0,e),await this.notify(\"add\",{item:e,index:t}),await this.notify(\"change\"),e.notify(\"add\",{collection:this,index:t}))}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"removeAtIndex\")||Object.defineProperty(Array.prototype,\"removeAtIndex\",{enumerable:!1,writable:!1,value:async function(e){const t=this.items[e];this.items.splice(e,1),await this.notify(\"remove\",{item:t,index:e}),await this.notify(\"change\"),await t.notify(\"remove\",{collection:this})}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"on\")||Object.defineProperty(Array.prototype,\"on\",{enumerable:!1,writable:!1,value:function(e,t){this._listeners||Object.defineProperty(this,\"_listeners\",{enumerable:!1,writable:!1,value:{}}),this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}}),Object.prototype.hasOwnProperty.call(Array.prototype,\"off\")||Object.defineProperty(Array.prototype,\"off\",{enumerable:!1,writable:!1,value:function(e,t){if(!this._listeners)return;if(!this._listeners[e])return;const n=this._listeners[e].indexOf(t);-1!==n&&this._listeners[e].splice(n,1)}});class Collection extends Array{static create(e){const t=Model.guid();return Collection._collections[t]=new Collection,Object.defineProperty(Collection._collections[t],\"_id\",{enumerable:!1,writable:!1,value:t}),e&&Collection._collections[t].set(e),Collection._collections[t]}static get(e){return void 0===e&&(e=Model.guid()),Collection._collections[e]||(Collection._collections[e]=new Collection,Object.defineProperty(Collection._collections[e],\"_id\",{enumerable:!1,writable:!1,value:e})),Collection._collections[e]}static instanceOf(e){return e instanceof Collection}static exists(e){return void 0!==Collection._collections[e]}}Collection._collections={};class CloudFile{constructor({name:e,url:t}){this.name=e,this.url=t}getUrl(){return this.url}getName(){return this.name}toString(){return this.url}}const _protectedFields={_common:[\"_createdAt\",\"_updatedAt\",\"objectId\"],_User:[\"_email_verify_token\"]};function _removeProtectedFields(e,t){const n=Object.assign({},e);return _protectedFields._common.forEach((e=>delete n[e])),t&&_protectedFields[t]&&_protectedFields[t].forEach((e=>delete n[e])),n}class CloudStore{static get instance(){return void 0===CloudStore._instance&&(CloudStore._instance=new CloudStore),CloudStore._instance}static get collections(){if(void 0===CloudStore._collections){CloudStore._collections={};(NoodlRuntime$1.instance.getMetaData(\"dbCollections\")||[]).forEach((e=>{CloudStore._collections&&(CloudStore._collections[e.name]=e)}));(NoodlRuntime$1.instance.getMetaData(\"systemCollections\")||[]).forEach((e=>{CloudStore._collections&&(CloudStore._collections[e.name]=e)}))}return CloudStore._collections}constructor(e){this._initCloudServices(),this.events=new EventEmitter,this.modelScope=e||Model}_fromJSON(e,t){return CloudStore._fromJSON(e,t,this.modelScope)}_deserializeJSON(e,t){return CloudStore._deserializeJSON(e,t,this.modelScope)}_serializeObject(e,t){return CloudStore._serializeObject(e,t,this.modelScope)}_initCloudServices(){CloudStore._collections=void 0;const e=NoodlRuntime$1.instance.getMetaData(\"cloudservices\");e&&(this.appId=e.appId,this.endpoint=e.endpoint);const t=NoodlRuntime$1.instance.getMetaData(\"dbVersionMajor\");this.dbVersionMajor=t}on(e,t,n){this.events.on.apply(this.events,[e,t,n])}off(e,t,n,o){this.events.off.apply(this.events,[e,t,n,o])}_makeRequest(e,t){if(!this.appId)throw new Error(\"App ID is not set\");if(\"undefined\"==typeof _noodl_cloud_runtime_version){const n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){let e;try{e=JSON.parse(n.response||n.responseText)}catch(e){}200===n.status||201===n.status?t.success(e):t.error(e||{error:n.responseText,status:n.status})}},n.open(t.method||\"GET\",this.endpoint+e,!0),n.setRequestHeader(\"X-Parse-Application-Id\",this.appId),\"undefined\"!=typeof _noodl_cloudservices&&n.setRequestHeader(\"X-Parse-Master-Key\",_noodl_cloudservices.masterKey);const o=localStorage[\"Parse/\"+this.appId+\"/currentUser\"];if(void 0!==o)try{const e=JSON.parse(o);n.setRequestHeader(\"X-Parse-Session-Token\",e.sessionToken)}catch(e){}t.onUploadProgress&&(n.upload.onprogress=e=>{t.onUploadProgress&&t.onUploadProgress(e)}),t.content instanceof File?n.send(t.content):(n.setRequestHeader(\"Content-Type\",\"application/json\"),n.send(JSON.stringify(t.content)))}else{const n=\"undefined\"!=typeof _noodl_cloudservices?_noodl_cloudservices.endpoint:this.endpoint,o=\"undefined\"!=typeof _noodl_cloudservices?_noodl_cloudservices.appId:this.appId,i=\"undefined\"!=typeof _noodl_cloudservices?_noodl_cloudservices.masterKey:void 0;fetch(n+e,{method:t.method||\"GET\",headers:{\"X-Parse-Application-Id\":o,\"X-Parse-Master-Key\":i,\"Content-Type\":\"application/json\"},body:JSON.stringify(t.content)}).then((e=>{200===e.status||201===e.status?\"DELETE\"===t.method?t.success(void 0):e.json().then((e=>t.success(e))).catch((e=>t.error({error:\"CloudStore: Failed to get json result.\"}))):\"DELETE\"===t.method?t.error({error:\"Failed to delete.\"}):e.json().then((e=>t.error(e))).catch((e=>t.error({error:\"Failed to fetch.\"})))})).catch((e=>{t.error({error:e.message})}))}}query(e){this._makeRequest(\"/classes/\"+e.collection,{method:\"POST\",content:{_method:\"GET\",where:e.where,limit:e.limit,skip:e.skip,include:Array.isArray(e.include)?e.include.join(\",\"):e.include,keys:Array.isArray(e.select)?e.select.join(\",\"):e.select,order:Array.isArray(e.sort)?e.sort.join(\",\"):e.sort,count:e.count},success:function(t){e.success(t.results,t.count)},error:function(){e.error()}})}aggregate(e){const t=[];if(!e.group)return void e.error(\"You need to provide group option.\");e.limit&&t.push(\"limit=\"+e.limit),e.skip&&t.push(\"skip=\"+e.skip);const n={};Object.keys(e.group).forEach((t=>{const o={},i=e.group[t];void 0!==i.avg?o.$avg=\"$\"+i.avg:void 0!==i.sum?o.$sum=\"$\"+i.sum:void 0!==i.max?o.$max=\"$\"+i.max:void 0!==i.min?o.$min=\"$\"+i.min:void 0!==i.distinct&&(o.$addToSet=\"$\"+i.distinct),n[t]=o})),this.dbVersionMajor&&this.dbVersionMajor>4?(n._id=null,e.where&&t.push(\"$match=\"+encodeURIComponent(JSON.stringify(e.where))),t.push(\"$group=\"+JSON.stringify(n))):(n.objectId=null,e.where&&t.push(\"match=\"+encodeURIComponent(JSON.stringify(e.where))),t.push(\"group=\"+JSON.stringify(n))),this._makeRequest(\"/aggregate/\"+e.collection+(t.length>0?\"?\"+t.join(\"&\"):\"\"),{success:function(t){const n={};t.results&&1===t.results.length?(Object.keys(e.group).forEach((e=>{n[e]=t.results[0][e]})),e.success(n)):e.success({})},error:function(){e.error()}})}count(e){const t=[];e.where&&t.push(\"where=\"+encodeURIComponent(JSON.stringify(e.where))),t.push(\"limit=0\"),t.push(\"count=1\"),this._makeRequest(\"/classes/\"+e.collection+(t.length>0?\"?\"+t.join(\"&\"):\"\"),{success:function(t){e.success(t.count)},error:function(){e.error()}})}distinct(e){const t=[];e.where&&t.push(\"where=\"+encodeURIComponent(JSON.stringify(e.where))),t.push(\"distinct=\"+e.property),this._makeRequest(\"/aggregate/\"+e.collection+(t.length>0?\"?\"+t.join(\"&\"):\"\"),{success:function(t){e.success(t.results)},error:function(){e.error()}})}fetch(e){const t=[];e.include&&t.push(\"include=\"+(Array.isArray(e.include)?e.include.join(\",\"):e.include)),e.keys&&t.push(\"keys=\"+(Array.isArray(e.keys)?e.keys.join(\",\"):e.keys)),e.excludeKeys&&t.push(\"excludeKeys=\"+(Array.isArray(e.excludeKeys)?e.excludeKeys.join(\",\"):e.excludeKeys)),this._makeRequest(\"/classes/\"+e.collection+\"/\"+e.objectId+(t.length>0?\"?\"+t.join(\"&\"):\"\"),{method:\"GET\",success:t=>{e.success(t),this.events.emit(\"fetch\",{type:\"fetch\",objectId:e.objectId,object:t,collection:e.collection})},error:function(t){e.error(t.error)}})}create(e){this._makeRequest(\"/classes/\"+e.collection,{method:\"POST\",content:Object.assign(_removeProtectedFields(CloudStore._serializeObject(e.data,e.collection),e.collection),{ACL:e.acl}),success:t=>{const n=Object.assign({},e.data,t);e.success(n),this.events.emit(\"create\",{type:\"create\",objectId:e.objectId,object:n,collection:e.collection})},error:function(t){e.error(t.error)}})}increment(e){const t={};for(let n in e.properties)t[n]={__op:\"Increment\",amount:e.properties[n]};this._makeRequest(\"/classes/\"+e.collection+\"/\"+e.objectId,{method:\"PUT\",content:t,success:t=>{e.success(t)},error:function(t){e.error(t.error)}})}save(e){const t=Object.assign({},e.data);delete t.createdAt,delete t.updatedAt,this._makeRequest(\"/classes/\"+e.collection+\"/\"+e.objectId,{method:\"PUT\",content:Object.assign(_removeProtectedFields(CloudStore._serializeObject(t,e.collection),e.collection),{ACL:e.acl}),success:t=>{e.success(t),this.events.emit(\"save\",{type:\"save\",objectId:e.objectId,object:Object.assign({},e.data,t),collection:e.collection})},error:function(t){e.error(t.error)}})}delete(e){this._makeRequest(\"/classes/\"+e.collection+\"/\"+e.objectId,{method:\"DELETE\",success:()=>{e.success(),this.events.emit(\"delete\",{type:\"delete\",objectId:e.objectId,collection:e.collection})},error:function(t){e.error(t.error)}})}addRelation(e){if(!e.key)throw new Error(\"Key is required\");const t={};t[e.key]={__op:\"AddRelation\",objects:[{__type:\"Pointer\",objectId:e.targetObjectId,className:e.targetClass}]},this._makeRequest(\"/classes/\"+e.collection+\"/\"+e.objectId,{method:\"PUT\",content:t,success:function(t){e.success(t)},error:function(t){e.error(t.error)}})}removeRelation(e){if(!e.key)throw new Error(\"Key is required\");const t={};t[e.key]={__op:\"RemoveRelation\",objects:[{__type:\"Pointer\",objectId:e.targetObjectId,className:e.targetClass}]},this._makeRequest(\"/classes/\"+e.collection+\"/\"+e.objectId,{method:\"PUT\",content:t,success:function(t){e.success(t)},error:function(t){e.error(t.error)}})}uploadFile(e){if(!e.file)throw new Error(\"File is required\");this._makeRequest(\"/files/\"+e.file.name,{method:\"POST\",content:e.file,contentType:e.file.type,success:t=>e.success(Object.assign({},e.data,t)),error:t=>e.error(t),onUploadProgress:e.onUploadProgress})}deleteFile(e){if(!e.file)throw new Error(\"File is required\");this._makeRequest(\"/files/\"+e.file.name,{method:\"DELETE\",success:t=>e.success(Object.assign({},e.data,t)),error:t=>e.error(t)})}static forScope(e){return void 0===e?CloudStore.instance:(e._cloudStore||(e._cloudStore=new CloudStore(e)),e._cloudStore)}static invalidateCollections(){_collections=void 0}static _fromJSON(e,t,n){const o=(n||Model).get(e.objectId);let i;o._class=t,void 0!==t&&void 0!==CloudStore._collections[t]&&(i=CloudStore._collections[t].schema);for(const t in e){if(\"objectId\"===t||\"ACL\"===t)continue;const s=i&&i.properties&&i.properties[t]?i.properties[t].type:void 0;o.set(t,CloudStore._deserializeJSON(e[t],s,n))}return o}static _serializeObject(e,t,n){let o;CloudStore._collections[t]&&(o=CloudStore._collections[t].schema);for(const t in e){const i=o&&o.properties&&o.properties[t]?o.properties[t].type:void 0;if(void 0===e[t]||null===e[t]);else if(\"Pointer\"===i&&\"string\"==typeof e[t])e[t]={__type:\"Pointer\",className:o.properties[t].targetClass,objectId:e[t]};else if(\"Pointer\"===i&&\"object\"==typeof e[t]&&(n||Model).instanceOf(e[t]))e[t]={__type:\"Pointer\",className:o.properties[t].targetClass,objectId:e[t].getId()};else if(\"Date\"===i&&(\"string\"==typeof e[t]||e[t]instanceof Date))e[t]={__type:\"Date\",iso:e[t]instanceof Date?e[t].toISOString():e[t]};else if(\"File\"===i&&e[t]instanceof CloudFile){const n=e[t];e[t]={__type:\"File\",url:n.getUrl(),name:n.getName()}}else\"Array\"===i&&\"string\"==typeof e[t]&&Collection.exists(e[t])?e[t]=_toJSON(Collection.get(e[t])):\"Object\"===i&&\"string\"==typeof e[t]&&(n||Model).exists(e[t])?e[t]=_toJSON((n||Model).get(e[t])):\"GeoPoint\"===i&&\"object\"==typeof e[t]?e[t]={__type:\"GeoPoint\",latitude:Number(e[t].latitude),longitude:Number(e[t].longitude)}:e[t]=_toJSON(e[t])}return e}static _deserializeJSON(e,t,n){if(void 0!==e){if(null===e)return null;if(\"Relation\"!==t||\"Relation\"!==e.__type){if(\"Pointer\"===t&&\"Pointer\"===e.__type)return e.objectId;if(\"Date\"===t&&\"Date\"===e.__type)return new Date(e.iso);if(\"Date\"===t&&\"string\"==typeof e)return new Date(e);if(\"File\"===t&&\"File\"===e.__type)return new CloudFile(e);if(\"GeoPoint\"===t&&\"GeoPoint\"===e.__type)return{latitude:e.latitude,longitude:e.longitude};if(_isArrayOfObjects(e)){const t=[];for(let o=0;o<e.length;o++)t.push(CloudStore._deserializeJSON(e[o],void 0,n));const o=Collection.get();return o.set(t),o}if(Array.isArray(e))return e;if(e&&\"Object\"===e.__type&&void 0!==e.className&&void 0!==e.objectId){const t=Object.assign({},e);return delete t.className,delete t.__type,CloudStore._fromJSON(t,e.className,n)}if(\"object\"==typeof e&&null!==e){const t=(n||Model).get();for(const o in e)t.set(o,CloudStore._deserializeJSON(e[o],void 0,n));return t}return e}}}}function _isArrayOfObjects(e){if(!Array.isArray(e))return!1;for(let t=0;t<e.length;t++)if(\"object\"!=typeof e[t]||null===e[t])return!1;return!0}function _toJSON(e){if(e instanceof Model){const t={};for(const n in e.data)t[n]=_toJSON(e.data[n]);return t}if(e instanceof Collection){const t=[];return e.items.forEach((e=>{t.push(_toJSON(e))})),t}return e}function convertVisualFilter(e,t){const n=t.queryParameters;if(void 0!==e.combinator&&void 0!==e.rules){if(0===e.rules.length)return;if(1===e.rules.length)return convertVisualFilter(e.rules[0],t);{const n={},o=\"$\"+e.combinator;return n[o]=[],e.rules.forEach((e=>{const i=convertVisualFilter(e,t);void 0!==i&&n[o].push(i)})),n}}if(\"related to\"===e.operator){const t=void 0!==e.input?n[e.input]:void 0;if(void 0===t)return;return{$relatedTo:{object:{__type:\"Pointer\",objectId:t,className:e.relatedTo},key:e.relationProperty}}}{const o={};let i,s,r=void 0!==e.input?n[e.input]:e.value;if(\"exist\"===e.operator)return o[e.property]={$exists:!0},o;if(\"not exist\"===e.operator)return o[e.property]={$exists:!1},o;if(void 0===r)return;CloudStore._collections[t.collectionName]&&(s=CloudStore._collections[t.collectionName].schema);if(\"Date\"===(s&&s.properties&&s.properties[e.property]?s.properties[e.property].type:void 0)&&(r instanceof Date||(r=new Date(r.toString())),r={__type:\"Date\",iso:r.toISOString()}),\"greater than\"===e.operator)i={$gt:r};else if(\"greater than or equal to\"===e.operator)i={$gte:r};else if(\"less than\"===e.operator)i={$lt:r};else if(\"less than or equal to\"===e.operator)i={$lte:r};else if(\"equal to\"===e.operator)i={$eq:r};else if(\"not equal to\"===e.operator)i={$ne:r};else if(\"points to\"===e.operator){i={$eq:{__type:\"Pointer\",objectId:r,className:s&&s.properties&&s.properties[e.property]?s.properties[e.property].targetClass:void 0}}}else\"contain\"===e.operator&&(i={$regex:r,$options:\"i\"});return o[e.property]=i,o}}function matchesQuery(e,t){let n=!0;if(void 0===t)return!0;if(void 0!==t.$and)t.$and.forEach((t=>{n=n&&matchesQuery(e,t)}));else if(void 0!==t.$or)n=!1,t.$or.forEach((t=>{n=n||matchesQuery(e,t)}));else{Object.keys(t).forEach((o=>{if(\"objectId\"===o)void 0!==t[o].$eq?n=n&&e.getId()===t[o].$eq:void 0!==t[o].$in&&(n=n&&-1!==t[o].$in.indexOf(e.getId()));else if(\"$relatedTo\"===o)n=!1;else{const i=e.get(o);void 0!==t[o].$eq&&\"Pointer\"===t[o].$eq.__type?n=n&&i===t[o].$eq.objectId:void 0!==t[o].$eq?n=n&&i==t[o].$eq:void 0!==t[o].$ne?n=n&&i!=t[o].$ne:void 0!==t[o].$lt?n=n&&i<t[o].$lt:void 0!==t[o].$lte?n=n&&i<=t[o].$lt:void 0!==t[o].$gt?n=n&&i>t[o].$gt:void 0!==t[o].$gte?n=n&&i>=t[o].$gte:void 0!==t[o].$exists?n=n&&void 0!==i:void 0!==t[o].$in?n=n&&-1!==t[o].$in.indexOf(i):void 0!==t[o].$nin?n=n&&-1===t[o].$in.indexOf(i):void 0!==t[o].$regex&&(n=n&&new RegExp(t[o].$regex,t[o].$options).test(i))}}))}return n}function compareObjects(e,t,n){for(let o=0;o<e.length;o++){let i=e[o];if(\"-\"===i[0]){let e=i.substring(1);if(t.get(e)>n.get(e))return-1;if(t.get(e)<n.get(e))return 1}else{if(t.get(i)>n.get(i))return 1;if(t.get(i)<n.get(i))return-1}}return 0}function convertVisualSorting(e){return e.map((e=>(\"descending\"===e.order?\"-\":\"\")+e.property))}function _value(e){return e instanceof Date&&\"function\"==typeof e.toISOString?{__type:\"Date\",iso:e.toISOString()}:e}function convertFilterOp(e,t){var n,o,i,s,r,a;const d=Object.keys(e);if(0===d.length)return{};if(1!==d.length)return null===(n=null==t?void 0:t.error)||void 0===n?void 0:n.call(t,\"Filter must only have one key found \"+d.join(\",\"));const l={},u=d[0];if(void 0!==e.and&&Array.isArray(e.and))l.$and=e.and.map((e=>convertFilterOp(e,t)));else if(void 0!==e.or&&Array.isArray(e.or))l.$or=e.or.map((e=>convertFilterOp(e,t)));else if(void 0!==e.idEqualTo)l.objectId={$eq:e.idEqualTo};else if(void 0!==e.idContainedIn)l.objectId={$in:e.idContainedIn};else if(void 0!==e.relatedTo){const n=e.relatedTo.id;if(void 0===n)return null===(o=null==t?void 0:t.error)||void 0===o?void 0:o.call(t,\"Must provide id in relatedTo filter\");const a=e.relatedTo.key;if(void 0===a)return null===(i=null==t?void 0:t.error)||void 0===i?void 0:i.call(t,\"Must provide key in relatedTo filter\");const d=e.relatedTo.className||(null===(s=(t.modelScope||Model).get(n))||void 0===s?void 0:s._class);if(void 0===d)return null===(r=null==t?void 0:t.error)||void 0===r?void 0:r.call(t,\"Must preload the Pointer or include className\");l.$relatedTo={object:{__type:\"Pointer\",objectId:n,className:d},key:a}}else if(\"object\"==typeof e[u]){const n=e[u];if(void 0!==n.equalTo)l[u]={$eq:_value(n.equalTo)};else if(void 0!==n.notEqualTo)l[u]={$ne:_value(n.notEqualTo)};else if(void 0!==n.lessThan)l[u]={$lt:_value(n.lessThan)};else if(void 0!==n.greaterThan)l[u]={$gt:_value(n.greaterThan)};else if(void 0!==n.lessThanOrEqualTo)l[u]={$lte:_value(n.lessThanOrEqualTo)};else if(void 0!==n.greaterThanOrEqualTo)l[u]={$gte:_value(n.greaterThanOrEqualTo)};else if(void 0!==n.exists)l[u]={$exists:n.exists};else if(void 0!==n.containedIn)l[u]={$in:n.containedIn};else if(void 0!==n.notContainedIn)l[u]={$nin:n.notContainedIn};else if(void 0!==n.pointsTo){let e=null;CloudStore._collections[t.collectionName]&&(e=CloudStore._collections[t.collectionName].schema);const o=e&&e.properties&&e.properties[u]?e.properties[u].targetClass:void 0;\"Relation\"===(e&&e.properties&&e.properties[u]?e.properties[u].type:void 0)?l[u]={__type:\"Pointer\",objectId:n.pointsTo,className:o}:Array.isArray(n.pointsTo)?l[u]={$in:n.pointsTo.map((e=>({__type:\"Pointer\",objectId:e,className:o})))}:l[u]={$eq:{__type:\"Pointer\",objectId:n.pointsTo,className:o}}}else if(void 0!==n.matchesRegex)l[u]={$regex:n.matchesRegex,$options:n.options};else if(void 0!==n.text&&void 0!==n.text.search){const e=n.text.search;l[u]=\"string\"==typeof e?{$text:{$search:{$term:e,$caseSensitive:!1}}}:{$text:{$search:{$term:e.term,$language:e.language,$caseSensitive:e.caseSensitive,$diacriticSensitive:e.diacriticSensitive}}}}else if(void 0!==n.nearSphere){const e=n.nearSphere;l[u]={$nearSphere:{__type:\"GeoPoint\",latitude:e.latitude,longitude:e.longitude},$maxDistanceInMiles:e.maxDistanceInMiles,$maxDistanceInKilometers:e.maxDistanceInKilometers,$maxDistanceInRadians:e.maxDistanceInRadians}}else if(void 0!==n.withinBox){const e=n.withinBox;l[u]={$within:{$box:e.map((e=>({__type:\"GeoPoint\",latitude:e.latitude,longitude:e.longitude})))}}}else if(void 0!==n.withinPolygon){const e=n.withinPolygon;l[u]={$geoWithin:{$polygon:e.map((e=>({__type:\"GeoPoint\",latitude:e.latitude,longitude:e.longitude})))}}}}else null===(a=null==t?void 0:t.error)||void 0===a||a.call(t,\"Unrecognized filter keys \"+d.join(\",\"));return l}const node$s={name:\"DbCollection2\",docs:\"https://docs.noodl.net/nodes/data/cloud-data/query-records\",displayName:\"Query Records\",category:\"Cloud Services\",usePortAsLabel:\"collectionName\",color:\"data\",initialize(){const e=this;this._internal.queryParameters={};let t=!1;this._internal.collectionChangedCallback=function(){t||(t=!0,e.scheduleAfterInputsHaveUpdated((function(){e.flagOutputDirty(\"count\"),e.flagOutputDirty(\"firstItemId\"),e.flagOutputDirty(\"isEmpty\"),t=!1})))},this._internal.cloudStoreEvents=function(t){var n,o;if(!0!==e.isInputConnected(\"storageFetch\")&&void 0!==e._internal.collection&&t.collection===e._internal.name)if(\"create\"===t.type){const o=Model.get(t.object.objectId);void 0!==o&&matchesQuery(o,null===(n=e._internal.currentQuery)||void 0===n?void 0:n.where)&&s(o)}else if(\"save\"===t.type){const n=Model.get(t.objectId);if(void 0!==n){const t=matchesQuery(n,null===(o=e._internal.currentQuery)||void 0===o?void 0:o.where);!t&&e._internal.collection.contains(n)?(e._internal.collection.remove(n),e.flagOutputDirty(\"items\"),e.flagOutputDirty(\"count\"),e.flagOutputDirty(\"firstItemId\"),e.flagOutputDirty(\"isEmpty\")):t&&!e._internal.collection.contains(n)&&s(n)}}else if(\"delete\"===t.type){const n=Model.get(t.objectId);void 0!==n&&(e._internal.collection.remove(n),e.flagOutputDirty(\"items\"),e.flagOutputDirty(\"count\"),e.flagOutputDirty(\"firstItemId\"),e.flagOutputDirty(\"isEmpty\"))}function s(t){var n,o;if(void 0!==(null===(n=e._internal.currentQuery)||void 0===n?void 0:n.sort)){for(let n=0;n<e._internal.collection.size()&&!(compareObjects(e._internal.currentQuery.sort,e._internal.collection.get(n),t)>0);n++);e._internal.collection.addAtIndex(t,i)}else e._internal.collection.add(t);let s=e._internal.collection.size();void 0!==(null===(o=e._internal.currentQuery)||void 0===o?void 0:o.limit)&&s>e._internal.currentQuery.limit&&e._internal.collection.remove(e._internal.collection.get(void 0!==e._internal.currentQuery.sort&&\"-\"===e._internal.currentQuery.sort[0][0]?s-1:0)),e.flagOutputDirty(\"items\"),e.flagOutputDirty(\"count\"),e.flagOutputDirty(\"firstItemId\"),e.flagOutputDirty(\"isEmpty\")}};const n=CloudStore.forScope(this.nodeScope.modelScope);n.on(\"save\",this._internal.cloudStoreEvents),n.on(\"create\",this._internal.cloudStoreEvents),n.on(\"delete\",this._internal.cloudStoreEvents),this._internal.storageSettings={}},getInspectInfo(){const e=this._internal.collection;return e?[{type:\"value\",value:e.items}]:{type:\"text\",value:\"[Not executed yet]\"}},inputs:{},outputs:{items:{type:\"array\",displayName:\"Items\",group:\"General\",getter:function(){return this._internal.collection}},firstItemId:{type:\"string\",displayName:\"First Record Id\",group:\"General\",getter:function(){if(this._internal.collection){const e=this._internal.collection.get(0);if(void 0!==e)return e.getId()}}},isEmpty:{type:\"boolean\",displayName:\"Is Empty\",group:\"General\",getter:function(){return!this._internal.collection||0===this._internal.collection.size()}},count:{type:\"number\",displayName:\"Count\",group:\"General\",getter:function(){return this._internal.collection?this._internal.collection.size():0}},fetched:{group:\"Events\",type:\"signal\",displayName:\"Success\"},failure:{group:\"Events\",type:\"signal\",displayName:\"Failure\"},error:{type:\"string\",displayName:\"Error\",group:\"Error\",getter:function(){return this._internal.error}}},prototypeExtensions:{setCollectionName:function(e){this._internal.name=e,!1===this.isInputConnected(\"storageFetch\")&&this.scheduleFetch()},setCollection:function(e){this.bindCollection(e),this.flagOutputDirty(\"firstItemId\"),this.flagOutputDirty(\"isEmpty\"),this.flagOutputDirty(\"items\"),this.flagOutputDirty(\"count\")},unbindCurrentCollection:function(){const e=this._internal.collection;e&&(e.off(\"change\",this._internal.collectionChangedCallback),this._internal.collection=void 0)},bindCollection:function(e){this.unbindCurrentCollection(),this._internal.collection=e,e&&e.on(\"change\",this._internal.collectionChangedCallback)},_onNodeDeleted:function(){Node.prototype._onNodeDeleted.call(this),this.unbindCurrentCollection();const e=CloudStore.forScope(this.nodeScope.modelScope);e.off(\"insert\",this._internal.cloudStoreEvents),e.off(\"delete\",this._internal.cloudStoreEvents),e.off(\"save\",this._internal.cloudStoreEvents)},setError:function(e){this._internal.err=e,this.flagOutputDirty(\"error\"),this.sendSignalOnOutput(\"failure\")},scheduleFetch:function(){const e=this._internal;e.fetchScheduled||(e.fetchScheduled=!0,this.scheduleAfterInputsHaveUpdated((()=>{e.fetchScheduled=!1,this.fetch()})))},fetch:function(){this.context.editorConnection&&(void 0===this._internal.name?this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"query-collection\",{message:\"No collection specified for query\"}):this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name,this.id,\"query-collection\"));const e=Collection.get(),t=this.getStorageFilter(),n=this.getStorageLimit(),o=this.getStorageSkip(),i=this.getStorageFetchTotalCount();this._internal.currentQuery={where:t.where,sort:t.sort,limit:n,skip:o},CloudStore.forScope(this.nodeScope.modelScope).query({collection:this._internal.name,where:t.where,sort:t.sort,limit:n,skip:o,count:i,success:(t,n)=>{void 0!==t&&e.set(t.map((e=>CloudStore._fromJSON(e,this._internal.name,this.nodeScope.modelScope)))),void 0!==n&&(this._internal.storageSettings.storageTotalCount=n,this.hasOutput(\"storageTotalCount\")&&this.flagOutputDirty(\"storageTotalCount\")),this.setCollection(e),this.sendSignalOnOutput(\"fetched\")},error:t=>{this.setCollection(e),this.setError(t||\"Failed to fetch.\")}})},getStorageFilter:function(){var e;const t=this._internal.storageSettings;if(void 0===t.storageFilterType||\"simple\"===t.storageFilterType){return{where:void 0!==this._internal.visualFilter?convertVisualFilter(this._internal.visualFilter,{queryParameters:this._internal.queryParameters,collectionName:this._internal.name}):void 0,sort:void 0!==this._internal.visualSorting?convertVisualSorting(this._internal.visualSorting):void 0}}if(\"json\"===t.storageFilterType){if(!this._internal.filterFunc)try{let e=t.storageJSONFilter;e=e.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g,\"\"),this._internal.filterVariables=e.match(/\\$[A-Za-z0-9]+/g)||[];const n=[\"filter\",\"where\",\"sort\",\"Inputs\"].concat(this._internal.filterVariables).concat([e]);this._internal.filterFunc=Function.apply(null,n)}catch(e){this._internal.filterFunc=void 0,console.log(\"Error while parsing filter script: \"+e)}if(!this._internal.filterFunc)return;let n={},o=[];const i=this,s=function(e){n=convertFilterOp(e,{collectionName:i._internal.name,error:function(e){i.context.editorConnection.sendWarning(i.nodeScope.componentOwner.name,i.id,\"query-collection-filter\",{message:e})}})},r=function(e){o=e},a={};for(const e in t)e.startsWith(\"storageFilterValue-\")&&(a[e.substring(19)]=t[e]);const d=[s,s,r,a];null===(e=this._internal.filterVariables)||void 0===e||e.forEach((e=>{d.push(t[\"storageFilterValue-\"+e.substring(1)])}));try{this._internal.filterFunc.apply(this,d)}catch(e){console.log(\"Error while running filter script: \"+e)}return{where:n,sort:o}}},getStorageLimit:function(){const e=this._internal.storageSettings;return e.storageEnableLimit?e.storageLimit||10:void 0},getStorageSkip:function(){const e=this._internal.storageSettings;return e.storageEnableLimit?e.storageSkip||0:void 0},getStorageFetchTotalCount:function(){return!!this._internal.storageSettings.storageEnableCount},registerOutputIfNeeded:function(e){this.hasOutput(e)||this.registerOutput(e,{getter(){return this._internal.storageSettings[e]}})},setVisualFilter:function(e){this._internal.visualFilter=e,!1===this.isInputConnected(\"storageFetch\")&&this.scheduleFetch()},setVisualSorting:function(e){this._internal.visualSorting=e,!1===this.isInputConnected(\"storageFetch\")&&this.scheduleFetch()},setQueryParameter:function(e,t){this._internal.queryParameters[e]=t,!1===this.isInputConnected(\"storageFetch\")&&this.scheduleFetch()},registerInputIfNeeded:function(e){if(this.hasInput(e))return;if(e.startsWith(\"qp-\"))return this.registerInput(e,{set:this.setQueryParameter.bind(this,e.substring(3))});const t={storageFetch:this.scheduleFetch.bind(this)};if(t[e])return this.registerInput(e,{set:createSetter({valueChangedToTrue:t[e]})});const n={collectionName:this.setCollectionName.bind(this),visualFilter:this.setVisualFilter.bind(this),visualSort:this.setVisualSorting.bind(this)};if(n[e])return this.registerInput(e,{set:n[e]});this.registerInput(e,{set(t){this._internal.storageSettings[e]=t,!1===this.isInputConnected(\"storageFetch\")&&this.scheduleFetch()}})}}},_defaultJSONQuery=\"// Write your query script here, check out the reference documentation for examples\\nwhere({ })\\n\";function updatePorts$6(e,t,n,o){const i=[],s=o.getMetaData(\"dbCollections\"),r=o.getMetaData(\"systemCollections\");if(i.push({name:\"collectionName\",type:{name:\"enum\",enums:[{label:\"User\",value:\"_User\"},{label:\"Role\",value:\"_Role\"}].concat(void 0!==s?s.map((e=>({value:e.name,label:e.name}))):[]),allowEditOnly:!0},displayName:\"Class\",plug:\"input\",group:\"General\"}),i.push({name:\"storageFilterType\",type:{name:\"enum\",allowEditOnly:!0,enums:[{value:\"simple\",label:\"Visual\"},{value:\"json\",label:\"Javascript\"}]},displayName:\"Filter\",default:\"simple\",plug:\"input\",group:\"General\"}),i.push({type:{name:\"boolean\"},plug:\"input\",group:\"Limit\",name:\"storageEnableLimit\",displayName:\"Use limit\"}),t.storageEnableLimit&&(i.push({type:{name:\"number\"},default:10,plug:\"input\",group:\"Limit\",name:\"storageLimit\",displayName:\"Limit\"}),i.push({type:{name:\"number\"},default:0,plug:\"input\",group:\"Limit\",name:\"storageSkip\",displayName:\"Skip\"})),i.push({type:{name:\"signal\"},plug:\"input\",group:\"Actions\",name:\"storageFetch\",displayName:\"Do\"}),i.push({type:{name:\"boolean\"},plug:\"input\",group:\"Total Count\",name:\"storageEnableCount\",displayName:\"Fetch total count\"}),t.storageEnableCount&&i.push({type:{name:\"number\"},plug:\"output\",group:\"General\",name:\"storageTotalCount\",displayName:\"Total Count\"}),void 0===t.storageFilterType||\"simple\"===t.storageFilterType){if(void 0!==t.collectionName){let e=s&&s.find((e=>e.name===t.collectionName));if(void 0===e&&r&&(e=r.find((e=>e.name===t.collectionName))),e&&e.schema&&e.schema.properties){const n=JSON.parse(JSON.stringify(e.schema));null==s||s.forEach(_findRelations.bind(null,t,n)),null==r||r.forEach(_findRelations.bind(null,t,n)),i.push({name:\"visualFilter\",plug:\"input\",type:{name:\"query-filter\",schema:n,allowEditOnly:!0},displayName:\"Filter\",group:\"Filter\"}),i.push({name:\"visualSort\",plug:\"input\",type:{name:\"query-sorting\",schema:n,allowEditOnly:!0},displayName:\"Sort\",group:\"Sorting\"})}if(void 0!==t.visualFilter){const e={};_collectInputs$1(e,t.visualFilter),Object.keys(e).forEach((e=>{i.push({name:\"qp-\"+e,plug:\"input\",type:{name:\"*\"},displayName:e,group:\"Query Parameters\"})}))}}}else if(\"json\"===t.storageFilterType){i.push({type:{name:\"string\",allowEditOnly:!0,codeeditor:\"javascript\"},plug:\"input\",group:\"Filter\",name:\"storageJSONFilter\",default:_defaultJSONQuery,displayName:\"Filter\"});let e=String(t.storageJSONFilter);if(e){e=e.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g,\"\");const t=e.match(/\\$[A-Za-z0-9]+/g);if(t){const e={};t.forEach((t=>{e[t]=!0})),Object.keys(e).forEach((e=>{i.push({name:\"storageFilterValue-\"+e.substring(1),displayName:e.substring(1),group:\"Filter Values\",plug:\"input\",type:{name:\"*\",allowConnectionsOnly:!0}})}))}JavascriptNodeParser.parseAndAddPortsFromScript(e,i,{inputPrefix:\"storageFilterValue-\",inputGroup:\"Filter Values\",inputType:{name:\"*\",allowConnectionsOnly:!0},skipOutputs:!0})}}n.sendDynamicPorts(e,i)}function setup$7(e,t){function n(n){updatePorts$6(n.id,n.parameters,e.editorConnection,t),n.on(\"parameterUpdated\",(function(o){(o.name.startsWith(\"storage\")||\"visualFilter\"===o.name||\"collectionName\"===o.name)&&updatePorts$6(n.id,n.parameters,e.editorConnection,t)})),t.on(\"metadataChanged.dbCollections\",(function(){CloudStore.invalidateCollections(),updatePorts$6(n.id,n.parameters,e.editorConnection,t)})),t.on(\"metadataChanged.systemCollections\",(function(){CloudStore.invalidateCollections(),updatePorts$6(n.id,n.parameters,e.editorConnection,t)})),t.on(\"metadataChanged.cloudservices\",(function(){CloudStore.instance._initCloudServices()}))}e.editorConnection&&e.editorConnection.isRunningLocally()&&t.on(\"editorImportComplete\",(()=>{t.on(\"nodeAdded.DbCollection2\",(function(e){n(e)}));for(const e of t.getNodesWithType(\"DbCollection2\"))n(e)}))}function _collectInputs$1(e,t){void 0!==t&&(void 0!==t.rules?t.rules.forEach((t=>_collectInputs$1(e,t))):void 0!==t.input&&(e[t.input]=!0))}function _findRelations(e,t,n){if(void 0!==n.schema&&void 0!==n.schema.properties)for(const o in n.schema.properties){const i=n.schema.properties[o];\"Relation\"===i.type&&i.targetClass===e.collectionName&&(void 0===t.relations&&(t.relations={}),void 0===t.relations[n.name]&&(t.relations[n.name]=[]),t.relations[n.name].push({property:o}))}}var dbcollectionnode2=Object.freeze({__proto__:null,node:node$s,setup:setup$7});const node$r={name:\"DbModel2\",docs:\"https://docs.noodl.net/nodes/data/cloud-data/record\",displayNodeName:\"Record\",shortDesc:\"Database model\",category:\"Cloud Services\",usePortAsLabel:\"collectionName\",color:\"data\",dynamicports:[{name:\"conditionalports/extended\",condition:\"idSource = explicit OR idSource NOT SET\",inputs:[\"modelId\"]}],initialize:function(){const e=this._internal;e.inputValues={},e.relationModelIds={};const t=this;this._internal.onModelChangedCallback=function(e){t.isInputConnected(\"fetch\")||(t.hasOutput(\"prop-\"+e.name)&&t.flagOutputDirty(\"prop-\"+e.name),t.hasOutput(\"changed-\"+e.name)&&t.sendSignalOnOutput(\"changed-\"+e.name),t.sendSignalOnOutput(\"changed\"))}},getInspectInfo(){const e=this._internal.model;return e?[{type:\"text\",value:\"Id: \"+e.getId()},{type:\"value\",value:e.data}]:\"[No Record]\"},outputs:{id:{type:\"string\",displayName:\"Id\",group:\"General\",getter:function(){return this._internal.model?this._internal.model.getId():this._internal.modelId}},fetched:{type:\"signal\",displayName:\"Fetched\",group:\"Events\"},changed:{type:\"signal\",displayName:\"Changed\",group:\"Events\"},failure:{type:\"signal\",displayName:\"Failure\",group:\"Events\"},error:{type:\"string\",displayName:\"Error\",group:\"Error\",getter:function(){return this._internal.error}}},inputs:{idSource:{type:{name:\"enum\",enums:[{label:\"Specify explicitly\",value:\"explicit\"},{label:\"From repeater\",value:\"foreach\"}],allowEditOnly:!0},default:\"explicit\",displayName:\"Id Source\",group:\"General\",set(e){\"foreach\"===e&&this.scheduleAfterInputsHaveUpdated((()=>{let e=this.nodeScope.componentOwner;for(;void 0!==e&&void 0===e._forEachModel&&e.parentNodeScope;)e=e.parentNodeScope.componentOwner;this.setModel(void 0!==e?e._forEachModel:void 0)}))}},modelId:{type:{name:\"string\",allowConnectionsOnly:!0},displayName:\"Id\",group:\"General\",set(e){e instanceof Model?e=e.getId():\"object\"==typeof e&&(e=Model.create(e).getId()),this._internal.modelId=e,!1===this.isInputConnected(\"fetch\")?this.setModelID(e):this.flagOutputDirty(\"id\")}},fetch:{displayName:\"Fetch\",group:\"Actions\",valueChangedToTrue(){this.scheduleFetch()}}},methods:{setCollectionID(e){this._internal.collectionId=e},setModelID(e){const t=(this.nodeScope.modelScope||Model).get(e);this.setModel(t)},setModel(e){this._internal.model&&this._internal.model.off(\"change\",this._internal.onModelChangedCallback),this._internal.model=e,this.flagOutputDirty(\"id\"),e.on(\"change\",this._internal.onModelChangedCallback);for(const t in e.data)this.hasOutput(\"prop-\"+t)&&this.flagOutputDirty(\"prop-\"+t);this.sendSignalOnOutput(\"fetched\")},_onNodeDeleted(){Node.prototype._onNodeDeleted.call(this),this._internal.model&&this._internal.model.off(\"change\",this._internal.onModelChangedCallback)},scheduleOnce(e,t){const n=this,o=\"hasScheduled\"+e;this._internal[o]||(this._internal[o]=!0,this.scheduleAfterInputsHaveUpdated((function(){n._internal[o]=!1,t()})))},setError(e){this._internal.error=e,this.flagOutputDirty(\"error\"),this.sendSignalOnOutput(\"failure\"),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"storage-op-warning\",{message:e,showGlobally:!0})},clearWarnings(){this.context.editorConnection&&this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name,this.id,\"storage-op-warning\")},scheduleFetch(){const e=this,t=this._internal;this.scheduleOnce(\"Fetch\",(function(){if(void 0===t.modelId||\"\"===t.modelId)return void e.setError(\"Missing Id.\");const n=CloudStore.forScope(e.nodeScope.modelScope);n.fetch({collection:t.collectionId,objectId:t.modelId,success:function(o){const i=n._fromJSON(o,t.collectionId);t.model!==i&&(t.model&&t.model.off(\"change\",t.onModelChangedCallback),t.model=i,i.on(\"change\",t.onModelChangedCallback)),e.flagOutputDirty(\"id\"),delete o.objectId;for(const t in o)e.hasOutput(\"prop-\"+t)&&e.flagOutputDirty(\"prop-\"+t);e.sendSignalOnOutput(\"fetched\")},error:function(t){e.setError(t||\"Failed to fetch.\")}})}))},scheduleStore:function(){const e=this._internal;e.model&&this.scheduleOnce(\"Store\",(function(){for(const t in e.inputValues)e.model.set(t,e.inputValues[t],{resolve:!0})}))},registerOutputIfNeeded:function(e){this.hasOutput(e)||e.startsWith(\"prop-\")&&this.registerOutput(e,{getter:userOutputGetter$1.bind(this,e.substring(5))})},registerInputIfNeeded:function(e){if(this.hasInput(e))return;const t={};if(t[e])return this.registerInput(e,{set:createSetter({valueChangedToTrue:t[e]})});const n={collectionName:this.setCollectionID.bind(this)};if(n[e])return this.registerInput(e,{set:n[e]});e.startsWith(\"prop-\")&&this.registerInput(e,{set:userInputSetter$1.bind(this,e.substring(5))})}}};function userOutputGetter$1(e){return this._internal.model?this._internal.model.get(e,{resolve:!0}):void 0}function userInputSetter$1(e,t){this._internal.inputValues[e]=t}function updatePorts$5(e,t,n,o){const i=[],s=o.getMetaData(\"dbCollections\"),r=o.getMetaData(\"systemCollections\");if(i.push({name:\"collectionName\",displayName:\"Class\",group:\"General\",type:{name:\"enum\",enums:[{label:\"User\",value:\"_User\"},{label:\"Role\",value:\"_Role\"}].concat(void 0!==s?s.map((e=>({value:e.name,label:e.name}))):[]),allowEditOnly:!0},plug:\"input\"}),t.collectionName&&s){let e=s.find((e=>e.name===t.collectionName));if(void 0===e&&r&&(e=r.find((e=>e.name===t.collectionName))),e&&e.schema&&e.schema.properties){const t=e.schema.properties;for(const e in t){const n=t[e];if(!i.find((t=>t.name===e))&&\"Relation\"!==n.type){const t={String:\"string\",Boolean:\"boolean\",Number:\"number\",Date:\"date\"};i.push({type:{name:t[n.type]?t[n.type]:\"*\"},plug:\"output\",group:\"Properties\",name:\"prop-\"+e,displayName:e}),i.push({type:\"signal\",plug:\"output\",group:\"Changed Events\",displayName:e+\" Changed\",name:\"changed-\"+e})}}}}n.sendDynamicPorts(e,i)}function setup$6(e,t){function n(n){updatePorts$5(n.id,n.parameters,e.editorConnection,t),n.on(\"parameterUpdated\",(function(){updatePorts$5(n.id,n.parameters,e.editorConnection,t)})),t.on(\"metadataChanged.dbCollections\",(function(){CloudStore.invalidateCollections(),updatePorts$5(n.id,n.parameters,e.editorConnection,t)})),t.on(\"metadataChanged.systemCollections\",(function(){CloudStore.invalidateCollections(),updatePorts$5(n.id,n.parameters,e.editorConnection,t)}))}e.editorConnection&&e.editorConnection.isRunningLocally()&&t.on(\"editorImportComplete\",(()=>{t.on(\"nodeAdded.DbModel2\",(function(e){n(e)}));for(const e of t.getNodesWithType(\"DbModel2\"))n(e)}))}var dbmodelnode2=Object.freeze({__proto__:null,node:node$r,setup:setup$6});function _addBaseInfo$1(e,t){const n=void 0===t||t.includeInputProperties,o=void 0!==t&&t.includeRelations;Object.assign(e.node,{category:\"Data\",color:\"data\",inputs:e.node.inputs||{},outputs:e.node.outputs||{},methods:e.node.methods||{}}),Object.assign(e.node.outputs,{failure:{type:\"signal\",displayName:\"Failure\",group:\"Events\"},error:{type:\"string\",displayName:\"Error\",group:\"Error\",getter:function(){return this._internal.error}}}),Object.assign(e.node.methods,{scheduleOnce:function(e,t){const n=this,o=\"hasScheduled\"+e;this._internal[o]||(this._internal[o]=!0,this.scheduleAfterInputsHaveUpdated((function(){n._internal[o]=!1,t()})))},checkWarningsBeforeCloudOp(){return this.clearWarnings(),!!this._internal.collectionId||(this.setError(\"No class name specified\"),!1)},setError:function(e){this._internal.error=e,this.flagOutputDirty(\"error\"),this.sendSignalOnOutput(\"failure\"),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"storage-op-warning\",{message:e,showGlobally:!0})},clearWarnings(){this.context.editorConnection&&this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name,this.id,\"storage-op-warning\")}}),Object.assign(e,{setup:function(t,i){function s(s){function r(){var r;const a=[],d=i.getMetaData(\"dbCollections\"),l=i.getMetaData(\"systemCollections\"),u=s.parameters;if(a.push({name:\"collectionName\",displayName:\"Class\",group:\"General\",type:{name:\"enum\",enums:[{label:\"User\",value:\"_User\"},{label:\"Role\",value:\"_Role\"}].concat(void 0!==d?d.map((e=>({value:e.name,label:e.name}))):[]),allowEditOnly:!0},plug:\"input\"}),o&&u.collectionName&&d){let e=d.find((e=>e.name===u.collectionName));if(void 0===e&&l&&(e=l.find((e=>e.name===u.collectionName))),e&&e.schema&&e.schema.properties){const t=e.schema.properties,n=Object.keys(t).filter((e=>\"Relation\"===t[e].type)).map((e=>({label:e,value:e})));a.push({name:\"relationProperty\",displayName:\"Relation\",group:\"General\",type:{name:\"enum\",enums:n,allowEditOnly:!0},plug:\"input\"})}}if(n&&u.collectionName&&d){const e={String:\"string\",Boolean:\"boolean\",Number:\"number\",Date:\"date\"};let t=d.find((e=>e.name===u.collectionName));if(void 0===t&&l&&(t=l.find((e=>e.name===u.collectionName))),t&&t.schema&&t.schema.properties){const n=t.schema.properties;for(const t in n){const o=n[t];a.find((e=>e.name===t))||a.push({type:{name:e[o.type]?e[o.type]:\"*\"},plug:\"input\",group:\"Properties\",name:\"prop-\"+t,displayName:t})}}}null===(r=e._additionalDynamicPorts)||void 0===r||r.call(e,s,a,i),t.editorConnection.sendDynamicPorts(s.id,a)}r(),s.on(\"parameterUpdated\",(function(){r()})),i.on(\"metadataChanged.dbCollections\",(function(){CloudStore.invalidateCollections(),r()})),i.on(\"metadataChanged.systemCollections\",(function(){CloudStore.invalidateCollections(),r()}))}t.editorConnection&&t.editorConnection.isRunningLocally()&&i.on(\"editorImportComplete\",(()=>{i.on(\"nodeAdded.\"+e.node.name,(function(e){s(e)}));for(const t of i.getNodesWithType(e.node.name))s(t)}))}})}function _addModelId$1(e,t){const n=Object.assign({},e.node.methods),o=void 0===t||t.includeInputs,i=void 0===t||t.includeOutputs;Object.assign(e.node,{inputs:e.node.inputs||{},outputs:e.node.outputs||{},methods:e.node.methods||{}}),o&&(Object.assign(e.node,{usePortAsLabel:\"collectionName\"}),e.node.dynamicports=(e.node.dynamicports||[]).concat([{name:\"conditionalports/extended\",condition:\"idSource = explicit OR idSource NOT SET\",inputs:[\"modelId\"]}]),Object.assign(e.node.inputs,{idSource:{type:{name:\"enum\",enums:[{label:\"Specify explicitly\",value:\"explicit\"},{label:\"From repeater\",value:\"foreach\"}],allowEditOnly:!0},default:\"explicit\",displayName:\"Id Source\",group:\"General\",tooltip:\"Choose if you want to specify the Id explicitly, \\n or if you want it to be that of the current record in a repeater.\",set:function(e){\"foreach\"===e&&this.scheduleAfterInputsHaveUpdated((()=>{let e=this.nodeScope.componentOwner;for(;void 0!==e&&void 0===e._forEachModel&&e.parentNodeScope;)e=e.parentNodeScope.componentOwner;this.setModel(void 0!==e?e._forEachModel:void 0)}))}},modelId:{type:{name:\"string\",identifierOf:\"ModelName\",identifierDisplayName:\"Object Ids\"},displayName:\"Id\",group:\"General\",set:function(e){e instanceof Model&&(e=e.getId()),this._internal.modelId=e,this.setModelID(e)}}})),i&&Object.assign(e.node.outputs,{id:{type:\"string\",displayName:\"Id\",group:\"General\",getter:function(){return this._internal.model?this._internal.model.getId():this._internal.modelId}}}),Object.assign(e.node.methods,{setCollectionID:function(e){this._internal.collectionId=e,this.clearWarnings()},setModelID:function(e){const t=(this.nodeScope.modelScope||Model).get(e);this.setModel(t)},setModel:function(e){this._internal.model=e,this.flagOutputDirty(\"id\")},registerInputIfNeeded:function(e){this.hasInput(e)||(\"collectionName\"===e&&this.registerInput(e,{set:this.setCollectionID.bind(this)}),n&&n.registerInputIfNeeded&&n.registerInputIfNeeded.call(this,e))}})}function _addInputProperties$1(e){const t={node:Object.assign({},e.node),setup:e.setup},n=Object.assign({},e.node.methods);Object.assign(e.node,{inputs:e.node.inputs||{},outputs:e.node.outputs||{},methods:e.node.methods||{}}),Object.assign(e.node,{initialize:function(){this._internal.inputValues={},t.node.initialize&&t.node.initialize.call(this)}}),Object.assign(e.node.outputs,{}),Object.assign(e.node.inputs,{}),Object.assign(e.node.methods,{registerInputIfNeeded:function(e){this.hasInput(e)||(e.startsWith(\"prop-\")&&this.registerInput(e,{set:this._setInputValue.bind(this,e.substring(5))}),n&&n.registerInputIfNeeded&&n.registerInputIfNeeded.call(this,e))},_setInputValue:function(e,t){this._internal.inputValues[e]=t}})}function _addRelationProperty(e){const t=Object.assign({},e.node.methods);Object.assign(e.node,{inputs:e.node.inputs||{},outputs:e.node.outputs||{},methods:e.node.methods||{}}),Object.assign(e.node.inputs,{targetId:{type:{name:\"string\",allowConnectionsOnly:!0},displayName:\"Target Record Id\",group:\"General\",set:function(e){this._internal.targetModelId=e}}}),Object.assign(e.node.methods,{registerInputIfNeeded:function(e){this.hasInput(e)||(\"relationProperty\"===e&&this.registerInput(e,{set:this.setRelationProperty.bind(this)}),t&&t.registerInputIfNeeded&&t.registerInputIfNeeded.call(this,e))},setRelationProperty:function(e){this._internal.relationProperty=e}})}function _getCurrentUser(e){if(\"undefined\"!=typeof _noodl_cloud_runtime_version){return e.get(\"Request\").UserId}{const e=localStorage[\"Parse/\"+CloudStore.instance.appId+\"/currentUser\"];if(void 0!==e){let t;try{t=JSON.parse(e)}catch(e){}return void 0!==t?t.objectId:void 0}}}function _addAccessControl(e){const t={node:Object.assign({},e.node),setup:e.setup},n=Object.assign({},e.node.methods);Object.assign(e.node,{inputs:e.node.inputs||{},outputs:e.node.outputs||{},methods:e.node.methods||{}}),Object.assign(e.node,{initialize(){this._internal.accessControl={},t.node.initialize&&t.node.initialize.call(this)}}),Object.assign(e.node.inputs,{accessControl:{type:{name:\"proplist\",autoName:\"Rule\",allowEditOnly:!0},index:1e3,displayName:\"Access Control Rules\",group:\"Access Control Rules\",set(e){this._internal.accessControlRules=e}}});const o=e._additionalDynamicPorts;e._additionalDynamicPorts=function(e,t,n){void 0!==e.parameters.accessControl&&e.parameters.accessControl.length>0&&e.parameters.accessControl.forEach((n=>{const o=\"acl-\"+n.id;t.push({name:o+\"-target\",displayName:\"Target\",editorName:n.label+\" | Target\",plug:\"input\",type:{name:\"enum\",enums:[{value:\"user\",label:\"User\"},{value:\"everyone\",label:\"Everyone\"},{value:\"role\",label:\"Role\"}],allowEditOnly:!0},group:n.label+\" Access Rule\",default:\"user\",parent:\"accessControl\",parentItemId:n.id}),\"role\"===e.parameters[o+\"-target\"]?t.push({name:o+\"-role\",displayName:\"Role\",editorName:n.label+\" | Role\",group:n.label+\" Access Rule\",plug:\"input\",type:\"string\",parent:\"accessControl\",parentItemId:n.id}):void 0!==e.parameters[o+\"-target\"]&&\"user\"!==e.parameters[o+\"-target\"]||t.push({name:o+\"-userid\",displayName:\"User Id\",group:n.label+\" Access Rule\",editorName:n.label+\" | User Id\",plug:\"input\",type:{name:\"string\",allowConnectionsOnly:!0},parent:\"accessControl\",parentItemId:n.id}),t.push({name:o+\"-read\",displayName:\"Read\",editorName:n.label+\" | Read\",group:n.label+\" Access Rule\",plug:\"input\",type:{name:\"boolean\"},default:!0,parent:\"accessControl\",parentItemId:n.id}),t.push({name:o+\"-write\",displayName:\"Write\",editorName:n.label+\" | Write\",group:n.label+\" Access Rule\",plug:\"input\",type:{name:\"boolean\"},default:!0,parent:\"accessControl\",parentItemId:n.id})})),o&&o(e,t,n)},Object.assign(e.node.methods,{registerInputIfNeeded:function(e){this.hasInput(e)||(e.startsWith(\"acl-\")&&this.registerInput(e,{set:this.setAccessControl.bind(this,e)}),n&&n.registerInputIfNeeded&&n.registerInputIfNeeded.call(this,e))},_getACL:function(){let e={};function t(e){return{read:void 0===e.read||e.read,write:void 0===e.write||e.write}}const n=_getCurrentUser(this.nodeScope.modelScope);return void 0!==this._internal.accessControlRules&&this._internal.accessControlRules.forEach((o=>{const i=this._internal.accessControl[o.id];if(void 0===i){void 0!==n&&(e[n]={write:!0,read:!0})}else if(\"everyone\"===i.target)e[\"*\"]=t(i);else if(\"user\"===i.target){const o=i.userid||n;e[o]=t(i)}else\"role\"===i.target&&(e[\"role:\"+i.role]=t(i))})),Object.keys(e).length>0?e:void 0},setAccessControl:function(e,t){const n=e.split(\"-\");void 0===this._internal.accessControl[n[1]]&&(this._internal.accessControl[n[1]]={}),this._internal.accessControl[n[1]][n[2]]=t}})}const SetDbModelPropertiedNodeDefinition={node:{name:\"SetDbModelProperties\",category:\"\",docs:\"https://docs.noodl.net/nodes/data/cloud-data/set-record-properties\",displayNodeName:\"Set Record Properties\",usePortAsLabel:\"collectionName\",dynamicports:[{name:\"conditionalports/extended\",condition:\"storeType = cloud OR storeType NOT SET\",inputs:[\"storeProperties\"]}],inputs:{store:{displayName:\"Do\",group:\"Actions\",valueChangedToTrue(){void 0===this._internal.storeType||\"cloud\"===this._internal.storeType?this.scheduleSave():this.scheduleStore()}},storeProperties:{displayName:\"Properties to  store\",group:\"General\",type:{name:\"enum\",enums:[{label:\"Only specified\",value:\"specified\"},{label:\"All\",value:\"all\"}]},default:\"specified\",set:function(e){this._internal.storeProperties=e}},storeType:{displayName:\"Store to\",group:\"General\",type:{name:\"enum\",enums:[{label:\"Cloud and local\",value:\"cloud\"},{label:\"Local only\",value:\"local\"}]},default:\"cloud\",set:function(e){this._internal.storeType=e}}},outputs:{stored:{type:\"signal\",displayName:\"Success\",group:\"Events\"}},methods:{scheduleSave(){const e=this,t=this._internal;this.checkWarningsBeforeCloudOp()&&this.scheduleOnce(\"StorageSave\",(function(){if(!t.model)return void e.setError(\"Missing Record Id\");const n=t.model;for(const e in t.inputValues)n.set(e,t.inputValues[e],{resolve:!0});CloudStore.forScope(e.nodeScope.modelScope).save({collection:t.collectionId,objectId:n.getId(),data:\"all\"===t.storeProperties?n.data:t.inputValues,acl:e._getACL(),success:function(t){for(const e in t)n.set(e,t[e]);e.sendSignalOnOutput(\"stored\")},error:function(t){e.setError(t||\"Failed to save.\")}})}))},scheduleStore(){if(this.hasScheduledStore)return;this.hasScheduledStore=!0;const e=this._internal;this.scheduleAfterInputsHaveUpdated((()=>{if(this.hasScheduledStore=!1,e.model){for(const t in e.inputValues)e.model.set(t,e.inputValues[t],{resolve:!0});this.sendSignalOnOutput(\"stored\")}}))}}}};_addBaseInfo$1(SetDbModelPropertiedNodeDefinition),_addModelId$1(SetDbModelPropertiedNodeDefinition),_addInputProperties$1(SetDbModelPropertiedNodeDefinition),_addAccessControl(SetDbModelPropertiedNodeDefinition);const node$q=SetDbModelPropertiedNodeDefinition.node;var setdbmodelpropertiesnode=Object.freeze({__proto__:null,node:node$q});const DeleteDbModelPropertiedNodeDefinition={node:{name:\"DeleteDbModelProperties\",category:\"\",docs:\"https://docs.noodl.net/nodes/data/cloud-data/delete-record\",displayNodeName:\"Delete Record\",shortDesc:\"Stores any amount of properties and can be used standalone or together with Collections and For Each nodes.\",inputs:{store:{displayName:\"Do\",group:\"Actions\",valueChangedToTrue(){this.storageDelete()}}},outputs:{deleted:{type:\"signal\",displayName:\"Success\",group:\"Events\"}},methods:{storageDelete(){const e=this._internal;this.checkWarningsBeforeCloudOp()&&this.scheduleOnce(\"StorageDelete\",(()=>{e.model?CloudStore.forScope(this.nodeScope.ModelScope).delete({collection:e.collectionId,objectId:e.model.getId(),success:()=>{e.model.notify(\"delete\"),this.sendSignalOnOutput(\"deleted\")},error:e=>{this.setError(e||\"Failed to delete.\")}}):this.setError(\"Missing Record Id\")}))}}}};_addBaseInfo$1(DeleteDbModelPropertiedNodeDefinition,{includeInputProperties:!1}),_addModelId$1(DeleteDbModelPropertiedNodeDefinition);const node$p=DeleteDbModelPropertiedNodeDefinition.node;var deletedbmodelpropertiesnode=Object.freeze({__proto__:null,node:node$p});const NewDbModelPropertiedNodeDefinition={node:{name:\"NewDbModelProperties\",category:\"\",docs:\"https://docs.noodl.net/nodes/data/cloud-data/create-new-record\",displayName:\"Create New Record\",usePortAsLabel:\"collectionName\",inputs:{store:{displayName:\"Do\",group:\"Actions\",valueChangedToTrue(){this.storageInsert()}},sourceObjectId:{type:{name:\"string\",allowConnectionsOnly:!0},displayName:\"Source Object Id\",group:\"General\",set(e){e instanceof Model&&(e=e.getId()),this._internal.sourceObjectId=e}}},outputs:{created:{type:\"signal\",displayName:\"Success\",group:\"Events\"}},methods:{storageInsert(){const e=this._internal;this.checkWarningsBeforeCloudOp()&&this.scheduleOnce(\"StorageInsert\",(()=>{const t=Object.assign({},e.sourceObjectId?(this.nodeScope.modelScope||Model).get(e.sourceObjectId).data:{},e.inputValues),n=CloudStore.forScope(this.nodeScope.modelScope);n.create({collection:e.collectionId,data:t,acl:this._getACL(),success:t=>{const o=n._fromJSON(t,e.collectionId);this.setModel(o),this.sendSignalOnOutput(\"created\")},error:e=>{this.setError(e||\"Failed to insert.\")}})}))}}}};_addBaseInfo$1(NewDbModelPropertiedNodeDefinition),_addModelId$1(NewDbModelPropertiedNodeDefinition,{includeOutputs:!0}),_addInputProperties$1(NewDbModelPropertiedNodeDefinition),_addAccessControl(NewDbModelPropertiedNodeDefinition);const node$o=NewDbModelPropertiedNodeDefinition.node;var newdbmodelpropertiesnode=Object.freeze({__proto__:null,node:node$o});const AddDbModelRelationNodeDefinition$1={node:{name:\"AddDbModelRelation\",category:\"Data\",docs:\"https://docs.noodl.net/nodes/data/cloud-data/add-record-relation\",displayNodeName:\"Add Record Relation\",usePortAsLabel:\"collectionName\",inputs:{store:{displayName:\"Do\",group:\"Actions\",valueChangedToTrue(){this.scheduleAddRelation()}}},outputs:{relationAdded:{type:\"signal\",displayName:\"Success\",group:\"Events\"}},methods:{validateInputs(){if(!this.context.editorConnection)return;const e=e=>{this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"add-relation\",{message:e})};void 0===this._internal.collectionId?e(\"No class specified\"):void 0===this._internal.relationProperty?e(\"No relation property specified\"):void 0===this._internal.targetModelId?e(\"No target record Id (the record to add a relation to) specified\"):void 0===this._internal.model?e(\"No record Id specified (the record that should get the relation)\"):this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name,this.id,\"add-relation\")},scheduleAddRelation(){const e=this,t=this._internal;this.scheduleOnce(\"StorageAddRelation\",(function(){if(e.validateInputs(),!t.model)return;const n=t.model,o=t.targetModelId;void 0!==o&&CloudStore.forScope(e.nodeScope.modelScope).addRelation({collection:t.collectionId,objectId:n.getId(),key:t.relationProperty,targetObjectId:o,targetClass:(e.nodeScope.modelScope||Model).get(o)._class,success:function(t){for(const e in t)n.set(e,t[e]);e.sendSignalOnOutput(\"relationAdded\")},error:function(t){e.setError(t||\"Failed to add relation.\")}})}))}}}};_addBaseInfo$1(AddDbModelRelationNodeDefinition$1,{includeRelations:!0}),_addModelId$1(AddDbModelRelationNodeDefinition$1),_addRelationProperty(AddDbModelRelationNodeDefinition$1);const node$n=AddDbModelRelationNodeDefinition$1.node;var dbmodelnodeAddrelation=Object.freeze({__proto__:null,node:node$n});const AddDbModelRelationNodeDefinition={node:{name:\"RemoveDbModelRelation\",category:\"\",docs:\"https://docs.noodl.net/nodes/data/cloud-data/remove-record-relation\",displayName:\"Remove Record Relation\",usePortAsLabel:\"collectionName\",inputs:{store:{displayName:\"Do\",group:\"Actions\",valueChangedToTrue(){this.scheduleRemoveRelation()}}},outputs:{relationRemoved:{type:\"signal\",displayName:\"Success\",group:\"Events\"}},methods:{validateInputs(){if(!this.context.editorConnection)return;const e=e=>{this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"add-relation\",{message:e})};void 0===this._internal.collectionId?e(\"No class specified\"):void 0===this._internal.relationProperty?e(\"No relation property specified\"):void 0===this._internal.targetModelId?e(\"No target record Id (the record to add a relation to) specified\"):void 0===this._internal.model?e(\"No record Id specified (the record that should get the relation)\"):this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name,this.id,\"add-relation\")},scheduleRemoveRelation(){const e=this,t=this._internal;this.scheduleOnce(\"StorageRemoveRelation\",(function(){if(e.validateInputs(),!t.model)return;const n=t.model,o=t.targetModelId;void 0!==o&&CloudStore.forScope(e.nodeScope.modelScope).removeRelation({collection:t.collectionId,objectId:n.getId(),key:t.relationProperty,targetObjectId:o,targetClass:(e.nodeScope.modelScope||Model).get(o)._class,success:function(t){for(const e in t)n.set(e,t[e]);e.sendSignalOnOutput(\"relationRemoved\")},error:function(t){e.setError(t||\"Failed to remove relation.\")}})}))}}}};_addBaseInfo$1(AddDbModelRelationNodeDefinition,{includeRelations:!0}),_addModelId$1(AddDbModelRelationNodeDefinition),_addRelationProperty(AddDbModelRelationNodeDefinition);const node$m=AddDbModelRelationNodeDefinition.node;var dbmodelnodeRemoverelation=Object.freeze({__proto__:null,node:node$m});const node$l={name:\"FilterDBModels\",docs:\"https://docs.noodl.net/nodes/data/cloud-data/filter-records\",displayNodeName:\"Filter Records\",shortDesc:\"Filter, sort and limit array\",category:\"Data\",color:\"data\",initialize(){const e=this;this._internal.collectionChangedCallback=function(){!0!==e.isInputConnected(\"filter\")&&e.scheduleFilter()},this._internal.cloudStoreEvents=function(t){!0!==e.isInputConnected(\"filter\")&&void 0!==e._internal.visualFilter&&void 0!==e._internal.collection&&t.collection===e._internal.collectionName&&void 0!==t.objectId&&e._internal.collection.contains(Model.get(t.objectId))&&e.scheduleFilter()},CloudStore.instance.on(\"save\",this._internal.cloudStoreEvents),this._internal.enabled=!0,this._internal.filterSettings={},this._internal.filterParameters={}},getInspectInfo(){const e=this._internal.filteredCollection;return e?[{type:\"text\",value:\"Id: \"+e.getId()},{type:\"value\",value:e.items}]:{type:\"text\",value:\"[Not executed yet]\"}},inputs:{items:{type:\"array\",displayName:\"Items\",group:\"General\",set(e){this.bindCollection(e),!1===this.isInputConnected(\"filter\")&&this.scheduleFilter()}},enabled:{type:\"boolean\",group:\"General\",displayName:\"Enabled\",default:!0,set(e){this._internal.enabled=e,!1===this.isInputConnected(\"filter\")&&this.scheduleFilter()}},filter:{type:\"signal\",group:\"Actions\",displayName:\"Filter\",valueChangedToTrue(){this.scheduleFilter()}}},outputs:{items:{type:\"array\",displayName:\"Items\",group:\"General\",getter(){return this._internal.filteredCollection}},firstItemId:{type:\"string\",displayName:\"First Record Id\",group:\"General\",getter(){if(void 0!==this._internal.filteredCollection){const e=this._internal.filteredCollection.get(0);if(void 0!==e)return e.getId()}}},count:{type:\"number\",displayName:\"Count\",group:\"General\",getter(){return this._internal.filteredCollection?this._internal.filteredCollection.size():0}},modified:{group:\"Events\",type:\"signal\",displayName:\"Filtered\"}},prototypeExtensions:{unbindCurrentCollection(){const e=this._internal.collection;e&&(e.off(\"change\",this._internal.collectionChangedCallback),this._internal.collection=void 0)},bindCollection(e){this.unbindCurrentCollection(),this._internal.collection=e,e&&e.on(\"change\",this._internal.collectionChangedCallback)},_onNodeDeleted(){Node.prototype._onNodeDeleted.call(this),this.unbindCurrentCollection(),CloudStore.instance.off(\"save\",this._internal.cloudStoreEvents)},getLimit(){const e=this._internal.filterSettings;return e.filterEnableLimit?e.filterLimit||10:void 0},getSkip(){const e=this._internal.filterSettings;return e.filterEnableLimit?e.filterSkip||0:void 0},scheduleFilter(){this.collectionChangedScheduled||(this.collectionChangedScheduled=!0,this.scheduleAfterInputsHaveUpdated((()=>{if(this.collectionChangedScheduled=!1,!this._internal.collection)return;let e=[].concat(this._internal.collection.items);if(this._internal.enabled){const t=this._internal.visualFilter;if(void 0!==t){const n=convertVisualFilter(t,{queryParameters:this._internal.filterParameters,collectionName:this._internal.collectionName});n&&(e=e.filter((e=>matchesQuery(e,n))))}const n=this._internal.visualSorting;if(void 0!==n&&n.length>0){const t=convertVisualSorting(n);t&&e.sort(compareObjects.bind(this,t))}const o=this.getSkip();o&&(e=e.slice(o,e.length));const i=this.getLimit();i&&(e=e.slice(0,i))}this._internal.filteredCollection=Collection.create(e),this.sendSignalOnOutput(\"modified\"),this.flagOutputDirty(\"firstItemId\"),this.flagOutputDirty(\"items\"),this.flagOutputDirty(\"count\")})))},setCollectionName(e){this._internal.collectionName=e},setVisualFilter(e){this._internal.visualFilter=e,!1===this.isInputConnected(\"filter\")&&this.scheduleFilter()},setVisualSorting(e){this._internal.visualSorting=e,!1===this.isInputConnected(\"filter\")&&this.scheduleFilter()},setFilterParameter:function(e,t){this._internal.filterParameters[e]=t,!1===this.isInputConnected(\"filter\")&&this.scheduleFilter()},registerInputIfNeeded(e){if(!this.hasInput(e))return\"collectionName\"===e?this.registerInput(e,{set:this.setCollectionName.bind(this)}):\"visualFilter\"===e?this.registerInput(e,{set:this.setVisualFilter.bind(this)}):\"visualSorting\"===e?this.registerInput(e,{set:this.setVisualSorting.bind(this)}):e.startsWith(\"fp-\")?this.registerInput(e,{set:this.setFilterParameter.bind(this,e.substring(3))}):void this.registerInput(e,{set(t){this._internal.filterSettings[e]=t,!1===this.isInputConnected(\"filter\")&&this.scheduleFilter()}})}}};function updatePorts$4(e,t,n,o){const i=[];if(i.push({name:\"collectionName\",type:{name:\"enum\",enums:void 0!==o?o.map((e=>({value:e.name,label:e.name}))):[],allowEditOnly:!0},displayName:\"Class\",plug:\"input\",group:\"General\"}),i.push({type:\"boolean\",plug:\"input\",group:\"Limit\",name:\"filterEnableLimit\",displayName:\"Use limit\"}),t.filterEnableLimit&&(i.push({type:\"number\",default:10,plug:\"input\",group:\"Limit\",name:\"filterLimit\",displayName:\"Limit\"}),i.push({type:\"number\",default:0,plug:\"input\",group:\"Limit\",name:\"filterSkip\",displayName:\"Skip\"})),void 0!==t.collectionName){const e=o.find((e=>e.name===t.collectionName));if(e&&e.schema&&e.schema.properties){const t=JSON.parse(JSON.stringify(e.schema)),n={Boolean:!0,String:!0,Date:!0,Number:!0,Pointer:!0};for(const e in t.properties)n[t.properties[e].type]||delete t.properties[e];i.push({name:\"visualFilter\",plug:\"input\",type:{name:\"query-filter\",schema:t,allowEditOnly:!0},displayName:\"Filter\",group:\"Filter\"}),i.push({name:\"visualSorting\",plug:\"input\",type:{name:\"query-sorting\",schema:t,allowEditOnly:!0},displayName:\"Sorting\",group:\"Sorting\"})}if(void 0!==t.visualFilter){const e={};_collectInputs(e,t.visualFilter),Object.keys(e).forEach((e=>{i.push({name:\"fp-\"+e,plug:\"input\",type:\"*\",displayName:e,group:\"Filter Parameters\"})}))}}n.sendDynamicPorts(e,i)}function setup$5(e,t){e.editorConnection&&e.editorConnection.isRunningLocally()&&t.on(\"nodeAdded.FilterDBModels\",(function(n){updatePorts$4(n.id,n.parameters,e.editorConnection,t.getMetaData(\"dbCollections\")),n.on(\"parameterUpdated\",(function(){updatePorts$4(n.id,n.parameters,e.editorConnection,t.getMetaData(\"dbCollections\"))})),t.on(\"metadataChanged.dbCollections\",(function(t){CloudStore.invalidateCollections(),updatePorts$4(n.id,n.parameters,e.editorConnection,t)})),t.on(\"metadataChanged.systemCollections\",(function(t){CloudStore.invalidateCollections(),updatePorts$4(n.id,n.parameters,e.editorConnection,t)}))}))}function _collectInputs(e,t){void 0!==t&&(void 0!==t.rules?t.rules.forEach((t=>_collectInputs(e,t))):void 0!==t.input&&(e[t.input]=!0))}var filterdbmodelsnode=Object.freeze({__proto__:null,node:node$l,setup:setup$5});const node$k={name:\"Model2\",docs:\"https://docs.noodl.net/nodes/data/object/object-node\",displayNodeName:\"Object\",shortDesc:\"Stores any amount of properties and can be used standalone or together with Collections and For Each nodes.\",category:\"Data\",usePortAsLabel:\"modelId\",color:\"data\",dynamicports:[{name:\"conditionalports/extended\",condition:\"idSource = explicit OR idSource NOT SET\",inputs:[\"modelId\"]}],initialize(){const e=this._internal;e.inputValues={},e.dirtyValues={},e.onModelChangedCallback=e=>{!0!==this.isInputConnected(\"fetch\")&&(this.hasOutput(\"prop-\"+e.name)&&this.flagOutputDirty(\"prop-\"+e.name),this.hasOutput(\"changed-\"+e.name)&&this.sendSignalOnOutput(\"changed-\"+e.name),this.sendSignalOnOutput(\"changed\"))}},getInspectInfo(){const e=this._internal.model;return e?[{type:\"text\",value:\"Id: \"+e.getId()},{type:\"value\",value:e.data}]:\"[No Object]\"},outputs:{id:{type:\"string\",displayName:\"Id\",group:\"General\",getter(){return this._internal.model?this._internal.model.getId():this._internal.modelId}},changed:{type:\"signal\",displayName:\"Changed\",group:\"Events\"},fetched:{type:\"signal\",displayName:\"Fetched\",group:\"Events\"}},inputs:{idSource:{type:{name:\"enum\",enums:[{label:\"Specify explicitly\",value:\"explicit\"},{label:\"From repeater\",value:\"foreach\"}],allowEditOnly:!0},default:\"explicit\",displayName:\"Get Id from\",group:\"General\",set(e){\"foreach\"===e&&this.scheduleAfterInputsHaveUpdated((()=>{let e=this.nodeScope.componentOwner;for(;void 0!==e&&void 0===e._forEachModel&&e.parentNodeScope;)e=e.parentNodeScope.componentOwner;this.setModel(void 0!==e?e._forEachModel:void 0)}))}},modelId:{type:{name:\"string\",identifierOf:\"ModelName\",identifierDisplayName:\"Object Ids\"},displayName:\"Id\",group:\"General\",set(e){e instanceof Model?e=e.getId():\"object\"==typeof e&&(e=Model.create(e).getId()),this._internal.modelId=e,!1===this.isInputConnected(\"fetch\")?this.setModelID(e):this.flagOutputDirty(\"id\")}},properties:{type:{name:\"stringlist\",allowEditOnly:!0},displayName:\"Properties\",group:\"Properties\",set(e){}},fetch:{displayName:\"Fetch\",group:\"Actions\",valueChangedToTrue(){this.scheduleSetModel()}}},prototypeExtensions:{scheduleStore(){if(this.hasScheduledStore)return;this.hasScheduledStore=!0;const e=this._internal;this.scheduleAfterInputsHaveUpdated((()=>{if(this.hasScheduledStore=!1,e.model){for(const t in e.dirtyValues)e.model.set(t,e.inputValues[t],{resolve:!0});e.dirtyValues={}}}))},scheduleSetModel(){this.hasScheduledSetModel||(this.hasScheduledSetModel=!0,this.scheduleAfterInputsHaveUpdated((()=>{this.hasScheduledSetModel=!1,this.setModelID(this._internal.modelId)})))},setModelID(e){const t=(this.nodeScope.modelScope||Model).get(e);this.setModel(t),this.sendSignalOnOutput(\"fetched\")},setModel(e){if(this._internal.model&&this._internal.model.off(\"change\",this._internal.onModelChangedCallback),this._internal.model=e,this.flagOutputDirty(\"id\"),e){e.on(\"change\",this._internal.onModelChangedCallback);for(const t in e.data)this.hasOutput(\"prop-\"+t)&&this.flagOutputDirty(\"prop-\"+t)}},_onNodeDeleted(){this._internal.model&&this._internal.model.off(\"change\",this._internal.onModelChangedCallback)},registerOutputIfNeeded(e){this.hasOutput(e)||e.startsWith(\"prop-\")&&this.registerOutput(e,{getter:userOutputGetter.bind(this,e.substring(5))})},registerInputIfNeeded(e){this.hasInput(e)||e.startsWith(\"prop-\")&&this.registerInput(e,{set:userInputSetter.bind(this,e.substring(5))})}}};function userOutputGetter(e){return this._internal.model?this._internal.model.get(e,{resolve:!0}):void 0}function userInputSetter(e,t){this._internal.inputValues[e]=t;const n=this._internal.model;(!n||n.get(e)!==t)&&(this._internal.dirtyValues[e]=!0,this.scheduleStore())}function updatePorts$3(e,t,n){const o=[],i=t.properties;if(i){const e=i?i.split(\",\"):void 0;if(e)for(const t of e)o.push({type:{name:\"*\",allowConnectionsOnly:!0},plug:\"input/output\",group:\"Properties\",name:\"prop-\"+t,displayName:t}),o.push({type:\"signal\",plug:\"output\",group:\"Changed Events\",displayName:t+\" Changed\",name:\"changed-\"+t})}n.sendDynamicPorts(e,o,{detectRenamed:{plug:\"input/output\"}})}function setup$4(e,t){e.editorConnection&&e.editorConnection.isRunningLocally()&&t.on(\"nodeAdded.Model2\",(function(t){updatePorts$3(t.id,t.parameters,e.editorConnection),t.on(\"parameterUpdated\",(function(){updatePorts$3(t.id,t.parameters,e.editorConnection)}))}))}var modelnode2=Object.freeze({__proto__:null,node:node$k,setup:setup$4});function _addBaseInfo(e){Object.assign(e.node,{category:\"Data\",color:\"data\"})}function _addModelId(e,t){const n=void 0===t||t.includeInputs,o=void 0===t||t.includeOutputs;Object.assign(e.node,{inputs:e.node.inputs||{},outputs:e.node.outputs||{},methods:e.node.methods||{}}),n&&(Object.assign(e.node,{usePortAsLabel:\"modelId\"}),e.node.dynamicports=(e.node.dynamicports||[]).concat([{name:\"conditionalports/extended\",condition:\"idSource = explicit OR idSource NOT SET\",inputs:[\"modelId\"]}]),Object.assign(e.node.inputs,{idSource:{type:{name:\"enum\",enums:[{label:\"Specify explicitly\",value:\"explicit\"},{label:\"From repeater\",value:\"foreach\"}],allowEditOnly:!0},default:\"explicit\",displayName:\"Id Source\",group:\"General\",set(e){\"foreach\"===e&&this.scheduleAfterInputsHaveUpdated((()=>{let e=this.nodeScope.componentOwner;for(;void 0!==e&&void 0===e._forEachModel&&e.parentNodeScope;)e=e.parentNodeScope.componentOwner;this.setModel(void 0!==e?e._forEachModel:void 0)}))}},modelId:{type:{name:\"string\",identifierOf:\"ModelName\",identifierDisplayName:\"Object Ids\"},displayName:\"Id\",group:\"General\",set:function(e){e instanceof Model&&(e=e.getId()),this._internal.modelId=e,this.setModelID(e)}}})),o&&Object.assign(e.node.outputs,{id:{type:\"string\",displayName:\"Id\",group:\"General\",getter:function(){return this._internal.model?this._internal.model.getId():this._internal.modelId}}}),Object.assign(e.node.methods,{setModelID:function(e){const t=(this.nodeScope.modelScope||Model).get(e);this.setModel(t)},setModel:function(e){this._internal.model=e,this.flagOutputDirty(\"id\")}}),e.node.getInspectInfo||(e.node.getInspectInfo=function(){const e=this._internal.model;return e?[{type:\"text\",value:\"Id: \"+e.getId()},{type:\"value\",value:e.data}]:\"[No Object]\"})}function _addInputProperties(def){const _def={node:Object.assign({},def.node),setup:def.setup},_methods=Object.assign({},def.node.methods);Object.assign(def.node,{inputs:def.node.inputs||{},outputs:def.node.outputs||{},methods:def.node.methods||{}}),Object.assign(def,{setup:function(e,t){e.editorConnection&&e.editorConnection.isRunningLocally()&&(t.on(\"nodeAdded.\"+def.node.name,(function(t){function n(){const n=[],o=[{label:\"String\",value:\"string\"},{label:\"Boolean\",value:\"boolean\"},{label:\"Number\",value:\"number\"},{label:\"Date\",value:\"date\"},{label:\"Array\",value:\"array\"},{label:\"Object\",value:\"object\"},{label:\"Any\",value:\"*\"}];let i=t.parameters.properties;if(i){i=i?i.split(\",\"):void 0;for(const e of i)n.push({type:{name:void 0===t.parameters[\"type-\"+e]?\"*\":t.parameters[\"type-\"+e]},plug:\"input\",group:\"Property Values\",displayName:e,name:\"prop-\"+e}),n.push({type:{name:\"enum\",enums:o,allowEditOnly:!0},plug:\"input\",group:\"Property Types\",displayName:e,default:\"*\",name:\"type-\"+e})}e.editorConnection.sendDynamicPorts(t.id,n,{detectRenamed:{plug:\"input\"}})}n(),t.on(\"parameterUpdated\",(function(){n()}))})),_def.setup&&_def.setup(e,t))}}),Object.assign(def.node,{initialize:function(){const e=this._internal;e.inputValues={},e.inputTypes={},_def.node.initialize&&_def.node.initialize.call(this)}}),Object.assign(def.node.outputs,{}),Object.assign(def.node.inputs,{properties:{type:{name:\"stringlist\",allowEditOnly:!0},displayName:\"Properties\",group:\"Properties to set\",set:function(){}}}),Object.assign(def.node.methods,{_pushInputValues:function(model){const internal=this._internal,_defaultValueForType={boolean:!1,string:\"\",number:0,date:new Date},_allKeys={};for(const e in internal.inputTypes)_allKeys[e]=!0;for(const e in internal.inputValues)_allKeys[e]=!0;const properties=this.model.parameters.properties||\"\",validProperties=properties.split(\",\"),keysToSet=Object.keys(_allKeys).filter((e=>-1!==validProperties.indexOf(e)));for(const i of keysToSet){let value=internal.inputValues[i];if(void 0!==value){if(void 0!==internal.inputTypes[i]&&\"array\"===internal.inputTypes[i]&&\"string\"==typeof value){this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name,this.id,\"invalid-array-\"+i);try{value=eval(value)}catch(e){-1!==value.indexOf(\"[\")||-1!==value.indexOf(\"{\")?(this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"invalid-array-\"+i,{showGlobally:!0,message:\"Invalid array<br>\"+e.toString()}),value=[]):value=Collection.get(value)}}void 0!==internal.inputTypes[i]&&\"object\"===internal.inputTypes[i]&&\"string\"==typeof value&&(value=(this.nodeScope.modelScope||Model).get(value)),model.set(i,value,{resolve:!0})}else model.set(i,_defaultValueForType[internal.inputTypes[i]],{resolve:!0})}},scheduleStore:function(){if(this.hasScheduledStore)return;this.hasScheduledStore=!0;const e=this._internal;this.scheduleAfterInputsHaveUpdated((()=>{this.hasScheduledStore=!1,e.model&&(this._pushInputValues(e.model),this.sendSignalOnOutput(\"stored\"))}))},registerInputIfNeeded:function(e){this.hasInput(e)||(e.startsWith(\"prop-\")&&this.registerInput(e,{set:this._setInputValue.bind(this,e.substring(5))}),e.startsWith(\"type-\")&&this.registerInput(e,{set:this._setInputType.bind(this,e.substring(5))}),_methods&&_methods.registerInputIfNeeded&&_def.node.methods.registerInputIfNeeded.call(this,e))},_setInputValue:function(e,t){this._internal.inputValues[e]=t},_setInputType:function(e,t){this._internal.inputTypes[e]=t}})}const SetModelPropertiedNodeDefinition={node:{name:\"SetModelProperties\",category:\"\",docs:\"https://docs.noodl.net/nodes/data/object/set-object-properties\",displayNodeName:\"Set Object Properties\",inputs:{store:{displayName:\"Do\",group:\"Actions\",valueChangedToTrue:function(){this.scheduleStore()}}},outputs:{stored:{type:\"signal\",displayName:\"Done\",group:\"Events\"}}}};_addBaseInfo(SetModelPropertiedNodeDefinition),_addModelId(SetModelPropertiedNodeDefinition),_addInputProperties(SetModelPropertiedNodeDefinition);const node$j=SetModelPropertiedNodeDefinition.node;var setmodelpropertiesnode=Object.freeze({__proto__:null,node:node$j});const NewModelNodeDefinition={node:{name:\"NewModel\",category:\"\",docs:\"https://docs.noodl.net/nodes/data/object/create-new-object\",displayNodeName:\"Create New Object\",inputs:{new:{displayName:\"Do\",group:\"Actions\",valueChangedToTrue(){this.scheduleNew()}}},outputs:{created:{type:\"signal\",displayName:\"Done\",group:\"Events\"}},methods:{scheduleNew(){this.hasScheduledNew||(this.hasScheduledNew=!0,this.scheduleAfterInputsHaveUpdated((()=>{this.hasScheduledNew=!1;const e=(this.nodeScope.modelScope||Model).get();this._pushInputValues(e),this.setModel(e),this.sendSignalOnOutput(\"created\")})))}}}};_addBaseInfo(NewModelNodeDefinition),_addModelId(NewModelNodeDefinition,{includeOutputs:!0}),_addInputProperties(NewModelNodeDefinition);const node$i=NewModelNodeDefinition.node;var newmodelnode=Object.freeze({__proto__:null,node:node$i});const node$h={name:\"Cloud File\",docs:\"https://docs.noodl.net/nodes/data/cloud-data/cloud-file\",category:\"Cloud Services\",color:\"data\",getInspectInfo(){var e;return null===(e=this._internal.cloudFile)||void 0===e?void 0:e.getUrl()},outputs:{url:{type:\"string\",displayName:\"URL\",group:\"General\",getter(){var e;return null===(e=this._internal.cloudFile)||void 0===e?void 0:e.getUrl()}},name:{type:\"string\",displayName:\"Name\",group:\"General\",getter(){if(!this._internal.cloudFile)return;const e=this._internal.cloudFile.getName().split(\"_\");return 1===e.length?e[0]:e.slice(1).join(\"_\")}}},inputs:{file:{type:\"cloudfile\",displayName:\"Cloud File\",group:\"General\",set(e){e instanceof CloudFile&&(this._internal.cloudFile=e,this.flagOutputDirty(\"name\"),this.flagOutputDirty(\"url\"))}}}};var cloudfilenode=Object.freeze({__proto__:null,node:node$h});class ConfigService{constructor(){this.cacheDuration=9e5}_makeRequest(e,t){if(\"undefined\"==typeof _noodl_cloud_runtime_version){const n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){let e;try{e=JSON.parse(n.response)}catch(e){}200===n.status||201===n.status?t.success(e):t.error(e||{error:n.responseText,status:n.status})}};const o=NoodlRuntime$1.instance.getMetaData(\"cloudservices\"),i=o.appId,s=o.endpoint;n.open(\"GET\",s+e,!0),n.setRequestHeader(\"X-Parse-Application-Id\",i),n.send()}else{const n=\"undefined\"!=typeof _noodl_cloudservices?_noodl_cloudservices.endpoint:this.endpoint,o=\"undefined\"!=typeof _noodl_cloudservices?_noodl_cloudservices.appId:this.appId,i=\"undefined\"!=typeof _noodl_cloudservices?_noodl_cloudservices.masterKey:void 0;fetch(n+e,{method:\"GET\",headers:{\"X-Parse-Application-Id\":o,\"X-Parse-Master-Key\":i}}).then((e=>{200===e.status||201===e.status?e.json().then((e=>t.success(e))).catch((e=>t.error({error:\"Config: Failed to get json result.\"}))):e.json().then((e=>t.error(e))).catch((e=>t.error({error:\"Failed to fetch.\"})))})).catch((e=>{t.error({error:e.message})}))}}_getConfig(){return new Promise(((e,t)=>{this._makeRequest(\"/config\",{success:t=>{e(t.params||{})},error:e=>{t(e)}})}))}async getConfig(){return this.configCachePending?this.configCachePending:this.configCache?(this.ttl&&Date.now()>this.ttl&&this._getConfig().then((e=>{this.configCache=e,this.ttl=Date.now()+this.cacheDuration})),this.configCache):(this.configCachePending=this._getConfig(),this.configCache=await this.configCachePending,delete this.configCachePending,this.ttl=Date.now()+this.cacheDuration,this.configCache)}clearCache(){delete this.configCache}}ConfigService.instance=new ConfigService;const ConfigNodeDefinition={name:\"DbConfig\",docs:\"https://docs.noodl.net/nodes/data/cloud-data/config\",displayNodeName:\"Config\",category:\"Cloud Services\",usePortAsLabel:\"configKey\",color:\"data\",initialize:function(){const e=this._internal;ConfigService.instance.getConfig().then((t=>{e.config=t,this.hasOutput(\"value\")&&this.flagOutputDirty(\"value\")}))},getInspectInfo(){const e=this.getValue();return void 0===e?\"[No Value]\":[{type:\"value\",value:e}]},methods:{getValue:function(){const e=this._internal;return e.useDevValue&&this.context.editorConnection&&this.context.editorConnection.isRunningLocally()?e.devValue:void 0!==e.config&&void 0!==e.configKey?e.config[e.configKey]:void 0},setInternal:function(e,t){this._internal[e]=t,this.hasOutput(\"value\")&&this.flagOutputDirty(\"value\")},registerOutputIfNeeded:function(e){if(!this.hasOutput(e))return\"value\"===e?this.registerOutput(e,{getter:this.getValue.bind(this)}):void 0},registerInputIfNeeded:function(e){if(!this.hasInput(e))return\"configKey\"===e||\"useDevValue\"===e||\"devValue\"===e?this.registerInput(e,{set:this.setInternal.bind(this,e)}):void 0}}},node$g=ConfigNodeDefinition;function setup$3(e,t){function n(n){const o=[];e.editorConnection.clearWarning(n.component.name,n.id,\"dbconfig-warning\");const i=t.getMetaData(\"dbConfigSchema\");let s;if(i){const t=void 0!==global._noodl_cloud_runtime_version;o.push({name:\"configKey\",displayName:\"Parameter\",group:\"General\",type:{name:\"enum\",enums:Object.keys(i).filter((e=>t||!i[e].masterKeyOnly)).map((e=>({value:e,label:e}))),allowEditOnly:!0},plug:\"input\"}),void 0!==n.parameters.configKey&&i&&i[n.parameters.configKey]?(s=i[n.parameters.configKey].type,\"string\"!==s&&\"boolean\"!==s&&\"number\"!==s&&\"object\"!==s&&\"array\"!==s||(o.push({name:\"useDevValue\",displayName:\"Enable\",group:\"Local Override\",type:\"boolean\",default:!1,plug:\"input\"}),!0===n.parameters.useDevValue&&o.push({name:\"devValue\",displayName:\"Value\",group:\"Local Override\",type:s,plug:\"input\"}))):void 0!==n.parameters.configKey&&e.editorConnection.sendWarning(n.component.name,n.id,\"dbconfig-warning\",{showGlobally:!0,message:n.parameters.configKey+\" config parameter is missing, add it to your cloud service.\"})}else e.editorConnection.sendWarning(n.component.name,n.id,\"dbconfig-warning\",{showGlobally:!0,message:\"You need an active cloud service.\"});o.push({name:\"value\",displayName:\"Value\",group:\"General\",type:s||\"*\",plug:\"output\"}),e.editorConnection.sendDynamicPorts(n.id,o)}function o(e){n(e),e.on(\"parameterUpdated\",(function(){n(e)})),t.on(\"metadataChanged.dbConfigSchema\",(function(){ConfigService.instance.clearCache(),n(e)}))}e.editorConnection&&e.editorConnection.isRunningLocally()&&t.on(\"editorImportComplete\",(()=>{t.on(\"nodeAdded.DbConfig\",(function(e){o(e)}));for(const e of t.getNodesWithType(\"DbConfig\"))o(e)}))}var dbconfig=Object.freeze({__proto__:null,node:node$g,setup:setup$3});function createDefinition(e){return{name:e.name,docs:e.docs,shortDesc:e.shortDesc,nodeDoubleClickAction:e.nodeDoubleClickAction,category:\"Variables\",initialize(){this._internal.currentValue=e.startValue,this._internal.latestValue=0},getInspectInfo(){return[{type:\"color\"===e.type.name?\"color\":\"text\",value:this._internal.currentValue}]},inputs:{value:{type:e.type,displayName:\"Value\",default:e.startValue,set(e){!1===this.isInputConnected(\"saveValue\")?this.setValueTo(e):this._internal.latestValue=e}},saveValue:{displayName:\"Set\",valueChangedToTrue(){this.scheduleAfterInputsHaveUpdated((function(){this.setValueTo(this._internal.latestValue),this.sendSignalOnOutput(\"stored\")}))}}},outputs:{savedValue:{type:e.type.name,displayName:\"Value\",getter(){return this._internal.currentValue}},changed:{type:\"signal\",displayName:\"Changed\"},stored:{type:\"signal\",displayName:\"Stored\"}},prototypeExtensions:{setValueTo(t){t=e.cast(t);const n=this._internal.currentValue!==t;this._internal.currentValue=t,n&&(this.flagOutputDirty(\"savedValue\"),this.sendSignalOnOutput(\"changed\"),e.onChanged&&e.onChanged.call(this))}}}}const node$f=createDefinition({name:\"Number\",docs:\"https://docs.noodl.net/nodes/data/number\",startValue:0,nodeDoubleClickAction:{focusPort:\"value\"},type:{name:\"number\"},cast:e=>Number(e)});var number=Object.freeze({__proto__:null,node:node$f});const StringNode=createDefinition({name:\"String\",docs:\"https://docs.noodl.net/nodes/data/string\",shortDesc:\"Contains a string (text).\",startValue:\"\",nodeDoubleClickAction:{focusPort:\"value\"},type:{name:\"string\"},cast:e=>String(e),onChanged:function(){this.flagOutputDirty(\"length\")}});extend(StringNode,{usePortAsLabel:\"value\",portLabelTruncationMode:\"length\",outputs:{length:{type:\"number\",displayName:\"Length\",getter:function(){return this._internal.currentValue.length}}}});const node$e=StringNode;var string=Object.freeze({__proto__:null,node:node$e});const node$d=createDefinition({name:\"Boolean\",docs:\"https://docs.noodl.net/nodes/data/boolean\",startValue:!1,type:{name:\"boolean\"},cast:e=>Boolean(e)});var boolean=Object.freeze({__proto__:null,node:node$d});const node$c={name:\"Condition\",docs:\"https://docs.noodl.net/nodes/utilities/logic/condition\",category:\"Logic\",initialize(){},getInspectInfo(){const e=this.getInputValue(\"condition\");let t;return t=void 0===e?\"[No input]\":e,[{type:\"value\",value:t}]},inputs:{condition:{type:\"boolean\",displayName:\"Condition\",group:\"General\",set(e){this.isInputConnected(\"eval\")||this.scheduleEvaluate()}},eval:{type:\"signal\",displayName:\"Evaluate\",group:\"Actions\",valueChangedToTrue(){this.scheduleEvaluate()}}},outputs:{ontrue:{type:\"signal\",displayName:\"On True\",group:\"Events\"},onfalse:{type:\"signal\",displayName:\"On False\",group:\"Events\"},result:{type:\"boolean\",displayName:\"Is True\",group:\"Booleans\",getter(){return!!this.getInputValue(\"condition\")}},isfalse:{type:\"boolean\",displayName:\"Is False\",group:\"Booleans\",getter(){return!this.getInputValue(\"condition\")}}},methods:{scheduleEvaluate(){this.scheduleAfterInputsHaveUpdated((()=>{this.flagOutputDirty(\"result\"),this.flagOutputDirty(\"isfalse\");const e=this.getInputValue(\"condition\");this.sendSignalOnOutput(e?\"ontrue\":\"onfalse\")}))}}};var condition=Object.freeze({__proto__:null,node:node$c});function and(e){return e.length>0&&!1===e.some((e=>!e))}const node$b={name:\"And\",docs:\"https://docs.noodl.net/nodes/logic/and\",category:\"Logic\",initialize(){this._internal={inputs:[]}},getInspectInfo(){return and(this._internal.inputs)},numberedInputs:{input:{displayPrefix:\"Input\",type:\"boolean\",createSetter:e=>function(t){const n=!!t;if(this._internal.inputs[e]===n)return;this._internal.inputs[e]=n;const o=and(this._internal.inputs);this._internal.result!==o&&(this._internal.result=o,this.flagOutputDirty(\"result\"))}}},outputs:{result:{type:\"boolean\",displayName:\"Result\",get(){return this._internal.result}}}};var and$1=Object.freeze({__proto__:null,node:node$b});function isTrue(e){return!!e}const node$a={name:\"Or\",docs:\"https://docs.noodl.net/nodes/logic/or\",category:\"Logic\",initialize(){this._internal.inputs=[]},getInspectInfo(){return this._internal.inputs.some(isTrue)},numberedInputs:{input:{type:\"boolean\",displayPrefix:\"Input\",createSetter:e=>function(t){this._internal.inputs[e]!==t&&(this._internal.inputs[e]=t,this.flagOutputDirty(\"result\"))}}},outputs:{result:{type:\"boolean\",displayName:\"Result\",getter:function(){return this._internal.inputs.some(isTrue)}}}};var or=Object.freeze({__proto__:null,node:node$a});const node$9={name:\"Boolean To String\",docs:\"https://docs.noodl.net/nodes/utilities/boolean-to-string\",category:\"Utilities\",initialize(){this._internal.inputs=[],this._internal.currentSelectedIndex=0,this._internal.indexChanged=!1,this._internal.trueString=\"\",this._internal.falseString=\"\"},inputs:{trueString:{displayName:\"String for true\",type:\"string\",set(e){this._internal.trueString!==e&&(this._internal.trueString=e,this._internal.currentInput&&this.flagOutputDirty(\"currentValue\"))}},falseString:{displayName:\"String for false\",type:\"string\",set(e){this._internal.falseString!==e&&(this._internal.falseString=e,this._internal.currentInput||this.flagOutputDirty(\"currentValue\"))}},input:{type:{name:\"boolean\"},displayName:\"Selector\",set(e){this._internal.currentInput!==e&&(this._internal.currentInput=e,this.flagOutputDirty(\"currentValue\"),this.sendSignalOnOutput(\"inputChanged\"))}}},outputs:{currentValue:{type:\"string\",displayName:\"Current Value\",group:\"Value\",getter(){return this._internal.currentInput?this._internal.trueString:this._internal.falseString}},inputChanged:{type:\"signal\",displayName:\"Selector Changed\",group:\"Signals\"}}};var booleantostring=Object.freeze({__proto__:null,node:node$9});const node$8={name:\"Date To String\",docs:\"https://docs.noodl.net/nodes/utilities/date-to-string\",category:\"Utilities\",initialize(){this._internal.formatString=\"{year}-{month}-{date}\"},inputs:{formatString:{displayName:\"Format\",type:\"string\",default:\"{year}-{month}-{date}\",set(e){this._internal.formatString!==e&&(this._internal.formatString=e,void 0!==this._internal.currentInput&&(this._format(),this.flagOutputDirty(\"currentValue\")))}},input:{type:{name:\"date\"},displayName:\"Date\",set(e){const t=\"string\"==typeof e?new Date(e):e;this._internal.currentInput!==t&&(this._internal.currentInput=t,this._format())}}},outputs:{currentValue:{type:\"string\",displayName:\"Date String\",group:\"Value\",getter(){return this._internal.dateString}},inputChanged:{type:\"signal\",displayName:\"Date Changed\",group:\"Signals\"},onError:{type:\"signal\",displayName:\"Invalid Date\",group:\"Signals\"}},methods:{_format(){try{const e=this._internal.currentInput,t=this._internal.formatString,n=(\"0\"+e.getDate()).slice(-2),o=(\"0\"+(e.getMonth()+1)).slice(-2),i=new Intl.DateTimeFormat(\"en-US\",{month:\"short\"}).format(e),s=e.getFullYear(),r=s.toString().substring(2),a=(\"0\"+e.getHours()).slice(-2),d=(\"0\"+e.getMinutes()).slice(-2),l=(\"0\"+e.getSeconds()).slice(-2);this._internal.dateString=t.replace(/\\{date\\}/g,n).replace(/\\{month\\}/g,String(o)).replace(/\\{monthShort\\}/g,i).replace(/\\{year\\}/g,String(s)).replace(/\\{yearShort\\}/g,String(r)).replace(/\\{hours\\}/g,String(a)).replace(/\\{minutes\\}/g,String(d)).replace(/\\{seconds\\}/g,String(l))}catch(e){this._internal.dateString=\"\",this.flagOutputDirty(\"onError\")}this.flagOutputDirty(\"currentValue\"),this.sendSignalOnOutput(\"inputChanged\")}}};var datetostring=Object.freeze({__proto__:null,node:node$8});const node$7={name:\"String Mapper\",docs:\"https://docs.noodl.net/nodes/string-manipulation/string-mapper\",category:\"Utilities\",initialize(){this._internal={inputs:[],mappings:[]}},getInspectInfo(){return this._internal.mappedString},numberedInputs:{input:{type:\"string\",displayPrefix:\"Input\",group:\"Inputs\",index:10,createSetter:e=>function(t){t=void 0===t?\"\":String(t),this._internal.inputs[e]=t,this.scheduleMapping()}},output:{type:\"string\",displayPrefix:\"Mapping\",index:1001,group:\"Mappings\",createSetter:e=>function(t){t=void 0===t?\"\":String(t),this._internal.mappings[e]=t,this.scheduleMapping()}}},inputs:{inputString:{type:{name:\"string\"},index:1,displayName:\"Input String\",set(e){this._internal.currentInputString=void 0!==e?String(e):void 0,this.scheduleMapping()}},defaultMapping:{type:\"string\",displayName:\"Default\",index:1e3,group:\"Mappings\",set(e){this._internal.defaultMapping=e,this.scheduleMapping()}}},outputs:{mappedString:{type:\"string\",displayName:\"Mapped String\",group:\"Value\",getter(){return this._internal.mappedString}}},prototypeExtensions:{doMapping(){this._internal.hasScheduledFetch=!1;const e=this._internal.inputs.indexOf(this._internal.currentInputString);this._internal.mappedString=-1!==e?this._internal.mappings[e]:this._internal.defaultMapping,this.flagOutputDirty(\"mappedString\")},scheduleMapping(){const e=this._internal;e.hasScheduledFetch||(e.hasScheduledFetch=!0,this.scheduleAfterInputsHaveUpdated(this.doMapping.bind(this)))}}};var stringmapper=Object.freeze({__proto__:null,node:node$7});function invert(e){if(void 0!==e)return!e}const node$6={name:\"Inverter\",docs:\"https://docs.noodl.net/nodes/logic/inverter\",category:\"Logic\",initialize(){this._internal.currentValue=void 0},getInspectInfo(){return String(invert(this._internal.currentValue))},inputs:{value:{type:{name:\"boolean\"},displayName:\"Value\",set(e){this._internal.currentValue=e,this.flagOutputDirty(\"result\")}}},outputs:{result:{type:\"boolean\",displayName:\"Result\",getter(){return invert(this._internal.currentValue)}}}};var inverter=Object.freeze({__proto__:null,node:node$6});const node$5={name:\"Substring\",docs:\"https://docs.noodl.net/nodes/string-manipulation/substring\",category:\"String Manipulation\",initialize(){var e=this._internal;e.startIndex=0,e.endIndex=-1,e.cachedResult=\"\",e.inputString=\"\",e.resultDirty=!1},inputs:{start:{type:\"number\",displayName:\"Start\",default:0,set(e){this._internal.startIndex=e,this._internal.resultDirty=!0,this.flagOutputDirty(\"result\")}},end:{type:\"number\",displayName:\"End\",default:0,set(e){this._internal.endIndex=e,this._internal.resultDirty=!0,this.flagOutputDirty(\"result\")}},string:{type:{name:\"string\"},displayName:\"String\",default:\"\",set(e){const t=String(e);this._internal.inputString=t,this._internal.resultDirty=!0,this.flagOutputDirty(\"result\")}}},outputs:{result:{type:\"string\",displayName:\"Result\",getter(){var e=this._internal;return e.resultDirty&&(-1===e.endIndex?e.cachedResult=e.inputString.substr(e.startIndex):e.cachedResult=e.inputString.substr(e.startIndex,e.endIndex-e.startIndex),e.resultDirty=!1),e.cachedResult}}}};var substring=Object.freeze({__proto__:null,node:node$5});const node$4={name:\"String Format\",docs:\"https://docs.noodl.net/nodes/string-manipulation/string-format\",category:\"String Manipulation\",usePortAsLabel:\"format\",portLabelTruncationMode:\"length\",initialize(){const e=this._internal;e.format=\"\",e.cachedResult=\"\",e.resultDirty=!1,e.inputValues={}},getInspectInfo(){return this.formatValue()},inputs:{format:{type:{name:\"string\",multiline:!0},displayName:\"Format\",set(e){this._internal.format!==e&&(this._internal.format=e,this._internal.resultDirty=!0,this.scheduleFormat())}}},outputs:{formatted:{type:\"string\",displayName:\"Formatted\",get(){return this.formatValue()}}},methods:{formatValue(){const e=this._internal;if(e.resultDirty){let t=e.format;const n=e.format.match(/\\{[A-Za-z0-9_]*\\}/g);let o=[];n&&(o=n.map((e=>e.replace(\"{\",\"\").replace(\"}\",\"\")))),o.forEach((n=>{const o=e.inputValues[n];t=t.replace(\"{\"+n+\"}\",void 0!==o?o:\"\")})),e.cachedResult=t,e.resultDirty=!1}return e.cachedResult},registerInputIfNeeded(e){this.hasInput(e)||this.registerInput(e,{set(t){this._internal.inputValues[e]!==t&&(this._internal.inputValues[e]=t,this._internal.resultDirty=!0,this.scheduleFormat())}})},scheduleFormat(){this.formatScheduled||(this.formatScheduled=!0,this.scheduleAfterInputsHaveUpdated((()=>{this.formatValue(),this.flagOutputDirty(\"formatted\"),this.formatScheduled=!1})))}}};function updatePorts$2(e,t,n){const o=(t.match(/\\{[A-Za-z0-9_]*\\}/g)||[]).map((e=>e.replace(\"{\",\"\").replace(\"}\",\"\"))).filter(((e,t,n)=>n.indexOf(e)===t)).map((e=>({name:e,type:\"string\",plug:\"input\"})));n.sendDynamicPorts(e,o)}function setup$2(e,t){e.editorConnection&&e.editorConnection.isRunningLocally()&&t.on(\"nodeAdded.String Format\",(t=>{t.parameters.format&&updatePorts$2(t.id,t.parameters.format,e.editorConnection),t.on(\"parameterUpdated\",(n=>{\"format\"===n.name&&updatePorts$2(t.id,t.parameters.format,e.editorConnection)}))}))}var stringformat=Object.freeze({__proto__:null,node:node$4,setup:setup$2});const node$3={name:\"Counter\",docs:\"https://docs.noodl.net/nodes/math/counter\",category:\"Math\",initialize(){this._internal.currentValue=0,this._internal.startValue=0,this._internal.startValueSet=!1,this._internal.limitsEnabled=!1,this._internal.limitsMin=0,this._internal.limitsMax=0},getInspectInfo(){return\"Count: \"+this._internal.currentValue},inputs:{increase:{group:\"Actions\",displayName:\"Increase Count\",valueChangedToTrue(){this._internal.limitsEnabled&&this._internal.currentValue>=this._internal.limitsMax||(this._internal.currentValue++,this.flagOutputDirty(\"currentCount\"),this.sendSignalOnOutput(\"countChanged\"))}},decrease:{group:\"Actions\",displayName:\"Decrease Count\",valueChangedToTrue(){this._internal.limitsEnabled&&this._internal.currentValue<=this._internal.limitsMin||(this._internal.currentValue--,this.flagOutputDirty(\"currentCount\"),this.sendSignalOnOutput(\"countChanged\"))}},reset:{group:\"Actions\",displayName:\"Reset To Start\",valueChangedToTrue(){0!==this.currentValue&&(this._internal.currentValue=this._internal.startValue,this.flagOutputDirty(\"currentCount\"),this.sendSignalOnOutput(\"countChanged\"))}},startValue:{type:\"number\",displayName:\"Start Value\",default:0,set(e){this._internal.startValue=Number(e),!1===this._internal.startValueSet&&(this._internal.startValueSet=!0,this._internal.currentValue=this._internal.startValue,this.flagOutputDirty(\"currentCount\"),this.sendSignalOnOutput(\"countChanged\"))}},limitsMin:{type:{name:\"number\"},displayName:\"Min Value\",group:\"Limits\",default:0,set(e){this._internal.limitsMin=Number(e)}},limitsMax:{type:{name:\"number\"},displayName:\"Max Value\",group:\"Limits\",default:0,set(e){this._internal.limitsMax=Number(e)}},limitsEnabled:{type:{name:\"boolean\"},displayName:\"Limits Enabled\",group:\"Limits\",default:!1,set(e){this._internal.limitsEnabled=!!e}}},outputs:{currentCount:{displayName:\"Current Count\",type:\"number\",getter(){return this._internal.currentValue}},countChanged:{displayName:\"Count Changed\",type:\"signal\"}}};var counter=Object.freeze({__proto__:null,node:node$3});const node$2={name:\"Unique Id\",docs:\"https://docs.noodl.net/nodes/utilities/unique-id\",category:\"String Manipulation\",initialize(){this._internal.guid=guid()},getInspectInfo(){return this._internal.guid},inputs:{new:{displayName:\"New\",valueChangedToTrue:function(){this._internal.guid=guid(),this.flagOutputDirty(\"guid\")}}},outputs:{guid:{type:\"string\",displayName:\"Id\",getter:function(){return this._internal.guid}}},prototypeExtensions:{}};var uniqueid=Object.freeze({__proto__:null,node:node$2});const node$1={name:\"net.noodl.user.SetUserProperties\",docs:\"https://docs.noodl.net/nodes/data/user/set-user-properties\",displayNodeName:\"Set User Properties\",category:\"Cloud Services\",color:\"data\",initialize(){this._internal.userProperties={}},outputs:{success:{type:\"signal\",displayName:\"Success\",group:\"Events\"},failure:{type:\"signal\",displayName:\"Failure\",group:\"Events\"},error:{type:\"string\",displayName:\"Error\",group:\"Error\",getter(){return this._internal.error}}},inputs:{store:{displayName:\"Do\",group:\"Actions\",valueChangedToTrue(){this.scheduleStore()}},email:{displayName:\"Email\",type:\"string\",group:\"General\",set(e){this._internal.email=e}},username:{displayName:\"Username\",type:\"string\",group:\"General\",set(e){this._internal.username=e}}},methods:{setError(e){this._internal.error=e,this.flagOutputDirty(\"error\"),this.sendSignalOnOutput(\"failure\"),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"user-set-warning\",{message:e,showGlobally:!0})},clearWarnings(){this.context.editorConnection&&this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name,this.id,\"user-set-warning\")},scheduleStore(){const e=this._internal;!0!==this.storeScheduled&&(this.storeScheduled=!0,this.scheduleAfterInputsHaveUpdated((()=>{this.storeScheduled=!1;NoodlRuntime.Services.UserService.forScope(this.nodeScope.modelScope).setUserProperties({email:this._internal.email,username:this._internal.username,properties:e.userProperties,success:()=>{this.sendSignalOnOutput(\"success\")},error:e=>{this.setError(e)}})})))},setUserProperty(e,t){this._internal.userProperties[e]=t},registerInputIfNeeded(e){if(!this.hasInput(e))return e.startsWith(\"prop-\")?this.registerInput(e,{set:this.setUserProperty.bind(this,e.substring(5))}):void 0}}};function updatePorts$1(e,t,n,o){const i=[];if(o){const e=o.find((e=>\"_User\"===e.name));if(e&&e.schema&&e.schema.properties){const t=e.schema.properties,n=\"undefined\"==typeof _noodl_cloud_runtime_version?[\"authData\",\"createdAt\",\"updatedAt\",\"email\",\"username\",\"emailVerified\",\"password\"]:[\"authData\",\"createdAt\",\"updatedAt\",\"email\",\"username\"];for(const e in t){if(-1!==n.indexOf(e))continue;const o=t[e];if(!i.find((t=>t.name===e)))if(\"Relation\"===o.type);else{const t={String:\"string\",Boolean:\"boolean\",Number:\"number\",Date:\"date\"};i.push({type:{name:t[o.type]?t[o.type]:\"*\"},plug:\"input\",group:\"Properties\",name:\"prop-\"+e,displayName:e})}}}}n.sendDynamicPorts(e,i)}function setup$1(e,t){function n(n){updatePorts$1(n.id,n.parameters,e.editorConnection,t.getMetaData(\"systemCollections\")),n.on(\"parameterUpdated\",(function(o){updatePorts$1(n.id,n.parameters,e.editorConnection,t.getMetaData(\"systemCollections\"))})),t.on(\"metadataChanged.systemCollections\",(function(t){updatePorts$1(n.id,n.parameters,e.editorConnection,t)}))}e.editorConnection&&e.editorConnection.isRunningLocally()&&t.on(\"editorImportComplete\",(()=>{t.on(\"nodeAdded.net.noodl.user.SetUserProperties\",(function(e){n(e)}));for(const e of t.getNodesWithType(\"net.noodl.user.SetUserProperties\"))n(e)}))}var setuserproperties=Object.freeze({__proto__:null,node:node$1,setup:setup$1});const node={name:\"net.noodl.user.User\",docs:\"https://docs.noodl.net/nodes/data/user/user-node\",displayNodeName:\"User\",category:\"Cloud Services\",color:\"data\",initialize(){const e=this;this._internal.onModelChangedCallback=function(t){e.isInputConnected(\"fetch\")||(e.hasOutput(\"prop-\"+t.name)&&e.flagOutputDirty(\"prop-\"+t.name),e.hasOutput(\"changed-\"+t.name)&&e.sendSignalOnOutput(\"changed-\"+t.name),e.sendSignalOnOutput(\"changed\"))};const t=NoodlRuntime.Services.UserService.forScope(this.nodeScope.modelScope);this.setUserModel(t.current),t.on(\"loggedIn\",(()=>{this.setUserModel(t.current),this.hasOutput(\"loggedIn\")&&this.sendSignalOnOutput(\"loggedIn\")})),t.on(\"sessionGained\",(()=>{this.setUserModel(t.current)})),t.on(\"loggedOut\",(()=>{this.setUserModel(void 0),this.hasOutput(\"loggedOut\")&&this.sendSignalOnOutput(\"loggedOut\")})),t.on(\"sessionLost\",(()=>{this.setUserModel(void 0),this.hasOutput(\"sessionLost\")&&this.sendSignalOnOutput(\"sessionLost\")}))},getInspectInfo(){const e=this._internal.model;return e?[{type:\"text\",value:\"Id: \"+e.getId()},{type:\"value\",value:this._internal.model.data}]:\"[No Model]\"},outputs:{id:{type:\"string\",displayName:\"Id\",group:\"General\",getter(){return void 0!==this._internal.model?this._internal.model.getId():void 0}},fetched:{type:\"signal\",displayName:\"Fetched\",group:\"Events\"},changed:{type:\"signal\",displayName:\"Changed\",group:\"Events\"},failure:{type:\"signal\",displayName:\"Failure\",group:\"Events\"},error:{type:\"string\",displayName:\"Error\",group:\"Error\",getter(){return this._internal.error}},username:{type:\"string\",displayName:\"Username\",group:\"General\",getter(){return void 0!==this._internal.model?this._internal.model.get(\"username\"):void 0}},email:{type:\"string\",displayName:\"Email\",group:\"General\",getter(){return void 0!==this._internal.model?this._internal.model.get(\"email\"):void 0}},authenticated:{type:\"boolean\",displayName:\"Authenticated\",group:\"General\",getter(){return void 0!==this._internal.model}}},inputs:{fetch:{displayName:\"Fetch\",group:\"Actions\",valueChangedToTrue(){this.scheduleFetch()}}},methods:{_onNodeDeleted(){Node.prototype._onNodeDeleted.call(this),this._internal.model&&this._internal.model.off(\"change\",this._internal.onModelChangedCallback)},scheduleOnce(e,t){const n=this,o=\"hasScheduled\"+e;this._internal[o]||(this._internal[o]=!0,this.scheduleAfterInputsHaveUpdated((function(){n._internal[o]=!1,t()})))},setError(e){this._internal.error=e,this.flagOutputDirty(\"error\"),this.sendSignalOnOutput(\"failure\"),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,\"user-warning\",{message:e,showGlobally:!0})},clearWarnings(){this.context.editorConnection&&this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name,this.id,\"user-warning\")},setUserModel(e){const t=this._internal;if(t.model!==e&&(t.model&&t.model.off(\"change\",t.onModelChangedCallback),t.model=e,e&&e.on(\"change\",t.onModelChangedCallback)),this.flagOutputDirty(\"id\"),this.flagOutputDirty(\"authenticated\"),this.flagOutputDirty(\"email\"),this.flagOutputDirty(\"username\"),e)for(const t in e.data)this.hasOutput(\"prop-\"+t)&&this.flagOutputDirty(\"prop-\"+t)},scheduleFetch(){this._internal,this.scheduleOnce(\"Fetch\",(()=>{const e=NoodlRuntime.Services.UserService.forScope(this.nodeScope.modelScope);e.fetchCurrentUser({success:t=>{this.setUserModel(e.current),this.sendSignalOnOutput(\"fetched\")},error:e=>{this.setError(e||\"Failed to fetch.\")}})}))},registerOutputIfNeeded(e){this.hasOutput(e)||(\"loggedOut\"!==e&&\"loggedIn\"!==e&&\"sessionLost\"!==e?e.startsWith(\"prop-\")&&this.registerOutput(e,{getter:this.getUserProperty.bind(this,e.substring(5))}):this.registerOutput(e,{getter:()=>{}}))},getUserProperty(e){return void 0!==this._internal.model?this._internal.model.get(e):void 0}}};function updatePorts(e,t,n,o){const i=[];if(o){const e=o.find((e=>\"_User\"===e.name));if(e&&e.schema&&e.schema.properties){const t=e.schema.properties,n=[\"authData\",\"password\",\"username\",\"email\"];for(const e in t){if(-1!==n.indexOf(e))continue;const o=t[e];if(!i.find((t=>t.name===e)))if(\"Relation\"===o.type);else{const t={String:\"string\",Boolean:\"boolean\",Number:\"number\",Date:\"date\"};i.push({type:{name:t[o.type]?t[o.type]:\"*\"},plug:\"output\",group:\"Properties\",name:\"prop-\"+e,displayName:e}),i.push({type:\"signal\",plug:\"output\",group:\"Changed Events\",displayName:e+\" Changed\",name:\"changed-\"+e})}}}}\"undefined\"==typeof _noodl_cloud_runtime_version&&(i.push({plug:\"output\",name:\"loggedIn\",type:\"signal\",displayName:\"Logged In\",group:\"Events\"}),i.push({plug:\"output\",name:\"loggedOut\",type:\"signal\",displayName:\"Logged Out\",group:\"Events\"}),i.push({plug:\"output\",name:\"sessionLost\",type:\"signal\",displayName:\"Session Lost\",group:\"Events\"})),n.sendDynamicPorts(e,i)}function setup(e,t){function n(n){updatePorts(n.id,n.parameters,e.editorConnection,t.getMetaData(\"systemCollections\")),n.on(\"parameterUpdated\",(function(o){updatePorts(n.id,n.parameters,e.editorConnection,t.getMetaData(\"systemCollections\"))})),t.on(\"metadataChanged.systemCollections\",(function(t){updatePorts(n.id,n.parameters,e.editorConnection,t)}))}e.editorConnection&&e.editorConnection.isRunningLocally()&&t.on(\"editorImportComplete\",(()=>{t.on(\"nodeAdded.net.noodl.user.User\",(function(e){n(e)}));for(const e of t.getNodesWithType(\"net.noodl.user.User\"))n(e)}))}var user=Object.freeze({__proto__:null,node:node,setup:setup});function registerNodes(e){[componentinputs,componentoutputs,runtasks,restnode,expression,simplejavascript,dbcollectionnode2,dbmodelnode2,setdbmodelpropertiesnode,deletedbmodelpropertiesnode,newdbmodelpropertiesnode,dbmodelnodeAddrelation,dbmodelnodeRemoverelation,filterdbmodelsnode,modelnode2,setmodelpropertiesnode,newmodelnode,cloudfilenode,dbconfig,number,string,boolean,condition,and$1,or,booleantostring,datetostring,stringmapper,inverter,substring,stringformat,counter,uniqueid,setuserproperties,user].forEach((t=>e.registerNode(t)))}class NoodlRuntime$1{constructor(e){if(e.platform=e.platform||{},NoodlRuntime$1.instance=this,this.type=e.type||\"browser\",this.noodlModules=[],this.eventEmitter=new EventEmitter,this.updateScheduled=!1,this.rootComponent=null,this._currentLoadedData=null,this.isWaitingForExport=!0,this.graphModel=new GraphModel,this.errorHandlers=[],this.frameNumber=0,this.dontCreateRootComponent=!!e.dontCreateRootComponent,this.componentFilter=e.componentFilter,this.runningInEditor=!e.runDeployed,this.platform={requestUpdate:e.platform.requestUpdate,getCurrentTime:e.platform.getCurrentTime,webSocketOptions:e.platform.webSocketOptions,objectToString:e.platform.objectToString},!e.platform.requestUpdate)throw new Error(\"platform.requestUpdate must be set\");if(!e.platform.getCurrentTime)throw new Error(\"platform.getCurrentTime must be set\");this.editorConnection=new EditorConnection({platform:e.platform,runtimeType:this.type}),this.context=new NodeContext({runningInEditor:!e.runDeployed,editorConnection:this.editorConnection,platform:this.platform,graphModel:this.graphModel}),this.context.eventEmitter.on(\"scheduleUpdate\",this.scheduleUpdate.bind(this)),e.runDeployed||this._setupEditorCommunication(e),this.registerGraphModelListeners(),registerNodes(this)}async prefetchBundles(e,t){await asyncPool(t,e,(async e=>{await this.context.fetchComponentBundle(e)}))}_setupEditorCommunication(e){function t(e,n){if(null==e||null==n)return e===n;if(e===n)return!0;if(Array.isArray(e)&&e.length!==n.length)return!1;if(!(e instanceof Object))return!1;if(!(n instanceof Object))return!1;const o=Object.keys(e);return Object.keys(n).every((e=>-1!==o.indexOf(e)))&&o.every((o=>t(e[o],n[o])))}this.editorConnection.on(\"exportDataFull\",(async e=>{if(!1!==this.graphModel.isEmpty()){if(this.isWaitingForExport=!1,!1===t(this._currentLoadedData,e)){if(this.componentFilter&&(e.components=e.components.filter((e=>this.componentFilter(e)))),await this.setData(e),e.componentIndex){const t=Object.keys(e.componentIndex);await this.prefetchBundles(t,2)}this.graphModel.emit(\"editorImportComplete\")}}else this.reload()})),this.editorConnection.on(\"reload\",this.reload.bind(this)),this.editorConnection.on(\"modelUpdate\",this.onModelUpdateReceived.bind(this)),this.editorConnection.on(\"metadataUpdate\",this.onMetaDataUpdateReceived.bind(this)),this.editorConnection.on(\"connected\",(()=>{this.sendNodeLibrary()}))}setDebugInspectorsEnabled(e){this.context.setDebugInspectorsEnabled(e)}registerModule(e){if(e.nodes)for(let t of e.nodes)t.node||(t={node:t}),t.node.module=e.name||\"Unknown Module\",this.registerNode(t);this.noodlModules.push(e)}registerGraphModelListeners(){this.graphModel.on(\"componentAdded\",(e=>{this.context.registerComponentModel(e)}),this),this.graphModel.on(\"componentRemoved\",(e=>{this.context.deregisterComponentModel(e)}),this)}reload(){location.reload()}registerNode(e){if(e.node){const t=defineNode(e.node);this.context.nodeRegister.register(t),t.setupNumberedInputDynamicPorts&&t.setupNumberedInputDynamicPorts(this.context,this.graphModel)}else this.context.nodeRegister.register(e.node);e.setup&&e.setup(this.context,this.graphModel)}async _setRootComponent(e){this.rootComponent&&this.rootComponent.name===e||(this.rootComponent&&(this.rootComponent.model&&this.rootComponent.model.removeListenersWithRef(this),this.rootComponent=void 0),e&&(this.rootComponent=await this.context.createComponentInstanceNode(e,\"rootComponent\",null),this.rootComponent.componentModel.on(\"rootAdded\",(()=>this.eventEmitter.emit(\"rootComponentUpdated\")),this),this.rootComponent.componentModel.on(\"rootRemoved\",(()=>this.eventEmitter.emit(\"rootComponentUpdated\")),this),this.context.setRootComponent(this.rootComponent)),this.eventEmitter.emit(\"rootComponentUpdated\"))}async setData(e){if(!this._disableLoad){this._currentLoadedData=e,await this.graphModel.importEditorData(e);for(const e of this.noodlModules)\"function\"==typeof e.setup&&e.setup();!0!==this.dontCreateRootComponent&&(await this._setRootComponent(this.graphModel.rootComponent||null),this.graphModel.on(\"rootComponentNameUpdated\",(e=>{this._setRootComponent(e)})),this.graphModel.on(\"componentRemoved\",(e=>{this.rootComponent&&this.rootComponent.name===e.name&&this._setRootComponent(null)})),this.graphModel.on(\"componentAdded\",(e=>{setTimeout((()=>{this.rootComponent||this.graphModel.rootComponent!==e.name||this._setRootComponent(e.name)}),1)}))),this.scheduleUpdate()}}scheduleUpdate(){var e,t;this.updateScheduled||(this.updateScheduled=!0,null===(t=(e=this.platform).requestUpdate)||void 0===t||t.call(e,this._doUpdate.bind(this)))}_doUpdate(){this.updateScheduled=!1,this.context.currentFrameTime=this.platform.getCurrentTime(),this.context.eventEmitter.emit(\"frameStart\"),this.context.update(),this.context.eventEmitter.emit(\"frameEnd\"),this.frameNumber++}setProjectSettings(e){this.projectSettings=e}getNodeLibrary(){const e=generateProjectSettings(this.graphModel.getSettings(),this.noodlModules);this.projectSettings&&(this.projectSettings.ports&&(e.ports=e.ports.concat(this.projectSettings.ports)),this.projectSettings.dynamicports&&(e.dynamicports=e.ports.concat(this.projectSettings.dynamicports)));const t=generateNodeLibrary(this.context.nodeRegister);return t.projectsettings=e,JSON.stringify(t,null,3)}sendNodeLibrary(){const e=this.getNodeLibrary();this.lastSentNodeLibrary!==e&&(this.lastSentNodeLibrary=e,this.editorConnection.sendNodeLibrary(e))}connectToEditor(e){this.editorConnection.connect(e)}onMetaDataUpdateReceived(e){this.graphModel.isEmpty()||handleEvent(this.context,this.graphModel,e)}async onModelUpdateReceived(e){this.isWaitingForExport||(\"projectInstanceChanged\"===e.type?this.reload():!1===this.graphModel.isEmpty()&&await handleEvent(this.context,this.graphModel,e))}addErrorHandler(e){this.errorHandlers.push(e)}reportError(e){this.errorHandlers.forEach((t=>{t(e)}))}getProjectSettings(){return this.graphModel.getSettings()}getMetaData(e){return this.graphModel.getMetaData(e)}}function createRecordsAPI(e){let t;const n=()=>(t||(t=new CloudStore(e)),t);return{async query(t,o,i){if(void 0===t)throw new Error(\"'className' is undefined\");return new Promise(((s,r)=>{n().query({collection:t,where:convertFilterOp(o||{},{collectionName:t,error:e=>r(e),modelScope:e}),limit:null==i?void 0:i.limit,sort:null==i?void 0:i.sort,skip:null==i?void 0:i.skip,include:null==i?void 0:i.include,select:null==i?void 0:i.select,count:null==i?void 0:i.count,success:(e,o)=>{const i=e.map((e=>n()._fromJSON(e,t)));s(void 0!==o?{results:i,count:o}:i)},error:e=>{r(Error(e||\"Failed to query.\"))}})}))},async count(t,o){if(void 0===t)throw new Error(\"'className' is undefined\");return new Promise(((i,s)=>{n().count({collection:t,where:o?convertFilterOp(o||{},{collectionName:t,error:e=>s(e),modelScope:e}):void 0,success:e=>{i(e)},error:e=>{s(Error(e||\"Failed to query.\"))}})}))},async distinct(t,o,i){if(void 0===t)throw new Error(\"'className' is undefined\");return new Promise(((s,r)=>{n().distinct({collection:t,property:o,where:i?convertFilterOp(i||{},{collectionName:t,error:e=>r(e),modelScope:e}):void 0,success:e=>{s(e)},error:e=>{r(Error(e||\"Failed to query.\"))}})}))},async aggregate(t,o,i){if(void 0===t)throw new Error(\"'className' is undefined\");return new Promise(((s,r)=>{n().aggregate({collection:t,group:o,where:i?convertFilterOp(i||{},{collectionName:t,error:e=>r(e),modelScope:e}):void 0,success:e=>{s(e)},error:e=>{r(Error(e||\"Failed to aggregate.\"))}})}))},async fetch(t,o){if(void 0===t)return Promise.reject(new Error(\"'objectOrId' is undefined.\"));const i=\"string\"==typeof t?t:t.getId(),s=(null==o?void 0:o.className)||(e||Model).get(i)._class;return new Promise(((e,t)=>{if(!s)return t(\"No class name specified\");n().fetch({collection:s,objectId:i,keys:null==o?void 0:o.keys,include:null==o?void 0:o.include,excludeKeys:null==o?void 0:o.excludeKeys,success:function(t){const o=n()._fromJSON(t,s);e(o)},error:function(e){t(Error(e||\"Failed to fetch.\"))}})}))},async increment(t,o,i){if(void 0===t)return Promise.reject(new Error(\"'objectOrId' is undefined.\"));const s=\"string\"==typeof t?t:t.getId(),r=(null==i?void 0:i.className)||(e||Model).get(s)._class;return new Promise(((e,t)=>{if(!r)return t(\"No class name specified\");n().increment({collection:r,objectId:s,properties:o,success:t=>{n()._fromJSON(Object.assign({objectId:s},t),r),e()},error:e=>{t(Error(e||\"Failed to increment.\"))}})}))},async save(t,o,i){if(void 0===t)return Promise.reject(new Error(\"'objectOrId' is undefined.\"));const s=\"string\"==typeof t?t:t.getId(),r=(null==i?void 0:i.className)||(e||Model).get(s)._class,a=(e||Model).get(s);return o&&Object.keys(o).forEach((e=>{a.set(e,o[e])})),new Promise(((e,t)=>{if(!r)return t(\"No class name specified\");n().save({collection:r,objectId:s,data:o||a.data,acl:null==i?void 0:i.acl,success:t=>{n()._fromJSON(Object.assign({objectId:s},t),r),e()},error:e=>{t(Error(e||\"Failed to save.\"))}})}))},async create(e,t,o){if(void 0===e)throw new Error(\"'className' is undefined\");return new Promise(((i,s)=>{n().create({collection:e,data:t,acl:null==o?void 0:o.acl,success:t=>{const o=n()._fromJSON(t,e);i(o)},error:e=>{s(Error(e||\"Failed to insert.\"))}})}))},async delete(t,o){if(void 0===t)return Promise.reject(new Error(\"'objectOrId' is undefined.\"));const i=\"string\"==typeof t?t:t.getId(),s=(null==o?void 0:o.className)||(e||Model).get(i)._class;return new Promise(((t,o)=>{if(!s)return o(\"No class name specified\");n().delete({collection:s,objectId:i,success:()=>{(e||Model).get(i).notify(\"delete\"),t()},error:e=>{o(Error(e||\"Failed to delete.\"))}})}))},async addRelation(t){var o,i;const s=t.recordId||(null===(o=t.record)||void 0===o?void 0:o.getId()),r=t.className||(e||Model).get(s)._class,a=t.targetRecordId||(null===(i=t.targetRecord)||void 0===i?void 0:i.getId()),d=t.targetClassName||(e||Model).get(a)._class;return new Promise(((e,o)=>r?d?void n().addRelation({collection:r,objectId:s,key:t.key,targetObjectId:a,targetClass:d,success:()=>{e()},error:e=>{o(Error(e||\"Failed to add relation.\"))}}):o(\"No target class name specified\"):o(\"No class name specified\")))},async removeRelation(t){var o,i;const s=t.recordId||(null===(o=t.record)||void 0===o?void 0:o.getId()),r=t.className||(e||Model).get(s)._class,a=t.targetRecordId||(null===(i=t.targetRecord)||void 0===i?void 0:i.getId()),d=t.targetClassName||(e||Model).get(a)._class;return new Promise(((e,o)=>r?d?void n().removeRelation({collection:r,objectId:s,key:t.key,targetObjectId:a,targetClass:d,success:()=>{e()},error:e=>{o(Error(e||\"Failed to add relation.\"))}}):o(\"No target class name specified\"):o(\"No class name specified\")))}}}NoodlRuntime$1.Services=Services,NoodlRuntime$1.Node=Node$1,NoodlRuntime$1.NodeDefinition={defineNode:defineNode},NoodlRuntime$1.EdgeTriggeredInput=createSetter;export{Collection,ComponentModel,EditorConnection,GraphModel,JavascriptNodeParser,Model,ModelScope,Node$1 as Node,NodeContext,NodeModel,NodeScope,Services,TimerScheduler,createRecordsAPI,createSetter,NoodlRuntime$1 as default,defineNode,extend,getAbsoluteUrl,guid,logJavaScriptNodeError,randomString};\n//# sourceMappingURL=noodl-runtime.esm.js.map\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array ? array.length : 0;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\n/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array ? array.length : 0;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array ? array.length : 0,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\n/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\n/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  if (value !== value) {\n    return baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\n/**\n * Checks if a cache value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    splice = arrayProto.splice,\n    spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map'),\n    nativeCreate = getNative(Object, 'create');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values ? values.length : 0;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = array;\n    return apply(func, this, otherArgs);\n  };\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Creates an array of `array` values not included in the other given arrays\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons. The order of result values is determined by the\n * order they occur in the first array.\n *\n * **Note:** Unlike `_.pullAll`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {...Array} [values] The values to exclude.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.without, _.xor\n * @example\n *\n * _.difference([2, 1], [2, 3]);\n * // => [1]\n */\nvar difference = baseRest(function(array, values) {\n  return isArrayLikeObject(array)\n    ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))\n    : [];\n});\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nfunction isArguments(value) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&\n    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\nmodule.exports = difference;\n","/**\n * BezierEasing - use bezier curve for transition easing function\n * by Gatan Renaudeau 2014 - 2015  MIT License\n *\n * Credits: is based on Firefox's nsSMILKeySpline.cpp\n * Usage:\n * var spline = BezierEasing([ 0.25, 0.1, 0.25, 1.0 ])\n * spline.get(x) => returns the easing value | x must be in [0, 1] range\n *\n */\n\n// These values are established by empiricism with tests (tradeoff: performance VS precision)\nvar NEWTON_ITERATIONS = 4;\nvar NEWTON_MIN_SLOPE = 0.001;\nvar SUBDIVISION_PRECISION = 0.0000001;\nvar SUBDIVISION_MAX_ITERATIONS = 10;\n\nvar kSplineTableSize = 11;\nvar kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\nvar float32ArraySupported = typeof Float32Array === \"function\";\n\nfunction A (aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1; }\nfunction B (aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1; }\nfunction C (aA1)      { return 3.0 * aA1; }\n\n// Returns x(t) given t, x1, and x2, or y(t) given t, y1, and y2.\nfunction calcBezier (aT, aA1, aA2) {\n  return ((A(aA1, aA2)*aT + B(aA1, aA2))*aT + C(aA1))*aT;\n}\n\n// Returns dx/dt given t, x1, and x2, or dy/dt given t, y1, and y2.\nfunction getSlope (aT, aA1, aA2) {\n  return 3.0 * A(aA1, aA2)*aT*aT + 2.0 * B(aA1, aA2) * aT + C(aA1);\n}\n\nfunction binarySubdivide (aX, aA, aB, mX1, mX2) {\n  var currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2.0;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0.0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (Math.abs(currentX) > SUBDIVISION_PRECISION && ++i < SUBDIVISION_MAX_ITERATIONS);\n  return currentT;\n}\n\nfunction newtonRaphsonIterate (aX, aGuessT, mX1, mX2) {\n  for (var i = 0; i < NEWTON_ITERATIONS; ++i) {\n    var currentSlope = getSlope(aGuessT, mX1, mX2);\n    if (currentSlope === 0.0) return aGuessT;\n    var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n    aGuessT -= currentX / currentSlope;\n  }\n  return aGuessT;\n}\n\n/**\n * points is an array of [ mX1, mY1, mX2, mY2 ]\n */\nfunction BezierEasing (points, b, c, d) {\n  if (arguments.length === 4) {\n    return new BezierEasing([ points, b, c, d ]);\n  }\n  if (!(this instanceof BezierEasing)) return new BezierEasing(points);\n\n  if (!points || points.length !== 4) {\n    throw new Error(\"BezierEasing: points must contains 4 values\");\n  }\n  for (var i=0; i<4; ++i) {\n    if (typeof points[i] !== \"number\" || isNaN(points[i]) || !isFinite(points[i])) {\n      throw new Error(\"BezierEasing: points should be integers.\");\n    }\n  }\n  if (points[0] < 0 || points[0] > 1 || points[2] < 0 || points[2] > 1) {\n    throw new Error(\"BezierEasing x values must be in [0, 1] range.\");\n  }\n\n  this._str = \"BezierEasing(\"+points+\")\";\n  this._css = \"cubic-bezier(\"+points+\")\";\n  this._p = points;\n  this._mSampleValues = float32ArraySupported ? new Float32Array(kSplineTableSize) : new Array(kSplineTableSize);\n  this._precomputed = false;\n\n  this.get = this.get.bind(this);\n}\n\nBezierEasing.prototype = {\n\n  get: function (x) {\n    var mX1 = this._p[0],\n      mY1 = this._p[1],\n      mX2 = this._p[2],\n      mY2 = this._p[3];\n    if (!this._precomputed) this._precompute();\n    if (mX1 === mY1 && mX2 === mY2) return x; // linear\n    // Because JavaScript number are imprecise, we should guarantee the extremes are right.\n    if (x === 0) return 0;\n    if (x === 1) return 1;\n    return calcBezier(this._getTForX(x), mY1, mY2);\n  },\n\n  getPoints: function() {\n    return this._p;\n  },\n\n  toString: function () {\n    return this._str;\n  },\n\n  toCSS: function () {\n    return this._css;\n  },\n\n  // Private part\n\n  _precompute: function () {\n    var mX1 = this._p[0],\n      mY1 = this._p[1],\n      mX2 = this._p[2],\n      mY2 = this._p[3];\n    this._precomputed = true;\n    if (mX1 !== mY1 || mX2 !== mY2)\n      this._calcSampleValues();\n  },\n\n  _calcSampleValues: function () {\n    var mX1 = this._p[0],\n      mX2 = this._p[2];\n    for (var i = 0; i < kSplineTableSize; ++i) {\n      this._mSampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n    }\n  },\n\n  /**\n   * getTForX chose the fastest heuristic to determine the percentage value precisely from a given X projection.\n   */\n  _getTForX: function (aX) {\n    var mX1 = this._p[0],\n      mX2 = this._p[2],\n      mSampleValues = this._mSampleValues;\n\n    var intervalStart = 0.0;\n    var currentSample = 1;\n    var lastSample = kSplineTableSize - 1;\n\n    for (; currentSample !== lastSample && mSampleValues[currentSample] <= aX; ++currentSample) {\n      intervalStart += kSampleStepSize;\n    }\n    --currentSample;\n\n    // Interpolate to provide an initial guess for t\n    var dist = (aX - mSampleValues[currentSample]) / (mSampleValues[currentSample+1] - mSampleValues[currentSample]);\n    var guessForT = intervalStart + dist * kSampleStepSize;\n\n    var initialSlope = getSlope(guessForT, mX1, mX2);\n    if (initialSlope >= NEWTON_MIN_SLOPE) {\n      return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n    } else if (initialSlope === 0.0) {\n      return guessForT;\n    } else {\n      return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n    }\n  }\n};\n\n// CSS mapping\nBezierEasing.css = {\n  \"ease\":        BezierEasing.ease      = BezierEasing(0.25, 0.1, 0.25, 1.0),\n  \"linear\":      BezierEasing.linear    = BezierEasing(0.00, 0.0, 1.00, 1.0),\n  \"ease-in\":     BezierEasing.easeIn    = BezierEasing(0.42, 0.0, 1.00, 1.0),\n  \"ease-out\":    BezierEasing.easeOut   = BezierEasing(0.00, 0.0, 0.58, 1.0),\n  \"ease-in-out\": BezierEasing.easeInOut = BezierEasing(0.42, 0.0, 0.58, 1.0)\n};\n\nmodule.exports = BezierEasing;\n","function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f);else for(t in e)e[t]&&(n&&(n+=\" \"),n+=t);return n}export function clsx(){for(var e,t,f=0,n=\"\";f<arguments.length;)(e=arguments[f++])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".ndl-visual-text {\\r\\n  font-weight: 400;\\r\\n  margin: 0;\\r\\n}\\r\\n\\r\\n.ndl-controls-pointer,\\r\\n.ndl-controls-pointer * {\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-abs-center {\\r\\n  position: absolute;\\r\\n  transform: translate(-50%, -50%);\\r\\n  left: 50%;\\r\\n  top: 50%;\\r\\n}\\r\\n\\r\\n/** Button **/\\r\\n.ndl-controls-button {\\r\\n  outline: none;\\r\\n  border: none;\\r\\n  color: white;\\r\\n  background-color: black;\\r\\n  padding: 5px 20px 5px 20px;\\r\\n  cursor: pointer;\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  justify-content: center;\\r\\n}\\r\\n.ndl-controls-button:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** Deprecated checkbox **/\\r\\n.ndl-controls-checkbox {\\r\\n  margin: 0;\\r\\n  border: 1px solid #000000;\\r\\n  border-radius: 0;\\r\\n  background-color: transparent;\\r\\n  -webkit-appearance: none;\\r\\n  outline: none;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-checkbox:checked {\\r\\n  background-color: #000000;\\r\\n}\\r\\n\\r\\n.ndl-controls-checkbox:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** Deprecated radio button **/\\r\\n.ndl-controls-radiobutton {\\r\\n  margin: 0;\\r\\n  border: 1px solid #000000;\\r\\n  border-radius: 16px;\\r\\n  background-color: transparent;\\r\\n  -webkit-appearance: none;\\r\\n  outline: none;\\r\\n  width: 32px;\\r\\n  height: 32px;\\r\\n  display: block;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-radiobutton:checked {\\r\\n  background-color: #000000;\\r\\n}\\r\\n\\r\\n.ndl-controls-radiobutton:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** New radio button **/\\r\\n.ndl-controls-radio-2 {\\r\\n  opacity: 0;\\r\\n  position: absolute;\\r\\n  margin: 0;\\r\\n}\\r\\n\\r\\n.ndl-controls-radio-2:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** New checkbox **/\\r\\n.ndl-controls-checkbox-2 {\\r\\n  opacity: 0;\\r\\n  position: absolute;\\r\\n  margin: 0;\\r\\n}\\r\\n\\r\\n.ndl-controls-checkbox-2:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** Options **/\\r\\n.ndl-controls-select {\\r\\n  -webkit-appearance: none;\\r\\n  appearance: none;\\r\\n  background-color: transparent;\\r\\n  border: 1px solid #000000;\\r\\n  border-radius: 0;\\r\\n  padding: 0 1em 0 0;\\r\\n  margin: 0;\\r\\n  width: 100%;\\r\\n  font-family: inherit;\\r\\n  font-size: inherit;\\r\\n  cursor: inherit;\\r\\n  line-height: inherit;\\r\\n\\r\\n  /* Stack above custom arrow */\\r\\n  z-index: 1;\\r\\n\\r\\n  /* Remove dropdown arrow in IE10 & IE11\\r\\n      @link https://www.filamentgroup.com/lab/select-css.html */\\r\\n  /*  &::-ms-expand {\\r\\n      display: none;\\r\\n    }*/\\r\\n\\r\\n  /* Remove focus outline, will add on alternate element */\\r\\n  outline: none;\\r\\n}\\r\\n\\r\\n.ndl-controls-select:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** Range **/\\r\\n.ndl-controls-range2 {\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  -webkit-appearance: none;\\r\\n  appearance: none;\\r\\n  outline: none;\\r\\n  border: none;\\r\\n  background: transparent;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-range2::-webkit-slider-thumb {\\r\\n  height: 100%;\\r\\n  border: 0;\\r\\n  -webkit-appearance: none;\\r\\n  appearance: none;\\r\\n}\\r\\n\\r\\n.ndl-controls-range2::-moz-range-thumb {\\r\\n  height: 100%;\\r\\n  border: 0;\\r\\n  -webkit-appearance: none;\\r\\n  appearance: none;\\r\\n}\\r\\n\\r\\n.ndl-controls-range2::-webkit-slider-runnable-track {\\r\\n  border: none;\\r\\n  height: 100%;\\r\\n}\\r\\n\\r\\n.ndl-controls-range2::-moz-range-track {\\r\\n  border: none;\\r\\n  height: 100%;\\r\\n}\\r\\n\\r\\n.ndl-controls-range2:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/* Old range */\\r\\n\\r\\n.ndl-controls-range {\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  -webkit-appearance: none;\\r\\n  outline: none;\\r\\n  border: none;\\r\\n  background-color: transparent;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-webkit-slider-thumb {\\r\\n  width: 16px;\\r\\n  height: 16px;\\r\\n  background: #000000;\\r\\n  border: 0;\\r\\n  border-radius: 8px;\\r\\n  cursor: pointer;\\r\\n  -webkit-appearance: none;\\r\\n  margin-top: -5px;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-moz-range-thumb {\\r\\n  width: 16px;\\r\\n  height: 16px;\\r\\n  background: #000000;\\r\\n  border: none;\\r\\n  border-radius: 8px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-ms-thumb {\\r\\n  width: 16px;\\r\\n  height: 16px;\\r\\n  background: #000000;\\r\\n  border: none;\\r\\n  border-radius: 8px;\\r\\n  cursor: pointer;\\r\\n  margin-top: 0px;\\r\\n  /*Needed to keep the Edge thumb centred*/\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-webkit-slider-runnable-track {\\r\\n  background: #f0f0f0;\\r\\n  border: none;\\r\\n  width: 100%;\\r\\n  height: 6px;\\r\\n  cursor: pointer;\\r\\n  top: 4px;\\r\\n  margin-top: 5px;\\r\\n}\\r\\n\\r\\n.ndl-controls-range:focus::-webkit-slider-runnable-track {\\r\\n  background: #f0f0f0;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-moz-range-track {\\r\\n  background: #f0f0f0;\\r\\n  border: none;\\r\\n  width: 100%;\\r\\n  height: 6px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-ms-track {\\r\\n  background: transparent;\\r\\n  border-color: transparent;\\r\\n  border-width: 5px 0;\\r\\n  color: transparent;\\r\\n  width: 100%;\\r\\n  height: 6px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-ms-fill-lower {\\r\\n  background: #f0f0f0;\\r\\n  border: none;\\r\\n}\\r\\n.ndl-controls-range::-ms-fill-upper {\\r\\n  background: #f0f0f0;\\r\\n  border: none;\\r\\n}\\r\\n\\r\\n/** Field Set **/\\r\\n.ndl-controls-fieldset {\\r\\n  outline: none;\\r\\n  border: none;\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n}\\r\\n\\r\\n/** Text Input **/\\r\\n.ndl-controls-textinput {\\r\\n  outline: none;\\r\\n  border-style: none;\\r\\n  background-color: transparent;\\r\\n}\\r\\n\\r\\n.ndl-controls-textinput::placeholder {\\r\\n  color: inherit;\\r\\n  opacity: 0.5;\\r\\n}\\r\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/assets/style.css\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[\".ndl-visual-text {\\r\\n  font-weight: 400;\\r\\n  margin: 0;\\r\\n}\\r\\n\\r\\n.ndl-controls-pointer,\\r\\n.ndl-controls-pointer * {\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-abs-center {\\r\\n  position: absolute;\\r\\n  transform: translate(-50%, -50%);\\r\\n  left: 50%;\\r\\n  top: 50%;\\r\\n}\\r\\n\\r\\n/** Button **/\\r\\n.ndl-controls-button {\\r\\n  outline: none;\\r\\n  border: none;\\r\\n  color: white;\\r\\n  background-color: black;\\r\\n  padding: 5px 20px 5px 20px;\\r\\n  cursor: pointer;\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  justify-content: center;\\r\\n}\\r\\n.ndl-controls-button:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** Deprecated checkbox **/\\r\\n.ndl-controls-checkbox {\\r\\n  margin: 0;\\r\\n  border: 1px solid #000000;\\r\\n  border-radius: 0;\\r\\n  background-color: transparent;\\r\\n  -webkit-appearance: none;\\r\\n  outline: none;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-checkbox:checked {\\r\\n  background-color: #000000;\\r\\n}\\r\\n\\r\\n.ndl-controls-checkbox:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** Deprecated radio button **/\\r\\n.ndl-controls-radiobutton {\\r\\n  margin: 0;\\r\\n  border: 1px solid #000000;\\r\\n  border-radius: 16px;\\r\\n  background-color: transparent;\\r\\n  -webkit-appearance: none;\\r\\n  outline: none;\\r\\n  width: 32px;\\r\\n  height: 32px;\\r\\n  display: block;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-radiobutton:checked {\\r\\n  background-color: #000000;\\r\\n}\\r\\n\\r\\n.ndl-controls-radiobutton:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** New radio button **/\\r\\n.ndl-controls-radio-2 {\\r\\n  opacity: 0;\\r\\n  position: absolute;\\r\\n  margin: 0;\\r\\n}\\r\\n\\r\\n.ndl-controls-radio-2:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** New checkbox **/\\r\\n.ndl-controls-checkbox-2 {\\r\\n  opacity: 0;\\r\\n  position: absolute;\\r\\n  margin: 0;\\r\\n}\\r\\n\\r\\n.ndl-controls-checkbox-2:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** Options **/\\r\\n.ndl-controls-select {\\r\\n  -webkit-appearance: none;\\r\\n  appearance: none;\\r\\n  background-color: transparent;\\r\\n  border: 1px solid #000000;\\r\\n  border-radius: 0;\\r\\n  padding: 0 1em 0 0;\\r\\n  margin: 0;\\r\\n  width: 100%;\\r\\n  font-family: inherit;\\r\\n  font-size: inherit;\\r\\n  cursor: inherit;\\r\\n  line-height: inherit;\\r\\n\\r\\n  /* Stack above custom arrow */\\r\\n  z-index: 1;\\r\\n\\r\\n  /* Remove dropdown arrow in IE10 & IE11\\r\\n      @link https://www.filamentgroup.com/lab/select-css.html */\\r\\n  /*  &::-ms-expand {\\r\\n      display: none;\\r\\n    }*/\\r\\n\\r\\n  /* Remove focus outline, will add on alternate element */\\r\\n  outline: none;\\r\\n}\\r\\n\\r\\n.ndl-controls-select:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/** Range **/\\r\\n.ndl-controls-range2 {\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  -webkit-appearance: none;\\r\\n  appearance: none;\\r\\n  outline: none;\\r\\n  border: none;\\r\\n  background: transparent;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-range2::-webkit-slider-thumb {\\r\\n  height: 100%;\\r\\n  border: 0;\\r\\n  -webkit-appearance: none;\\r\\n  appearance: none;\\r\\n}\\r\\n\\r\\n.ndl-controls-range2::-moz-range-thumb {\\r\\n  height: 100%;\\r\\n  border: 0;\\r\\n  -webkit-appearance: none;\\r\\n  appearance: none;\\r\\n}\\r\\n\\r\\n.ndl-controls-range2::-webkit-slider-runnable-track {\\r\\n  border: none;\\r\\n  height: 100%;\\r\\n}\\r\\n\\r\\n.ndl-controls-range2::-moz-range-track {\\r\\n  border: none;\\r\\n  height: 100%;\\r\\n}\\r\\n\\r\\n.ndl-controls-range2:disabled {\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\n/* Old range */\\r\\n\\r\\n.ndl-controls-range {\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  -webkit-appearance: none;\\r\\n  outline: none;\\r\\n  border: none;\\r\\n  background-color: transparent;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-webkit-slider-thumb {\\r\\n  width: 16px;\\r\\n  height: 16px;\\r\\n  background: #000000;\\r\\n  border: 0;\\r\\n  border-radius: 8px;\\r\\n  cursor: pointer;\\r\\n  -webkit-appearance: none;\\r\\n  margin-top: -5px;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-moz-range-thumb {\\r\\n  width: 16px;\\r\\n  height: 16px;\\r\\n  background: #000000;\\r\\n  border: none;\\r\\n  border-radius: 8px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-ms-thumb {\\r\\n  width: 16px;\\r\\n  height: 16px;\\r\\n  background: #000000;\\r\\n  border: none;\\r\\n  border-radius: 8px;\\r\\n  cursor: pointer;\\r\\n  margin-top: 0px;\\r\\n  /*Needed to keep the Edge thumb centred*/\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-webkit-slider-runnable-track {\\r\\n  background: #f0f0f0;\\r\\n  border: none;\\r\\n  width: 100%;\\r\\n  height: 6px;\\r\\n  cursor: pointer;\\r\\n  top: 4px;\\r\\n  margin-top: 5px;\\r\\n}\\r\\n\\r\\n.ndl-controls-range:focus::-webkit-slider-runnable-track {\\r\\n  background: #f0f0f0;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-moz-range-track {\\r\\n  background: #f0f0f0;\\r\\n  border: none;\\r\\n  width: 100%;\\r\\n  height: 6px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-ms-track {\\r\\n  background: transparent;\\r\\n  border-color: transparent;\\r\\n  border-width: 5px 0;\\r\\n  color: transparent;\\r\\n  width: 100%;\\r\\n  height: 6px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.ndl-controls-range::-ms-fill-lower {\\r\\n  background: #f0f0f0;\\r\\n  border: none;\\r\\n}\\r\\n.ndl-controls-range::-ms-fill-upper {\\r\\n  background: #f0f0f0;\\r\\n  border: none;\\r\\n}\\r\\n\\r\\n/** Field Set **/\\r\\n.ndl-controls-fieldset {\\r\\n  outline: none;\\r\\n  border: none;\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n}\\r\\n\\r\\n/** Text Input **/\\r\\n.ndl-controls-textinput {\\r\\n  outline: none;\\r\\n  border-style: none;\\r\\n  background-color: transparent;\\r\\n}\\r\\n\\r\\n.ndl-controls-textinput::placeholder {\\r\\n  color: inherit;\\r\\n  opacity: 0.5;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === \"string\") {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, \"\"]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]); if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"DraggableCore\", {\n  enumerable: true,\n  get: function () {\n    return _DraggableCore.default;\n  }\n});\nexports.default = void 0;\nvar React = _interopRequireWildcard(require(\"react\"));\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\nvar _reactDom = _interopRequireDefault(require(\"react-dom\"));\nvar _clsx = _interopRequireDefault(require(\"clsx\"));\nvar _domFns = require(\"./utils/domFns\");\nvar _positionFns = require(\"./utils/positionFns\");\nvar _shims = require(\"./utils/shims\");\nvar _DraggableCore = _interopRequireDefault(require(\"./DraggableCore\"));\nvar _log = _interopRequireDefault(require(\"./utils/log\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); } /*:: import type {ControlPosition, PositionOffsetControlPosition, DraggableCoreProps, DraggableCoreDefaultProps} from './DraggableCore';*/\n/*:: import type {Bounds, DraggableEventHandler} from './utils/types';*/\n/*:: import type {Element as ReactElement} from 'react';*/\n/*:: type DraggableState = {\n  dragging: boolean,\n  dragged: boolean,\n  x: number, y: number,\n  slackX: number, slackY: number,\n  isElementSVG: boolean,\n  prevPropsPosition: ?ControlPosition,\n};*/\n/*:: export type DraggableDefaultProps = {\n  ...DraggableCoreDefaultProps,\n  axis: 'both' | 'x' | 'y' | 'none',\n  bounds: Bounds | string | false,\n  defaultClassName: string,\n  defaultClassNameDragging: string,\n  defaultClassNameDragged: string,\n  defaultPosition: ControlPosition,\n  scale: number,\n};*/\n/*:: export type DraggableProps = {\n  ...DraggableCoreProps,\n  ...DraggableDefaultProps,\n  positionOffset: PositionOffsetControlPosition,\n  position: ControlPosition,\n};*/\n//\n// Define <Draggable>\n//\nclass Draggable extends React.Component /*:: <DraggableProps, DraggableState>*/{\n  // React 16.3+\n  // Arity (props, state)\n  static getDerivedStateFromProps(_ref /*:: */, _ref2 /*:: */) /*: ?Partial<DraggableState>*/{\n    let {\n      position\n    } /*: DraggableProps*/ = _ref /*: DraggableProps*/;\n    let {\n      prevPropsPosition\n    } /*: DraggableState*/ = _ref2 /*: DraggableState*/;\n    // Set x/y if a new position is provided in props that is different than the previous.\n    if (position && (!prevPropsPosition || position.x !== prevPropsPosition.x || position.y !== prevPropsPosition.y)) {\n      (0, _log.default)('Draggable: getDerivedStateFromProps %j', {\n        position,\n        prevPropsPosition\n      });\n      return {\n        x: position.x,\n        y: position.y,\n        prevPropsPosition: {\n          ...position\n        }\n      };\n    }\n    return null;\n  }\n  constructor(props /*: DraggableProps*/) {\n    super(props);\n    _defineProperty(this, \"onDragStart\", (e, coreData) => {\n      (0, _log.default)('Draggable: onDragStart: %j', coreData);\n\n      // Short-circuit if user's callback killed it.\n      const shouldStart = this.props.onStart(e, (0, _positionFns.createDraggableData)(this, coreData));\n      // Kills start event on core as well, so move handlers are never bound.\n      if (shouldStart === false) return false;\n      this.setState({\n        dragging: true,\n        dragged: true\n      });\n    });\n    _defineProperty(this, \"onDrag\", (e, coreData) => {\n      if (!this.state.dragging) return false;\n      (0, _log.default)('Draggable: onDrag: %j', coreData);\n      const uiData = (0, _positionFns.createDraggableData)(this, coreData);\n      const newState = {\n        x: uiData.x,\n        y: uiData.y,\n        slackX: 0,\n        slackY: 0\n      };\n\n      // Keep within bounds.\n      if (this.props.bounds) {\n        // Save original x and y.\n        const {\n          x,\n          y\n        } = newState;\n\n        // Add slack to the values used to calculate bound position. This will ensure that if\n        // we start removing slack, the element won't react to it right away until it's been\n        // completely removed.\n        newState.x += this.state.slackX;\n        newState.y += this.state.slackY;\n\n        // Get bound position. This will ceil/floor the x and y within the boundaries.\n        const [newStateX, newStateY] = (0, _positionFns.getBoundPosition)(this, newState.x, newState.y);\n        newState.x = newStateX;\n        newState.y = newStateY;\n\n        // Recalculate slack by noting how much was shaved by the boundPosition handler.\n        newState.slackX = this.state.slackX + (x - newState.x);\n        newState.slackY = this.state.slackY + (y - newState.y);\n\n        // Update the event we fire to reflect what really happened after bounds took effect.\n        uiData.x = newState.x;\n        uiData.y = newState.y;\n        uiData.deltaX = newState.x - this.state.x;\n        uiData.deltaY = newState.y - this.state.y;\n      }\n\n      // Short-circuit if user's callback killed it.\n      const shouldUpdate = this.props.onDrag(e, uiData);\n      if (shouldUpdate === false) return false;\n      this.setState(newState);\n    });\n    _defineProperty(this, \"onDragStop\", (e, coreData) => {\n      if (!this.state.dragging) return false;\n\n      // Short-circuit if user's callback killed it.\n      const shouldContinue = this.props.onStop(e, (0, _positionFns.createDraggableData)(this, coreData));\n      if (shouldContinue === false) return false;\n      (0, _log.default)('Draggable: onDragStop: %j', coreData);\n      const newState /*: Partial<DraggableState>*/ = {\n        dragging: false,\n        slackX: 0,\n        slackY: 0\n      };\n\n      // If this is a controlled component, the result of this operation will be to\n      // revert back to the old position. We expect a handler on `onDragStop`, at the least.\n      const controlled = Boolean(this.props.position);\n      if (controlled) {\n        const {\n          x,\n          y\n        } = this.props.position;\n        newState.x = x;\n        newState.y = y;\n      }\n      this.setState(newState);\n    });\n    this.state = {\n      // Whether or not we are currently dragging.\n      dragging: false,\n      // Whether or not we have been dragged before.\n      dragged: false,\n      // Current transform x and y.\n      x: props.position ? props.position.x : props.defaultPosition.x,\n      y: props.position ? props.position.y : props.defaultPosition.y,\n      prevPropsPosition: {\n        ...props.position\n      },\n      // Used for compensating for out-of-bounds drags\n      slackX: 0,\n      slackY: 0,\n      // Can only determine if SVG after mounting\n      isElementSVG: false\n    };\n    if (props.position && !(props.onDrag || props.onStop)) {\n      // eslint-disable-next-line no-console\n      console.warn('A `position` was applied to this <Draggable>, without drag handlers. This will make this ' + 'component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the ' + '`position` of this element.');\n    }\n  }\n  componentDidMount() {\n    // Check to see if the element passed is an instanceof SVGElement\n    if (typeof window.SVGElement !== 'undefined' && this.findDOMNode() instanceof window.SVGElement) {\n      this.setState({\n        isElementSVG: true\n      });\n    }\n  }\n  componentWillUnmount() {\n    this.setState({\n      dragging: false\n    }); // prevents invariant if unmounted while dragging\n  }\n\n  // React Strict Mode compatibility: if `nodeRef` is passed, we will use it instead of trying to find\n  // the underlying DOM node ourselves. See the README for more information.\n  findDOMNode() /*: ?HTMLElement*/{\n    var _this$props$nodeRef$c, _this$props;\n    return (_this$props$nodeRef$c = (_this$props = this.props) === null || _this$props === void 0 || (_this$props = _this$props.nodeRef) === null || _this$props === void 0 ? void 0 : _this$props.current) !== null && _this$props$nodeRef$c !== void 0 ? _this$props$nodeRef$c : _reactDom.default.findDOMNode(this);\n  }\n  render() /*: ReactElement<any>*/{\n    const {\n      axis,\n      bounds,\n      children,\n      defaultPosition,\n      defaultClassName,\n      defaultClassNameDragging,\n      defaultClassNameDragged,\n      position,\n      positionOffset,\n      scale,\n      ...draggableCoreProps\n    } = this.props;\n    let style = {};\n    let svgTransform = null;\n\n    // If this is controlled, we don't want to move it - unless it's dragging.\n    const controlled = Boolean(position);\n    const draggable = !controlled || this.state.dragging;\n    const validPosition = position || defaultPosition;\n    const transformOpts = {\n      // Set left if horizontal drag is enabled\n      x: (0, _positionFns.canDragX)(this) && draggable ? this.state.x : validPosition.x,\n      // Set top if vertical drag is enabled\n      y: (0, _positionFns.canDragY)(this) && draggable ? this.state.y : validPosition.y\n    };\n\n    // If this element was SVG, we use the `transform` attribute.\n    if (this.state.isElementSVG) {\n      svgTransform = (0, _domFns.createSVGTransform)(transformOpts, positionOffset);\n    } else {\n      // Add a CSS transform to move the element around. This allows us to move the element around\n      // without worrying about whether or not it is relatively or absolutely positioned.\n      // If the item you are dragging already has a transform set, wrap it in a <span> so <Draggable>\n      // has a clean slate.\n      style = (0, _domFns.createCSSTransform)(transformOpts, positionOffset);\n    }\n\n    // Mark with class while dragging\n    const className = (0, _clsx.default)(children.props.className || '', defaultClassName, {\n      [defaultClassNameDragging]: this.state.dragging,\n      [defaultClassNameDragged]: this.state.dragged\n    });\n\n    // Reuse the child provided\n    // This makes it flexible to use whatever element is wanted (div, ul, etc)\n    return /*#__PURE__*/React.createElement(_DraggableCore.default, _extends({}, draggableCoreProps, {\n      onStart: this.onDragStart,\n      onDrag: this.onDrag,\n      onStop: this.onDragStop\n    }), /*#__PURE__*/React.cloneElement(React.Children.only(children), {\n      className: className,\n      style: {\n        ...children.props.style,\n        ...style\n      },\n      transform: svgTransform\n    }));\n  }\n}\nexports.default = Draggable;\n_defineProperty(Draggable, \"displayName\", 'Draggable');\n_defineProperty(Draggable, \"propTypes\", {\n  // Accepts all props <DraggableCore> accepts.\n  ..._DraggableCore.default.propTypes,\n  /**\n   * `axis` determines which axis the draggable can move.\n   *\n   *  Note that all callbacks will still return data as normal. This only\n   *  controls flushing to the DOM.\n   *\n   * 'both' allows movement horizontally and vertically.\n   * 'x' limits movement to horizontal axis.\n   * 'y' limits movement to vertical axis.\n   * 'none' limits all movement.\n   *\n   * Defaults to 'both'.\n   */\n  axis: _propTypes.default.oneOf(['both', 'x', 'y', 'none']),\n  /**\n   * `bounds` determines the range of movement available to the element.\n   * Available values are:\n   *\n   * 'parent' restricts movement within the Draggable's parent node.\n   *\n   * Alternatively, pass an object with the following properties, all of which are optional:\n   *\n   * {left: LEFT_BOUND, right: RIGHT_BOUND, bottom: BOTTOM_BOUND, top: TOP_BOUND}\n   *\n   * All values are in px.\n   *\n   * Example:\n   *\n   * ```jsx\n   *   let App = React.createClass({\n   *       render: function () {\n   *         return (\n   *            <Draggable bounds={{right: 300, bottom: 300}}>\n   *              <div>Content</div>\n   *           </Draggable>\n   *         );\n   *       }\n   *   });\n   * ```\n   */\n  bounds: _propTypes.default.oneOfType([_propTypes.default.shape({\n    left: _propTypes.default.number,\n    right: _propTypes.default.number,\n    top: _propTypes.default.number,\n    bottom: _propTypes.default.number\n  }), _propTypes.default.string, _propTypes.default.oneOf([false])]),\n  defaultClassName: _propTypes.default.string,\n  defaultClassNameDragging: _propTypes.default.string,\n  defaultClassNameDragged: _propTypes.default.string,\n  /**\n   * `defaultPosition` specifies the x and y that the dragged item should start at\n   *\n   * Example:\n   *\n   * ```jsx\n   *      let App = React.createClass({\n   *          render: function () {\n   *              return (\n   *                  <Draggable defaultPosition={{x: 25, y: 25}}>\n   *                      <div>I start with transformX: 25px and transformY: 25px;</div>\n   *                  </Draggable>\n   *              );\n   *          }\n   *      });\n   * ```\n   */\n  defaultPosition: _propTypes.default.shape({\n    x: _propTypes.default.number,\n    y: _propTypes.default.number\n  }),\n  positionOffset: _propTypes.default.shape({\n    x: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string]),\n    y: _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.string])\n  }),\n  /**\n   * `position`, if present, defines the current position of the element.\n   *\n   *  This is similar to how form elements in React work - if no `position` is supplied, the component\n   *  is uncontrolled.\n   *\n   * Example:\n   *\n   * ```jsx\n   *      let App = React.createClass({\n   *          render: function () {\n   *              return (\n   *                  <Draggable position={{x: 25, y: 25}}>\n   *                      <div>I start with transformX: 25px and transformY: 25px;</div>\n   *                  </Draggable>\n   *              );\n   *          }\n   *      });\n   * ```\n   */\n  position: _propTypes.default.shape({\n    x: _propTypes.default.number,\n    y: _propTypes.default.number\n  }),\n  /**\n   * These properties should be defined on the child, not here.\n   */\n  className: _shims.dontSetMe,\n  style: _shims.dontSetMe,\n  transform: _shims.dontSetMe\n});\n_defineProperty(Draggable, \"defaultProps\", {\n  ..._DraggableCore.default.defaultProps,\n  axis: 'both',\n  bounds: false,\n  defaultClassName: 'react-draggable',\n  defaultClassNameDragging: 'react-draggable-dragging',\n  defaultClassNameDragged: 'react-draggable-dragged',\n  defaultPosition: {\n    x: 0,\n    y: 0\n  },\n  scale: 1\n});","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar React = _interopRequireWildcard(require(\"react\"));\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\nvar _reactDom = _interopRequireDefault(require(\"react-dom\"));\nvar _domFns = require(\"./utils/domFns\");\nvar _positionFns = require(\"./utils/positionFns\");\nvar _shims = require(\"./utils/shims\");\nvar _log = _interopRequireDefault(require(\"./utils/log\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n/*:: import type {EventHandler, MouseTouchEvent} from './utils/types';*/\n/*:: import type {Element as ReactElement} from 'react';*/\n// Simple abstraction for dragging events names.\nconst eventsFor = {\n  touch: {\n    start: 'touchstart',\n    move: 'touchmove',\n    stop: 'touchend'\n  },\n  mouse: {\n    start: 'mousedown',\n    move: 'mousemove',\n    stop: 'mouseup'\n  }\n};\n\n// Default to mouse events.\nlet dragEventFor = eventsFor.mouse;\n/*:: export type DraggableData = {\n  node: HTMLElement,\n  x: number, y: number,\n  deltaX: number, deltaY: number,\n  lastX: number, lastY: number,\n};*/\n/*:: export type DraggableEventHandler = (e: MouseEvent, data: DraggableData) => void | false;*/\n/*:: export type ControlPosition = {x: number, y: number};*/\n/*:: export type PositionOffsetControlPosition = {x: number|string, y: number|string};*/\n/*:: export type DraggableCoreDefaultProps = {\n  allowAnyClick: boolean,\n  disabled: boolean,\n  enableUserSelectHack: boolean,\n  onStart: DraggableEventHandler,\n  onDrag: DraggableEventHandler,\n  onStop: DraggableEventHandler,\n  onMouseDown: (e: MouseEvent) => void,\n  scale: number,\n};*/\n/*:: export type DraggableCoreProps = {\n  ...DraggableCoreDefaultProps,\n  cancel: string,\n  children: ReactElement<any>,\n  offsetParent: HTMLElement,\n  grid: [number, number],\n  handle: string,\n  nodeRef?: ?React.ElementRef<any>,\n};*/\n//\n// Define <DraggableCore>.\n//\n// <DraggableCore> is for advanced usage of <Draggable>. It maintains minimal internal state so it can\n// work well with libraries that require more control over the element.\n//\n\nclass DraggableCore extends React.Component /*:: <DraggableCoreProps>*/{\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"dragging\", false);\n    // Used while dragging to determine deltas.\n    _defineProperty(this, \"lastX\", NaN);\n    _defineProperty(this, \"lastY\", NaN);\n    _defineProperty(this, \"touchIdentifier\", null);\n    _defineProperty(this, \"mounted\", false);\n    _defineProperty(this, \"handleDragStart\", e => {\n      // Make it possible to attach event handlers on top of this one.\n      this.props.onMouseDown(e);\n\n      // Only accept left-clicks.\n      if (!this.props.allowAnyClick && typeof e.button === 'number' && e.button !== 0) return false;\n\n      // Get nodes. Be sure to grab relative document (could be iframed)\n      const thisNode = this.findDOMNode();\n      if (!thisNode || !thisNode.ownerDocument || !thisNode.ownerDocument.body) {\n        throw new Error('<DraggableCore> not mounted on DragStart!');\n      }\n      const {\n        ownerDocument\n      } = thisNode;\n\n      // Short circuit if handle or cancel prop was provided and selector doesn't match.\n      if (this.props.disabled || !(e.target instanceof ownerDocument.defaultView.Node) || this.props.handle && !(0, _domFns.matchesSelectorAndParentsTo)(e.target, this.props.handle, thisNode) || this.props.cancel && (0, _domFns.matchesSelectorAndParentsTo)(e.target, this.props.cancel, thisNode)) {\n        return;\n      }\n\n      // Prevent scrolling on mobile devices, like ipad/iphone.\n      // Important that this is after handle/cancel.\n      if (e.type === 'touchstart') e.preventDefault();\n\n      // Set touch identifier in component state if this is a touch event. This allows us to\n      // distinguish between individual touches on multitouch screens by identifying which\n      // touchpoint was set to this element.\n      const touchIdentifier = (0, _domFns.getTouchIdentifier)(e);\n      this.touchIdentifier = touchIdentifier;\n\n      // Get the current drag point from the event. This is used as the offset.\n      const position = (0, _positionFns.getControlPosition)(e, touchIdentifier, this);\n      if (position == null) return; // not possible but satisfies flow\n      const {\n        x,\n        y\n      } = position;\n\n      // Create an event object with all the data parents need to make a decision here.\n      const coreEvent = (0, _positionFns.createCoreData)(this, x, y);\n      (0, _log.default)('DraggableCore: handleDragStart: %j', coreEvent);\n\n      // Call event handler. If it returns explicit false, cancel.\n      (0, _log.default)('calling', this.props.onStart);\n      const shouldUpdate = this.props.onStart(e, coreEvent);\n      if (shouldUpdate === false || this.mounted === false) return;\n\n      // Add a style to the body to disable user-select. This prevents text from\n      // being selected all over the page.\n      if (this.props.enableUserSelectHack) (0, _domFns.addUserSelectStyles)(ownerDocument);\n\n      // Initiate dragging. Set the current x and y as offsets\n      // so we know how much we've moved during the drag. This allows us\n      // to drag elements around even if they have been moved, without issue.\n      this.dragging = true;\n      this.lastX = x;\n      this.lastY = y;\n\n      // Add events to the document directly so we catch when the user's mouse/touch moves outside of\n      // this element. We use different events depending on whether or not we have detected that this\n      // is a touch-capable device.\n      (0, _domFns.addEvent)(ownerDocument, dragEventFor.move, this.handleDrag);\n      (0, _domFns.addEvent)(ownerDocument, dragEventFor.stop, this.handleDragStop);\n    });\n    _defineProperty(this, \"handleDrag\", e => {\n      // Get the current drag point from the event. This is used as the offset.\n      const position = (0, _positionFns.getControlPosition)(e, this.touchIdentifier, this);\n      if (position == null) return;\n      let {\n        x,\n        y\n      } = position;\n\n      // Snap to grid if prop has been provided\n      if (Array.isArray(this.props.grid)) {\n        let deltaX = x - this.lastX,\n          deltaY = y - this.lastY;\n        [deltaX, deltaY] = (0, _positionFns.snapToGrid)(this.props.grid, deltaX, deltaY);\n        if (!deltaX && !deltaY) return; // skip useless drag\n        x = this.lastX + deltaX, y = this.lastY + deltaY;\n      }\n      const coreEvent = (0, _positionFns.createCoreData)(this, x, y);\n      (0, _log.default)('DraggableCore: handleDrag: %j', coreEvent);\n\n      // Call event handler. If it returns explicit false, trigger end.\n      const shouldUpdate = this.props.onDrag(e, coreEvent);\n      if (shouldUpdate === false || this.mounted === false) {\n        try {\n          // $FlowIgnore\n          this.handleDragStop(new MouseEvent('mouseup'));\n        } catch (err) {\n          // Old browsers\n          const event = ((document.createEvent('MouseEvents') /*: any*/) /*: MouseTouchEvent*/);\n          // I see why this insanity was deprecated\n          // $FlowIgnore\n          event.initMouseEvent('mouseup', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n          this.handleDragStop(event);\n        }\n        return;\n      }\n      this.lastX = x;\n      this.lastY = y;\n    });\n    _defineProperty(this, \"handleDragStop\", e => {\n      if (!this.dragging) return;\n      const position = (0, _positionFns.getControlPosition)(e, this.touchIdentifier, this);\n      if (position == null) return;\n      let {\n        x,\n        y\n      } = position;\n\n      // Snap to grid if prop has been provided\n      if (Array.isArray(this.props.grid)) {\n        let deltaX = x - this.lastX || 0;\n        let deltaY = y - this.lastY || 0;\n        [deltaX, deltaY] = (0, _positionFns.snapToGrid)(this.props.grid, deltaX, deltaY);\n        x = this.lastX + deltaX, y = this.lastY + deltaY;\n      }\n      const coreEvent = (0, _positionFns.createCoreData)(this, x, y);\n\n      // Call event handler\n      const shouldContinue = this.props.onStop(e, coreEvent);\n      if (shouldContinue === false || this.mounted === false) return false;\n      const thisNode = this.findDOMNode();\n      if (thisNode) {\n        // Remove user-select hack\n        if (this.props.enableUserSelectHack) (0, _domFns.removeUserSelectStyles)(thisNode.ownerDocument);\n      }\n      (0, _log.default)('DraggableCore: handleDragStop: %j', coreEvent);\n\n      // Reset the el.\n      this.dragging = false;\n      this.lastX = NaN;\n      this.lastY = NaN;\n      if (thisNode) {\n        // Remove event handlers\n        (0, _log.default)('DraggableCore: Removing handlers');\n        (0, _domFns.removeEvent)(thisNode.ownerDocument, dragEventFor.move, this.handleDrag);\n        (0, _domFns.removeEvent)(thisNode.ownerDocument, dragEventFor.stop, this.handleDragStop);\n      }\n    });\n    _defineProperty(this, \"onMouseDown\", e => {\n      dragEventFor = eventsFor.mouse; // on touchscreen laptops we could switch back to mouse\n\n      return this.handleDragStart(e);\n    });\n    _defineProperty(this, \"onMouseUp\", e => {\n      dragEventFor = eventsFor.mouse;\n      return this.handleDragStop(e);\n    });\n    // Same as onMouseDown (start drag), but now consider this a touch device.\n    _defineProperty(this, \"onTouchStart\", e => {\n      // We're on a touch device now, so change the event handlers\n      dragEventFor = eventsFor.touch;\n      return this.handleDragStart(e);\n    });\n    _defineProperty(this, \"onTouchEnd\", e => {\n      // We're on a touch device now, so change the event handlers\n      dragEventFor = eventsFor.touch;\n      return this.handleDragStop(e);\n    });\n  }\n  componentDidMount() {\n    this.mounted = true;\n    // Touch handlers must be added with {passive: false} to be cancelable.\n    // https://developers.google.com/web/updates/2017/01/scrolling-intervention\n    const thisNode = this.findDOMNode();\n    if (thisNode) {\n      (0, _domFns.addEvent)(thisNode, eventsFor.touch.start, this.onTouchStart, {\n        passive: false\n      });\n    }\n  }\n  componentWillUnmount() {\n    this.mounted = false;\n    // Remove any leftover event handlers. Remove both touch and mouse handlers in case\n    // some browser quirk caused a touch event to fire during a mouse move, or vice versa.\n    const thisNode = this.findDOMNode();\n    if (thisNode) {\n      const {\n        ownerDocument\n      } = thisNode;\n      (0, _domFns.removeEvent)(ownerDocument, eventsFor.mouse.move, this.handleDrag);\n      (0, _domFns.removeEvent)(ownerDocument, eventsFor.touch.move, this.handleDrag);\n      (0, _domFns.removeEvent)(ownerDocument, eventsFor.mouse.stop, this.handleDragStop);\n      (0, _domFns.removeEvent)(ownerDocument, eventsFor.touch.stop, this.handleDragStop);\n      (0, _domFns.removeEvent)(thisNode, eventsFor.touch.start, this.onTouchStart, {\n        passive: false\n      });\n      if (this.props.enableUserSelectHack) (0, _domFns.removeUserSelectStyles)(ownerDocument);\n    }\n  }\n\n  // React Strict Mode compatibility: if `nodeRef` is passed, we will use it instead of trying to find\n  // the underlying DOM node ourselves. See the README for more information.\n  findDOMNode() /*: ?HTMLElement*/{\n    var _this$props, _this$props2;\n    return (_this$props = this.props) !== null && _this$props !== void 0 && _this$props.nodeRef ? (_this$props2 = this.props) === null || _this$props2 === void 0 || (_this$props2 = _this$props2.nodeRef) === null || _this$props2 === void 0 ? void 0 : _this$props2.current : _reactDom.default.findDOMNode(this);\n  }\n  render() /*: React.Element<any>*/{\n    // Reuse the child provided\n    // This makes it flexible to use whatever element is wanted (div, ul, etc)\n    return /*#__PURE__*/React.cloneElement(React.Children.only(this.props.children), {\n      // Note: mouseMove handler is attached to document so it will still function\n      // when the user drags quickly and leaves the bounds of the element.\n      onMouseDown: this.onMouseDown,\n      onMouseUp: this.onMouseUp,\n      // onTouchStart is added on `componentDidMount` so they can be added with\n      // {passive: false}, which allows it to cancel. See\n      // https://developers.google.com/web/updates/2017/01/scrolling-intervention\n      onTouchEnd: this.onTouchEnd\n    });\n  }\n}\nexports.default = DraggableCore;\n_defineProperty(DraggableCore, \"displayName\", 'DraggableCore');\n_defineProperty(DraggableCore, \"propTypes\", {\n  /**\n   * `allowAnyClick` allows dragging using any mouse button.\n   * By default, we only accept the left button.\n   *\n   * Defaults to `false`.\n   */\n  allowAnyClick: _propTypes.default.bool,\n  children: _propTypes.default.node.isRequired,\n  /**\n   * `disabled`, if true, stops the <Draggable> from dragging. All handlers,\n   * with the exception of `onMouseDown`, will not fire.\n   */\n  disabled: _propTypes.default.bool,\n  /**\n   * By default, we add 'user-select:none' attributes to the document body\n   * to prevent ugly text selection during drag. If this is causing problems\n   * for your app, set this to `false`.\n   */\n  enableUserSelectHack: _propTypes.default.bool,\n  /**\n   * `offsetParent`, if set, uses the passed DOM node to compute drag offsets\n   * instead of using the parent node.\n   */\n  offsetParent: function (props /*: DraggableCoreProps*/, propName /*: $Keys<DraggableCoreProps>*/) {\n    if (props[propName] && props[propName].nodeType !== 1) {\n      throw new Error('Draggable\\'s offsetParent must be a DOM Node.');\n    }\n  },\n  /**\n   * `grid` specifies the x and y that dragging should snap to.\n   */\n  grid: _propTypes.default.arrayOf(_propTypes.default.number),\n  /**\n   * `handle` specifies a selector to be used as the handle that initiates drag.\n   *\n   * Example:\n   *\n   * ```jsx\n   *   let App = React.createClass({\n   *       render: function () {\n   *         return (\n   *            <Draggable handle=\".handle\">\n   *              <div>\n   *                  <div className=\"handle\">Click me to drag</div>\n   *                  <div>This is some other content</div>\n   *              </div>\n   *           </Draggable>\n   *         );\n   *       }\n   *   });\n   * ```\n   */\n  handle: _propTypes.default.string,\n  /**\n   * `cancel` specifies a selector to be used to prevent drag initialization.\n   *\n   * Example:\n   *\n   * ```jsx\n   *   let App = React.createClass({\n   *       render: function () {\n   *           return(\n   *               <Draggable cancel=\".cancel\">\n   *                   <div>\n   *                     <div className=\"cancel\">You can't drag from here</div>\n   *                     <div>Dragging here works fine</div>\n   *                   </div>\n   *               </Draggable>\n   *           );\n   *       }\n   *   });\n   * ```\n   */\n  cancel: _propTypes.default.string,\n  /* If running in React Strict mode, ReactDOM.findDOMNode() is deprecated.\n   * Unfortunately, in order for <Draggable> to work properly, we need raw access\n   * to the underlying DOM node. If you want to avoid the warning, pass a `nodeRef`\n   * as in this example:\n   *\n   * function MyComponent() {\n   *   const nodeRef = React.useRef(null);\n   *   return (\n   *     <Draggable nodeRef={nodeRef}>\n   *       <div ref={nodeRef}>Example Target</div>\n   *     </Draggable>\n   *   );\n   * }\n   *\n   * This can be used for arbitrarily nested components, so long as the ref ends up\n   * pointing to the actual child DOM node and not a custom component.\n   */\n  nodeRef: _propTypes.default.object,\n  /**\n   * Called when dragging starts.\n   * If this function returns the boolean false, dragging will be canceled.\n   */\n  onStart: _propTypes.default.func,\n  /**\n   * Called while dragging.\n   * If this function returns the boolean false, dragging will be canceled.\n   */\n  onDrag: _propTypes.default.func,\n  /**\n   * Called when dragging stops.\n   * If this function returns the boolean false, the drag will remain active.\n   */\n  onStop: _propTypes.default.func,\n  /**\n   * A workaround option which can be passed if onMouseDown needs to be accessed,\n   * since it'll always be blocked (as there is internal use of onMouseDown)\n   */\n  onMouseDown: _propTypes.default.func,\n  /**\n   * `scale`, if set, applies scaling while dragging an element\n   */\n  scale: _propTypes.default.number,\n  /**\n   * These properties should be defined on the child, not here.\n   */\n  className: _shims.dontSetMe,\n  style: _shims.dontSetMe,\n  transform: _shims.dontSetMe\n});\n_defineProperty(DraggableCore, \"defaultProps\", {\n  allowAnyClick: false,\n  // by default only accept left click\n  disabled: false,\n  enableUserSelectHack: true,\n  onStart: function () {},\n  onDrag: function () {},\n  onStop: function () {},\n  onMouseDown: function () {},\n  scale: 1\n});","\"use strict\";\n\nconst {\n  default: Draggable,\n  DraggableCore\n} = require('./Draggable');\n\n// Previous versions of this lib exported <Draggable> as the root export. As to no-// them, or TypeScript, we export *both* as the root and as 'default'.\n// See https://github.com/mzabriskie/react-draggable/pull/254\n// and https://github.com/mzabriskie/react-draggable/issues/266\nmodule.exports = Draggable;\nmodule.exports.default = Draggable;\nmodule.exports.DraggableCore = DraggableCore;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.addClassName = addClassName;\nexports.addEvent = addEvent;\nexports.addUserSelectStyles = addUserSelectStyles;\nexports.createCSSTransform = createCSSTransform;\nexports.createSVGTransform = createSVGTransform;\nexports.getTouch = getTouch;\nexports.getTouchIdentifier = getTouchIdentifier;\nexports.getTranslation = getTranslation;\nexports.innerHeight = innerHeight;\nexports.innerWidth = innerWidth;\nexports.matchesSelector = matchesSelector;\nexports.matchesSelectorAndParentsTo = matchesSelectorAndParentsTo;\nexports.offsetXYFromParent = offsetXYFromParent;\nexports.outerHeight = outerHeight;\nexports.outerWidth = outerWidth;\nexports.removeClassName = removeClassName;\nexports.removeEvent = removeEvent;\nexports.removeUserSelectStyles = removeUserSelectStyles;\nvar _shims = require(\"./shims\");\nvar _getPrefix = _interopRequireWildcard(require(\"./getPrefix\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n/*:: import type {ControlPosition, PositionOffsetControlPosition, MouseTouchEvent} from './types';*/\nlet matchesSelectorFunc = '';\nfunction matchesSelector(el /*: Node*/, selector /*: string*/) /*: boolean*/{\n  if (!matchesSelectorFunc) {\n    matchesSelectorFunc = (0, _shims.findInArray)(['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'], function (method) {\n      // $FlowIgnore: Doesn't think elements are indexable\n      return (0, _shims.isFunction)(el[method]);\n    });\n  }\n\n  // Might not be found entirely (not an Element?) - in that case, bail\n  // $FlowIgnore: Doesn't think elements are indexable\n  if (!(0, _shims.isFunction)(el[matchesSelectorFunc])) return false;\n\n  // $FlowIgnore: Doesn't think elements are indexable\n  return el[matchesSelectorFunc](selector);\n}\n\n// Works up the tree to the draggable itself attempting to match selector.\nfunction matchesSelectorAndParentsTo(el /*: Node*/, selector /*: string*/, baseNode /*: Node*/) /*: boolean*/{\n  let node = el;\n  do {\n    if (matchesSelector(node, selector)) return true;\n    if (node === baseNode) return false;\n    // $FlowIgnore[incompatible-type]\n    node = node.parentNode;\n  } while (node);\n  return false;\n}\nfunction addEvent(el /*: ?Node*/, event /*: string*/, handler /*: Function*/, inputOptions /*: Object*/) /*: void*/{\n  if (!el) return;\n  const options = {\n    capture: true,\n    ...inputOptions\n  };\n  // $FlowIgnore[method-unbinding]\n  if (el.addEventListener) {\n    el.addEventListener(event, handler, options);\n  } else if (el.attachEvent) {\n    el.attachEvent('on' + event, handler);\n  } else {\n    // $FlowIgnore: Doesn't think elements are indexable\n    el['on' + event] = handler;\n  }\n}\nfunction removeEvent(el /*: ?Node*/, event /*: string*/, handler /*: Function*/, inputOptions /*: Object*/) /*: void*/{\n  if (!el) return;\n  const options = {\n    capture: true,\n    ...inputOptions\n  };\n  // $FlowIgnore[method-unbinding]\n  if (el.removeEventListener) {\n    el.removeEventListener(event, handler, options);\n  } else if (el.detachEvent) {\n    el.detachEvent('on' + event, handler);\n  } else {\n    // $FlowIgnore: Doesn't think elements are indexable\n    el['on' + event] = null;\n  }\n}\nfunction outerHeight(node /*: HTMLElement*/) /*: number*/{\n  // This is deliberately excluding margin for our calculations, since we are using\n  // offsetTop which is including margin. See getBoundPosition\n  let height = node.clientHeight;\n  const computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n  height += (0, _shims.int)(computedStyle.borderTopWidth);\n  height += (0, _shims.int)(computedStyle.borderBottomWidth);\n  return height;\n}\nfunction outerWidth(node /*: HTMLElement*/) /*: number*/{\n  // This is deliberately excluding margin for our calculations, since we are using\n  // offsetLeft which is including margin. See getBoundPosition\n  let width = node.clientWidth;\n  const computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n  width += (0, _shims.int)(computedStyle.borderLeftWidth);\n  width += (0, _shims.int)(computedStyle.borderRightWidth);\n  return width;\n}\nfunction innerHeight(node /*: HTMLElement*/) /*: number*/{\n  let height = node.clientHeight;\n  const computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n  height -= (0, _shims.int)(computedStyle.paddingTop);\n  height -= (0, _shims.int)(computedStyle.paddingBottom);\n  return height;\n}\nfunction innerWidth(node /*: HTMLElement*/) /*: number*/{\n  let width = node.clientWidth;\n  const computedStyle = node.ownerDocument.defaultView.getComputedStyle(node);\n  width -= (0, _shims.int)(computedStyle.paddingLeft);\n  width -= (0, _shims.int)(computedStyle.paddingRight);\n  return width;\n}\n/*:: interface EventWithOffset {\n  clientX: number, clientY: number\n}*/\n// Get from offsetParent\nfunction offsetXYFromParent(evt /*: EventWithOffset*/, offsetParent /*: HTMLElement*/, scale /*: number*/) /*: ControlPosition*/{\n  const isBody = offsetParent === offsetParent.ownerDocument.body;\n  const offsetParentRect = isBody ? {\n    left: 0,\n    top: 0\n  } : offsetParent.getBoundingClientRect();\n  const x = (evt.clientX + offsetParent.scrollLeft - offsetParentRect.left) / scale;\n  const y = (evt.clientY + offsetParent.scrollTop - offsetParentRect.top) / scale;\n  return {\n    x,\n    y\n  };\n}\nfunction createCSSTransform(controlPos /*: ControlPosition*/, positionOffset /*: PositionOffsetControlPosition*/) /*: Object*/{\n  const translation = getTranslation(controlPos, positionOffset, 'px');\n  return {\n    [(0, _getPrefix.browserPrefixToKey)('transform', _getPrefix.default)]: translation\n  };\n}\nfunction createSVGTransform(controlPos /*: ControlPosition*/, positionOffset /*: PositionOffsetControlPosition*/) /*: string*/{\n  const translation = getTranslation(controlPos, positionOffset, '');\n  return translation;\n}\nfunction getTranslation(_ref /*:: */, positionOffset /*: PositionOffsetControlPosition*/, unitSuffix /*: string*/) /*: string*/{\n  let {\n    x,\n    y\n  } /*: ControlPosition*/ = _ref /*: ControlPosition*/;\n  let translation = \"translate(\".concat(x).concat(unitSuffix, \",\").concat(y).concat(unitSuffix, \")\");\n  if (positionOffset) {\n    const defaultX = \"\".concat(typeof positionOffset.x === 'string' ? positionOffset.x : positionOffset.x + unitSuffix);\n    const defaultY = \"\".concat(typeof positionOffset.y === 'string' ? positionOffset.y : positionOffset.y + unitSuffix);\n    translation = \"translate(\".concat(defaultX, \", \").concat(defaultY, \")\") + translation;\n  }\n  return translation;\n}\nfunction getTouch(e /*: MouseTouchEvent*/, identifier /*: number*/) /*: ?{clientX: number, clientY: number}*/{\n  return e.targetTouches && (0, _shims.findInArray)(e.targetTouches, t => identifier === t.identifier) || e.changedTouches && (0, _shims.findInArray)(e.changedTouches, t => identifier === t.identifier);\n}\nfunction getTouchIdentifier(e /*: MouseTouchEvent*/) /*: ?number*/{\n  if (e.targetTouches && e.targetTouches[0]) return e.targetTouches[0].identifier;\n  if (e.changedTouches && e.changedTouches[0]) return e.changedTouches[0].identifier;\n}\n\n// User-select Hacks:\n//\n// Useful for preventing blue highlights all over everything when dragging.\n\n// Note we're passing `document` b/c we could be iframed\nfunction addUserSelectStyles(doc /*: ?Document*/) {\n  if (!doc) return;\n  let styleEl = doc.getElementById('react-draggable-style-el');\n  if (!styleEl) {\n    styleEl = doc.createElement('style');\n    styleEl.type = 'text/css';\n    styleEl.id = 'react-draggable-style-el';\n    styleEl.innerHTML = '.react-draggable-transparent-selection *::-moz-selection {all: inherit;}\\n';\n    styleEl.innerHTML += '.react-draggable-transparent-selection *::selection {all: inherit;}\\n';\n    doc.getElementsByTagName('head')[0].appendChild(styleEl);\n  }\n  if (doc.body) addClassName(doc.body, 'react-draggable-transparent-selection');\n}\nfunction removeUserSelectStyles(doc /*: ?Document*/) {\n  if (!doc) return;\n  try {\n    if (doc.body) removeClassName(doc.body, 'react-draggable-transparent-selection');\n    // $FlowIgnore: IE\n    if (doc.selection) {\n      // $FlowIgnore: IE\n      doc.selection.empty();\n    } else {\n      // Remove selection caused by scroll, unless it's a focused input\n      // (we use doc.defaultView in case we're in an iframe)\n      const selection = (doc.defaultView || window).getSelection();\n      if (selection && selection.type !== 'Caret') {\n        selection.removeAllRanges();\n      }\n    }\n  } catch (e) {\n    // probably IE\n  }\n}\nfunction addClassName(el /*: HTMLElement*/, className /*: string*/) {\n  if (el.classList) {\n    el.classList.add(className);\n  } else {\n    if (!el.className.match(new RegExp(\"(?:^|\\\\s)\".concat(className, \"(?!\\\\S)\")))) {\n      el.className += \" \".concat(className);\n    }\n  }\n}\nfunction removeClassName(el /*: HTMLElement*/, className /*: string*/) {\n  if (el.classList) {\n    el.classList.remove(className);\n  } else {\n    el.className = el.className.replace(new RegExp(\"(?:^|\\\\s)\".concat(className, \"(?!\\\\S)\"), 'g'), '');\n  }\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.browserPrefixToKey = browserPrefixToKey;\nexports.browserPrefixToStyle = browserPrefixToStyle;\nexports.default = void 0;\nexports.getPrefix = getPrefix;\nconst prefixes = ['Moz', 'Webkit', 'O', 'ms'];\nfunction getPrefix() /*: string*/{\n  var _window$document;\n  let prop /*: string*/ = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'transform';\n  // Ensure we're running in an environment where there is actually a global\n  // `window` obj\n  if (typeof window === 'undefined') return '';\n\n  // If we're in a pseudo-browser server-side environment, this access\n  // path may not exist, so bail out if it doesn't.\n  const style = (_window$document = window.document) === null || _window$document === void 0 || (_window$document = _window$document.documentElement) === null || _window$document === void 0 ? void 0 : _window$document.style;\n  if (!style) return '';\n  if (prop in style) return '';\n  for (let i = 0; i < prefixes.length; i++) {\n    if (browserPrefixToKey(prop, prefixes[i]) in style) return prefixes[i];\n  }\n  return '';\n}\nfunction browserPrefixToKey(prop /*: string*/, prefix /*: string*/) /*: string*/{\n  return prefix ? \"\".concat(prefix).concat(kebabToTitleCase(prop)) : prop;\n}\nfunction browserPrefixToStyle(prop /*: string*/, prefix /*: string*/) /*: string*/{\n  return prefix ? \"-\".concat(prefix.toLowerCase(), \"-\").concat(prop) : prop;\n}\nfunction kebabToTitleCase(str /*: string*/) /*: string*/{\n  let out = '';\n  let shouldCapitalize = true;\n  for (let i = 0; i < str.length; i++) {\n    if (shouldCapitalize) {\n      out += str[i].toUpperCase();\n      shouldCapitalize = false;\n    } else if (str[i] === '-') {\n      shouldCapitalize = true;\n    } else {\n      out += str[i];\n    }\n  }\n  return out;\n}\n\n// Default export is the prefix itself, like 'Moz', 'Webkit', etc\n// Note that you may have to re-test for certain things; for instance, Chrome 50\n// can handle unprefixed `transform`, but not unprefixed `user-select`\nvar _default = exports.default = (getPrefix() /*: string*/);","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = log;\n/*eslint no-console:0*/\nfunction log() {\n  if (undefined) console.log(...arguments);\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.canDragX = canDragX;\nexports.canDragY = canDragY;\nexports.createCoreData = createCoreData;\nexports.createDraggableData = createDraggableData;\nexports.getBoundPosition = getBoundPosition;\nexports.getControlPosition = getControlPosition;\nexports.snapToGrid = snapToGrid;\nvar _shims = require(\"./shims\");\nvar _domFns = require(\"./domFns\");\n/*:: import type Draggable from '../Draggable';*/\n/*:: import type {Bounds, ControlPosition, DraggableData, MouseTouchEvent} from './types';*/\n/*:: import type DraggableCore from '../DraggableCore';*/\nfunction getBoundPosition(draggable /*: Draggable*/, x /*: number*/, y /*: number*/) /*: [number, number]*/{\n  // If no bounds, short-circuit and move on\n  if (!draggable.props.bounds) return [x, y];\n\n  // Clone new bounds\n  let {\n    bounds\n  } = draggable.props;\n  bounds = typeof bounds === 'string' ? bounds : cloneBounds(bounds);\n  const node = findDOMNode(draggable);\n  if (typeof bounds === 'string') {\n    const {\n      ownerDocument\n    } = node;\n    const ownerWindow = ownerDocument.defaultView;\n    let boundNode;\n    if (bounds === 'parent') {\n      boundNode = node.parentNode;\n    } else {\n      boundNode = ownerDocument.querySelector(bounds);\n    }\n    if (!(boundNode instanceof ownerWindow.HTMLElement)) {\n      throw new Error('Bounds selector \"' + bounds + '\" could not find an element.');\n    }\n    const boundNodeEl /*: HTMLElement*/ = boundNode; // for Flow, can't seem to refine correctly\n    const nodeStyle = ownerWindow.getComputedStyle(node);\n    const boundNodeStyle = ownerWindow.getComputedStyle(boundNodeEl);\n    // Compute bounds. This is a pain with padding and offsets but this gets it exactly right.\n    bounds = {\n      left: -node.offsetLeft + (0, _shims.int)(boundNodeStyle.paddingLeft) + (0, _shims.int)(nodeStyle.marginLeft),\n      top: -node.offsetTop + (0, _shims.int)(boundNodeStyle.paddingTop) + (0, _shims.int)(nodeStyle.marginTop),\n      right: (0, _domFns.innerWidth)(boundNodeEl) - (0, _domFns.outerWidth)(node) - node.offsetLeft + (0, _shims.int)(boundNodeStyle.paddingRight) - (0, _shims.int)(nodeStyle.marginRight),\n      bottom: (0, _domFns.innerHeight)(boundNodeEl) - (0, _domFns.outerHeight)(node) - node.offsetTop + (0, _shims.int)(boundNodeStyle.paddingBottom) - (0, _shims.int)(nodeStyle.marginBottom)\n    };\n  }\n\n  // Keep x and y below right and bottom limits...\n  if ((0, _shims.isNum)(bounds.right)) x = Math.min(x, bounds.right);\n  if ((0, _shims.isNum)(bounds.bottom)) y = Math.min(y, bounds.bottom);\n\n  // But above left and top limits.\n  if ((0, _shims.isNum)(bounds.left)) x = Math.max(x, bounds.left);\n  if ((0, _shims.isNum)(bounds.top)) y = Math.max(y, bounds.top);\n  return [x, y];\n}\nfunction snapToGrid(grid /*: [number, number]*/, pendingX /*: number*/, pendingY /*: number*/) /*: [number, number]*/{\n  const x = Math.round(pendingX / grid[0]) * grid[0];\n  const y = Math.round(pendingY / grid[1]) * grid[1];\n  return [x, y];\n}\nfunction canDragX(draggable /*: Draggable*/) /*: boolean*/{\n  return draggable.props.axis === 'both' || draggable.props.axis === 'x';\n}\nfunction canDragY(draggable /*: Draggable*/) /*: boolean*/{\n  return draggable.props.axis === 'both' || draggable.props.axis === 'y';\n}\n\n// Get {x, y} positions from event.\nfunction getControlPosition(e /*: MouseTouchEvent*/, touchIdentifier /*: ?number*/, draggableCore /*: DraggableCore*/) /*: ?ControlPosition*/{\n  const touchObj = typeof touchIdentifier === 'number' ? (0, _domFns.getTouch)(e, touchIdentifier) : null;\n  if (typeof touchIdentifier === 'number' && !touchObj) return null; // not the right touch\n  const node = findDOMNode(draggableCore);\n  // User can provide an offsetParent if desired.\n  const offsetParent = draggableCore.props.offsetParent || node.offsetParent || node.ownerDocument.body;\n  return (0, _domFns.offsetXYFromParent)(touchObj || e, offsetParent, draggableCore.props.scale);\n}\n\n// Create an data object exposed by <DraggableCore>'s events\nfunction createCoreData(draggable /*: DraggableCore*/, x /*: number*/, y /*: number*/) /*: DraggableData*/{\n  const isStart = !(0, _shims.isNum)(draggable.lastX);\n  const node = findDOMNode(draggable);\n  if (isStart) {\n    // If this is our first move, use the x and y as last coords.\n    return {\n      node,\n      deltaX: 0,\n      deltaY: 0,\n      lastX: x,\n      lastY: y,\n      x,\n      y\n    };\n  } else {\n    // Otherwise calculate proper values.\n    return {\n      node,\n      deltaX: x - draggable.lastX,\n      deltaY: y - draggable.lastY,\n      lastX: draggable.lastX,\n      lastY: draggable.lastY,\n      x,\n      y\n    };\n  }\n}\n\n// Create an data exposed by <Draggable>'s events\nfunction createDraggableData(draggable /*: Draggable*/, coreData /*: DraggableData*/) /*: DraggableData*/{\n  const scale = draggable.props.scale;\n  return {\n    node: coreData.node,\n    x: draggable.state.x + coreData.deltaX / scale,\n    y: draggable.state.y + coreData.deltaY / scale,\n    deltaX: coreData.deltaX / scale,\n    deltaY: coreData.deltaY / scale,\n    lastX: draggable.state.x,\n    lastY: draggable.state.y\n  };\n}\n\n// A lot faster than stringify/parse\nfunction cloneBounds(bounds /*: Bounds*/) /*: Bounds*/{\n  return {\n    left: bounds.left,\n    top: bounds.top,\n    right: bounds.right,\n    bottom: bounds.bottom\n  };\n}\nfunction findDOMNode(draggable /*: Draggable | DraggableCore*/) /*: HTMLElement*/{\n  const node = draggable.findDOMNode();\n  if (!node) {\n    throw new Error('<DraggableCore>: Unmounted during event!');\n  }\n  // $FlowIgnore we can't assert on HTMLElement due to tests... FIXME\n  return node;\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.dontSetMe = dontSetMe;\nexports.findInArray = findInArray;\nexports.int = int;\nexports.isFunction = isFunction;\nexports.isNum = isNum;\n// @credits https://gist.github.com/rogozhnikoff/a43cfed27c41e4e68cdc\nfunction findInArray(array /*: Array<any> | TouchList*/, callback /*: Function*/) /*: any*/{\n  for (let i = 0, length = array.length; i < length; i++) {\n    if (callback.apply(callback, [array[i], i, array])) return array[i];\n  }\n}\nfunction isFunction(func /*: any*/) /*: boolean %checks*/{\n  // $FlowIgnore[method-unbinding]\n  return typeof func === 'function' || Object.prototype.toString.call(func) === '[object Function]';\n}\nfunction isNum(num /*: any*/) /*: boolean %checks*/{\n  return typeof num === 'number' && !isNaN(num);\n}\nfunction int(a /*: string*/) /*: number*/{\n  return parseInt(a, 10);\n}\nfunction dontSetMe(props /*: Object*/, propName /*: string*/, componentName /*: string*/) /*: ?Error*/{\n  if (props[propName]) {\n    return new Error(\"Invalid prop \".concat(propName, \" passed to \").concat(componentName, \" - do not set this, set it on the child.\"));\n  }\n}","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","export class CloudFile {\r\n  private name: string;\r\n  private url: string;\r\n\r\n  constructor({ name, url }: { name: string; url: string }) {\r\n    this.name = name;\r\n    this.url = url;\r\n  }\r\n\r\n  getUrl(): string {\r\n    return this.url;\r\n  }\r\n\r\n  getName(): string {\r\n    return this.name;\r\n  }\r\n\r\n  toString(): string {\r\n    return this.url;\r\n  }\r\n}\r\n","import { Model } from \"../model\";\r\nimport { Collection } from \"../collection\";\r\nimport { CloudFile } from \"./cloudfile\";\r\nimport { EventEmitter } from \"eventemitter3\";\r\nimport NoodlRuntime from \"../runtime\";\r\n\r\ninterface ProtectedFields {\r\n  _common: string[];\r\n  _User: string[];\r\n  [key: string]: string[];\r\n}\r\n\r\nconst _protectedFields: ProtectedFields = {\r\n  _common: [\"_createdAt\", \"_updatedAt\", \"objectId\"],\r\n  _User: [\"_email_verify_token\"],\r\n};\r\n\r\ninterface CloudCollection {\r\n  name: string;\r\n  schema: {\r\n    properties?: {\r\n      [key: string]: {\r\n        type: string;\r\n        targetClass?: string;\r\n      };\r\n    };\r\n  };\r\n}\r\n\r\ninterface CloudStoreOptions {\r\n  collection: string;\r\n  objectId?: string;\r\n  where?: any;\r\n  limit?: number;\r\n  skip?: number;\r\n  include?: string[] | string;\r\n  select?: string[] | string;\r\n  sort?: string[] | string;\r\n  count?: boolean;\r\n  keys?: string[] | string;\r\n  excludeKeys?: string[] | string;\r\n  data?: any;\r\n  acl?: any;\r\n  properties?: { [key: string]: number };\r\n  key?: string;\r\n  targetObjectId?: string;\r\n  targetClass?: string;\r\n  file?: File;\r\n  success: (data?: any, count?: number) => void;\r\n  error: (error?: any) => void;\r\n  onUploadProgress?: (progress: ProgressEvent) => void;\r\n}\r\n\r\ninterface GroupOptions {\r\n  avg?: string;\r\n  sum?: string;\r\n  max?: string;\r\n  min?: string;\r\n  distinct?: string;\r\n}\r\n\r\ninterface AggregateOptions extends CloudStoreOptions {\r\n  group: { [key: string]: GroupOptions };\r\n}\r\n\r\nfunction _removeProtectedFields(data: any, className?: string): any {\r\n  const _data = Object.assign({}, data);\r\n  _protectedFields._common.forEach((f) => delete _data[f]);\r\n  if (className && _protectedFields[className])\r\n    _protectedFields[className].forEach((f) => delete _data[f]);\r\n\r\n  return _data;\r\n}\r\n\r\nexport class CloudStore {\r\n  static _instance: CloudStore;\r\n  static get instance() {\r\n    if (CloudStore._instance === undefined)\r\n      CloudStore._instance = new CloudStore();\r\n    return CloudStore._instance;\r\n  }\r\n\r\n  static _collections: { [key: string]: CloudCollection } | undefined;\r\n  static get collections() {\r\n    if (CloudStore._collections === undefined) {\r\n      CloudStore._collections = {};\r\n      const dbCollections =\r\n        NoodlRuntime.instance.getMetaData(\"dbCollections\") || [];\r\n      dbCollections.forEach((c) => {\r\n        if (CloudStore._collections) {\r\n          CloudStore._collections[c.name] = c;\r\n        }\r\n      });\r\n\r\n      const systemCollections =\r\n        NoodlRuntime.instance.getMetaData(\"systemCollections\") || [];\r\n      systemCollections.forEach((c) => {\r\n        if (CloudStore._collections) {\r\n          CloudStore._collections[c.name] = c;\r\n        }\r\n      });\r\n    }\r\n    return CloudStore._collections;\r\n  }\r\n\r\n  appId?: string;\r\n  private endpoint?: string;\r\n  private dbVersionMajor?: number;\r\n  private events: EventEmitter;\r\n  private modelScope: typeof Model;\r\n\r\n  constructor(modelScope?: typeof Model) {\r\n    this._initCloudServices();\r\n\r\n    this.events = new EventEmitter();\r\n    // this.events.setMaxListeners(10000);\r\n    this.modelScope = modelScope || Model;\r\n  }\r\n\r\n  _fromJSON(\r\n    item: Parameters<typeof CloudStore._fromJSON>[0],\r\n    collectionName: Parameters<typeof CloudStore._fromJSON>[1]\r\n  ) {\r\n    return CloudStore._fromJSON(item, collectionName, this.modelScope);\r\n  }\r\n\r\n  _deserializeJSON(\r\n    data: Parameters<typeof CloudStore._deserializeJSON>[0],\r\n    type: Parameters<typeof CloudStore._deserializeJSON>[1]\r\n  ) {\r\n    return CloudStore._deserializeJSON(data, type, this.modelScope);\r\n  }\r\n\r\n  _serializeObject(\r\n    data: Parameters<typeof CloudStore._serializeObject>[0],\r\n    collectionName: Parameters<typeof CloudStore._serializeObject>[1]\r\n  ) {\r\n    return CloudStore._serializeObject(data, collectionName, this.modelScope);\r\n  }\r\n\r\n  _initCloudServices(): void {\r\n    CloudStore._collections = undefined; // clear collection cache, so it's refetched\r\n\r\n    const cloudServices = NoodlRuntime.instance.getMetaData(\"cloudservices\");\r\n    if (cloudServices) {\r\n      this.appId = cloudServices.appId;\r\n      this.endpoint = cloudServices.endpoint;\r\n    }\r\n\r\n    const dbVersionMajor = NoodlRuntime.instance.getMetaData(\"dbVersionMajor\");\r\n    this.dbVersionMajor = dbVersionMajor;\r\n  }\r\n\r\n  on(\r\n    event: string | symbol,\r\n    fn: (...args: any[]) => void,\r\n    context?: any\r\n  ): void {\r\n    this.events.on.apply(this.events, [event, fn, context]);\r\n  }\r\n\r\n  off(\r\n    event: string | symbol,\r\n    fn?: (...args: any[]) => void,\r\n    context?: any,\r\n    once?: boolean\r\n  ): void {\r\n    this.events.off.apply(this.events, [event, fn, context, once]);\r\n  }\r\n\r\n  private _makeRequest(\r\n    path: string,\r\n    options: {\r\n      method?: string;\r\n      content?: any;\r\n      contentType?: string;\r\n      success: (response: any) => void;\r\n      error: (error: any) => void;\r\n      onUploadProgress?: (progress: ProgressEvent) => void;\r\n    }\r\n  ): void {\r\n    if (!this.appId) throw new Error(\"App ID is not set\");\r\n\r\n    // @ts-expect-error _noodl_cloud_runtime_version\r\n    if (typeof _noodl_cloud_runtime_version === \"undefined\") {\r\n      // Running in browser\r\n      const xhr = new XMLHttpRequest();\r\n\r\n      xhr.onreadystatechange = function () {\r\n        if (xhr.readyState === 4) {\r\n          let json;\r\n          try {\r\n            // In SSR, we dont have xhr.response\r\n            json = JSON.parse(xhr.response || xhr.responseText);\r\n          } catch (e) {}\r\n\r\n          if (xhr.status === 200 || xhr.status === 201) {\r\n            options.success(json);\r\n          } else\r\n            options.error(\r\n              json || { error: xhr.responseText, status: xhr.status }\r\n            );\r\n        }\r\n      };\r\n\r\n      xhr.open(options.method || \"GET\", this.endpoint + path, true);\r\n\r\n      xhr.setRequestHeader(\"X-Parse-Application-Id\", this.appId);\r\n      // @ts-expect-error\r\n      if (typeof _noodl_cloudservices !== \"undefined\") {\r\n        xhr.setRequestHeader(\r\n          \"X-Parse-Master-Key\",\r\n          // @ts-expect-error\r\n          _noodl_cloudservices.masterKey\r\n        );\r\n      }\r\n\r\n      // Check for current users\r\n      const _cu = localStorage[\"Parse/\" + this.appId + \"/currentUser\"];\r\n      if (_cu !== undefined) {\r\n        try {\r\n          const currentUser = JSON.parse(_cu);\r\n          xhr.setRequestHeader(\r\n            \"X-Parse-Session-Token\",\r\n            currentUser.sessionToken\r\n          );\r\n        } catch (e) {\r\n          // Failed to extract session token\r\n        }\r\n      }\r\n\r\n      if (options.onUploadProgress) {\r\n        xhr.upload.onprogress = (pe) => {\r\n          if (options.onUploadProgress) {\r\n            options.onUploadProgress(pe);\r\n          }\r\n        };\r\n      }\r\n\r\n      if (options.content instanceof File) {\r\n        xhr.send(options.content);\r\n      } else {\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n        xhr.send(JSON.stringify(options.content));\r\n      }\r\n    } else {\r\n      // Running in cloud runtime\r\n      const endpoint =\r\n        // @ts-expect-error\r\n        typeof _noodl_cloudservices !== \"undefined\"\r\n          ? // @ts-expect-error\r\n            _noodl_cloudservices.endpoint\r\n          : this.endpoint;\r\n      const appId =\r\n        // @ts-expect-error\r\n        typeof _noodl_cloudservices !== \"undefined\"\r\n          ? // @ts-expect-error\r\n            _noodl_cloudservices.appId\r\n          : this.appId;\r\n      const masterKey =\r\n        // @ts-expect-error\r\n        typeof _noodl_cloudservices !== \"undefined\"\r\n          ? // @ts-expect-error\r\n            _noodl_cloudservices.masterKey\r\n          : undefined;\r\n\r\n      fetch(endpoint + path, {\r\n        method: options.method || \"GET\",\r\n        headers: {\r\n          \"X-Parse-Application-Id\": appId,\r\n          \"X-Parse-Master-Key\": masterKey,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(options.content),\r\n      })\r\n        .then((r) => {\r\n          if (r.status === 200 || r.status === 201) {\r\n            if (options.method === \"DELETE\") {\r\n              options.success(undefined);\r\n            } else {\r\n              r.json()\r\n                .then((json) => options.success(json))\r\n                .catch((e) =>\r\n                  options.error({\r\n                    error: \"CloudStore: Failed to get json result.\",\r\n                  })\r\n                );\r\n            }\r\n          } else {\r\n            if (options.method === \"DELETE\") {\r\n              options.error({ error: \"Failed to delete.\" });\r\n            } else {\r\n              r.json()\r\n                .then((json) => options.error(json))\r\n                .catch((e) => options.error({ error: \"Failed to fetch.\" }));\r\n            }\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          options.error({ error: e.message });\r\n        });\r\n    }\r\n  }\r\n\r\n  query(options: CloudStoreOptions): void {\r\n    this._makeRequest(\"/classes/\" + options.collection, {\r\n      method: \"POST\",\r\n      content: {\r\n        _method: \"GET\",\r\n        where: options.where,\r\n        limit: options.limit,\r\n        skip: options.skip,\r\n        include: Array.isArray(options.include)\r\n          ? options.include.join(\",\")\r\n          : options.include,\r\n        keys: Array.isArray(options.select)\r\n          ? options.select.join(\",\")\r\n          : options.select,\r\n        order: Array.isArray(options.sort)\r\n          ? options.sort.join(\",\")\r\n          : options.sort,\r\n        count: options.count,\r\n      },\r\n      success: function (response) {\r\n        options.success(response.results, response.count);\r\n      },\r\n      error: function () {\r\n        options.error();\r\n      },\r\n    });\r\n  }\r\n\r\n  aggregate(options: AggregateOptions): void {\r\n    const args: string[] = [];\r\n\r\n    if (!options.group) {\r\n      options.error(\"You need to provide group option.\");\r\n      return;\r\n    }\r\n\r\n    if (options.limit) args.push(\"limit=\" + options.limit);\r\n    if (options.skip) args.push(\"skip=\" + options.skip);\r\n\r\n    const grouping: { [key: string]: any } = {};\r\n\r\n    Object.keys(options.group).forEach((k) => {\r\n      const _g: { [key: string]: string } = {};\r\n      const group = options.group[k];\r\n      if (group[\"avg\"] !== undefined) _g[\"$avg\"] = \"$\" + group[\"avg\"];\r\n      else if (group[\"sum\"] !== undefined) _g[\"$sum\"] = \"$\" + group[\"sum\"];\r\n      else if (group[\"max\"] !== undefined) _g[\"$max\"] = \"$\" + group[\"max\"];\r\n      else if (group[\"min\"] !== undefined) _g[\"$min\"] = \"$\" + group[\"min\"];\r\n      else if (group[\"distinct\"] !== undefined)\r\n        _g[\"$addToSet\"] = \"$\" + group[\"distinct\"];\r\n\r\n      grouping[k] = _g;\r\n    });\r\n\r\n    // I don't know which version the API was changed, lets just say above 4 for now.\r\n    if (this.dbVersionMajor && this.dbVersionMajor > 4) {\r\n      grouping._id = null;\r\n\r\n      if (options.where)\r\n        args.push(\r\n          \"$match=\" + encodeURIComponent(JSON.stringify(options.where))\r\n        );\r\n\r\n      args.push(\"$group=\" + JSON.stringify(grouping));\r\n    } else {\r\n      grouping.objectId = null;\r\n\r\n      if (options.where)\r\n        args.push(\"match=\" + encodeURIComponent(JSON.stringify(options.where)));\r\n\r\n      args.push(\"group=\" + JSON.stringify(grouping));\r\n    }\r\n\r\n    this._makeRequest(\r\n      \"/aggregate/\" +\r\n        options.collection +\r\n        (args.length > 0 ? \"?\" + args.join(\"&\") : \"\"),\r\n      {\r\n        success: function (response) {\r\n          const res: { [key: string]: any } = {};\r\n\r\n          if (!response.results || response.results.length !== 1) {\r\n            options.success({}); // No result\r\n            return;\r\n          }\r\n\r\n          Object.keys(options.group).forEach((k) => {\r\n            res[k] = response.results[0][k];\r\n          });\r\n\r\n          options.success(res);\r\n        },\r\n        error: function () {\r\n          options.error();\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  count(options: CloudStoreOptions): void {\r\n    const args: string[] = [];\r\n\r\n    if (options.where)\r\n      args.push(\"where=\" + encodeURIComponent(JSON.stringify(options.where)));\r\n    args.push(\"limit=0\");\r\n    args.push(\"count=1\");\r\n\r\n    this._makeRequest(\r\n      \"/classes/\" +\r\n        options.collection +\r\n        (args.length > 0 ? \"?\" + args.join(\"&\") : \"\"),\r\n      {\r\n        success: function (response) {\r\n          options.success(response.count);\r\n        },\r\n        error: function () {\r\n          options.error();\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  distinct(options: CloudStoreOptions & { property: string }): void {\r\n    const args: string[] = [];\r\n\r\n    if (options.where)\r\n      args.push(\"where=\" + encodeURIComponent(JSON.stringify(options.where)));\r\n    args.push(\"distinct=\" + options.property);\r\n\r\n    this._makeRequest(\r\n      \"/aggregate/\" +\r\n        options.collection +\r\n        (args.length > 0 ? \"?\" + args.join(\"&\") : \"\"),\r\n      {\r\n        success: function (response) {\r\n          options.success(response.results);\r\n        },\r\n        error: function () {\r\n          options.error();\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  fetch(options: CloudStoreOptions): void {\r\n    const args: string[] = [];\r\n\r\n    if (options.include) {\r\n      args.push(\r\n        \"include=\" +\r\n          (Array.isArray(options.include)\r\n            ? options.include.join(\",\")\r\n            : options.include)\r\n      );\r\n    }\r\n\r\n    if (options.keys) {\r\n      args.push(\r\n        \"keys=\" +\r\n          (Array.isArray(options.keys) ? options.keys.join(\",\") : options.keys)\r\n      );\r\n    }\r\n\r\n    if (options.excludeKeys) {\r\n      args.push(\r\n        \"excludeKeys=\" +\r\n          (Array.isArray(options.excludeKeys)\r\n            ? options.excludeKeys.join(\",\")\r\n            : options.excludeKeys)\r\n      );\r\n    }\r\n\r\n    this._makeRequest(\r\n      \"/classes/\" +\r\n        options.collection +\r\n        \"/\" +\r\n        options.objectId +\r\n        (args.length > 0 ? \"?\" + args.join(\"&\") : \"\"),\r\n      {\r\n        method: \"GET\",\r\n        success: (response) => {\r\n          options.success(response);\r\n          this.events.emit(\"fetch\", {\r\n            type: \"fetch\",\r\n            objectId: options.objectId,\r\n            object: response,\r\n            collection: options.collection,\r\n          });\r\n        },\r\n        error: function (res) {\r\n          options.error(res.error);\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  create(options: CloudStoreOptions): void {\r\n    this._makeRequest(\"/classes/\" + options.collection, {\r\n      method: \"POST\",\r\n      content: Object.assign(\r\n        _removeProtectedFields(\r\n          CloudStore._serializeObject(options.data, options.collection),\r\n          options.collection\r\n        ),\r\n        { ACL: options.acl }\r\n      ),\r\n      success: (response) => {\r\n        const _obj = Object.assign({}, options.data, response);\r\n        options.success(_obj);\r\n        this.events.emit(\"create\", {\r\n          type: \"create\",\r\n          objectId: options.objectId,\r\n          object: _obj,\r\n          collection: options.collection,\r\n        });\r\n      },\r\n      error: function (res) {\r\n        options.error(res.error);\r\n      },\r\n    });\r\n  }\r\n\r\n  increment(options: CloudStoreOptions): void {\r\n    const data: { [key: string]: { __op: string; amount: number } } = {};\r\n\r\n    for (let key in options.properties) {\r\n      data[key] = { __op: \"Increment\", amount: options.properties[key] };\r\n    }\r\n\r\n    this._makeRequest(\r\n      \"/classes/\" + options.collection + \"/\" + options.objectId,\r\n      {\r\n        method: \"PUT\",\r\n        content: data,\r\n        success: (response) => {\r\n          options.success(response);\r\n        },\r\n        error: function (res) {\r\n          options.error(res.error);\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  save(options: CloudStoreOptions): void {\r\n    const _data = Object.assign({}, options.data);\r\n    delete _data.createdAt;\r\n    delete _data.updatedAt;\r\n\r\n    this._makeRequest(\r\n      \"/classes/\" + options.collection + \"/\" + options.objectId,\r\n      {\r\n        method: \"PUT\",\r\n        content: Object.assign(\r\n          _removeProtectedFields(\r\n            CloudStore._serializeObject(_data, options.collection),\r\n            options.collection\r\n          ),\r\n          {\r\n            ACL: options.acl,\r\n          }\r\n        ),\r\n        success: (response) => {\r\n          options.success(response);\r\n          this.events.emit(\"save\", {\r\n            type: \"save\",\r\n            objectId: options.objectId,\r\n            object: Object.assign({}, options.data, response),\r\n            collection: options.collection,\r\n          });\r\n        },\r\n        error: function (res) {\r\n          options.error(res.error);\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  delete(options: CloudStoreOptions): void {\r\n    this._makeRequest(\r\n      \"/classes/\" + options.collection + \"/\" + options.objectId,\r\n      {\r\n        method: \"DELETE\",\r\n        success: () => {\r\n          options.success();\r\n          this.events.emit(\"delete\", {\r\n            type: \"delete\",\r\n            objectId: options.objectId,\r\n            collection: options.collection,\r\n          });\r\n        },\r\n        error: function (res) {\r\n          options.error(res.error);\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  addRelation(options: CloudStoreOptions): void {\r\n    if (!options.key) throw new Error(\"Key is required\");\r\n\r\n    const _content: { [key: string]: any } = {};\r\n    _content[options.key] = {\r\n      __op: \"AddRelation\",\r\n      objects: [\r\n        {\r\n          __type: \"Pointer\",\r\n          objectId: options.targetObjectId,\r\n          className: options.targetClass,\r\n        },\r\n      ],\r\n    };\r\n    this._makeRequest(\r\n      \"/classes/\" + options.collection + \"/\" + options.objectId,\r\n      {\r\n        method: \"PUT\",\r\n        content: _content,\r\n        success: function (response) {\r\n          options.success(response);\r\n        },\r\n        error: function (res) {\r\n          options.error(res.error);\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  removeRelation(options: CloudStoreOptions): void {\r\n    if (!options.key) throw new Error(\"Key is required\");\r\n\r\n    const _content: { [key: string]: any } = {};\r\n    _content[options.key] = {\r\n      __op: \"RemoveRelation\",\r\n      objects: [\r\n        {\r\n          __type: \"Pointer\",\r\n          objectId: options.targetObjectId,\r\n          className: options.targetClass,\r\n        },\r\n      ],\r\n    };\r\n    this._makeRequest(\r\n      \"/classes/\" + options.collection + \"/\" + options.objectId,\r\n      {\r\n        method: \"PUT\",\r\n        content: _content,\r\n        success: function (response) {\r\n          options.success(response);\r\n        },\r\n        error: function (res) {\r\n          options.error(res.error);\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  uploadFile(options: CloudStoreOptions): void {\r\n    if (!options.file) throw new Error(\"File is required\");\r\n\r\n    this._makeRequest(\"/files/\" + options.file.name, {\r\n      method: \"POST\",\r\n      content: options.file,\r\n      contentType: options.file.type,\r\n      success: (response) =>\r\n        options.success(Object.assign({}, options.data, response)),\r\n      error: (err) => options.error(err),\r\n      onUploadProgress: options.onUploadProgress,\r\n    });\r\n  }\r\n\r\n  deleteFile(options: CloudStoreOptions): void {\r\n    if (!options.file) throw new Error(\"File is required\");\r\n    this._makeRequest(\"/files/\" + options.file.name, {\r\n      method: \"DELETE\",\r\n      success: (response) =>\r\n        options.success(Object.assign({}, options.data, response)),\r\n      error: (err) => options.error(err),\r\n    });\r\n  }\r\n\r\n  // TODO: What is modelScope?\r\n  static forScope(modelScope?: typeof Model): CloudStore {\r\n    if (modelScope === undefined) return CloudStore.instance;\r\n    // @ts-expect-error\r\n    if (modelScope._cloudStore) return modelScope._cloudStore;\r\n\r\n    // @ts-expect-error\r\n    modelScope._cloudStore = new CloudStore(modelScope);\r\n    // @ts-expect-error\r\n    return modelScope._cloudStore;\r\n  }\r\n\r\n  static invalidateCollections(): void {\r\n    // @ts-expect-error\r\n    _collections = undefined;\r\n  }\r\n\r\n  static _fromJSON(\r\n    item: any,\r\n    collectionName: string,\r\n    modelScope?: typeof Model\r\n  ): any {\r\n    const modelStore = modelScope || Model;\r\n\r\n    const model = modelStore.get(item.objectId);\r\n    model._class = collectionName;\r\n\r\n    let schema;\r\n    if (\r\n      collectionName !== undefined &&\r\n      // @ts-expect-error\r\n      CloudStore._collections[collectionName] !== undefined\r\n    ) {\r\n      // @ts-expect-error\r\n      schema = CloudStore._collections[collectionName].schema;\r\n    }\r\n\r\n    for (const key in item) {\r\n      if (key === \"objectId\" || key === \"ACL\") {\r\n        continue;\r\n      }\r\n\r\n      const _type =\r\n        schema && schema.properties && schema.properties[key]\r\n          ? schema.properties[key].type\r\n          : undefined;\r\n      model.set(key, CloudStore._deserializeJSON(item[key], _type, modelScope));\r\n    }\r\n\r\n    return model;\r\n  }\r\n\r\n  static _serializeObject(\r\n    data: any,\r\n    collectionName: string,\r\n    modelScope?: typeof Model\r\n  ): any {\r\n    let schema;\r\n    // @ts-expect-error\r\n    if (CloudStore._collections[collectionName])\r\n      // @ts-expect-error\r\n      schema = CloudStore._collections[collectionName].schema;\r\n\r\n    for (const key in data) {\r\n      const _type =\r\n        schema && schema.properties && schema.properties[key]\r\n          ? schema.properties[key].type\r\n          : undefined;\r\n\r\n      if (data[key] === undefined || data[key] === null) {\r\n        // Keep null and undefined as is\r\n      } else if (_type === \"Pointer\" && typeof data[key] === \"string\") {\r\n        // This is a string pointer to an object\r\n        data[key] = {\r\n          __type: \"Pointer\",\r\n          className: schema.properties[key].targetClass,\r\n          objectId: data[key],\r\n        };\r\n      } else if (\r\n        _type === \"Pointer\" &&\r\n        typeof data[key] === \"object\" &&\r\n        (modelScope || Model).instanceOf(data[key])\r\n      ) {\r\n        // This is an embedded object that should be stored as pointer\r\n        data[key] = {\r\n          __type: \"Pointer\",\r\n          className: schema.properties[key].targetClass,\r\n          objectId: data[key].getId(),\r\n        };\r\n      } else if (\r\n        _type === \"Date\" &&\r\n        (typeof data[key] === \"string\" || data[key] instanceof Date)\r\n      ) {\r\n        data[key] = {\r\n          __type: \"Date\",\r\n          iso: data[key] instanceof Date ? data[key].toISOString() : data[key],\r\n        };\r\n      } else if (_type === \"File\" && data[key] instanceof CloudFile) {\r\n        const cloudFile = data[key];\r\n        data[key] = {\r\n          __type: \"File\",\r\n          url: cloudFile.getUrl(),\r\n          name: cloudFile.getName(),\r\n        };\r\n      } else if (\r\n        _type === \"Array\" &&\r\n        typeof data[key] === \"string\" &&\r\n        Collection.exists(data[key])\r\n      ) {\r\n        data[key] = _toJSON(Collection.get(data[key]));\r\n      } else if (\r\n        _type === \"Object\" &&\r\n        typeof data[key] === \"string\" &&\r\n        (modelScope || Model).exists(data[key])\r\n      ) {\r\n        data[key] = _toJSON((modelScope || Model).get(data[key]));\r\n      } else if (_type === \"GeoPoint\" && typeof data[key] === \"object\") {\r\n        data[key] = {\r\n          __type: \"GeoPoint\",\r\n          latitude: Number(data[key].latitude),\r\n          longitude: Number(data[key].longitude),\r\n        };\r\n      } else data[key] = _toJSON(data[key]);\r\n    }\r\n\r\n    return data;\r\n  }\r\n\r\n  static _deserializeJSON(\r\n    data: any,\r\n    type?: string,\r\n    modelScope?: typeof Model\r\n  ): any {\r\n    if (data === undefined) return;\r\n    if (data === null) return null;\r\n\r\n    if (type === \"Relation\" && data.__type === \"Relation\") {\r\n      return undefined; // Ignore relation fields\r\n    } else if (type === \"Pointer\" && data.__type === \"Pointer\") {\r\n      // This is a pointer type, resolve into id\r\n      return data.objectId;\r\n    } else if (type === \"Date\" && data.__type === \"Date\") {\r\n      return new Date(data.iso);\r\n    } else if (type === \"Date\" && typeof data === \"string\") {\r\n      return new Date(data);\r\n    } else if (type === \"File\" && data.__type === \"File\") {\r\n      return new CloudFile(data);\r\n    } else if (type === \"GeoPoint\" && data.__type === \"GeoPoint\") {\r\n      return {\r\n        latitude: data.latitude,\r\n        longitude: data.longitude,\r\n      };\r\n    } else if (_isArrayOfObjects(data)) {\r\n      const a: any[] = [];\r\n      for (let i = 0; i < data.length; i++) {\r\n        a.push(CloudStore._deserializeJSON(data[i], undefined, modelScope));\r\n      }\r\n      const c = Collection.get();\r\n      c.set(a);\r\n      return c;\r\n    } else if (Array.isArray(data)) return data;\r\n    // This is an array with mixed data, just return it\r\n    else if (\r\n      data &&\r\n      data.__type === \"Object\" &&\r\n      data.className !== undefined &&\r\n      data.objectId !== undefined\r\n    ) {\r\n      const _data = Object.assign({}, data);\r\n      delete _data.className;\r\n      delete _data.__type;\r\n      return CloudStore._fromJSON(_data, data.className, modelScope);\r\n    } else if (typeof data === \"object\" && data !== null) {\r\n      const m = (modelScope || Model).get();\r\n      for (const key in data) {\r\n        m.set(\r\n          key,\r\n          CloudStore._deserializeJSON(data[key], undefined, modelScope)\r\n        );\r\n      }\r\n      return m;\r\n    } else return data;\r\n  }\r\n}\r\n\r\nfunction _isArrayOfObjects(a: any[]): boolean {\r\n  if (!Array.isArray(a)) return false;\r\n  for (let i = 0; i < a.length; i++)\r\n    if (typeof a[i] !== \"object\" || a[i] === null) return false;\r\n\r\n  return true;\r\n}\r\n\r\nfunction _toJSON(obj: any): any {\r\n  if (obj instanceof Model) {\r\n    const res: { [key: string]: any } = {};\r\n    for (const key in obj.data) {\r\n      res[key] = _toJSON(obj.data[key]);\r\n    }\r\n    return res;\r\n  } else if (obj instanceof Collection) {\r\n    const res: any[] = [];\r\n    obj.items.forEach((m) => {\r\n      res.push(_toJSON(m));\r\n    });\r\n    return res;\r\n  }\r\n  return obj;\r\n}\r\n","import { Model } from \"./model\";\r\n\r\ninterface ListenerMap {\r\n  [key: string]: ((args: any) => Promise<void>)[];\r\n}\r\n\r\ndeclare global {\r\n  interface Array<T> {\r\n    items: T[];\r\n    each: typeof Array.prototype.forEach;\r\n    size(): number;\r\n    get(index: number): T;\r\n    getId(): string;\r\n    id: string;\r\n    set(src: T[]): void;\r\n    notify(event: string, args: any): Promise<void>;\r\n    contains(item: T): boolean;\r\n    add(item: T): Promise<void>;\r\n    remove(item: T): void;\r\n    addAtIndex(item: T, index: number): Promise<void>;\r\n    removeAtIndex(idx: number): Promise<void>;\r\n    on(event: string, listener: (args: any) => Promise<void>): void;\r\n    off(event: string, listener: (args: any) => Promise<void>): void;\r\n    _id?: string;\r\n    _listeners?: ListenerMap;\r\n  }\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"items\")) {\r\n  Object.defineProperty(Array.prototype, \"items\", {\r\n    enumerable: false,\r\n    get() {\r\n      return this;\r\n    },\r\n    set(data: any[]) {\r\n      this.set(data);\r\n    },\r\n  });\r\n}\r\n\r\nObject.defineProperty(Array.prototype, \"each\", {\r\n  enumerable: false,\r\n  writable: false,\r\n  value: Array.prototype.forEach,\r\n});\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"size\")) {\r\n  Object.defineProperty(Array.prototype, \"size\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: function (): number {\r\n      return this.length;\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"get\")) {\r\n  Object.defineProperty(Array.prototype, \"get\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: function <T>(index: number): T {\r\n      return this[index];\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"getId\")) {\r\n  Object.defineProperty(Array.prototype, \"getId\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: function (): string {\r\n      return this._id as string;\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"id\")) {\r\n  Object.defineProperty(Array.prototype, \"id\", {\r\n    enumerable: false,\r\n    get() {\r\n      return this.getId();\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"set\")) {\r\n  Object.defineProperty(Array.prototype, \"set\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: function <T extends Model>(src: T[]): void {\r\n      let length: number, i: number;\r\n\r\n      if (src === this) return;\r\n\r\n      src = src || []; //handle if src is undefined\r\n\r\n      function keyIndex(a: T[]): Record<string, T> {\r\n        const keys: Record<string, T> = {};\r\n        const length = a.length;\r\n        for (let i = 0; i < length; i++) {\r\n          const item = a[i];\r\n          keys[item.getId()] = item;\r\n        }\r\n        return keys;\r\n      }\r\n\r\n      // Src can be a collection, or an array\r\n      const bItems: T[] = [];\r\n      length = src.length;\r\n      for (i = 0; i < length; i++) {\r\n        const item = src[i];\r\n        if (Model.instanceOf(item)) bItems.push(item);\r\n        // @ts-expect-error TODO: What is this?\r\n        else bItems.push(Model.create(item));\r\n      }\r\n\r\n      const aItems = this.items;\r\n      const aKeys = keyIndex(aItems);\r\n      const bKeys = keyIndex(bItems);\r\n\r\n      // First remove all items not in the new collection\r\n      length = aItems.length;\r\n      for (i = 0; i < length; i++) {\r\n        if (!bKeys.hasOwnProperty(aItems[i].getId())) {\r\n          // This item is not present in new collection, remove it\r\n          this.removeAtIndex(i);\r\n          i--;\r\n          length--;\r\n        }\r\n      }\r\n\r\n      // Reorder items\r\n      for (i = 0; i < Math.min(aItems.length, bItems.length); i++) {\r\n        if (aItems[i] !== bItems[i]) {\r\n          if (aKeys.hasOwnProperty(bItems[i].getId())) {\r\n            // The bItem exist in the collection but is in the wrong place\r\n            this.remove(bItems[i]);\r\n          }\r\n\r\n          // This is a new item, add it at correct index\r\n          this.addAtIndex(bItems[i], i);\r\n        }\r\n      }\r\n\r\n      // Add remaining items\r\n      for (i = aItems.length; i < bItems.length; i++) {\r\n        this.add(bItems[i]);\r\n      }\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"notify\")) {\r\n  Object.defineProperty(Array.prototype, \"notify\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: async function (event: string, args: any): Promise<void> {\r\n      if (!this._listeners) return;\r\n      if (!this._listeners[event]) return;\r\n\r\n      const l = this._listeners[event].slice(); //clone in case listeners array is modified in the callbacks\r\n      for (let i = 0; i < l.length; i++) {\r\n        await l[i](args);\r\n      }\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"contains\")) {\r\n  Object.defineProperty(Array.prototype, \"contains\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: function <T>(item: T): boolean {\r\n      return this.indexOf(item) !== -1;\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"add\")) {\r\n  Object.defineProperty(Array.prototype, \"add\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: async function <T extends Model>(item: T): Promise<void> {\r\n      if (this.contains(item)) return; // Already contains item\r\n\r\n      this.items.push(item);\r\n      await this.notify(\"add\", { item: item, index: this.items.length - 1 });\r\n      await this.notify(\"change\");\r\n      item.notify(\"add\", { collection: this });\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"remove\")) {\r\n  Object.defineProperty(Array.prototype, \"remove\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: function <T>(item: T): void {\r\n      const idx = this.items.indexOf(item);\r\n      if (idx !== -1) this.removeAtIndex(idx);\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"addAtIndex\")) {\r\n  Object.defineProperty(Array.prototype, \"addAtIndex\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: async function <T extends Model>(\r\n      item: T,\r\n      index: number\r\n    ): Promise<void> {\r\n      if (this.contains(item)) return; // Already contains item\r\n\r\n      this.items.splice(index, 0, item);\r\n      await this.notify(\"add\", { item: item, index: index });\r\n      await this.notify(\"change\");\r\n      item.notify(\"add\", { collection: this, index: index });\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"removeAtIndex\")) {\r\n  Object.defineProperty(Array.prototype, \"removeAtIndex\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: async function (idx: number): Promise<void> {\r\n      const item = this.items[idx];\r\n      this.items.splice(idx, 1);\r\n      await this.notify(\"remove\", { item: item, index: idx });\r\n      await this.notify(\"change\");\r\n      await item.notify(\"remove\", { collection: this });\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"on\")) {\r\n  Object.defineProperty(Array.prototype, \"on\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: function (\r\n      event: string,\r\n      listener: (args: any) => Promise<void>\r\n    ): void {\r\n      if (!this._listeners)\r\n        Object.defineProperty(this, \"_listeners\", {\r\n          enumerable: false,\r\n          writable: false,\r\n          value: {},\r\n        });\r\n      if (!this._listeners[event]) this._listeners[event] = [];\r\n      this._listeners[event].push(listener);\r\n    },\r\n  });\r\n}\r\n\r\nif (!Object.prototype.hasOwnProperty.call(Array.prototype, \"off\")) {\r\n  Object.defineProperty(Array.prototype, \"off\", {\r\n    enumerable: false,\r\n    writable: false,\r\n    value: function (\r\n      event: string,\r\n      listener: (args: any) => Promise<void>\r\n    ): void {\r\n      if (!this._listeners) return;\r\n      if (!this._listeners[event]) return;\r\n      const idx = this._listeners[event].indexOf(listener);\r\n      if (idx !== -1) this._listeners[event].splice(idx, 1);\r\n    },\r\n  });\r\n}\r\n\r\nexport class Collection<T extends Model> extends Array<T> {\r\n  static _collections: Record<string, Collection<any>> = {};\r\n\r\n  static create<T extends Model>(items?: T[]): Collection<T> {\r\n    const name = Model.guid();\r\n    Collection._collections[name] = new Collection<T>();\r\n    Object.defineProperty(Collection._collections[name], \"_id\", {\r\n      enumerable: false,\r\n      writable: false,\r\n      value: name,\r\n    });\r\n    if (items) {\r\n      Collection._collections[name].set(items);\r\n    }\r\n    return Collection._collections[name];\r\n  }\r\n\r\n  static get<T extends Model>(name?: string): Collection<T> {\r\n    if (name === undefined) name = Model.guid();\r\n    if (!Collection._collections[name]) {\r\n      Collection._collections[name] = new Collection<T>();\r\n      Object.defineProperty(Collection._collections[name], \"_id\", {\r\n        enumerable: false,\r\n        writable: false,\r\n        value: name,\r\n      });\r\n    }\r\n\r\n    return Collection._collections[name];\r\n  }\r\n\r\n  static instanceOf(collection: any): boolean {\r\n    return collection instanceof Collection;\r\n  }\r\n\r\n  static exists(name: string): boolean {\r\n    return Collection._collections[name] !== undefined;\r\n  }\r\n}\r\n","interface SetterArgs {\r\n  valueChangedToTrue: () => void;\r\n}\r\n\r\nexport function createSetter(args: SetterArgs): (value: any) => void {\r\n  let currentValue: boolean = false;\r\n\r\n  return function (value: any): void {\r\n    value = value ? true : false;\r\n    // value changed from false to true\r\n    if (value && currentValue === false) {\r\n      // @ts-expect-error\r\n      args.valueChangedToTrue.call(this);\r\n    }\r\n    currentValue = value;\r\n  };\r\n}\r\n","import { randomString } from \"./utils\";\r\n\r\ninterface ModelData {\r\n  id?: string;\r\n  [key: string]: any;\r\n}\r\n\r\ninterface ModelSetArgs {\r\n  resolve?: boolean;\r\n  forceChange?: boolean;\r\n  silent?: boolean;\r\n}\r\n\r\ninterface ModelGetArgs {\r\n  resolve?: boolean;\r\n}\r\n\r\nexport class Model {\r\n  private id: string;\r\n  _class?: string;\r\n  data: ModelData;\r\n  private listeners?: Record<string, Function[]>;\r\n  private static _models: Record<string, Model> = {};\r\n\r\n  constructor(id: string, data: ModelData) {\r\n    this.id = id;\r\n    this.data = data;\r\n  }\r\n\r\n  private static models = Model._models;\r\n  private static proxies: Record<string, any> = {};\r\n\r\n  static _modelProxyHandler = {\r\n    get: function (target: Model, prop: string | symbol, receiver: any) {\r\n      if (typeof target[prop as keyof Model] === \"function\")\r\n        // @ts-expect-error\r\n        return target[prop as keyof Model].bind(target);\r\n      else if (prop in target) return Reflect.get(target, prop, receiver);\r\n      else return target.get(prop.toString());\r\n    },\r\n    set: function (obj: Model, prop: string | symbol, value: any) {\r\n      if (prop === \"_class\") {\r\n        (obj as any)._class = value;\r\n      } else if (prop === \"id\") {\r\n        console.log(\r\n          `Noodl.Object warning: id is readonly (Id is ${obj.id}, trying to set to ${value})`\r\n        );\r\n        return true;\r\n      } else {\r\n        obj.set(prop.toString(), value);\r\n      }\r\n      return true;\r\n    },\r\n    ownKeys(target: Model) {\r\n      return Reflect.ownKeys(target.data);\r\n    },\r\n    getOwnPropertyDescriptor(target: Model, prop: string | symbol) {\r\n      return Object.getOwnPropertyDescriptor(target.data, prop.toString());\r\n    },\r\n  };\r\n\r\n  static get(id?: string): Model {\r\n    if (id === undefined) id = Model.guid();\r\n    if (!Model.models[id]) {\r\n      Model.models[id] = new Model(id, {});\r\n      Model.proxies[id] = new Proxy(Model.models[id], Model._modelProxyHandler);\r\n    }\r\n    return Model.proxies[id];\r\n  }\r\n\r\n  static create(data?: ModelData): Model {\r\n    const modelData = data ? data : {};\r\n    const m = Model.get(modelData.id);\r\n    for (const key in modelData) {\r\n      if (key === \"id\") continue;\r\n      m.set(key, modelData[key]);\r\n    }\r\n    return m;\r\n  }\r\n\r\n  static exists(id: string): boolean {\r\n    return Model.models[id] !== undefined;\r\n  }\r\n\r\n  static instanceOf(collection: any): boolean {\r\n    return collection instanceof Model || collection.target instanceof Model;\r\n  }\r\n\r\n  static guid(): string {\r\n    return randomString(10);\r\n  }\r\n\r\n  on(event: string, listener: Function): void {\r\n    if (!this.listeners) this.listeners = {};\r\n    if (!this.listeners[event]) this.listeners[event] = [];\r\n    this.listeners[event].push(listener);\r\n  }\r\n\r\n  off(event: string, listener: Function): void {\r\n    if (!this.listeners) return;\r\n    if (!this.listeners[event]) return;\r\n    const idx = this.listeners[event].indexOf(listener);\r\n    if (idx !== -1) this.listeners[event].splice(idx, 1);\r\n  }\r\n\r\n  notify(event: string, args: any): void {\r\n    if (!this.listeners) return;\r\n    if (!this.listeners[event]) return;\r\n\r\n    const l = this.listeners[event].slice();\r\n    for (let i = 0; i < l.length; i++) {\r\n      l[i](args);\r\n    }\r\n  }\r\n\r\n  setAll(obj: ModelData): void {\r\n    for (const i in obj) {\r\n      if (i === \"id\") continue;\r\n      if (this.data[i] !== obj[i]) {\r\n        const old = this.data[i];\r\n        this.data[i] = obj[i];\r\n        this.notify(\"change\", { name: i, value: obj[i], old });\r\n      }\r\n    }\r\n  }\r\n\r\n  fill(value: any = null): void {\r\n    for (const key in this.data) {\r\n      if (key === \"id\") continue;\r\n      const temp = this.data[key];\r\n      this.data[key] = value;\r\n      this.notify(\"change\", { name: key, value: this.data[key], old: temp });\r\n    }\r\n  }\r\n\r\n  set(name: string, value: any, args?: ModelSetArgs): void {\r\n    if (args?.resolve && name.indexOf(\".\") !== -1) {\r\n      const path = name.split(\".\");\r\n      let model: Model = this;\r\n      for (let i = 0; i < path.length - 1; i++) {\r\n        const v = model.get(path[i]);\r\n        if (Model.instanceOf(v)) model = v;\r\n        else return;\r\n      }\r\n      model.set(path[path.length - 1], value);\r\n      return;\r\n    }\r\n\r\n    const forceChange = args?.forceChange;\r\n    const oldValue = this.data[name];\r\n    this.data[name] = value;\r\n\r\n    if ((forceChange || oldValue !== value) && !args?.silent) {\r\n      this.notify(\"change\", { name, value, old: oldValue });\r\n    }\r\n  }\r\n\r\n  getId(): string {\r\n    return this.id;\r\n  }\r\n\r\n  get(name: string, args?: ModelGetArgs): any {\r\n    if (args?.resolve && name.indexOf(\".\") !== -1) {\r\n      const path = name.split(\".\");\r\n      let model: Model = this;\r\n      for (let i = 0; i < path.length - 1; i++) {\r\n        const v = model.get(path[i]);\r\n        if (Model.instanceOf(v)) model = v;\r\n        else return;\r\n      }\r\n      return model.get(path[path.length - 1]);\r\n    }\r\n\r\n    return this.data[name];\r\n  }\r\n\r\n  toJSON(): ModelData {\r\n    return Object.assign({}, this.data, { id: this.id });\r\n  }\r\n}\r\n\r\nexport class ModelScope {\r\n  private models: Record<string, Model> = {};\r\n  private proxies: Record<string, any> = {};\r\n  private _cloudStore?: any;\r\n\r\n  get(id?: string): Model {\r\n    if (id === undefined) id = Model.guid();\r\n    if (!this.models[id]) {\r\n      this.models[id] = new Model(id, {});\r\n      this.proxies[id] = new Proxy(this.models[id], Model._modelProxyHandler);\r\n    }\r\n    return this.proxies[id];\r\n  }\r\n\r\n  create(data?: ModelData): Model {\r\n    const modelData = data ? data : {};\r\n    const m = this.get(modelData.id);\r\n    for (const key in modelData) {\r\n      if (key === \"id\") continue;\r\n      m.set(key, modelData[key]);\r\n    }\r\n    return m;\r\n  }\r\n\r\n  exists(id: string): boolean {\r\n    return this.models[id] !== undefined;\r\n  }\r\n\r\n  instanceOf(collection: any): boolean {\r\n    return collection instanceof Model || collection.target instanceof Model;\r\n  }\r\n\r\n  guid(): string {\r\n    return randomString(10);\r\n  }\r\n\r\n  reset(): void {\r\n    this.models = {};\r\n    this.proxies = {};\r\n    delete this._cloudStore;\r\n  }\r\n}\r\n","import type { NodeModel } from \"./models/nodemodel\";\r\nimport type { NodeContext } from \"./nodecontext\";\r\nimport { NodeDefinition } from \"./nodedefinition\";\r\nimport type { NodeScope } from \"./nodescope\";\r\nimport { OutputProperty } from \"./outputproperty\";\r\nimport { Variant } from \"./variants\";\r\n\r\ninterface Input<TSelf extends Node<any>> {\r\n  type?:\r\n    | {\r\n        units?: string[];\r\n        defaultUnit?: string;\r\n        name?: string;\r\n      }\r\n    | string;\r\n  default?: any;\r\n  set: (this: TSelf, value: any) => void;\r\n  value?: any;\r\n}\r\n\r\ninterface Output<TSelf extends Node<any>> {\r\n  get?: (this: TSelf) => any;\r\n  getter?: (this: TSelf) => any;\r\n  onFirstConnectionAdded?: (this: TSelf) => void;\r\n  onLastConnectionRemoved?: (this: TSelf) => void;\r\n}\r\n\r\nexport class Node<TInternal extends Record<string, any> = any> {\r\n  id: string;\r\n  context: NodeContext;\r\n  name?: string;\r\n  nodeScope?: NodeScope;\r\n  variant?: Variant | string;\r\n  model?: NodeModel;\r\n  updateOnDirtyFlagging: boolean = true;\r\n  children: Node[] = [];\r\n  nodeScopeDidInitialize?: () => void;\r\n\r\n  // This is used by the node definitions to store internal state.\r\n  // Something that should get cleaned up in the future.\r\n  public _internal = {} as TInternal;\r\n\r\n  private _dirty: boolean = false;\r\n  _inputs: Record<string, Input<this>> = {};\r\n  _inputValues: Record<string, any> = {};\r\n  private _outputs: Record<string, OutputProperty> = {};\r\n  private _inputConnections: Record<string, OutputProperty[]> = {};\r\n  private _outputList: OutputProperty[] = [];\r\n  private _isUpdating: boolean = false;\r\n  private _inputValuesQueue: Record<string, any[]> = {};\r\n  private _afterInputsHaveUpdatedCallbacks: ((\r\n    this: Node<TInternal>\r\n  ) => void)[] = [];\r\n  private _signalsSentThisUpdate: Record<string, boolean> = {};\r\n  _deleted: boolean = false;\r\n  private _deleteListeners: Function[] = [];\r\n  private _isFirstUpdate: boolean = true;\r\n  private _valuesFromConnections: Record<string, any> = {};\r\n  private _updatedAtIteration?: number;\r\n  private _updateIteration: number = 0;\r\n  private _cyclicLoop?: boolean;\r\n  private _cyclicWarningSent?: boolean;\r\n  private _getVisualStates?: () => string[];\r\n  private _resetReactVirtualDOM?: () => void;\r\n\r\n  public getInspectInfo: NodeDefinition[\"getInspectInfo\"];\r\n\r\n  constructor(context: NodeContext, id: string) {\r\n    this.id = id;\r\n    this.context = context;\r\n  }\r\n\r\n  getInputValue(name: string): any {\r\n    return this._inputValues[name];\r\n  }\r\n\r\n  registerInput(name: string, input: Input<this>): void {\r\n    if (this.hasInput(name)) {\r\n      throw new Error(\"Input property \" + name + \" already registered\");\r\n    }\r\n\r\n    this._inputs[name] = input;\r\n\r\n    if (input.type && typeof input.type === \"object\" && \"units\" in input.type) {\r\n      const defaultUnit = input.type.defaultUnit || input.type.units?.[0] || \"\";\r\n      this._inputValues[name] = {\r\n        value: input.default,\r\n        type: defaultUnit,\r\n      };\r\n    } else if (input.hasOwnProperty(\"default\")) {\r\n      this._inputValues[name] = input.default;\r\n    }\r\n  }\r\n\r\n  deregisterInput(name: string): void {\r\n    if (this.hasInput(name) === false) {\r\n      throw new Error(\"Input property \" + name + \" doesn't exist\");\r\n    }\r\n    delete this._inputs[name];\r\n    delete this._inputValues[name];\r\n  }\r\n\r\n  registerInputs(inputs: Record<string, Input<this>>): void {\r\n    for (const name in inputs) {\r\n      this.registerInput(name, inputs[name]);\r\n    }\r\n  }\r\n\r\n  getInput(name: string): Input<this> | undefined {\r\n    if (this.hasInput(name) === false) {\r\n      console.log(\"Node \" + this.name + \": Invalid input property \" + name);\r\n      return undefined;\r\n    }\r\n\r\n    return this._inputs[name];\r\n  }\r\n\r\n  hasInput(name: string): boolean {\r\n    return name in this._inputs;\r\n  }\r\n\r\n  registerInputIfNeeded(_name?: string): void {\r\n    //noop, can be overriden by subclasses\r\n  }\r\n\r\n  setInputValue(name: string, value: any): void {\r\n    const input = this.getInput(name);\r\n    if (!input) {\r\n      console.log(\"node doesn't have input\", name);\r\n      return;\r\n    }\r\n\r\n    if (\r\n      typeof input.type === \"object\" &&\r\n      input.type.name === \"array\" &&\r\n      typeof value === \"string\"\r\n    ) {\r\n      try {\r\n        const parsedValue = JSON.parse(value);\r\n        input.set.call(this, parsedValue);\r\n        input.value = parsedValue;\r\n        this._inputValues[name] = parsedValue;\r\n      } catch (e) {\r\n        // Handle parsing error if needed\r\n      }\r\n    } else {\r\n      input.set.call(this, value);\r\n      input.value = value;\r\n      this._inputValues[name] = value;\r\n    }\r\n\r\n    if (input.type === \"color\" && this.context && this.context.styles) {\r\n      value = this.context.styles.resolveColor(value);\r\n    } else if (input.type === \"array\" && typeof value === \"string\") {\r\n      try {\r\n        value = eval(value);\r\n        this.context.editorConnection?.clearWarning(\r\n          this.nodeScope?.componentOwner?.name,\r\n          this.id,\r\n          \"invalid-array-\" + name\r\n        );\r\n      } catch (e) {\r\n        const error = e as Error;\r\n\r\n        value = [];\r\n        console.log(e);\r\n        if (this.context.editorConnection) {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope?.componentOwner?.name,\r\n            this.id,\r\n            \"invalid-array-\" + name,\r\n            {\r\n              showGlobally: true,\r\n              message: \"Invalid array<br>\" + error.toString(),\r\n            }\r\n          );\r\n        }\r\n      }\r\n    }\r\n\r\n    input.set.call(this, value);\r\n  }\r\n\r\n  hasOutput(name: string): boolean {\r\n    return name in this._outputs;\r\n  }\r\n\r\n  registerOutput(name: string, output: Output<this>): void {\r\n    if (this.hasOutput(name)) {\r\n      throw new Error(\"Output property \" + name + \" already registered\");\r\n    }\r\n\r\n    const newOutput = new OutputProperty({\r\n      owner: this,\r\n      getter: output.get || output.getter,\r\n      name: name,\r\n      onFirstConnectionAdded: output.onFirstConnectionAdded,\r\n      onLastConnectionRemoved: output.onLastConnectionRemoved,\r\n    });\r\n\r\n    this._outputs[name] = newOutput;\r\n    this._outputList.push(newOutput);\r\n  }\r\n\r\n  deregisterOutput(name: string): void {\r\n    if (this.hasOutput(name) === false) {\r\n      throw new Error(\"Output property \" + name + \" isn't registered\");\r\n    }\r\n\r\n    const output = this._outputs[name];\r\n\r\n    if (output.hasConnections()) {\r\n      throw new Error(\r\n        \"Output property \" + name + \" has connections and can't be removed\"\r\n      );\r\n    }\r\n\r\n    delete this._outputs[name];\r\n    const index = this._outputList.indexOf(output);\r\n    this._outputList.splice(index, 1);\r\n  }\r\n\r\n  registerOutputs(outputs: Record<string, Output<this>>): void {\r\n    for (const name in outputs) {\r\n      this.registerOutput(name, outputs[name]);\r\n    }\r\n  }\r\n\r\n  registerOutputIfNeeded(): void {\r\n    //noop, can be overriden by subclasses\r\n  }\r\n\r\n  getOutput(name: string): OutputProperty {\r\n    if (this.hasOutput(name) === false) {\r\n      throw new Error(\r\n        \"Node \" + this.name + \" doesn't have a port named \" + name\r\n      );\r\n    }\r\n    return this._outputs[name];\r\n  }\r\n\r\n  connectInput(\r\n    inputName: string,\r\n    sourceNode: Node,\r\n    sourcePortName: string\r\n  ): void {\r\n    if (this.hasInput(inputName) === false) {\r\n      throw new Error(\r\n        \"Invalid connection, input doesn't exist. Trying to connect from \" +\r\n          sourceNode.name +\r\n          \" output \" +\r\n          sourcePortName +\r\n          \" to \" +\r\n          this.name +\r\n          \" input \" +\r\n          inputName\r\n      );\r\n    }\r\n\r\n    const sourcePort = sourceNode.getOutput(sourcePortName);\r\n    sourcePort.registerConnection(this, inputName);\r\n\r\n    if (!this._inputConnections[inputName]) {\r\n      this._inputConnections[inputName] = [];\r\n    }\r\n\r\n    this._inputConnections[inputName].push(sourcePort);\r\n\r\n    if (sourceNode._signalsSentThisUpdate[sourcePortName]) {\r\n      this._setValueFromConnection(inputName, true);\r\n      this._setValueFromConnection(inputName, false);\r\n    } else {\r\n      const outputValue = sourcePort.value;\r\n      if (outputValue !== undefined) {\r\n        this._setValueFromConnection(inputName, outputValue);\r\n\r\n        if (this.context) {\r\n          // Send value to editor for connection debugging.\r\n          // Conceptually the value has already been sent,\r\n          // but the editor needs to be notified after a connection is created\r\n          this.context.connectionSentValue(sourcePort, sourcePort.value);\r\n        }\r\n      }\r\n    }\r\n\r\n    this.flagDirty();\r\n  }\r\n\r\n  removeInputConnection(\r\n    inputName: string,\r\n    sourceNodeId: string,\r\n    sourcePortName: string\r\n  ): void {\r\n    if (!this._inputConnections[inputName]) {\r\n      throw new Error(\"Node removeInputConnection: Input doesn't exist\");\r\n    }\r\n\r\n    const inputsToPort = this._inputConnections[inputName];\r\n\r\n    for (let i = 0; i < inputsToPort.length; i++) {\r\n      const sourcePort = inputsToPort[i];\r\n      if (\r\n        sourcePort.owner.id === sourceNodeId &&\r\n        sourcePort.name === sourcePortName\r\n      ) {\r\n        inputsToPort.splice(i, 1);\r\n\r\n        //remove the output from the source node\r\n        const output = sourcePort.owner.getOutput(sourcePortName);\r\n        output.deregisterConnection(this, inputName);\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (inputsToPort.length === 0) {\r\n      //no inputs left, remove the bookkeeping that traces values sent to this node as inputs\r\n      delete this._valuesFromConnections[inputName];\r\n    }\r\n  }\r\n\r\n  isInputConnected(inputName: string): boolean {\r\n    if (!this._inputConnections.hasOwnProperty(inputName)) {\r\n      return false;\r\n    }\r\n\r\n    //We have connections, but they might be from non-connected component inputs.\r\n    // If they are from a component input then check the input on the component instance.\r\n    return this._inputConnections[inputName].some((c) => {\r\n      //if this is not a component input, then we have a proper connection\r\n      if (c.owner.name !== \"Component Inputs\") return true;\r\n\r\n      //the name of the output from the component input, is the same as the component instance input\r\n      const component = c.owner.nodeScope?.componentOwner;\r\n      return component?.isInputConnected(c.name);\r\n    });\r\n  }\r\n\r\n  update(): void {\r\n    if (this._isUpdating || this._dirty === false) {\r\n      return;\r\n    }\r\n\r\n    if (this._updatedAtIteration !== this.context.updateIteration) {\r\n      this._updatedAtIteration = this.context.updateIteration;\r\n      this._updateIteration = 0;\r\n      if (this._cyclicLoop) this._cyclicLoop = false;\r\n    }\r\n\r\n    this._isUpdating = true;\r\n    const maxUpdateIterations = 100;\r\n\r\n    try {\r\n      while (this._dirty && !this._cyclicLoop) {\r\n        this._updateDependencies();\r\n\r\n        //all inputs are now updated, flag as not dirty\r\n        this._dirty = false;\r\n\r\n        const inputNames = Object.keys(this._inputValuesQueue);\r\n\r\n        let hasMoreInputs = true;\r\n\r\n        while (hasMoreInputs && !this._cyclicLoop) {\r\n          hasMoreInputs = false;\r\n\r\n          for (let i = 0; i < inputNames.length; i++) {\r\n            const inputName = inputNames[i];\r\n            const queue = this._inputValuesQueue[inputName];\r\n            if (queue.length > 0) {\r\n              this.setInputValue(inputName, queue.shift());\r\n              if (queue.length > 0) {\r\n                hasMoreInputs = true;\r\n              }\r\n            }\r\n          }\r\n\r\n          const afterInputCallbacks = this._afterInputsHaveUpdatedCallbacks;\r\n          this._afterInputsHaveUpdatedCallbacks = [];\r\n          for (let i = 0; i < afterInputCallbacks.length; i++) {\r\n            afterInputCallbacks[i].call(this);\r\n          }\r\n        }\r\n        this._updateIteration++;\r\n\r\n        if (this._updateIteration >= maxUpdateIterations) {\r\n          this._cyclicLoop = true;\r\n        }\r\n      }\r\n    } catch (e) {\r\n      this._isUpdating = false;\r\n      throw e;\r\n    }\r\n\r\n    if (this._cyclicLoop) {\r\n      //flag the node as dirty again to let it contiune next frame so we don't just stop it\r\n      //This will allow the browser a chance to render and run other code\r\n      this.context.scheduleNextFrame(() => {\r\n        this.context.nodeIsDirty(this);\r\n      });\r\n\r\n      if (\r\n        this.context.editorConnection &&\r\n        !this._cyclicWarningSent &&\r\n        this.context.isWarningTypeEnabled(\"cyclicLoops\")\r\n      ) {\r\n        this.context.editorConnection.sendWarning(\r\n          this.nodeScope?.componentOwner?.name,\r\n          this.id,\r\n          \"cyclic-loop\",\r\n          {\r\n            showGlobally: true,\r\n            message: \"Cyclic loop detected\",\r\n          }\r\n        );\r\n        this._cyclicWarningSent = true;\r\n        console.log(\"cycle detected\", {\r\n          id: this.id,\r\n          name: this.name,\r\n          component: this.nodeScope?.componentOwner?.name,\r\n        });\r\n      }\r\n    }\r\n\r\n    this._isFirstUpdate = false;\r\n    this._isUpdating = false;\r\n  }\r\n\r\n  private _updateDependencies(): void {\r\n    for (const inputName in this._inputConnections) {\r\n      const connectedPorts = this._inputConnections[inputName];\r\n      for (let i = 0; i < connectedPorts.length; ++i) {\r\n        connectedPorts[i].owner.update();\r\n      }\r\n    }\r\n  }\r\n\r\n  flagDirty(): void {\r\n    if (this._dirty) {\r\n      return;\r\n    }\r\n\r\n    this._dirty = true;\r\n\r\n    //a hack to not update nodes as a component is being created.\r\n    //Nodes should update once all connections are in place, so inputs that rely on connections, e.g. \"Run\" on a Function node, have the correct context before running.\r\n    //This flag is being updated externally by the NodeScope and _performDirtyUpdate will be called when the component setup is done\r\n    if (this.updateOnDirtyFlagging) {\r\n      this._performDirtyUpdate();\r\n    }\r\n  }\r\n\r\n  protected _performDirtyUpdate(): void {\r\n    this.context && this.context.nodeIsDirty(this);\r\n\r\n    for (let i = 0; i < this._outputList.length; ++i) {\r\n      this._outputList[i].flagDependeesDirty();\r\n    }\r\n  }\r\n\r\n  sendValue(name: string, value: any): void {\r\n    if (this.hasOutput(name) === false) {\r\n      console.log(\r\n        \"Error: Node\",\r\n        this.name,\r\n        \"doesn't have a output named\",\r\n        name\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (value === undefined) {\r\n      return;\r\n    }\r\n\r\n    const output = this.getOutput(name);\r\n    output.sendValue(value);\r\n\r\n    if (this.context) {\r\n      this.context.connectionSentValue(output, value);\r\n    }\r\n  }\r\n\r\n  flagOutputDirty(name: string): void {\r\n    const output = this.getOutput(name);\r\n    this.sendValue(name, output.value);\r\n  }\r\n\r\n  flagAllOutputsDirty(): void {\r\n    for (const output of this._outputList) {\r\n      this.sendValue(output.name, output.value);\r\n    }\r\n  }\r\n\r\n  sendSignalOnOutput(outputName: string): void {\r\n    if (this.hasOutput(outputName) === false) {\r\n      console.log(\r\n        \"Error: Node\",\r\n        this.name,\r\n        \"doesn't have a output named\",\r\n        outputName\r\n      );\r\n      return;\r\n    }\r\n\r\n    const output = this.getOutput(outputName);\r\n    output.sendValue(true);\r\n    output.sendValue(false);\r\n\r\n    this._signalsSentThisUpdate[outputName] = true;\r\n    this.scheduleAfterInputsHaveUpdated(function (this: Node) {\r\n      this._signalsSentThisUpdate[outputName] = false;\r\n    });\r\n\r\n    if (this.context) {\r\n      this.context.connectionSentSignal(output);\r\n    }\r\n  }\r\n\r\n  _setValueFromConnection(inputName: string, value: any): void {\r\n    this._valuesFromConnections[inputName] = value;\r\n    this.queueInput(inputName, value);\r\n  }\r\n\r\n  _hasInputBeenSetFromAConnection(inputName: string): boolean {\r\n    return this._valuesFromConnections.hasOwnProperty(inputName);\r\n  }\r\n\r\n  queueInput(inputName: string, value: any): void {\r\n    if (!this._inputValuesQueue[inputName]) {\r\n      this._inputValuesQueue[inputName] = [];\r\n    }\r\n\r\n    //when values are queued during the very first update, make the last value overwrite previous ones\r\n    //so a chain with multiple nodes with values that connect to each other all\r\n    //consolidate to a single value, instead of piling up in the queue\r\n    if (this._isFirstUpdate) {\r\n      //signals need two values, so make sure we don't suppress the 'false' that comes directly\r\n      //after a 'true'\r\n      const queueValue = this._inputValuesQueue[inputName][0];\r\n      const isSignal = queueValue === true; // && value === true;\r\n      if (!isSignal) {\r\n        //default units are set as an object {value, unit}\r\n        //subsequent inputs can be unitless. and will will then overwrite those\r\n        //and the node will get a value without ever getting a unit.\r\n        //To make sure that doesn't happen, look at the value being overwritten\r\n        //and use the unit from that before overwriting\r\n        if (\r\n          queueValue instanceof Object &&\r\n          (queueValue as any).unit &&\r\n          value instanceof Object === false\r\n        ) {\r\n          value = {\r\n            value,\r\n            unit: (queueValue as any).unit,\r\n          };\r\n        }\r\n\r\n        this._inputValuesQueue[inputName].length = 0;\r\n      }\r\n    }\r\n\r\n    this._inputValuesQueue[inputName].push(value);\r\n    this.flagDirty();\r\n  }\r\n\r\n  scheduleAfterInputsHaveUpdated(\r\n    callbackFn: (this: Node<TInternal>) => void\r\n  ): void {\r\n    this._afterInputsHaveUpdatedCallbacks.push(callbackFn);\r\n    this.flagDirty();\r\n  }\r\n\r\n  setNodeModel(nodeModel: NodeModel): void {\r\n    this.model = nodeModel;\r\n    nodeModel.on(\"parameterUpdated\", this._onNodeModelParameterUpdated, this);\r\n    nodeModel.on(\"variantUpdated\", this._onNodeModelVariantUpdated, this);\r\n\r\n    nodeModel.on(\r\n      \"inputPortRemoved\",\r\n      (port: { name: string }) => {\r\n        if (this.hasInput(port.name)) {\r\n          this.deregisterInput(port.name);\r\n        }\r\n      },\r\n      this\r\n    );\r\n\r\n    nodeModel.on(\r\n      \"outputPortRemoved\",\r\n      (port: { name: string }) => {\r\n        if (this.hasOutput(port.name)) {\r\n          this.deregisterOutput(port.name);\r\n        }\r\n      },\r\n      this\r\n    );\r\n  }\r\n\r\n  addDeleteListener(listener: Function): void {\r\n    this._deleteListeners.push(listener);\r\n  }\r\n\r\n  /*protected*/ _onNodeDeleted(): void {\r\n    if (this.model) {\r\n      this.model.removeListenersWithRef(this);\r\n      this.model = undefined;\r\n    }\r\n\r\n    this._deleted = true;\r\n\r\n    for (const deleteListener of this._deleteListeners) {\r\n      deleteListener.call(this);\r\n    }\r\n  }\r\n\r\n  private _onNodeModelParameterUpdated(event: {\r\n    name: string;\r\n    value: any;\r\n    state?: string;\r\n  }): void {\r\n    this.registerInputIfNeeded(event.name);\r\n\r\n    if (event.value !== undefined) {\r\n      if (event.state) {\r\n        //this parameter is only used in a certain visual state\r\n        //make sure we are in that state before setting it\r\n\r\n        if (!this._getVisualStates) {\r\n          console.log(\r\n            \"Node has nos visual states, but got a parameter for state\",\r\n            event.state\r\n          );\r\n          return;\r\n        }\r\n\r\n        const states = this._getVisualStates();\r\n        if (states.indexOf(event.state) !== -1) {\r\n          this.queueInput(event.name, event.value);\r\n        }\r\n      } else {\r\n        this.queueInput(event.name, event.value);\r\n      }\r\n    } else {\r\n      //parameter is undefined, that means it has been removed and we should reset to default\r\n      let defaultValue;\r\n\r\n      const variant = this.variant;\r\n\r\n      if (typeof variant === \"object\") {\r\n        if (event.state) {\r\n          //local value has been reset, check the variant first\r\n          if (\r\n            variant &&\r\n            variant.stateParameters.hasOwnProperty(event.state) &&\r\n            variant.stateParameters[event.state].hasOwnProperty(event.name)\r\n          ) {\r\n            defaultValue = variant.stateParameters[event.state][event.name];\r\n          }\r\n          //and if variant has no value in that state, check for local values in the neutral state\r\n          else if (this.model?.parameters.hasOwnProperty(event.name)) {\r\n            defaultValue = this.model.parameters[event.name];\r\n          }\r\n          //and then look in the variant neutral values\r\n          else if (variant && variant.parameters.hasOwnProperty(event.name)) {\r\n            defaultValue = variant.parameters[event.name];\r\n          }\r\n        } else if (variant && variant.parameters.hasOwnProperty(event.name)) {\r\n          defaultValue = variant.parameters[event.name];\r\n        }\r\n      }\r\n\r\n      if (defaultValue === undefined) {\r\n        //get the default value for the port\r\n        defaultValue = this.context.getDefaultValueForInput(\r\n          this.model!.type,\r\n          event.name\r\n        );\r\n\r\n        //when a paramter that's used by a text style is reset, Noodl will modify the original dom node, outside of React\r\n        //React will then re-render, and should apply the values from the text style, but won't see any delta in the virtual dom,\r\n        //even though there is a diff to the real dom.\r\n        //to fix that, we just force React to re-render the entire node\r\n        this._resetReactVirtualDOM && this._resetReactVirtualDOM();\r\n      }\r\n\r\n      this.queueInput(event.name, defaultValue);\r\n    }\r\n  }\r\n\r\n  private _onNodeModelVariantUpdated(variant: any): void {\r\n    this.setVariant(variant);\r\n  }\r\n\r\n  setVariant(variant: Variant): void {\r\n    this.variant = variant;\r\n  }\r\n}\r\n","import { Collection } from \"../../../collection\";\r\nimport { Model } from \"../../../model\";\r\n\r\ninterface NodeDefinition {\r\n  node: {\r\n    name?: string;\r\n    category?: string;\r\n    color?: string;\r\n    inputs?: Record<string, any>;\r\n    outputs?: Record<string, any>;\r\n    methods?: Record<string, any>;\r\n    dynamicports?: any[];\r\n    usePortAsLabel?: string;\r\n    initialize?: () => void;\r\n    getInspectInfo?: () => any;\r\n  };\r\n  setup?: (context: any, graphModel: any) => void;\r\n}\r\n\r\ninterface Internal {\r\n  modelId?: string;\r\n  model?: typeof Model;\r\n  inputValues: Record<string, any>;\r\n  inputTypes: Record<string, string>;\r\n}\r\n\r\nfunction _addBaseInfo(def: NodeDefinition): void {\r\n  Object.assign(def.node, {\r\n    category: \"Data\",\r\n    color: \"data\",\r\n  });\r\n}\r\n\r\nfunction _addModelId(\r\n  def: NodeDefinition,\r\n  opts?: { includeInputs?: boolean; includeOutputs?: boolean }\r\n): void {\r\n  const _includeInputs = opts === undefined || opts.includeInputs;\r\n  const _includeOutputs = opts === undefined || opts.includeOutputs;\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {},\r\n  });\r\n\r\n  if (_includeInputs) {\r\n    Object.assign(def.node, {\r\n      usePortAsLabel: \"modelId\",\r\n    });\r\n\r\n    def.node.dynamicports = (def.node.dynamicports || []).concat([\r\n      {\r\n        name: \"conditionalports/extended\",\r\n        condition: \"idSource = explicit OR idSource NOT SET\",\r\n        inputs: [\"modelId\"],\r\n      },\r\n    ]);\r\n\r\n    // Inputs\r\n    // @ts-expect-error\r\n    Object.assign(def.node.inputs, {\r\n      idSource: {\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"Specify explicitly\", value: \"explicit\" },\r\n            { label: \"From repeater\", value: \"foreach\" },\r\n          ],\r\n          allowEditOnly: true,\r\n        },\r\n        default: \"explicit\",\r\n        displayName: \"Id Source\",\r\n        group: \"General\",\r\n        set(value: string) {\r\n          if (value === \"foreach\") {\r\n            // @ts-expect-error\r\n            this.scheduleAfterInputsHaveUpdated(() => {\r\n              // Find closest nodescope that have a _forEachModel\r\n              // @ts-expect-error\r\n              let component = this.nodeScope.componentOwner;\r\n              while (\r\n                component !== undefined &&\r\n                component._forEachModel === undefined &&\r\n                component.parentNodeScope\r\n              ) {\r\n                component = component.parentNodeScope.componentOwner;\r\n              }\r\n              // @ts-expect-error\r\n              this.setModel(\r\n                component !== undefined ? component._forEachModel : undefined\r\n              );\r\n            });\r\n          }\r\n        },\r\n      },\r\n      modelId: {\r\n        type: {\r\n          name: \"string\",\r\n          identifierOf: \"ModelName\",\r\n          identifierDisplayName: \"Object Ids\",\r\n        },\r\n        displayName: \"Id\",\r\n        group: \"General\",\r\n        set: function (value: string | typeof Model): void {\r\n          if (value instanceof Model) value = value.getId(); // Can be passed as model as well\r\n          // @ts-expect-error\r\n          this._internal.modelId = value; // Wait to fetch data\r\n          // @ts-expect-error\r\n          this.setModelID(value);\r\n        },\r\n      },\r\n    });\r\n  }\r\n\r\n  // Outputs\r\n  if (_includeOutputs) {\r\n    // @ts-expect-error\r\n    Object.assign(def.node.outputs, {\r\n      id: {\r\n        type: \"string\",\r\n        displayName: \"Id\",\r\n        group: \"General\",\r\n        getter: function (): string {\r\n          // @ts-expect-error\r\n          return this._internal.model\r\n            ? // @ts-expect-error\r\n              this._internal.model.getId()\r\n            : // @ts-expect-error\r\n              this._internal.modelId;\r\n        },\r\n      },\r\n    });\r\n  }\r\n\r\n  // Methods\r\n  // @ts-expect-error\r\n  Object.assign(def.node.methods, {\r\n    setModelID: function (id: string): void {\r\n      // @ts-expect-error\r\n      const model = (this.nodeScope.modelScope || Model).get(id);\r\n      // @ts-expect-error\r\n      this.setModel(model);\r\n    },\r\n    setModel: function (model: typeof Model): void {\r\n      // @ts-expect-error\r\n      this._internal.model = model;\r\n      // @ts-expect-error\r\n      this.flagOutputDirty(\"id\");\r\n    },\r\n  });\r\n\r\n  //Inspect model\r\n  if (!def.node.getInspectInfo) {\r\n    def.node.getInspectInfo = function (): any[] | string {\r\n      // @ts-expect-error\r\n      const model = this._internal.model;\r\n      if (!model) return \"[No Object]\";\r\n\r\n      return [\r\n        { type: \"text\", value: \"Id: \" + model.getId() },\r\n        { type: \"value\", value: model.data },\r\n      ];\r\n    };\r\n  }\r\n}\r\n\r\nfunction _addInputProperties(def: NodeDefinition): void {\r\n  const _def: NodeDefinition = {\r\n    node: Object.assign({}, def.node),\r\n    setup: def.setup,\r\n  };\r\n  const _methods = Object.assign({}, def.node.methods);\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {},\r\n  });\r\n\r\n  Object.assign(def, {\r\n    setup: function (context: any, graphModel: any): void {\r\n      if (\r\n        !context.editorConnection ||\r\n        !context.editorConnection.isRunningLocally()\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      graphModel.on(\"nodeAdded.\" + def.node.name, function (node: any) {\r\n        function _updatePorts(): void {\r\n          const ports: any[] = [];\r\n\r\n          const _types = [\r\n            { label: \"String\", value: \"string\" },\r\n            { label: \"Boolean\", value: \"boolean\" },\r\n            { label: \"Number\", value: \"number\" },\r\n            { label: \"Date\", value: \"date\" },\r\n            { label: \"Array\", value: \"array\" },\r\n            { label: \"Object\", value: \"object\" },\r\n            { label: \"Any\", value: \"*\" },\r\n          ];\r\n\r\n          // Add value outputs\r\n          let properties = node.parameters.properties;\r\n          if (properties) {\r\n            properties = properties ? properties.split(\",\") : undefined;\r\n            for (const p of properties) {\r\n              // Property input\r\n              ports.push({\r\n                type: {\r\n                  name:\r\n                    node.parameters[\"type-\" + p] === undefined\r\n                      ? \"*\"\r\n                      : node.parameters[\"type-\" + p],\r\n                },\r\n                plug: \"input\",\r\n                group: \"Property Values\",\r\n                displayName: p,\r\n                name: \"prop-\" + p,\r\n              });\r\n\r\n              // Property type\r\n              ports.push({\r\n                type: {\r\n                  name: \"enum\",\r\n                  enums: _types,\r\n                  allowEditOnly: true,\r\n                },\r\n                plug: \"input\",\r\n                group: \"Property Types\",\r\n                displayName: p,\r\n                default: \"*\",\r\n                name: \"type-\" + p,\r\n              });\r\n            }\r\n          }\r\n\r\n          context.editorConnection.sendDynamicPorts(node.id, ports, {\r\n            detectRenamed: {\r\n              plug: \"input\",\r\n            },\r\n          });\r\n        }\r\n\r\n        _updatePorts();\r\n\r\n        node.on(\"parameterUpdated\", function () {\r\n          _updatePorts();\r\n        });\r\n      });\r\n\r\n      _def.setup && _def.setup(context, graphModel);\r\n    },\r\n  });\r\n\r\n  // Initialize\r\n  Object.assign(def.node, {\r\n    initialize: function (): void {\r\n      // @ts-expect-error\r\n      const internal = this._internal as Internal;\r\n      internal.inputValues = {};\r\n      internal.inputTypes = {};\r\n\r\n      _def.node.initialize && _def.node.initialize.call(this);\r\n    },\r\n  });\r\n\r\n  // Outputs\r\n  // @ts-expect-error\r\n  Object.assign(def.node.outputs, {});\r\n\r\n  // Inputs\r\n  // @ts-expect-error\r\n  Object.assign(def.node.inputs, {\r\n    properties: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      displayName: \"Properties\",\r\n      group: \"Properties to set\",\r\n      set: function (): void {},\r\n    },\r\n  });\r\n\r\n  // Methods\r\n  // @ts-expect-error\r\n  Object.assign(def.node.methods, {\r\n    _pushInputValues: function (model: typeof Model): void {\r\n      // @ts-expect-error\r\n      const internal = this._internal as Internal;\r\n\r\n      const _defaultValueForType: Record<string, any> = {\r\n        boolean: false,\r\n        string: \"\",\r\n        number: 0,\r\n        date: new Date(),\r\n      };\r\n\r\n      const _allKeys: Record<string, boolean> = {};\r\n      for (const key in internal.inputTypes) _allKeys[key] = true;\r\n      for (const key in internal.inputValues) _allKeys[key] = true;\r\n\r\n      // @ts-expect-error\r\n      const properties = this.model.parameters.properties || \"\";\r\n\r\n      const validProperties = properties.split(\",\");\r\n\r\n      const keysToSet = Object.keys(_allKeys).filter(\r\n        (key) => validProperties.indexOf(key) !== -1\r\n      );\r\n\r\n      for (const i of keysToSet) {\r\n        let value = internal.inputValues[i];\r\n\r\n        if (value !== undefined) {\r\n          //Parse array types with string as javascript\r\n          if (\r\n            internal.inputTypes[i] !== undefined &&\r\n            internal.inputTypes[i] === \"array\" &&\r\n            typeof value === \"string\"\r\n          ) {\r\n            // @ts-expect-error\r\n            this.context.editorConnection.clearWarning(\r\n              // @ts-expect-error\r\n              this.nodeScope.componentOwner.name,\r\n              // @ts-expect-error\r\n              this.id,\r\n              \"invalid-array-\" + i\r\n            );\r\n\r\n            try {\r\n              value = eval(value); //this might be static data in the form of javascript\r\n            } catch (e) {\r\n              if (value.indexOf(\"[\") !== -1 || value.indexOf(\"{\") !== -1) {\r\n                // @ts-expect-error\r\n                this.context.editorConnection.sendWarning(\r\n                  // @ts-expect-error\r\n                  this.nodeScope.componentOwner.name,\r\n                  // @ts-expect-error\r\n                  this.id,\r\n                  \"invalid-array-\" + i,\r\n                  {\r\n                    showGlobally: true,\r\n                    // @ts-expect-error\r\n                    message: \"Invalid array<br>\" + e.toString(),\r\n                  }\r\n                );\r\n                value = [];\r\n              } else {\r\n                //backwards compatibility with how this node used to work\r\n                value = Collection.get(value);\r\n              }\r\n            }\r\n          }\r\n          // Resolve object from IDs\r\n          if (\r\n            internal.inputTypes[i] !== undefined &&\r\n            internal.inputTypes[i] === \"object\" &&\r\n            typeof value === \"string\"\r\n          ) {\r\n            // @ts-expect-error\r\n            value = (this.nodeScope.modelScope || Model).get(value);\r\n          }\r\n\r\n          // @ts-expect-error\r\n          model.set(i, value, { resolve: true });\r\n        } else {\r\n          // @ts-expect-error\r\n          model.set(i, _defaultValueForType[internal.inputTypes[i]], {\r\n            resolve: true,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    scheduleStore: function (): void {\r\n      // @ts-expect-error\r\n      if (this.hasScheduledStore) return;\r\n      // @ts-expect-error\r\n      this.hasScheduledStore = true;\r\n\r\n      // @ts-expect-error\r\n      const internal = this._internal as Internal;\r\n      // @ts-expect-error\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.hasScheduledStore = false;\r\n        if (!internal.model) return;\r\n\r\n        // @ts-expect-error\r\n        this._pushInputValues(internal.model);\r\n\r\n        // @ts-expect-error\r\n        this.sendSignalOnOutput(\"stored\");\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name: string): void {\r\n      // @ts-expect-error\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"prop-\"))\r\n        // @ts-expect-error\r\n        this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this._setInputValue.bind(this, name.substring(\"prop-\".length)),\r\n        });\r\n\r\n      if (name.startsWith(\"type-\"))\r\n        // @ts-expect-error\r\n        this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this._setInputType.bind(this, name.substring(\"type-\".length)),\r\n        });\r\n\r\n      _methods &&\r\n        _methods.registerInputIfNeeded &&\r\n        // @ts-expect-error\r\n        _def.node.methods.registerInputIfNeeded.call(this, name);\r\n    },\r\n    _setInputValue: function (name: string, value: any): void {\r\n      // @ts-expect-error\r\n      (this._internal as Internal).inputValues[name] = value;\r\n    },\r\n    _setInputType: function (name: string, value: string): void {\r\n      // @ts-expect-error\r\n      (this._internal as Internal).inputTypes[name] = value;\r\n    },\r\n  });\r\n}\r\n\r\nexport {\r\n  _addInputProperties as addInputProperties,\r\n  _addModelId as addModelId,\r\n  _addBaseInfo as addBaseInfo,\r\n};\r\n","import type { Node } from \"./node\";\r\n\r\ninterface OutputPropertyArgs {\r\n  getter?: () => any;\r\n  owner: Node<any>;\r\n  name: string;\r\n  type?: string;\r\n  onFirstConnectionAdded?: () => void;\r\n  onLastConnectionRemoved?: () => void;\r\n}\r\n\r\ninterface Connection {\r\n  node: Node;\r\n  inputPortName: string;\r\n}\r\n\r\nexport class OutputProperty {\r\n  private getter: () => any;\r\n  private connections: Connection[];\r\n  private _owner: Node;\r\n  private _name: string;\r\n  private onFirstConnectionAdded?: () => void;\r\n  private onLastConnectionRemoved?: () => void;\r\n  private _id?: string;\r\n  private _lastUpdateIteration?: number;\r\n  private valuesSendThisIteration: number = 0;\r\n\r\n  constructor(args: OutputPropertyArgs) {\r\n    if (!args.owner) {\r\n      throw new Error(\"Owner must be set\");\r\n    }\r\n    this.getter = args.getter || (() => undefined);\r\n    this.connections = [];\r\n    this._owner = args.owner;\r\n    this._name = args.name;\r\n    this.onFirstConnectionAdded = args.onFirstConnectionAdded;\r\n    this.onLastConnectionRemoved = args.onLastConnectionRemoved;\r\n  }\r\n\r\n  get name(): string {\r\n    return this._name;\r\n  }\r\n\r\n  get owner(): Node {\r\n    return this._owner;\r\n  }\r\n\r\n  get value(): any {\r\n    return this.getter.call(this.owner);\r\n  }\r\n\r\n  get id(): string {\r\n    if (!this._id) {\r\n      this._id = this.owner.id + this.name;\r\n    }\r\n    return this._id;\r\n  }\r\n\r\n  registerConnection(node: Node<any>, inputPortName: string): void {\r\n    this.connections.push({\r\n      node,\r\n      inputPortName,\r\n    });\r\n\r\n    if (this.connections.length === 1 && this.onFirstConnectionAdded) {\r\n      this.onFirstConnectionAdded.call(this.owner);\r\n    }\r\n  }\r\n\r\n  deregisterConnection(node: Node<any>, inputPortName: string): void {\r\n    for (let i = 0; i < this.connections.length; i++) {\r\n      const connection = this.connections[i];\r\n      if (\r\n        connection.node === node &&\r\n        connection.inputPortName === inputPortName\r\n      ) {\r\n        this.connections.splice(i, 1);\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (this.connections.length === 0 && this.onLastConnectionRemoved) {\r\n      this.onLastConnectionRemoved.call(this.owner);\r\n    }\r\n  }\r\n\r\n  flagDependeesDirty(value?: any): void {\r\n    for (let i = 0, len = this.connections.length; i < len; i++) {\r\n      this.connections[i].node.flagDirty();\r\n    }\r\n  }\r\n\r\n  sendValue(value: any): void {\r\n    if (this._lastUpdateIteration !== (this.owner as any)._updatedAtIteration) {\r\n      this._lastUpdateIteration = (this.owner as any)._updatedAtIteration;\r\n      this.valuesSendThisIteration = 0;\r\n    } else {\r\n      this.valuesSendThisIteration++;\r\n    }\r\n\r\n    if (this.valuesSendThisIteration > 500) {\r\n      (this.owner as any)._cyclicLoop = true;\r\n    }\r\n\r\n    for (let i = 0, len = this.connections.length; i < len; i++) {\r\n      const connection = this.connections[i];\r\n      (connection.node as any)._setValueFromConnection(\r\n        connection.inputPortName,\r\n        value\r\n      );\r\n    }\r\n  }\r\n\r\n  hasConnections(): boolean {\r\n    return this.connections.length > 0;\r\n  }\r\n}\r\n","import type { GraphModel } from \"./models/graphmodel\";\r\nimport type { NodeContext } from \"./nodecontext\";\r\nimport type { InputDefinition, NodeDefinition } from \"./nodedefinition\";\r\nimport type { NodeScope } from \"./nodescope\";\r\n\r\nexport interface NodeSetup {\r\n  metadata: NodeDefinition;\r\n  setupNumberedInputDynamicPorts?: (\r\n    context: NodeContext,\r\n    graphModel: GraphModel\r\n  ) => void;\r\n  (context: any, id: string, nodeScope: any): any;\r\n}\r\n\r\nexport class NodeRegister {\r\n  private _constructors: { [key: string]: NodeSetup };\r\n  private context: NodeContext;\r\n\r\n  constructor(context: NodeContext) {\r\n    this._constructors = {};\r\n    this.context = context;\r\n  }\r\n\r\n  register(nodeDefinition: NodeSetup): void {\r\n    const name = nodeDefinition.metadata.name;\r\n    this._constructors[name] = nodeDefinition;\r\n  }\r\n\r\n  createNode(name: string, id: string, nodeScope: NodeScope): any {\r\n    if (!this._constructors.hasOwnProperty(name)) {\r\n      throw new Error(\"Unknown node type with name \" + name);\r\n    }\r\n\r\n    return this._constructors[name](this.context, id, nodeScope);\r\n  }\r\n\r\n  getNodeMetadata(type: string): NodeDefinition {\r\n    if (!this._constructors.hasOwnProperty(type)) {\r\n      throw new Error(\"Unknown node type with name \" + type);\r\n    }\r\n\r\n    return this._constructors[type].metadata;\r\n  }\r\n\r\n  hasNode(type: string): boolean {\r\n    return this._constructors.hasOwnProperty(type);\r\n  }\r\n\r\n  getInputType(type: string, inputName: string): InputDefinition {\r\n    const metadata = this.getNodeMetadata(type);\r\n    return metadata.inputs?.[inputName]?.type;\r\n  }\r\n}\r\n","interface TimerArgs {\r\n  duration?: number;\r\n  delay?: number;\r\n  repeatCount?: number;\r\n  onStart?: () => void;\r\n  onRunning?: (t: number) => void;\r\n  onStop?: () => void;\r\n  onFinish?: () => void;\r\n  [key: string]: any;\r\n}\r\n\r\nclass Timer {\r\n  [key: string]: any;\r\n\r\n  duration: number;\r\n  delay: number;\r\n  repeatCount: number;\r\n  _isRunning: boolean;\r\n  _hasCalledOnStart: boolean = false;\r\n  _wasStopped: boolean = false;\r\n  _start: number = 0;\r\n  _durationLeft: number = 0;\r\n  scheduler: TimerScheduler;\r\n  onStart?: () => void;\r\n  onRunning?: (t: number) => void;\r\n  onStop?: () => void;\r\n  onFinish?: () => void;\r\n\r\n  constructor(scheduler: TimerScheduler, args: TimerArgs) {\r\n    this.duration = args.duration || 0;\r\n    this._isRunning = false;\r\n    this._hasCalledOnStart = false;\r\n    this.scheduler = scheduler;\r\n    this.repeatCount = 1;\r\n    this.delay = 0;\r\n\r\n    for (const arg in args) {\r\n      this[arg] = args[arg];\r\n    }\r\n  }\r\n\r\n  start(): Timer {\r\n    if (this._isRunning) {\r\n      this.stop();\r\n    }\r\n\r\n    this.scheduler.scheduleTimer(this);\r\n    return this;\r\n  }\r\n\r\n  stop(): void {\r\n    this.scheduler.stopTimer(this);\r\n    this._hasCalledOnStart = false;\r\n    this._isRunning = false;\r\n    this._wasStopped = true; // This is used to avoid calling onFinish\r\n  }\r\n\r\n  isRunning(): boolean {\r\n    return this._isRunning;\r\n  }\r\n\r\n  durationLeft(): number {\r\n    return this._durationLeft;\r\n  }\r\n}\r\n\r\nexport class TimerScheduler {\r\n  requestFrame: () => void;\r\n  runningTimers: Timer[];\r\n  newTimers: Timer[];\r\n\r\n  constructor(requestFrameCallback: () => void) {\r\n    this.requestFrame = requestFrameCallback;\r\n    this.runningTimers = [];\r\n    this.newTimers = [];\r\n  }\r\n\r\n  createTimer(args: TimerArgs): Timer {\r\n    return new Timer(this, args);\r\n  }\r\n\r\n  scheduleTimer(timer: Timer): void {\r\n    if (this.newTimers.indexOf(timer) === -1) {\r\n      if (timer.repeatCount === 0) {\r\n        timer.repeatCount = 100000;\r\n      }\r\n\r\n      this.newTimers.push(timer);\r\n      this.requestFrame();\r\n    }\r\n  }\r\n\r\n  stopTimer(timer: Timer): void {\r\n    let index: number;\r\n\r\n    if (timer._isRunning) {\r\n      index = this.runningTimers.indexOf(timer);\r\n      if (index !== -1) {\r\n        this.runningTimers.splice(index, 1);\r\n      }\r\n\r\n      if (timer.onStop && !timer._wasStopped) {\r\n        timer.onStop();\r\n      }\r\n    } else {\r\n      index = this.newTimers.indexOf(timer);\r\n      if (index !== -1) {\r\n        this.newTimers.splice(index, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  runTimers(currentTime: number): void {\r\n    const remainingTimers: Timer[] = [];\r\n    const finishedTimers: Timer[] = [];\r\n    const timersThisFrame: Timer[] = [];\r\n\r\n    let i: number;\r\n    const len = this.runningTimers.length;\r\n    let timer: Timer;\r\n\r\n    //copy timer list in case timers are added or removed during onStart or onRunning\r\n    for (i = 0; i < len; ++i) {\r\n      timersThisFrame[i] = this.runningTimers[i];\r\n    }\r\n\r\n    for (i = 0; i < len; ++i) {\r\n      timer = timersThisFrame[i];\r\n      if (timer && currentTime >= timer._start) {\r\n        if (timer._hasCalledOnStart === false && timer.onStart) {\r\n          timer.onStart();\r\n          timer._hasCalledOnStart = true;\r\n        }\r\n\r\n        let t: number;\r\n        if (timer.duration > 0) {\r\n          t =\r\n            (currentTime - timer._start) / (timer.duration * timer.repeatCount);\r\n        } else {\r\n          t = 1.0;\r\n        }\r\n\r\n        timer._durationLeft = timer.duration * (1 - t);\r\n\r\n        let localT = t * timer.repeatCount - Math.floor(t * timer.repeatCount);\r\n        if (t >= 1.0) {\r\n          localT = 1.0;\r\n        }\r\n\r\n        if (timer.onRunning) {\r\n          timer.onRunning(localT);\r\n        }\r\n\r\n        if (t < 1.0 && timer._isRunning) {\r\n          remainingTimers.push(timer);\r\n        } else if (!timer._wasStopped) {\r\n          finishedTimers.push(timer);\r\n        }\r\n      } else {\r\n        remainingTimers.push(timer);\r\n      }\r\n    }\r\n\r\n    this.runningTimers = remainingTimers;\r\n\r\n    for (i = 0; i < finishedTimers.length; ++i) {\r\n      finishedTimers[i]._isRunning = false;\r\n      finishedTimers[i]._hasCalledOnStart = false;\r\n      finishedTimers[i]?.onFinish?.();\r\n    }\r\n\r\n    //add newly queued timers\r\n    if (this.newTimers.length > 0) {\r\n      for (i = 0; i < this.newTimers.length; ++i) {\r\n        timer = this.newTimers[i];\r\n        timer._start = currentTime + timer.delay;\r\n        timer._isRunning = true;\r\n        timer._wasStopped = false;\r\n        this.runningTimers.push(timer);\r\n\r\n        if (timer.delay === 0) {\r\n          //play first timer frame directly to keep everything nicely synched\r\n          if (timer.onStart) {\r\n            timer.onStart();\r\n            timer._hasCalledOnStart = true;\r\n          }\r\n          if (timer.onRunning) {\r\n            timer.onRunning(0);\r\n          }\r\n        }\r\n      }\r\n      this.newTimers.length = 0;\r\n    }\r\n  }\r\n\r\n  hasPendingTimers(): boolean {\r\n    return this.runningTimers.length > 0 || this.newTimers.length > 0;\r\n  }\r\n}\r\n","import { GraphModel } from \"./models/graphmodel\";\r\nimport { NodeScope } from \"./nodescope\";\r\n\r\nexport interface Variant {\r\n  name: string;\r\n  typename: string;\r\n  variantName?: string;\r\n  parameters: { [key: string]: any };\r\n  stateParameters: { [key: string]: { [key: string]: any } };\r\n  defaultStateTransitions: { [key: string]: any };\r\n  stateTransitions: { [key: string]: { [key: string]: any } };\r\n}\r\n\r\ninterface ConstructorParams {\r\n  graphModel?: GraphModel;\r\n  getNodeScope: () => NodeScope | null;\r\n}\r\n\r\nexport class Variants {\r\n  private getNodeScope: () => NodeScope | null;\r\n  private graphModel?: GraphModel;\r\n\r\n  constructor({ graphModel, getNodeScope }: ConstructorParams) {\r\n    this.getNodeScope = getNodeScope;\r\n\r\n    if (graphModel) {\r\n      this.graphModel = graphModel;\r\n      graphModel.on(\"variantUpdated\", (variant: Variant) =>\r\n        this.onVariantUpdated(variant)\r\n      );\r\n    }\r\n  }\r\n\r\n  getVariant(typename: string, name: string | undefined): Variant | undefined {\r\n    if (!this.graphModel) return undefined;\r\n    if (!name) return undefined;\r\n\r\n    return this.graphModel.getVariant(typename, name);\r\n  }\r\n\r\n  private onVariantUpdated(variant: Variant): void {\r\n    const nodeScope = this.getNodeScope();\r\n    if (!nodeScope) return;\r\n\r\n    //get all nodes with the type the variant applies to\r\n    const nodes = nodeScope.getNodesWithTypeRecursive(variant.typename);\r\n\r\n    //and filter for the ones using the updated variant\r\n    const nodesWithVariant = nodes.filter((node) => {\r\n      //if a variant has been set during runtime, it'll override the value from the model\r\n      if (typeof node.variant === \"object\")\r\n        return node.variant.name === variant.name;\r\n\r\n      if (typeof node.variant === \"string\")\r\n        return node.variant === variant.name;\r\n\r\n      //otherwise check the model (which always matches the editor)\r\n      return node.model && node.model.variant === variant.name;\r\n    });\r\n\r\n    //and re-apply the variant\r\n    for (const node of nodesWithVariant) {\r\n      node.setVariant(variant);\r\n    }\r\n  }\r\n}\r\n","import type { ComponentModel } from \"./models/componentmodel\";\r\nimport type { NodeModel } from \"./models/nodemodel\";\r\nimport type { NodeContext } from \"./nodecontext\";\r\nimport type { Node } from \"./node\";\r\nimport type { Variant } from \"./variants\";\r\nimport { ComponentInstanceNode } from \"./nodes/componentinstance\";\r\nimport { guid } from \"./utils\";\r\n\r\nexport interface Connection {\r\n  sourceId: string;\r\n  sourcePort: string;\r\n  targetId: string;\r\n  targetPort: string;\r\n}\r\n\r\nexport class NodeScope {\r\n  context: NodeContext;\r\n  nodes: Record<string, Node>;\r\n  componentOwner: any;\r\n  componentInstanceChildren: Record<string, any>;\r\n  componentModel?: ComponentModel;\r\n\r\n  modelScope?: any;\r\n\r\n  constructor(context: NodeContext, componentOwner: any) {\r\n    this.context = context;\r\n    this.nodes = {};\r\n    this.componentOwner = componentOwner; //Component Instance that owns this NodeScope\r\n    this.componentInstanceChildren = {};\r\n  }\r\n\r\n  private verifyData(data: any, requiredKeys: string[]): void {\r\n    requiredKeys.forEach((key) => {\r\n      if (!data[key]) {\r\n        throw new Error(\"Missing \" + key);\r\n      }\r\n    });\r\n  }\r\n\r\n  addConnection(connectionData: Connection): void {\r\n    try {\r\n      this.verifyData(connectionData, [\r\n        \"sourceId\",\r\n        \"sourcePort\",\r\n        \"targetId\",\r\n        \"targetPort\",\r\n      ]);\r\n    } catch (e) {\r\n      // @ts-expect-error\r\n      throw new Error(\"Error in connection: \" + e.message);\r\n    }\r\n\r\n    try {\r\n      const sourceNode = this.getNodeWithId(connectionData.sourceId);\r\n      const targetNode = this.getNodeWithId(connectionData.targetId);\r\n\r\n      targetNode.registerInputIfNeeded(connectionData.targetPort);\r\n      sourceNode.registerOutputIfNeeded(connectionData.sourcePort);\r\n      targetNode.connectInput(\r\n        connectionData.targetPort,\r\n        sourceNode,\r\n        connectionData.sourcePort\r\n      );\r\n    } catch (e) {\r\n      // @ts-expect-error\r\n      console.error(e.message);\r\n    }\r\n  }\r\n\r\n  setNodeParameters(node: any, nodeModel: NodeModel): void {\r\n    const variant = this.context.variants.getVariant(\r\n      nodeModel.type,\r\n      // @ts-expect-error WTF is this codebase?\r\n      nodeModel.variant\r\n    );\r\n\r\n    if (variant) {\r\n      //apply the variant (this will also apply the parameters)\r\n      node.setVariant(variant);\r\n    } else {\r\n      const parameters = nodeModel.parameters || {};\r\n\r\n      let inputNames = Object.keys(parameters);\r\n\r\n      if (this.context.nodeRegister.hasNode(node.name)) {\r\n        const metadata = this.context.nodeRegister.getNodeMetadata(node.name);\r\n        if (metadata.inputs) {\r\n          inputNames.sort((a, b) => {\r\n            const inputA = metadata.inputs![a];\r\n            const inputB = metadata.inputs![b];\r\n            return (inputB?.inputPriority ?? 0) - (inputA?.inputPriority ?? 0);\r\n          });\r\n        }\r\n      }\r\n\r\n      inputNames.forEach((inputName) => {\r\n        node.registerInputIfNeeded(inputName);\r\n\r\n        //protect against obsolete parameters\r\n        if (node.hasInput(inputName) === false) {\r\n          return;\r\n        }\r\n\r\n        node.queueInput(inputName, parameters[inputName]);\r\n      });\r\n    }\r\n  }\r\n\r\n  async createNodeFromModel(\r\n    nodeModel: NodeModel,\r\n    updateOnDirtyFlagging?: boolean\r\n  ): Promise<any> {\r\n    if (nodeModel.type === \"Component Children\") {\r\n      if (nodeModel.parent) {\r\n        const parentInstance = this.getNodeWithId(nodeModel.parent.id);\r\n        this.componentOwner.setChildRoot(parentInstance);\r\n      }\r\n      return;\r\n    }\r\n\r\n    let node;\r\n    try {\r\n      node = await this.createNode(nodeModel.type, nodeModel.id);\r\n      node.updateOnDirtyFlagging =\r\n        updateOnDirtyFlagging === false ? false : true;\r\n      node.setNodeModel(nodeModel);\r\n    } catch (e) {\r\n      // @ts-expect-error\r\n      console.error(e.message);\r\n      if (\r\n        this.context.editorConnection &&\r\n        this.context.isWarningTypeEnabled(\"nodescope\")\r\n      ) {\r\n        this.context.editorConnection.sendWarning(\r\n          this.componentOwner.name,\r\n          nodeModel.id,\r\n          \"nodelibrary-unknown-node\",\r\n          {\r\n            // @ts-expect-error\r\n            message: e.message,\r\n            showGlobally: true,\r\n          }\r\n        );\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (nodeModel.variant && node.setVariant)\r\n      node.setVariant(nodeModel.variant);\r\n    this.setNodeParameters(node, nodeModel);\r\n\r\n    if (nodeModel.parent) {\r\n      this.insertNodeInTree(node, nodeModel);\r\n    }\r\n\r\n    return node;\r\n  }\r\n\r\n  insertNodeInTree(nodeInstance: any, nodeModel: NodeModel): void {\r\n    if (!nodeModel.parent) {\r\n      throw new Error(\"Cannot insert node without parent\");\r\n    }\r\n\r\n    const parentInstance = this.getNodeWithId(nodeModel.parent.id);\r\n    const childIndex = nodeModel.parent.children.indexOf(nodeModel);\r\n\r\n    if (!parentInstance.addChild) {\r\n      throw new Error(\r\n        \"Node \" +\r\n          parentInstance.id +\r\n          \" of type \" +\r\n          parentInstance.constructor.name +\r\n          \" can't have children\"\r\n      );\r\n    }\r\n\r\n    parentInstance.addChild(nodeInstance, childIndex);\r\n  }\r\n\r\n  getNodeWithId(id: string): any {\r\n    if (!this.nodes.hasOwnProperty(id)) {\r\n      throw new Error(\"Unknown node id \" + id);\r\n    }\r\n    return this.nodes[id];\r\n  }\r\n\r\n  hasNodeWithId(id: string): boolean {\r\n    return this.nodes.hasOwnProperty(id);\r\n  }\r\n\r\n  createPrimitiveNode(\r\n    name: string,\r\n    id?: string,\r\n    extraProps?: Record<string, any>\r\n  ): any {\r\n    if (!id) id = guid();\r\n\r\n    if (this.nodes.hasOwnProperty(id)) {\r\n      throw Error(\"duplicate id \" + id);\r\n    }\r\n\r\n    const node = this.context.nodeRegister.createNode(name, id, this);\r\n    if (extraProps) {\r\n      for (const prop in extraProps) {\r\n        node[prop] = extraProps[prop];\r\n      }\r\n    }\r\n\r\n    this.nodes[id] = node;\r\n    return node;\r\n  }\r\n\r\n  async createNode(\r\n    name: string,\r\n    id?: string,\r\n    extraProps?: Record<string, any>\r\n  ): Promise<any> {\r\n    if (!id) id = guid();\r\n\r\n    if (this.nodes.hasOwnProperty(id)) {\r\n      throw Error(\"duplicate id \" + id);\r\n    }\r\n\r\n    let node;\r\n\r\n    if (this.context.nodeRegister.hasNode(name)) {\r\n      node = this.context.nodeRegister.createNode(name, id, this);\r\n      if (extraProps) {\r\n        for (const prop in extraProps) {\r\n          node[prop] = extraProps[prop];\r\n        }\r\n      }\r\n    } else {\r\n      node = await this.context.createComponentInstanceNode(\r\n        name,\r\n        id,\r\n        this,\r\n        extraProps\r\n      );\r\n      this.componentInstanceChildren[id] = node;\r\n    }\r\n\r\n    this.nodes[id] = node;\r\n    return node;\r\n  }\r\n\r\n  getNodesWithIdRecursive(id: string): Node[] {\r\n    function findNodesWithIdRec(\r\n      scope: NodeScope,\r\n      id: string,\r\n      result: Node[]\r\n    ): void {\r\n      if (scope.nodes.hasOwnProperty(id)) {\r\n        result.push(scope.nodes[id]);\r\n      }\r\n\r\n      const componentIds = Object.keys(scope.nodes).filter((nodeId) => {\r\n        return scope.nodes[nodeId] instanceof ComponentInstanceNode;\r\n      });\r\n\r\n      componentIds.forEach((componentId) => {\r\n        const nodeScope = scope.nodes[componentId].nodeScope;\r\n        if (nodeScope) {\r\n          findNodesWithIdRec(nodeScope, id, result);\r\n        }\r\n      });\r\n    }\r\n\r\n    const result: Node[] = [];\r\n    findNodesWithIdRec(this, id, result);\r\n    return result;\r\n  }\r\n\r\n  getNodesWithType(name: string): Node[] {\r\n    const ids = Object.keys(this.nodes).filter((id) => {\r\n      return this.nodes[id].name === name;\r\n    });\r\n    return ids.map((id) => {\r\n      return this.nodes[id];\r\n    });\r\n  }\r\n\r\n  getNodesWithTypeRecursive(name: string): Node[] {\r\n    let result: Node[] = [];\r\n\r\n    const findNodesWithTypeRec = () => {\r\n      result = result.concat(this.getNodesWithType(name));\r\n\r\n      const componentIds = Object.keys(this.nodes).filter((nodeId) => {\r\n        return this.nodes[nodeId] instanceof ComponentInstanceNode;\r\n      });\r\n\r\n      componentIds.forEach((componentId) => {\r\n        const node = this.nodes[componentId];\r\n        if (node && node.nodeScope) {\r\n          const res = node.nodeScope.getNodesWithTypeRecursive(name);\r\n          result = result.concat(res);\r\n        }\r\n      });\r\n    };\r\n\r\n    findNodesWithTypeRec();\r\n    return result;\r\n  }\r\n\r\n  getAllNodesRecursive(): any[] {\r\n    let result: any[] = [];\r\n\r\n    const getAllNodesRec = () => {\r\n      result = result.concat(Object.values(this.nodes));\r\n\r\n      const componentIds = Object.keys(this.nodes).filter((nodeId) => {\r\n        return this.nodes[nodeId] instanceof ComponentInstanceNode;\r\n      });\r\n      componentIds.forEach((componentId) => {\r\n        const node = this.nodes[componentId];\r\n        if (node && node.nodeScope) {\r\n          const res = node.nodeScope.getAllNodesRecursive();\r\n          result = result.concat(res);\r\n        }\r\n      });\r\n    };\r\n\r\n    getAllNodesRec();\r\n    return result;\r\n  }\r\n\r\n  getAllNodesWithVariantRecursive(variant: Variant | string): any[] {\r\n    const nodes = this.getAllNodesRecursive();\r\n    return nodes.filter((node) => node.variant === variant);\r\n  }\r\n\r\n  onNodeModelRemoved(nodeModel: NodeModel): void {\r\n    const nodeInstance = this.getNodeWithId(nodeModel.id);\r\n\r\n    if (nodeModel.parent) {\r\n      const parentInstance = this.getNodeWithId(nodeModel.parent.id);\r\n      parentInstance.removeChild(nodeInstance);\r\n    }\r\n\r\n    nodeInstance._onNodeDeleted();\r\n    delete this.nodes[nodeInstance.id];\r\n    delete this.componentInstanceChildren[nodeInstance.id];\r\n  }\r\n\r\n  removeConnection(connectionModel: Connection): void {\r\n    const targetNode = this.getNodeWithId(connectionModel.targetId);\r\n    targetNode.removeInputConnection(\r\n      connectionModel.targetPort,\r\n      connectionModel.sourceId,\r\n      connectionModel.sourcePort\r\n    );\r\n  }\r\n\r\n  async setComponentModel(componentModel: ComponentModel): Promise<void> {\r\n    this.componentModel = componentModel;\r\n\r\n    const nodes: any[] = [];\r\n\r\n    //create all nodes\r\n    for (const nodeModel of componentModel.getAllNodes()) {\r\n      const node = await this.createNodeFromModel(nodeModel, false);\r\n      if (node) nodes.push(node);\r\n    }\r\n\r\n    componentModel\r\n      .getAllConnections()\r\n      .forEach((conn) => this.addConnection(conn));\r\n\r\n    //now that all nodes and connections are setup, trigger the dirty flagging so nodes can run with all the connections in place\r\n    nodes.forEach((node) => (node.updateOnDirtyFlagging = true));\r\n\r\n    nodes.forEach((node) => {\r\n      if (node._dirty) {\r\n        node._performDirtyUpdate();\r\n      }\r\n    });\r\n\r\n    componentModel.on(\r\n      \"connectionAdded\",\r\n      (conn: Connection) => this.addConnection(conn),\r\n      this\r\n    );\r\n    componentModel.on(\"connectionRemoved\", this.removeConnection, this);\r\n    componentModel.on(\"nodeAdded\", this.createNodeFromModel, this);\r\n\r\n    componentModel.on(\r\n      \"nodeParentWillBeRemoved\",\r\n      (nodeModel: NodeModel) => {\r\n        if (nodeModel.type === \"Component Children\") {\r\n          if (nodeModel.parent) {\r\n            this.componentOwner.setChildRoot(null);\r\n          }\r\n          return;\r\n        }\r\n\r\n        const nodeInstance = this.getNodeWithId(nodeModel.id);\r\n        if (nodeInstance.parent) {\r\n          nodeInstance.parent.removeChild(nodeInstance);\r\n        }\r\n      },\r\n      this\r\n    );\r\n\r\n    componentModel.on(\r\n      \"nodeParentUpdated\",\r\n      (nodeModel: NodeModel) => {\r\n        if (nodeModel.type === \"Component Children\") {\r\n          const parentInstance = nodeModel.parent\r\n            ? this.getNodeWithId(nodeModel.parent.id)\r\n            : null;\r\n          this.componentOwner.setChildRoot(parentInstance);\r\n        } else {\r\n          const nodeInstance = this.getNodeWithId(nodeModel.id);\r\n          this.insertNodeInTree(nodeInstance, nodeModel);\r\n        }\r\n      },\r\n      this\r\n    );\r\n\r\n    componentModel.on(\r\n      \"nodeRemoved\",\r\n      (nodeModel: NodeModel) => {\r\n        if (nodeModel.type !== \"Component Children\") {\r\n          this.onNodeModelRemoved(nodeModel);\r\n        }\r\n      },\r\n      this\r\n    );\r\n\r\n    for (const id in this.nodes) {\r\n      const node = this.nodes[id];\r\n      node?.nodeScopeDidInitialize?.();\r\n    }\r\n  }\r\n\r\n  reset(): void {\r\n    if (this.componentModel) {\r\n      this.componentModel.removeListenersWithRef(this);\r\n      this.componentModel = undefined;\r\n    }\r\n\r\n    Object.keys(this.nodes).forEach((id) => {\r\n      if (this.nodes.hasOwnProperty(id)) {\r\n        this.deleteNode(this.nodes[id]);\r\n      }\r\n    });\r\n  }\r\n\r\n  deleteNode(nodeInstance: any): void {\r\n    if (!this.nodes.hasOwnProperty(nodeInstance.id)) {\r\n      console.error(\r\n        \"Node doesn't belong to this scope\",\r\n        nodeInstance.id,\r\n        nodeInstance.name\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (nodeInstance.parent) {\r\n      nodeInstance.parent.removeChild(nodeInstance);\r\n    }\r\n\r\n    //depth first\r\n    if (nodeInstance.getChildren) {\r\n      nodeInstance.getChildren().forEach((child: any) => {\r\n        nodeInstance.removeChild(child);\r\n        //the child might be created in a different scope\r\n        //if the child is a component instance, we want its parent scope, not the inner scope\r\n        const nodeScope = child.parentNodeScope || child.nodeScope;\r\n        nodeScope.deleteNode(child);\r\n      });\r\n    }\r\n\r\n    if (this.componentModel) {\r\n      const connectionFrom = this.componentModel.getConnectionsFrom(\r\n        nodeInstance.id\r\n      );\r\n      const connectionTo = this.componentModel.getConnectionsTo(\r\n        nodeInstance.id\r\n      );\r\n\r\n      connectionFrom.concat(connectionTo).forEach((connection) => {\r\n        if (\r\n          this.nodes.hasOwnProperty(connection.targetId) &&\r\n          this.nodes.hasOwnProperty(connection.sourceId)\r\n        ) {\r\n          this.removeConnection(connection);\r\n        }\r\n      });\r\n    }\r\n\r\n    nodeInstance._onNodeDeleted();\r\n    delete this.nodes[nodeInstance.id];\r\n    delete this.componentInstanceChildren[nodeInstance.id]; //in case this is a component\r\n  }\r\n\r\n  sendEventFromThisScope(\r\n    eventName: string,\r\n    data: any,\r\n    propagation?: string,\r\n    sendEventInThisScope?: boolean\r\n  ): boolean {\r\n    if (sendEventInThisScope) {\r\n      const eventReceivers = this.getNodesWithType(\"Event Receiver\").filter(\r\n        (eventReceiver) => {\r\n          // @ts-expect-error TODO: fix this\r\n          return eventReceiver.getChannelName() === eventName;\r\n        }\r\n      );\r\n\r\n      for (let i = 0; i < eventReceivers.length; i++) {\r\n        // @ts-expect-error TODO: fix this\r\n        const consumed = eventReceivers[i].handleEvent(data);\r\n        if (consumed) return true;\r\n      }\r\n    }\r\n\r\n    if (propagation === \"parent\" && this.componentOwner.parentNodeScope) {\r\n      // Send event to parent scope\r\n      //either the scope of the visual parent if there is one, otherwise the parent component\r\n      const parentNodeScope = this.componentOwner.parent\r\n        ? this.componentOwner.parent.nodeScope\r\n        : this.componentOwner.parentNodeScope;\r\n      if (!parentNodeScope) return false;\r\n      return parentNodeScope.sendEventFromThisScope(\r\n        eventName,\r\n        data,\r\n        propagation,\r\n        true\r\n      );\r\n    } else if (propagation === \"children\") {\r\n      // Send event to all child scopes\r\n      const nodes = this.nodes;\r\n      for (const nodeId in nodes) {\r\n        const children = nodes[nodeId].children;\r\n        if (children)\r\n          for (const child of children) {\r\n            if (\r\n              child.name &&\r\n              this.context.hasComponentModelWithName(child.name)\r\n            ) {\r\n              // This is a component instance child\r\n              const consumed = child.nodeScope?.sendEventFromThisScope(\r\n                eventName,\r\n                data,\r\n                propagation,\r\n                true\r\n              );\r\n              if (consumed) return true;\r\n            }\r\n          }\r\n      }\r\n    } else if (propagation === \"siblings\") {\r\n      // Send event to all siblings, that is all children of the parent scope except this scope\r\n      let parentNodeScope: NodeScope | undefined;\r\n      if (this.componentOwner.parent) {\r\n        parentNodeScope = this.componentOwner.parent.nodeScope;\r\n      } else {\r\n        parentNodeScope = this.componentOwner.parentNodeScope;\r\n      }\r\n\r\n      if (!parentNodeScope) return false;\r\n\r\n      const nodes = parentNodeScope.nodes;\r\n      for (const nodeId in nodes) {\r\n        const children = nodes[nodeId].children;\r\n        if (children) {\r\n          const _c = children.filter(\r\n            (child) =>\r\n              child.name &&\r\n              this.context.hasComponentModelWithName(child.name) &&\r\n              child.nodeScope !== this\r\n          );\r\n          for (const child of _c) {\r\n            const consumed = child.nodeScope?.sendEventFromThisScope(\r\n              eventName,\r\n              data,\r\n              undefined,\r\n              true\r\n            );\r\n            if (consumed) return true;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n}\r\n","import type { ComponentModel } from \"../models/componentmodel\";\r\nimport { Node } from \"../node\";\r\nimport { NodeScope } from \"../nodescope\";\r\n\r\nlet componentIdCounter = 0;\r\n\r\ninterface Internal {\r\n  childRoot: any;\r\n  componentOutputValues: Record<string, any>;\r\n  componentOutputs: any[];\r\n  componentInputs: any[];\r\n  inputValues: Record<string, any>;\r\n  roots: any[];\r\n  instanceId: string;\r\n  creatorCallbacks?: {\r\n    onOutputChanged?: (name: string, value: any, prevValue: any) => void;\r\n  };\r\n}\r\n\r\nexport class ComponentInstanceNode extends Node<Internal> {\r\n  nodeScope: NodeScope;\r\n  parentNodeScope: NodeScope | null;\r\n  _internal: Internal;\r\n  componentModel?: ComponentModel;\r\n  parent?: any;\r\n  cachedChildren?: any;\r\n  name?: string;\r\n\r\n  constructor(context: any, id: string, parentNodeScope: NodeScope | null) {\r\n    super(context, id);\r\n\r\n    this.nodeScope = new NodeScope(context, this);\r\n    this.parentNodeScope = parentNodeScope;\r\n    this._internal = {\r\n      childRoot: null,\r\n      componentOutputValues: {},\r\n      componentOutputs: [],\r\n      componentInputs: [],\r\n      inputValues: {},\r\n      roots: [],\r\n      instanceId: \"__$ndl_componentInstaceId\" + componentIdCounter,\r\n    };\r\n\r\n    this.nodeScope.modelScope = parentNodeScope\r\n      ? parentNodeScope.modelScope\r\n      : undefined;\r\n\r\n    componentIdCounter++;\r\n  }\r\n\r\n  async setComponentModel(componentModel: ComponentModel) {\r\n    this.componentModel = componentModel;\r\n    const self = this;\r\n\r\n    await this.nodeScope.setComponentModel(componentModel);\r\n\r\n    this._internal.componentInputs =\r\n      this.nodeScope.getNodesWithType(\"Component Inputs\");\r\n    this._internal.componentOutputs =\r\n      this.nodeScope.getNodesWithType(\"Component Outputs\");\r\n\r\n    Object.values(componentModel.getInputPorts()).forEach(\r\n      this.registerComponentInputPort.bind(this)\r\n    );\r\n    Object.values(componentModel.getOutputPorts()).forEach(\r\n      this.registerComponentOutputPort.bind(this)\r\n    );\r\n\r\n    const roots = componentModel.roots || [];\r\n    this._internal.roots = roots.map((id: string) =>\r\n      this.nodeScope.getNodeWithId(id)\r\n    );\r\n\r\n    componentModel.on(\r\n      \"rootAdded\",\r\n      (id: string) => {\r\n        this._internal.roots.push(this.nodeScope.getNodeWithId(id));\r\n        this.forceUpdate();\r\n      },\r\n      this\r\n    );\r\n\r\n    componentModel.on(\r\n      \"rootRemoved\",\r\n      function (this: ComponentInstanceNode, id: string) {\r\n        const index = this._internal.roots.findIndex(\r\n          (root: any) => root.id === id\r\n        );\r\n        if (index !== -1) {\r\n          this._internal.roots.splice(index, 1);\r\n        }\r\n        this.forceUpdate();\r\n      },\r\n      this\r\n    );\r\n\r\n    componentModel.on(\r\n      \"inputPortAdded\",\r\n      this.registerComponentInputPort.bind(this),\r\n      this\r\n    );\r\n    componentModel.on(\r\n      \"outputPortAdded\",\r\n      this.registerComponentOutputPort.bind(this),\r\n      this\r\n    );\r\n\r\n    componentModel.on(\r\n      \"inputPortRemoved\",\r\n      function (port: { name: string }) {\r\n        if (self.hasInput(port.name)) {\r\n          self.deregisterInput(port.name);\r\n        }\r\n      },\r\n      this\r\n    );\r\n\r\n    componentModel.on(\r\n      \"outputPortRemoved\",\r\n      function (this: ComponentInstanceNode, port: { name: string }) {\r\n        if (this.hasOutput(port.name)) {\r\n          self.deregisterOutput(port.name);\r\n        }\r\n      },\r\n      this\r\n    );\r\n\r\n    componentModel.on(\r\n      \"nodeAdded\",\r\n      function (node: { type: string; id: string }) {\r\n        if (node.type === \"Component Inputs\") {\r\n          self._internal.componentInputs.push(\r\n            self.nodeScope.getNodeWithId(node.id)\r\n          );\r\n        } else if (node.type === \"Component Outputs\") {\r\n          self._internal.componentOutputs.push(\r\n            self.nodeScope.getNodeWithId(node.id)\r\n          );\r\n        }\r\n      },\r\n      this\r\n    );\r\n\r\n    componentModel.on(\r\n      \"nodeRemoved\",\r\n      function (node: { type: string; id: string }) {\r\n        function removeNodesWithId(array: any[], id: string) {\r\n          return array.filter((e) => e.id !== id);\r\n        }\r\n        if (node.type === \"Component Inputs\") {\r\n          self._internal.componentInputs = removeNodesWithId(\r\n            self._internal.componentInputs,\r\n            node.id\r\n          );\r\n        } else if (node.type === \"Component Outputs\") {\r\n          self._internal.componentOutputs = removeNodesWithId(\r\n            self._internal.componentOutputs,\r\n            node.id\r\n          );\r\n        }\r\n      },\r\n      this\r\n    );\r\n\r\n    componentModel.on(\r\n      \"renamed\",\r\n      function (event: { newName: string }) {\r\n        self.name = event.newName;\r\n      },\r\n      this\r\n    );\r\n  }\r\n\r\n  _onNodeDeleted() {\r\n    if (this.componentModel) {\r\n      this.componentModel.removeListenersWithRef(this);\r\n      this.componentModel = undefined;\r\n    }\r\n\r\n    this.nodeScope.reset();\r\n    super._onNodeDeleted();\r\n  }\r\n\r\n  registerComponentInputPort(port: { name: string }) {\r\n    this.registerInput(port.name, {\r\n      set: function (this: ComponentInstanceNode, value: any) {\r\n        this._internal.inputValues[port.name] = value;\r\n        this._internal.componentInputs.forEach(function (componentInput) {\r\n          componentInput.registerOutputIfNeeded(port.name);\r\n          componentInput.flagOutputDirty(port.name);\r\n        });\r\n      },\r\n    });\r\n  }\r\n\r\n  registerComponentOutputPort(port: { name: string }) {\r\n    this.registerOutput(port.name, {\r\n      getter() {\r\n        return this._internal.componentOutputValues[port.name];\r\n      },\r\n    });\r\n  }\r\n\r\n  setOutputFromComponentOutput(name: string, value: any) {\r\n    if (this.hasOutput(name) === false) {\r\n      return;\r\n    }\r\n\r\n    this._internal.creatorCallbacks?.onOutputChanged?.(\r\n      name,\r\n      value,\r\n      this._internal.componentOutputValues[name]\r\n    );\r\n\r\n    this._internal.componentOutputValues[name] = value;\r\n    this.flagOutputDirty(name);\r\n  }\r\n\r\n  setChildRoot(node: any) {\r\n    const prevChildRoot = this._internal.childRoot;\r\n    const newChildRoot = node;\r\n\r\n    this._internal.childRoot = newChildRoot;\r\n\r\n    if (this.model && this.model.children) {\r\n      const parentNodeScope = this.parentNodeScope;\r\n\r\n      const children = this.model.children\r\n        .filter((child) => child.type !== \"Component Children\")\r\n        .map((child) => parentNodeScope?.getNodeWithId(child.id));\r\n\r\n      if (prevChildRoot) {\r\n        for (let i = 0; i < children.length; i++) {\r\n          if (prevChildRoot.isChild(children[i])) {\r\n            prevChildRoot.removeChild(children[i]);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (newChildRoot) {\r\n        for (let i = 0; i < children.length; i++) {\r\n          const child = children[i];\r\n          const index = child.model.parent.children.indexOf(child.model);\r\n          this.addChild(child, index);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  getChildRootIndex(): number {\r\n    if (!this._internal.childRoot?.model?.children) {\r\n      return 0;\r\n    }\r\n\r\n    const children = this._internal.childRoot.model.children;\r\n\r\n    for (let i = 0; i < children.length; i++) {\r\n      if (children[i].type === \"Component Children\") {\r\n        return i;\r\n      }\r\n    }\r\n\r\n    return 0;\r\n  }\r\n\r\n  getChildRoot() {\r\n    if (this._internal.childRoot) {\r\n      return this._internal.childRoot;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getRoots() {\r\n    return this._internal.roots;\r\n  }\r\n\r\n  /** Added for SSR Support */\r\n  triggerDidMount() {\r\n    this._internal.roots.forEach((root) => {\r\n      root.triggerDidMount?.();\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this._internal.roots.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    return this._internal.roots[0].render();\r\n  }\r\n\r\n  setChildIndex(childIndex: number) {\r\n    // NOTE: setChildIndex can be undefined when it is not a React node,\r\n    //       but still a visual node like the foreach (Repeater) node.\r\n    this.getRoots().forEach((root) => root.setChildIndex?.(childIndex));\r\n  }\r\n\r\n  addChild(child: any, index: number) {\r\n    this.getChildRoot().addChild(child, index + this.getChildRootIndex());\r\n  }\r\n\r\n  removeChild(child: any) {\r\n    this.getChildRoot().removeChild(child);\r\n  }\r\n\r\n  getChildren() {\r\n    const childRoot = this.getChildRoot();\r\n    return childRoot ? childRoot.getChildren() : [];\r\n  }\r\n\r\n  isChild(child: any) {\r\n    if (!this.getChildRoot()) {\r\n      return false;\r\n    }\r\n\r\n    return this.getChildRoot().isChild(child);\r\n  }\r\n\r\n  contains(node: any) {\r\n    return this.getRoots().some((root) => root.contains?.(node));\r\n  }\r\n\r\n  _performDirtyUpdate() {\r\n    super._performDirtyUpdate();\r\n\r\n    const componentInputs = this._internal.componentInputs;\r\n    for (let i = 0, len = componentInputs.length; i < len; i++) {\r\n      componentInputs[i].flagDirty();\r\n    }\r\n\r\n    this._internal.componentOutputs.forEach(function (componentOutput) {\r\n      componentOutput.flagDirty();\r\n    });\r\n  }\r\n\r\n  getRef() {\r\n    const root = this._internal.roots[0];\r\n    return root ? root.getRef() : undefined;\r\n  }\r\n\r\n  update() {\r\n    super.update();\r\n\r\n    this._internal.componentOutputs.forEach(function (componentOutput) {\r\n      componentOutput.update();\r\n    });\r\n  }\r\n\r\n  forceUpdate() {\r\n    if (!this.parent) return;\r\n\r\n    //the parent will need to re-render the roots of this component instance\r\n    //TODO: make this use a cleaner API, and only invalidate the affected child, instead of all children\r\n    this.parent.cachedChildren = undefined;\r\n    this.parent.forceUpdate();\r\n  }\r\n\r\n  getInstanceId() {\r\n    return this._internal.instanceId;\r\n  }\r\n}\r\n","import { EventEmitter } from \"eventemitter3\";\r\nimport { NodeRegister } from \"./noderegister\";\r\nimport { TimerScheduler } from \"./timerscheduler\";\r\nimport { Variants } from \"./variants\";\r\nimport { ComponentInstanceNode } from \"./nodes/componentinstance\";\r\nimport {\r\n  ConnectionPulse,\r\n  EditorConnection,\r\n  Platform,\r\n} from \"./editorconnection\";\r\nimport { NodeScope } from \"./nodescope\";\r\nimport { ComponentModel } from \"./models/componentmodel\";\r\nimport { Node } from \"./node\";\r\nimport { GraphModel } from \"./models/graphmodel\";\r\n\r\ninterface NodeContextArgs {\r\n  runningInEditor?: boolean;\r\n  graphModel?: any;\r\n  platform?: any;\r\n  editorConnection?: any;\r\n}\r\n\r\ninterface DebugInspector {\r\n  type: \"connection\" | \"node\";\r\n  id: string;\r\n  connection?: {\r\n    fromId: string;\r\n    fromProperty: string;\r\n  };\r\n  nodeId?: string;\r\n}\r\n\r\ninterface OutputHistory {\r\n  value: any;\r\n  timestamp: number;\r\n}\r\n\r\ninterface SignalHistory {\r\n  count: number;\r\n}\r\n\r\ninterface PopupCallbacks {\r\n  onShow: (group: any) => void;\r\n  onClose: (group: any) => void;\r\n}\r\n\r\ninterface PopupArgs {\r\n  senderNode?: any; // TODO: Is this Node?\r\n  onClosePopup?: (\r\n    action: string | undefined,\r\n    results: Record<string, any>\r\n  ) => void;\r\n}\r\n\r\nexport class NodeContext {\r\n  private _dirtyNodes: Node[];\r\n  private callbacksAfterUpdate: Function[];\r\n  private graphModel: GraphModel;\r\n  private platform: Platform;\r\n\r\n  eventEmitter: EventEmitter;\r\n  eventSenderEmitter: EventEmitter;\r\n  globalsEventEmitter: EventEmitter;\r\n\r\n  private globalValues: Record<string, any>;\r\n  private runningInEditor: boolean;\r\n  currentFrameTime: number;\r\n  private frameNumber: number;\r\n  public updateIteration: number;\r\n  nodeRegister: NodeRegister;\r\n  timerScheduler: TimerScheduler;\r\n  private componentModels: Record<string, ComponentModel>;\r\n  private debugInspectorsEnabled: boolean;\r\n  private connectionsToPulse: Record<string, ConnectionPulse>;\r\n  private connectionsToPulseChanged: boolean;\r\n  private debugInspectors: Record<string, DebugInspector>;\r\n  private connectionPulsingCallbackScheduled: boolean;\r\n  rootComponent: ComponentInstanceNode | undefined;\r\n  private _outputHistory: Record<string, OutputHistory>;\r\n  private _signalHistory: Record<string, SignalHistory>;\r\n  private warningTypes: Record<string, boolean>;\r\n  private bundleFetchesInFlight: Map<string, Promise<void>>;\r\n  variants: Variants;\r\n  private isUpdating: boolean = false;\r\n  private onShowPopup?: (group: any) => void;\r\n  private onClosePopup?: (group: any) => void;\r\n\r\n  public editorConnection?: EditorConnection;\r\n\r\n  public styles?: {\r\n    resolveColor: (color: any) => any;\r\n  };\r\n\r\n  constructor(args: NodeContextArgs = {}) {\r\n    const runningInEditor = args.hasOwnProperty(\"runningInEditor\")\r\n      ? args.runningInEditor\r\n      : false;\r\n\r\n    this._dirtyNodes = [];\r\n    this.callbacksAfterUpdate = [];\r\n\r\n    this.graphModel = args.graphModel;\r\n    this.platform = args.platform;\r\n\r\n    this.eventEmitter = new EventEmitter();\r\n    // this.eventEmitter.setMaxListeners(1000000);\r\n\r\n    this.eventSenderEmitter = new EventEmitter(); //used by event senders and receivers\r\n    // this.eventSenderEmitter.setMaxListeners(1000000);\r\n\r\n    this.globalValues = {};\r\n    this.globalsEventEmitter = new EventEmitter();\r\n    // this.globalsEventEmitter.setMaxListeners(1000000);\r\n\r\n    this.runningInEditor = !!runningInEditor;\r\n    this.currentFrameTime = 0;\r\n    this.frameNumber = 0;\r\n    this.updateIteration = 0;\r\n\r\n    this.nodeRegister = new NodeRegister(this);\r\n    this.timerScheduler = new TimerScheduler(this.scheduleUpdate.bind(this));\r\n\r\n    this.componentModels = {};\r\n    this.debugInspectorsEnabled = false;\r\n    this.connectionsToPulse = {};\r\n    this.connectionsToPulseChanged = false;\r\n\r\n    this.debugInspectors = {};\r\n\r\n    this.connectionPulsingCallbackScheduled = false;\r\n\r\n    this.editorConnection = args.editorConnection;\r\n\r\n    this.rootComponent = undefined;\r\n\r\n    this._outputHistory = {};\r\n    this._signalHistory = {};\r\n\r\n    this.warningTypes = {}; //default is to send all warning types\r\n\r\n    this.bundleFetchesInFlight = new Map();\r\n\r\n    this.variants = new Variants({\r\n      graphModel: this.graphModel,\r\n      getNodeScope: () =>\r\n        this.rootComponent ? this.rootComponent.nodeScope : null,\r\n    });\r\n\r\n    if (this.editorConnection) {\r\n      this.editorConnection.on(\r\n        \"debugInspectorsUpdated\",\r\n        (inspectors: DebugInspector[]) => {\r\n          this.onDebugInspectorsUpdated(inspectors);\r\n        }\r\n      );\r\n\r\n      this.editorConnection?.on(\r\n        \"getConnectionValue\",\r\n        ({\r\n          clientId,\r\n          connectionId,\r\n        }: {\r\n          clientId: string;\r\n          connectionId: string;\r\n        }) => {\r\n          if (this.editorConnection?.clientId !== clientId) return;\r\n          const connection = this._outputHistory[connectionId];\r\n          this.editorConnection?.sendConnectionValue(\r\n            connectionId,\r\n            connection ? connection.value : undefined\r\n          );\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  setRootComponent(rootComponent: any): void {\r\n    this.rootComponent = rootComponent;\r\n  }\r\n\r\n  getCurrentTime(): number {\r\n    return this.platform.getCurrentTime();\r\n  }\r\n\r\n  onDebugInspectorsUpdated(inspectors: DebugInspector[]): void {\r\n    if (!this.debugInspectorsEnabled) return;\r\n\r\n    inspectors = inspectors.map((inspector) => {\r\n      if (inspector.type === \"connection\" && inspector.connection) {\r\n        const connection = inspector.connection;\r\n        inspector.id = connection.fromId + connection.fromProperty;\r\n      } else if (inspector.type === \"node\" && inspector.nodeId) {\r\n        inspector.id = inspector.nodeId;\r\n      }\r\n      return inspector;\r\n    });\r\n\r\n    this.debugInspectors = {};\r\n    inspectors.forEach(\r\n      (inspector) => (this.debugInspectors[inspector.id] = inspector)\r\n    );\r\n\r\n    this.sendDebugInspectorValues();\r\n  }\r\n\r\n  updateDirtyNodes(): void {\r\n    let i: number, len: number;\r\n\r\n    let loop = true;\r\n    let iterations = 0;\r\n\r\n    this.updateIteration++;\r\n\r\n    this.isUpdating = true;\r\n\r\n    while (loop && iterations < 10) {\r\n      const dirtyNodes = this._dirtyNodes;\r\n      this._dirtyNodes = [];\r\n      for (i = 0, len = dirtyNodes.length; i < len; ++i) {\r\n        try {\r\n          if (!dirtyNodes[i]._deleted) {\r\n            dirtyNodes[i].update();\r\n          }\r\n        } catch (e) {\r\n          console.error(e);\r\n        }\r\n      }\r\n\r\n      //make a new reference and reset array in case new callbacks are scheduled\r\n      //by the current callbacks\r\n      const callbacks = this.callbacksAfterUpdate;\r\n      this.callbacksAfterUpdate = [];\r\n      for (i = 0, len = callbacks.length; i < len; i++) {\r\n        try {\r\n          callbacks[i]();\r\n        } catch (e) {\r\n          console.error(e);\r\n        }\r\n      }\r\n\r\n      loop =\r\n        this.callbacksAfterUpdate.length > 0 || this._dirtyNodes.length > 0;\r\n      iterations++;\r\n    }\r\n\r\n    this.isUpdating = false;\r\n  }\r\n\r\n  update(): void {\r\n    this.frameNumber++;\r\n\r\n    this.updateDirtyNodes();\r\n\r\n    if (this.timerScheduler.hasPendingTimers()) {\r\n      this.scheduleUpdate();\r\n      this.timerScheduler.runTimers(this.currentFrameTime);\r\n    }\r\n\r\n    if (this.debugInspectorsEnabled) {\r\n      this.sendDebugInspectorValues();\r\n    }\r\n  }\r\n\r\n  reset(): void {\r\n    //removes listeners like device orientation, websockets and more\r\n    this.eventEmitter.emit(\"applicationDataReloaded\");\r\n\r\n    const eventEmitter = this.eventEmitter;\r\n    [\"frameStart\", \"frameEnd\"].forEach(function (name) {\r\n      eventEmitter.removeAllListeners(name);\r\n    });\r\n\r\n    this.globalValues = {};\r\n    this._dirtyNodes.length = 0;\r\n    this.callbacksAfterUpdate.length = 0;\r\n\r\n    this.timerScheduler.runningTimers = [];\r\n    this.timerScheduler.newTimers = [];\r\n    this.rootComponent = undefined;\r\n\r\n    this.clearDebugInspectors();\r\n  }\r\n\r\n  nodeIsDirty(node: Node): void {\r\n    this._dirtyNodes.push(node);\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  scheduleUpdate(): void {\r\n    this.eventEmitter.emit(\"scheduleUpdate\");\r\n  }\r\n\r\n  scheduleAfterUpdate(fn: Parameters<EventEmitter[\"on\"]>[1]): void {\r\n    this.callbacksAfterUpdate.push(fn);\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  scheduleNextFrame(fn: Parameters<EventEmitter[\"once\"]>[1]): void {\r\n    this.eventEmitter.once(\"frameStart\", fn);\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  setGlobalValue(name: string, value: any): void {\r\n    this.globalValues[name] = value;\r\n    this.globalsEventEmitter.emit(name);\r\n  }\r\n\r\n  getGlobalValue(name: string): any {\r\n    return this.globalValues[name];\r\n  }\r\n\r\n  registerComponentModel(componentModel: ComponentModel): void {\r\n    if (this.componentModels.hasOwnProperty(componentModel.name)) {\r\n      throw new Error(\"Duplicate component name \" + componentModel.name);\r\n    }\r\n    this.componentModels[componentModel.name] = componentModel;\r\n\r\n    componentModel.on(\r\n      \"renamed\",\r\n      (event: { oldName: string; newName: string }) => {\r\n        delete this.componentModels[event.oldName];\r\n        this.componentModels[event.newName] = componentModel;\r\n      },\r\n      this\r\n    );\r\n  }\r\n\r\n  deregisterComponentModel(componentModel: ComponentModel): void {\r\n    if (this.componentModels.hasOwnProperty(componentModel.name)) {\r\n      this.componentModels[componentModel.name].removeListenersWithRef(this);\r\n      delete this.componentModels[componentModel.name];\r\n    }\r\n  }\r\n\r\n  async fetchComponentBundle(name: string): Promise<void> {\r\n    const fetchBundle = async (name: string) => {\r\n      const baseUrl = (window as any).Noodl.Env[\"BaseUrl\"] || \"/\";\r\n      const bundleUrl = `${baseUrl}noodl_bundles/${name}.json`;\r\n\r\n      const response = await fetch(bundleUrl);\r\n      if (response.status === 404) {\r\n        throw new Error(\"Component not found \" + name);\r\n      }\r\n\r\n      const data = await response.json();\r\n      for (const component of data) {\r\n        if (this.graphModel.hasComponentWithName(component.name) === false) {\r\n          await this.graphModel.importComponentFromEditorData(component);\r\n        }\r\n      }\r\n    };\r\n\r\n    if (this.bundleFetchesInFlight.has(name)) {\r\n      await this.bundleFetchesInFlight.get(name);\r\n    } else {\r\n      const promise = fetchBundle(name);\r\n      this.bundleFetchesInFlight.set(name, promise);\r\n      await promise;\r\n    }\r\n  }\r\n\r\n  async getComponentModel(name: string): Promise<any> {\r\n    if (!name) {\r\n      throw new Error(\"Component instance must have a name\");\r\n    }\r\n\r\n    if (this.componentModels.hasOwnProperty(name) === false) {\r\n      const bundleName = this.graphModel.getBundleContainingComponent(name);\r\n      if (!bundleName) {\r\n        throw new Error(\"Can't find component model for \" + name);\r\n      }\r\n\r\n      //start fetching dependencies in the background\r\n      for (const bundleDep of this.graphModel.getBundleDependencies(\r\n        bundleName\r\n      )) {\r\n        this.fetchComponentBundle(bundleDep);\r\n      }\r\n\r\n      //and wait for the bundle that has the component we need\r\n      await this.fetchComponentBundle(bundleName);\r\n    }\r\n\r\n    return this.componentModels[name];\r\n  }\r\n\r\n  hasComponentModelWithName(name: string): boolean {\r\n    return this.componentModels.hasOwnProperty(name);\r\n  }\r\n\r\n  async createComponentInstanceNode(\r\n    componentName: string,\r\n    id: string,\r\n    nodeScope: NodeScope | null,\r\n    extraProps?: Record<string, any>\r\n  ): Promise<any> {\r\n    const node = new ComponentInstanceNode(this, id, nodeScope);\r\n    node.name = componentName;\r\n\r\n    if (extraProps) {\r\n      for (const prop in extraProps) {\r\n        node[prop] = extraProps[prop];\r\n      }\r\n    }\r\n\r\n    const componentModel = await this.getComponentModel(componentName);\r\n    await node.setComponentModel(componentModel);\r\n\r\n    return node;\r\n  }\r\n\r\n  _formatConnectionValue(value: any): any {\r\n    if (\r\n      typeof value === \"object\" &&\r\n      value &&\r\n      value.constructor &&\r\n      value.constructor.name === \"Node\"\r\n    ) {\r\n      value = \"<Node> \" + value.name;\r\n    } else if (\r\n      typeof value === \"object\" &&\r\n      typeof window !== \"undefined\" &&\r\n      value instanceof HTMLElement\r\n    ) {\r\n      value = `DOM Node <${value.tagName}>`;\r\n    } else if (typeof value === \"string\" && !value.startsWith(\"[Signal]\")) {\r\n      return '\"' + value + '\"';\r\n    } else if (Number.isNaN(value)) {\r\n      return \"NaN\";\r\n    }\r\n\r\n    return value;\r\n  }\r\n\r\n  connectionSentValue(output: any, value: any): void {\r\n    if (\r\n      !this.editorConnection ||\r\n      !this.editorConnection.isConnected() ||\r\n      !this.debugInspectorsEnabled\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    const timestamp = this.getCurrentTime();\r\n\r\n    this._outputHistory[output.id] = {\r\n      value,\r\n      timestamp,\r\n    };\r\n\r\n    if (this.connectionsToPulse.hasOwnProperty(output.id)) {\r\n      this.connectionsToPulse[output.id].timestamp = timestamp;\r\n      return;\r\n    }\r\n\r\n    const connections: string[] = [];\r\n\r\n    output.connections.forEach((connection: any) => {\r\n      connections.push(\r\n        output.owner.id +\r\n          output.name +\r\n          connection.node.id +\r\n          connection.inputPortName\r\n      );\r\n    });\r\n\r\n    this.connectionsToPulse[output.id] = {\r\n      timestamp,\r\n      connections,\r\n    };\r\n\r\n    this.connectionsToPulseChanged = true;\r\n\r\n    if (this.connectionPulsingCallbackScheduled === false) {\r\n      this.connectionPulsingCallbackScheduled = true;\r\n      setTimeout(this.clearOldConnectionPulsing.bind(this), 100);\r\n    }\r\n  }\r\n\r\n  connectionSentSignal(output: any): void {\r\n    const id = output.id;\r\n    if (!this._signalHistory.hasOwnProperty(id)) {\r\n      this._signalHistory[id] = {\r\n        count: 0,\r\n      };\r\n    }\r\n\r\n    this._signalHistory[id].count++;\r\n\r\n    this.connectionSentValue(\r\n      output,\r\n      \"[Signal] Trigger count \" + this._signalHistory[id].count\r\n    );\r\n  }\r\n\r\n  clearDebugInspectors(): void {\r\n    this.debugInspectors = {};\r\n    this.connectionsToPulse = {};\r\n\r\n    this.editorConnection?.sendPulsingConnections(this.connectionsToPulse);\r\n  }\r\n\r\n  clearOldConnectionPulsing(): void {\r\n    this.connectionPulsingCallbackScheduled = false;\r\n\r\n    const now = this.getCurrentTime();\r\n\r\n    const connectionIds = Object.keys(this.connectionsToPulse);\r\n    connectionIds.forEach((id) => {\r\n      const con = this.connectionsToPulse[id];\r\n      if (now - con.timestamp > 100) {\r\n        this.connectionsToPulseChanged = true;\r\n        delete this.connectionsToPulse[id];\r\n      }\r\n    });\r\n\r\n    if (this.connectionsToPulseChanged) {\r\n      this.connectionsToPulseChanged = false;\r\n      this.editorConnection?.sendPulsingConnections(this.connectionsToPulse);\r\n    }\r\n\r\n    if (Object.keys(this.connectionsToPulse).length > 0) {\r\n      this.connectionPulsingCallbackScheduled = true;\r\n      setTimeout(this.clearOldConnectionPulsing.bind(this), 500);\r\n    }\r\n  }\r\n\r\n  _getDebugInspectorValueForNode(\r\n    id: string\r\n  ): { type: \"node\"; id: string; value: any } | undefined {\r\n    if (!this.rootComponent) return;\r\n    const nodes = this.rootComponent.nodeScope.getNodesWithIdRecursive(id);\r\n    const node = nodes[nodes.length - 1];\r\n\r\n    if (node && node.getInspectInfo) {\r\n      const info = node.getInspectInfo();\r\n      if (info !== undefined) {\r\n        return { type: \"node\", id, value: info };\r\n      }\r\n    }\r\n  }\r\n\r\n  sendDebugInspectorValues(): void {\r\n    const valuesToSend: Array<{ type: string; id: string; value: any }> = [];\r\n\r\n    for (const id in this.debugInspectors) {\r\n      const inspector = this.debugInspectors[id];\r\n\r\n      if (\r\n        inspector.type === \"connection\" &&\r\n        this._outputHistory.hasOwnProperty(id)\r\n      ) {\r\n        const value = this._outputHistory[id].value;\r\n\r\n        valuesToSend.push({\r\n          type: \"connection\",\r\n          id,\r\n          value: this._formatConnectionValue(value),\r\n        });\r\n      } else if (inspector.type === \"node\") {\r\n        const inspectorValue = this._getDebugInspectorValueForNode(id);\r\n        inspectorValue && valuesToSend.push(inspectorValue);\r\n      }\r\n    }\r\n\r\n    if (valuesToSend.length > 0) {\r\n      this.editorConnection?.sendDebugInspectorValues(valuesToSend);\r\n    }\r\n\r\n    if (this.connectionsToPulseChanged) {\r\n      this.connectionsToPulseChanged = false;\r\n      this.editorConnection?.sendPulsingConnections(this.connectionsToPulse);\r\n    }\r\n  }\r\n\r\n  setDebugInspectorsEnabled(enabled: boolean): void {\r\n    this.debugInspectorsEnabled = enabled;\r\n    if (this.editorConnection) {\r\n      // TODO: this.editorConnection.sendDebugInspectorsEnabled(enabled);\r\n    }\r\n    if (enabled) {\r\n      this.sendDebugInspectorValues();\r\n    }\r\n  }\r\n\r\n  sendGlobalEventFromEventSender(\r\n    channelName: string,\r\n    inputValues: Record<string, any>\r\n  ): void {\r\n    this.eventSenderEmitter.emit(channelName, inputValues);\r\n  }\r\n\r\n  setPopupCallbacks(callbacks: PopupCallbacks): void {\r\n    this.onShowPopup = callbacks.onShow;\r\n    this.onClosePopup = callbacks.onClose;\r\n  }\r\n\r\n  async showPopup(\r\n    popupComponent: string,\r\n    params: Record<string, any>,\r\n    args?: PopupArgs\r\n  ): Promise<void> {\r\n    if (!this.onShowPopup) return;\r\n\r\n    const nodeScope = this.rootComponent!.nodeScope;\r\n\r\n    const popupNode = await nodeScope.createNode(popupComponent);\r\n    for (const inputKey in params) {\r\n      popupNode.setInputValue(inputKey, params[inputKey]);\r\n    }\r\n\r\n    popupNode.popupParent = args?.senderNode || null;\r\n\r\n    // Create container group\r\n    const group = nodeScope.createPrimitiveNode(\"Group\");\r\n    group.setInputValue(\"flexDirection\", \"node\");\r\n    group.setInputValue(\"cssClassName\", \"noodl-popup\");\r\n\r\n    const bodyScroll = this.graphModel.getSettings().bodyScroll;\r\n\r\n    //if the body can scroll the position of the popup needs to be fixed.\r\n    group.setInputValue(\"position\", bodyScroll ? \"fixed\" : \"absolute\");\r\n\r\n    const closePopupNodes = popupNode.nodeScope.getNodesWithType(\r\n      \"NavigationClosePopup\"\r\n    );\r\n    if (closePopupNodes && closePopupNodes.length > 0) {\r\n      for (let j = 0; j < closePopupNodes.length; j++) {\r\n        closePopupNodes[j]._setCloseCallback(\r\n          (action?: string, results?: Record<string, any>) => {\r\n            //close next frame so all nodes have a chance to update before being deleted\r\n            this.scheduleNextFrame(() => {\r\n              //avoid double callbacks\r\n              if (!nodeScope.hasNodeWithId(group.id)) return;\r\n\r\n              this.onClosePopup?.(group);\r\n              nodeScope.deleteNode(group);\r\n              args?.onClosePopup?.(action, results || {});\r\n            });\r\n          }\r\n        );\r\n      }\r\n    }\r\n\r\n    this.onShowPopup(group);\r\n\r\n    requestAnimationFrame(() => {\r\n      //hack to make the react components have the right props\r\n      //TODO: figure out why this requestAnimationFrame is necessary\r\n      group.addChild(popupNode);\r\n    });\r\n  }\r\n\r\n  setWarningTypes(warningTypes: Record<string, boolean>): void {\r\n    Object.assign(this.warningTypes, warningTypes);\r\n  }\r\n\r\n  isWarningTypeEnabled(warning: string): boolean {\r\n    if (!this.warningTypes.hasOwnProperty(warning)) {\r\n      //if a level isn't set, default to true\r\n      return true;\r\n    }\r\n\r\n    return this.warningTypes[warning] ? true : false;\r\n  }\r\n\r\n  getDefaultValueForInput(nodeType: string, inputName: string): any {\r\n    if (this.nodeRegister.hasNode(nodeType) === false) {\r\n      return undefined;\r\n    }\r\n\r\n    const nodeMetadata = this.nodeRegister.getNodeMetadata(nodeType);\r\n\r\n    const inputMetadata = nodeMetadata.inputs?.[inputName];\r\n    if (!inputMetadata) {\r\n      return undefined;\r\n    }\r\n\r\n    if (inputMetadata.type.defaultUnit) {\r\n      return {\r\n        value: inputMetadata.default,\r\n        unit: inputMetadata.type.defaultUnit,\r\n      };\r\n    }\r\n\r\n    return inputMetadata.default;\r\n  }\r\n}\r\n","type Callback = (data?: any) => void | Promise<void>;\r\ntype ListenersMap = Record<string, Callback[]>;\r\ntype ListenersWithRefsMap = Record<string, Map<any, Callback[]>>;\r\n\r\nexport class EventSender {\r\n  private listeners: ListenersMap;\r\n  private listenersWithRefs: ListenersWithRefsMap;\r\n\r\n  constructor() {\r\n    this.listeners = {};\r\n    this.listenersWithRefs = {};\r\n  }\r\n\r\n  on(eventName: string, callback: Callback, ref?: any): void {\r\n    if (ref) {\r\n      if (!this.listenersWithRefs.hasOwnProperty(eventName)) {\r\n        this.listenersWithRefs[eventName] = new Map();\r\n      }\r\n\r\n      if (!this.listenersWithRefs[eventName].get(ref)) {\r\n        this.listenersWithRefs[eventName].set(ref, []);\r\n      }\r\n\r\n      this.listenersWithRefs[eventName].get(ref)!.push(callback);\r\n    } else {\r\n      if (!this.listeners.hasOwnProperty(eventName)) {\r\n        this.listeners[eventName] = [];\r\n      }\r\n\r\n      this.listeners[eventName].push(callback);\r\n    }\r\n  }\r\n\r\n  removeListenersWithRef(ref: any): void {\r\n    Object.keys(this.listenersWithRefs).forEach((eventName) => {\r\n      const listeners = this.listenersWithRefs[eventName];\r\n      if (listeners.has(ref)) {\r\n        listeners.delete(ref);\r\n      }\r\n    });\r\n  }\r\n\r\n  removeAllListeners(eventName?: string): void {\r\n    if (eventName) {\r\n      delete this.listeners[eventName];\r\n      delete this.listenersWithRefs[eventName];\r\n    } else {\r\n      this.listeners = {};\r\n      this.listenersWithRefs = {};\r\n    }\r\n  }\r\n\r\n  async emit(eventName: string, data?: any): Promise<void> {\r\n    const array = this.listeners[eventName];\r\n\r\n    if (array) {\r\n      const callbacks = [...array];\r\n      for (const callback of callbacks) {\r\n        await Promise.resolve(callback(data));\r\n      }\r\n    }\r\n\r\n    const map = this.listenersWithRefs[eventName];\r\n\r\n    if (map) {\r\n      for (const [ref, callbacks] of map) {\r\n        for (const callback of callbacks) {\r\n          await Promise.resolve(callback.call(ref, data));\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","//used to optimize warnings so we're not sending unneccessary warnings.\r\n//Improves editor performance, especially in larger projects\r\n\r\ninterface WarningMap {\r\n  [key: string]: string;\r\n}\r\n\r\nexport class ActiveWarnings {\r\n  private currentWarnings: Map<string, WarningMap>;\r\n\r\n  constructor() {\r\n    this.currentWarnings = new Map();\r\n  }\r\n\r\n  setWarning(nodeId: string, key: string, warning: string): boolean {\r\n    //Check if we've already sent this warning\r\n    if (this.currentWarnings.has(nodeId)) {\r\n      //we have sent warnings to this node before, check if we've sent this particular one before\r\n      const warningKeys = this.currentWarnings.get(nodeId);\r\n      if (warningKeys && warningKeys[key] === warning) {\r\n        //we've already sent this warning, no need to send it again\r\n        return false;\r\n      }\r\n\r\n      //new warning, remember that we sent it\r\n      if (warningKeys) {\r\n        warningKeys[key] = warning;\r\n      }\r\n      return true;\r\n    } else {\r\n      //new warning, we havent sent any warnings to this node before\r\n      //Remember that we sent it\r\n      this.currentWarnings.set(nodeId, { [key]: warning });\r\n      return true;\r\n    }\r\n  }\r\n\r\n  clearWarning(nodeId: string, key: string): boolean {\r\n    const warningKeys = this.currentWarnings.get(nodeId);\r\n\r\n    if (!warningKeys || !warningKeys[key]) {\r\n      //There are no warnings that we've sent on this node.\r\n      //Save some performance by not sending an uneccesary message to the editor\r\n      return false;\r\n    }\r\n\r\n    delete warningKeys[key];\r\n    if (Object.keys(warningKeys).length === 0) {\r\n      this.currentWarnings.delete(nodeId);\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  clearWarnings(nodeId: string): boolean {\r\n    if (this.currentWarnings.has(nodeId) === false) {\r\n      //no warnings on this node, save some performance by not sending a message to the editor\r\n      return false;\r\n    }\r\n\r\n    //no warnings for this node anymore\r\n    this.currentWarnings.delete(nodeId);\r\n    return true;\r\n  }\r\n}\r\n","import { EventSender } from \"./eventsender\";\r\nimport { ActiveWarnings } from \"./editorconnection.activewarnings\";\r\nimport { guid } from \"./utils\";\r\n\r\nexport interface Platform {\r\n  webSocketClass?: typeof WebSocket;\r\n  webSocketOptions?: any;\r\n  getCurrentTime: () => number;\r\n  isRunningLocally?: () => boolean;\r\n  requestUpdate?: (callback: () => void) => void;\r\n  objectToString?: (obj: any) => string;\r\n}\r\n\r\ninterface EditorConnectionOptions {\r\n  runtimeType?: string;\r\n  platform?: Platform;\r\n}\r\n\r\ninterface ServiceRequest {\r\n  token: string;\r\n  clientId: string;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface ConnectionPulse {\r\n  timestamp: number;\r\n  connections: string[];\r\n}\r\n\r\nexport class EditorConnection extends EventSender {\r\n  private runtimeType: string | undefined;\r\n  private platform: Platform;\r\n  private ws: typeof WebSocket;\r\n  private wsOptions: any;\r\n  private reconnectOnClose: boolean;\r\n  private enableDebugger: boolean;\r\n  private lastSendTimestamp: number;\r\n  private sendQueue: any[];\r\n  private sendTimer: ReturnType<typeof setTimeout> | undefined;\r\n  private activeWarnings: ActiveWarnings;\r\n  private socket?: WebSocket;\r\n\r\n  clientId: string = \"\";\r\n  debugInspectorsEnabled?: boolean;\r\n\r\n  constructor(opts: EditorConnectionOptions = {}) {\r\n    super();\r\n\r\n    this.runtimeType = opts.runtimeType;\r\n    this.platform = opts.platform || { getCurrentTime: () => Date.now() };\r\n    // @ts-expect-error\r\n    this.ws =\r\n      opts.platform?.webSocketClass ||\r\n      (typeof WebSocket !== \"undefined\" ? WebSocket : undefined);\r\n    this.wsOptions = opts.platform?.webSocketOptions;\r\n    this.reconnectOnClose = true;\r\n    this.enableDebugger = false;\r\n\r\n    this.lastSendTimestamp = 0;\r\n    this.sendQueue = [];\r\n    this.sendTimer = undefined;\r\n\r\n    //used to optimize warnings so we're not sending unneccessary warnings.\r\n    //Can slow down the editor in large projects\r\n    this.activeWarnings = new ActiveWarnings();\r\n  }\r\n\r\n  isRunningLocally(): boolean {\r\n    const runningLocallyInBrowser =\r\n      (this.platform.isRunningLocally && this.platform.isRunningLocally()) ||\r\n      (typeof document !== \"undefined\" &&\r\n        (document.location.hostname === \"localhost\" ||\r\n          document.location.hostname === \"127.0.0.1\"));\r\n    return runningLocallyInBrowser;\r\n  }\r\n\r\n  connect(address: string): void {\r\n    this.socket = this.wsOptions\r\n      ? new this.ws(address, this.wsOptions)\r\n      : new this.ws(address);\r\n\r\n    this.socket.addEventListener(\"open\", () => {\r\n      this.clientId = guid();\r\n      this.socket?.send(\r\n        JSON.stringify({\r\n          cmd: \"register\",\r\n          type: \"viewer\",\r\n          clientId: this.clientId,\r\n        })\r\n      );\r\n      this.emit(\"connected\");\r\n    });\r\n\r\n    this.socket.addEventListener(\"close\", (event: CloseEvent) => {\r\n      if (this.reconnectOnClose) {\r\n        this.reconnect(address);\r\n      }\r\n      console.log(\"Editor connection closed\", event.code, event.reason);\r\n      this.emit(\"connectionClosed\");\r\n    });\r\n\r\n    this.socket.addEventListener(\"error\", () => {\r\n      console.log(\"Editor connection error, trying to reconnect\");\r\n    });\r\n\r\n    this.socket.addEventListener(\"message\", async (e: MessageEvent) => {\r\n      // NOTE: When the data is too big it seems to change from string to a blob\r\n      const text = typeof e.data === \"string\" ? e.data : await e.data.text();\r\n      const message = JSON.parse(text);\r\n\r\n      let content;\r\n\r\n      if (message.cmd === \"registered\") {\r\n        //ignore\r\n      } else if (message.cmd === \"export\") {\r\n        content = JSON.parse(message.content);\r\n        if (message.type === \"full\" && message.target === this.clientId) {\r\n          this.emit(\"exportDataFull\", content);\r\n        }\r\n      } else if (message.cmd === \"hoverStart\") {\r\n        this.emit(\"hoverStart\", message.content.id);\r\n      } else if (message.cmd === \"hoverEnd\") {\r\n        this.emit(\"hoverEnd\", message.content.id);\r\n      } else if (message.cmd === \"refresh\") {\r\n        this.emit(\"reload\");\r\n      } else if (message.cmd === \"debugInspectors\") {\r\n        if (this.debugInspectorsEnabled) {\r\n          content = JSON.parse(message.content);\r\n          this.emit(\"debugInspectorsUpdated\", content.inspectors);\r\n        }\r\n      } else if (message.cmd === \"debuggingEnabled\") {\r\n        if (this.isRunningLocally()) {\r\n          content = JSON.parse(message.content);\r\n          this.emit(\"debuggingEnabledChanged\", content.enabled);\r\n        }\r\n      } else if (message.cmd === \"getConnectionValue\") {\r\n        if (this.isRunningLocally()) {\r\n          content = JSON.parse(message.content);\r\n          await this.emit(\"getConnectionValue\", {\r\n            clientId: content.clientId,\r\n            connectionId: content.connectionId,\r\n          });\r\n        }\r\n      } else if (message.cmd === \"modelUpdate\") {\r\n        await this.emit(\"modelUpdate\", message.content);\r\n      } else if (message.cmd === \"publish\") {\r\n        // TODO: What is this?\r\n        // Services.pubsub.routeMessage(message); // Publish a message from the pubsub service\r\n      } else if (message.cmd === \"noodlModules\") {\r\n        this.emit(\"noodlModules\", JSON.parse(message.content));\r\n      } else if (message.cmd === \"mqttUpdate\") {\r\n        this.emit(\"mqttUpdate\", message.content);\r\n      } else if (message.cmd === \"activeComponentChanged\") {\r\n        this.emit(\"activeComponentChanged\", message.component);\r\n      } else {\r\n        console.log(\"Command not implemented\", message);\r\n      }\r\n    });\r\n  }\r\n\r\n  reconnect(address: string): void {\r\n    setTimeout(() => {\r\n      this.connect(address);\r\n    }, 2000);\r\n  }\r\n\r\n  isConnected(): boolean {\r\n    return this.socket !== undefined && this.socket.readyState === this.ws.OPEN;\r\n  }\r\n\r\n  //JSON replacer to make cyclic objects non-cyclic.\r\n  //Using this example: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cyclic_object_value#examples\r\n  private getCircularReplacer() {\r\n    const seen = new WeakSet();\r\n    return (key: string, value: any) => {\r\n      if (typeof value === \"object\" && value !== null) {\r\n        if (seen.has(value)) {\r\n          return \"[Circular]\";\r\n        }\r\n        seen.add(value);\r\n      }\r\n      return value;\r\n    };\r\n  }\r\n\r\n  send(data: any): void {\r\n    const now = this.platform.getCurrentTime();\r\n    const dt = now - this.lastSendTimestamp;\r\n\r\n    //Send objects as json and capture exceptions\r\n    const trySend = (msg: any) => {\r\n      try {\r\n        this.socket?.send(JSON.stringify(msg));\r\n      } catch (e: any) {\r\n        if (e.message && e.message.startsWith(\"Converting circular\")) {\r\n          //the object is circular, try to address it\r\n          try {\r\n            this.socket?.send(JSON.stringify(msg, this.getCircularReplacer()));\r\n          } catch (e) {\r\n            //still failed, give up\r\n            console.log(\"failed to send message to editor\", msg, e);\r\n          }\r\n        } else {\r\n          //message couldn't be serialized to json\r\n          console.log(\"failed to send message to editor\", msg, e);\r\n        }\r\n      }\r\n    };\r\n\r\n    //batch messages so they're only sent at most every 200ms\r\n    //note that the first message will always be sent immediately, and the ones for 200ms after\r\n    //that one will be queued. So initial message response time is as low as possible (for hover etc)\r\n    if (dt < 200 || this.sendTimer || !this.isConnected()) {\r\n      this.sendQueue.push(data);\r\n      if (!this.sendTimer) {\r\n        this.sendTimer = setTimeout(() => {\r\n          if (this.isConnected() === false) {\r\n            return;\r\n          }\r\n\r\n          //send messages in chunks. If we send too many at once the editor UI can freeze for a while\r\n          //since it's handling these in the renderer process\r\n          const chunkSize = 50;\r\n          for (let i = 0; i < this.sendQueue.length; i += chunkSize) {\r\n            const chunk = this.sendQueue.slice(i, i + chunkSize);\r\n            trySend(chunk);\r\n          }\r\n\r\n          this.sendQueue = [];\r\n          this.sendTimer = undefined;\r\n          this.lastSendTimestamp = this.platform.getCurrentTime();\r\n        }, 100);\r\n      }\r\n    } else {\r\n      this.lastSendTimestamp = now;\r\n      trySend(data);\r\n    }\r\n  }\r\n\r\n  sendInspectId(id: string): void {\r\n    this.send({\r\n      cmd: \"select\",\r\n      type: \"viewer\",\r\n      content: JSON.stringify({ id: id }),\r\n    });\r\n  }\r\n\r\n  sendSelectComponent(componentName: string): void {\r\n    this.send({\r\n      cmd: \"select\",\r\n      type: \"viewer\",\r\n      content: JSON.stringify({ componentName }),\r\n    });\r\n  }\r\n\r\n  sendPulsingConnections(connectionMap: Record<string, ConnectionPulse>): void {\r\n    const connectionsToPulse: any[] = [];\r\n    Object.keys(connectionMap).forEach((c) => {\r\n      const connection = connectionMap[c];\r\n      connectionsToPulse.push(...connection.connections);\r\n    });\r\n\r\n    this.send({\r\n      cmd: \"connectiondebugpulse\",\r\n      type: \"viewer\",\r\n      content: JSON.stringify({\r\n        connectionsToPulse: connectionsToPulse,\r\n      }),\r\n    });\r\n  }\r\n\r\n  sendDebugInspectorValues(inspectors: any): void {\r\n    this.send({\r\n      cmd: \"debuginspectorvalues\",\r\n      type: \"viewer\",\r\n      content: { inspectors },\r\n    });\r\n  }\r\n\r\n  sendConnectionValue(connectionId: string, value: any): void {\r\n    this.send({\r\n      cmd: \"connectionValue\",\r\n      type: \"viewer\",\r\n      content: { connectionId, value },\r\n    });\r\n  }\r\n\r\n  private dynamicPortsHash: Record<string, string> = {};\r\n\r\n  private _detectRename(\r\n    before: string[],\r\n    after: string[]\r\n  ): { before: string; after: string } | undefined {\r\n    if (!before || !after) return;\r\n\r\n    if (before.length !== after.length) return; // Must be of same length\r\n\r\n    const res: { before?: string; after?: string } = {};\r\n    for (let i = 0; i < before.length; i++) {\r\n      if (after.indexOf(before[i]) === -1) {\r\n        if (res.before) return; // Can only be one from before that is missing\r\n        res.before = before[i];\r\n      }\r\n\r\n      if (before.indexOf(after[i]) === -1) {\r\n        if (res.after) return; // Only one can be missing,otherwise we cannot match\r\n        res.after = after[i];\r\n      }\r\n    }\r\n\r\n    return res.before && res.after\r\n      ? { before: res.before, after: res.after }\r\n      : undefined;\r\n  }\r\n\r\n  sendDynamicPorts(id: string, ports: any[], options?: any): void {\r\n    const hash = JSON.stringify(ports);\r\n    if (this.dynamicPortsHash[id] === hash) {\r\n      // Make sure we don't resend the same port data\r\n      return;\r\n    }\r\n\r\n    if (\r\n      this.dynamicPortsHash[id] &&\r\n      ports &&\r\n      options &&\r\n      options.detectRenamed\r\n    ) {\r\n      const detectRenamed = Array.isArray(options.detectRenamed)\r\n        ? options.detectRenamed\r\n        : [options.detectRenamed];\r\n\r\n      const renamed: any[] = [];\r\n      detectRenamed.forEach((d: any) => {\r\n        let before = JSON.parse(this.dynamicPortsHash[id]);\r\n        let after = [...ports];\r\n\r\n        // Filter ports with correct prefix and plug\r\n        if (d.prefix) {\r\n          before = before.filter((p: any) => p.name.startsWith(d.prefix));\r\n          after = after.filter((p: any) => p.name.startsWith(d.prefix));\r\n        }\r\n\r\n        if (d.plug) {\r\n          before = before.filter((p: any) => p.plug === d.plug);\r\n          after = after.filter((p: any) => p.plug === d.plug);\r\n        }\r\n\r\n        // Remove the prefix\r\n        after = after.map((p: any) =>\r\n          p.name.substring((d.prefix || \"\").length)\r\n        );\r\n        before = before.map((p: any) =>\r\n          p.name.substring((d.prefix || \"\").length)\r\n        );\r\n\r\n        // Find the one that is renamed (if any)\r\n        const res = this._detectRename(before, after);\r\n        if (res) {\r\n          renamed.push({\r\n            plug: d.plug,\r\n            patterns: [(d.prefix || \"\") + \"{{*}}\"],\r\n            before: res.before,\r\n            after: res.after,\r\n          });\r\n        }\r\n      });\r\n      if (renamed.length > 0) options.renamed = renamed;\r\n\r\n      delete options.detectRenamed;\r\n    }\r\n\r\n    this.dynamicPortsHash[id] = hash;\r\n\r\n    this.send({\r\n      cmd: \"instanceports\",\r\n      type: \"viewer\",\r\n      content: JSON.stringify({\r\n        nodeid: id,\r\n        ports: ports,\r\n        options: options,\r\n      }),\r\n    });\r\n  }\r\n\r\n  sendWarning(\r\n    componentName: string,\r\n    nodeId: string,\r\n    key: string,\r\n    warning: any\r\n  ): void {\r\n    const isNewWarning = this.activeWarnings.setWarning(nodeId, key, warning);\r\n\r\n    if (isNewWarning) {\r\n      this.send({\r\n        cmd: \"showwarning\",\r\n        type: \"viewer\",\r\n        content: JSON.stringify({\r\n          componentName: componentName,\r\n          nodeId: nodeId,\r\n          key: key,\r\n          warning: warning,\r\n        }),\r\n      });\r\n    }\r\n  }\r\n\r\n  clearWarning(componentName: string, nodeId: string, key: string): void {\r\n    const hasWarning = this.activeWarnings.clearWarning(nodeId, key);\r\n\r\n    if (hasWarning) {\r\n      this.send({\r\n        cmd: \"showwarning\",\r\n        type: \"viewer\",\r\n        content: JSON.stringify({\r\n          componentName: componentName,\r\n          nodeId: nodeId,\r\n          key: key,\r\n          warning: undefined,\r\n        }),\r\n      });\r\n    }\r\n  }\r\n\r\n  clearWarnings(componentName: string, nodeId: string): void {\r\n    const hasWarnings = this.activeWarnings.clearWarnings(nodeId);\r\n\r\n    if (hasWarnings) {\r\n      this.send({\r\n        cmd: \"clearwarnings\",\r\n        type: \"viewer\",\r\n        content: JSON.stringify({\r\n          componentName: componentName,\r\n          nodeId: nodeId,\r\n        }),\r\n      });\r\n    }\r\n  }\r\n\r\n  sendPatches(patches: any): void {\r\n    this.send({\r\n      cmd: \"patchproject\",\r\n      type: \"viewer\",\r\n      content: JSON.stringify(patches),\r\n    });\r\n  }\r\n\r\n  requestFullExport(): void {\r\n    this.send({\r\n      cmd: \"register\",\r\n      type: \"viewer\",\r\n    });\r\n  }\r\n\r\n  requestNoodlModules(): void {\r\n    this.send({\r\n      cmd: \"getNoodlModules\",\r\n      type: \"viewer\",\r\n    });\r\n  }\r\n\r\n  private serviceRequests: Record<string, (response: any) => void> = {};\r\n\r\n  sendServiceRequest(\r\n    request: ServiceRequest,\r\n    callback: (response: any) => void\r\n  ): void {\r\n    request.token = guid();\r\n    request.clientId = this.clientId;\r\n    this.serviceRequests[request.token] = callback;\r\n    this.send(request);\r\n  }\r\n\r\n  close(): void {\r\n    this.reconnectOnClose = false;\r\n\r\n    if (this.isConnected() === false) {\r\n      return;\r\n    }\r\n\r\n    this.socket?.close();\r\n  }\r\n\r\n  sendNodeLibrary(nodelibrary: any): void {\r\n    this.send({\r\n      cmd: \"nodelibrary\",\r\n      type: \"viewer\",\r\n      runtimeType: this.runtimeType,\r\n      content: nodelibrary,\r\n      clientId: this.clientId,\r\n    });\r\n  }\r\n\r\n  sendComponentMetadata(componentName: string, key: string, data: any): void {\r\n    this.send({\r\n      cmd: \"componentMetadata\",\r\n      type: \"viewer\",\r\n      content: JSON.stringify({\r\n        componentName,\r\n        key,\r\n        data,\r\n      }),\r\n    });\r\n  }\r\n\r\n  sendProjectMetadata(key: string, data: any): void {\r\n    this.send({\r\n      cmd: \"projectMetadata\",\r\n      type: \"viewer\",\r\n      content: JSON.stringify({\r\n        key,\r\n        data,\r\n      }),\r\n    });\r\n  }\r\n}\r\n","import { Port } from \"./models/componentmodel\";\r\nimport type {\r\n  DynamicPort,\r\n  InputDefinition,\r\n  NodeDefinition,\r\n  OutputDefinition,\r\n} from \"./nodedefinition\";\r\nimport { NodeRegister } from \"./noderegister\";\r\n\r\nfunction formatDynamicPorts(nodeMetadata: NodeDefinition): DynamicPort[] {\r\n  const dynamicports: DynamicPort[] = [];\r\n\r\n  for (const dp of nodeMetadata.dynamicports || []) {\r\n    if (dp.ports || dp.template || dp.port || dp.channelPort) {\r\n      //same format as editor expects, no need to transform it\r\n      dynamicports.push(dp as DynamicPort);\r\n    } else if (dp.inputs || dp.outputs) {\r\n      //inputs and outputs is just list of names\r\n      //need to pull the metadata from the inputs/outputs since they\r\n      //won't be registered by the editor (it's either a regular port\r\n      // or a dynamic port, can't register both)\r\n      const ports: Port[] = [];\r\n\r\n      if (dp.inputs) {\r\n        for (const inputName of dp.inputs) {\r\n          const input = nodeMetadata.inputs?.[inputName];\r\n          if (input) {\r\n            ports.push(formatPort(inputName, input, \"input\"));\r\n          }\r\n        }\r\n      }\r\n\r\n      if (dp.outputs) {\r\n        for (const outputName of dp.outputs) {\r\n          const output = nodeMetadata.outputs?.[outputName];\r\n          if (output) {\r\n            ports.push(formatPort(outputName, output, \"output\"));\r\n          }\r\n        }\r\n      }\r\n\r\n      const dynamicPortGroup: DynamicPort = {\r\n        name: dp.name || \"conditionalports/basic\",\r\n        condition: dp.condition,\r\n        ports,\r\n      };\r\n\r\n      dynamicports.push(dynamicPortGroup);\r\n    }\r\n  }\r\n\r\n  return dynamicports;\r\n}\r\n\r\nfunction formatPort(\r\n  portName: string,\r\n  portData: InputDefinition<any> | OutputDefinition<any>,\r\n  plugType: Port[\"plug\"]\r\n): Port {\r\n  const port: Port = {\r\n    name: portName,\r\n    type: portData.type,\r\n    plug: plugType,\r\n  };\r\n  if (portData.group) {\r\n    port.group = portData.group;\r\n  }\r\n  if (portData.displayName) {\r\n    port.displayName = portData.displayName;\r\n  }\r\n  if (portData.description) {\r\n    port.description = portData.description;\r\n  }\r\n  if (portData.editorName) {\r\n    port.editorName = portData.editorName;\r\n  }\r\n  if (portData.default !== undefined) {\r\n    port.default = portData.default;\r\n  }\r\n  if (portData.hasOwnProperty(\"index\")) {\r\n    port.index = portData.index;\r\n  }\r\n  if (portData.tooltip) {\r\n    port.tooltip = portData.tooltip;\r\n  }\r\n  if (portData.tab) {\r\n    port.tab = portData.tab;\r\n  }\r\n  if (portData.popout) {\r\n    port.popout = portData.popout;\r\n  }\r\n  if (portData.allowVisualStates) {\r\n    port.allowVisualStates = portData.allowVisualStates;\r\n  }\r\n  return port;\r\n}\r\n\r\nexport function generateNodeLibrary(nodeRegister: NodeRegister) {\r\n  const obj: Record<string, any> = {\r\n    //note: needs to include ALL types\r\n    typecasts: [\r\n      {\r\n        from: \"string\",\r\n        to: [\r\n          \"number\",\r\n          \"boolean\",\r\n          \"image\",\r\n          \"color\",\r\n          \"enum\",\r\n          \"textStyle\",\r\n          \"dimension\",\r\n          \"array\",\r\n          \"object\",\r\n        ],\r\n      },\r\n      {\r\n        from: \"boolean\",\r\n        to: [\"number\", \"string\", \"signal\"],\r\n      },\r\n      {\r\n        from: \"number\",\r\n        to: [\"boolean\", \"string\", \"dimension\"],\r\n      },\r\n      {\r\n        from: \"date\",\r\n        to: [\"string\"],\r\n      },\r\n      {\r\n        from: \"signal\",\r\n        to: [\"boolean\", \"number\"],\r\n      },\r\n      {\r\n        from: \"image\",\r\n        to: [],\r\n      },\r\n      {\r\n        from: \"cloudfile\",\r\n        to: [\"string\", \"image\"],\r\n      },\r\n      {\r\n        from: \"color\",\r\n        to: [],\r\n      },\r\n      {\r\n        from: \"enum\",\r\n        to: [],\r\n      },\r\n      {\r\n        from: \"object\",\r\n        to: [],\r\n      },\r\n      {\r\n        from: \"domelement\",\r\n        to: [],\r\n      },\r\n      {\r\n        from: \"reference\",\r\n        to: [],\r\n      },\r\n      {\r\n        from: \"font\",\r\n        to: [],\r\n      },\r\n      {\r\n        from: \"textStyle\",\r\n        to: [\"string\"],\r\n      },\r\n      {\r\n        // Collection is deprecated but supported via typecasts\r\n        from: \"collection\",\r\n        to: [\"array\"],\r\n      },\r\n      {\r\n        from: \"array\",\r\n        to: [\"collection\"],\r\n      },\r\n    ],\r\n    dynamicports: [\r\n      {\r\n        type: \"conditionalports\",\r\n        name: \"basic\",\r\n      },\r\n      {\r\n        type: \"expand\",\r\n        name: \"basic\",\r\n      },\r\n    ],\r\n    colors: {\r\n      nodes: {\r\n        component: {\r\n          base: \"#643D8B\",\r\n          baseHighlighted: \"#79559b\",\r\n          header: \"#4E2877\",\r\n          headerHighlighted: \"#643d8b\",\r\n          outline: \"#4E2877\",\r\n          outlineHighlighted: \"#b58900\",\r\n          text: \"#dbd0e4\",\r\n        },\r\n        visual: {\r\n          base: \"#315272\",\r\n          baseHighlighted: \"#4d6784\",\r\n          header: \"#173E5D\",\r\n          headerHighlighted: \"#315272\",\r\n          outline: \"#173E5D\",\r\n          outlineHighlighted: \"#b58900\",\r\n          text: \"#cfd5de\",\r\n        },\r\n        data: {\r\n          base: \"#465524\",\r\n          baseHighlighted: \"#5b6a37\",\r\n          header: \"#314110\",\r\n          headerHighlighted: \"#465524\",\r\n          outline: \"#314110\",\r\n          outlineHighlighted: \"#b58900\",\r\n          text: \"#d2d6c5\",\r\n        },\r\n        javascript: {\r\n          base: \"#7E3660\",\r\n          baseHighlighted: \"#944e74\",\r\n          header: \"#67214B\",\r\n          headerHighlighted: \"#7e3660\",\r\n          outline: \"#67214B\",\r\n          outlineHighlighted: \"#d57bab\",\r\n          text: \"#e4cfd9\",\r\n        },\r\n        default: {\r\n          base: \"#4C4F59\",\r\n          baseHighlighted: \"#62656e\",\r\n          header: \"#373B45\",\r\n          headerHighlighted: \"#4c4f59\",\r\n          outline: \"#373B45\",\r\n          outlineHighlighted: \"#b58900\",\r\n          text: \"#d3d4d6\",\r\n        },\r\n      },\r\n      connections: {\r\n        signal: {\r\n          normal: \"#006f82\",\r\n          highlighted: \"#7ec2cf\",\r\n          pulsing: \"#ffffff\",\r\n        },\r\n        default: {\r\n          normal: \"#875d00\",\r\n          highlighted: \"#e5ae32\",\r\n          pulsing: \"#ffffff\",\r\n        },\r\n      },\r\n    },\r\n    nodetypes: [\r\n      {\r\n        name: \"Component Children\",\r\n        shortDesc:\r\n          \"This node is a placeholder for where children of this component will be inserted.\",\r\n        docs: \"https://docs.noodl.net/nodes/component-utilities/component-children\",\r\n        color: \"component\",\r\n        allowAsChild: true,\r\n        category: \"Visual\",\r\n        haveComponentChildren: [\"Visual\"],\r\n      },\r\n    ],\r\n  };\r\n\r\n  const nodeTypes = Object.keys((nodeRegister as any)._constructors);\r\n\r\n  nodeTypes.forEach(function (type) {\r\n    const nodeMetadata: NodeDefinition = (nodeRegister as any)._constructors[\r\n      type\r\n    ].metadata;\r\n\r\n    const nodeObj: Partial<NodeDefinition> = {\r\n      name: type,\r\n      searchTags: nodeMetadata.searchTags,\r\n    };\r\n    obj.nodetypes.push(nodeObj);\r\n\r\n    if (nodeMetadata.version) {\r\n      nodeObj.version = nodeMetadata.version;\r\n    }\r\n    if (nodeMetadata.displayNodeName) {\r\n      nodeObj.displayNodeName = nodeMetadata.displayNodeName;\r\n    }\r\n    if (nodeMetadata.nodeDoubleClickAction) {\r\n      nodeObj.nodeDoubleClickAction = nodeMetadata.nodeDoubleClickAction;\r\n    }\r\n    if (nodeMetadata.shortDesc) {\r\n      nodeObj.shortDesc = nodeMetadata.shortDesc;\r\n    }\r\n    if (nodeMetadata.module) {\r\n      nodeObj.module = nodeMetadata.module;\r\n    }\r\n    if (nodeMetadata.deprecated) {\r\n      nodeObj.deprecated = true;\r\n    }\r\n    if (nodeMetadata.haveComponentPorts) {\r\n      nodeObj.haveComponentPorts = true;\r\n    }\r\n    if (nodeMetadata.category === \"Visual\") {\r\n      nodeObj.allowAsChild = true;\r\n      nodeObj.allowAsExportRoot = true;\r\n      nodeObj.color = \"visual\";\r\n    }\r\n\r\n    if (nodeMetadata.allowAsExportRoot !== undefined) {\r\n      nodeObj.allowAsExportRoot = nodeMetadata.allowAsExportRoot;\r\n    }\r\n\r\n    if (nodeMetadata.allowChildren) {\r\n      nodeObj.allowChildrenWithCategory = [\"Visual\"];\r\n      nodeObj.color = \"visual\";\r\n    }\r\n    if (nodeMetadata.allowChildrenWithCategory) {\r\n      nodeObj.allowChildrenWithCategory =\r\n        nodeMetadata.allowChildrenWithCategory;\r\n    }\r\n    if (nodeMetadata.singleton) {\r\n      nodeObj.singleton = true;\r\n    }\r\n    if (nodeMetadata.allowAsChild) {\r\n      nodeObj.allowAsChild = true;\r\n    }\r\n    if (nodeMetadata.docs) {\r\n      nodeObj.docs = nodeMetadata.docs;\r\n    }\r\n    if (nodeMetadata.shortDocs) {\r\n      nodeObj.shortDocs = nodeMetadata.shortDocs;\r\n    } else if (\r\n      nodeMetadata.docs &&\r\n      nodeMetadata.docs.indexOf(\"https://docs.noodl.net\") === 0\r\n    ) {\r\n      nodeObj.shortDocs = nodeMetadata.docs.replace(\"/#\", \"\") + \"-short.md\";\r\n    }\r\n    nodeObj.category = nodeMetadata.category;\r\n\r\n    if (nodeMetadata.panels) {\r\n      nodeObj.panels = nodeMetadata.panels;\r\n    }\r\n    if (nodeMetadata.usePortAsLabel) {\r\n      nodeObj.usePortAsLabel = nodeMetadata.usePortAsLabel;\r\n      nodeObj.portLabelTruncationMode = nodeMetadata.portLabelTruncationMode;\r\n    }\r\n    if (nodeMetadata.color) {\r\n      nodeObj.color = nodeMetadata.color;\r\n    }\r\n    if (nodeMetadata.dynamicports) {\r\n      nodeObj.dynamicports = formatDynamicPorts(nodeMetadata);\r\n    }\r\n    if (nodeMetadata.exportDynamicPorts) {\r\n      nodeObj.exportDynamicPorts = nodeMetadata.exportDynamicPorts;\r\n    }\r\n    if (nodeMetadata.visualStates) {\r\n      nodeObj.visualStates = nodeMetadata.visualStates;\r\n    }\r\n    if (nodeMetadata.useVariants) {\r\n      nodeObj.useVariants = nodeMetadata.useVariants;\r\n    }\r\n    if (nodeMetadata.connectionPanel) {\r\n      nodeObj.connectionPanel = nodeMetadata.connectionPanel;\r\n    }\r\n    nodeObj.ports = [];\r\n\r\n    const dynamicports = nodeObj.dynamicports || [];\r\n    const selectorNames: Record<string, boolean> = {};\r\n    const conditionalPortNames: Record<string, boolean> = {};\r\n\r\n    //same for channel ports\r\n    dynamicports\r\n      .filter((d) => d.channelPort !== undefined)\r\n      .forEach((port) => {\r\n        conditionalPortNames[\r\n          port.channelPort.plug + \"/\" + port.channelPort.name\r\n        ] = true;\r\n      });\r\n\r\n    if (dynamicports.length) {\r\n      nodeObj.dynamicports = dynamicports;\r\n    }\r\n\r\n    Object.keys(nodeMetadata.inputs || {}).forEach(function (inputName) {\r\n      if (\r\n        selectorNames.hasOwnProperty(\"input/\" + inputName) ||\r\n        conditionalPortNames.hasOwnProperty(\"input/\" + inputName)\r\n      ) {\r\n        //this is a selector or dynamic port. It's already been registered\r\n        return;\r\n      }\r\n\r\n      const port = nodeMetadata.inputs?.[inputName];\r\n      if (!port || port.exportToEditor === false) {\r\n        return;\r\n      }\r\n\r\n      if (!nodeObj.ports) {\r\n        nodeObj.ports = [];\r\n      }\r\n      nodeObj.ports.push(formatPort(inputName, port, \"input\"));\r\n    });\r\n\r\n    function exportOutput(name: string, output: OutputDefinition<{}>) {\r\n      const port: Port = {\r\n        name: name,\r\n        type: output.type,\r\n        plug: \"output\",\r\n      };\r\n      if (output.group) {\r\n        port.group = output.group;\r\n      }\r\n      if (output.displayName) {\r\n        port.displayName = output.displayName;\r\n      }\r\n      if (output.editorName) {\r\n        port.editorName = output.editorName;\r\n      }\r\n      if (output.hasOwnProperty(\"index\")) {\r\n        port.index = output.index;\r\n      }\r\n      if (!nodeObj.ports) {\r\n        nodeObj.ports = [];\r\n      }\r\n      nodeObj.ports.push(port);\r\n    }\r\n\r\n    Object.keys(nodeMetadata.outputs || {}).forEach(function (prop) {\r\n      if (\r\n        selectorNames.hasOwnProperty(\"output/\" + prop) ||\r\n        conditionalPortNames.hasOwnProperty(\"output/\" + prop)\r\n      ) {\r\n        //this is a selector or dynamic port. It's already been registered\r\n        return;\r\n      }\r\n\r\n      const output = nodeMetadata.outputs?.[prop];\r\n      if (output) {\r\n        exportOutput(prop, output);\r\n      }\r\n    });\r\n  });\r\n\r\n  const coreNodes = [\r\n    {\r\n      name: \"UI Elements\",\r\n      description: \"Buttons, inputs, containers, media\",\r\n      type: \"visual\",\r\n      subCategories: [\r\n        {\r\n          name: \"Basic Elements\",\r\n          items: [\r\n            \"Group\",\r\n            \"net.noodl.visual.columns\",\r\n            \"Text\",\r\n            \"Image\",\r\n            \"Video\",\r\n            \"Circle\",\r\n            \"net.noodl.visual.icon\",\r\n          ],\r\n        },\r\n        {\r\n          name: \"UI Controls\",\r\n          items: [\r\n            \"net.noodl.controls.button\",\r\n            \"net.noodl.controls.checkbox\",\r\n            \"net.noodl.controls.options\",\r\n            \"net.noodl.controls.radiobutton\",\r\n            \"Radio Button Group\",\r\n            \"net.noodl.controls.range\",\r\n            \"net.noodl.controls.textinput\",\r\n          ],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Navigation & Popups\",\r\n      description: \"Page routing, navigation, popups\",\r\n      type: \"logic\",\r\n      subCategories: [\r\n        {\r\n          name: \"Navigation\",\r\n          items: [\r\n            \"Router\",\r\n            \"RouterNavigate\",\r\n            \"PageInputs\",\r\n            \"net.noodl.externallink\",\r\n            \"PageStackNavigateToPath\",\r\n          ],\r\n        },\r\n        {\r\n          name: \"Component Stack\",\r\n          items: [\"Page Stack\", \"PageStackNavigate\", \"PageStackNavigateBack\"],\r\n        },\r\n        {\r\n          name: \"Popups\",\r\n          items: [\"NavigationShowPopup\", \"NavigationClosePopup\"],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Logic & Utilities\",\r\n      description: \"Logic, events, string manipulation\",\r\n      type: \"logic\",\r\n      subCategories: [\r\n        {\r\n          name: \"General Utils\",\r\n          items: [\r\n            \"States\",\r\n            \"Value Changed\",\r\n            \"Timer\",\r\n            \"Color Blend\",\r\n            \"Number Remapper\",\r\n            \"Counter\",\r\n            \"Drag\",\r\n            \"net.noodl.animatetovalue\",\r\n          ],\r\n        },\r\n        {\r\n          name: \"Logic\",\r\n          items: [\r\n            \"Boolean To String\",\r\n            \"Switch\",\r\n            \"And\",\r\n            \"Or\",\r\n            \"Condition\",\r\n            \"Inverter\",\r\n          ],\r\n        },\r\n        {\r\n          name: \"Events\",\r\n          items: [\"Event Sender\", \"Event Receiver\"],\r\n        },\r\n        {\r\n          name: \"String Manipulation\",\r\n          items: [\r\n            \"Substring\",\r\n            \"String Mapper\",\r\n            \"String Format\",\r\n            \"Date To String\",\r\n            \"Unique Id\",\r\n          ],\r\n        },\r\n        {\r\n          name: \"System\",\r\n          items: [\"Screen Resolution\", \"Open File Picker\"],\r\n        },\r\n        {\r\n          name: \"Variables\",\r\n          items: [\"String\", \"Boolean\", \"Color\", \"Number\"],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Component Utilities\",\r\n      description: \"Component inputs, outputs & object\",\r\n      type: \"component\",\r\n      subCategories: [\r\n        {\r\n          name: \"\",\r\n          items: [\r\n            \"Component Inputs\",\r\n            \"Component Outputs\",\r\n            \"Component Children\",\r\n            \"net.noodl.ComponentObject\",\r\n            \"net.noodl.ParentComponentObject\",\r\n            \"net.noodl.SetComponentObjectProperties\",\r\n            \"net.noodl.SetParentComponentObjectProperties\",\r\n          ],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Read & Write Data\",\r\n      description: \"Arrays, objects, cloud data\",\r\n      type: \"data\",\r\n      subCategories: [\r\n        {\r\n          name: \"\",\r\n          items: [\r\n            \"RunTasks\",\r\n            \"For Each\",\r\n            \"For Each Actions\",\r\n            \"Model2\",\r\n            \"SetModelProperties\",\r\n            \"NewModel\",\r\n            \"Set Variable\",\r\n            \"Variable2\",\r\n          ],\r\n        },\r\n        {\r\n          name: \"Array\",\r\n          items: [\r\n            \"Collection2\",\r\n            \"CollectionNew\",\r\n            \"CollectionRemove\",\r\n            \"CollectionClear\",\r\n            \"CollectionInsert\",\r\n            \"Filter Collection\",\r\n            \"Map Collection\",\r\n            \"Static Data\",\r\n          ],\r\n        },\r\n        {\r\n          name: \"Cloud Data\",\r\n          items: [\r\n            \"DbModel2\",\r\n            \"NewDbModelProperties\",\r\n            \"FilterDBModels\",\r\n            \"SetDbModelProperties\",\r\n            \"DbCollection2\",\r\n            \"DeleteDbModelProperties\",\r\n            \"AddDbModelRelation\",\r\n            \"RemoveDbModelRelation\",\r\n            \"Cloud File\",\r\n            \"Upload File\",\r\n            \"CloudFunction2\",\r\n            \"DbConfig\",\r\n          ],\r\n        },\r\n        {\r\n          name: \"User\",\r\n          items: [\r\n            \"net.noodl.user.LogIn\",\r\n            \"net.noodl.user.LogOut\",\r\n            \"net.noodl.user.SignUp\",\r\n            \"net.noodl.user.User\",\r\n            \"net.noodl.user.SetUserProperties\",\r\n            \"net.noodl.user.VerifyEmail\",\r\n            \"net.noodl.user.SendEmailVerification\",\r\n            \"net.noodl.user.ResetPassword\",\r\n            \"net.noodl.user.RequestPasswordReset\",\r\n          ],\r\n        },\r\n        {\r\n          name: \"External Data\",\r\n          items: [\"REST2\"],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Custom Code\",\r\n      description: \"Custom JavaScript and CSS\",\r\n      type: \"javascript\",\r\n      subCategories: [\r\n        {\r\n          name: \"\",\r\n          items: [\r\n            \"Expression\",\r\n            \"JavaScriptFunction\",\r\n            \"Javascript2\",\r\n            \"CSS Definition\",\r\n          ],\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      name: \"Cloud Functions\",\r\n      description: \"Nodes to be used in cloud functions\",\r\n      type: \"data\",\r\n      subCategories: [\r\n        {\r\n          name: \"\",\r\n          items: [\"noodl.cloud.request\", \"noodl.cloud.response\"],\r\n        },\r\n        {\r\n          name: \"Cloud Data\",\r\n          items: [\"noodl.cloud.aggregate\"],\r\n        },\r\n      ],\r\n    },\r\n  ];\r\n\r\n  obj.nodeIndex = {\r\n    coreNodes,\r\n  };\r\n\r\n  const moduleNodes: string[] = [];\r\n\r\n  nodeTypes.forEach((type) => {\r\n    const nodeMetadata = (nodeRegister as any)._constructors[type].metadata;\r\n    if (nodeMetadata.module) {\r\n      moduleNodes.push(type);\r\n    }\r\n  });\r\n\r\n  if (moduleNodes.length) {\r\n    obj.nodeIndex.moduleNodes = [\r\n      {\r\n        name: \"\",\r\n        items: moduleNodes,\r\n      },\r\n    ];\r\n  }\r\n\r\n  return obj;\r\n}\r\n","import { EventSender } from \"../eventsender\";\r\nimport { Variant } from \"../variants\";\r\nimport type { ComponentModel, Port } from \"./componentmodel\";\r\n\r\n// TODO: What is this? Node?\r\nexport interface NodeData {\r\n  id: string;\r\n  type: string;\r\n  parameters?: Record<string, any>;\r\n  stateParameters?: Record<string, Record<string, any>>;\r\n  stateTransitions?: Record<string, Record<string, any>>;\r\n  defaultStateTransitions?: Record<string, any>;\r\n  ports?: Port[];\r\n  variant?: string;\r\n  name?: string;\r\n  children?: NodeData[];\r\n  metadata?: Record<string, any>;\r\n}\r\n\r\nexport class NodeModel extends EventSender {\r\n  id: string;\r\n  type: string;\r\n  inputs: any[];\r\n  outputs: any[];\r\n  children: NodeModel[];\r\n  parameters: Record<string, any>;\r\n  stateParameters?: Record<string, Record<string, any>>;\r\n  stateTransitions?: Record<string, Record<string, any>>;\r\n  defaultStateTransitions?: Record<string, any>;\r\n  inputPorts: Record<string, Port>;\r\n  outputPorts: Record<string, Port>;\r\n  parent?: NodeModel;\r\n  variant?: Variant | string;\r\n  component?: ComponentModel;\r\n\r\n  // removeListenersWithRef: (ref: any) => void;\r\n\r\n  constructor(id: string, type: string) {\r\n    super();\r\n\r\n    this.id = id;\r\n    this.type = type;\r\n\r\n    this.inputs = [];\r\n    this.outputs = [];\r\n    this.children = [];\r\n    this.parameters = {};\r\n    this.inputPorts = {};\r\n    this.outputPorts = {};\r\n  }\r\n\r\n  setParameter(name: string, value: any, state?: string): void {\r\n    if (state) {\r\n      if (!this.stateParameters) this.stateParameters = {};\r\n      if (!this.stateParameters[state]) this.stateParameters[state] = {};\r\n\r\n      if (value === undefined) {\r\n        delete this.stateParameters[state][name];\r\n      } else {\r\n        this.stateParameters[state][name] = value;\r\n      }\r\n    } else {\r\n      if (value === undefined) {\r\n        delete this.parameters[name];\r\n      } else {\r\n        this.parameters[name] = value;\r\n      }\r\n    }\r\n\r\n    this.emit(\"parameterUpdated\", { name, value, state });\r\n  }\r\n\r\n  setParameters(parameters: Record<string, any>): void {\r\n    Object.keys(parameters).forEach((name) => {\r\n      this.setParameter(name, parameters[name]);\r\n    });\r\n  }\r\n\r\n  setStateParameters(parameters: Record<string, Record<string, any>>): void {\r\n    this.stateParameters = parameters;\r\n  }\r\n\r\n  setStateTransitions(\r\n    stateTransitions: Record<string, Record<string, any>>\r\n  ): void {\r\n    this.stateTransitions = stateTransitions;\r\n  }\r\n\r\n  setStateTransitionParamter(\r\n    parameter: string,\r\n    curve: any,\r\n    state: string\r\n  ): void {\r\n    if (!this.stateTransitions) {\r\n      this.stateTransitions = {};\r\n    }\r\n\r\n    if (curve) {\r\n      this.stateTransitions[state][parameter] = curve;\r\n    } else {\r\n      delete this.stateTransitions[state][parameter];\r\n    }\r\n  }\r\n\r\n  setDefaultStateTransition(stateTransition: any, state: string): void {\r\n    if (!this.defaultStateTransitions) {\r\n      this.defaultStateTransitions = {};\r\n    }\r\n    this.defaultStateTransitions[state] = stateTransition;\r\n  }\r\n\r\n  addInputPort(port: Port): void {\r\n    this.inputPorts[port.name] = port;\r\n    this.emit(\"inputPortAdded\", port);\r\n  }\r\n\r\n  getInputPort(portName: string): Port | undefined {\r\n    return this.inputPorts[portName];\r\n  }\r\n\r\n  getInputPorts(): Record<string, Port> {\r\n    return this.inputPorts;\r\n  }\r\n\r\n  removeInputPortWithName(portName: string): void {\r\n    if (this.inputPorts.hasOwnProperty(portName)) {\r\n      const port = this.inputPorts[portName];\r\n      delete this.inputPorts[portName];\r\n      this.emit(\"inputPortRemoved\", port);\r\n    }\r\n  }\r\n\r\n  updateInputPortTypes(ports: Record<string, Port>): void {\r\n    let changed = false;\r\n    for (const key in ports) {\r\n      if (this.inputPorts[key] !== undefined) {\r\n        this.inputPorts[key].type = ports[key].type;\r\n        changed = true;\r\n      }\r\n    }\r\n    changed && this.emit(\"inputPortTypesUpdated\");\r\n  }\r\n\r\n  addOutputPort(port: Port): void {\r\n    this.outputPorts[port.name] = port;\r\n    this.emit(\"outputPortAdded\", port);\r\n  }\r\n\r\n  getOutputPort(portName: string): Port | undefined {\r\n    return this.outputPorts[portName];\r\n  }\r\n\r\n  getOutputPorts(): Record<string, Port> {\r\n    return this.outputPorts;\r\n  }\r\n\r\n  removeOutputPortWithName(portName: string): void {\r\n    if (this.outputPorts.hasOwnProperty(portName)) {\r\n      const port = this.outputPorts[portName];\r\n      delete this.outputPorts[portName];\r\n      this.emit(\"outputPortRemoved\", port);\r\n    }\r\n  }\r\n\r\n  updateOutputPortTypes(ports: Record<string, Port>): void {\r\n    let changed = false;\r\n    for (const key in ports) {\r\n      if (this.outputPorts[key] !== undefined) {\r\n        this.outputPorts[key].type = ports[key].type;\r\n        changed = true;\r\n      }\r\n    }\r\n    changed && this.emit(\"outputPortTypesUpdated\");\r\n  }\r\n\r\n  addChild(child: NodeModel, index?: number): void {\r\n    child.parent = this;\r\n    if (index === undefined) {\r\n      this.children.push(child);\r\n    } else {\r\n      this.children.splice(index, 0, child);\r\n    }\r\n    this.emit(\"childAdded\", child);\r\n  }\r\n\r\n  removeChild(child: NodeModel): void {\r\n    child.parent = undefined;\r\n    const index = this.children.indexOf(child);\r\n    this.children.splice(index, 1);\r\n    this.emit(\"childRemoved\", child);\r\n  }\r\n\r\n  reset(): void {\r\n    this.removeAllListeners();\r\n  }\r\n\r\n  setVariant(variant: Variant | string): void {\r\n    this.variant = variant;\r\n    this.emit(\"variantUpdated\", variant);\r\n  }\r\n\r\n  static createFromExportData(nodeData: NodeData): NodeModel {\r\n    const node = new NodeModel(nodeData.id, nodeData.type);\r\n    nodeData.parameters && node.setParameters(nodeData.parameters);\r\n    nodeData.stateParameters &&\r\n      node.setStateParameters(nodeData.stateParameters);\r\n    nodeData.stateTransitions &&\r\n      node.setStateTransitions(nodeData.stateTransitions);\r\n\r\n    if (nodeData.defaultStateTransitions) {\r\n      for (const state in nodeData.defaultStateTransitions) {\r\n        node.setDefaultStateTransition(\r\n          nodeData.defaultStateTransitions[state],\r\n          state\r\n        );\r\n      }\r\n    }\r\n\r\n    nodeData.ports &&\r\n      nodeData.ports.forEach((port) => {\r\n        //some ports are incorrectly named outputs instead of output, patch it here so\r\n        //the rest of the code doesn't need to care\r\n        // TODO: WTF...\r\n        // if (port.plug === \"outputs\") {\r\n        //   port.plug = \"output\";\r\n        // }\r\n\r\n        if (port.plug === \"input\" || port.plug === \"input/output\") {\r\n          node.addInputPort(port);\r\n        }\r\n        if (port.plug === \"output\" || port.plug === \"input/output\") {\r\n          node.addOutputPort(port);\r\n        }\r\n      });\r\n\r\n    nodeData.variant && node.setVariant(nodeData.variant);\r\n\r\n    return node;\r\n  }\r\n}\r\n","import type { Connection } from \"../nodescope\";\r\nimport { NodeData, NodeModel } from \"./nodemodel\";\r\nimport { EventSender } from \"../eventsender\";\r\n\r\nexport type PortType =\r\n  | string\r\n  | {\r\n      name: string;\r\n      enums?: Array<{ value: string; label: string }>;\r\n      allowEditOnly?: boolean;\r\n      codeeditor?: string;\r\n      allowConnectionsOnly?: boolean;\r\n      schema?: any;\r\n    };\r\n\r\nexport interface Port {\r\n  name: string;\r\n  plug: \"input\" | \"output\" | \"input/output\";\r\n  type?: PortType;\r\n  group?: string;\r\n  index?: number;\r\n  displayName?: string;\r\n  editorName?: string;\r\n  description?: string;\r\n  tooltip?: string;\r\n  tab?: string;\r\n  popout?: boolean;\r\n  allowVisualStates?: boolean;\r\n  default?: unknown;\r\n  parent?: string;\r\n  parentItemId?: string;\r\n  set?: (value: any) => void;\r\n  getter?: () => any;\r\n}\r\n\r\ninterface ComponentData {\r\n  name: string;\r\n  metadata?: Record<string, any>;\r\n  ports?: Port[];\r\n  nodes?: NodeData[];\r\n  connections?: Connection[];\r\n  roots?: string[];\r\n}\r\n\r\nexport class ComponentModel extends EventSender {\r\n  name: string;\r\n  nodes: Record<string, NodeModel>;\r\n  connections: Connection[];\r\n  roots: string[];\r\n  inputPorts: Record<string, Port>;\r\n  outputPorts: Record<string, Port>;\r\n  metadata: Record<string, any>;\r\n\r\n  constructor(name: string) {\r\n    super();\r\n\r\n    this.name = name;\r\n    this.nodes = {};\r\n    this.connections = [];\r\n    this.roots = [];\r\n    this.inputPorts = {};\r\n    this.outputPorts = {};\r\n    this.metadata = {};\r\n  }\r\n\r\n  async addNode(node: NodeModel): Promise<void> {\r\n    node.component = this;\r\n    this.nodes[node.id] = node;\r\n    await this.emit(\"nodeAdded\", node);\r\n  }\r\n\r\n  hasNodeWithId(id: string): boolean {\r\n    return this.getNodeWithId(id) !== undefined;\r\n  }\r\n\r\n  getNodeWithId(id: string | undefined): NodeModel | undefined {\r\n    if (!id) {\r\n      return undefined;\r\n    }\r\n    return this.nodes[id];\r\n  }\r\n\r\n  getAllNodes(): NodeModel[] {\r\n    return Object.values(this.nodes);\r\n  }\r\n\r\n  getNodesWithType(type: string): NodeModel[] {\r\n    const nodes: NodeModel[] = [];\r\n    Object.keys(this.nodes).forEach((id) => {\r\n      const node = this.nodes[id];\r\n      if (node.type === type) {\r\n        nodes.push(node);\r\n      }\r\n    });\r\n\r\n    return nodes;\r\n  }\r\n\r\n  addConnection(connection: Connection): void {\r\n    this.connections.push(connection);\r\n    this.emit(\"connectionAdded\", connection);\r\n\r\n    //emit an event on the target node model\r\n    //used by numbered inputs\r\n    if (connection.targetId) {\r\n      const node = this.getNodeWithId(connection.targetId);\r\n      if (node) {\r\n        node.emit(\"inputConnectionAdded\", connection);\r\n      }\r\n    }\r\n  }\r\n\r\n  removeConnection(connection: Connection): void {\r\n    const index = this.connections.findIndex((con) => {\r\n      return (\r\n        con.sourceId === connection.sourceId &&\r\n        con.sourcePort === connection.sourcePort &&\r\n        con.targetId === connection.targetId &&\r\n        con.targetPort === connection.targetPort\r\n      );\r\n    });\r\n\r\n    if (index === -1) {\r\n      // TODO: Setup a better logging system\r\n      // console.log(\"Connection doesn't exist\", connection);\r\n      return;\r\n    }\r\n\r\n    this.connections.splice(index, 1);\r\n    this.emit(\"connectionRemoved\", connection);\r\n\r\n    //emit an event on the target node model\r\n    //used by numbered inputs\r\n    if (connection.targetId) {\r\n      const node = this.getNodeWithId(connection.targetId);\r\n      if (node) {\r\n        node.emit(\"inputConnectionRemoved\", connection);\r\n      }\r\n    }\r\n  }\r\n\r\n  getConnectionsFromPort(nodeId: string, sourcePortName: string): Connection[] {\r\n    return this.connections.filter((connection) => {\r\n      return (\r\n        connection.sourceId === nodeId &&\r\n        connection.sourcePort === sourcePortName\r\n      );\r\n    });\r\n  }\r\n\r\n  getConnectionsToPort(nodeId: string, targetPortName: string): Connection[] {\r\n    return this.connections.filter((connection) => {\r\n      return (\r\n        connection.targetId === nodeId &&\r\n        connection.targetPort === targetPortName\r\n      );\r\n    });\r\n  }\r\n\r\n  getConnectionsFrom(nodeId: string): Connection[] {\r\n    return this.connections.filter((connection) => {\r\n      return connection.sourceId === nodeId;\r\n    });\r\n  }\r\n\r\n  getConnectionsTo(nodeId: string): Connection[] {\r\n    return this.connections.filter((connection) => {\r\n      return connection.targetId === nodeId;\r\n    });\r\n  }\r\n\r\n  addRootId(rootId: string | undefined): void {\r\n    if (!rootId) {\r\n      return;\r\n    }\r\n\r\n    if (this.roots.indexOf(rootId) !== -1) {\r\n      return;\r\n    }\r\n    this.roots.push(rootId);\r\n    this.emit(\"rootAdded\", rootId);\r\n  }\r\n\r\n  removeRootId(rootId: string): void {\r\n    const index = this.roots.indexOf(rootId);\r\n    if (index !== -1) {\r\n      this.roots.splice(index, 1);\r\n      this.emit(\"rootRemoved\", rootId);\r\n    }\r\n  }\r\n\r\n  getRoots(): string[] {\r\n    return this.roots;\r\n  }\r\n\r\n  async removeNodeWithId(id: string): Promise<boolean> {\r\n    const node = this.getNodeWithId(id);\r\n\r\n    if (!node) {\r\n      console.warn(\"ERROR: Attempted to remove non-existing node with ID:\", id);\r\n      return false;\r\n    }\r\n\r\n    //remove children first\r\n    while (node.children.length > 0) {\r\n      const child = node.children[0];\r\n      const childRemoved = await this.removeNodeWithId(child.id);\r\n      if (!childRemoved) {\r\n        // Workaround for corrupt node trees, should never happen, a remove should always be successful\r\n        node.children.shift();\r\n      }\r\n    }\r\n\r\n    const connections = this.getConnectionsTo(id).concat(\r\n      this.getConnectionsFrom(id)\r\n    );\r\n\r\n    for (let i = 0; i < connections.length; i++) {\r\n      this.removeConnection(connections[i]);\r\n    }\r\n\r\n    this.setNodeParent(node, undefined);\r\n\r\n    if (this.roots.indexOf(node.id) !== -1) {\r\n      this.removeRootId(node.id);\r\n    }\r\n\r\n    await this.emit(\"nodeRemoved\", node);\r\n\r\n    node.removeAllListeners();\r\n    delete this.nodes[id];\r\n\r\n    await this.emit(\"nodeWasRemoved\", node);\r\n    return true;\r\n  }\r\n\r\n  getAllConnections(): Connection[] {\r\n    return this.connections;\r\n  }\r\n\r\n  getInputPorts(): Record<string, Port> {\r\n    return this.inputPorts;\r\n  }\r\n\r\n  getOutputPorts(): Record<string, Port> {\r\n    return this.outputPorts;\r\n  }\r\n\r\n  addInputPort(port: Port): void {\r\n    this.inputPorts[port.name] = port;\r\n    this.emit(\"inputPortAdded\", port);\r\n  }\r\n\r\n  addOutputPort(port: Port): void {\r\n    this.outputPorts[port.name] = port;\r\n    this.emit(\"outputPortAdded\", port);\r\n  }\r\n\r\n  removeOutputPortWithName(portName: string): void {\r\n    if (this.outputPorts.hasOwnProperty(portName)) {\r\n      const port = this.outputPorts[portName];\r\n      delete this.outputPorts[portName];\r\n      this.emit(\"outputPortRemoved\", port);\r\n    }\r\n  }\r\n\r\n  removeInputPortWithName(portName: string): void {\r\n    if (this.inputPorts.hasOwnProperty(portName)) {\r\n      const port = this.inputPorts[portName];\r\n      delete this.inputPorts[portName];\r\n      this.emit(\"inputPortRemoved\", port);\r\n    }\r\n  }\r\n\r\n  updateInputPortTypes(ports: Record<string, Port>): void {\r\n    let changed = false;\r\n    for (const key in ports) {\r\n      if (this.inputPorts[key] !== undefined) {\r\n        this.inputPorts[key].type = ports[key].type;\r\n        changed = true;\r\n      }\r\n    }\r\n    changed && this.emit(\"inputPortTypesUpdated\");\r\n  }\r\n\r\n  updateOutputPortTypes(ports: Record<string, Port>): void {\r\n    let changed = false;\r\n    for (const key in ports) {\r\n      if (this.outputPorts[key] !== undefined) {\r\n        this.outputPorts[key].type = ports[key].type;\r\n        changed = true;\r\n      }\r\n    }\r\n    changed && this.emit(\"outputPortTypesUpdated\");\r\n  }\r\n\r\n  renameInputPortOnNodeWithId(\r\n    id: string,\r\n    oldName: string,\r\n    newName: string\r\n  ): void {\r\n    //remove connections\r\n    const connections = this.getConnectionsToPort(id, oldName);\r\n    connections.forEach(this.removeConnection.bind(this));\r\n\r\n    //get port before deleting it\r\n    const nodeModel = this.getNodeWithId(id);\r\n    if (!nodeModel) return;\r\n\r\n    // @ts-expect-error TODO: What is this?\r\n    const port: Port = { ...nodeModel.getInputPort(oldName) };\r\n\r\n    //remove old port\r\n    if (port) {\r\n      nodeModel.removeInputPortWithName(oldName);\r\n\r\n      //rename and add new port\r\n      port.name = newName;\r\n      nodeModel.addInputPort(port);\r\n    }\r\n\r\n    //add new connection\r\n    connections.forEach((connection) => {\r\n      connection.targetPort = newName;\r\n    });\r\n\r\n    connections.forEach(this.addConnection.bind(this));\r\n  }\r\n\r\n  renameOutputPortOnNodeWithId(\r\n    id: string,\r\n    oldName: string,\r\n    newName: string\r\n  ): void {\r\n    //remove connections\r\n    const connections = this.getConnectionsFromPort(id, oldName);\r\n    connections.forEach(this.removeConnection.bind(this));\r\n\r\n    //get port before deleting it\r\n    const nodeModel = this.getNodeWithId(id);\r\n    if (!nodeModel) return;\r\n\r\n    // @ts-expect-error TODO: What is this?\r\n    const port: Port = { ...nodeModel.getOutputPort(oldName) };\r\n\r\n    //remove old port\r\n    nodeModel.removeOutputPortWithName(oldName);\r\n\r\n    //rename and add new port\r\n    port.name = newName;\r\n    nodeModel.addOutputPort(port);\r\n\r\n    //add new connection\r\n    connections.forEach((connection) => {\r\n      connection.sourcePort = newName;\r\n    });\r\n\r\n    connections.forEach(this.addConnection.bind(this));\r\n  }\r\n\r\n  setNodeParent(\r\n    childModel: NodeModel | undefined,\r\n    newParentModel: NodeModel | null | undefined,\r\n    index?: number\r\n  ): void {\r\n    if (!childModel) {\r\n      return;\r\n    }\r\n\r\n    if (this.roots.indexOf(childModel.id) !== -1) {\r\n      this.removeRootId(childModel.id);\r\n    }\r\n\r\n    if (childModel.parent) {\r\n      this.emit(\"nodeParentWillBeRemoved\", childModel);\r\n      childModel.parent.removeChild(childModel);\r\n    }\r\n    childModel.emit(\"parentUpdated\", newParentModel);\r\n    if (newParentModel) {\r\n      newParentModel.addChild(childModel, index);\r\n      this.emit(\"nodeParentUpdated\", childModel);\r\n    }\r\n  }\r\n\r\n  async importEditorNodeData(\r\n    nodeData: NodeData,\r\n    parentId?: string,\r\n    childIndex?: number\r\n  ): Promise<void> {\r\n    const nodeModel = NodeModel.createFromExportData(nodeData);\r\n    await this.addNode(nodeModel);\r\n\r\n    if (parentId) {\r\n      this.setNodeParent(nodeModel, this.getNodeWithId(parentId), childIndex);\r\n    }\r\n\r\n    if (nodeData.children) {\r\n      for (let i = 0; i < nodeData.children.length; i++) {\r\n        const child = nodeData.children[i];\r\n        await this.importEditorNodeData(child, nodeModel.id, i);\r\n      }\r\n    }\r\n  }\r\n\r\n  async reset(): Promise<void> {\r\n    while (this.roots.length) {\r\n      await this.removeNodeWithId(this.roots[0]);\r\n    }\r\n\r\n    for (const id of Object.keys(this.nodes)) {\r\n      //note: with an incomplete library there will be no roots\r\n      //so some of the nodes will have children, which will be recursively removed by\r\n      //removeNodeWithId(), so some IDs from the Object.keys(this.nodes) that runs this loop\r\n      //will already have been removed, so check if they exist before removing\r\n      if (this.hasNodeWithId(id)) {\r\n        await this.removeNodeWithId(id);\r\n      }\r\n    }\r\n\r\n    if (Object.keys(this.nodes).length > 0) {\r\n      throw new Error(\"Not all nodes were removed during a reset\");\r\n    }\r\n\r\n    if (this.connections.length > 0) {\r\n      throw new Error(\"Not all connections were removed during a reset\");\r\n    }\r\n  }\r\n\r\n  rename(newName: string): void {\r\n    const oldName = this.name;\r\n    this.name = newName;\r\n    this.emit(\"renamed\", { oldName, newName });\r\n  }\r\n\r\n  setMetadata(key: string, data: any): void {\r\n    this.metadata[key] = data;\r\n  }\r\n\r\n  getMetadata(key?: string): any {\r\n    if (!key) return this.metadata;\r\n    return this.metadata[key];\r\n  }\r\n\r\n  static async createFromExportData(\r\n    componentData: ComponentData\r\n  ): Promise<ComponentModel> {\r\n    const componentModel = new ComponentModel(componentData.name);\r\n\r\n    if (componentData.metadata) {\r\n      for (const key in componentData.metadata) {\r\n        componentModel.setMetadata(key, componentData.metadata[key]);\r\n      }\r\n    }\r\n\r\n    componentData.ports &&\r\n      componentData.ports.forEach((port) => {\r\n        if (port.plug === \"input\" || port.plug === \"input/output\") {\r\n          componentModel.addInputPort(port);\r\n        }\r\n        if (port.plug === \"output\" || port.plug === \"input/output\") {\r\n          componentModel.addOutputPort(port);\r\n        }\r\n      });\r\n\r\n    if (componentData.nodes) {\r\n      for (const node of componentData.nodes) {\r\n        await componentModel.importEditorNodeData(node);\r\n      }\r\n    }\r\n\r\n    componentData.connections &&\r\n      componentData.connections.forEach((connection) =>\r\n        componentModel.addConnection(connection)\r\n      );\r\n    componentData.roots &&\r\n      componentData.roots.forEach((root) => componentModel.addRootId(root));\r\n\r\n    return componentModel;\r\n  }\r\n}\r\n","\"use strict\";\r\n\r\nimport { ComponentModel } from \"./componentmodel\";\r\nimport { EventSender } from \"../eventsender\";\r\nimport { Event } from \"../editormodeleventshandler\";\r\nimport { Variant } from \"../variants\";\r\n\r\ninterface Settings {\r\n  [key: string]: any;\r\n}\r\n\r\ninterface Metadata {\r\n  [key: string]: any;\r\n}\r\n\r\ninterface ComponentIndex {\r\n  [key: string]: {\r\n    components: string[];\r\n    dependencies: string[];\r\n  };\r\n}\r\n\r\nexport interface RouterIndex {\r\n  [key: string]: any;\r\n}\r\n\r\ninterface ExportData {\r\n  componentIndex: ComponentIndex;\r\n  routerIndex: RouterIndex;\r\n  variants?: Variant[];\r\n  settings?: Settings;\r\n  metadata?: Metadata;\r\n  components: any[];\r\n  rootComponent: string;\r\n}\r\n\r\nclass GraphModel extends EventSender {\r\n  private components: { [key: string]: ComponentModel };\r\n  private settings: Settings;\r\n  private metadata: Metadata;\r\n  private componentIndex: ComponentIndex | undefined;\r\n  routerIndex: RouterIndex | undefined;\r\n  private componentToBundleMap: Map<string, string> = new Map();\r\n  private variants: Variant[] = [];\r\n  rootComponent: string | undefined;\r\n\r\n  constructor() {\r\n    super();\r\n    this.components = {};\r\n    this.settings = {};\r\n    this.metadata = {};\r\n  }\r\n\r\n  async importComponentFromEditorData(componentData: any): Promise<void> {\r\n    const componentModel = await ComponentModel.createFromExportData(\r\n      componentData\r\n    );\r\n    this.addComponent(componentModel);\r\n  }\r\n\r\n  getBundleContainingComponent(name: string): string | undefined {\r\n    return this.componentToBundleMap.get(name);\r\n  }\r\n\r\n  getBundlesContainingSheet(sheetName: string): string[] {\r\n    const bundles = new Set<string>();\r\n    for (const name of this.componentToBundleMap.keys()) {\r\n      const isOnDefaultSheet = name.indexOf(\"/#\") !== 0;\r\n\r\n      const isMatch =\r\n        (isOnDefaultSheet && sheetName === \"Default\") ||\r\n        (!isOnDefaultSheet && name.indexOf(\"/#\" + sheetName) === 0);\r\n\r\n      if (isMatch) {\r\n        bundles.add(this.componentToBundleMap.get(name)!);\r\n      }\r\n    }\r\n    return Array.from(bundles);\r\n  }\r\n\r\n  getBundleDependencies(bundleName: string): string[] {\r\n    const result = new Set<string>();\r\n\r\n    const recurse = (name: string) => {\r\n      const bundle = this.componentIndex?.[name];\r\n      if (bundle) {\r\n        for (const dep of bundle.dependencies) {\r\n          if (!result.has(dep)) {\r\n            result.add(dep);\r\n            recurse(dep);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    recurse(bundleName);\r\n\r\n    return Array.from(result);\r\n  }\r\n\r\n  async importEditorData(exportData: ExportData): Promise<void> {\r\n    this.componentIndex = exportData.componentIndex;\r\n    this.routerIndex = exportData.routerIndex;\r\n\r\n    this.componentToBundleMap = new Map();\r\n\r\n    for (const bundleName in exportData.componentIndex) {\r\n      const bundle = exportData.componentIndex[bundleName];\r\n\r\n      for (const componentName of bundle.components) {\r\n        this.componentToBundleMap.set(componentName, bundleName);\r\n      }\r\n    }\r\n\r\n    this.variants = exportData.variants || [];\r\n\r\n    exportData.settings && this.setSettings(exportData.settings);\r\n\r\n    exportData.metadata && this.setAllMetaData(exportData.metadata);\r\n\r\n    for (const component of exportData.components) {\r\n      await this.importComponentFromEditorData(component);\r\n    }\r\n\r\n    this.setRootComponentName(exportData.rootComponent);\r\n  }\r\n\r\n  setRootComponentName(componentName: string): void {\r\n    this.rootComponent = componentName;\r\n    this.emit(\"rootComponentNameUpdated\", componentName);\r\n  }\r\n\r\n  getNodesWithType(type: string): any[] {\r\n    let nodes: any[] = [];\r\n\r\n    const componentNames = Object.keys(this.components);\r\n    for (let i = 0; i < componentNames.length; i++) {\r\n      const component = this.components[componentNames[i]];\r\n      nodes = nodes.concat(component.getNodesWithType(type));\r\n    }\r\n    return nodes;\r\n  }\r\n\r\n  getComponentWithName(type: string): ComponentModel | undefined {\r\n    return this.components[type];\r\n  }\r\n\r\n  hasComponentWithName(type: string): boolean {\r\n    return this.components[type] ? true : false;\r\n  }\r\n\r\n  getAllComponents(): ComponentModel[] {\r\n    return Object.keys(this.components).map((name) => {\r\n      return this.components[name];\r\n    });\r\n  }\r\n\r\n  getAllNodes(): any[] {\r\n    let nodes: any[] = [];\r\n\r\n    const componentNames = Object.keys(this.components);\r\n    for (let i = 0; i < componentNames.length; i++) {\r\n      const component = this.components[componentNames[i]];\r\n      nodes = nodes.concat(component.getAllNodes());\r\n    }\r\n\r\n    return nodes;\r\n  }\r\n\r\n  addComponent(component: ComponentModel): void {\r\n    this.components[component.name] = component;\r\n\r\n    this.getNodesWithType(component.name).forEach(\r\n      this._addComponentPorts.bind(this)\r\n    );\r\n\r\n    component.getAllNodes().forEach(this._onNodeAdded.bind(this));\r\n\r\n    component.on(\"nodeAdded\", this._onNodeAdded.bind(this), this);\r\n\r\n    component.on(\"nodeRemoved\", this._onNodeRemoved.bind(this), this);\r\n    component.on(\"nodeWasRemoved\", this._onNodeWasRemoved.bind(this), this);\r\n\r\n    this.emit(\"componentAdded\", component);\r\n  }\r\n\r\n  async removeComponentWithName(\r\n    componentName: string | undefined\r\n  ): Promise<void> {\r\n    if (!componentName) {\r\n      return;\r\n    }\r\n\r\n    if (this.components.hasOwnProperty(componentName) === false) {\r\n      console.error(\r\n        \"GraphModel: Component with name \" + componentName + \" not in graph\"\r\n      );\r\n      return;\r\n    }\r\n\r\n    const component = this.components[componentName];\r\n    await component.reset();\r\n\r\n    component.removeAllListeners();\r\n    delete this.components[component.name];\r\n\r\n    this.emit(\"componentRemoved\", component);\r\n  }\r\n\r\n  renameComponent(componentName: string, newName: string): void {\r\n    if (this.components.hasOwnProperty(componentName) === false) {\r\n      console.error(\r\n        \"GraphModel: Component with name \" + componentName + \" not in graph\"\r\n      );\r\n      return;\r\n    }\r\n\r\n    this.getNodesWithType(componentName).forEach(function (nodeModel) {\r\n      nodeModel.type = newName;\r\n    });\r\n\r\n    const component = this.components[componentName];\r\n    component.rename(newName);\r\n\r\n    delete this.components[componentName];\r\n    this.components[newName] = component;\r\n\r\n    this.emit(\"componentRenamed\", component);\r\n  }\r\n\r\n  private _addComponentPorts(node: any): void {\r\n    if (this.components.hasOwnProperty(node.type)) {\r\n      const component = this.components[node.type];\r\n\r\n      const inputPorts = component.getInputPorts();\r\n      const outputPorts = component.getOutputPorts();\r\n\r\n      Object.keys(inputPorts).forEach((portName) => {\r\n        node.addInputPort(inputPorts[portName]);\r\n      });\r\n\r\n      Object.keys(outputPorts).forEach((portName) => {\r\n        node.addOutputPort(outputPorts[portName]);\r\n      });\r\n    }\r\n  }\r\n\r\n  private _onNodeAdded(node: any): void {\r\n    this._addComponentPorts(node);\r\n\r\n    this.emit(\"nodeAdded\", node);\r\n    this.emit(\"nodeAdded.\" + node.type, node);\r\n  }\r\n\r\n  private _onNodeRemoved(node: any): void {\r\n    this.emit(\"nodeRemoved\", node);\r\n    this.emit(\"nodeRemoved.\" + node.type, node);\r\n  }\r\n\r\n  private _onNodeWasRemoved(node: any): void {\r\n    this.emit(\"nodeWasRemoved\", node);\r\n    this.emit(\"nodeWasRemoved.\" + node.type, node);\r\n  }\r\n\r\n  async reset(): Promise<void> {\r\n    for (const componentName of Object.keys(this.components)) {\r\n      await this.removeComponentWithName(componentName);\r\n    }\r\n    this.setSettings({});\r\n  }\r\n\r\n  isEmpty(): boolean {\r\n    return Object.keys(this.components).length === 0;\r\n  }\r\n\r\n  setSettings(settings: Settings): void {\r\n    this.settings = settings;\r\n    this.emit(\"projectSettingsChanged\", settings);\r\n  }\r\n\r\n  getSettings(): Settings {\r\n    return this.settings;\r\n  }\r\n\r\n  setAllMetaData(metadata: Metadata): void {\r\n    for (const p in metadata) {\r\n      this.setMetaData(p, metadata[p]);\r\n    }\r\n  }\r\n\r\n  setMetaData(key: string, data: any): void {\r\n    if (\r\n      this.metadata[key] &&\r\n      JSON.stringify(this.metadata[key]) === JSON.stringify(data)\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.metadata[key] = data;\r\n    this.emit(\"metadataChanged\", { key, data });\r\n    this.emit(\"metadataChanged.\" + key, data);\r\n  }\r\n\r\n  getMetaData(key?: string): any {\r\n    if (key) return this.metadata[key];\r\n    return this.metadata;\r\n  }\r\n\r\n  getVariants(): Variant[] {\r\n    return this.variants || [];\r\n  }\r\n\r\n  getVariant(typename: string, name: string): Variant | undefined {\r\n    return this.variants.find(\r\n      (v) => v.name === name && v.typename === typename\r\n    );\r\n  }\r\n\r\n  updateVariant(variant: Variant): void {\r\n    const i = this.variants.findIndex(\r\n      (v) => v.name === variant.name && v.typename === variant.typename\r\n    );\r\n    if (i !== -1) this.variants.splice(i, 1);\r\n    this.variants.push(variant);\r\n\r\n    this.emit(\"variantUpdated\", variant);\r\n  }\r\n\r\n  updateVariantParameter(\r\n    variantName: string,\r\n    variantTypeName: string,\r\n    parameterName: string,\r\n    parameterValue: any,\r\n    state?: string\r\n  ): void {\r\n    const variant = this.getVariant(variantTypeName, variantName);\r\n    if (!variant) {\r\n      console.log(\r\n        \"updateVariantParameter: can't find variant\",\r\n        variantName,\r\n        variantTypeName\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (!state) {\r\n      if (parameterValue === undefined) {\r\n        delete variant.parameters[parameterName];\r\n      } else {\r\n        variant.parameters[parameterName] = parameterValue;\r\n      }\r\n    } else {\r\n      if (!variant.stateParameters.hasOwnProperty(state)) {\r\n        variant.stateParameters[state] = {};\r\n      }\r\n\r\n      if (parameterValue === undefined) {\r\n        delete variant.stateParameters[state][parameterName];\r\n      } else {\r\n        variant.stateParameters[state][parameterName] = parameterValue;\r\n      }\r\n    }\r\n\r\n    this.emit(\"variantUpdated\", variant);\r\n  }\r\n\r\n  updateVariantDefaultStateTransition(\r\n    variantName: string,\r\n    variantTypeName: string,\r\n    transition: any,\r\n    state: string\r\n  ): void {\r\n    const variant = this.getVariant(variantTypeName, variantName);\r\n    if (!variant) return;\r\n\r\n    variant.defaultStateTransitions[state] = transition;\r\n    this.emit(\"variantUpdated\", variant);\r\n  }\r\n\r\n  updateVariantStateTransition(args: Event): void {\r\n    const { variantTypeName, variantName, state, parameterName, curve } = args;\r\n\r\n    const variant = this.getVariant(variantTypeName!, variantName!);\r\n    if (!variant) return;\r\n\r\n    if (!variant.stateTransitions[state]) {\r\n      variant.stateTransitions[state] = {};\r\n    }\r\n\r\n    variant.stateTransitions[state][parameterName!] = curve;\r\n  }\r\n\r\n  deleteVariant(typename: string, name: string): void {\r\n    const i = this.variants.findIndex(\r\n      (v) => v.name === name && v.typename === typename\r\n    );\r\n    if (i !== -1) this.variants.splice(i, 1);\r\n  }\r\n}\r\n\r\nexport { GraphModel };\r\n","import { NodeContext } from \"./nodecontext\";\r\nimport { GraphModel, RouterIndex } from \"./models/graphmodel\";\r\nimport { ComponentModel, Port } from \"./models/componentmodel\";\r\nimport { NodeModel } from \"./models/nodemodel\";\r\nimport { NodeScope } from \"./nodescope\";\r\n\r\nexport interface Event {\r\n  type: string;\r\n  componentName?: string;\r\n  model?: any;\r\n  nodeId?: string;\r\n  parentId?: string;\r\n  childIndex?: number;\r\n  port?: Port;\r\n  parameters?: Record<string, any>;\r\n  oldParameters?: Record<string, any>;\r\n  parameterName?: string;\r\n  parameterValue?: any;\r\n  state?: any;\r\n  ports?: Port[];\r\n  oldName?: string;\r\n  newName?: string;\r\n  settings?: any;\r\n  key?: string;\r\n  data?: any;\r\n  variant?: any;\r\n  variantName?: string;\r\n  variantTypeName?: string;\r\n  oldVariantName?: string;\r\n  curve?: any;\r\n  name?: string;\r\n}\r\n\r\nfunction difference(array1: string[], array2: string[]): string[] {\r\n  const valueSet = new Set(array2);\r\n  return array1.filter((e) => !valueSet.has(e));\r\n}\r\n\r\nasync function handleEvent(\r\n  context: NodeContext,\r\n  graphModel: GraphModel,\r\n  event: Event\r\n): Promise<void> {\r\n  function applyPortDelta(\r\n    nodeModel: ComponentModel | NodeModel,\r\n    newPorts: Port[]\r\n  ): void {\r\n    const inputPorts: Record<string, Port> = {};\r\n    const outputPorts: Record<string, Port> = {};\r\n\r\n    newPorts.forEach((port: Port) => {\r\n      // TODO: WTF...\r\n      // if (port && port.plug === \"outputs\") {\r\n      //   port.plug = \"output\";\r\n      // }\r\n\r\n      if (port.plug === \"input\" || port.plug === \"input/output\") {\r\n        inputPorts[port.name] = port;\r\n      }\r\n      if (port.plug === \"output\" || port.plug === \"input/output\") {\r\n        outputPorts[port.name] = port;\r\n      }\r\n    });\r\n\r\n    const existingInputs = Object.keys(nodeModel.getInputPorts());\r\n\r\n    const inputPortsToRemove = difference(\r\n      existingInputs,\r\n      Object.keys(inputPorts)\r\n    );\r\n    const inputPortsToAdd = difference(Object.keys(inputPorts), existingInputs);\r\n\r\n    nodeModel.updateInputPortTypes(inputPorts);\r\n\r\n    inputPortsToRemove.forEach(\r\n      nodeModel.removeInputPortWithName.bind(nodeModel)\r\n    );\r\n    inputPortsToAdd.forEach((portName: string) => {\r\n      nodeModel.addInputPort(inputPorts[portName]);\r\n      if (nodeModel instanceof NodeModel) {\r\n        if (nodeModel.parameters?.hasOwnProperty(portName)) {\r\n          setInputValueOnNodeInstancesWithModel(\r\n            context.rootComponent!.nodeScope,\r\n            nodeModel,\r\n            portName,\r\n            nodeModel.parameters[portName]\r\n          );\r\n        }\r\n      }\r\n    });\r\n\r\n    nodeModel.updateOutputPortTypes(outputPorts);\r\n\r\n    const existingOutputs = Object.keys(nodeModel.getOutputPorts());\r\n\r\n    const outputPortsToRemove = difference(\r\n      existingOutputs,\r\n      Object.keys(outputPorts)\r\n    );\r\n    const outputPortsToAdd = difference(\r\n      Object.keys(outputPorts),\r\n      existingOutputs\r\n    );\r\n\r\n    outputPortsToRemove.forEach(\r\n      nodeModel.removeOutputPortWithName.bind(nodeModel)\r\n    );\r\n    outputPortsToAdd.forEach((portName: string) => {\r\n      nodeModel.addOutputPort(outputPorts[portName]);\r\n    });\r\n  }\r\n\r\n  function setInputValueOnNodeInstancesWithModel(\r\n    nodeScope: NodeScope,\r\n    nodeModel: NodeModel,\r\n    port: string,\r\n    value: any\r\n  ): void {\r\n    const nodes = nodeScope.getNodesWithIdRecursive(nodeModel.id);\r\n    nodes.forEach((node) => {\r\n      node.queueInput(port, value);\r\n    });\r\n  }\r\n\r\n  let componentModel: ComponentModel | undefined;\r\n  if (event.componentName) {\r\n    componentModel = graphModel.getComponentWithName(event.componentName);\r\n    if (!componentModel) {\r\n      return;\r\n    }\r\n  }\r\n\r\n  // TODO: WTF...\r\n  // if (event.port && event.port.plug === \"outputs\") {\r\n  //   event.port.plug = \"output\";\r\n  // }\r\n\r\n  if (!componentModel) {\r\n    // TODO: This is new, why is the code like this after this line?\r\n    throw new Error(\"Component model not found\");\r\n  }\r\n\r\n  const eventHandlers: Record<string, (event: Event) => Promise<void> | void> =\r\n    {\r\n      nodeAdded: (event: Event): void => {\r\n        componentModel?.importEditorNodeData(\r\n          event.model,\r\n          event.parentId,\r\n          event.childIndex\r\n        );\r\n      },\r\n      nodeRemoved: async (event: Event): Promise<void> => {\r\n        if (componentModel?.hasNodeWithId(event.model.id)) {\r\n          await componentModel.removeNodeWithId(event.model.id);\r\n        }\r\n      },\r\n      connectionAdded: (event: Event): void => {\r\n        componentModel?.addConnection(event.model);\r\n      },\r\n      connectionRemoved: (event: Event): void => {\r\n        if (!componentModel) {\r\n          return;\r\n        }\r\n\r\n        componentModel.removeConnection(event.model);\r\n\r\n        const targetNodeModel = componentModel.getNodeWithId(\r\n          event.model.targetId\r\n        )!;\r\n        if (\r\n          componentModel.getConnectionsToPort(\r\n            targetNodeModel.id,\r\n            event.model.targetId\r\n          ).length === 0\r\n        ) {\r\n          let value = targetNodeModel.parameters[event.model.targetPort];\r\n          if (value === undefined) {\r\n            value = context.getDefaultValueForInput(\r\n              targetNodeModel.type,\r\n              event.model.targetPort\r\n            );\r\n          }\r\n\r\n          setInputValueOnNodeInstancesWithModel(\r\n            context.rootComponent!.nodeScope,\r\n            targetNodeModel,\r\n            event.model.targetPort,\r\n            value\r\n          );\r\n        }\r\n      },\r\n      parameterChanged: (event: Event): void => {\r\n        if (!componentModel) {\r\n          return;\r\n        }\r\n\r\n        const nodeModel = componentModel.getNodeWithId(event.nodeId!);\r\n        if (nodeModel === undefined) {\r\n          console.log(\"parameterChanged: Unknown node id\", event);\r\n          return;\r\n        }\r\n\r\n        if (event.parameters) {\r\n          const allParams = new Set([\r\n            ...Object.keys(event.parameters),\r\n            ...Object.keys(event.oldParameters!),\r\n          ]);\r\n          for (const param of allParams) {\r\n            nodeModel.setParameter(param, event.parameters[param]);\r\n          }\r\n        }\r\n\r\n        if (event.parameterName) {\r\n          nodeModel.setParameter(\r\n            event.parameterName,\r\n            event.parameterValue,\r\n            event.state\r\n          );\r\n        }\r\n      },\r\n      nodeAttached: (event: Event): void => {\r\n        if (!componentModel) {\r\n          return;\r\n        }\r\n\r\n        componentModel.setNodeParent(\r\n          componentModel.getNodeWithId(event.nodeId),\r\n          componentModel.getNodeWithId(event.parentId),\r\n          event.childIndex\r\n        );\r\n      },\r\n      nodeDetached: (event: Event): void => {\r\n        if (!componentModel) {\r\n          return;\r\n        }\r\n\r\n        componentModel.setNodeParent(\r\n          componentModel.getNodeWithId(event.nodeId!),\r\n          null\r\n        );\r\n        componentModel.addRootId(event.nodeId!);\r\n      },\r\n      componentAdded: (event: Event): void => {\r\n        graphModel.importComponentFromEditorData(event.model);\r\n      },\r\n      componentRemoved: async (event: Event): Promise<void> => {\r\n        await graphModel.removeComponentWithName(event.componentName);\r\n      },\r\n      rootAdded: (event: Event): void => {\r\n        componentModel?.addRootId(event.nodeId);\r\n      },\r\n      portAdded: (event: Event): void => {\r\n        if (!componentModel) {\r\n          return;\r\n        }\r\n\r\n        const nodeModel = componentModel.getNodeWithId(event.nodeId);\r\n        if (!event.port || !nodeModel) {\r\n          return;\r\n        }\r\n\r\n        if (event.port.plug === \"input\" || event.port.plug === \"input/output\") {\r\n          nodeModel.addInputPort(event.port);\r\n\r\n          // TODO: Was here a bug before?\r\n          if (nodeModel.parameters.hasOwnProperty(event.port.name)) {\r\n            setInputValueOnNodeInstancesWithModel(\r\n              context.rootComponent!.nodeScope,\r\n              nodeModel,\r\n              event.port.name,\r\n              nodeModel.parameters[event.port.name]\r\n            );\r\n          }\r\n        }\r\n        if (\r\n          event.port.plug === \"output\" ||\r\n          event.port.plug === \"input/output\"\r\n        ) {\r\n          nodeModel.addOutputPort(event.port);\r\n        }\r\n      },\r\n      portRemoved: (event: Event): void => {\r\n        if (!componentModel) {\r\n          return;\r\n        }\r\n\r\n        const nodeModel = componentModel.getNodeWithId(event.nodeId);\r\n        if (!event.port || !nodeModel) {\r\n          return;\r\n        }\r\n\r\n        if (event.port.plug === \"input\" || event.port.plug === \"input/output\") {\r\n          nodeModel.removeInputPortWithName(event.port.name);\r\n        }\r\n        if (\r\n          event.port.plug === \"output\" ||\r\n          event.port.plug === \"input/output\"\r\n        ) {\r\n          nodeModel.removeOutputPortWithName(event.port.name);\r\n        }\r\n      },\r\n      nodePortRenamed: (event: Event): void => {\r\n        if (!event.port || !componentModel) {\r\n          return;\r\n        }\r\n\r\n        if (event.port.plug === \"input\" || event.port.plug === \"input/output\") {\r\n          if (event.nodeId && event.oldName) {\r\n            componentModel.renameInputPortOnNodeWithId(\r\n              event.nodeId,\r\n              event.oldName,\r\n              event.port.name\r\n            );\r\n          }\r\n        }\r\n        if (\r\n          event.nodeId &&\r\n          event.oldName &&\r\n          (event.port.plug === \"output\" || event.port.plug === \"input/output\")\r\n        ) {\r\n          componentModel.renameOutputPortOnNodeWithId(\r\n            event.nodeId,\r\n            event.oldName,\r\n            event.port.name\r\n          );\r\n        }\r\n        const node = componentModel.getNodeWithId(event.nodeId);\r\n        if (node?.type === \"Component Inputs\") {\r\n          componentModel.addInputPort(event.port);\r\n          graphModel\r\n            .getNodesWithType(componentModel.name)\r\n            .forEach((componentInstance) => {\r\n              componentInstance.component.renameInputPortOnNodeWithId(\r\n                componentInstance.id,\r\n                event.oldName,\r\n                event.port?.name\r\n              );\r\n            });\r\n          componentModel.removeInputPortWithName(event.oldName!);\r\n        } else if (node?.type === \"Component Outputs\") {\r\n          componentModel.addOutputPort(event.port);\r\n          graphModel\r\n            .getNodesWithType(componentModel!.name)\r\n            .forEach((componentInstance) => {\r\n              componentInstance.component.renameOutputPortOnNodeWithId(\r\n                componentInstance.id,\r\n                event.oldName,\r\n                event.port?.name\r\n              );\r\n            });\r\n          componentModel.removeOutputPortWithName(event.oldName!);\r\n        }\r\n      },\r\n      componentPortsUpdated: (event: Event): void => {\r\n        if (componentModel) {\r\n          applyPortDelta(componentModel, event.ports!);\r\n        }\r\n      },\r\n      instancePortsChanged: (event: Event): void => {\r\n        if (!componentModel!.hasNodeWithId(event.nodeId!)) return;\r\n        const nodeModel = componentModel!.getNodeWithId(event.nodeId!);\r\n        if (nodeModel) {\r\n          applyPortDelta(nodeModel, event.ports!);\r\n        }\r\n      },\r\n      componentRenamed: (event: Event): void => {\r\n        graphModel.renameComponent(event.oldName!, event.newName!);\r\n      },\r\n      settingsChanged: (event: Event): void => {\r\n        graphModel.setSettings(event.settings);\r\n      },\r\n      metadataChanged: (event: Event): void => {\r\n        graphModel.setMetaData(event.key!, event.data);\r\n      },\r\n      componentMetadataChanged: (event: Event): void => {\r\n        const c = graphModel.getComponentWithName(event.componentName!);\r\n        if (!c) return;\r\n        c.setMetadata(event.key!, event.data);\r\n      },\r\n      variantParametersChanged: (event: Event): void => {\r\n        if (event.variant) {\r\n          graphModel.updateVariant(event.variant);\r\n        } else {\r\n          graphModel.updateVariantParameter(\r\n            event.variantName!,\r\n            event.variantTypeName!,\r\n            event.parameterName!,\r\n            event.parameterValue,\r\n            event.state\r\n          );\r\n\r\n          if (event.parameterValue === undefined) {\r\n            const variant = graphModel.getVariant(\r\n              event.variantTypeName!,\r\n              event.variantName!\r\n            );\r\n            const nodes =\r\n              context.rootComponent!.nodeScope.getAllNodesWithVariantRecursive(\r\n                variant!\r\n              );\r\n            nodes.forEach((node) => {\r\n              node.queueInput(\r\n                event.parameterName,\r\n                node.getParameter(event.parameterName)\r\n              );\r\n            });\r\n          }\r\n        }\r\n      },\r\n      variantDeleted: (event: Event): void => {\r\n        graphModel.deleteVariant(event.variantTypeName!, event.variantName!);\r\n      },\r\n      variantChanged: (event: Event): void => {\r\n        const nodeModel = componentModel!.getNodeWithId(event.nodeId);\r\n        if (nodeModel) {\r\n          const variant = graphModel.getVariant(\r\n            nodeModel.type,\r\n            event.variantName!\r\n          );\r\n\r\n          nodeModel.setVariant(variant!);\r\n        }\r\n      },\r\n      variantRenamed: (event: Event): void => {\r\n        const variant = graphModel.getVariant(\r\n          event.variantTypeName!,\r\n          event.oldVariantName!\r\n        );\r\n        if (variant?.variantName) {\r\n          variant.name = variant.variantName;\r\n        }\r\n      },\r\n      defaultStateTransitionChanged: (event: Event): void => {\r\n        const nodeModel = componentModel!.getNodeWithId(event.nodeId);\r\n        nodeModel?.setDefaultStateTransition(event.curve, event.state);\r\n      },\r\n      stateTransitionsChanged: (event: Event): void => {\r\n        const nodeModel = componentModel!.getNodeWithId(event.nodeId);\r\n        if (nodeModel && event.parameterName) {\r\n          nodeModel.setStateTransitionParamter(\r\n            event.parameterName!,\r\n            event.curve,\r\n            event.state\r\n          );\r\n        }\r\n      },\r\n      variantDefaultStateTransitionChanged: (event: Event): void => {\r\n        graphModel.updateVariantDefaultStateTransition(\r\n          event.variantName!,\r\n          event.variantTypeName!,\r\n          event.curve,\r\n          event.state\r\n        );\r\n      },\r\n      variantStateTransitionsChanged: (event: Event): void => {\r\n        graphModel.updateVariantStateTransition(event);\r\n      },\r\n      routerIndexChanged: (event: Event): void => {\r\n        graphModel.routerIndex = event.data as RouterIndex;\r\n      },\r\n    };\r\n\r\n  if (eventHandlers.hasOwnProperty(event.type)) {\r\n    await eventHandlers[event.type](event);\r\n    context.scheduleUpdate();\r\n  } else {\r\n    console.log(\"Unknown event\", event);\r\n  }\r\n}\r\n\r\nexport { handleEvent };\r\n","import { EventEmitter } from \"eventemitter3\";\r\n\r\nexport class Services {\r\n  static events: EventEmitter = new EventEmitter();\r\n}\r\n","import { Node } from \"./node\";\r\nimport { createSetter } from \"./edgetriggeredinput\";\r\nimport type { Port } from \"./models/componentmodel\";\r\nimport { NodeSetup } from \"./noderegister\";\r\nimport { NodeContext } from \"./nodecontext\";\r\nimport { GraphModel } from \"./models/graphmodel\";\r\n\r\nexport interface InputDefinition<TInternal extends Record<string, any> = {}> {\r\n  set?: (this: Node<TInternal>, value: any) => void;\r\n  valueChangedToTrue?: (this: Node<TInternal>) => void;\r\n  setUnitType?: string;\r\n  displayName?: string;\r\n  editorName?: string;\r\n  group?: string;\r\n  type?: any;\r\n  default?: any;\r\n  index?: number;\r\n  exportToEditor?: boolean;\r\n  description?: string;\r\n  inputPriority?: number;\r\n  tooltip?: string;\r\n  tab?: string;\r\n  popout?: boolean;\r\n  allowVisualStates?: boolean;\r\n  nodeDoubleClickAction?: any;\r\n  createSetter?: (index: number) => (value: any) => void;\r\n}\r\n\r\nexport interface OutputDefinition<TInternal extends Record<string, any> = {}> {\r\n  displayName?: string;\r\n  editorName?: string;\r\n  group?: string;\r\n  type?: any;\r\n  index?: number;\r\n  exportToEditor?: boolean;\r\n  description?: string;\r\n  default?: unknown;\r\n  tooltip?: string;\r\n  tab?: string;\r\n  popout?: boolean;\r\n  allowVisualStates?: boolean;\r\n  get?: (this: Node<TInternal>) => any;\r\n  getter?: (this: Node<TInternal>) => any;\r\n}\r\n\r\ninterface Panel {\r\n  name: string;\r\n  context?: string[];\r\n  title?: string;\r\n  plug?: string;\r\n  type?: {\r\n    name: string;\r\n  };\r\n  canArrangeInGroups?: boolean;\r\n  hidden?: boolean;\r\n}\r\n\r\nexport type DynamicPort = {\r\n  name?: string;\r\n  condition?: string;\r\n  ports?: any[];\r\n  template?: string;\r\n  port?: any;\r\n  channelPort?: any;\r\n  inputs?: string[];\r\n  outputs?: string[];\r\n};\r\n\r\nexport interface NodeDefinition<TInternal extends Record<string, any> = {}> {\r\n  _internal?: any;\r\n  displayName?: string;\r\n  inputs?: Record<string, InputDefinition<TInternal>>;\r\n  outputs?: Record<string, OutputDefinition<TInternal>>;\r\n  category: string;\r\n  dynamicports?: DynamicPort[];\r\n  exportDynamicPorts?: any;\r\n  useVariants?: any;\r\n  allowChildren?: boolean;\r\n  allowChildrenWithCategory?: string[];\r\n  singleton?: boolean;\r\n  connectionPanel?: any;\r\n  allowAsChild?: boolean;\r\n  visualStates?: any;\r\n  panels?: Panel[];\r\n  color?: string;\r\n  usePortAsLabel?: any;\r\n  portLabelTruncationMode?: any;\r\n  name: string;\r\n  displayNodeName?: string;\r\n  deprecated?: boolean;\r\n  haveComponentPorts?: boolean;\r\n  version?: string;\r\n  module?: string;\r\n  docs?: string;\r\n  shortDocs?: string;\r\n  shortDesc?: string;\r\n  allowAsExportRoot?: boolean;\r\n  nodeDoubleClickAction?: any;\r\n  searchTags?: string[];\r\n  ports?: Port[];\r\n  numberedInputs?: Record<\r\n    string,\r\n    {\r\n      type: string;\r\n      displayPrefix: string;\r\n      group?: string;\r\n      index?: number;\r\n      createSetter: (\r\n        index: number\r\n      ) => (this: Node<TInternal>, value: any) => void;\r\n    }\r\n  >;\r\n  nodeScopeDidInitialize?: () => void;\r\n\r\n  /**\r\n   * deprecated Use methods instead.\r\n   */\r\n  prototypeExtensions?: Record<\r\n    string,\r\n    (\r\n      this: Node<TInternal>,\r\n      ...args: any[]\r\n    ) => void | {\r\n      value: (this: Node<TInternal>, ...args: any[]) => void;\r\n    }\r\n  > & {\r\n    registerOutputIfNeeded?: (this: Node<TInternal>, name: string) => void;\r\n  };\r\n\r\n  methods?: Record<string, (this: Node<TInternal>, ...args: any[]) => void> & {\r\n    registerOutputIfNeeded?: (this: Node<TInternal>, name: string) => void;\r\n  };\r\n\r\n  initialize?: (this: Node<TInternal>) => void;\r\n\r\n  // TODO: getInspectInfo, what more return types are supported?\r\n  getInspectInfo?: (this: Node<TInternal>) =>\r\n    | {\r\n        type: string;\r\n        value: unknown;\r\n      }\r\n    | {\r\n        type: string;\r\n        value: unknown;\r\n      }[]\r\n    | string\r\n    | number\r\n    | boolean\r\n    | undefined;\r\n}\r\n\r\nfunction registerInput(\r\n  object: any,\r\n  metadata: NodeDefinition,\r\n  name: string,\r\n  input: InputDefinition\r\n): void {\r\n  if (object.hasOwnProperty(name)) {\r\n    throw new Error(\"Input property \" + name + \" already registered\");\r\n  }\r\n\r\n  if (!input.set && !input.valueChangedToTrue) {\r\n    input.set = () => {};\r\n  }\r\n\r\n  if (input.set) {\r\n    object[name] = {\r\n      set: input.set,\r\n    };\r\n\r\n    //types to keep in the input on the node instances\r\n    //color and textStyles are used for style updates\r\n    //array is for supporting eval:ing strings\r\n    const typesToSaveInInput = [\"color\", \"textStyle\", \"array\"];\r\n\r\n    typesToSaveInInput.forEach((type) => {\r\n      if (input.type && (input.type === type || input.type.name === type)) {\r\n        object[name].type = type;\r\n      }\r\n    });\r\n  }\r\n\r\n  if (input.setUnitType) {\r\n    object[name].setUnitType = input.setUnitType;\r\n  }\r\n\r\n  metadata.inputs = metadata.inputs || {};\r\n  metadata.inputs[name] = {\r\n    displayName: input.displayName,\r\n    editorName: input.editorName,\r\n    group: input.group,\r\n    type: input.type,\r\n    default: input.default,\r\n    index: input.index,\r\n    exportToEditor: input.hasOwnProperty(\"exportToEditor\")\r\n      ? input.exportToEditor\r\n      : true,\r\n    inputPriority: input.inputPriority || 0,\r\n    tooltip: input.tooltip,\r\n    tab: input.tab,\r\n    popout: input.popout,\r\n    allowVisualStates: input.allowVisualStates,\r\n    nodeDoubleClickAction: input.nodeDoubleClickAction,\r\n  };\r\n\r\n  if (input.valueChangedToTrue) {\r\n    metadata.inputs[name].type = {\r\n      name: \"signal\",\r\n      allowConnectionsOnly: true,\r\n    };\r\n  }\r\n}\r\n\r\nfunction registerInputs(\r\n  object: any,\r\n  metadata: NodeDefinition,\r\n  inputs: Record<string, InputDefinition>\r\n): void {\r\n  Object.keys(inputs).forEach(function (inputName) {\r\n    registerInput(object, metadata, inputName, inputs[inputName]);\r\n  });\r\n}\r\n\r\nfunction registerNumberedInputs(\r\n  node: any,\r\n  numberedInputs: Record<string, any>\r\n): void {\r\n  for (const inputName of Object.keys(numberedInputs)) {\r\n    registerNumberedInput(node, inputName, numberedInputs[inputName]);\r\n  }\r\n}\r\n\r\nfunction registerNumberedInput(node: any, name: string, input: any): void {\r\n  const oldRegisterInputIfNeeded = node.registerInputIfNeeded;\r\n\r\n  node.registerInputIfNeeded = function (inputName: string): void {\r\n    if (oldRegisterInputIfNeeded) {\r\n      oldRegisterInputIfNeeded.call(node, inputName);\r\n    }\r\n\r\n    if (node.hasInput(inputName) || !inputName.startsWith(name)) {\r\n      return;\r\n    }\r\n\r\n    const index = Number(inputName.slice(name.length + 1)); // inputName is \"nameOfInput xxx\" where xxx is the index\r\n\r\n    node.registerInput(inputName, {\r\n      type: input.type,\r\n      set: input.createSetter.call(node, index),\r\n    });\r\n  };\r\n}\r\n\r\nfunction registerOutputsMetadata(\r\n  metadata: NodeDefinition,\r\n  outputs: Record<string, OutputDefinition>\r\n): void {\r\n  Object.keys(outputs).forEach(function (name) {\r\n    const output = outputs[name];\r\n\r\n    metadata.outputs = metadata.outputs || {};\r\n    metadata.outputs[name] = {\r\n      displayName: output.displayName,\r\n      editorName: output.editorName,\r\n      group: output.group,\r\n      type: output.type,\r\n      index: output.index,\r\n      exportToEditor: output.hasOwnProperty(\"exportToEditor\")\r\n        ? output.exportToEditor\r\n        : true,\r\n    };\r\n  });\r\n}\r\n\r\nfunction initializeDefaultValues(\r\n  defaultValues: Record<string, any>,\r\n  inputsMetadata: Record<string, any>\r\n): void {\r\n  Object.keys(inputsMetadata).forEach((name) => {\r\n    const defaultValue = inputsMetadata[name].default;\r\n    if (defaultValue === undefined) return;\r\n\r\n    if (inputsMetadata[name].type.defaultUnit) {\r\n      defaultValues[name] = {\r\n        unit: inputsMetadata[name].type.defaultUnit,\r\n        value: defaultValue,\r\n      };\r\n    } else {\r\n      defaultValues[name] = defaultValue;\r\n    }\r\n  });\r\n}\r\n\r\nexport function defineNode(opts: NodeDefinition): NodeSetup {\r\n  if (!opts.category) {\r\n    throw new Error(\"Node must have a category\");\r\n  }\r\n\r\n  if (!opts.name) {\r\n    throw new Error(\"Node must have a name\");\r\n  }\r\n\r\n  const metadata: NodeDefinition = {\r\n    inputs: {},\r\n    outputs: {},\r\n    category: opts.category,\r\n    dynamicports: opts.dynamicports,\r\n    exportDynamicPorts: opts.exportDynamicPorts,\r\n    useVariants: opts.useVariants,\r\n    allowChildren: opts.allowChildren,\r\n    allowChildrenWithCategory: opts.allowChildrenWithCategory,\r\n    singleton: opts.singleton,\r\n    connectionPanel: opts.connectionPanel,\r\n    allowAsChild: opts.allowAsChild,\r\n    visualStates: opts.visualStates,\r\n    panels: opts.panels,\r\n    color: opts.color,\r\n    usePortAsLabel: opts.usePortAsLabel,\r\n    portLabelTruncationMode: opts.portLabelTruncationMode,\r\n    name: opts.name,\r\n    displayNodeName: opts.displayNodeName || opts.displayName,\r\n    deprecated: opts.deprecated,\r\n    haveComponentPorts: opts.haveComponentPorts,\r\n    version: opts.version,\r\n    module: opts.module,\r\n    docs: opts.docs,\r\n    allowAsExportRoot: opts.allowAsExportRoot,\r\n    nodeDoubleClickAction: opts.nodeDoubleClickAction,\r\n    searchTags: opts.searchTags,\r\n  };\r\n\r\n  opts._internal = opts._internal || {};\r\n\r\n  //prototypeExtensions - old API\r\n  //methods - new API\r\n  opts.prototypeExtensions = opts.methods || opts.prototypeExtensions || {};\r\n  opts.inputs = opts.inputs || {};\r\n  opts.outputs = opts.outputs || {};\r\n  opts.initialize = opts.initialize || function () {};\r\n\r\n  const inputs: Record<string, any> = {};\r\n\r\n  registerInputs(inputs, metadata, opts.inputs);\r\n  registerOutputsMetadata(metadata, opts.outputs);\r\n\r\n  class NodeConstructor extends Node {\r\n    constructor(context: any, id: string) {\r\n      super(context, id);\r\n    }\r\n  }\r\n\r\n  if (opts.prototypeExtensions) {\r\n    Object.keys(opts.prototypeExtensions).forEach(function (propName) {\r\n      // TODO: WTF is this junk?!\r\n      // @ts-expect-error\r\n      if (!opts.prototypeExtensions![propName].value) {\r\n        // @ts-expect-error\r\n        opts.prototypeExtensions[propName] = {\r\n          // @ts-expect-error\r\n          value: opts.prototypeExtensions[propName],\r\n        };\r\n      }\r\n    });\r\n  }\r\n\r\n  // @ts-ignore\r\n  Object.defineProperties(NodeConstructor.prototype, opts.prototypeExtensions);\r\n  Object.defineProperty(NodeConstructor.prototype, \"name\", {\r\n    value: opts.name,\r\n  });\r\n\r\n  if (opts.getInspectInfo)\r\n    NodeConstructor.prototype.getInspectInfo = opts.getInspectInfo;\r\n  if (opts.nodeScopeDidInitialize)\r\n    NodeConstructor.prototype.nodeScopeDidInitialize =\r\n      opts.nodeScopeDidInitialize;\r\n\r\n  const nodeDefinition = function (\r\n    context: any,\r\n    id: string,\r\n    nodeScope: any\r\n  ): NodeSetup | NodeConstructor | undefined {\r\n    const node = new NodeConstructor(context, id);\r\n\r\n    //create all inputs. Use the inputs object for setters that don't have state and can be shared\r\n    node._inputs = Object.create(inputs);\r\n\r\n    //all inputs that use the valueChangedToTrue have state and need to be instanced\r\n    if (opts.inputs) {\r\n      Object.keys(opts.inputs).forEach(function (name) {\r\n        const input = opts.inputs![name];\r\n        if (input.valueChangedToTrue) {\r\n          node._inputs[name] = {\r\n            set: createSetter({\r\n              valueChangedToTrue: input.valueChangedToTrue,\r\n            }),\r\n          };\r\n        }\r\n      });\r\n\r\n      if (opts.outputs) {\r\n        Object.keys(opts.outputs).forEach(function (name) {\r\n          const output = opts.outputs![name];\r\n          if (output.type === \"signal\") {\r\n            node.registerOutput(name, {\r\n              getter() {\r\n                //signals are always emitted as a sequence of false, true, so this getter is never used\r\n                return undefined;\r\n              },\r\n            });\r\n          } else {\r\n            node.registerOutput(name, output);\r\n          }\r\n        });\r\n\r\n        opts.numberedInputs &&\r\n          registerNumberedInputs(node, opts.numberedInputs);\r\n\r\n        node.nodeScope = nodeScope;\r\n        initializeDefaultValues(node._inputValues, metadata.inputs || {});\r\n\r\n        opts.initialize?.call(node);\r\n\r\n        return node;\r\n      }\r\n\r\n      Object.assign(nodeDefinition, { metadata });\r\n\r\n      if (opts.numberedInputs)\r\n        registerSetupFunctionForNumberedInputs(\r\n          nodeDefinition,\r\n          opts.name,\r\n          opts.numberedInputs\r\n        );\r\n\r\n      return nodeDefinition;\r\n    }\r\n  };\r\n  nodeDefinition.metadata = metadata;\r\n\r\n  return nodeDefinition;\r\n}\r\n\r\nfunction registerSetupFunctionForNumberedInputs(\r\n  nodeDefinition: NodeSetup,\r\n  nodeType: string,\r\n  numberedInputs: Record<string, any>\r\n): void {\r\n  const inputNames = Object.keys(numberedInputs);\r\n\r\n  if (!inputNames.length) return;\r\n\r\n  nodeDefinition.setupNumberedInputDynamicPorts = function (\r\n    context: NodeContext,\r\n    graphModel: GraphModel\r\n  ): void {\r\n    const editorConnection = context.editorConnection;\r\n\r\n    if (!editorConnection || !editorConnection.isRunningLocally()) {\r\n      return;\r\n    }\r\n\r\n    function collectPorts(node: any, inputName: string, input: any): any[] {\r\n      const connections = node.component\r\n        .getConnectionsTo(node.id)\r\n        .map((c: any) => c.targetPort);\r\n\r\n      const allPortNames = Object.keys(node.parameters).concat(connections);\r\n      const portNames = allPortNames.filter((p) =>\r\n        p.startsWith(inputName + \" \")\r\n      );\r\n\r\n      //Figure out how many we need to create\r\n      //It needs to be the highest index + 1\r\n      //Only parameters with values are present, e.g. input 3 can be missing even if input 4 is defined\r\n      const maxIndex = portNames.length\r\n        ? 1 +\r\n          Math.max(\r\n            ...portNames.map((p) => Number(p.slice(inputName.length + 1)))\r\n          )\r\n        : 0;\r\n      const numPorts = maxIndex + 1;\r\n\r\n      const ports: Port[] = [];\r\n\r\n      for (let i = 0; i < numPorts; i++) {\r\n        const port: Port = {\r\n          name: inputName + \" \" + i,\r\n          displayName: (input.displayPrefix || inputName) + \" \" + i,\r\n          type: input.type,\r\n          plug: \"input\",\r\n          group: input.group,\r\n        };\r\n\r\n        if (input.hasOwnProperty(\"index\")) {\r\n          port.index = input.index + i;\r\n        }\r\n\r\n        ports.push(port);\r\n      }\r\n\r\n      return ports;\r\n    }\r\n\r\n    function updatePorts(node: any): void {\r\n      const ports = inputNames\r\n        .map((inputName) =>\r\n          collectPorts(node, inputName, numberedInputs[inputName])\r\n        )\r\n        .flat();\r\n      editorConnection?.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    graphModel.on(\"nodeAdded.\" + nodeType, (node: any) => {\r\n      updatePorts(node);\r\n      node.on(\"parameterUpdated\", () => {\r\n        updatePorts(node);\r\n      });\r\n\r\n      node.on(\"inputConnectionAdded\", () => {\r\n        updatePorts(node);\r\n      });\r\n\r\n      node.on(\"inputConnectionRemoved\", () => {\r\n        updatePorts(node);\r\n      });\r\n    });\r\n  };\r\n}\r\n\r\nexport function extend<T extends object, U extends object>(\r\n  obj1: T,\r\n  obj2: U\r\n): T & U {\r\n  for (const p in obj2) {\r\n    if (p === \"initialize\" && (obj1 as any).initialize) {\r\n      const oldInit = (obj1 as any).initialize;\r\n      (obj1 as any).initialize = function () {\r\n        oldInit.call(this);\r\n        (obj2 as any).initialize.call(this);\r\n      };\r\n      // @ts-ignore\r\n    } else if (obj2[p] && obj2[p].constructor === Object) {\r\n      // @ts-ignore\r\n      (obj1 as any)[p] = extend((obj1 as any)[p] || {}, obj2[p]);\r\n    } else if (\r\n      obj2[p] &&\r\n      // @ts-ignore\r\n      obj2[p].constructor === Array &&\r\n      (obj1 as any)[p] &&\r\n      // @ts-ignore\r\n      (obj1 as any)[p].constructor == Array\r\n    ) {\r\n      (obj1 as any)[p] = (obj1 as any)[p].concat(obj2[p]);\r\n    } else {\r\n      (obj1 as any)[p] = obj2[p];\r\n    }\r\n  }\r\n  return obj1 as T & U;\r\n}\r\n","import type { NodeDefinition } from \"../nodedefinition\";\r\n\r\nexport const node: NodeDefinition = {\r\n  name: \"Component Inputs\",\r\n  shortDesc: \"This node is used to define the inputs of a component.\",\r\n  docs: \"https://docs.noodl.net/nodes/component-utilities/component-inputs\",\r\n  panels: [\r\n    {\r\n      name: \"PortEditor\",\r\n      context: [\"select\", \"connectFrom\"],\r\n      title: \"Inputs\",\r\n      plug: \"output\",\r\n      type: {\r\n        name: \"*\",\r\n      },\r\n      canArrangeInGroups: true,\r\n    },\r\n    {\r\n      name: \"PropertyEditor\",\r\n      hidden: true,\r\n    },\r\n  ],\r\n  getInspectInfo() {\r\n    return {\r\n      type: \"value\",\r\n      value: this.nodeScope?.componentOwner._internal.inputValues,\r\n    };\r\n  },\r\n  color: \"component\",\r\n  haveComponentPorts: true,\r\n  category: \"Component Utilities\",\r\n  methods: {\r\n    registerOutputIfNeeded(name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerOutput(name, {\r\n        getter() {\r\n          return this.nodeScope?.componentOwner._internal.inputValues[name];\r\n        },\r\n      });\r\n    },\r\n    _updateDependencies() {\r\n      this.nodeScope?.componentOwner?.update();\r\n    },\r\n  },\r\n};\r\n","import type { NodeDefinition } from \"../nodedefinition\";\r\n\r\nexport const node: NodeDefinition = {\r\n  category: \"Component Utilities\",\r\n  name: \"Component Outputs\",\r\n  shortDesc: \"This node is used to define the outputs of a component.\",\r\n  docs: \"https://docs.noodl.net/nodes/component-utilities/component-outputs\",\r\n  panels: [\r\n    {\r\n      name: \"PortEditor\",\r\n      context: [\"select\", \"connectTo\"],\r\n      title: \"Outputs\",\r\n      plug: \"input\",\r\n      type: {\r\n        name: \"*\",\r\n      },\r\n      canArrangeInGroups: true,\r\n    },\r\n    {\r\n      name: \"PropertyEditor\",\r\n      hidden: true,\r\n    },\r\n  ],\r\n  color: \"component\",\r\n  haveComponentPorts: true,\r\n  prototypeExtensions: {\r\n    registerInputIfNeeded: function (name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerInput(name, {\r\n        set(value: string) {\r\n          this.nodeScope?.componentOwner?.setOutputFromComponentOutput(\r\n            name,\r\n            value\r\n          );\r\n        },\r\n      });\r\n    },\r\n  },\r\n};\r\n","import type { Node } from \"../../node\";\r\nimport { guid } from \"../../utils\";\r\nimport { Model } from \"../../model\";\r\nimport { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  queuedOperations: Function[];\r\n  state: \"idle\" | \"running\" | \"aborted\";\r\n  maxRunningTasks: number;\r\n  activeTasks: Map<string, any>;\r\n  hasScheduledRun?: boolean;\r\n  hasScheduledAbort?: boolean;\r\n  template?: any;\r\n  items?: any[];\r\n  stopOnFailure?: boolean;\r\n  numTasks?: number;\r\n  failedTasks?: number;\r\n  completedTasks?: number;\r\n  queuedTasks?: any[];\r\n  runningTasks?: number;\r\n}\r\n\r\nfunction sendSignalOnInput(itemNode: any, name: string): void {\r\n  itemNode.queueInput(name, true); // send signal\r\n  itemNode.queueInput(name, false);\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"RunTasks\",\r\n  displayNodeName: \"Run Tasks\",\r\n  docs: \"https://docs.noodl.net/nodes/data/run-tasks\",\r\n  color: \"data\",\r\n  category: \"Data\",\r\n  initialize(): void {\r\n    this._internal = {\r\n      queuedOperations: [],\r\n      state: \"idle\",\r\n      maxRunningTasks: 10,\r\n      activeTasks: new Map(), //id => ComponentInstanceNode\r\n    } as Internal;\r\n  },\r\n  inputs: {\r\n    items: {\r\n      group: \"Data\",\r\n      displayName: \"Items\",\r\n      type: \"array\",\r\n      set(value: any[]): void {\r\n        if (!value) return;\r\n        if (value === this._internal.items) return;\r\n\r\n        this._internal.items = value;\r\n      },\r\n    },\r\n    stopOnFailure: {\r\n      group: \"General\",\r\n      displayName: \"Stop On Failure\",\r\n      type: \"boolean\",\r\n      default: false,\r\n      set(value: boolean): void {\r\n        this._internal.stopOnFailure = value;\r\n      },\r\n    },\r\n    maxRunningTasks: {\r\n      group: \"General\",\r\n      displayName: \"Max Running Tasks\",\r\n      type: \"number\",\r\n      default: 10,\r\n      set(value: number): void {\r\n        this._internal.maxRunningTasks = value;\r\n      },\r\n    },\r\n    taskTemplate: {\r\n      type: \"component\",\r\n      displayName: \"Template\",\r\n      group: \"General\",\r\n      set(value: any): void {\r\n        this._internal.template = value;\r\n      },\r\n    },\r\n    run: {\r\n      group: \"General\",\r\n      displayName: \"Do\",\r\n      type: \"signal\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleRun();\r\n      },\r\n    },\r\n    abort: {\r\n      group: \"General\",\r\n      displayName: \"Abort\",\r\n      type: \"signal\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleAbort();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    success: {\r\n      type: \"signal\",\r\n      group: \"Events\",\r\n      displayName: \"Success\",\r\n    },\r\n    failure: {\r\n      type: \"signal\",\r\n      group: \"Events\",\r\n      displayName: \"Failure\",\r\n    },\r\n    done: {\r\n      type: \"signal\",\r\n      group: \"Events\",\r\n      displayName: \"Done\",\r\n    },\r\n    aborted: {\r\n      type: \"signal\",\r\n      group: \"Events\",\r\n      displayName: \"Aborted\",\r\n    },\r\n  },\r\n  methods: {\r\n    scheduleRun(): void {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledRun) {\r\n        internal.hasScheduledRun = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          // @ts-expect-error\r\n          this._queueOperation(() => {\r\n            internal.hasScheduledRun = false;\r\n            // @ts-expect-error\r\n            this.run();\r\n          });\r\n        });\r\n      }\r\n    },\r\n    scheduleAbort(): void {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledAbort) {\r\n        internal.hasScheduledAbort = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          // @ts-expect-error\r\n          this._queueOperation(() => {\r\n            internal.hasScheduledAbort = false;\r\n            // @ts-expect-error\r\n            this.abort();\r\n          });\r\n        });\r\n      }\r\n    },\r\n    async createTaskComponent(item: any): Promise<any> {\r\n      const internal = this._internal;\r\n\r\n      const modelScope = this.nodeScope!.modelScope || Model;\r\n      const model = modelScope.create(item);\r\n\r\n      const itemNode = await this.nodeScope!.createNode(\r\n        internal.template,\r\n        guid(),\r\n        {\r\n          _forEachModel: model,\r\n          _forEachNode: this,\r\n        }\r\n      );\r\n\r\n      // This is needed to make sure any action connected to \"Do\"\r\n      // is not run directly\r\n      const _isInputConnected = itemNode.isInputConnected.bind(itemNode);\r\n      itemNode.isInputConnected = (name: string): boolean => {\r\n        if (name === \"Do\") return true;\r\n        return _isInputConnected(name);\r\n      };\r\n\r\n      // Set the Id as an input\r\n      if (itemNode.hasInput(\"Id\")) {\r\n        itemNode.setInputValue(\"Id\", model.getId());\r\n      }\r\n      if (itemNode.hasInput(\"id\")) {\r\n        itemNode.setInputValue(\"id\", model.getId());\r\n      }\r\n\r\n      // Push all other values also as inputs\r\n      // if they exist as component inputs\r\n      for (const inputKey in itemNode._inputs) {\r\n        if (model.data[inputKey] !== undefined)\r\n          itemNode.setInputValue(inputKey, model.data[inputKey]);\r\n      }\r\n\r\n      // capture signals\r\n      itemNode._internal.creatorCallbacks = {\r\n        onOutputChanged: (\r\n          name: string,\r\n          value: boolean,\r\n          oldValue: boolean | undefined\r\n        ) => {\r\n          if (\r\n            (oldValue === false || oldValue === undefined) &&\r\n            value === true\r\n          ) {\r\n            // @ts-expect-error\r\n            this.itemOutputSignalTriggered(name, model, itemNode);\r\n          }\r\n        },\r\n      };\r\n\r\n      return itemNode;\r\n    },\r\n    async startTask(task: any): Promise<void> {\r\n      const internal = this._internal;\r\n\r\n      try {\r\n        // @ts-expect-error\r\n        const taskComponent = await this.createTaskComponent(task);\r\n        // @ts-expect-error\r\n        internal.runningTasks++;\r\n        sendSignalOnInput(taskComponent, \"Do\");\r\n        internal.activeTasks.set(taskComponent.id, taskComponent);\r\n      } catch (e) {\r\n        // Something went wrong starting the task\r\n        console.log(e);\r\n      }\r\n    },\r\n    async run(): Promise<void> {\r\n      const internal = this._internal;\r\n\r\n      if (this.context.editorConnection) {\r\n        if (internal.state !== \"idle\") {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"run-tasks\",\r\n            {\r\n              message: \"Cannot start when not in idle mode\",\r\n            }\r\n          );\r\n        } else if (!internal.template) {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"run-tasks\",\r\n            {\r\n              message: \"No task template specified.\",\r\n            }\r\n          );\r\n        } else if (!internal.items) {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"run-tasks\",\r\n            {\r\n              message: \"No items array provided.\",\r\n            }\r\n          );\r\n        } else {\r\n          this.context.editorConnection.clearWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"run-tasks\"\r\n          );\r\n        }\r\n      }\r\n\r\n      if (internal.state !== \"idle\") {\r\n        return;\r\n      }\r\n\r\n      if (!internal.template) {\r\n        return;\r\n      }\r\n\r\n      if (!internal.items) {\r\n        return;\r\n      }\r\n\r\n      internal.state = \"running\";\r\n      internal.numTasks = internal.items.length;\r\n      internal.failedTasks = 0;\r\n      internal.completedTasks = 0;\r\n      // @ts-expect-error\r\n      internal.queuedTasks = [].concat(internal.items);\r\n      internal.runningTasks = 0;\r\n\r\n      // No tasks\r\n      if (internal.items.length === 0) {\r\n        this.sendSignalOnOutput(\"success\");\r\n        internal.state = \"idle\";\r\n      }\r\n\r\n      // Start tasks\r\n      for (\r\n        let i = 0;\r\n        i < Math.min(internal.maxRunningTasks, internal.queuedTasks.length);\r\n        i++\r\n      ) {\r\n        const task = internal.queuedTasks.shift();\r\n        if (!task) break;\r\n\r\n        // @ts-expect-error\r\n        this.startTask(task);\r\n      }\r\n    },\r\n    abort(): void {\r\n      const internal = this._internal;\r\n      internal.state = \"aborted\";\r\n    },\r\n    itemOutputSignalTriggered(name: string, model: any, itemNode: any): void {\r\n      const internal = this._internal;\r\n\r\n      if (internal.state === \"idle\") {\r\n        // Signal while we are not running is ignored\r\n        return;\r\n      }\r\n\r\n      const checkDone = () => {\r\n        if (internal.state === \"aborted\") {\r\n          this.sendSignalOnOutput(\"aborted\");\r\n          internal.state = \"idle\";\r\n          return;\r\n        }\r\n\r\n        if (internal.completedTasks === internal.numTasks) {\r\n          if (internal.failedTasks === 0) this.sendSignalOnOutput(\"success\");\r\n          else this.sendSignalOnOutput(\"failure\");\r\n          this.sendSignalOnOutput(\"done\");\r\n          internal.state = \"idle\";\r\n        } else {\r\n          if (internal.stopOnFailure) {\r\n            // Only continue if there are no failed tasks, otherwise aborted\r\n            if (internal.failedTasks === 0) {\r\n              // @ts-expect-error\r\n              internal.runningTasks++;\r\n              // @ts-expect-error\r\n              const task = internal.queuedTasks.shift();\r\n              // @ts-expect-error\r\n              if (task) this.startTask(task);\r\n            } else {\r\n              this.sendSignalOnOutput(\"failure\");\r\n              this.sendSignalOnOutput(\"aborted\");\r\n            }\r\n          } else {\r\n            // @ts-expect-error\r\n            internal.runningTasks++;\r\n            // @ts-expect-error\r\n            const task = internal.queuedTasks.shift();\r\n            // @ts-expect-error\r\n            if (task) this.startTask(task);\r\n          }\r\n        }\r\n      };\r\n\r\n      if (name === \"Success\") {\r\n        // @ts-expect-error\r\n        internal.completedTasks++;\r\n        // @ts-expect-error\r\n        internal.runningTasks--;\r\n        checkDone();\r\n      } else if (name === \"Failure\") {\r\n        // @ts-expect-error\r\n        internal.completedTasks++;\r\n        // @ts-expect-error\r\n        internal.failedTasks++;\r\n        // @ts-expect-error\r\n        internal.runningTasks--;\r\n        checkDone();\r\n      }\r\n\r\n      internal.activeTasks.delete(itemNode.id);\r\n      this.nodeScope!.deleteNode(itemNode);\r\n    },\r\n    _queueOperation(op: Function): void {\r\n      this._internal.queuedOperations.push(op);\r\n      // @ts-expect-error\r\n      this._runQueueOperations();\r\n    },\r\n    async _runQueueOperations(): Promise<void> {\r\n      // @ts-expect-error\r\n      if (this.runningOperations) {\r\n        return;\r\n      }\r\n      // @ts-expect-error\r\n      this.runningOperations = true;\r\n\r\n      while (this._internal.queuedOperations.length) {\r\n        const op = this._internal.queuedOperations.shift();\r\n        // @ts-expect-error\r\n        await op();\r\n      }\r\n\r\n      // @ts-expect-error\r\n      this.runningOperations = false;\r\n    },\r\n  },\r\n  // @ts-expect-error\r\n  _deleteAllTasks(): void {\r\n    for (const taskComponent of this._internal.activeTasks) {\r\n      // @ts-expect-error\r\n      this.nodeScope.deleteNode(taskComponent);\r\n    }\r\n    this._internal.activeTasks.clear();\r\n  },\r\n  _onNodeDeleted(): void {\r\n    // @ts-expect-error\r\n    Node.prototype._onNodeDeleted.call(this);\r\n    // @ts-expect-error\r\n    this._deleteAllTasks();\r\n  },\r\n};\r\n","import { NodeDefinition } from \"../../../nodedefinition\";\r\nimport { NodeContext } from \"../../../nodecontext\";\r\nimport { GraphModel } from \"../../../models/graphmodel\";\r\nimport { Port } from \"../../../models/componentmodel\";\r\n\r\nconst defaultRequestScript =\r\n  \"\" +\r\n  \"//Add custom code to setup the request object before the request\\n\" +\r\n  \"//is made.\\n\" +\r\n  \"//\\n\" +\r\n  \"//*Request.resource     contains the resource path of the request.\\n\" +\r\n  \"//*Request.method       contains the method, GET, POST, PUT or DELETE.\\n\" +\r\n  \"//*Request.headers      is a map where you can add additional headers.\\n\" +\r\n  \"//*Request.parameters   is a map the parameters that will be appended\\n\" +\r\n  \"//                      to the url.\\n\" +\r\n  \"//*Request.content      contains the content of the request as a javascript\\n\" +\r\n  \"//                      object.\\n\" +\r\n  \"//\\n\" +\r\n  \"//*Inputs and *Outputs contain the inputs and outputs of the node.\\n\";\r\n\r\nconst defaultResponseScript =\r\n  \"\" +\r\n  \"// Add custom code to convert the response content to outputs\\n\" +\r\n  \"//\\n\" +\r\n  \"//*Response.status    The status code of the response\\n\" +\r\n  \"//*Response.content   The content of the response as a javascript\\n\" +\r\n  \"//                    object.\\n\" +\r\n  \"//*Response.request   The request object that resulted in the response.\\n\" +\r\n  \"//\\n\" +\r\n  \"//*Inputs and *Outputs contain the inputs and outputs of the node.\\n\";\r\n\r\ninterface Request {\r\n  resource: string;\r\n  method: string;\r\n  headers: Record<string, string>;\r\n  parameters: Record<string, string>;\r\n  content?: any;\r\n}\r\n\r\ninterface Response {\r\n  status: number;\r\n  content: any;\r\n  request: Request;\r\n}\r\n\r\ninterface Internal {\r\n  inputValues: Record<string, any>;\r\n  outputValues: Record<string, any>;\r\n  outputValuesProxy: any;\r\n  self: any;\r\n  resource?: string;\r\n  method?: string;\r\n  requestFunc?: Function;\r\n  responseFunc?: Function;\r\n  hasScheduledFetch?: boolean;\r\n  inspectData?: any;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"REST2\",\r\n  displayNodeName: \"REST\",\r\n  docs: \"https://docs.noodl.net/nodes/data/rest\",\r\n  category: \"Data\",\r\n  color: \"data\",\r\n  searchTags: [\"http\", \"request\", \"fetch\"],\r\n  initialize() {\r\n    this._internal.inputValues = {};\r\n    this._internal.outputValues = {};\r\n\r\n    this._internal.outputValuesProxy = new Proxy(this._internal.outputValues, {\r\n      set: (obj, prop: string, value) => {\r\n        if (value !== this._internal.outputValues[prop]) {\r\n          // @ts-expect-error\r\n          this.registerOutputIfNeeded(\"out-\" + prop);\r\n\r\n          this._internal.outputValues[prop] = value;\r\n          this.flagOutputDirty(\"out-\" + prop);\r\n        }\r\n        return true;\r\n      },\r\n    });\r\n\r\n    this._internal.self = {};\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.inspectData\r\n      ? { type: \"value\", value: this._internal.inspectData }\r\n      : { type: \"text\", value: \"[Not executed yet]\" };\r\n  },\r\n  inputs: {\r\n    resource: {\r\n      type: \"string\",\r\n      displayName: \"Resource\",\r\n      group: \"Request\",\r\n      default: \"/\",\r\n      set(value: string) {\r\n        this._internal.resource = value;\r\n      },\r\n    },\r\n    method: {\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"GET\", value: \"GET\" },\r\n          { label: \"POST\", value: \"POST\" },\r\n          { label: \"PUT\", value: \"PUT\" },\r\n          { label: \"PATCH\", value: \"PATCH\" },\r\n          { label: \"DELETE\", value: \"DELETE\" },\r\n        ],\r\n      },\r\n      displayName: \"Method\",\r\n      group: \"Request\",\r\n      default: \"GET\",\r\n      set(value: string) {\r\n        this._internal.method = value;\r\n      },\r\n    },\r\n    requestScript: {\r\n      type: {\r\n        name: \"string\",\r\n        allowEditOnly: true,\r\n        codeeditor: \"javascript\",\r\n      },\r\n      displayName: \"Request\",\r\n      default: defaultRequestScript,\r\n      group: \"Scripts\",\r\n      set(script: string) {\r\n        try {\r\n          this._internal.requestFunc = new Function(\r\n            \"Inputs\",\r\n            \"Outputs\",\r\n            \"Request\",\r\n            script\r\n          );\r\n        } catch (e) {\r\n          console.log(e);\r\n        }\r\n      },\r\n    },\r\n    responseScript: {\r\n      type: {\r\n        name: \"string\",\r\n        allowEditOnly: true,\r\n        codeeditor: \"javascript\",\r\n      },\r\n      displayName: \"Response\",\r\n      default: defaultResponseScript,\r\n      group: \"Scripts\",\r\n      set(script: string) {\r\n        try {\r\n          this._internal.responseFunc = new Function(\r\n            \"Inputs\",\r\n            \"Outputs\",\r\n            \"Response\",\r\n            script\r\n          );\r\n        } catch (e) {\r\n          console.log(e);\r\n        }\r\n      },\r\n    },\r\n    fetch: {\r\n      type: \"signal\",\r\n      displayName: \"Fetch\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleFetch();\r\n      },\r\n    },\r\n    cancel: {\r\n      type: \"signal\",\r\n      displayName: \"Cancel\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.cancelFetch();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    failure: {\r\n      type: \"signal\",\r\n      displayName: \"Failure\",\r\n      group: \"Events\",\r\n    },\r\n    success: {\r\n      type: \"signal\",\r\n      displayName: \"Success\",\r\n      group: \"Events\",\r\n    },\r\n    canceled: {\r\n      type: \"signal\",\r\n      displayName: \"Canceled\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    getScriptOutputValue(name: string) {\r\n      return this._internal.outputValues[name];\r\n    },\r\n    setScriptInputValue(name: string, value: any) {\r\n      return (this._internal.inputValues[name] = value);\r\n    },\r\n    registerOutputIfNeeded(name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"out-\"))\r\n        return this.registerOutput(name, {\r\n          // @ts-expect-error\r\n          getter: this.getScriptOutputValue.bind(\r\n            this,\r\n            name.substring(\"out-\".length)\r\n          ),\r\n        });\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"in-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setScriptInputValue.bind(\r\n            this,\r\n            name.substring(\"in-\".length)\r\n          ),\r\n        });\r\n    },\r\n    scheduleFetch() {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledFetch) {\r\n        internal.hasScheduledFetch = true;\r\n        // @ts-expect-error\r\n        this.scheduleAfterInputsHaveUpdated(this.doFetch.bind(this));\r\n      }\r\n    },\r\n    doResponse(status: number, response: any, request: Request) {\r\n      if (this._internal.responseFunc) {\r\n        this._internal.responseFunc.apply(this._internal.self, [\r\n          this._internal.inputValues,\r\n          this._internal.outputValuesProxy,\r\n          { status, content: response, request },\r\n        ]);\r\n      }\r\n\r\n      this._internal.inspectData = { status, content: response };\r\n\r\n      if (status >= 200 && status < 300) {\r\n        this.sendSignalOnOutput(\"success\");\r\n      } else {\r\n        this.sendSignalOnOutput(\"failure\");\r\n      }\r\n    },\r\n    doExternalFetch(request: Request) {\r\n      let url = request.resource;\r\n\r\n      if (Object.keys(request.parameters).length > 0) {\r\n        const parameters = Object.keys(request.parameters).map((p) => {\r\n          return p + \"=\" + encodeURIComponent(request.parameters[p]);\r\n        });\r\n        url += \"?\" + parameters.join(\"&\");\r\n      }\r\n\r\n      // @ts-expect-error\r\n      if (typeof _noodl_cloud_runtime_version === \"undefined\") {\r\n        const xhr = new XMLHttpRequest();\r\n        // @ts-expect-error\r\n        this._xhr = xhr;\r\n\r\n        xhr.open(request.method, url, true);\r\n        for (const header in request.headers) {\r\n          xhr.setRequestHeader(header, request.headers[header]);\r\n        }\r\n        xhr.onreadystatechange = () => {\r\n          let sentResponse = false;\r\n\r\n          if (xhr.readyState === 4) {\r\n            const statusCode = xhr.status;\r\n            const responseType = xhr.getResponseHeader(\"content-type\");\r\n            const rawResponse = xhr.response;\r\n            // @ts-expect-error\r\n            delete this._xhr;\r\n\r\n            if (responseType) {\r\n              // @ts-expect-error\r\n              responseType = responseType.toLowerCase();\r\n              const responseData =\r\n                responseType.indexOf(\"json\") !== -1\r\n                  ? JSON.parse(rawResponse)\r\n                  : rawResponse;\r\n\r\n              // @ts-expect-error\r\n              this.doResponse(statusCode, responseData, request);\r\n              sentResponse = true;\r\n            }\r\n\r\n            if (sentResponse === false) {\r\n              // @ts-expect-error\r\n              this.doResponse(statusCode, rawResponse, request);\r\n            }\r\n          }\r\n        };\r\n        xhr.onerror = () => {\r\n          // @ts-expect-error\r\n          delete this._xhr;\r\n          this.sendSignalOnOutput(\"failure\");\r\n        };\r\n\r\n        xhr.onabort = () => {\r\n          // @ts-expect-error\r\n          delete this._xhr;\r\n          this.sendSignalOnOutput(\"canceled\");\r\n        };\r\n\r\n        if (request.content) {\r\n          xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n          xhr.send(JSON.stringify(request.content));\r\n        } else {\r\n          xhr.send();\r\n        }\r\n      } else {\r\n        const headers = {\r\n          ...request.headers,\r\n          ...(request.content ? { \"Content-Type\": \"application/json\" } : {}),\r\n        };\r\n\r\n        fetch(url, {\r\n          method: request.method,\r\n          headers,\r\n          body: request.content ? JSON.stringify(request.content) : undefined,\r\n        })\r\n          .then((response) => {\r\n            const responseType = response.headers.get(\"content-type\");\r\n            if (responseType) {\r\n              if (responseType.indexOf(\"/json\") !== -1) {\r\n                response.json().then((json) => {\r\n                  // @ts-expect-error\r\n                  this.doResponse(response.status, json, request);\r\n                });\r\n              } else {\r\n                if (this.context.editorConnection) {\r\n                  this.context.editorConnection.sendWarning(\r\n                    this.nodeScope!.componentOwner.name,\r\n                    this.id,\r\n                    \"rest-run-waring-\",\r\n                    {\r\n                      message:\r\n                        \"REST only supports json content type in response.\",\r\n                    }\r\n                  );\r\n                }\r\n              }\r\n            } else {\r\n              response.text().then((raw) => {\r\n                // @ts-expect-error\r\n                this.doResponse(response.status, raw, request);\r\n              });\r\n            }\r\n          })\r\n          .catch((e) => {\r\n            console.log(\"REST: Failed to request\", url);\r\n            console.log(e);\r\n            this.sendSignalOnOutput(\"failure\");\r\n          });\r\n      }\r\n    },\r\n    doFetch() {\r\n      this._internal.hasScheduledFetch = false;\r\n\r\n      let resource = this._internal.resource;\r\n      if (resource) {\r\n        for (const key in this._internal.inputValues) {\r\n          resource = resource.replace(\r\n            \"{\" + key + \"}\",\r\n            this._internal.inputValues[key]\r\n          );\r\n        }\r\n      }\r\n\r\n      const request: Request = {\r\n        // @ts-expect-error\r\n        resource,\r\n        headers: {},\r\n        method:\r\n          this._internal.method !== undefined ? this._internal.method : \"GET\",\r\n        parameters: {},\r\n      };\r\n\r\n      if (this._internal.requestFunc) {\r\n        this._internal.requestFunc.apply(this._internal.self, [\r\n          this._internal.inputValues,\r\n          this._internal.outputValuesProxy,\r\n          request,\r\n        ]);\r\n      }\r\n\r\n      // @ts-expect-error\r\n      this.doExternalFetch(request);\r\n    },\r\n    cancelFetch() {\r\n      // @ts-expect-error\r\n      if (typeof _noodl_cloud_runtime_version === \"undefined\") {\r\n        // @ts-expect-error\r\n        this._xhr && this._xhr.abort();\r\n      } else {\r\n        if (this.context.editorConnection) {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"rest-run-waring-\",\r\n            {\r\n              message: \"REST doesn't support cancel in cloud functions.\",\r\n            }\r\n          );\r\n        }\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nfunction parseScriptForErrors(\r\n  script: string | undefined,\r\n  args: string[],\r\n  name: string,\r\n  node: any,\r\n  context: NodeContext,\r\n  ports: Port[]\r\n) {\r\n  if (!context.editorConnection) {\r\n    return;\r\n  }\r\n\r\n  context.editorConnection.clearWarning(\r\n    node.component.name,\r\n    node.id,\r\n    \"rest-run-waring-\" + name\r\n  );\r\n\r\n  if (script === undefined) {\r\n    context.editorConnection.clearWarning(\r\n      node.component.name,\r\n      node.id,\r\n      \"rest-parse-waring-\" + name\r\n    );\r\n    return;\r\n  }\r\n\r\n  try {\r\n    new Function(...args, script);\r\n    context.editorConnection.clearWarning(\r\n      node.component.name,\r\n      node.id,\r\n      \"rest-parse-waring-\" + name\r\n    );\r\n  } catch (e: any) {\r\n    context.editorConnection.sendWarning(\r\n      node.component.name,\r\n      node.id,\r\n      \"rest-parse-waring-\" + name,\r\n      {\r\n        message: \"<strong>\" + name + \"</strong>: \" + e.message,\r\n        showGlobally: true,\r\n      }\r\n    );\r\n  }\r\n\r\n  function exists(port: string): boolean {\r\n    return ports.find((p) => p.name === port) !== undefined;\r\n  }\r\n\r\n  const scriptWithoutComments = script.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g, \"\");\r\n  const inputs = scriptWithoutComments.match(/Inputs\\.[A-Za-z0-9]+/g);\r\n  if (inputs) {\r\n    const unique: Record<string, boolean> = {};\r\n    inputs.forEach((v) => {\r\n      unique[v.substring(\"Inputs.\".length)] = true;\r\n    });\r\n\r\n    Object.keys(unique).forEach((p) => {\r\n      if (exists(\"in-\" + p)) return;\r\n\r\n      ports.push({\r\n        name: \"in-\" + p,\r\n        displayName: p,\r\n        plug: \"input\",\r\n        type: \"*\",\r\n        group: \"Inputs\",\r\n      });\r\n    });\r\n  }\r\n\r\n  const outputs = scriptWithoutComments.match(/Outputs\\.[A-Za-z0-9]+/g);\r\n  if (outputs) {\r\n    const unique: Record<string, boolean> = {};\r\n    outputs.forEach((v) => {\r\n      unique[v.substring(\"Outputs.\".length)] = true;\r\n    });\r\n\r\n    Object.keys(unique).forEach((p) => {\r\n      if (exists(\"out-\" + p)) return;\r\n\r\n      ports.push({\r\n        name: \"out-\" + p,\r\n        displayName: p,\r\n        plug: \"output\",\r\n        type: \"*\",\r\n        group: \"Outputs\",\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (!context.editorConnection) {\r\n    return;\r\n  }\r\n\r\n  function managePortsForNode(node: any) {\r\n    function updatePorts() {\r\n      if (!node.parameters) {\r\n        return;\r\n      }\r\n\r\n      const ports: Port[] = [];\r\n      function exists(name: string): boolean {\r\n        for (let i = 0; i < ports.length; i++)\r\n          if (ports[i].name === name && ports[i].plug === \"input\") return true;\r\n        return false;\r\n      }\r\n\r\n      if (node.parameters.resource) {\r\n        const inputs = node.parameters.resource.match(/\\{[A-Za-z0-9_]*\\}/g);\r\n        if (inputs) {\r\n          for (const def of inputs) {\r\n            const name = def.replace(\"{\", \"\").replace(\"}\", \"\");\r\n            if (exists(\"in-\" + name)) continue;\r\n\r\n            ports.push({\r\n              name: \"in-\" + name,\r\n              displayName: name,\r\n              type: \"string\",\r\n              plug: \"input\",\r\n              group: \"Inputs\",\r\n            });\r\n          }\r\n        }\r\n      }\r\n\r\n      if (node.parameters[\"requestScript\"]) {\r\n        parseScriptForErrors(\r\n          node.parameters[\"requestScript\"],\r\n          [\"Inputs\", \"Outputs\", \"Request\"],\r\n          \"Request script\",\r\n          node,\r\n          context,\r\n          ports\r\n        );\r\n      }\r\n\r\n      if (node.parameters[\"responseScript\"]) {\r\n        parseScriptForErrors(\r\n          node.parameters[\"responseScript\"],\r\n          [\"Inputs\", \"Outputs\", \"Response\"],\r\n          \"Response script\",\r\n          node,\r\n          context,\r\n          ports\r\n        );\r\n      }\r\n\r\n      context.editorConnection!.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    updatePorts();\r\n    node.on(\"parameterUpdated\", () => {\r\n      updatePorts();\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.REST2\", (node: any) => {\r\n      managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"REST2\")) {\r\n      managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import difference from \"lodash.difference\";\r\nimport { NodeDefinition } from \"../../nodedefinition\";\r\nimport type { NodeContext } from \"../../nodecontext\";\r\nimport type { Node } from \"../../node\";\r\nimport type { EditorConnection } from \"../../editorconnection\";\r\nimport type { GraphModel } from \"../../models/graphmodel\";\r\nimport type { Event } from \"../../editormodeleventshandler\";\r\nimport type { NodeModel } from \"../../models/nodemodel\";\r\n\r\ninterface Internal {\r\n  scope: Record<string, any>;\r\n  hasScheduledEvaluation: boolean;\r\n  code?: string;\r\n  cachedValue: number;\r\n  currentExpression: string;\r\n  compiledFunction?: Function;\r\n  inputNames: string[];\r\n  inputValues: any[];\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Expression\",\r\n  docs: \"https://docs.noodl.net/nodes/math/expression\",\r\n  usePortAsLabel: \"expression\",\r\n  category: \"CustomCode\",\r\n  color: \"javascript\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"Expression\",\r\n  },\r\n  searchTags: [\"javascript\"],\r\n  initialize() {\r\n    const internal = this._internal;\r\n\r\n    internal.scope = {};\r\n    internal.hasScheduledEvaluation = false;\r\n\r\n    internal.code = undefined;\r\n    internal.cachedValue = 0;\r\n    internal.currentExpression = \"\";\r\n    internal.compiledFunction = undefined;\r\n    internal.inputNames = [];\r\n    internal.inputValues = [];\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.cachedValue;\r\n  },\r\n  inputs: {\r\n    expression: {\r\n      group: \"General\",\r\n      inputPriority: 1,\r\n      type: {\r\n        name: \"string\",\r\n        allowEditOnly: true,\r\n        codeeditor: \"javascript\",\r\n      },\r\n      displayName: \"Expression\",\r\n      set(value: string) {\r\n        const internal = this._internal;\r\n        internal.currentExpression =\r\n          functionPreamble + \"return (\" + value + \");\";\r\n        internal.compiledFunction = undefined;\r\n\r\n        const newInputs = parsePorts(value);\r\n\r\n        const inputsToAdd = difference(newInputs, internal.inputNames);\r\n        const inputsToRemove = difference(internal.inputNames, newInputs);\r\n\r\n        const self = this;\r\n        inputsToRemove.forEach(function (name: string) {\r\n          self.deregisterInput(name);\r\n          delete internal.scope[name];\r\n        });\r\n\r\n        inputsToAdd.forEach(function (name: string) {\r\n          if (self.hasInput(name)) {\r\n            return;\r\n          }\r\n\r\n          self.registerInput(name, {\r\n            set(value: any) {\r\n              internal.scope[name] = value;\r\n              if (!this.isInputConnected(\"run\")) {\r\n                // @ts-expect-error\r\n                this._scheduleEvaluateExpression();\r\n              }\r\n            },\r\n          });\r\n\r\n          internal.scope[name] = 0;\r\n          (self as any)._inputValues[name] = 0;\r\n        });\r\n\r\n        internal.inputNames = Object.keys(internal.scope);\r\n        if (!this.isInputConnected(\"run\"))\r\n          (this as any)._scheduleEvaluateExpression();\r\n      },\r\n    },\r\n    run: {\r\n      group: \"Actions\",\r\n      displayName: \"Run\",\r\n      type: \"signal\",\r\n      valueChangedToTrue() {\r\n        (this as any)._scheduleEvaluateExpression();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    result: {\r\n      group: \"Result\",\r\n      type: \"*\",\r\n      displayName: \"Result\",\r\n      getter() {\r\n        if (!this._internal.currentExpression) {\r\n          return 0;\r\n        }\r\n\r\n        return this._internal.cachedValue;\r\n      },\r\n    },\r\n    isTrue: {\r\n      group: \"Result\",\r\n      type: \"boolean\",\r\n      displayName: \"Is True\",\r\n      getter() {\r\n        if (!this._internal.currentExpression) {\r\n          return false;\r\n        }\r\n\r\n        return !!this._internal.cachedValue;\r\n      },\r\n    },\r\n    isFalse: {\r\n      group: \"Result\",\r\n      type: \"boolean\",\r\n      displayName: \"Is False\",\r\n      getter() {\r\n        if (!this._internal.currentExpression) {\r\n          return true;\r\n        }\r\n\r\n        return !this._internal.cachedValue;\r\n      },\r\n    },\r\n    isTrueEv: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"On True\",\r\n    },\r\n    isFalseEv: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"On False\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      this._internal.scope[name] = 0;\r\n      (this as any)._inputValues[name] = 0;\r\n\r\n      this.registerInput(name, {\r\n        set(value: any) {\r\n          this._internal.scope[name] = value;\r\n          if (!this.isInputConnected(\"run\"))\r\n            (this as any)._scheduleEvaluateExpression();\r\n        },\r\n      });\r\n    },\r\n    _scheduleEvaluateExpression() {\r\n      const internal = this._internal;\r\n      if (internal.hasScheduledEvaluation !== false) {\r\n        return;\r\n      }\r\n\r\n      internal.hasScheduledEvaluation = true;\r\n\r\n      this.flagDirty();\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        const lastValue = internal.cachedValue;\r\n        internal.cachedValue = (this as any)._calculateExpression();\r\n        if (lastValue !== internal.cachedValue) {\r\n          this.flagOutputDirty(\"result\");\r\n          this.flagOutputDirty(\"isTrue\");\r\n          this.flagOutputDirty(\"isFalse\");\r\n        }\r\n        if (internal.cachedValue) this.sendSignalOnOutput(\"isTrueEv\");\r\n        else this.sendSignalOnOutput(\"isFalseEv\");\r\n        internal.hasScheduledEvaluation = false;\r\n      });\r\n    },\r\n    _calculateExpression() {\r\n      const internal = this._internal;\r\n\r\n      if (!internal.compiledFunction) {\r\n        internal.compiledFunction = (this as any)._compileFunction();\r\n      }\r\n      for (let i = 0; i < internal.inputNames.length; ++i) {\r\n        const inputValue = internal.scope[internal.inputNames[i]];\r\n        internal.inputValues[i] = inputValue;\r\n      }\r\n      try {\r\n        if (!internal.compiledFunction) {\r\n          throw new Error(\"Compiled function is undefined\");\r\n        }\r\n        return internal.compiledFunction.apply(null, internal.inputValues);\r\n      } catch (e) {\r\n        if (e instanceof Error) {\r\n          console.error(\"Error in expression:\", e.message);\r\n        }\r\n      }\r\n      return undefined;\r\n    },\r\n    // @ts-expect-error\r\n    _compileFunction() {\r\n      const expression = this._internal.currentExpression;\r\n      const args = Object.keys(this._internal.scope);\r\n\r\n      const key = expression + args.join(\" \");\r\n\r\n      if (!compiledFunctionsCache[key]) {\r\n        args.push(expression);\r\n\r\n        try {\r\n          compiledFunctionsCache[key] = construct(Function, args);\r\n        } catch (e) {\r\n          if (e instanceof Error) {\r\n            console.error(\"Failed to compile JS function\", e.message);\r\n          }\r\n        }\r\n      }\r\n      return compiledFunctionsCache[key];\r\n    },\r\n  },\r\n};\r\n\r\nconst functionPreamble = [\r\n  \"var min = Math.min,\" +\r\n    \"    max = Math.max,\" +\r\n    \"    cos = Math.cos,\" +\r\n    \"    sin = Math.sin,\" +\r\n    \"    tan = Math.tan,\" +\r\n    \"    sqrt = Math.sqrt,\" +\r\n    \"    pi = Math.PI,\" +\r\n    \"    round = Math.round,\" +\r\n    \"    floor = Math.floor,\" +\r\n    \"    ceil = Math.ceil,\" +\r\n    \"    abs = Math.abs,\" +\r\n    \"    random = Math.random;\",\r\n].join(\"\");\r\n\r\nfunction construct(\r\n  constructor: Function,\r\n  args: any[]\r\n): (this: Node<Internal>, ...args: any[]) => void {\r\n  function F(this: any) {\r\n    return constructor.apply(this, args);\r\n  }\r\n  F.prototype = constructor.prototype;\r\n  // @ts-expect-error\r\n  return new F();\r\n}\r\n\r\nconst compiledFunctionsCache: Record<\r\n  string,\r\n  (this: Node<Internal>, ...args: any[]) => void\r\n> = {};\r\n\r\nconst portsToIgnore = [\r\n  \"min\",\r\n  \"max\",\r\n  \"cos\",\r\n  \"sin\",\r\n  \"tan\",\r\n  \"sqrt\",\r\n  \"pi\",\r\n  \"round\",\r\n  \"floor\",\r\n  \"ceil\",\r\n  \"abs\",\r\n  \"random\",\r\n  \"Math\",\r\n  \"window\",\r\n  \"document\",\r\n  \"undefined\",\r\n  \"Vars\",\r\n  \"true\",\r\n  \"false\",\r\n  \"null\",\r\n  \"Boolean\",\r\n];\r\n\r\nfunction parsePorts(expression: string): string[] {\r\n  const ports: string[] = [];\r\n\r\n  function addPort(name: string): void {\r\n    if (portsToIgnore.indexOf(name) !== -1) return;\r\n    if (ports.some((p) => p === name)) return;\r\n\r\n    ports.push(name);\r\n  }\r\n\r\n  // First remove all strings\r\n  expression = expression\r\n    .replace(/\\\"([^\\\"]*)\\\"/g, \"\")\r\n    .replace(/\\'([^\\']*)\\'/g, \"\");\r\n\r\n  // Extract identifiers\r\n  const identifiers = expression.matchAll(/[a-zA-Z\\_\\$][a-zA-Z0-9\\.\\_\\$]*/g);\r\n  for (const _id of identifiers) {\r\n    let name = _id[0];\r\n    if (name.indexOf(\".\") !== -1) {\r\n      name = name.split(\".\")[0]; // Take first symbol on \".\" sequence\r\n    }\r\n\r\n    addPort(name);\r\n  }\r\n\r\n  return ports;\r\n}\r\n\r\nfunction updatePorts(\r\n  nodeId: string,\r\n  expression: string,\r\n  editorConnection: EditorConnection\r\n): void {\r\n  const portNames = parsePorts(expression);\r\n\r\n  const ports = portNames.map((name) => ({\r\n    group: \"Parameters\",\r\n    name,\r\n    type: {\r\n      name: \"*\",\r\n      editAsType: \"string\",\r\n    },\r\n    plug: \"input\",\r\n  }));\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nfunction evalCompileWarnings(\r\n  editorConnection: EditorConnection,\r\n  node: NodeModel\r\n): void {\r\n  try {\r\n    new Function(node.parameters.expression);\r\n    editorConnection.clearWarning(\r\n      node.component!.name,\r\n      node.id,\r\n      \"expression-compile-error\"\r\n    );\r\n  } catch (e) {\r\n    if (e instanceof Error) {\r\n      editorConnection.sendWarning(\r\n        node.component!.name,\r\n        node.id,\r\n        \"expression-compile-error\",\r\n        {\r\n          message: e.message,\r\n        }\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport function setup(\r\n  context: { editorConnection?: EditorConnection },\r\n  graphModel: GraphModel\r\n): void {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  graphModel.on(\"nodeAdded.Expression\", (node) => {\r\n    if (node.parameters.expression) {\r\n      updatePorts(\r\n        node.id,\r\n        node.parameters.expression,\r\n        context.editorConnection!\r\n      );\r\n      evalCompileWarnings(context.editorConnection!, node);\r\n    }\r\n    node.on(\"parameterUpdated\", (event: Event) => {\r\n      if (event.name === \"expression\") {\r\n        updatePorts(\r\n          node.id,\r\n          node.parameters.expression,\r\n          context.editorConnection!\r\n        );\r\n        evalCompileWarnings(context.editorConnection!, node);\r\n      }\r\n    });\r\n  });\r\n}\r\n","import { Model } from \"./model\";\r\nimport { Port, PortType } from \"./models/componentmodel\";\r\nimport { getAbsoluteUrl } from \"./utils\";\r\n\r\ninterface UserObject {\r\n  inputs?: Record<string, any>;\r\n  outputs?: Record<string, any>;\r\n  setup?: Function;\r\n  run?: Function;\r\n  change?: Function;\r\n  destroy?: Function;\r\n  methods?: Record<string, Function>;\r\n  signals?: Record<string, Function>;\r\n  changed?: Record<string, Function>;\r\n}\r\n\r\ninterface NodeAPI {\r\n  Inputs: Record<string, any>;\r\n  Outputs: Record<string, any>;\r\n  Signals: Record<string, Function>;\r\n  Setters: Record<string, Function>;\r\n  OnInit?: Function;\r\n  OnDestroy?: Function;\r\n  OnInputsChanged?: Function;\r\n  setOutputs?: (outputs: Record<string, any>) => void;\r\n}\r\n\r\ninterface ParserOptions {\r\n  node?: any;\r\n}\r\n\r\ninterface PortOptions {\r\n  skipInputs?: boolean;\r\n  skipOutputs?: boolean;\r\n  skipOutputSignals?: boolean;\r\n  skipRegularOutputs?: boolean;\r\n  inputType?: PortType;\r\n  inputGroup?: string;\r\n  inputPrefix?: string;\r\n  outputPrefix?: string;\r\n}\r\n\r\nconst userFunctionsCache: Record<string, Function> = {};\r\n\r\nexport class JavascriptNodeParser {\r\n  inputs: Record<string, any>;\r\n  outputs: Record<string, any>;\r\n  error?: string;\r\n  code: string;\r\n  // @ts-ignore\r\n  apis: {\r\n    Node: NodeAPI;\r\n  };\r\n  setup?: Function;\r\n  change?: Function;\r\n  destroy?: Function;\r\n  definedObject?: any;\r\n\r\n  constructor(code: string, options?: ParserOptions) {\r\n    this.inputs = {};\r\n    this.outputs = {};\r\n    this.code = code;\r\n\r\n    const node = options ? options.node : undefined;\r\n    this._initializeAPIs();\r\n\r\n    let userCode = userFunctionsCache[code];\r\n    if (!userCode) {\r\n      try {\r\n        userCode = new Function(\r\n          // @ts-ignore\r\n          [\"define\", \"script\", \"Node\", \"Component\"],\r\n          JavascriptNodeParser.getCodePrefix() + code\r\n        );\r\n        userFunctionsCache[code] = userCode;\r\n      } catch (e: unknown) {\r\n        this.error = e instanceof Error ? e.message : String(e);\r\n        console.error(e);\r\n      }\r\n    }\r\n    if (userCode) {\r\n      try {\r\n        userCode(\r\n          this.define.bind(this),\r\n          this.script.bind(this),\r\n          // @ts-expect-error\r\n          this.apis.Node,\r\n          node ? JavascriptNodeParser.getComponentScopeForNode(node) : {}\r\n        );\r\n\r\n        this._afterSourced();\r\n      } catch (e: unknown) {\r\n        this.error = e instanceof Error ? e.message : String(e);\r\n        console.error(e);\r\n      }\r\n    }\r\n  }\r\n\r\n  define(userObject: UserObject): void {\r\n    this.inputs = userObject.inputs || {};\r\n    this.outputs = userObject.outputs || {};\r\n    this.setup = userObject.setup;\r\n    this.change = userObject.run || userObject.change;\r\n    this.destroy = userObject.destroy;\r\n\r\n    this.definedObject = userObject;\r\n  }\r\n\r\n  script(userObject: UserObject): void {\r\n    const _userObjectExtended = _scriptExtend(userObject);\r\n    this.inputs = _userObjectExtended.inputs || {};\r\n    this.outputs = _userObjectExtended.outputs || {};\r\n    this.setup = _userObjectExtended.setup;\r\n    this.change = _userObjectExtended.run || _userObjectExtended.change;\r\n    this.destroy = _userObjectExtended.destroy;\r\n\r\n    this.definedObject = _userObjectExtended;\r\n  }\r\n\r\n  _initializeAPIs(): void {\r\n    this.apis = {\r\n      Node: {\r\n        Inputs: {},\r\n        Outputs: {},\r\n        Signals: {},\r\n        Setters: {},\r\n      },\r\n    };\r\n  }\r\n\r\n  _afterSourced(): void {\r\n    if (this.definedObject !== undefined) return;\r\n\r\n    const _Node = this.apis.Node;\r\n\r\n    this.inputs = Object.assign({}, _Node.Inputs || {});\r\n    this.outputs = Object.assign({}, _Node.Outputs || {});\r\n\r\n    this.setup = function (\r\n      inputs: Record<string, any>,\r\n      outputs: Record<string, any>\r\n    ) {\r\n      const _this = this;\r\n\r\n      _Node.setOutputs = function (_outputs: Record<string, any>) {\r\n        for (const key in _outputs) {\r\n          outputs[key] = _outputs[key];\r\n          // @ts-ignore\r\n          _this.flagOutputDirty(key);\r\n        }\r\n      };\r\n\r\n      _Node.OnInit && _Node.OnInit.apply(this);\r\n    };\r\n\r\n    this.destroy = _Node.OnDestroy || this.destroy;\r\n    this.change = (\r\n      inputs: Record<string, any>,\r\n      outputs: Record<string, any>,\r\n      changedInputs: Record<string, any>\r\n    ) => {\r\n      for (const key in changedInputs) {\r\n        if (typeof _Node.Setters[key] === \"function\") {\r\n          _Node.Setters[key](inputs[key]);\r\n        }\r\n      }\r\n\r\n      if (typeof _Node.OnInputsChanged === \"function\") {\r\n        _Node.OnInputsChanged();\r\n      }\r\n    };\r\n\r\n    this.definedObject = {\r\n      inputs: this.inputs,\r\n      outputs: this.outputs,\r\n      setup: this.setup,\r\n      destroy: this.destroy,\r\n      change: this.change,\r\n    };\r\n\r\n    if (_Node.Signals !== undefined) {\r\n      for (const key in _Node.Signals) {\r\n        if (typeof _Node.Signals[key] === \"function\") {\r\n          this.inputs[key] = \"signal\";\r\n          this.definedObject[key] = _Node.Signals[key];\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  getPorts(): Port[] {\r\n    const ports: Port[] = [];\r\n\r\n    Object.keys(this.inputs).forEach((name) => {\r\n      const inputPort = this.inputs[name];\r\n\r\n      const port: Port = {\r\n        name,\r\n        plug: \"input\",\r\n        type: undefined,\r\n        group: \"Inputs\",\r\n      };\r\n\r\n      if (typeof inputPort === \"string\") {\r\n        port.type = {\r\n          name: inputPort,\r\n        };\r\n      } else {\r\n        Object.assign(port, inputPort);\r\n      }\r\n\r\n      ports.push(port);\r\n    });\r\n\r\n    Object.keys(this.outputs).forEach((name) => {\r\n      ports.push({\r\n        name,\r\n        type: {\r\n          name: this.outputs[name],\r\n        },\r\n        plug: \"output\",\r\n        group: \"Outputs\",\r\n      });\r\n    });\r\n\r\n    JavascriptNodeParser.parseAndAddPortsFromScript(this.code, ports, {});\r\n\r\n    return ports;\r\n  }\r\n\r\n  static createFromCode(\r\n    code: string,\r\n    options?: ParserOptions\r\n  ): JavascriptNodeParser {\r\n    return new JavascriptNodeParser(code, options);\r\n  }\r\n\r\n  static createFromURL(\r\n    url: string,\r\n    callback: (parser: JavascriptNodeParser) => void,\r\n    options?: ParserOptions\r\n  ): void {\r\n    url = getAbsoluteUrl(url);\r\n\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open(\"GET\", url, true);\r\n    xhr.onreadystatechange = function () {\r\n      if (this.readyState === 4 || this.readyState === XMLHttpRequest.DONE) {\r\n        callback(new JavascriptNodeParser(this.response));\r\n      }\r\n    };\r\n    xhr.onerror = function () {\r\n      console.log(\"Failed to request\", url);\r\n    };\r\n    xhr.send();\r\n  }\r\n\r\n  static parseAndAddPortsFromScript(\r\n    script: string,\r\n    ports: Port[],\r\n    options: PortOptions\r\n  ): void {\r\n    function _exists(port: string | { name: string; plug: string }): boolean {\r\n      if (typeof port === \"string\")\r\n        return ports.find((p) => p.name === port) !== undefined;\r\n      else\r\n        return (\r\n          ports.find((p) => p.name === port.name && p.plug === port.plug) !==\r\n          undefined\r\n        );\r\n    }\r\n\r\n    function _addPortsFromMatch(\r\n      match: IterableIterator<RegExpMatchArray>,\r\n      options: {\r\n        type: PortType;\r\n        plug: Port[\"plug\"];\r\n        group: string;\r\n        prefix: string;\r\n      }\r\n    ): void {\r\n      if (match === undefined || match === null) return;\r\n\r\n      const unique: Record<string, boolean> = {};\r\n      for (const _s of match) {\r\n        let name = _s[1];\r\n        if (name === undefined) continue;\r\n\r\n        unique[name] = true;\r\n      }\r\n\r\n      Object.keys(unique).forEach((p) => {\r\n        if (\r\n          _exists({\r\n            name: options.prefix + p,\r\n            plug: options.plug,\r\n          })\r\n        )\r\n          return;\r\n\r\n        ports.push({\r\n          name: options.prefix + p,\r\n          displayName: p,\r\n          plug: options.plug,\r\n          type: options.type,\r\n          group: options.group,\r\n        });\r\n      });\r\n    }\r\n\r\n    if (!options.skipInputs) {\r\n      _addPortsFromMatch(script.matchAll(/Inputs\\.([A-Za-z0-9_]+)/g), {\r\n        type: options.inputType || \"*\",\r\n        plug: \"input\",\r\n        group: options.inputGroup || \"Inputs\",\r\n        prefix: options.inputPrefix || \"\",\r\n      });\r\n\r\n      _addPortsFromMatch(\r\n        script.matchAll(/Inputs\\s*\\[\\s*(?:'|\")(.*)(?:'|\")\\s*\\]/g),\r\n        {\r\n          type: options.inputType || \"*\",\r\n          plug: \"input\",\r\n          group: options.inputGroup || \"Inputs\",\r\n          prefix: options.inputPrefix || \"\",\r\n        }\r\n      );\r\n    }\r\n\r\n    if (!options.skipOutputs) {\r\n      if (!options.skipOutputSignals) {\r\n        _addPortsFromMatch(\r\n          script.matchAll(/Outputs\\.([A-Za-z0-9]+)\\s*\\(\\s*\\)/g),\r\n          {\r\n            type: \"signal\",\r\n            plug: \"output\",\r\n            group: \"Outputs\",\r\n            prefix: options.outputPrefix || \"\",\r\n          }\r\n        );\r\n\r\n        _addPortsFromMatch(\r\n          script.matchAll(/Outputs\\s*\\[\\s*(?:'|\")(.*)(?:'|\")\\s*\\]\\(\\s*\\)/g),\r\n          {\r\n            type: \"signal\",\r\n            plug: \"output\",\r\n            group: \"Outputs\",\r\n            prefix: options.outputPrefix || \"\",\r\n          }\r\n        );\r\n      }\r\n\r\n      if (!options.skipRegularOutputs) {\r\n        _addPortsFromMatch(script.matchAll(/Outputs\\.([A-Za-z0-9_]+)/g), {\r\n          type: \"*\",\r\n          plug: \"output\",\r\n          group: \"Outputs\",\r\n          prefix: options.outputPrefix || \"\",\r\n        });\r\n\r\n        _addPortsFromMatch(\r\n          script.matchAll(/Outputs\\s*\\[\\s*\\\"([^\\\"]*)\\\"\\s*\\]/g),\r\n          {\r\n            type: \"*\",\r\n            plug: \"output\",\r\n            group: \"Outputs\",\r\n            prefix: options.outputPrefix || \"\",\r\n          }\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  static getCodePrefix(): string {\r\n    return \"const Script = (typeof Node !== 'undefined')?Node:undefined;\\n\";\r\n  }\r\n\r\n  static createNoodlAPI(): any {\r\n    return typeof window !== \"undefined\" && (window as any).Noodl !== undefined\r\n      ? (window as any).Noodl\r\n      : {};\r\n  }\r\n\r\n  static getComponentScopeForNode(node: any): any {\r\n    const componentId = node.nodeScope.componentOwner.getInstanceId();\r\n\r\n    if (_componentScopes[componentId] === undefined) {\r\n      _componentScopes[componentId] = {};\r\n\r\n      const componentObject = (node.nodeScope.modelScope || Model).get(\r\n        \"componentState\" + componentId\r\n      );\r\n\r\n      _componentScopes[componentId].Object = componentObject;\r\n    }\r\n\r\n    const parentComponentObjectId = _findParentComponentStateModelId(node);\r\n    const parentComponentObject =\r\n      parentComponentObjectId !== undefined\r\n        ? (node.nodeScope.modelScope || Model).get(parentComponentObjectId)\r\n        : undefined;\r\n\r\n    _componentScopes[componentId].ParentObject = parentComponentObject;\r\n\r\n    _componentScopes[componentId].RepeaterObject = _findForEachModel(node);\r\n\r\n    return _componentScopes[componentId];\r\n  }\r\n}\r\n\r\nfunction _scriptExtend(userObject: UserObject): any {\r\n  const _extended = {\r\n    inputs: userObject.inputs || {},\r\n    outputs: userObject.outputs || {},\r\n\r\n    setup: function (\r\n      inputs: Record<string, any>,\r\n      outputs: Record<string, any>\r\n    ) {\r\n      this.inputs = inputs;\r\n      this.outputs = outputs;\r\n\r\n      // @ts-expect-error\r\n      this.setOutputs = function (states: Record<string, any>) {\r\n        for (const key in states) {\r\n          this.outputs[key] = states[key];\r\n          // @ts-ignore\r\n          this.flagOutputDirty(key);\r\n        }\r\n      };\r\n\r\n      if (userObject.methods) {\r\n        for (const key in userObject.methods) {\r\n          // @ts-ignore\r\n          this[key] = userObject.methods[key];\r\n        }\r\n      }\r\n\r\n      userObject.setup && userObject.setup.apply(this);\r\n    },\r\n\r\n    destroy: function (\r\n      inputs: Record<string, any>,\r\n      outputs: Record<string, any>\r\n    ) {\r\n      this.inputs = inputs;\r\n      this.outputs = outputs;\r\n\r\n      userObject.destroy && userObject.destroy.apply(this);\r\n    },\r\n\r\n    change: function (\r\n      inputs: Record<string, any>,\r\n      outputs: Record<string, any>\r\n    ) {\r\n      this.inputs = inputs;\r\n      this.outputs = outputs;\r\n\r\n      // @ts-ignore\r\n      const old = this._oldInputs || {};\r\n\r\n      if (userObject.changed) {\r\n        for (const key in inputs) {\r\n          if (inputs[key] !== old[key]) {\r\n            const changedFunction = userObject.changed[key];\r\n            if (typeof changedFunction === \"function\")\r\n              changedFunction.apply(this, [inputs[key], old[key]]);\r\n          }\r\n        }\r\n      }\r\n\r\n      // @ts-ignore\r\n      this._oldInputs = Object.assign({}, inputs);\r\n    },\r\n  };\r\n\r\n  if (userObject.signals) {\r\n    for (const key in userObject.signals) {\r\n      // @ts-ignore\r\n      _extended[key] = userObject.signals[key];\r\n      _extended.inputs[key] = \"signal\";\r\n    }\r\n  }\r\n\r\n  return _extended;\r\n}\r\n\r\nconst _componentScopes: Record<string, any> = {};\r\n\r\nfunction _findParentComponentStateModelId(node: any): string | undefined {\r\n  function getParentComponent(component: any): any {\r\n    let parent;\r\n    if (component.getRoots().length > 0) {\r\n      const root = component.getRoots()[0];\r\n\r\n      if (root.getVisualParentNode) {\r\n        if (root.getVisualParentNode()) {\r\n          parent = root.getVisualParentNode().nodeScope.componentOwner;\r\n        }\r\n      } else if (root.parentNodeScope) {\r\n        parent = component.parentNodeScope.componentOwner;\r\n      }\r\n    } else if (component.parentNodeScope) {\r\n      parent = component.parentNodeScope.componentOwner;\r\n    }\r\n\r\n    if (\r\n      parent &&\r\n      parent.nodeScope &&\r\n      parent.nodeScope.componentOwner !== component\r\n    ) {\r\n      if (\r\n        parent.nodeScope.getNodesWithType(\"net.noodl.ComponentObject\").length >\r\n        0\r\n      ) {\r\n        return parent;\r\n      }\r\n\r\n      if (parent.nodeScope.getNodesWithType(\"Component State\").length > 0) {\r\n        return parent;\r\n      }\r\n\r\n      return getParentComponent(parent);\r\n    }\r\n  }\r\n\r\n  const parent = getParentComponent(node.nodeScope.componentOwner);\r\n  if (!parent) return;\r\n\r\n  return \"componentState\" + parent.getInstanceId();\r\n}\r\n\r\nfunction _findForEachModel(node: any): any {\r\n  let component = node.nodeScope.componentOwner;\r\n  while (\r\n    component !== undefined &&\r\n    component._forEachModel === undefined &&\r\n    component.parentNodeScope\r\n  ) {\r\n    component = component.parentNodeScope.componentOwner;\r\n  }\r\n  return component !== undefined ? component._forEachModel : undefined;\r\n}\r\n","import { JavascriptNodeParser } from \"../../javascriptnodeparser\";\r\nimport { Port } from \"../../models/componentmodel\";\r\nimport { GraphModel } from \"../../models/graphmodel\";\r\nimport { NodeContext } from \"../../nodecontext\";\r\nimport { NodeDefinition } from \"../../nodedefinition\";\r\nimport { logJavaScriptNodeError } from \"../../utils\";\r\n\r\ninterface InputValues {\r\n  [key: string]: any;\r\n}\r\n\r\ninterface OutputValues {\r\n  [key: string]: any;\r\n}\r\n\r\ninterface Internal {\r\n  inputValues: InputValues;\r\n  outputValues: OutputValues;\r\n  outputValuesProxy: OutputValues;\r\n  _this: any;\r\n  func?: Function;\r\n  inputTypes: { [key: string]: string };\r\n  outputTypes: { [key: string]: string };\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"JavaScriptFunction\",\r\n  displayNodeName: \"Function\",\r\n  docs: \"https://docs.noodl.net/nodes/javascript/function\",\r\n  category: \"CustomCode\",\r\n  color: \"javascript\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"Script\",\r\n  },\r\n  searchTags: [\"javascript\"],\r\n  exportDynamicPorts: true,\r\n  initialize: function (this: any) {\r\n    this._internal = {}; // TODO: Is this needed?\r\n    this._internal.inputValues = {};\r\n    this._internal.outputValues = {};\r\n    this._internal.inputTypes = {};\r\n    this._internal.outputTypes = {};\r\n\r\n    this._internal.outputValuesProxy = new Proxy(this._internal.outputValues, {\r\n      set: (obj: OutputValues, prop: string, value: any) => {\r\n        //a function node can continue running after it has been deleted. E.g. with timeouts or event listeners that hasn't been removed.\r\n        //if the node is deleted, just do nothing\r\n        if (this._deleted) {\r\n          return true;\r\n        }\r\n\r\n        //only send outputs when they change.\r\n        //Some Noodl projects rely on this behavior, so changing it breaks backwards compability\r\n        if (value !== this._internal.outputValues[prop]) {\r\n          this.registerOutputIfNeeded(\"out-\" + prop);\r\n\r\n          this._internal.outputValues[prop] = value;\r\n          this.flagOutputDirty(\"out-\" + prop);\r\n        }\r\n        return true;\r\n      },\r\n    });\r\n\r\n    this._internal._this = {};\r\n  },\r\n  getInspectInfo() {\r\n    return [\r\n      {\r\n        type: \"value\",\r\n        value: {\r\n          inputs: this._internal.inputValues,\r\n          outputs: this._internal.outputValues,\r\n        },\r\n      },\r\n    ];\r\n  },\r\n  inputs: {\r\n    scriptInputs: {\r\n      type: {\r\n        name: \"proplist\",\r\n        allowEditOnly: true,\r\n      },\r\n      group: \"Script Inputs\",\r\n      set(value: any) {\r\n        //  ignore\r\n      },\r\n    },\r\n    scriptOutputs: {\r\n      type: {\r\n        name: \"proplist\",\r\n        allowEditOnly: true,\r\n      },\r\n      group: \"Script Outputs\",\r\n      set(value: any) {\r\n        //  ignore\r\n      },\r\n    },\r\n    functionScript: {\r\n      displayName: \"Script\",\r\n      // @ts-expect-error TODO: What is this... ???\r\n      plug: \"input\",\r\n      type: {\r\n        name: \"string\",\r\n        allowEditOnly: true,\r\n        codeeditor: \"javascript\",\r\n      },\r\n      group: \"General\",\r\n      set(this: any, script?: string) {\r\n        if (script === undefined) {\r\n          this._internal.func = undefined;\r\n          return;\r\n        }\r\n\r\n        this._internal.func = this.parseScript(script);\r\n\r\n        if (!this.isInputConnected(\"run\")) this.scheduleRun();\r\n      },\r\n    },\r\n    run: {\r\n      type: \"signal\",\r\n      displayName: \"Run\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue: function (this: any) {\r\n        this.scheduleRun();\r\n      },\r\n    },\r\n  },\r\n  outputs: {},\r\n  methods: {\r\n    scheduleRun() {\r\n      // @ts-expect-error\r\n      if (this.runScheduled) return;\r\n      // @ts-expect-error\r\n      this.runScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.runScheduled = false;\r\n\r\n        if (!this._deleted) {\r\n          // @ts-expect-error\r\n          this.runScript();\r\n        }\r\n      });\r\n    },\r\n    async runScript() {\r\n      const func = this._internal.func;\r\n\r\n      if (func === undefined) return;\r\n\r\n      const inputs = this._internal.inputValues;\r\n      const outputs = this._internal.outputValuesProxy;\r\n\r\n      // Prepare send signal functions\r\n      for (const key in this.model!.outputPorts) {\r\n        // @ts-expect-error\r\n        if (this._isSignalType(key)) {\r\n          const _sendSignal = () => {\r\n            if (this.hasOutput(key)) this.sendSignalOnOutput(key);\r\n          };\r\n          this._internal.outputValues[key.substring(\"out-\".length)] =\r\n            _sendSignal;\r\n          this._internal.outputValues[key.substring(\"out-\".length)].send =\r\n            _sendSignal;\r\n        }\r\n      }\r\n\r\n      try {\r\n        await func.apply(this._internal._this, [\r\n          inputs,\r\n          outputs,\r\n          // @ts-expect-error\r\n          JavascriptNodeParser.createNoodlAPI(this.nodeScope!.modelScope),\r\n          JavascriptNodeParser.getComponentScopeForNode(this),\r\n        ]);\r\n      } catch (e: any) {\r\n        logJavaScriptNodeError(e);\r\n\r\n        if (\r\n          this.context.editorConnection &&\r\n          this.context.isWarningTypeEnabled(\"javascriptExecution\")\r\n        ) {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"js-function-run-waring\",\r\n            {\r\n              showGlobally: true,\r\n              message: e.message,\r\n              stack: e.stack,\r\n            }\r\n          );\r\n        }\r\n      }\r\n    },\r\n    setScriptInputValue(name: string, value: any) {\r\n      this._internal.inputValues[name] = value;\r\n\r\n      if (!this.isInputConnected(\"run\")) {\r\n        // @ts-expect-error\r\n        this.scheduleRun();\r\n      }\r\n    },\r\n    getScriptOutputValue(name: string) {\r\n      // @ts-expect-error\r\n      if (this._isSignalType(name)) {\r\n        return undefined;\r\n      }\r\n      return this._internal.outputValues[name];\r\n    },\r\n    setScriptInputType(name: string, type: string) {\r\n      this._internal.inputTypes[name] = type;\r\n    },\r\n    setScriptOutputType(name: string, type: string) {\r\n      this._internal.outputTypes[name] = type;\r\n    },\r\n    parseScript(script: string) {\r\n      let func;\r\n      try {\r\n        const AsyncFunction = Object.getPrototypeOf(\r\n          async function () {}\r\n        ).constructor;\r\n        func = new AsyncFunction(\r\n          \"Inputs\",\r\n          \"Outputs\",\r\n          \"Noodl\",\r\n          \"Component\",\r\n          JavascriptNodeParser.getCodePrefix() + script\r\n        );\r\n      } catch (e) {\r\n        console.log(\"Error while parsing action script: \" + e);\r\n      }\r\n\r\n      return func;\r\n    },\r\n    _isSignalType(name: string): boolean {\r\n      // This will catch signals in script that may not have been delivered by the editor yet\r\n      return (\r\n        this.model!.outputPorts[name] &&\r\n        // @ts-expect-error\r\n        this.model.outputPorts[name].type === \"signal\"\r\n      );\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"in-\")) {\r\n        const n = name.substring(\"in-\".length);\r\n\r\n        const input = {\r\n          // @ts-expect-error\r\n          set: this.setScriptInputValue.bind(this, n),\r\n        };\r\n\r\n        //make sure we register the type as well, so Noodl resolves types like color styles to an actual color\r\n        if (this.model && this.model.parameters[\"intype-\" + n]) {\r\n          // @ts-expect-error\r\n          input.type = this.model.parameters[\"intype-\" + n];\r\n        }\r\n\r\n        this.registerInput(name, input);\r\n      }\r\n\r\n      if (name.startsWith(\"intype-\")) {\r\n        const n = name.substring(\"intype-\".length);\r\n\r\n        this.registerInput(name, {\r\n          set(value: any) {\r\n            //make sure we register the type as well, so Noodl resolves types like color styles to an actual color\r\n            if (this.hasInput(\"in\" + n)) {\r\n              // @ts-expect-error\r\n              this.getInput(\"in\" + n).type = value;\r\n            }\r\n          },\r\n        });\r\n      }\r\n\r\n      if (name.startsWith(\"outtype-\")) {\r\n        this.registerInput(name, {\r\n          set() {}, // Ignore\r\n        });\r\n      }\r\n    },\r\n    registerOutputIfNeeded(name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"out-\"))\r\n        return this.registerOutput(name, {\r\n          // @ts-expect-error\r\n          getter: this.getScriptOutputValue.bind(\r\n            this,\r\n            name.substring(\"out-\".length)\r\n          ),\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\nfunction _parseScriptForErrorsAndPorts(\r\n  script: string | undefined,\r\n  name: string,\r\n  node: any,\r\n  context: any,\r\n  ports: Port[]\r\n) {\r\n  // Clear run warnings if the script is edited\r\n  context.editorConnection.clearWarning(\r\n    node.component.name,\r\n    node.id,\r\n    \"js-function-run-waring\"\r\n  );\r\n\r\n  if (script === undefined) {\r\n    context.editorConnection.clearWarning(\r\n      node.component.name,\r\n      node.id,\r\n      \"js-function-parse-waring\"\r\n    );\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const AsyncFunction = Object.getPrototypeOf(\r\n      async function () {}\r\n    ).constructor;\r\n    new AsyncFunction(\"Inputs\", \"Outputs\", \"Noodl\", \"Component\", script);\r\n\r\n    context.editorConnection.clearWarning(\r\n      node.component.name,\r\n      node.id,\r\n      \"js-function-parse-waring\"\r\n    );\r\n  } catch (e: any) {\r\n    context.editorConnection.sendWarning(\r\n      node.component.name,\r\n      node.id,\r\n      \"js-function-parse-waring\",\r\n      {\r\n        showGlobally: true,\r\n        message: e.message,\r\n      }\r\n    );\r\n  }\r\n\r\n  JavascriptNodeParser.parseAndAddPortsFromScript(script, ports, {\r\n    inputPrefix: \"in-\",\r\n    outputPrefix: \"out-\",\r\n  });\r\n}\r\n\r\nconst inputTypeEnums = [\r\n  {\r\n    value: \"string\",\r\n    label: \"String\",\r\n  },\r\n  {\r\n    value: \"boolean\",\r\n    label: \"Boolean\",\r\n  },\r\n  {\r\n    value: \"number\",\r\n    label: \"Number\",\r\n  },\r\n  {\r\n    value: \"object\",\r\n    label: \"Object\",\r\n  },\r\n  {\r\n    value: \"date\",\r\n    label: \"Date\",\r\n  },\r\n  {\r\n    value: \"array\",\r\n    label: \"Array\",\r\n  },\r\n  {\r\n    value: \"color\",\r\n    label: \"Color\",\r\n  },\r\n];\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    function _updatePorts() {\r\n      const ports: Port[] = [];\r\n\r\n      const _outputTypeEnums = inputTypeEnums.concat([\r\n        {\r\n          value: \"signal\",\r\n          label: \"Signal\",\r\n        },\r\n      ]);\r\n\r\n      // Outputs\r\n      if (\r\n        node.parameters[\"scriptOutputs\"] !== undefined &&\r\n        node.parameters[\"scriptOutputs\"].length > 0\r\n      ) {\r\n        node.parameters[\"scriptOutputs\"].forEach(\r\n          (p: { label: string; id: string }) => {\r\n            // Type for output\r\n            ports.push({\r\n              name: \"outtype-\" + p.label,\r\n              displayName: \"Type\",\r\n              editorName: p.label + \" | Type\",\r\n              plug: \"input\",\r\n              type: {\r\n                name: \"enum\",\r\n                enums: _outputTypeEnums,\r\n                allowEditOnly: true,\r\n              },\r\n              default: \"string\",\r\n              parent: \"scriptOutputs\",\r\n              parentItemId: p.id,\r\n            });\r\n\r\n            // Value for output\r\n            ports.push({\r\n              name: \"out-\" + p.label,\r\n              displayName: p.label,\r\n              plug: \"output\",\r\n              type: node.parameters[\"outtype-\" + p.label] || \"*\",\r\n              group: \"Outputs\",\r\n            });\r\n          }\r\n        );\r\n      }\r\n\r\n      // Inputs\r\n      if (\r\n        node.parameters[\"scriptInputs\"] !== undefined &&\r\n        node.parameters[\"scriptInputs\"].length > 0\r\n      ) {\r\n        node.parameters[\"scriptInputs\"].forEach(\r\n          (p: { label: string; id: string }) => {\r\n            // Type for input\r\n            ports.push({\r\n              name: \"intype-\" + p.label,\r\n              displayName: \"Type\",\r\n              editorName: p.label + \" | Type\",\r\n              plug: \"input\",\r\n              type: {\r\n                name: \"enum\",\r\n                enums: inputTypeEnums,\r\n                allowEditOnly: true,\r\n              },\r\n              default: \"string\",\r\n              parent: \"scriptInputs\",\r\n              parentItemId: p.id,\r\n            });\r\n\r\n            // Default Value for input\r\n            ports.push({\r\n              name: \"in-\" + p.label,\r\n              displayName: p.label,\r\n              plug: \"input\",\r\n              type: node.parameters[\"intype-\" + p.label] || \"string\",\r\n              group: \"Inputs\",\r\n            });\r\n          }\r\n        );\r\n      }\r\n\r\n      _parseScriptForErrorsAndPorts(\r\n        node.parameters[\"functionScript\"],\r\n        \"Script \",\r\n        node,\r\n        context,\r\n        ports\r\n      );\r\n\r\n      // Push output ports that are signals directly to the model, it's needed by the initial run of\r\n      // the script function\r\n      ports.forEach((p) => {\r\n        if (p.type === \"signal\" && p.plug === \"output\") {\r\n          node.outputPorts[p.name] = p;\r\n        }\r\n      });\r\n\r\n      context.editorConnection?.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    _updatePorts();\r\n    node.on(\"parameterUpdated\", function () {\r\n      _updatePorts();\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.JavaScriptFunction\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"JavaScriptFunction\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import { CloudStore } from \"./cloudstore\";\r\nimport { Model } from \"../model\";\r\n\r\ninterface QueryRule {\r\n  combinator?: string;\r\n  rules?: QueryRule[];\r\n  operator?: string;\r\n  input?: string;\r\n  value?: any;\r\n  property?: string;\r\n  relatedTo?: string;\r\n  relationProperty?: string;\r\n}\r\n\r\ninterface QueryParameters {\r\n  [key: string]: any;\r\n}\r\n\r\ninterface QueryOptions {\r\n  queryParameters?: QueryParameters;\r\n  collectionName?: string;\r\n  modelScope?: typeof Model;\r\n  error?: (error: string) => void;\r\n}\r\n\r\ninterface SortRule {\r\n  order: \"ascending\" | \"descending\";\r\n  property: string;\r\n}\r\n\r\ninterface RelatedToFilter {\r\n  id: string;\r\n  key: string;\r\n  className?: string;\r\n}\r\n\r\ninterface FilterOperators {\r\n  equalTo?: any;\r\n  notEqualTo?: any;\r\n  lessThan?: any;\r\n  greaterThan?: any;\r\n  lessThanOrEqualTo?: any;\r\n  greaterThanOrEqualTo?: any;\r\n  exists?: boolean;\r\n  containedIn?: any[];\r\n  notContainedIn?: any[];\r\n  pointsTo?: string | string[];\r\n  matchesRegex?: string;\r\n  options?: string;\r\n  text?: {\r\n    search:\r\n      | string\r\n      | {\r\n          term: string;\r\n          language?: string;\r\n          caseSensitive?: boolean;\r\n          diacriticSensitive?: boolean;\r\n        };\r\n  };\r\n  nearSphere?: {\r\n    latitude: number;\r\n    longitude: number;\r\n    maxDistanceInMiles?: number;\r\n    maxDistanceInKilometers?: number;\r\n    maxDistanceInRadians?: number;\r\n  };\r\n  withinBox?: Array<{\r\n    latitude: number;\r\n    longitude: number;\r\n  }>;\r\n  withinPolygon?: Array<{\r\n    latitude: number;\r\n    longitude: number;\r\n  }>;\r\n}\r\n\r\ninterface Filter {\r\n  and?: Filter[];\r\n  or?: Filter[];\r\n  idEqualTo?: string;\r\n  idContainedIn?: string[];\r\n  relatedTo?: RelatedToFilter;\r\n  [key: string]: any;\r\n}\r\n\r\nfunction convertVisualFilter(query: QueryRule, options: QueryOptions): any {\r\n  const inputs = options.queryParameters;\r\n\r\n  if (query.combinator !== undefined && query.rules !== undefined) {\r\n    if (query.rules.length === 0) return;\r\n    else if (query.rules.length === 1)\r\n      return convertVisualFilter(query.rules[0], options);\r\n    else {\r\n      const _res: any = {};\r\n      const _op = \"$\" + query.combinator;\r\n      _res[_op] = [];\r\n      query.rules.forEach((r) => {\r\n        const cond = convertVisualFilter(r, options);\r\n        if (cond !== undefined) _res[_op].push(cond);\r\n      });\r\n\r\n      return _res;\r\n    }\r\n  } else if (query.operator === \"related to\") {\r\n    // @ts-expect-error\r\n    const value = query.input !== undefined ? inputs[query.input] : undefined;\r\n    if (value === undefined) return;\r\n\r\n    return {\r\n      $relatedTo: {\r\n        object: {\r\n          __type: \"Pointer\",\r\n          objectId: value,\r\n          className: query.relatedTo,\r\n        },\r\n        key: query.relationProperty,\r\n      },\r\n    };\r\n  } else {\r\n    const _res: any = {};\r\n    let cond: any;\r\n    // @ts-expect-error\r\n    let value = query.input !== undefined ? inputs[query.input] : query.value;\r\n\r\n    if (query.operator === \"exist\") {\r\n      _res[query.property!] = { $exists: true };\r\n      return _res;\r\n    } else if (query.operator === \"not exist\") {\r\n      _res[query.property!] = { $exists: false };\r\n      return _res;\r\n    }\r\n\r\n    if (value === undefined) return;\r\n\r\n    let schema;\r\n    // @ts-expect-error\r\n    if (CloudStore._collections[options.collectionName!]) {\r\n      // @ts-expect-error\r\n      schema = CloudStore._collections[options.collectionName!].schema;\r\n    }\r\n\r\n    const propertyType =\r\n      schema && schema.properties && schema.properties[query.property!]\r\n        ? schema.properties[query.property!].type\r\n        : undefined;\r\n\r\n    if (propertyType === \"Date\") {\r\n      if (!(value instanceof Date)) value = new Date(value.toString());\r\n      value = { __type: \"Date\", iso: value.toISOString() };\r\n    }\r\n\r\n    if (query.operator === \"greater than\") cond = { $gt: value };\r\n    else if (query.operator === \"greater than or equal to\")\r\n      cond = { $gte: value };\r\n    else if (query.operator === \"less than\") cond = { $lt: value };\r\n    else if (query.operator === \"less than or equal to\") cond = { $lte: value };\r\n    else if (query.operator === \"equal to\") cond = { $eq: value };\r\n    else if (query.operator === \"not equal to\") cond = { $ne: value };\r\n    else if (query.operator === \"points to\") {\r\n      const targetClass =\r\n        schema && schema.properties && schema.properties[query.property!]\r\n          ? schema.properties[query.property!].targetClass\r\n          : undefined;\r\n\r\n      cond = {\r\n        $eq: { __type: \"Pointer\", objectId: value, className: targetClass },\r\n      };\r\n    } else if (query.operator === \"contain\") {\r\n      cond = { $regex: value, $options: \"i\" };\r\n    }\r\n\r\n    _res[query.property!] = cond;\r\n\r\n    return _res;\r\n  }\r\n}\r\n\r\nfunction matchesQuery(model: any, query: any): boolean {\r\n  let match = true;\r\n\r\n  if (query === undefined) return true;\r\n\r\n  if (query[\"$and\"] !== undefined) {\r\n    query[\"$and\"].forEach((q: any) => {\r\n      match = match && matchesQuery(model, q);\r\n    });\r\n  } else if (query[\"$or\"] !== undefined) {\r\n    match = false;\r\n    query[\"$or\"].forEach((q: any) => {\r\n      match = match || matchesQuery(model, q);\r\n    });\r\n  } else {\r\n    const keys = Object.keys(query);\r\n    keys.forEach((k) => {\r\n      if (k === \"objectId\") {\r\n        if (query[k][\"$eq\"] !== undefined)\r\n          match = match && model.getId() === query[k][\"$eq\"];\r\n        else if (query[k][\"$in\"] !== undefined)\r\n          match = match && query[k][\"$in\"].indexOf(model.getId()) !== -1;\r\n      } else if (k === \"$relatedTo\") {\r\n        match = false; // cannot resolve relation queries locally\r\n      } else {\r\n        const value = model.get(k);\r\n        if (\r\n          query[k][\"$eq\"] !== undefined &&\r\n          query[k][\"$eq\"].__type === \"Pointer\"\r\n        )\r\n          match = match && value === query[k][\"$eq\"].objectId;\r\n        else if (query[k][\"$eq\"] !== undefined)\r\n          match = match && value == query[k][\"$eq\"];\r\n        else if (query[k][\"$ne\"] !== undefined)\r\n          match = match && value != query[k][\"$ne\"];\r\n        else if (query[k][\"$lt\"] !== undefined)\r\n          match = match && value < query[k][\"$lt\"];\r\n        else if (query[k][\"$lte\"] !== undefined)\r\n          match = match && value <= query[k][\"$lt\"];\r\n        else if (query[k][\"$gt\"] !== undefined)\r\n          match = match && value > query[k][\"$gt\"];\r\n        else if (query[k][\"$gte\"] !== undefined)\r\n          match = match && value >= query[k][\"$gte\"];\r\n        else if (query[k][\"$exists\"] !== undefined)\r\n          match = match && value !== undefined;\r\n        else if (query[k][\"$in\"] !== undefined)\r\n          match = match && query[k][\"$in\"].indexOf(value) !== -1;\r\n        else if (query[k][\"$nin\"] !== undefined)\r\n          match = match && query[k][\"$in\"].indexOf(value) === -1;\r\n        else if (query[k][\"$regex\"] !== undefined)\r\n          match =\r\n            match &&\r\n            new RegExp(query[k][\"$regex\"], query[k][\"$options\"]).test(value);\r\n      }\r\n    });\r\n  }\r\n  return match;\r\n}\r\n\r\nfunction compareObjects(sort: string[], a: any, b: any): number {\r\n  for (let i = 0; i < sort.length; i++) {\r\n    let _s = sort[i];\r\n    if (_s[0] === \"-\") {\r\n      // Descending\r\n      let prop = _s.substring(1);\r\n      if (a.get(prop) > b.get(prop)) return -1;\r\n      else if (a.get(prop) < b.get(prop)) return 1;\r\n    } else {\r\n      // Ascending\r\n      if (a.get(_s) > b.get(_s)) return 1;\r\n      else if (a.get(_s) < b.get(_s)) return -1;\r\n    }\r\n  }\r\n  return 0;\r\n}\r\n\r\nfunction convertVisualSorting(sorting: SortRule[]): string[] {\r\n  return sorting.map((s) => {\r\n    return (s.order === \"descending\" ? \"-\" : \"\") + s.property;\r\n  });\r\n}\r\n\r\nfunction _value(v: any): any {\r\n  if (v instanceof Date && typeof v.toISOString === \"function\") {\r\n    return {\r\n      __type: \"Date\",\r\n      iso: v.toISOString(),\r\n    };\r\n  }\r\n  return v;\r\n}\r\n\r\nfunction convertFilterOp(filter: Filter, options: QueryOptions): any {\r\n  const keys = Object.keys(filter);\r\n  if (keys.length === 0) return {};\r\n  if (keys.length !== 1) {\r\n    return options?.error?.(\r\n      \"Filter must only have one key found \" + keys.join(\",\")\r\n    );\r\n  }\r\n\r\n  const res: any = {};\r\n  const key = keys[0];\r\n  if (filter[\"and\"] !== undefined && Array.isArray(filter[\"and\"])) {\r\n    res[\"$and\"] = filter[\"and\"].map((f) => convertFilterOp(f, options));\r\n  } else if (filter[\"or\"] !== undefined && Array.isArray(filter[\"or\"])) {\r\n    res[\"$or\"] = filter[\"or\"].map((f) => convertFilterOp(f, options));\r\n  } else if (filter[\"idEqualTo\"] !== undefined) {\r\n    res[\"objectId\"] = { $eq: filter[\"idEqualTo\"] };\r\n  } else if (filter[\"idContainedIn\"] !== undefined) {\r\n    res[\"objectId\"] = { $in: filter[\"idContainedIn\"] };\r\n  } else if (filter[\"relatedTo\"] !== undefined) {\r\n    const modelId = filter[\"relatedTo\"][\"id\"];\r\n    if (modelId === undefined) {\r\n      return options?.error?.(\"Must provide id in relatedTo filter\");\r\n    }\r\n\r\n    const relationKey = filter[\"relatedTo\"][\"key\"];\r\n    if (relationKey === undefined) {\r\n      return options?.error?.(\"Must provide key in relatedTo filter\");\r\n    }\r\n\r\n    const className =\r\n      filter[\"relatedTo\"][\"className\"] ||\r\n      (options.modelScope || Model).get(modelId)?._class;\r\n    if (typeof className === \"undefined\") {\r\n      // Either the pointer is loaded as an object or we allow passing in the className.\r\n      return options?.error?.(\"Must preload the Pointer or include className\");\r\n    }\r\n\r\n    res[\"$relatedTo\"] = {\r\n      object: {\r\n        __type: \"Pointer\",\r\n        objectId: modelId,\r\n        className,\r\n      },\r\n      key: relationKey,\r\n    };\r\n  } else if (typeof filter[key] === \"object\") {\r\n    const opAndValue = filter[key] as FilterOperators;\r\n    if (opAndValue[\"equalTo\"] !== undefined)\r\n      res[key] = { $eq: _value(opAndValue[\"equalTo\"]) };\r\n    else if (opAndValue[\"notEqualTo\"] !== undefined)\r\n      res[key] = { $ne: _value(opAndValue[\"notEqualTo\"]) };\r\n    else if (opAndValue[\"lessThan\"] !== undefined)\r\n      res[key] = { $lt: _value(opAndValue[\"lessThan\"]) };\r\n    else if (opAndValue[\"greaterThan\"] !== undefined)\r\n      res[key] = { $gt: _value(opAndValue[\"greaterThan\"]) };\r\n    else if (opAndValue[\"lessThanOrEqualTo\"] !== undefined)\r\n      res[key] = { $lte: _value(opAndValue[\"lessThanOrEqualTo\"]) };\r\n    else if (opAndValue[\"greaterThanOrEqualTo\"] !== undefined)\r\n      res[key] = { $gte: _value(opAndValue[\"greaterThanOrEqualTo\"]) };\r\n    else if (opAndValue[\"exists\"] !== undefined)\r\n      res[key] = { $exists: opAndValue[\"exists\"] };\r\n    else if (opAndValue[\"containedIn\"] !== undefined)\r\n      res[key] = { $in: opAndValue[\"containedIn\"] };\r\n    else if (opAndValue[\"notContainedIn\"] !== undefined)\r\n      res[key] = { $nin: opAndValue[\"notContainedIn\"] };\r\n    else if (opAndValue[\"pointsTo\"] !== undefined) {\r\n      let schema = null;\r\n      // @ts-expect-error\r\n      if (CloudStore._collections[options.collectionName!]) {\r\n        // @ts-expect-error\r\n        schema = CloudStore._collections[options.collectionName!].schema;\r\n      }\r\n\r\n      const targetClass =\r\n        // @ts-expect-error\r\n        schema && schema.properties && schema.properties[key]\r\n          ? // @ts-expect-error\r\n            schema.properties[key].targetClass\r\n          : undefined;\r\n      const type =\r\n        // @ts-expect-error\r\n        schema && schema.properties && schema.properties[key]\r\n          ? // @ts-expect-error\r\n            schema.properties[key].type\r\n          : undefined;\r\n\r\n      if (type === \"Relation\") {\r\n        res[key] = {\r\n          __type: \"Pointer\",\r\n          objectId: opAndValue[\"pointsTo\"],\r\n          className: targetClass,\r\n        };\r\n      } else {\r\n        if (Array.isArray(opAndValue[\"pointsTo\"])) {\r\n          res[key] = {\r\n            $in: opAndValue[\"pointsTo\"].map((v) => {\r\n              return { __type: \"Pointer\", objectId: v, className: targetClass };\r\n            }),\r\n          };\r\n        } else {\r\n          res[key] = {\r\n            $eq: {\r\n              __type: \"Pointer\",\r\n              objectId: opAndValue[\"pointsTo\"],\r\n              className: targetClass,\r\n            },\r\n          };\r\n        }\r\n      }\r\n    } else if (opAndValue[\"matchesRegex\"] !== undefined) {\r\n      res[key] = {\r\n        $regex: opAndValue[\"matchesRegex\"],\r\n        $options: opAndValue[\"options\"],\r\n      };\r\n    } else if (\r\n      opAndValue[\"text\"] !== undefined &&\r\n      opAndValue[\"text\"][\"search\"] !== undefined\r\n    ) {\r\n      const _v = opAndValue[\"text\"][\"search\"];\r\n      if (typeof _v === \"string\")\r\n        res[key] = { $text: { $search: { $term: _v, $caseSensitive: false } } };\r\n      else\r\n        res[key] = {\r\n          $text: {\r\n            $search: {\r\n              $term: _v.term,\r\n              $language: _v.language,\r\n              $caseSensitive: _v.caseSensitive,\r\n              $diacriticSensitive: _v.diacriticSensitive,\r\n            },\r\n          },\r\n        };\r\n      // Geo points\r\n    } else if (opAndValue[\"nearSphere\"] !== undefined) {\r\n      const _v = opAndValue[\"nearSphere\"];\r\n      res[key] = {\r\n        $nearSphere: {\r\n          __type: \"GeoPoint\",\r\n          latitude: _v.latitude,\r\n          longitude: _v.longitude,\r\n        },\r\n        $maxDistanceInMiles: _v.maxDistanceInMiles,\r\n        $maxDistanceInKilometers: _v.maxDistanceInKilometers,\r\n        $maxDistanceInRadians: _v.maxDistanceInRadians,\r\n      };\r\n    } else if (opAndValue[\"withinBox\"] !== undefined) {\r\n      const _v = opAndValue[\"withinBox\"];\r\n      res[key] = {\r\n        $within: {\r\n          $box: _v.map((gp) => ({\r\n            __type: \"GeoPoint\",\r\n            latitude: gp.latitude,\r\n            longitude: gp.longitude,\r\n          })),\r\n        },\r\n      };\r\n    } else if (opAndValue[\"withinPolygon\"] !== undefined) {\r\n      const _v = opAndValue[\"withinPolygon\"];\r\n      res[key] = {\r\n        $geoWithin: {\r\n          $polygon: _v.map((gp) => ({\r\n            __type: \"GeoPoint\",\r\n            latitude: gp.latitude,\r\n            longitude: gp.longitude,\r\n          })),\r\n        },\r\n      };\r\n    }\r\n  } else {\r\n    options?.error?.(\"Unrecognized filter keys \" + keys.join(\",\"));\r\n  }\r\n\r\n  return res;\r\n}\r\n\r\nexport {\r\n  convertVisualFilter,\r\n  compareObjects,\r\n  matchesQuery,\r\n  convertVisualSorting,\r\n  convertFilterOp,\r\n};\r\n","import { Collection } from \"../../../collection\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\nimport { Port } from \"../../../models/componentmodel\";\r\nimport { createSetter } from \"../../../edgetriggeredinput\";\r\nimport { Model } from \"../../../model\";\r\nimport * as QueryUtils from \"../../../api/queryutils\";\r\nimport { CloudStore } from \"../../../api/cloudstore\";\r\nimport { JavascriptNodeParser } from \"../../../javascriptnodeparser\";\r\nimport { NodeContext } from \"../../../nodecontext\";\r\nimport { GraphModel } from \"../../../models/graphmodel\";\r\n\r\ninterface Internal {\r\n  queryParameters: Record<string, any>;\r\n  collectionChangedCallback: () => void;\r\n  cloudStoreEvents: (args: any) => void;\r\n  name?: string;\r\n  collection?: any;\r\n  currentQuery?: {\r\n    where: any;\r\n    sort: any;\r\n    limit: number;\r\n    skip: number;\r\n  };\r\n  fetchScheduled?: boolean;\r\n  err?: string;\r\n  error?: string;\r\n  visualFilter?: any;\r\n  visualSorting?: any;\r\n  filterFunc?: Function;\r\n  filterVariables?: string[];\r\n  storageSettings: Record<string, any>;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"DbCollection2\",\r\n  docs: \"https://docs.noodl.net/nodes/data/cloud-data/query-records\",\r\n  displayName: \"Query Records\",\r\n  /* shortDesc: \"A database collection.\",*/\r\n  category: \"Cloud Services\",\r\n  usePortAsLabel: \"collectionName\",\r\n  color: \"data\",\r\n  initialize() {\r\n    const _this = this;\r\n    this._internal.queryParameters = {};\r\n\r\n    let collectionChangedScheduled = false;\r\n    this._internal.collectionChangedCallback = function () {\r\n      //this can be called multiple times when adding/removing more than one item\r\n      //so optimize by only updating outputs once\r\n      if (collectionChangedScheduled) return;\r\n      collectionChangedScheduled = true;\r\n\r\n      _this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this.flagOutputDirty(\"count\");\r\n        _this.flagOutputDirty(\"firstItemId\");\r\n        _this.flagOutputDirty(\"isEmpty\");\r\n        collectionChangedScheduled = false;\r\n      });\r\n    };\r\n\r\n    this._internal.cloudStoreEvents = function (args: any) {\r\n      if (_this.isInputConnected(\"storageFetch\") === true) return;\r\n\r\n      if (_this._internal.collection === undefined) return;\r\n      if (args.collection !== _this._internal.name) return;\r\n\r\n      function _addModelAtCorrectIndex(m: any) {\r\n        if (_this._internal.currentQuery?.sort !== undefined) {\r\n          // We need to add it at the right index\r\n          for (let i = 0; i < _this._internal.collection.size(); i++)\r\n            if (\r\n              QueryUtils.compareObjects(\r\n                _this._internal.currentQuery.sort,\r\n                _this._internal.collection.get(i),\r\n                m\r\n              ) > 0\r\n            )\r\n              break;\r\n\r\n          // @ts-expect-error\r\n          _this._internal.collection.addAtIndex(m, i);\r\n        } else {\r\n          _this._internal.collection.add(m);\r\n        }\r\n\r\n        // Make sure we don't exceed limit\r\n        let size = _this._internal.collection.size();\r\n        if (\r\n          _this._internal.currentQuery?.limit !== undefined &&\r\n          size > _this._internal.currentQuery.limit\r\n        )\r\n          _this._internal.collection.remove(\r\n            _this._internal.collection.get(\r\n              _this._internal.currentQuery.sort !== undefined &&\r\n                _this._internal.currentQuery.sort[0][0] === \"-\"\r\n                ? size - 1\r\n                : 0\r\n            )\r\n          );\r\n\r\n        //Send the array again over the items output to trigger function nodes etc that might be connected\r\n        _this.flagOutputDirty(\"items\");\r\n\r\n        _this.flagOutputDirty(\"count\");\r\n        _this.flagOutputDirty(\"firstItemId\");\r\n        _this.flagOutputDirty(\"isEmpty\");\r\n      }\r\n\r\n      if (args.type === \"create\") {\r\n        const m = Model.get(args.object.objectId);\r\n        if (m !== undefined) {\r\n          // Check if the object matches the current query\r\n          if (QueryUtils.matchesQuery(m, _this._internal.currentQuery?.where)) {\r\n            // If matches the query, add the item to results\r\n            _addModelAtCorrectIndex(m);\r\n          }\r\n        }\r\n      } else if (args.type === \"save\") {\r\n        const m = Model.get(args.objectId);\r\n        if (m !== undefined) {\r\n          const matchesQuery = QueryUtils.matchesQuery(\r\n            m,\r\n            _this._internal.currentQuery?.where\r\n          );\r\n\r\n          if (!matchesQuery && _this._internal.collection.contains(m)) {\r\n            // The record no longer matches the filter, remove it\r\n            _this._internal.collection.remove(m);\r\n\r\n            //Send the array again over the items output to trigger function nodes etc that might be connected\r\n            _this.flagOutputDirty(\"items\");\r\n\r\n            _this.flagOutputDirty(\"count\");\r\n            _this.flagOutputDirty(\"firstItemId\");\r\n            _this.flagOutputDirty(\"isEmpty\");\r\n          } else if (matchesQuery && !_this._internal.collection.contains(m)) {\r\n            // It's not part of the result collection but now matches they query, add it and resort\r\n            _addModelAtCorrectIndex(m);\r\n          }\r\n        }\r\n      } else if (args.type === \"delete\") {\r\n        const m = Model.get(args.objectId);\r\n        if (m !== undefined) {\r\n          _this._internal.collection.remove(m);\r\n\r\n          //Send the array again over the items output to trigger function nodes etc that might be connected\r\n          _this.flagOutputDirty(\"items\");\r\n\r\n          _this.flagOutputDirty(\"count\");\r\n          _this.flagOutputDirty(\"firstItemId\");\r\n          _this.flagOutputDirty(\"isEmpty\");\r\n        }\r\n      }\r\n    };\r\n\r\n    // Listening to cloud store events is only for the global model scope, only valid in browser\r\n    // in cloud runtime its a nop\r\n    // @ts-expect-error\r\n    const cloudstore = CloudStore.forScope(this.nodeScope.modelScope);\r\n    cloudstore.on(\"save\", this._internal.cloudStoreEvents);\r\n    cloudstore.on(\"create\", this._internal.cloudStoreEvents);\r\n    cloudstore.on(\"delete\", this._internal.cloudStoreEvents);\r\n\r\n    this._internal.storageSettings = {};\r\n  },\r\n  getInspectInfo() {\r\n    const collection = this._internal.collection;\r\n    if (!collection) {\r\n      return { type: \"text\", value: \"[Not executed yet]\" };\r\n    }\r\n\r\n    return [\r\n      {\r\n        type: \"value\",\r\n        value: collection.items,\r\n      },\r\n    ];\r\n  },\r\n  inputs: {},\r\n  outputs: {\r\n    items: {\r\n      type: \"array\",\r\n      displayName: \"Items\",\r\n      group: \"General\",\r\n      getter: function () {\r\n        return this._internal.collection;\r\n      },\r\n    },\r\n    firstItemId: {\r\n      type: \"string\",\r\n      displayName: \"First Record Id\",\r\n      group: \"General\",\r\n      getter: function () {\r\n        if (this._internal.collection) {\r\n          const firstItem = this._internal.collection.get(0);\r\n          if (firstItem !== undefined) return firstItem.getId();\r\n        }\r\n      },\r\n    },\r\n    isEmpty: {\r\n      type: \"boolean\",\r\n      displayName: \"Is Empty\",\r\n      group: \"General\",\r\n      getter: function () {\r\n        if (this._internal.collection) {\r\n          return this._internal.collection.size() === 0;\r\n        }\r\n        return true;\r\n      },\r\n    },\r\n    count: {\r\n      type: \"number\",\r\n      displayName: \"Count\",\r\n      group: \"General\",\r\n      getter: function () {\r\n        return this._internal.collection ? this._internal.collection.size() : 0;\r\n      },\r\n    },\r\n    fetched: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Success\",\r\n    },\r\n    failure: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Failure\",\r\n    },\r\n    error: {\r\n      type: \"string\",\r\n      displayName: \"Error\",\r\n      group: \"Error\",\r\n      getter: function () {\r\n        return this._internal.error;\r\n      },\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionName: function (name: string) {\r\n      this._internal.name = name;\r\n\r\n      // @ts-expect-error\r\n      if (this.isInputConnected(\"storageFetch\") === false) this.scheduleFetch();\r\n    },\r\n    setCollection: function (collection: any) {\r\n      // @ts-expect-error\r\n      this.bindCollection(collection);\r\n      this.flagOutputDirty(\"firstItemId\");\r\n      this.flagOutputDirty(\"isEmpty\");\r\n      this.flagOutputDirty(\"items\");\r\n      this.flagOutputDirty(\"count\");\r\n    },\r\n    unbindCurrentCollection: function () {\r\n      const collection = this._internal.collection;\r\n      if (!collection) return;\r\n      collection.off(\"change\", this._internal.collectionChangedCallback);\r\n      this._internal.collection = undefined;\r\n    },\r\n    bindCollection: function (collection: any) {\r\n      // @ts-expect-error\r\n      this.unbindCurrentCollection();\r\n      this._internal.collection = collection;\r\n      collection &&\r\n        collection.on(\"change\", this._internal.collectionChangedCallback);\r\n    },\r\n    _onNodeDeleted: function () {\r\n      // @ts-expect-error\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      // @ts-expect-error\r\n      this.unbindCurrentCollection();\r\n\r\n      // @ts-expect-error\r\n      const cloudstore = CloudStore.forScope(this.nodeScope.modelScope);\r\n      cloudstore.off(\"insert\", this._internal.cloudStoreEvents);\r\n      cloudstore.off(\"delete\", this._internal.cloudStoreEvents);\r\n      cloudstore.off(\"save\", this._internal.cloudStoreEvents);\r\n    },\r\n    setError: function (err: string) {\r\n      this._internal.err = err;\r\n      this.flagOutputDirty(\"error\");\r\n      this.sendSignalOnOutput(\"failure\");\r\n    },\r\n    scheduleFetch: function () {\r\n      const internal = this._internal;\r\n\r\n      if (internal.fetchScheduled) return;\r\n      internal.fetchScheduled = true;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        internal.fetchScheduled = false;\r\n\r\n        // @ts-expect-error\r\n        this.fetch();\r\n      });\r\n    },\r\n    fetch: function () {\r\n      if (this.context.editorConnection) {\r\n        if (this._internal.name === undefined) {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"query-collection\",\r\n            {\r\n              message: \"No collection specified for query\",\r\n            }\r\n          );\r\n        } else {\r\n          this.context.editorConnection.clearWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"query-collection\"\r\n          );\r\n        }\r\n      }\r\n\r\n      const _c = Collection.get();\r\n      // @ts-expect-error\r\n      const f = this.getStorageFilter();\r\n      // @ts-expect-error\r\n      const limit = this.getStorageLimit();\r\n      // @ts-expect-error\r\n      const skip = this.getStorageSkip();\r\n      // @ts-expect-error\r\n      const count = this.getStorageFetchTotalCount();\r\n      this._internal.currentQuery = {\r\n        where: f.where,\r\n        sort: f.sort,\r\n        limit,\r\n        skip,\r\n      };\r\n      CloudStore.forScope(this.nodeScope!.modelScope).query({\r\n        // @ts-expect-error\r\n        collection: this._internal.name,\r\n        where: f.where,\r\n        sort: f.sort,\r\n        limit,\r\n        skip,\r\n        count,\r\n        success: (results: any[], count?: number) => {\r\n          if (results !== undefined) {\r\n            _c.set(\r\n              results.map((i) => {\r\n                const m = CloudStore._fromJSON(\r\n                  i,\r\n                  // @ts-expect-error\r\n                  this._internal.name,\r\n                  // @ts-expect-error\r\n                  this.nodeScope.modelScope\r\n                );\r\n                return m;\r\n              })\r\n            );\r\n          }\r\n          if (count !== undefined) {\r\n            this._internal.storageSettings.storageTotalCount = count;\r\n            if (this.hasOutput(\"storageTotalCount\"))\r\n              this.flagOutputDirty(\"storageTotalCount\");\r\n          }\r\n          // @ts-expect-error\r\n          this.setCollection(_c);\r\n          this.sendSignalOnOutput(\"fetched\");\r\n        },\r\n        error: (err?: string) => {\r\n          // @ts-expect-error\r\n          this.setCollection(_c);\r\n          // @ts-expect-error\r\n          this.setError(err || \"Failed to fetch.\");\r\n        },\r\n      });\r\n    },\r\n    // @ts-expect-error\r\n    getStorageFilter: function () {\r\n      const storageSettings = this._internal.storageSettings;\r\n      if (\r\n        storageSettings[\"storageFilterType\"] === undefined ||\r\n        storageSettings[\"storageFilterType\"] === \"simple\"\r\n      ) {\r\n        // Create simple filter\r\n        const _where =\r\n          this._internal.visualFilter !== undefined\r\n            ? QueryUtils.convertVisualFilter(this._internal.visualFilter, {\r\n                queryParameters: this._internal.queryParameters,\r\n                collectionName: this._internal.name,\r\n              })\r\n            : undefined;\r\n\r\n        const _sort =\r\n          this._internal.visualSorting !== undefined\r\n            ? QueryUtils.convertVisualSorting(this._internal.visualSorting)\r\n            : undefined;\r\n\r\n        return {\r\n          where: _where,\r\n          sort: _sort,\r\n        };\r\n      } else if (storageSettings[\"storageFilterType\"] === \"json\") {\r\n        // JSON filter\r\n        if (!this._internal.filterFunc) {\r\n          try {\r\n            let filterCode = storageSettings[\"storageJSONFilter\"];\r\n\r\n            // Parse out variables\r\n            filterCode = filterCode.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g, \"\"); // Remove comments\r\n            this._internal.filterVariables =\r\n              filterCode.match(/\\$[A-Za-z0-9]+/g) || [];\r\n\r\n            const args = [\"filter\", \"where\", \"sort\", \"Inputs\"]\r\n              // @ts-expect-error\r\n              .concat(this._internal.filterVariables)\r\n              .concat([filterCode]);\r\n            this._internal.filterFunc = Function.apply(null, args);\r\n          } catch (e) {\r\n            this._internal.filterFunc = undefined;\r\n            console.log(\"Error while parsing filter script: \" + e);\r\n          }\r\n        }\r\n\r\n        if (!this._internal.filterFunc) return;\r\n\r\n        let _filter = {},\r\n          _sort: any[] = [];\r\n        const _this = this;\r\n\r\n        // Collect filter variables\r\n        const _filterCb = function (f: any) {\r\n          _filter = QueryUtils.convertFilterOp(f, {\r\n            collectionName: _this._internal.name,\r\n            error: function (err: string) {\r\n              // @ts-expect-error\r\n              _this.context.editorConnection.sendWarning(\r\n                // @ts-expect-error\r\n                _this.nodeScope.componentOwner.name,\r\n                _this.id,\r\n                \"query-collection-filter\",\r\n                {\r\n                  message: err,\r\n                }\r\n              );\r\n            },\r\n          });\r\n        };\r\n        const _sortCb = function (s: any[]) {\r\n          _sort = s;\r\n        };\r\n\r\n        // Extract inputs\r\n        const inputs: Record<string, any> = {};\r\n        for (const key in storageSettings) {\r\n          if (key.startsWith(\"storageFilterValue-\"))\r\n            inputs[key.substring(\"storageFilterValue-\".length)] =\r\n              storageSettings[key];\r\n        }\r\n\r\n        const filterFuncArgs = [_filterCb, _filterCb, _sortCb, inputs]; // One for filter, one for where\r\n\r\n        this._internal.filterVariables?.forEach((v) => {\r\n          filterFuncArgs.push(\r\n            storageSettings[\"storageFilterValue-\" + v.substring(1)]\r\n          );\r\n        });\r\n\r\n        // Run the code to get the filter\r\n        try {\r\n          this._internal.filterFunc.apply(this, filterFuncArgs);\r\n        } catch (e) {\r\n          console.log(\"Error while running filter script: \" + e);\r\n        }\r\n\r\n        return { where: _filter, sort: _sort };\r\n      }\r\n    },\r\n    // @ts-expect-error\r\n    getStorageLimit: function (): number | undefined {\r\n      const storageSettings = this._internal.storageSettings;\r\n\r\n      if (!storageSettings[\"storageEnableLimit\"]) return undefined;\r\n      else return storageSettings[\"storageLimit\"] || 10;\r\n    },\r\n    // @ts-expect-error\r\n    getStorageSkip: function (): number | undefined {\r\n      const storageSettings = this._internal.storageSettings;\r\n\r\n      if (!storageSettings[\"storageEnableLimit\"]) return undefined;\r\n      else return storageSettings[\"storageSkip\"] || 0;\r\n    },\r\n    // @ts-expect-error\r\n    getStorageFetchTotalCount: function (): boolean {\r\n      const storageSettings = this._internal.storageSettings;\r\n\r\n      return !!storageSettings[\"storageEnableCount\"];\r\n    },\r\n    registerOutputIfNeeded: function (name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerOutput(name, {\r\n        getter() {\r\n          return this._internal.storageSettings[name];\r\n        },\r\n      });\r\n    },\r\n    setVisualFilter: function (value: any) {\r\n      this._internal.visualFilter = value;\r\n\r\n      // @ts-expect-error\r\n      if (this.isInputConnected(\"storageFetch\") === false) this.scheduleFetch();\r\n    },\r\n    setVisualSorting: function (value: any) {\r\n      this._internal.visualSorting = value;\r\n\r\n      // @ts-expect-error\r\n      if (this.isInputConnected(\"storageFetch\") === false) this.scheduleFetch();\r\n    },\r\n    setQueryParameter: function (name: string, value: any) {\r\n      this._internal.queryParameters[name] = value;\r\n\r\n      // @ts-expect-error\r\n      if (this.isInputConnected(\"storageFetch\") === false) this.scheduleFetch();\r\n    },\r\n    registerInputIfNeeded: function (name: string) {\r\n      const _this = this;\r\n\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"qp-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setQueryParameter.bind(this, name.substring(\"qp-\".length)),\r\n        });\r\n\r\n      const dynamicSignals: Record<string, () => void> = {\r\n        // @ts-expect-error\r\n        storageFetch: this.scheduleFetch.bind(this),\r\n      };\r\n\r\n      if (dynamicSignals[name])\r\n        return this.registerInput(name, {\r\n          set: createSetter({\r\n            valueChangedToTrue: dynamicSignals[name],\r\n          }),\r\n        });\r\n\r\n      const dynamicSetters: Record<string, (value: any) => void> = {\r\n        // @ts-expect-error\r\n        collectionName: this.setCollectionName.bind(this),\r\n        // @ts-expect-error\r\n        visualFilter: this.setVisualFilter.bind(this),\r\n        // @ts-expect-error\r\n        visualSort: this.setVisualSorting.bind(this),\r\n      };\r\n\r\n      if (dynamicSetters[name])\r\n        return this.registerInput(name, {\r\n          set: dynamicSetters[name],\r\n        });\r\n\r\n      this.registerInput(name, {\r\n        set(value: any) {\r\n          this._internal.storageSettings[name] = value;\r\n\r\n          if (this.isInputConnected(\"storageFetch\") === false) {\r\n            // @ts-expect-error\r\n            this.scheduleFetch();\r\n          }\r\n        },\r\n      });\r\n    },\r\n  },\r\n};\r\n\r\nconst _defaultJSONQuery =\r\n  \"// Write your query script here, check out the reference documentation for examples\\n\" +\r\n  \"where({ })\\n\";\r\n\r\nfunction updatePorts(\r\n  nodeId: string,\r\n  parameters: any,\r\n  editorConnection: any,\r\n  graphModel: any\r\n) {\r\n  const ports: Port[] = [];\r\n\r\n  const dbCollections = graphModel.getMetaData(\"dbCollections\");\r\n  const systemCollections = graphModel.getMetaData(\"systemCollections\");\r\n\r\n  const _systemClasses = [\r\n    { label: \"User\", value: \"_User\" },\r\n    { label: \"Role\", value: \"_Role\" },\r\n  ];\r\n  ports.push({\r\n    name: \"collectionName\",\r\n    type: {\r\n      name: \"enum\",\r\n      enums: _systemClasses.concat(\r\n        dbCollections !== undefined\r\n          ? dbCollections.map((c: any) => {\r\n              return { value: c.name, label: c.name };\r\n            })\r\n          : []\r\n      ),\r\n      allowEditOnly: true,\r\n    },\r\n    displayName: \"Class\",\r\n    plug: \"input\",\r\n    group: \"General\",\r\n  });\r\n\r\n  ports.push({\r\n    name: \"storageFilterType\",\r\n    type: {\r\n      name: \"enum\",\r\n      allowEditOnly: true,\r\n      enums: [\r\n        { value: \"simple\", label: \"Visual\" },\r\n        { value: \"json\", label: \"Javascript\" },\r\n      ],\r\n    },\r\n    displayName: \"Filter\",\r\n    default: \"simple\",\r\n    plug: \"input\",\r\n    group: \"General\",\r\n  });\r\n\r\n  // Limit\r\n  ports.push({\r\n    type: { name: \"boolean\" },\r\n    plug: \"input\",\r\n    group: \"Limit\",\r\n    name: \"storageEnableLimit\",\r\n    displayName: \"Use limit\",\r\n  });\r\n\r\n  if (parameters[\"storageEnableLimit\"]) {\r\n    ports.push({\r\n      type: { name: \"number\" },\r\n      default: 10,\r\n      plug: \"input\",\r\n      group: \"Limit\",\r\n      name: \"storageLimit\",\r\n      displayName: \"Limit\",\r\n    });\r\n\r\n    ports.push({\r\n      type: { name: \"number\" },\r\n      default: 0,\r\n      plug: \"input\",\r\n      group: \"Limit\",\r\n      name: \"storageSkip\",\r\n      displayName: \"Skip\",\r\n    });\r\n  }\r\n\r\n  ports.push({\r\n    type: { name: \"signal\" },\r\n    plug: \"input\",\r\n    group: \"Actions\",\r\n    name: \"storageFetch\",\r\n    displayName: \"Do\",\r\n  });\r\n\r\n  // Total Count\r\n  ports.push({\r\n    type: { name: \"boolean\" },\r\n    plug: \"input\",\r\n    group: \"Total Count\",\r\n    name: \"storageEnableCount\",\r\n    displayName: \"Fetch total count\",\r\n  });\r\n\r\n  if (parameters[\"storageEnableCount\"]) {\r\n    ports.push({\r\n      type: { name: \"number\" },\r\n      plug: \"output\",\r\n      group: \"General\",\r\n      name: \"storageTotalCount\",\r\n      displayName: \"Total Count\",\r\n    });\r\n  }\r\n\r\n  // Simple query\r\n  if (\r\n    parameters[\"storageFilterType\"] === undefined ||\r\n    parameters[\"storageFilterType\"] === \"simple\"\r\n  ) {\r\n    if (parameters.collectionName !== undefined) {\r\n      let c =\r\n        dbCollections &&\r\n        dbCollections.find((c: any) => c.name === parameters.collectionName);\r\n      if (c === undefined && systemCollections)\r\n        c = systemCollections.find(\r\n          (c: any) => c.name === parameters.collectionName\r\n        );\r\n      if (c && c.schema && c.schema.properties) {\r\n        const schema = JSON.parse(JSON.stringify(c.schema));\r\n\r\n        dbCollections?.forEach(_findRelations.bind(null, parameters, schema));\r\n        systemCollections?.forEach(\r\n          _findRelations.bind(null, parameters, schema)\r\n        );\r\n\r\n        ports.push({\r\n          name: \"visualFilter\",\r\n          plug: \"input\",\r\n          type: { name: \"query-filter\", schema: schema, allowEditOnly: true },\r\n          displayName: \"Filter\",\r\n          group: \"Filter\",\r\n        });\r\n\r\n        ports.push({\r\n          name: \"visualSort\",\r\n          plug: \"input\",\r\n          type: { name: \"query-sorting\", schema: schema, allowEditOnly: true },\r\n          displayName: \"Sort\",\r\n          group: \"Sorting\",\r\n        });\r\n      }\r\n\r\n      if (parameters.visualFilter !== undefined) {\r\n        // Find all input ports\r\n        const uniqueInputs: Record<string, boolean> = {};\r\n        _collectInputs(uniqueInputs, parameters.visualFilter);\r\n\r\n        Object.keys(uniqueInputs).forEach((input) => {\r\n          ports.push({\r\n            name: \"qp-\" + input,\r\n            plug: \"input\",\r\n            type: { name: \"*\" },\r\n            displayName: input,\r\n            group: \"Query Parameters\",\r\n          });\r\n        });\r\n      }\r\n    }\r\n  }\r\n  // JSON query\r\n  else if (parameters[\"storageFilterType\"] === \"json\") {\r\n    ports.push({\r\n      type: { name: \"string\", allowEditOnly: true, codeeditor: \"javascript\" },\r\n      plug: \"input\",\r\n      group: \"Filter\",\r\n      name: \"storageJSONFilter\",\r\n      default: _defaultJSONQuery,\r\n      displayName: \"Filter\",\r\n    });\r\n\r\n    let filter = String(parameters[\"storageJSONFilter\"]);\r\n    if (filter) {\r\n      filter = filter.replace(/\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*/g, \"\"); // Remove comments\r\n      const variables = filter.match(/\\$[A-Za-z0-9]+/g);\r\n\r\n      if (variables) {\r\n        const unique: Record<string, boolean> = {};\r\n        variables.forEach((v) => {\r\n          unique[v] = true;\r\n        });\r\n\r\n        Object.keys(unique).forEach((p) => {\r\n          ports.push({\r\n            name: \"storageFilterValue-\" + p.substring(1),\r\n            displayName: p.substring(1),\r\n            group: \"Filter Values\",\r\n            plug: \"input\",\r\n            type: { name: \"*\", allowConnectionsOnly: true },\r\n          });\r\n        });\r\n      }\r\n\r\n      // Support variables with the \"Inputs.\"\" syntax\r\n      JavascriptNodeParser.parseAndAddPortsFromScript(filter, ports, {\r\n        inputPrefix: \"storageFilterValue-\",\r\n        inputGroup: \"Filter Values\",\r\n        inputType: { name: \"*\", allowConnectionsOnly: true },\r\n        skipOutputs: true,\r\n      });\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    updatePorts(node.id, node.parameters, context.editorConnection, graphModel);\r\n\r\n    node.on(\"parameterUpdated\", function (event: { name: string }) {\r\n      if (\r\n        event.name.startsWith(\"storage\") ||\r\n        event.name === \"visualFilter\" ||\r\n        event.name === \"collectionName\"\r\n      ) {\r\n        updatePorts(\r\n          node.id,\r\n          node.parameters,\r\n          context.editorConnection,\r\n          graphModel\r\n        );\r\n      }\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.dbCollections\", function () {\r\n      CloudStore.invalidateCollections();\r\n      updatePorts(\r\n        node.id,\r\n        node.parameters,\r\n        context.editorConnection,\r\n        graphModel\r\n      );\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.systemCollections\", function () {\r\n      CloudStore.invalidateCollections();\r\n      updatePorts(\r\n        node.id,\r\n        node.parameters,\r\n        context.editorConnection,\r\n        graphModel\r\n      );\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.cloudservices\", function () {\r\n      CloudStore.instance._initCloudServices();\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.DbCollection2\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"DbCollection2\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n\r\ninterface QueryRule {\r\n  rules?: QueryRule[];\r\n  input?: string;\r\n}\r\n\r\nfunction _collectInputs(\r\n  uniqueInputs: Record<string, boolean>,\r\n  query: QueryRule | undefined\r\n) {\r\n  if (query === undefined) {\r\n    return;\r\n  }\r\n\r\n  if (query.rules !== undefined) {\r\n    query.rules.forEach((r: QueryRule) => _collectInputs(uniqueInputs, r));\r\n  } else if (query.input !== undefined) {\r\n    uniqueInputs[query.input] = true;\r\n  }\r\n}\r\n\r\n// Find all records that have a relation with this type\r\nfunction _findRelations(\r\n  parameters: any,\r\n  schema: any,\r\n  c: {\r\n    name: string;\r\n    schema?: {\r\n      properties?: {\r\n        [key: string]: {\r\n          type: string;\r\n          targetClass?: string;\r\n        };\r\n      };\r\n    };\r\n  }\r\n) {\r\n  if (c.schema !== undefined && c.schema.properties !== undefined) {\r\n    for (const key in c.schema.properties) {\r\n      const p = c.schema.properties[key];\r\n      if (\r\n        p.type === \"Relation\" &&\r\n        p.targetClass === parameters.collectionName\r\n      ) {\r\n        if (schema.relations === undefined) schema.relations = {};\r\n        if (schema.relations[c.name] === undefined)\r\n          schema.relations[c.name] = [];\r\n\r\n        schema.relations[c.name].push({ property: key });\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { Model } from \"../../../model\";\r\nimport { CloudStore } from \"../../../api/cloudstore\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\nimport { createSetter } from \"../../../edgetriggeredinput\";\r\nimport { NodeContext } from \"../../../nodecontext\";\r\nimport { GraphModel } from \"../../../models/graphmodel\";\r\nimport { Port } from \"../../../models/componentmodel\";\r\n\r\ninterface Internal {\r\n  inputValues: Record<string, any>;\r\n  relationModelIds: Record<string, any>;\r\n  onModelChangedCallback?: (args: { name: string }) => void;\r\n  model?: Model;\r\n  modelId?: string;\r\n  collectionId?: string;\r\n  error?: string;\r\n  [key: string]: any;\r\n}\r\n\r\ninterface Parameters {\r\n  collectionName?: string;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"DbModel2\",\r\n  docs: \"https://docs.noodl.net/nodes/data/cloud-data/record\",\r\n  displayNodeName: \"Record\",\r\n  shortDesc: \"Database model\",\r\n  category: \"Cloud Services\",\r\n  usePortAsLabel: \"collectionName\",\r\n  color: \"data\",\r\n  dynamicports: [\r\n    {\r\n      name: \"conditionalports/extended\",\r\n      condition: \"idSource = explicit OR idSource NOT SET\",\r\n      inputs: [\"modelId\"],\r\n    },\r\n  ],\r\n  initialize: function () {\r\n    const internal = this._internal;\r\n    internal.inputValues = {};\r\n    internal.relationModelIds = {};\r\n\r\n    const _this = this;\r\n    this._internal.onModelChangedCallback = function (args) {\r\n      if (_this.isInputConnected(\"fetch\")) return;\r\n\r\n      if (_this.hasOutput(\"prop-\" + args.name))\r\n        _this.flagOutputDirty(\"prop-\" + args.name);\r\n\r\n      if (_this.hasOutput(\"changed-\" + args.name))\r\n        _this.sendSignalOnOutput(\"changed-\" + args.name);\r\n\r\n      _this.sendSignalOnOutput(\"changed\");\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return \"[No Record]\";\r\n\r\n    return [\r\n      { type: \"text\", value: \"Id: \" + model.getId() },\r\n      { type: \"value\", value: model.data },\r\n    ];\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: \"string\",\r\n      displayName: \"Id\",\r\n      group: \"General\",\r\n      getter: function () {\r\n        return this._internal.model\r\n          ? this._internal.model.getId()\r\n          : this._internal.modelId;\r\n      },\r\n    },\r\n    fetched: {\r\n      type: \"signal\",\r\n      displayName: \"Fetched\",\r\n      group: \"Events\",\r\n    },\r\n    changed: {\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n      group: \"Events\",\r\n    },\r\n    failure: {\r\n      type: \"signal\",\r\n      displayName: \"Failure\",\r\n      group: \"Events\",\r\n    },\r\n    error: {\r\n      type: \"string\",\r\n      displayName: \"Error\",\r\n      group: \"Error\",\r\n      getter: function () {\r\n        return this._internal.error;\r\n      },\r\n    },\r\n  },\r\n  inputs: {\r\n    idSource: {\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Specify explicitly\", value: \"explicit\" },\r\n          { label: \"From repeater\", value: \"foreach\" },\r\n        ],\r\n        allowEditOnly: true,\r\n      },\r\n      default: \"explicit\",\r\n      displayName: \"Id Source\",\r\n      group: \"General\",\r\n      set(value) {\r\n        if (value === \"foreach\") {\r\n          this.scheduleAfterInputsHaveUpdated(() => {\r\n            // Find closest nodescope that have a _forEachModel\r\n            let component = this.nodeScope!.componentOwner;\r\n            while (\r\n              component !== undefined &&\r\n              component._forEachModel === undefined &&\r\n              component.parentNodeScope\r\n            ) {\r\n              component = component.parentNodeScope.componentOwner;\r\n            }\r\n            // @ts-expect-error\r\n            this.setModel(\r\n              component !== undefined ? component._forEachModel : undefined\r\n            );\r\n          });\r\n        }\r\n      },\r\n    },\r\n    modelId: {\r\n      type: { name: \"string\", allowConnectionsOnly: true },\r\n      displayName: \"Id\",\r\n      group: \"General\",\r\n      set(value: string | Model | object) {\r\n        if (value instanceof Model) {\r\n          // Can be passed as model as well\r\n          value = value.getId();\r\n        } else if (typeof value === \"object\") {\r\n          // If this is an js object, dereference it\r\n          value = Model.create(value).getId();\r\n        }\r\n\r\n        this._internal.modelId = value; // Wait to fetch data\r\n        if (this.isInputConnected(\"fetch\") === false) {\r\n          // @ts-expect-error\r\n          this.setModelID(value);\r\n        } else {\r\n          this.flagOutputDirty(\"id\");\r\n        }\r\n      },\r\n    },\r\n    fetch: {\r\n      displayName: \"Fetch\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleFetch();\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    setCollectionID(id: string) {\r\n      this._internal.collectionId = id;\r\n    },\r\n    setModelID(id: string) {\r\n      const model = (this.nodeScope!.modelScope || Model).get(id);\r\n      // @ts-expect-error\r\n      this.setModel(model);\r\n    },\r\n    setModel(model: Model) {\r\n      if (this._internal.model) {\r\n        // Remove old listener if existing\r\n        this._internal.model.off(\r\n          \"change\",\r\n          // @ts-expect-error\r\n          this._internal.onModelChangedCallback\r\n        );\r\n      }\r\n\r\n      this._internal.model = model;\r\n      this.flagOutputDirty(\"id\");\r\n      // @ts-expect-error\r\n      model.on(\"change\", this._internal.onModelChangedCallback);\r\n\r\n      // We have a new model, mark all outputs as dirty\r\n      for (const key in model.data) {\r\n        if (this.hasOutput(\"prop-\" + key)) {\r\n          this.flagOutputDirty(\"prop-\" + key);\r\n        }\r\n      }\r\n      this.sendSignalOnOutput(\"fetched\");\r\n    },\r\n    _onNodeDeleted() {\r\n      // @ts-expect-error\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      if (this._internal.model)\r\n        this._internal.model.off(\r\n          \"change\",\r\n          // @ts-expect-error\r\n          this._internal.onModelChangedCallback\r\n        );\r\n    },\r\n    scheduleOnce(type: string, cb: () => void) {\r\n      const _this = this;\r\n      const _type = \"hasScheduled\" + type;\r\n      if (this._internal[_type]) return;\r\n      this._internal[_type] = true;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this._internal[_type] = false;\r\n        cb();\r\n      });\r\n    },\r\n    setError(err: string) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty(\"error\");\r\n      this.sendSignalOnOutput(\"failure\");\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          this.nodeScope!.componentOwner.name,\r\n          this.id,\r\n          \"storage-op-warning\",\r\n          {\r\n            message: err,\r\n            showGlobally: true,\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          this.nodeScope!.componentOwner.name,\r\n          this.id,\r\n          \"storage-op-warning\"\r\n        );\r\n      }\r\n    },\r\n    scheduleFetch() {\r\n      const _this = this;\r\n      const internal = this._internal;\r\n\r\n      // @ts-expect-error\r\n      this.scheduleOnce(\"Fetch\", function () {\r\n        // Don't do fetch if no id\r\n        if (internal.modelId === undefined || internal.modelId === \"\") {\r\n          // @ts-expect-error\r\n          _this.setError(\"Missing Id.\");\r\n          return;\r\n        }\r\n\r\n        // @ts-expect-error\r\n        const cloudstore = CloudStore.forScope(_this.nodeScope.modelScope);\r\n        cloudstore.fetch({\r\n          // @ts-expect-error\r\n          collection: internal.collectionId,\r\n          objectId: internal.modelId, // Get the objectId part of the model id\r\n          success: function (response: any) {\r\n            // @ts-expect-error\r\n            const model = cloudstore._fromJSON(response, internal.collectionId);\r\n            if (internal.model !== model) {\r\n              // Check if we need to change model\r\n              if (internal.model) {\r\n                // Remove old listener if existing\r\n                // @ts-expect-error\r\n                internal.model.off(\"change\", internal.onModelChangedCallback);\r\n              }\r\n\r\n              internal.model = model;\r\n              model.on(\"change\", internal.onModelChangedCallback);\r\n            }\r\n            _this.flagOutputDirty(\"id\");\r\n\r\n            delete response.objectId;\r\n\r\n            for (const key in response) {\r\n              if (_this.hasOutput(\"prop-\" + key)) {\r\n                _this.flagOutputDirty(\"prop-\" + key);\r\n              }\r\n            }\r\n\r\n            _this.sendSignalOnOutput(\"fetched\");\r\n          },\r\n          error: function (err: string) {\r\n            // @ts-expect-error\r\n            _this.setError(err || \"Failed to fetch.\");\r\n          },\r\n        });\r\n      });\r\n    },\r\n    scheduleStore: function () {\r\n      const internal = this._internal;\r\n      if (!internal.model) return;\r\n\r\n      // @ts-expect-error\r\n      this.scheduleOnce(\"Store\", function () {\r\n        for (const i in internal.inputValues) {\r\n          // @ts-expect-error\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n      });\r\n    },\r\n    registerOutputIfNeeded: function (name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"prop-\"))\r\n        this.registerOutput(name, {\r\n          getter: userOutputGetter.bind(this, name.substring(\"prop-\".length)),\r\n        });\r\n    },\r\n    registerInputIfNeeded: function (name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      const dynamicSignals: Record<string, () => void> = {};\r\n\r\n      if (dynamicSignals[name])\r\n        return this.registerInput(name, {\r\n          set: createSetter({\r\n            valueChangedToTrue: dynamicSignals[name],\r\n          }),\r\n        });\r\n\r\n      const dynamicSetters: Record<string, (value: any) => void> = {\r\n        // @ts-expect-error\r\n        collectionName: this.setCollectionID.bind(this),\r\n      };\r\n\r\n      if (dynamicSetters[name])\r\n        return this.registerInput(name, {\r\n          set: dynamicSetters[name],\r\n        });\r\n\r\n      if (name.startsWith(\"prop-\"))\r\n        this.registerInput(name, {\r\n          set: userInputSetter.bind(this, name.substring(\"prop-\".length)),\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\nfunction userOutputGetter(name: string) {\r\n  // @ts-expect-error\r\n  return this._internal.model\r\n    ? // @ts-expect-error\r\n      this._internal.model.get(name, { resolve: true })\r\n    : undefined;\r\n}\r\n\r\nfunction userInputSetter(name: string, value: any) {\r\n  // @ts-expect-error\r\n  this._internal.inputValues[name] = value;\r\n}\r\n\r\nfunction updatePorts(\r\n  nodeId: string,\r\n  parameters: Parameters,\r\n  editorConnection: any,\r\n  graphModel: any\r\n) {\r\n  const ports: Port[] = [];\r\n\r\n  const dbCollections = graphModel.getMetaData(\"dbCollections\");\r\n  const systemCollections = graphModel.getMetaData(\"systemCollections\");\r\n\r\n  const _systemClasses = [\r\n    { label: \"User\", value: \"_User\" },\r\n    { label: \"Role\", value: \"_Role\" },\r\n  ];\r\n  ports.push({\r\n    name: \"collectionName\",\r\n    displayName: \"Class\",\r\n    group: \"General\",\r\n    type: {\r\n      name: \"enum\",\r\n      enums: _systemClasses.concat(\r\n        dbCollections !== undefined\r\n          ? dbCollections.map((c) => {\r\n              return { value: c.name, label: c.name };\r\n            })\r\n          : []\r\n      ),\r\n      allowEditOnly: true,\r\n    },\r\n    plug: \"input\",\r\n  });\r\n\r\n  if (parameters.collectionName && dbCollections) {\r\n    // Fetch ports from collection keys\r\n    let c = dbCollections.find((c) => c.name === parameters.collectionName);\r\n    if (c === undefined && systemCollections)\r\n      c = systemCollections.find((c) => c.name === parameters.collectionName);\r\n    if (c && c.schema && c.schema.properties) {\r\n      const props = c.schema.properties;\r\n      for (const key in props) {\r\n        const p = props[key];\r\n        if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n        if (p.type !== \"Relation\") {\r\n          // Other schema type ports\r\n          const _typeMap: Record<string, string> = {\r\n            String: \"string\",\r\n            Boolean: \"boolean\",\r\n            Number: \"number\",\r\n            Date: \"date\",\r\n          };\r\n\r\n          ports.push({\r\n            type: {\r\n              name: _typeMap[p.type] ? _typeMap[p.type] : \"*\",\r\n            },\r\n            plug: \"output\",\r\n            group: \"Properties\",\r\n            name: \"prop-\" + key,\r\n            displayName: key,\r\n          });\r\n\r\n          ports.push({\r\n            type: \"signal\",\r\n            plug: \"output\",\r\n            group: \"Changed Events\",\r\n            displayName: key + \" Changed\",\r\n            name: \"changed-\" + key,\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    updatePorts(node.id, node.parameters, context.editorConnection, graphModel);\r\n\r\n    node.on(\"parameterUpdated\", function () {\r\n      updatePorts(\r\n        node.id,\r\n        node.parameters,\r\n        context.editorConnection,\r\n        graphModel\r\n      );\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.dbCollections\", function () {\r\n      CloudStore.invalidateCollections();\r\n      updatePorts(\r\n        node.id,\r\n        node.parameters,\r\n        context.editorConnection,\r\n        graphModel\r\n      );\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.systemCollections\", function () {\r\n      CloudStore.invalidateCollections();\r\n      updatePorts(\r\n        node.id,\r\n        node.parameters,\r\n        context.editorConnection,\r\n        graphModel\r\n      );\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.DbModel2\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"DbModel2\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import { Model, ModelScope } from \"../../../model\";\r\nimport { CloudStore } from \"../../../api/cloudstore\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\nimport type { NodeModule } from \"../../../runtime\";\r\n\r\ninterface BaseOptions {\r\n  includeInputProperties?: boolean;\r\n  includeRelations?: boolean;\r\n  includeInputs?: boolean;\r\n  includeOutputs?: boolean;\r\n}\r\n\r\nfunction _addBaseInfo<TInternal extends Record<string, any> = {}>(\r\n  def: NodeModule<TInternal>,\r\n  opts?: BaseOptions\r\n): void {\r\n  const _includeInputProperties =\r\n    opts === undefined || opts.includeInputProperties;\r\n  const _includeRelations = opts !== undefined && opts.includeRelations;\r\n\r\n  Object.assign(def.node, {\r\n    category: \"Data\",\r\n    color: \"data\",\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {},\r\n  });\r\n\r\n  // Outputs\r\n  // @ts-expect-error\r\n  Object.assign(def.node.outputs, {\r\n    failure: {\r\n      type: \"signal\",\r\n      displayName: \"Failure\",\r\n      group: \"Events\",\r\n    },\r\n    error: {\r\n      type: \"string\",\r\n      displayName: \"Error\",\r\n      group: \"Error\",\r\n      getter: function () {\r\n        // @ts-expect-error\r\n        return this._internal.error;\r\n      },\r\n    },\r\n  });\r\n\r\n  // Methods\r\n  // @ts-expect-error\r\n  Object.assign(def.node.methods, {\r\n    scheduleOnce: function (type: string, cb: () => void) {\r\n      const _this = this;\r\n      const _type = \"hasScheduled\" + type;\r\n      // @ts-expect-error\r\n      if (this._internal[_type]) return;\r\n      // @ts-expect-error\r\n      this._internal[_type] = true;\r\n      // @ts-expect-error\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        // @ts-expect-error\r\n        _this._internal[_type] = false;\r\n        cb();\r\n      });\r\n    },\r\n    checkWarningsBeforeCloudOp() {\r\n      //clear all errors first\r\n      // @ts-expect-error\r\n      this.clearWarnings();\r\n\r\n      // @ts-expect-error\r\n      if (!this._internal.collectionId) {\r\n        // @ts-expect-error\r\n        this.setError(\"No class name specified\");\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    },\r\n    setError: function (err: string) {\r\n      // @ts-expect-error\r\n      this._internal.error = err;\r\n      // @ts-expect-error\r\n      this.flagOutputDirty(\"error\");\r\n      // @ts-expect-error\r\n      this.sendSignalOnOutput(\"failure\");\r\n\r\n      // @ts-expect-error\r\n      if (this.context.editorConnection) {\r\n        // @ts-expect-error\r\n        this.context.editorConnection.sendWarning(\r\n          // @ts-expect-error\r\n          this.nodeScope.componentOwner.name,\r\n          // @ts-expect-error\r\n          this.id,\r\n          \"storage-op-warning\",\r\n          {\r\n            message: err,\r\n            showGlobally: true,\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      // @ts-expect-error\r\n      if (this.context.editorConnection) {\r\n        // @ts-expect-error\r\n        this.context.editorConnection.clearWarning(\r\n          // @ts-expect-error\r\n          this.nodeScope.componentOwner.name,\r\n          // @ts-expect-error\r\n          this.id,\r\n          \"storage-op-warning\"\r\n        );\r\n      }\r\n    },\r\n  });\r\n\r\n  // Setup\r\n  Object.assign(def, {\r\n    setup: function (context: any, graphModel: any) {\r\n      if (\r\n        !context.editorConnection ||\r\n        !context.editorConnection.isRunningLocally()\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      function _managePortsForNode(node: any) {\r\n        function _updatePorts() {\r\n          const ports: any[] = [];\r\n\r\n          const dbCollections = graphModel.getMetaData(\"dbCollections\");\r\n          const systemCollections = graphModel.getMetaData(\"systemCollections\");\r\n\r\n          const _systemClasses = [\r\n            { label: \"User\", value: \"_User\" },\r\n            { label: \"Role\", value: \"_Role\" },\r\n          ];\r\n\r\n          const parameters = node.parameters;\r\n\r\n          ports.push({\r\n            name: \"collectionName\",\r\n            displayName: \"Class\",\r\n            group: \"General\",\r\n            type: {\r\n              name: \"enum\",\r\n              enums: _systemClasses.concat(\r\n                dbCollections !== undefined\r\n                  ? dbCollections.map((c: any) => {\r\n                      return { value: c.name, label: c.name };\r\n                    })\r\n                  : []\r\n              ),\r\n              allowEditOnly: true,\r\n            },\r\n            plug: \"input\",\r\n          });\r\n\r\n          if (_includeRelations && parameters.collectionName && dbCollections) {\r\n            // Fetch ports from collection keys\r\n            let c = dbCollections.find(\r\n              (c: any) => c.name === parameters.collectionName\r\n            );\r\n            if (c === undefined && systemCollections)\r\n              c = systemCollections.find(\r\n                (c: any) => c.name === parameters.collectionName\r\n              );\r\n            if (c && c.schema && c.schema.properties) {\r\n              const props = c.schema.properties;\r\n              const enums = Object.keys(props)\r\n                .filter((key) => props[key].type === \"Relation\")\r\n                .map((key) => ({ label: key, value: key }));\r\n\r\n              ports.push({\r\n                name: \"relationProperty\",\r\n                displayName: \"Relation\",\r\n                group: \"General\",\r\n                type: { name: \"enum\", enums: enums, allowEditOnly: true },\r\n                plug: \"input\",\r\n              });\r\n            }\r\n          }\r\n\r\n          if (\r\n            _includeInputProperties &&\r\n            parameters.collectionName &&\r\n            dbCollections\r\n          ) {\r\n            const _typeMap: { [key: string]: string } = {\r\n              String: \"string\",\r\n              Boolean: \"boolean\",\r\n              Number: \"number\",\r\n              Date: \"date\",\r\n            };\r\n\r\n            // Fetch ports from collection keys\r\n            let c = dbCollections.find(\r\n              (c: any) => c.name === parameters.collectionName\r\n            );\r\n            if (c === undefined && systemCollections)\r\n              c = systemCollections.find(\r\n                (c: any) => c.name === parameters.collectionName\r\n              );\r\n            if (c && c.schema && c.schema.properties) {\r\n              const props = c.schema.properties;\r\n              for (const key in props) {\r\n                const p = props[key];\r\n                if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n                ports.push({\r\n                  type: {\r\n                    name: _typeMap[p.type] ? _typeMap[p.type] : \"*\",\r\n                  },\r\n                  plug: \"input\",\r\n                  group: \"Properties\",\r\n                  name: \"prop-\" + key,\r\n                  displayName: key,\r\n                });\r\n              }\r\n            }\r\n          }\r\n\r\n          // @ts-expect-error\r\n          def._additionalDynamicPorts?.(node, ports, graphModel);\r\n\r\n          context.editorConnection.sendDynamicPorts(node.id, ports);\r\n        }\r\n\r\n        _updatePorts();\r\n\r\n        node.on(\"parameterUpdated\", function () {\r\n          _updatePorts();\r\n        });\r\n\r\n        graphModel.on(\"metadataChanged.dbCollections\", function () {\r\n          CloudStore.invalidateCollections();\r\n          _updatePorts();\r\n        });\r\n\r\n        graphModel.on(\"metadataChanged.systemCollections\", function () {\r\n          CloudStore.invalidateCollections();\r\n          _updatePorts();\r\n        });\r\n      }\r\n\r\n      graphModel.on(\"editorImportComplete\", () => {\r\n        graphModel.on(\"nodeAdded.\" + def.node.name, function (node: any) {\r\n          _managePortsForNode(node);\r\n        });\r\n\r\n        for (const node of graphModel.getNodesWithType(def.node.name)) {\r\n          _managePortsForNode(node);\r\n        }\r\n      });\r\n    },\r\n  });\r\n}\r\n\r\nfunction _addModelId(\r\n  def: {\r\n    node: NodeDefinition<any>;\r\n  },\r\n  opts?: BaseOptions\r\n) {\r\n  const _methods = Object.assign({}, def.node.methods);\r\n\r\n  const _includeInputs = opts === undefined || opts.includeInputs;\r\n  const _includeOutputs = opts === undefined || opts.includeOutputs;\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {},\r\n  });\r\n\r\n  if (_includeInputs) {\r\n    Object.assign(def.node, {\r\n      usePortAsLabel: \"collectionName\",\r\n    });\r\n\r\n    def.node.dynamicports = (def.node.dynamicports || []).concat([\r\n      {\r\n        name: \"conditionalports/extended\",\r\n        condition: \"idSource = explicit OR idSource NOT SET\",\r\n        inputs: [\"modelId\"],\r\n      },\r\n    ]);\r\n\r\n    // Inputs\r\n    // @ts-expect-error\r\n    Object.assign(def.node.inputs, {\r\n      idSource: {\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"Specify explicitly\", value: \"explicit\" },\r\n            { label: \"From repeater\", value: \"foreach\" },\r\n          ],\r\n          allowEditOnly: true,\r\n        },\r\n        default: \"explicit\",\r\n        displayName: \"Id Source\",\r\n        group: \"General\",\r\n        tooltip:\r\n          \"Choose if you want to specify the Id explicitly, \\n or if you want it to be that of the current record in a repeater.\",\r\n        set: function (value: string) {\r\n          if (value === \"foreach\") {\r\n            // @ts-expect-error\r\n            this.scheduleAfterInputsHaveUpdated(() => {\r\n              // Find closest nodescope that have a _forEachModel\r\n              // @ts-expect-error\r\n              let component = this.nodeScope.componentOwner;\r\n              while (\r\n                component !== undefined &&\r\n                component._forEachModel === undefined &&\r\n                component.parentNodeScope\r\n              ) {\r\n                component = component.parentNodeScope.componentOwner;\r\n              }\r\n              // @ts-expect-error\r\n              this.setModel(\r\n                component !== undefined ? component._forEachModel : undefined\r\n              );\r\n            });\r\n          }\r\n        },\r\n      },\r\n      modelId: {\r\n        type: {\r\n          name: \"string\",\r\n          identifierOf: \"ModelName\",\r\n          identifierDisplayName: \"Object Ids\",\r\n        },\r\n        displayName: \"Id\",\r\n        group: \"General\",\r\n        set: function (value: any) {\r\n          if (value instanceof Model) value = value.getId(); // Can be passed as model as well\r\n          // @ts-expect-error\r\n          this._internal.modelId = value; // Wait to fetch data\r\n          // @ts-expect-error\r\n          this.setModelID(value);\r\n        },\r\n      },\r\n    });\r\n  }\r\n\r\n  // Outputs\r\n  if (_includeOutputs) {\r\n    // @ts-expect-error\r\n    Object.assign(def.node.outputs, {\r\n      id: {\r\n        type: \"string\",\r\n        displayName: \"Id\",\r\n        group: \"General\",\r\n        getter: function () {\r\n          // @ts-expect-error\r\n          return this._internal.model\r\n            ? // @ts-expect-error\r\n              this._internal.model.getId()\r\n            : // @ts-expect-error\r\n              this._internal.modelId;\r\n        },\r\n      },\r\n    });\r\n  }\r\n\r\n  // Methods\r\n  // @ts-expect-error\r\n  Object.assign(def.node.methods, {\r\n    setCollectionID: function (id: string) {\r\n      // @ts-expect-error\r\n      this._internal.collectionId = id;\r\n      // @ts-expect-error\r\n      this.clearWarnings();\r\n    },\r\n    setModelID: function (id: string) {\r\n      // @ts-expect-error\r\n      const model = (this.nodeScope.modelScope || Model).get(id);\r\n      // @ts-expect-error\r\n      this.setModel(model);\r\n    },\r\n    setModel: function (model: any) {\r\n      // @ts-expect-error\r\n      this._internal.model = model;\r\n      // @ts-expect-error\r\n      this.flagOutputDirty(\"id\");\r\n    },\r\n    registerInputIfNeeded: function (name: string) {\r\n      // @ts-expect-error\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"collectionName\")\r\n        // @ts-expect-error\r\n        this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setCollectionID.bind(this),\r\n        });\r\n\r\n      _methods &&\r\n        _methods.registerInputIfNeeded &&\r\n        // @ts-expect-error\r\n        _methods.registerInputIfNeeded.call(this, name);\r\n    },\r\n  });\r\n}\r\n\r\nfunction _addInputProperties<TInternal extends Record<string, any> = {}>(\r\n  def: NodeModule<TInternal>\r\n) {\r\n  const _def = { node: Object.assign({}, def.node), setup: def.setup };\r\n  const _methods = Object.assign({}, def.node.methods);\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {},\r\n  });\r\n\r\n  Object.assign(def.node, {\r\n    initialize: function () {\r\n      // @ts-expect-error\r\n      const internal = this._internal;\r\n      internal.inputValues = {};\r\n\r\n      // @ts-expect-error\r\n      _def.node.initialize && _def.node.initialize.call(this);\r\n    },\r\n  });\r\n\r\n  // Outputs\r\n  // @ts-expect-error\r\n  Object.assign(def.node.outputs, {});\r\n\r\n  // Inputs\r\n  // @ts-expect-error\r\n  Object.assign(def.node.inputs, {});\r\n\r\n  // Methods\r\n  // @ts-expect-error\r\n  Object.assign(def.node.methods, {\r\n    registerInputIfNeeded: function (name: string) {\r\n      // @ts-expect-error\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"prop-\"))\r\n        // @ts-expect-error\r\n        this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this._setInputValue.bind(this, name.substring(\"prop-\".length)),\r\n        });\r\n\r\n      _methods &&\r\n        _methods.registerInputIfNeeded &&\r\n        // @ts-expect-error\r\n        _methods.registerInputIfNeeded.call(this, name);\r\n    },\r\n    _setInputValue: function (name: string, value: any) {\r\n      // @ts-expect-error\r\n      this._internal.inputValues[name] = value;\r\n    },\r\n  });\r\n}\r\n\r\nfunction _addRelationProperty(def: NodeModule) {\r\n  const _methods = Object.assign({}, def.node.methods);\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {},\r\n  });\r\n\r\n  // Inputs\r\n  // @ts-expect-error\r\n  Object.assign(def.node.inputs, {\r\n    targetId: {\r\n      type: { name: \"string\", allowConnectionsOnly: true },\r\n      displayName: \"Target Record Id\",\r\n      group: \"General\",\r\n      set: function (value: string) {\r\n        // @ts-expect-error\r\n        this._internal.targetModelId = value;\r\n      },\r\n    },\r\n  });\r\n\r\n  // Methods\r\n  // @ts-expect-error\r\n  Object.assign(def.node.methods, {\r\n    registerInputIfNeeded: function (name: string) {\r\n      // @ts-expect-error\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"relationProperty\")\r\n        // @ts-expect-error\r\n        this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setRelationProperty.bind(this),\r\n        });\r\n\r\n      _methods &&\r\n        _methods.registerInputIfNeeded &&\r\n        // @ts-expect-error\r\n        _methods.registerInputIfNeeded.call(this, name);\r\n    },\r\n    setRelationProperty: function (value: string) {\r\n      // @ts-expect-error\r\n      this._internal.relationProperty = value;\r\n    },\r\n  });\r\n}\r\n\r\nfunction _getCurrentUser(modelScope: ModelScope): string | undefined {\r\n  // @ts-expect-error _noodl_cloud_runtime_version\r\n  if (typeof _noodl_cloud_runtime_version === \"undefined\") {\r\n    // We are running in browser, try to find the current user\r\n\r\n    const _cu =\r\n      localStorage[\"Parse/\" + CloudStore.instance.appId + \"/currentUser\"];\r\n    if (_cu !== undefined) {\r\n      let cu;\r\n      try {\r\n        cu = JSON.parse(_cu);\r\n      } catch (e) {}\r\n\r\n      return cu !== undefined ? cu.objectId : undefined;\r\n    }\r\n  } else {\r\n    // Assume we are running in cloud runtime\r\n    const request = modelScope.get(\"Request\");\r\n    // @ts-expect-error\r\n    return request.UserId;\r\n  }\r\n}\r\n\r\ninterface AccessControlRule {\r\n  id: string;\r\n  label: string;\r\n}\r\n\r\nfunction _addAccessControl<TInternal extends Record<string, any> = {}>(\r\n  def: NodeModule<TInternal>\r\n) {\r\n  const _def = { node: Object.assign({}, def.node), setup: def.setup };\r\n  const _methods = Object.assign({}, def.node.methods);\r\n\r\n  Object.assign(def.node, {\r\n    inputs: def.node.inputs || {},\r\n    outputs: def.node.outputs || {},\r\n    methods: def.node.methods || {},\r\n  });\r\n\r\n  Object.assign(def.node, {\r\n    initialize() {\r\n      // @ts-expect-error\r\n      const internal = this._internal;\r\n      internal.accessControl = {};\r\n\r\n      // @ts-expect-error\r\n      _def.node.initialize && _def.node.initialize.call(this);\r\n    },\r\n  });\r\n\r\n  // Inputs\r\n  // @ts-expect-error\r\n  Object.assign(def.node.inputs, {\r\n    accessControl: {\r\n      type: { name: \"proplist\", autoName: \"Rule\", allowEditOnly: true },\r\n      index: 1000,\r\n      displayName: \"Access Control Rules\",\r\n      group: \"Access Control Rules\",\r\n      set(value: AccessControlRule[]) {\r\n        // @ts-expect-error\r\n        this._internal.accessControlRules = value;\r\n      },\r\n    },\r\n  });\r\n\r\n  // Dynamic ports\r\n  // @ts-expect-error\r\n  const _super = def._additionalDynamicPorts;\r\n  // @ts-expect-error\r\n  def._additionalDynamicPorts = function (\r\n    node: any,\r\n    ports: any[],\r\n    graphModel: any\r\n  ) {\r\n    if (\r\n      node.parameters[\"accessControl\"] !== undefined &&\r\n      node.parameters[\"accessControl\"].length > 0\r\n    ) {\r\n      node.parameters[\"accessControl\"].forEach((ac: AccessControlRule) => {\r\n        const prefix = \"acl-\" + ac.id;\r\n        // User or role?\r\n        ports.push({\r\n          name: prefix + \"-target\",\r\n          displayName: \"Target\",\r\n          editorName: ac.label + \" | Target\",\r\n          plug: \"input\",\r\n          type: {\r\n            name: \"enum\",\r\n            enums: [\r\n              { value: \"user\", label: \"User\" },\r\n              { value: \"everyone\", label: \"Everyone\" },\r\n              { value: \"role\", label: \"Role\" },\r\n            ],\r\n            allowEditOnly: true,\r\n          },\r\n          group: ac.label + \" Access Rule\",\r\n          default: \"user\",\r\n          parent: \"accessControl\",\r\n          parentItemId: ac.id,\r\n        });\r\n\r\n        if (node.parameters[prefix + \"-target\"] === \"role\") {\r\n          ports.push({\r\n            name: prefix + \"-role\",\r\n            displayName: \"Role\",\r\n            editorName: ac.label + \" | Role\",\r\n            group: ac.label + \" Access Rule\",\r\n            plug: \"input\",\r\n            type: \"string\",\r\n            parent: \"accessControl\",\r\n            parentItemId: ac.id,\r\n          });\r\n        } else if (\r\n          node.parameters[prefix + \"-target\"] === undefined ||\r\n          node.parameters[prefix + \"-target\"] === \"user\"\r\n        ) {\r\n          ports.push({\r\n            name: prefix + \"-userid\",\r\n            displayName: \"User Id\",\r\n            group: ac.label + \" Access Rule\",\r\n            editorName: ac.label + \" | User Id\",\r\n            plug: \"input\",\r\n            type: { name: \"string\", allowConnectionsOnly: true },\r\n            parent: \"accessControl\",\r\n            parentItemId: ac.id,\r\n          });\r\n        }\r\n\r\n        // Read\r\n        ports.push({\r\n          name: prefix + \"-read\",\r\n          displayName: \"Read\",\r\n          editorName: ac.label + \" | Read\",\r\n          group: ac.label + \" Access Rule\",\r\n          plug: \"input\",\r\n          type: { name: \"boolean\" },\r\n          default: true,\r\n          parent: \"accessControl\",\r\n          parentItemId: ac.id,\r\n        });\r\n\r\n        // Write\r\n        ports.push({\r\n          name: prefix + \"-write\",\r\n          displayName: \"Write\",\r\n          editorName: ac.label + \" | Write\",\r\n          group: ac.label + \" Access Rule\",\r\n          plug: \"input\",\r\n          type: { name: \"boolean\" },\r\n          default: true,\r\n          parent: \"accessControl\",\r\n          parentItemId: ac.id,\r\n        });\r\n      });\r\n    }\r\n\r\n    _super && _super(node, ports, graphModel);\r\n  };\r\n\r\n  // Methods\r\n  // @ts-expect-error\r\n  Object.assign(def.node.methods, {\r\n    registerInputIfNeeded: function (name: string) {\r\n      // @ts-expect-error\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"acl-\"))\r\n        // @ts-expect-error\r\n        this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setAccessControl.bind(this, name),\r\n        });\r\n\r\n      _methods &&\r\n        _methods.registerInputIfNeeded &&\r\n        // @ts-expect-error\r\n        _methods.registerInputIfNeeded.call(this, name);\r\n    },\r\n    _getACL: function () {\r\n      let acl: { [key: string]: { read: boolean; write: boolean } } = {};\r\n\r\n      function _rule(rule: any) {\r\n        return {\r\n          read: rule.read === undefined ? true : rule.read,\r\n          write: rule.write === undefined ? true : rule.write,\r\n        };\r\n      }\r\n\r\n      // @ts-expect-error\r\n      const currentUserId = _getCurrentUser(this.nodeScope.modelScope);\r\n\r\n      // @ts-expect-error\r\n      if (this._internal.accessControlRules !== undefined) {\r\n        // @ts-expect-error\r\n        this._internal.accessControlRules.forEach((r: AccessControlRule) => {\r\n          // @ts-expect-error\r\n          const rule = this._internal.accessControl[r.id];\r\n\r\n          if (rule === undefined) {\r\n            const userId = currentUserId;\r\n            if (userId !== undefined) acl[userId] = { write: true, read: true };\r\n          } else if (rule.target === \"everyone\") {\r\n            acl[\"*\"] = _rule(rule);\r\n          } else if (rule.target === \"user\") {\r\n            const userId = rule.userid || currentUserId;\r\n            acl[userId] = _rule(rule);\r\n          } else if (rule.target === \"role\") {\r\n            acl[\"role:\" + rule.role] = _rule(rule);\r\n          }\r\n        });\r\n      }\r\n\r\n      return Object.keys(acl).length > 0 ? acl : undefined;\r\n    },\r\n    setAccessControl: function (name: string, value: any) {\r\n      const _parts = name.split(\"-\");\r\n\r\n      // @ts-expect-error\r\n      if (this._internal.accessControl[_parts[1]] === undefined)\r\n        // @ts-expect-error\r\n        this._internal.accessControl[_parts[1]] = {};\r\n      // @ts-expect-error\r\n      this._internal.accessControl[_parts[1]][_parts[2]] = value;\r\n    },\r\n  });\r\n}\r\n\r\nexport {\r\n  _addInputProperties as addInputProperties,\r\n  _addModelId as addModelId,\r\n  _addBaseInfo as addBaseInfo,\r\n  _addRelationProperty as addRelationProperty,\r\n  _addAccessControl as addAccessControl,\r\n};\r\n","import * as DbModelCRUDBase from \"./dbmodelcrudbase\";\r\nimport { CloudStore } from \"../../../api/cloudstore\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\nimport { Model } from \"../../../model\";\r\n\r\ninterface Internal {\r\n  storeType?: \"cloud\" | \"local\";\r\n  storeProperties?: \"specified\" | \"all\";\r\n  model?: Model;\r\n  collectionId?: string;\r\n  inputValues: Record<string, any>;\r\n}\r\n\r\nconst SetDbModelPropertiedNodeDefinition: { node: NodeDefinition<Internal> } = {\r\n  node: {\r\n    name: \"SetDbModelProperties\",\r\n    category: \"\",\r\n    docs: \"https://docs.noodl.net/nodes/data/cloud-data/set-record-properties\",\r\n    displayNodeName: \"Set Record Properties\",\r\n    usePortAsLabel: \"collectionName\",\r\n    dynamicports: [\r\n      {\r\n        name: \"conditionalports/extended\",\r\n        condition: \"storeType = cloud OR storeType NOT SET\",\r\n        inputs: [\"storeProperties\"],\r\n      },\r\n    ],\r\n    inputs: {\r\n      store: {\r\n        displayName: \"Do\",\r\n        group: \"Actions\",\r\n        valueChangedToTrue() {\r\n          if (\r\n            this._internal.storeType === undefined ||\r\n            this._internal.storeType === \"cloud\"\r\n          ) {\r\n            // @ts-expect-error\r\n            this.scheduleSave();\r\n          } else {\r\n            // @ts-expect-error\r\n            this.scheduleStore();\r\n          }\r\n        },\r\n      },\r\n      storeProperties: {\r\n        displayName: \"Properties to  store\",\r\n        group: \"General\",\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"Only specified\", value: \"specified\" },\r\n            { label: \"All\", value: \"all\" },\r\n          ],\r\n        },\r\n        default: \"specified\",\r\n        set: function (this: any, value: \"specified\" | \"all\") {\r\n          this._internal.storeProperties = value;\r\n        },\r\n      },\r\n      storeType: {\r\n        displayName: \"Store to\",\r\n        group: \"General\",\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"Cloud and local\", value: \"cloud\" },\r\n            { label: \"Local only\", value: \"local\" },\r\n          ],\r\n        },\r\n        default: \"cloud\",\r\n        set: function (this: any, value: \"cloud\" | \"local\") {\r\n          this._internal.storeType = value;\r\n        },\r\n      },\r\n    },\r\n    outputs: {\r\n      stored: {\r\n        type: \"signal\",\r\n        displayName: \"Success\",\r\n        group: \"Events\",\r\n      },\r\n    },\r\n    methods: {\r\n      scheduleSave() {\r\n        const _this = this;\r\n        const internal = this._internal;\r\n\r\n        // @ts-expect-error\r\n        if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n        // @ts-expect-error\r\n        this.scheduleOnce(\"StorageSave\", function () {\r\n          if (!internal.model) {\r\n            // @ts-expect-error\r\n            _this.setError(\"Missing Record Id\");\r\n            return;\r\n          }\r\n\r\n          const model = internal.model;\r\n          for (const key in internal.inputValues) {\r\n            model.set(key, internal.inputValues[key], { resolve: true });\r\n          }\r\n\r\n          // @ts-expect-error\r\n          CloudStore.forScope(_this.nodeScope.modelScope).save({\r\n            // @ts-expect-error\r\n            collection: internal.collectionId,\r\n            objectId: model.getId(), // Get the objectId part of the model id\r\n            data:\r\n              internal.storeProperties === \"all\"\r\n                ? model.data\r\n                : internal.inputValues, // Only store input values by default, if not explicitly specified\r\n            // @ts-expect-error\r\n            acl: _this._getACL(),\r\n            success: function (response: Record<string, any>) {\r\n              for (const key in response) {\r\n                model.set(key, response[key]);\r\n              }\r\n\r\n              _this.sendSignalOnOutput(\"stored\");\r\n            },\r\n            error: function (err: string) {\r\n              // @ts-expect-error\r\n              _this.setError(err || \"Failed to save.\");\r\n            },\r\n          });\r\n        });\r\n      },\r\n      scheduleStore() {\r\n        // @ts-expect-error\r\n        if (this.hasScheduledStore) return;\r\n        // @ts-expect-error\r\n        this.hasScheduledStore = true;\r\n\r\n        const internal = this._internal;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          // @ts-expect-error\r\n          this.hasScheduledStore = false;\r\n          if (!internal.model) return;\r\n\r\n          for (const i in internal.inputValues) {\r\n            internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n          }\r\n          this.sendSignalOnOutput(\"stored\");\r\n        });\r\n      },\r\n    },\r\n  },\r\n};\r\n\r\nDbModelCRUDBase.addBaseInfo(SetDbModelPropertiedNodeDefinition);\r\nDbModelCRUDBase.addModelId(SetDbModelPropertiedNodeDefinition);\r\nDbModelCRUDBase.addInputProperties(SetDbModelPropertiedNodeDefinition);\r\nDbModelCRUDBase.addAccessControl(SetDbModelPropertiedNodeDefinition);\r\n\r\nexport const node = SetDbModelPropertiedNodeDefinition.node;\r\n","import * as DbModelCRUDBase from \"./dbmodelcrudbase\";\r\nimport { CloudStore } from \"../../../api/cloudstore\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\nimport { Model } from \"../../../model\";\r\n\r\ninterface Internal {\r\n  model?: Model;\r\n  collectionId?: string;\r\n  nodeScope: {\r\n    ModelScope?: typeof Model;\r\n  };\r\n}\r\n\r\nconst DeleteDbModelPropertiedNodeDefinition: {\r\n  node: NodeDefinition<Internal>;\r\n} = {\r\n  node: {\r\n    name: \"DeleteDbModelProperties\",\r\n    category: \"\",\r\n    docs: \"https://docs.noodl.net/nodes/data/cloud-data/delete-record\",\r\n    displayNodeName: \"Delete Record\",\r\n    shortDesc:\r\n      \"Stores any amount of properties and can be used standalone or together with Collections and For Each nodes.\",\r\n    inputs: {\r\n      store: {\r\n        displayName: \"Do\",\r\n        group: \"Actions\",\r\n        valueChangedToTrue() {\r\n          // @ts-expect-error\r\n          this.storageDelete();\r\n        },\r\n      },\r\n    },\r\n    outputs: {\r\n      deleted: {\r\n        type: \"signal\",\r\n        displayName: \"Success\",\r\n        group: \"Events\",\r\n      },\r\n    },\r\n    methods: {\r\n      storageDelete() {\r\n        const internal = this._internal;\r\n\r\n        // @ts-expect-error\r\n        if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n        // @ts-expect-error\r\n        this.scheduleOnce(\"StorageDelete\", () => {\r\n          if (!internal.model) {\r\n            // @ts-expect-error\r\n            this.setError(\"Missing Record Id\");\r\n            return;\r\n          }\r\n\r\n          // @ts-expect-error\r\n          CloudStore.forScope(this.nodeScope.ModelScope).delete({\r\n            // @ts-expect-error\r\n            collection: internal.collectionId,\r\n            objectId: internal.model.getId(), // Get the objectId part of the model id,\r\n            success: () => {\r\n              // @ts-expect-error\r\n              internal.model!.notify(\"delete\"); // Notify that this model has been deleted\r\n              this.sendSignalOnOutput(\"deleted\");\r\n            },\r\n            error: (err: string) => {\r\n              // @ts-expect-error\r\n              this.setError(err || \"Failed to delete.\");\r\n            },\r\n          });\r\n        });\r\n      },\r\n    },\r\n  },\r\n};\r\n\r\nDbModelCRUDBase.addBaseInfo(DeleteDbModelPropertiedNodeDefinition, {\r\n  includeInputProperties: false,\r\n});\r\nDbModelCRUDBase.addModelId(DeleteDbModelPropertiedNodeDefinition);\r\n\r\nexport const node = DeleteDbModelPropertiedNodeDefinition.node;\r\n","import { Model } from \"../../../model\";\r\nimport * as DbModelCRUDBase from \"./dbmodelcrudbase\";\r\nimport { CloudStore } from \"../../../api/cloudstore\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  sourceObjectId?: string;\r\n  collectionId?: string;\r\n  inputValues: Record<string, any>;\r\n  nodeScope: {\r\n    modelScope?: typeof Model;\r\n  };\r\n  [key: string]: any;\r\n}\r\n\r\nconst NewDbModelPropertiedNodeDefinition: {\r\n  node: NodeDefinition<Internal>;\r\n} = {\r\n  node: {\r\n    name: \"NewDbModelProperties\",\r\n    category: \"\",\r\n    docs: \"https://docs.noodl.net/nodes/data/cloud-data/create-new-record\",\r\n    displayName: \"Create New Record\",\r\n    usePortAsLabel: \"collectionName\",\r\n    inputs: {\r\n      store: {\r\n        displayName: \"Do\",\r\n        group: \"Actions\",\r\n        valueChangedToTrue() {\r\n          // @ts-expect-error\r\n          this.storageInsert();\r\n        },\r\n      },\r\n      sourceObjectId: {\r\n        type: { name: \"string\", allowConnectionsOnly: true },\r\n        displayName: \"Source Object Id\",\r\n        group: \"General\",\r\n        set(value: string | Model) {\r\n          if (value instanceof Model) value = value.getId(); // Can be passed as model as well\r\n          this._internal.sourceObjectId = value; // Wait to fetch data\r\n        },\r\n      },\r\n    },\r\n    outputs: {\r\n      created: {\r\n        type: \"signal\",\r\n        displayName: \"Success\",\r\n        group: \"Events\",\r\n      },\r\n    },\r\n    methods: {\r\n      storageInsert() {\r\n        const internal = this._internal;\r\n\r\n        // @ts-expect-error\r\n        if (!this.checkWarningsBeforeCloudOp()) return;\r\n\r\n        // @ts-expect-error\r\n        this.scheduleOnce(\"StorageInsert\", () => {\r\n          const initValues = Object.assign(\r\n            {},\r\n            internal.sourceObjectId\r\n              ? (this.nodeScope!.modelScope || Model).get(\r\n                  internal.sourceObjectId\r\n                ).data\r\n              : {},\r\n            internal.inputValues\r\n          );\r\n\r\n          const cloudstore = CloudStore.forScope(this.nodeScope!.modelScope);\r\n          cloudstore.create({\r\n            // @ts-expect-error\r\n            collection: internal.collectionId,\r\n            data: initValues,\r\n            // @ts-expect-error\r\n            acl: this._getACL(),\r\n            success: (data: any) => {\r\n              // Successfully created\r\n              // @ts-expect-error\r\n              const m = cloudstore._fromJSON(data, internal.collectionId);\r\n              // @ts-expect-error\r\n              this.setModel(m);\r\n              this.sendSignalOnOutput(\"created\");\r\n            },\r\n            error: (err: string) => {\r\n              // @ts-expect-error\r\n              this.setError(err || \"Failed to insert.\");\r\n            },\r\n          });\r\n        });\r\n      },\r\n    },\r\n  },\r\n};\r\n\r\nDbModelCRUDBase.addBaseInfo(NewDbModelPropertiedNodeDefinition);\r\nDbModelCRUDBase.addModelId(NewDbModelPropertiedNodeDefinition, {\r\n  includeOutputs: true,\r\n});\r\nDbModelCRUDBase.addInputProperties(NewDbModelPropertiedNodeDefinition);\r\nDbModelCRUDBase.addAccessControl(NewDbModelPropertiedNodeDefinition);\r\n\r\nexport const node = NewDbModelPropertiedNodeDefinition.node;\r\n","import { Model } from \"../../../model\";\r\nimport * as DbModelCRUDBase from \"./dbmodelcrudbase\";\r\nimport { CloudStore } from \"../../../api/cloudstore\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  collectionId?: string;\r\n  relationProperty?: string;\r\n  targetModelId?: string;\r\n  model?: any;\r\n}\r\n\r\nconst AddDbModelRelationNodeDefinition: {\r\n  node: NodeDefinition<Internal>;\r\n} = {\r\n  node: {\r\n    name: \"AddDbModelRelation\",\r\n    category: \"Data\",\r\n    docs: \"https://docs.noodl.net/nodes/data/cloud-data/add-record-relation\",\r\n    displayNodeName: \"Add Record Relation\",\r\n    usePortAsLabel: \"collectionName\",\r\n    inputs: {\r\n      store: {\r\n        displayName: \"Do\",\r\n        group: \"Actions\",\r\n        valueChangedToTrue() {\r\n          // @ts-expect-error\r\n          this.scheduleAddRelation();\r\n        },\r\n      },\r\n    },\r\n    outputs: {\r\n      relationAdded: {\r\n        type: \"signal\",\r\n        displayName: \"Success\",\r\n        group: \"Events\",\r\n      },\r\n    },\r\n    methods: {\r\n      validateInputs() {\r\n        if (!this.context.editorConnection) return;\r\n\r\n        const _warning = (message: string) => {\r\n          this.context.editorConnection!.sendWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"add-relation\",\r\n            {\r\n              message,\r\n            }\r\n          );\r\n        };\r\n\r\n        if (this._internal.collectionId === undefined) {\r\n          _warning(\"No class specified\");\r\n        } else if (this._internal.relationProperty === undefined) {\r\n          _warning(\"No relation property specified\");\r\n        } else if (this._internal.targetModelId === undefined) {\r\n          _warning(\r\n            \"No target record Id (the record to add a relation to) specified\"\r\n          );\r\n        } else if (this._internal.model === undefined) {\r\n          _warning(\r\n            \"No record Id specified (the record that should get the relation)\"\r\n          );\r\n        } else {\r\n          this.context.editorConnection.clearWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"add-relation\"\r\n          );\r\n        }\r\n      },\r\n      scheduleAddRelation() {\r\n        const _this = this;\r\n        const internal = this._internal;\r\n\r\n        // @ts-expect-error\r\n        this.scheduleOnce(\"StorageAddRelation\", function () {\r\n          // @ts-expect-error\r\n          _this.validateInputs();\r\n\r\n          if (!internal.model) return;\r\n          const model = internal.model;\r\n\r\n          const targetModelId = internal.targetModelId;\r\n          if (targetModelId === undefined) return;\r\n\r\n          // @ts-expect-error\r\n          CloudStore.forScope(_this.nodeScope.modelScope).addRelation({\r\n            collection: internal.collectionId!,\r\n            objectId: model.getId(),\r\n            key: internal.relationProperty!,\r\n            targetObjectId: targetModelId,\r\n            // @ts-expect-error\r\n            targetClass: (_this.nodeScope.modelScope || Model).get(\r\n              targetModelId\r\n            )._class,\r\n            success: function (response: any) {\r\n              for (const key in response) {\r\n                model.set(key, response[key]);\r\n              }\r\n\r\n              // Successfully added relation\r\n              _this.sendSignalOnOutput(\"relationAdded\");\r\n            },\r\n            error: function (err?: string) {\r\n              // @ts-expect-error\r\n              _this.setError(err || \"Failed to add relation.\");\r\n            },\r\n          });\r\n        });\r\n      },\r\n    },\r\n  },\r\n};\r\n\r\nDbModelCRUDBase.addBaseInfo(AddDbModelRelationNodeDefinition, {\r\n  includeRelations: true,\r\n});\r\nDbModelCRUDBase.addModelId(AddDbModelRelationNodeDefinition);\r\nDbModelCRUDBase.addRelationProperty(AddDbModelRelationNodeDefinition);\r\n\r\nexport const node = AddDbModelRelationNodeDefinition.node;\r\n","import { Model } from \"../../../model\";\r\nimport { CloudStore } from \"../../../api/cloudstore\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\nimport * as DbModelCRUDBase from \"./dbmodelcrudbase\";\r\n\r\ninterface RemoveDbModelRelationInternal {\r\n  collectionId?: string;\r\n  relationProperty?: string;\r\n  targetModelId?: string;\r\n  model?: any;\r\n  error?: string;\r\n}\r\n\r\nconst AddDbModelRelationNodeDefinition: {\r\n  node: NodeDefinition<RemoveDbModelRelationInternal>;\r\n} = {\r\n  node: {\r\n    name: \"RemoveDbModelRelation\",\r\n    category: \"\",\r\n    docs: \"https://docs.noodl.net/nodes/data/cloud-data/remove-record-relation\",\r\n    displayName: \"Remove Record Relation\",\r\n    usePortAsLabel: \"collectionName\",\r\n    inputs: {\r\n      store: {\r\n        displayName: \"Do\",\r\n        group: \"Actions\",\r\n        valueChangedToTrue() {\r\n          // @ts-expect-error\r\n          this.scheduleRemoveRelation();\r\n        },\r\n      },\r\n    },\r\n    outputs: {\r\n      relationRemoved: {\r\n        type: \"signal\",\r\n        displayName: \"Success\",\r\n        group: \"Events\",\r\n      },\r\n    },\r\n    methods: {\r\n      validateInputs() {\r\n        if (!this.context.editorConnection) return;\r\n\r\n        const _warning = (message: string) => {\r\n          this.context.editorConnection!.sendWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"add-relation\",\r\n            {\r\n              message,\r\n            }\r\n          );\r\n        };\r\n\r\n        if (this._internal.collectionId === undefined) {\r\n          _warning(\"No class specified\");\r\n        } else if (this._internal.relationProperty === undefined) {\r\n          _warning(\"No relation property specified\");\r\n        } else if (this._internal.targetModelId === undefined) {\r\n          _warning(\r\n            \"No target record Id (the record to add a relation to) specified\"\r\n          );\r\n        } else if (this._internal.model === undefined) {\r\n          _warning(\r\n            \"No record Id specified (the record that should get the relation)\"\r\n          );\r\n        } else {\r\n          this.context.editorConnection.clearWarning(\r\n            this.nodeScope!.componentOwner.name,\r\n            this.id,\r\n            \"add-relation\"\r\n          );\r\n        }\r\n      },\r\n      scheduleRemoveRelation() {\r\n        const _this = this;\r\n        const internal = this._internal;\r\n\r\n        // @ts-expect-error\r\n        this.scheduleOnce(\"StorageRemoveRelation\", function () {\r\n          // @ts-expect-error\r\n          _this.validateInputs();\r\n\r\n          if (!internal.model) return;\r\n          const model = internal.model;\r\n\r\n          const targetModelId = internal.targetModelId;\r\n          if (targetModelId === undefined) return;\r\n\r\n          // @ts-expect-error\r\n          CloudStore.forScope(_this.nodeScope.modelScope).removeRelation({\r\n            // @ts-expect-error\r\n            collection: internal.collectionId,\r\n            objectId: model.getId(),\r\n            key: internal.relationProperty,\r\n            targetObjectId: targetModelId,\r\n            // @ts-expect-error\r\n            targetClass: (_this.nodeScope.modelScope || Model).get(\r\n              targetModelId\r\n            )._class,\r\n            success: function (response: Record<string, any>) {\r\n              for (const _key in response) {\r\n                model.set(_key, response[_key]);\r\n              }\r\n\r\n              // Successfully removed relation\r\n              _this.sendSignalOnOutput(\"relationRemoved\");\r\n            },\r\n            error: function (err?: string) {\r\n              // @ts-expect-error\r\n              _this.setError(err || \"Failed to remove relation.\");\r\n            },\r\n          });\r\n        });\r\n      },\r\n    },\r\n  },\r\n};\r\n\r\nDbModelCRUDBase.addBaseInfo(AddDbModelRelationNodeDefinition, {\r\n  includeRelations: true,\r\n});\r\nDbModelCRUDBase.addModelId(AddDbModelRelationNodeDefinition);\r\nDbModelCRUDBase.addRelationProperty(AddDbModelRelationNodeDefinition);\r\n\r\nexport const node = AddDbModelRelationNodeDefinition.node;\r\n","import { Collection } from \"../../../collection\";\r\nimport { Model } from \"../../../model\";\r\nimport { CloudStore } from \"../../../api/cloudstore\";\r\nimport * as QueryUtils from \"../../../api/queryutils\";\r\nimport { NodeContext } from \"../../../nodecontext\";\r\nimport { EditorConnection } from \"../../../editorconnection\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\nimport { GraphModel } from \"../../../models/graphmodel\";\r\nimport { Port } from \"../../../models/componentmodel\";\r\n\r\ninterface Internal {\r\n  collectionChangedCallback: () => void;\r\n  cloudStoreEvents: (args: any) => void;\r\n  enabled: boolean;\r\n  filterSettings: Record<string, any>;\r\n  filterParameters: Record<string, any>;\r\n  collection?: any;\r\n  collectionName?: string;\r\n  visualFilter?: any;\r\n  visualSorting?: any;\r\n  filteredCollection?: any;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"FilterDBModels\",\r\n  docs: \"https://docs.noodl.net/nodes/data/cloud-data/filter-records\",\r\n  displayNodeName: \"Filter Records\",\r\n  shortDesc: \"Filter, sort and limit array\",\r\n  category: \"Data\",\r\n  color: \"data\",\r\n  initialize() {\r\n    const _this = this;\r\n\r\n    this._internal.collectionChangedCallback = function () {\r\n      if (_this.isInputConnected(\"filter\") === true) return;\r\n\r\n      // @ts-expect-error\r\n      _this.scheduleFilter();\r\n    };\r\n\r\n    this._internal.cloudStoreEvents = function (args: any) {\r\n      if (_this.isInputConnected(\"filter\") === true) return;\r\n\r\n      if (_this._internal.visualFilter === undefined) return;\r\n      if (_this._internal.collection === undefined) return;\r\n      if (args.collection !== _this._internal.collectionName) return;\r\n\r\n      if (\r\n        args.objectId !== undefined &&\r\n        _this._internal.collection.contains(Model.get(args.objectId))\r\n      )\r\n        // @ts-expect-error\r\n        _this.scheduleFilter();\r\n    };\r\n\r\n    CloudStore.instance.on(\"save\", this._internal.cloudStoreEvents);\r\n\r\n    this._internal.enabled = true;\r\n    this._internal.filterSettings = {};\r\n    this._internal.filterParameters = {};\r\n  },\r\n  getInspectInfo() {\r\n    const collection = this._internal.filteredCollection;\r\n\r\n    if (!collection) {\r\n      return { type: \"text\", value: \"[Not executed yet]\" };\r\n    }\r\n\r\n    return [\r\n      {\r\n        type: \"text\",\r\n        value: \"Id: \" + collection.getId(),\r\n      },\r\n      {\r\n        type: \"value\",\r\n        value: collection.items,\r\n      },\r\n    ];\r\n  },\r\n  inputs: {\r\n    items: {\r\n      type: \"array\",\r\n      displayName: \"Items\",\r\n      group: \"General\",\r\n      set(value: any) {\r\n        // @ts-expect-error\r\n        this.bindCollection(value);\r\n        // @ts-expect-error\r\n        if (this.isInputConnected(\"filter\") === false) this.scheduleFilter();\r\n      },\r\n    },\r\n    enabled: {\r\n      type: \"boolean\",\r\n      group: \"General\",\r\n      displayName: \"Enabled\",\r\n      default: true,\r\n      set(value: boolean) {\r\n        this._internal.enabled = value;\r\n        // @ts-expect-error\r\n        if (this.isInputConnected(\"filter\") === false) this.scheduleFilter();\r\n      },\r\n    },\r\n    filter: {\r\n      type: \"signal\",\r\n      group: \"Actions\",\r\n      displayName: \"Filter\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleFilter();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    items: {\r\n      type: \"array\",\r\n      displayName: \"Items\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.filteredCollection;\r\n      },\r\n    },\r\n    firstItemId: {\r\n      type: \"string\",\r\n      displayName: \"First Record Id\",\r\n      group: \"General\",\r\n      getter() {\r\n        if (this._internal.filteredCollection !== undefined) {\r\n          const firstItem = this._internal.filteredCollection.get(0);\r\n          if (firstItem !== undefined) return firstItem.getId();\r\n        }\r\n      },\r\n    },\r\n    count: {\r\n      type: \"number\",\r\n      displayName: \"Count\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.filteredCollection\r\n          ? this._internal.filteredCollection.size()\r\n          : 0;\r\n      },\r\n    },\r\n    modified: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Filtered\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    unbindCurrentCollection() {\r\n      const collection = this._internal.collection;\r\n      if (!collection) return;\r\n      collection.off(\"change\", this._internal.collectionChangedCallback);\r\n      this._internal.collection = undefined;\r\n    },\r\n    bindCollection(collection: any) {\r\n      // @ts-expect-error\r\n      this.unbindCurrentCollection();\r\n      this._internal.collection = collection;\r\n      collection &&\r\n        collection.on(\"change\", this._internal.collectionChangedCallback);\r\n    },\r\n    _onNodeDeleted() {\r\n      // @ts-expect-error\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      // @ts-expect-error\r\n      this.unbindCurrentCollection();\r\n\r\n      CloudStore.instance.off(\"save\", this._internal.cloudStoreEvents);\r\n    },\r\n    getLimit() {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      if (!filterSettings[\"filterEnableLimit\"]) return;\r\n      else return filterSettings[\"filterLimit\"] || 10;\r\n    },\r\n    getSkip() {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      if (!filterSettings[\"filterEnableLimit\"]) return;\r\n      else return filterSettings[\"filterSkip\"] || 0;\r\n    },\r\n    scheduleFilter() {\r\n      // @ts-expect-error\r\n      if (this.collectionChangedScheduled) return;\r\n      // @ts-expect-error\r\n      this.collectionChangedScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.collectionChangedScheduled = false;\r\n        if (!this._internal.collection) return;\r\n\r\n        // Apply filter and write to output collection\r\n        let filtered = [].concat(this._internal.collection.items);\r\n\r\n        if (this._internal.enabled) {\r\n          const _filter = this._internal.visualFilter;\r\n          if (_filter !== undefined) {\r\n            const filter = QueryUtils.convertVisualFilter(_filter, {\r\n              queryParameters: this._internal.filterParameters,\r\n              collectionName: this._internal.collectionName,\r\n            });\r\n            if (filter)\r\n              filtered = filtered.filter((m) =>\r\n                QueryUtils.matchesQuery(m, filter)\r\n              );\r\n          }\r\n\r\n          const _sort = this._internal.visualSorting;\r\n          if (_sort !== undefined && _sort.length > 0) {\r\n            const sort = QueryUtils.convertVisualSorting(_sort);\r\n            if (sort) filtered.sort(QueryUtils.compareObjects.bind(this, sort));\r\n          }\r\n\r\n          // @ts-expect-error\r\n          const skip = this.getSkip();\r\n          if (skip) filtered = filtered.slice(skip, filtered.length);\r\n\r\n          // @ts-expect-error\r\n          const limit = this.getLimit();\r\n          if (limit) filtered = filtered.slice(0, limit);\r\n        }\r\n\r\n        this._internal.filteredCollection = Collection.create(filtered);\r\n\r\n        this.sendSignalOnOutput(\"modified\");\r\n        this.flagOutputDirty(\"firstItemId\");\r\n        this.flagOutputDirty(\"items\");\r\n        this.flagOutputDirty(\"count\");\r\n      });\r\n    },\r\n    setCollectionName(name: string) {\r\n      this._internal.collectionName = name;\r\n    },\r\n    setVisualFilter(value: any) {\r\n      this._internal.visualFilter = value;\r\n\r\n      // @ts-expect-error\r\n      if (this.isInputConnected(\"filter\") === false) this.scheduleFilter();\r\n    },\r\n    setVisualSorting(value: any) {\r\n      this._internal.visualSorting = value;\r\n\r\n      // @ts-expect-error\r\n      if (this.isInputConnected(\"filter\") === false) this.scheduleFilter();\r\n    },\r\n    setFilterParameter: function (\r\n      // @ts-expect-error\r\n      this: FilterDBModelsNode,\r\n      name: string,\r\n      value: any\r\n    ) {\r\n      this._internal.filterParameters[name] = value;\r\n\r\n      if (this.isInputConnected(\"filter\") === false) this.scheduleFilter();\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"collectionName\")\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setCollectionName.bind(this),\r\n        });\r\n\r\n      if (name === \"visualFilter\")\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setVisualFilter.bind(this),\r\n        });\r\n\r\n      if (name === \"visualSorting\")\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setVisualSorting.bind(this),\r\n        });\r\n\r\n      if (name.startsWith(\"fp-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setFilterParameter.bind(this, name.substring(\"fp-\".length)),\r\n        });\r\n\r\n      this.registerInput(name, {\r\n        set(value: any) {\r\n          this._internal.filterSettings[name] = value;\r\n          // @ts-expect-error\r\n          if (this.isInputConnected(\"filter\") === false) this.scheduleFilter();\r\n        },\r\n      });\r\n    },\r\n  },\r\n};\r\n\r\nfunction updatePorts(\r\n  nodeId: string,\r\n  parameters: any,\r\n  editorConnection: EditorConnection,\r\n  dbCollections: any[]\r\n) {\r\n  const ports: Port[] = [];\r\n\r\n  ports.push({\r\n    name: \"collectionName\",\r\n    type: {\r\n      name: \"enum\",\r\n      enums:\r\n        dbCollections !== undefined\r\n          ? dbCollections.map((c) => {\r\n              return { value: c.name, label: c.name };\r\n            })\r\n          : [],\r\n      allowEditOnly: true,\r\n    },\r\n    displayName: \"Class\",\r\n    plug: \"input\",\r\n    group: \"General\",\r\n  });\r\n\r\n  ports.push({\r\n    type: \"boolean\",\r\n    plug: \"input\",\r\n    group: \"Limit\",\r\n    name: \"filterEnableLimit\",\r\n    displayName: \"Use limit\",\r\n  });\r\n\r\n  if (parameters[\"filterEnableLimit\"]) {\r\n    ports.push({\r\n      type: \"number\",\r\n      default: 10,\r\n      plug: \"input\",\r\n      group: \"Limit\",\r\n      name: \"filterLimit\",\r\n      displayName: \"Limit\",\r\n    });\r\n\r\n    ports.push({\r\n      type: \"number\",\r\n      default: 0,\r\n      plug: \"input\",\r\n      group: \"Limit\",\r\n      name: \"filterSkip\",\r\n      displayName: \"Skip\",\r\n    });\r\n  }\r\n\r\n  if (parameters.collectionName !== undefined) {\r\n    const c = dbCollections.find((c) => c.name === parameters.collectionName);\r\n    if (c && c.schema && c.schema.properties) {\r\n      const schema = JSON.parse(JSON.stringify(c.schema));\r\n\r\n      const _supportedTypes = {\r\n        Boolean: true,\r\n        String: true,\r\n        Date: true,\r\n        Number: true,\r\n        Pointer: true,\r\n      };\r\n      for (const key in schema.properties) {\r\n        if (!_supportedTypes[schema.properties[key].type]) {\r\n          delete schema.properties[key];\r\n        }\r\n      }\r\n\r\n      ports.push({\r\n        name: \"visualFilter\",\r\n        plug: \"input\",\r\n        type: { name: \"query-filter\", schema: schema, allowEditOnly: true },\r\n        displayName: \"Filter\",\r\n        group: \"Filter\",\r\n      });\r\n\r\n      ports.push({\r\n        name: \"visualSorting\",\r\n        plug: \"input\",\r\n        type: { name: \"query-sorting\", schema: schema, allowEditOnly: true },\r\n        displayName: \"Sorting\",\r\n        group: \"Sorting\",\r\n      });\r\n    }\r\n\r\n    if (parameters.visualFilter !== undefined) {\r\n      // Find all input ports\r\n      const uniqueInputs: Record<string, boolean> = {};\r\n      _collectInputs(uniqueInputs, parameters.visualFilter);\r\n\r\n      Object.keys(uniqueInputs).forEach((input) => {\r\n        ports.push({\r\n          name: \"fp-\" + input,\r\n          plug: \"input\",\r\n          type: \"*\",\r\n          displayName: input,\r\n          group: \"Filter Parameters\",\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  graphModel.on(\"nodeAdded.FilterDBModels\", function (node: any) {\r\n    updatePorts(\r\n      node.id,\r\n      node.parameters,\r\n      // @ts-expect-error\r\n      context.editorConnection,\r\n      graphModel.getMetaData(\"dbCollections\")\r\n    );\r\n\r\n    node.on(\"parameterUpdated\", function () {\r\n      updatePorts(\r\n        node.id,\r\n        node.parameters,\r\n        // @ts-expect-error\r\n        context.editorConnection,\r\n        graphModel.getMetaData(\"dbCollections\")\r\n      );\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.dbCollections\", function (data: any) {\r\n      CloudStore.invalidateCollections();\r\n      // @ts-expect-error\r\n      updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.systemCollections\", function (data: any) {\r\n      CloudStore.invalidateCollections();\r\n      // @ts-expect-error\r\n      updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n    });\r\n  });\r\n}\r\n\r\ninterface QueryRule {\r\n  rules?: QueryRule[];\r\n  input?: string;\r\n}\r\n\r\nfunction _collectInputs(\r\n  uniqueInputs: Record<string, boolean>,\r\n  query: QueryRule | undefined\r\n) {\r\n  if (query === undefined) {\r\n    return;\r\n  }\r\n\r\n  if (query.rules !== undefined) {\r\n    query.rules.forEach((r: QueryRule) => _collectInputs(uniqueInputs, r));\r\n  } else if (query.input !== undefined) {\r\n    uniqueInputs[query.input] = true;\r\n  }\r\n}\r\n","import { NodeDefinition } from \"../../../nodedefinition\";\r\nimport { NodeContext } from \"../../../nodecontext\";\r\nimport { GraphModel } from \"../../../models/graphmodel\";\r\nimport { Port } from \"../../../models/componentmodel\";\r\nimport { Model } from \"../../../model\";\r\n\r\ninterface Internal {\r\n  inputValues: Record<string, any>;\r\n  dirtyValues: Record<string, any>;\r\n  model?: Model;\r\n  modelId?: string;\r\n  onModelChangedCallback: (args: { name: string }) => void;\r\n}\r\n\r\ninterface Parameters {\r\n  properties?: string;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Model2\",\r\n  docs: \"https://docs.noodl.net/nodes/data/object/object-node\",\r\n  displayNodeName: \"Object\",\r\n  shortDesc:\r\n    \"Stores any amount of properties and can be used standalone or together with Collections and For Each nodes.\",\r\n  category: \"Data\",\r\n  usePortAsLabel: \"modelId\",\r\n  color: \"data\",\r\n  dynamicports: [\r\n    {\r\n      name: \"conditionalports/extended\",\r\n      condition: \"idSource = explicit OR idSource NOT SET\",\r\n      inputs: [\"modelId\"],\r\n    },\r\n  ],\r\n  initialize() {\r\n    const internal = this._internal;\r\n    internal.inputValues = {};\r\n    internal.dirtyValues = {};\r\n\r\n    internal.onModelChangedCallback = (args) => {\r\n      if (this.isInputConnected(\"fetch\") === true) return;\r\n\r\n      if (this.hasOutput(\"prop-\" + args.name))\r\n        this.flagOutputDirty(\"prop-\" + args.name);\r\n\r\n      if (this.hasOutput(\"changed-\" + args.name))\r\n        this.sendSignalOnOutput(\"changed-\" + args.name);\r\n\r\n      this.sendSignalOnOutput(\"changed\");\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return \"[No Object]\";\r\n\r\n    return [\r\n      { type: \"text\", value: \"Id: \" + model.getId() },\r\n      { type: \"value\", value: model.data },\r\n    ];\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: \"string\",\r\n      displayName: \"Id\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.model\r\n          ? this._internal.model.getId()\r\n          : this._internal.modelId;\r\n      },\r\n    },\r\n    changed: {\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n      group: \"Events\",\r\n    },\r\n    fetched: {\r\n      type: \"signal\",\r\n      displayName: \"Fetched\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n  inputs: {\r\n    idSource: {\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Specify explicitly\", value: \"explicit\" },\r\n          { label: \"From repeater\", value: \"foreach\" },\r\n        ],\r\n        allowEditOnly: true,\r\n      },\r\n      default: \"explicit\",\r\n      displayName: \"Get Id from\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        if (value === \"foreach\") {\r\n          this.scheduleAfterInputsHaveUpdated(() => {\r\n            // Find closest nodescope that have a _forEachModel\r\n            let component = this.nodeScope!.componentOwner;\r\n            while (\r\n              component !== undefined &&\r\n              (component as any)._forEachModel === undefined &&\r\n              component.parentNodeScope\r\n            ) {\r\n              component = component.parentNodeScope.componentOwner;\r\n            }\r\n            // @ts-expect-error\r\n            this.setModel(\r\n              component !== undefined\r\n                ? (component as any)._forEachModel\r\n                : undefined\r\n            );\r\n          });\r\n        }\r\n      },\r\n    },\r\n    modelId: {\r\n      type: {\r\n        name: \"string\",\r\n        identifierOf: \"ModelName\",\r\n        identifierDisplayName: \"Object Ids\",\r\n      },\r\n      displayName: \"Id\",\r\n      group: \"General\",\r\n      set(value: string | Model | Record<string, any>) {\r\n        if (value instanceof Model) value = value.getId();\r\n        // Can be passed as model as well\r\n        else if (typeof value === \"object\") value = Model.create(value).getId(); // If this is an js object, dereference it\r\n\r\n        this._internal.modelId = value; // Wait to fetch data\r\n        // @ts-expect-error\r\n        if (this.isInputConnected(\"fetch\") === false) this.setModelID(value);\r\n        else {\r\n          this.flagOutputDirty(\"id\");\r\n        }\r\n      },\r\n    },\r\n    properties: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      displayName: \"Properties\",\r\n      group: \"Properties\",\r\n      set(value: string) {},\r\n    },\r\n    fetch: {\r\n      displayName: \"Fetch\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleSetModel();\r\n      },\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    scheduleStore() {\r\n      if ((this as any).hasScheduledStore) return;\r\n      (this as any).hasScheduledStore = true;\r\n\r\n      const internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        (this as any).hasScheduledStore = false;\r\n        if (!internal.model) return;\r\n\r\n        for (const i in internal.dirtyValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n        internal.dirtyValues = {}; // Reset dirty values\r\n      });\r\n    },\r\n    scheduleSetModel() {\r\n      if ((this as any).hasScheduledSetModel) return;\r\n      (this as any).hasScheduledSetModel = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        (this as any).hasScheduledSetModel = false;\r\n        // @ts-expect-error\r\n        this.setModelID(this._internal.modelId);\r\n      });\r\n    },\r\n    setModelID(id: string) {\r\n      const model = (this.nodeScope!.modelScope || Model).get(id);\r\n      // @ts-expect-error\r\n      this.setModel(model);\r\n      this.sendSignalOnOutput(\"fetched\");\r\n    },\r\n    setModel(model?: Model) {\r\n      if (this._internal.model)\r\n        // Remove old listener if existing\r\n        this._internal.model.off(\r\n          \"change\",\r\n          this._internal.onModelChangedCallback\r\n        );\r\n\r\n      this._internal.model = model;\r\n      this.flagOutputDirty(\"id\");\r\n\r\n      // In set idSource, we are calling setModel with undefined\r\n      if (model) {\r\n        model.on(\"change\", this._internal.onModelChangedCallback);\r\n\r\n        // We have a new model, mark all outputs as dirty\r\n        for (const key in model.data) {\r\n          if (this.hasOutput(\"prop-\" + key))\r\n            this.flagOutputDirty(\"prop-\" + key);\r\n        }\r\n      }\r\n    },\r\n    _onNodeDeleted() {\r\n      if (this._internal.model)\r\n        this._internal.model.off(\r\n          \"change\",\r\n          this._internal.onModelChangedCallback\r\n        );\r\n    },\r\n    registerOutputIfNeeded(name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"prop-\"))\r\n        this.registerOutput(name, {\r\n          getter: userOutputGetter.bind(this, name.substring(\"prop-\".length)),\r\n        });\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"prop-\"))\r\n        this.registerInput(name, {\r\n          set: userInputSetter.bind(this, name.substring(\"prop-\".length)),\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\nfunction userOutputGetter(this: any, name: string) {\r\n  return this._internal.model\r\n    ? this._internal.model.get(name, { resolve: true })\r\n    : undefined;\r\n}\r\n\r\nfunction userInputSetter(this: any, name: string, value: any) {\r\n  this._internal.inputValues[name] = value;\r\n\r\n  // Store on change if no connection to store or new\r\n  const model = this._internal.model;\r\n  const valueChanged = model ? model.get(name) !== value : true;\r\n  if (valueChanged) {\r\n    this._internal.dirtyValues[name] = true;\r\n    this.scheduleStore();\r\n  }\r\n}\r\n\r\nfunction updatePorts(\r\n  nodeId: string,\r\n  parameters: Parameters,\r\n  editorConnection: any\r\n) {\r\n  const ports: Port[] = [];\r\n\r\n  // Add value outputs\r\n  const properties = parameters.properties;\r\n  if (properties) {\r\n    const propArray = properties ? properties.split(\",\") : undefined;\r\n    if (propArray) {\r\n      for (const p of propArray) {\r\n        ports.push({\r\n          type: {\r\n            name: \"*\",\r\n            allowConnectionsOnly: true,\r\n          },\r\n          plug: \"input/output\",\r\n          group: \"Properties\",\r\n          name: \"prop-\" + p,\r\n          displayName: p,\r\n        });\r\n\r\n        ports.push({\r\n          type: \"signal\",\r\n          plug: \"output\",\r\n          group: \"Changed Events\",\r\n          displayName: p + \" Changed\",\r\n          name: \"changed-\" + p,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: \"input/output\",\r\n    },\r\n  });\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  graphModel.on(\"nodeAdded.Model2\", function (node) {\r\n    updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n    node.on(\"parameterUpdated\", function () {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n    });\r\n  });\r\n}\r\n","import { NodeDefinition } from \"../../../nodedefinition\";\r\nimport * as ModelCRUDBase from \"./modelcrudbase\";\r\n\r\nconst SetModelPropertiedNodeDefinition: { node: NodeDefinition } = {\r\n  node: {\r\n    name: \"SetModelProperties\",\r\n    category: \"\",\r\n    docs: \"https://docs.noodl.net/nodes/data/object/set-object-properties\",\r\n    displayNodeName: \"Set Object Properties\",\r\n    inputs: {\r\n      store: {\r\n        displayName: \"Do\",\r\n        group: \"Actions\",\r\n        valueChangedToTrue: function (this: any) {\r\n          this.scheduleStore();\r\n        },\r\n      },\r\n    },\r\n    outputs: {\r\n      stored: {\r\n        type: \"signal\",\r\n        displayName: \"Done\",\r\n        group: \"Events\",\r\n      },\r\n    },\r\n  },\r\n};\r\n\r\nModelCRUDBase.addBaseInfo(SetModelPropertiedNodeDefinition);\r\nModelCRUDBase.addModelId(SetModelPropertiedNodeDefinition);\r\nModelCRUDBase.addInputProperties(SetModelPropertiedNodeDefinition);\r\n\r\nexport const node = SetModelPropertiedNodeDefinition.node;\r\n","import { Model } from \"../../../model\";\r\nimport * as ModelCRUDBase from \"./modelcrudbase\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  hasScheduledNew?: boolean;\r\n  nodeScope: {\r\n    modelScope?: typeof Model;\r\n  };\r\n  _pushInputValues: (model: any) => void;\r\n  setModel: (model: any) => void;\r\n  scheduleAfterInputsHaveUpdated: (callback: () => void) => void;\r\n  sendSignalOnOutput: (name: string) => void;\r\n}\r\n\r\nconst NewModelNodeDefinition: {\r\n  node: NodeDefinition<Internal>;\r\n} = {\r\n  node: {\r\n    name: \"NewModel\",\r\n    category: \"\",\r\n    docs: \"https://docs.noodl.net/nodes/data/object/create-new-object\",\r\n    displayNodeName: \"Create New Object\",\r\n    inputs: {\r\n      new: {\r\n        displayName: \"Do\",\r\n        group: \"Actions\",\r\n        valueChangedToTrue() {\r\n          // @ts-expect-error\r\n          this.scheduleNew();\r\n        },\r\n      },\r\n    },\r\n    outputs: {\r\n      created: {\r\n        type: \"signal\",\r\n        displayName: \"Done\",\r\n        group: \"Events\",\r\n      },\r\n    },\r\n    methods: {\r\n      scheduleNew() {\r\n        // @ts-expect-error\r\n        if (this.hasScheduledNew) return;\r\n        // @ts-expect-error\r\n        this.hasScheduledNew = true;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          // @ts-expect-error\r\n          this.hasScheduledNew = false;\r\n          const newModel = (this.nodeScope!.modelScope || Model).get();\r\n\r\n          // @ts-expect-error\r\n          this._pushInputValues(newModel);\r\n\r\n          // @ts-expect-error\r\n          this.setModel(newModel);\r\n\r\n          this.sendSignalOnOutput(\"created\");\r\n        });\r\n      },\r\n    },\r\n  },\r\n};\r\n\r\nModelCRUDBase.addBaseInfo(NewModelNodeDefinition);\r\nModelCRUDBase.addModelId(NewModelNodeDefinition, { includeOutputs: true });\r\nModelCRUDBase.addInputProperties(NewModelNodeDefinition);\r\n\r\nexport const node = NewModelNodeDefinition.node;\r\n","import { CloudFile } from \"../../../api/cloudfile\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  cloudFile?: CloudFile;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Cloud File\",\r\n  docs: \"https://docs.noodl.net/nodes/data/cloud-data/cloud-file\",\r\n  category: \"Cloud Services\",\r\n  color: \"data\",\r\n  getInspectInfo(): string | undefined {\r\n    return this._internal.cloudFile?.getUrl();\r\n  },\r\n  outputs: {\r\n    url: {\r\n      type: \"string\",\r\n      displayName: \"URL\",\r\n      group: \"General\",\r\n      getter(): string | undefined {\r\n        return this._internal.cloudFile?.getUrl();\r\n      },\r\n    },\r\n    name: {\r\n      type: \"string\",\r\n      displayName: \"Name\",\r\n      group: \"General\",\r\n      getter(): string | undefined {\r\n        if (!this._internal.cloudFile) return undefined;\r\n\r\n        //parse prefixes the file with a guid_\r\n        //remove it so the name is the same as the original file name\r\n        const n = this._internal.cloudFile.getName().split(\"_\");\r\n        return n.length === 1 ? n[0] : n.slice(1).join(\"_\");\r\n      },\r\n    },\r\n  },\r\n  inputs: {\r\n    file: {\r\n      type: \"cloudfile\",\r\n      displayName: \"Cloud File\",\r\n      group: \"General\",\r\n      set(value: unknown): void {\r\n        if (!(value instanceof CloudFile)) {\r\n          return;\r\n        }\r\n        this._internal.cloudFile = value;\r\n        this.flagOutputDirty(\"name\");\r\n        this.flagOutputDirty(\"url\");\r\n      },\r\n    },\r\n  },\r\n};\r\n","import NoodlRuntime from \"../runtime\";\r\n\r\ninterface RequestOptions {\r\n  success: (data: any) => void;\r\n  error: (error: any) => void;\r\n}\r\n\r\ninterface CloudServices {\r\n  appId: string;\r\n  endpoint: string;\r\n  masterKey?: string;\r\n}\r\n\r\ndeclare const _noodl_cloud_runtime_version: string | undefined;\r\ndeclare const _noodl_cloudservices: CloudServices | undefined;\r\n\r\nexport class ConfigService {\r\n  private cacheDuration: number;\r\n  private configCache?: Record<string, any>;\r\n  private configCachePending?: Promise<Record<string, any>>;\r\n  private ttl?: number;\r\n  private endpoint?: string;\r\n  private appId?: string;\r\n\r\n  constructor() {\r\n    this.cacheDuration = 15 * 60 * 1000; // 15 min cache\r\n  }\r\n\r\n  private _makeRequest(path: string, options: RequestOptions): void {\r\n    if (typeof _noodl_cloud_runtime_version === \"undefined\") {\r\n      // Running in browser\r\n      const xhr = new XMLHttpRequest();\r\n\r\n      xhr.onreadystatechange = function () {\r\n        if (xhr.readyState === 4) {\r\n          let json;\r\n          try {\r\n            json = JSON.parse(xhr.response);\r\n          } catch (e) {}\r\n\r\n          if (xhr.status === 200 || xhr.status === 201) {\r\n            options.success(json);\r\n          } else\r\n            options.error(\r\n              json || { error: xhr.responseText, status: xhr.status }\r\n            );\r\n        }\r\n      };\r\n\r\n      const cloudServices = NoodlRuntime.instance.getMetaData(\r\n        \"cloudservices\"\r\n      ) as CloudServices;\r\n      const appId = cloudServices.appId;\r\n      const endpoint = cloudServices.endpoint;\r\n      xhr.open(\"GET\", endpoint + path, true);\r\n\r\n      xhr.setRequestHeader(\"X-Parse-Application-Id\", appId);\r\n\r\n      xhr.send();\r\n    } else {\r\n      // Running in cloud runtime\r\n      const endpoint =\r\n        typeof _noodl_cloudservices !== \"undefined\"\r\n          ? _noodl_cloudservices.endpoint\r\n          : this.endpoint;\r\n      const appId =\r\n        typeof _noodl_cloudservices !== \"undefined\"\r\n          ? _noodl_cloudservices.appId\r\n          : this.appId;\r\n      const masterKey =\r\n        typeof _noodl_cloudservices !== \"undefined\"\r\n          ? _noodl_cloudservices.masterKey\r\n          : undefined;\r\n\r\n      fetch(endpoint + path, {\r\n        method: \"GET\",\r\n        // @ts-expect-error\r\n        headers: {\r\n          \"X-Parse-Application-Id\": appId,\r\n          \"X-Parse-Master-Key\": masterKey,\r\n        },\r\n      })\r\n        .then((r) => {\r\n          if (r.status === 200 || r.status === 201) {\r\n            r.json()\r\n              .then((json) => options.success(json))\r\n              .catch((e) =>\r\n                options.error({\r\n                  error: \"Config: Failed to get json result.\",\r\n                })\r\n              );\r\n          } else {\r\n            r.json()\r\n              .then((json) => options.error(json))\r\n              .catch((e) => options.error({ error: \"Failed to fetch.\" }));\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          options.error({ error: e.message });\r\n        });\r\n    }\r\n  }\r\n\r\n  private _getConfig(): Promise<Record<string, any>> {\r\n    return new Promise((resolve, reject) => {\r\n      this._makeRequest(\"/config\", {\r\n        success: (config) => {\r\n          resolve(config.params || {});\r\n        },\r\n        error: (err) => {\r\n          reject(err);\r\n        },\r\n      });\r\n    });\r\n  }\r\n\r\n  async getConfig(): Promise<Record<string, any>> {\r\n    if (this.configCachePending) return this.configCachePending;\r\n\r\n    if (!this.configCache) {\r\n      this.configCachePending = this._getConfig();\r\n\r\n      this.configCache = await this.configCachePending;\r\n      delete this.configCachePending;\r\n      this.ttl = Date.now() + this.cacheDuration;\r\n      return this.configCache;\r\n    } else {\r\n      // Update cache if ttl has passed\r\n      if (this.ttl && Date.now() > this.ttl) {\r\n        this._getConfig().then((config) => {\r\n          this.configCache = config;\r\n          this.ttl = Date.now() + this.cacheDuration;\r\n        });\r\n      }\r\n\r\n      // But return currently cached\r\n      return this.configCache;\r\n    }\r\n  }\r\n\r\n  clearCache(): void {\r\n    delete this.configCache;\r\n  }\r\n\r\n  static instance = new ConfigService();\r\n}\r\n","import { ConfigService } from \"../../../api/configservice\";\r\n\r\ninterface ConfigNodeDefinition {\r\n  name: string;\r\n  docs: string;\r\n  displayNodeName: string;\r\n  category: string;\r\n  usePortAsLabel: string;\r\n  color: string;\r\n  initialize: () => void;\r\n  getInspectInfo: () => string | { type: string; value: any }[];\r\n  inputs?: Record<string, any>;\r\n  outputs?: Record<string, any>;\r\n  methods: {\r\n    getValue: () => any;\r\n    setInternal: (key: string, value: any) => void;\r\n    registerOutputIfNeeded: (name: string) => void;\r\n    registerInputIfNeeded: (name: string) => void;\r\n  };\r\n}\r\n\r\ninterface ConfigNode {\r\n  _internal: {\r\n    config?: Record<string, any>;\r\n    configKey?: string;\r\n    useDevValue?: boolean;\r\n    devValue?: any;\r\n  };\r\n  context: {\r\n    editorConnection?: {\r\n      isRunningLocally: () => boolean;\r\n    };\r\n  };\r\n  hasOutput: (name: string) => boolean;\r\n  flagOutputDirty: (name: string) => void;\r\n  hasInput: (name: string) => boolean;\r\n  registerOutput: (name: string, options: { getter: () => any }) => void;\r\n  registerInput: (name: string, options: { set: (value: any) => void }) => void;\r\n}\r\n\r\nconst ConfigNodeDefinition: ConfigNodeDefinition = {\r\n  name: \"DbConfig\",\r\n  docs: \"https://docs.noodl.net/nodes/data/cloud-data/config\",\r\n  displayNodeName: \"Config\",\r\n  category: \"Cloud Services\",\r\n  usePortAsLabel: \"configKey\",\r\n  color: \"data\",\r\n  initialize: function (this: ConfigNode) {\r\n    const internal = this._internal;\r\n\r\n    ConfigService.instance.getConfig().then((config) => {\r\n      internal.config = config;\r\n      if (this.hasOutput(\"value\")) this.flagOutputDirty(\"value\");\r\n    });\r\n  },\r\n  getInspectInfo() {\r\n    // @ts-expect-error\r\n    const value = this.getValue();\r\n\r\n    if (value === undefined) return \"[No Value]\";\r\n\r\n    return [{ type: \"value\", value: value }];\r\n  },\r\n  methods: {\r\n    getValue: function (this: ConfigNode) {\r\n      const internal = this._internal;\r\n      if (\r\n        internal.useDevValue &&\r\n        this.context.editorConnection &&\r\n        this.context.editorConnection.isRunningLocally()\r\n      ) {\r\n        return internal.devValue;\r\n      } else if (\r\n        internal.config !== undefined &&\r\n        internal.configKey !== undefined\r\n      ) {\r\n        return internal.config[internal.configKey];\r\n      }\r\n    },\r\n    setInternal: function (this: ConfigNode, key: string, value: any) {\r\n      this._internal[key] = value;\r\n      if (this.hasOutput(\"value\")) this.flagOutputDirty(\"value\");\r\n    },\r\n    registerOutputIfNeeded: function (this: ConfigNode, name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"value\")\r\n        return this.registerOutput(name, {\r\n          // @ts-expect-error\r\n          getter: this.getValue.bind(this),\r\n        });\r\n    },\r\n    registerInputIfNeeded: function (this: ConfigNode, name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"configKey\" || name === \"useDevValue\" || name === \"devValue\")\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setInternal.bind(this, name),\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\ninterface GraphModel {\r\n  getMetaData: (key: string) => any;\r\n  getNodesWithType: (type: string) => any[];\r\n  on: (event: string, callback: (data?: any) => void) => void;\r\n}\r\n\r\ninterface SetupContext {\r\n  editorConnection?: {\r\n    isRunningLocally: () => boolean;\r\n    clearWarning: (componentName: string, id: string, type: string) => void;\r\n    sendWarning: (\r\n      componentName: string,\r\n      id: string,\r\n      type: string,\r\n      options: { showGlobally: boolean; message: string }\r\n    ) => void;\r\n    sendDynamicPorts: (id: string, ports: any[]) => void;\r\n  };\r\n}\r\n\r\nexport const node = ConfigNodeDefinition;\r\nexport function setup(context: SetupContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function updatePorts(node: any) {\r\n    const ports: any[] = [];\r\n\r\n    context.editorConnection!.clearWarning(\r\n      node.component.name,\r\n      node.id,\r\n      \"dbconfig-warning\"\r\n    );\r\n\r\n    const configSchema = graphModel.getMetaData(\"dbConfigSchema\");\r\n    let valueType;\r\n\r\n    if (configSchema) {\r\n      const isCloud =\r\n        typeof (global as any)._noodl_cloud_runtime_version !== \"undefined\";\r\n      ports.push({\r\n        name: \"configKey\",\r\n        displayName: \"Parameter\",\r\n        group: \"General\",\r\n        type: {\r\n          name: \"enum\",\r\n          enums: Object.keys(configSchema)\r\n            .filter((k) => isCloud || !configSchema[k].masterKeyOnly)\r\n            .map((k) => ({ value: k, label: k })),\r\n          allowEditOnly: true,\r\n        },\r\n        plug: \"input\",\r\n      });\r\n\r\n      if (\r\n        node.parameters[\"configKey\"] !== undefined &&\r\n        configSchema &&\r\n        configSchema[node.parameters[\"configKey\"]]\r\n      ) {\r\n        valueType = configSchema[node.parameters[\"configKey\"]].type;\r\n\r\n        if (\r\n          valueType === \"string\" ||\r\n          valueType === \"boolean\" ||\r\n          valueType === \"number\" ||\r\n          valueType === \"object\" ||\r\n          valueType === \"array\"\r\n        ) {\r\n          ports.push({\r\n            name: \"useDevValue\",\r\n            displayName: \"Enable\",\r\n            group: \"Local Override\",\r\n            type: \"boolean\",\r\n            default: false,\r\n            plug: \"input\",\r\n          });\r\n\r\n          if (node.parameters[\"useDevValue\"] === true) {\r\n            ports.push({\r\n              name: \"devValue\",\r\n              displayName: \"Value\",\r\n              group: \"Local Override\",\r\n              type: valueType,\r\n              plug: \"input\",\r\n            });\r\n          }\r\n        }\r\n      } else if (node.parameters[\"configKey\"] !== undefined) {\r\n        context.editorConnection!.sendWarning(\r\n          node.component.name,\r\n          node.id,\r\n          \"dbconfig-warning\",\r\n          {\r\n            showGlobally: true,\r\n            message:\r\n              node.parameters[\"configKey\"] +\r\n              \" config parameter is missing, add it to your cloud service.\",\r\n          }\r\n        );\r\n      }\r\n    } else {\r\n      context.editorConnection!.sendWarning(\r\n        node.component.name,\r\n        node.id,\r\n        \"dbconfig-warning\",\r\n        {\r\n          showGlobally: true,\r\n          message: \"You need an active cloud service.\",\r\n        }\r\n      );\r\n    }\r\n\r\n    ports.push({\r\n      name: \"value\",\r\n      displayName: \"Value\",\r\n      group: \"General\",\r\n      type: valueType || \"*\",\r\n      plug: \"output\",\r\n    });\r\n\r\n    context.editorConnection!.sendDynamicPorts(node.id, ports);\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    updatePorts(node);\r\n\r\n    node.on(\"parameterUpdated\", function () {\r\n      updatePorts(node);\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.dbConfigSchema\", function () {\r\n      ConfigService.instance.clearCache();\r\n      updatePorts(node);\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.DbConfig\", function (node) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"DbConfig\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import { NodeDefinition } from \"../../../nodedefinition\";\r\n\r\ninterface NodeArgs {\r\n  name: string;\r\n  docs?: string;\r\n  shortDesc?: string;\r\n  nodeDoubleClickAction?:\r\n    | string\r\n    | {\r\n        focusPort: string;\r\n      };\r\n  type: { name: string };\r\n  startValue: any;\r\n  cast: (value: any) => any;\r\n  onChanged?: () => void;\r\n}\r\n\r\nexport interface Internal {\r\n  currentValue: any;\r\n  latestValue: any;\r\n}\r\n\r\nexport function createDefinition(args: NodeArgs): NodeDefinition<Internal> {\r\n  return {\r\n    name: args.name,\r\n    docs: args.docs,\r\n    shortDesc: args.shortDesc,\r\n    nodeDoubleClickAction: args.nodeDoubleClickAction,\r\n    category: \"Variables\",\r\n    initialize() {\r\n      this._internal.currentValue = args.startValue;\r\n      this._internal.latestValue = 0;\r\n    },\r\n    getInspectInfo() {\r\n      const type = args.type.name === \"color\" ? \"color\" : \"text\";\r\n      return [{ type, value: this._internal.currentValue }];\r\n    },\r\n    inputs: {\r\n      value: {\r\n        type: args.type,\r\n        displayName: \"Value\",\r\n        default: args.startValue,\r\n        set(value: any) {\r\n          if (this.isInputConnected(\"saveValue\") === false) {\r\n            // @ts-expect-error\r\n            this.setValueTo(value);\r\n          } else {\r\n            this._internal.latestValue = value;\r\n          }\r\n        },\r\n      },\r\n      saveValue: {\r\n        displayName: \"Set\",\r\n        valueChangedToTrue() {\r\n          this.scheduleAfterInputsHaveUpdated(function () {\r\n            // @ts-expect-error\r\n            this.setValueTo(this._internal.latestValue);\r\n            this.sendSignalOnOutput(\"stored\");\r\n          });\r\n        },\r\n      },\r\n    },\r\n    outputs: {\r\n      savedValue: {\r\n        type: args.type.name,\r\n        displayName: \"Value\",\r\n        getter() {\r\n          return this._internal.currentValue;\r\n        },\r\n      },\r\n      changed: {\r\n        type: \"signal\",\r\n        displayName: \"Changed\",\r\n      },\r\n      stored: {\r\n        type: \"signal\",\r\n        displayName: \"Stored\",\r\n      },\r\n    },\r\n    prototypeExtensions: {\r\n      setValueTo(value: any) {\r\n        value = args.cast(value);\r\n        const changed = this._internal.currentValue !== value;\r\n        this._internal.currentValue = value;\r\n\r\n        if (changed) {\r\n          this.flagOutputDirty(\"savedValue\");\r\n          this.sendSignalOnOutput(\"changed\");\r\n          args.onChanged && args.onChanged.call(this);\r\n        }\r\n      },\r\n    },\r\n  };\r\n}\r\n","import { createDefinition } from \"./variablebase\";\r\n\r\nexport const node = createDefinition({\r\n  name: \"Number\",\r\n  docs: \"https://docs.noodl.net/nodes/data/number\",\r\n  startValue: 0,\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"value\",\r\n  },\r\n  type: {\r\n    name: \"number\",\r\n  },\r\n  cast(value: any): number {\r\n    return Number(value);\r\n  },\r\n});\r\n","import { extend } from \"../../../nodedefinition\";\r\nimport { createDefinition } from \"./variablebase\";\r\n\r\ninterface NodeInstance {\r\n  _internal: {\r\n    currentValue: string;\r\n  };\r\n  flagOutputDirty: (name: string) => void;\r\n}\r\n\r\nconst StringNode = createDefinition({\r\n  name: \"String\",\r\n  docs: \"https://docs.noodl.net/nodes/data/string\",\r\n  shortDesc: \"Contains a string (text).\",\r\n  startValue: \"\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"value\",\r\n  },\r\n  type: {\r\n    name: \"string\",\r\n  },\r\n  cast(value: any): string {\r\n    return String(value);\r\n  },\r\n  onChanged: function (this: NodeInstance) {\r\n    this.flagOutputDirty(\"length\");\r\n  },\r\n});\r\n\r\nextend(StringNode, {\r\n  usePortAsLabel: \"value\",\r\n  portLabelTruncationMode: \"length\",\r\n  outputs: {\r\n    length: {\r\n      type: \"number\",\r\n      displayName: \"Length\",\r\n      getter: function (this: NodeInstance): number {\r\n        return this._internal.currentValue.length;\r\n      },\r\n    },\r\n  },\r\n});\r\n\r\nexport const node = StringNode;\r\n","import { createDefinition } from \"./variablebase\";\r\n\r\nexport const node = createDefinition({\r\n  name: \"Boolean\",\r\n  docs: \"https://docs.noodl.net/nodes/data/boolean\",\r\n  startValue: false,\r\n  type: {\r\n    name: \"boolean\",\r\n  },\r\n  cast(value: any): boolean {\r\n    return Boolean(value);\r\n  },\r\n});\r\n","import type { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Condition\",\r\n  docs: \"https://docs.noodl.net/nodes/utilities/logic/condition\",\r\n  category: \"Logic\",\r\n  initialize() {},\r\n  getInspectInfo() {\r\n    const condition = this.getInputValue(\"condition\");\r\n    let value: unknown;\r\n    if (condition === undefined) {\r\n      value = \"[No input]\";\r\n    } else {\r\n      value = condition;\r\n    }\r\n    return [\r\n      {\r\n        type: \"value\",\r\n        value,\r\n      },\r\n    ];\r\n  },\r\n  inputs: {\r\n    condition: {\r\n      type: \"boolean\",\r\n      displayName: \"Condition\",\r\n      group: \"General\",\r\n      set(_value: boolean) {\r\n        if (!this.isInputConnected(\"eval\")) {\r\n          // Evaluate right away\r\n          // @ts-expect-error\r\n          this.scheduleEvaluate();\r\n        }\r\n      },\r\n    },\r\n    eval: {\r\n      type: \"signal\",\r\n      displayName: \"Evaluate\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleEvaluate();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    ontrue: {\r\n      type: \"signal\",\r\n      displayName: \"On True\",\r\n      group: \"Events\",\r\n    },\r\n    onfalse: {\r\n      type: \"signal\",\r\n      displayName: \"On False\",\r\n      group: \"Events\",\r\n    },\r\n    result: {\r\n      type: \"boolean\",\r\n      displayName: \"Is True\",\r\n      group: \"Booleans\",\r\n      getter() {\r\n        return !!this.getInputValue(\"condition\");\r\n      },\r\n    },\r\n    isfalse: {\r\n      type: \"boolean\",\r\n      displayName: \"Is False\",\r\n      group: \"Booleans\",\r\n      getter() {\r\n        return !this.getInputValue(\"condition\");\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    scheduleEvaluate() {\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.flagOutputDirty(\"result\");\r\n        this.flagOutputDirty(\"isfalse\");\r\n\r\n        const condition = this.getInputValue(\"condition\");\r\n        this.sendSignalOnOutput(condition ? \"ontrue\" : \"onfalse\");\r\n      });\r\n    },\r\n  },\r\n};\r\n","import type { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  inputs: boolean[];\r\n  result?: boolean;\r\n}\r\n\r\nfunction and(values: boolean[]): boolean {\r\n  //if none are false, then return true\r\n  return values.length > 0 && values.some((v) => !v) === false;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"And\",\r\n  docs: \"https://docs.noodl.net/nodes/logic/and\",\r\n  category: \"Logic\",\r\n  initialize() {\r\n    this._internal = {\r\n      inputs: [],\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    return and(this._internal.inputs);\r\n  },\r\n  numberedInputs: {\r\n    input: {\r\n      displayPrefix: \"Input\",\r\n      type: \"boolean\",\r\n      createSetter(index: number) {\r\n        return function (\r\n          this: {\r\n            _internal: Internal;\r\n            flagOutputDirty: (name: string) => void;\r\n          },\r\n          value: unknown\r\n        ) {\r\n          const boolValue = value ? true : false;\r\n\r\n          if (this._internal.inputs[index] === boolValue) {\r\n            return;\r\n          }\r\n\r\n          this._internal.inputs[index] = boolValue;\r\n          const result = and(this._internal.inputs);\r\n\r\n          if (this._internal.result !== result) {\r\n            this._internal.result = result;\r\n            this.flagOutputDirty(\"result\");\r\n          }\r\n        };\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: \"boolean\",\r\n      displayName: \"Result\",\r\n      get() {\r\n        return this._internal.result;\r\n      },\r\n    },\r\n  },\r\n};\r\n","import type { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  inputs: boolean[];\r\n}\r\n\r\nfunction isTrue(value: boolean): boolean {\r\n  return value ? true : false;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Or\",\r\n  docs: \"https://docs.noodl.net/nodes/logic/or\",\r\n  category: \"Logic\",\r\n  initialize() {\r\n    this._internal.inputs = [];\r\n  },\r\n  getInspectInfo(): boolean {\r\n    return this._internal.inputs.some(isTrue);\r\n  },\r\n  numberedInputs: {\r\n    input: {\r\n      type: \"boolean\",\r\n      displayPrefix: \"Input\",\r\n      createSetter(index: number) {\r\n        return function (value: boolean): void {\r\n          if (this._internal.inputs[index] === value) {\r\n            return;\r\n          }\r\n\r\n          this._internal.inputs[index] = value;\r\n          this.flagOutputDirty(\"result\");\r\n        };\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: \"boolean\",\r\n      displayName: \"Result\",\r\n      getter: function (): boolean {\r\n        return this._internal.inputs.some(isTrue);\r\n      },\r\n    },\r\n  },\r\n};\r\n","import type { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  inputs: any[];\r\n  currentSelectedIndex: number;\r\n  indexChanged: boolean;\r\n  trueString: string;\r\n  falseString: string;\r\n  currentInput?: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Boolean To String\",\r\n  docs: \"https://docs.noodl.net/nodes/utilities/boolean-to-string\",\r\n  category: \"Utilities\",\r\n  initialize() {\r\n    this._internal.inputs = [];\r\n    this._internal.currentSelectedIndex = 0;\r\n    this._internal.indexChanged = false;\r\n\r\n    this._internal.trueString = \"\";\r\n    this._internal.falseString = \"\";\r\n  },\r\n  inputs: {\r\n    trueString: {\r\n      displayName: \"String for true\",\r\n      type: \"string\",\r\n      set(value: string) {\r\n        if (this._internal.trueString === value) return;\r\n        this._internal.trueString = value;\r\n\r\n        if (this._internal.currentInput) {\r\n          this.flagOutputDirty(\"currentValue\");\r\n        }\r\n      },\r\n    },\r\n    falseString: {\r\n      displayName: \"String for false\",\r\n      type: \"string\",\r\n      set(value: string) {\r\n        if (this._internal.falseString === value) return;\r\n        this._internal.falseString = value;\r\n\r\n        if (!this._internal.currentInput) {\r\n          this.flagOutputDirty(\"currentValue\");\r\n        }\r\n      },\r\n    },\r\n    input: {\r\n      type: { name: \"boolean\" },\r\n      displayName: \"Selector\",\r\n      set(value: boolean) {\r\n        if (this._internal.currentInput === value) return;\r\n\r\n        this._internal.currentInput = value;\r\n        this.flagOutputDirty(\"currentValue\");\r\n        this.sendSignalOnOutput(\"inputChanged\");\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    currentValue: {\r\n      type: \"string\",\r\n      displayName: \"Current Value\",\r\n      group: \"Value\",\r\n      getter(): string {\r\n        return this._internal.currentInput\r\n          ? this._internal.trueString\r\n          : this._internal.falseString;\r\n      },\r\n    },\r\n    inputChanged: {\r\n      type: \"signal\",\r\n      displayName: \"Selector Changed\",\r\n      group: \"Signals\",\r\n    },\r\n  },\r\n};\r\n","import type { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  formatString: string;\r\n  currentInput?: Date;\r\n  dateString?: string;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Date To String\",\r\n  docs: \"https://docs.noodl.net/nodes/utilities/date-to-string\",\r\n  category: \"Utilities\",\r\n  initialize() {\r\n    this._internal.formatString = \"{year}-{month}-{date}\";\r\n  },\r\n  inputs: {\r\n    formatString: {\r\n      displayName: \"Format\",\r\n      type: \"string\",\r\n      default: \"{year}-{month}-{date}\",\r\n      set(value: string) {\r\n        if (this._internal.formatString === value) return;\r\n        this._internal.formatString = value;\r\n\r\n        if (this._internal.currentInput !== undefined) {\r\n          // @ts-expect-error\r\n          this._format();\r\n          this.flagOutputDirty(\"currentValue\");\r\n        }\r\n      },\r\n    },\r\n    input: {\r\n      type: {\r\n        name: \"date\",\r\n      },\r\n      displayName: \"Date\",\r\n      set(value: Date | string) {\r\n        const _value = typeof value === \"string\" ? new Date(value) : value;\r\n        if (this._internal.currentInput === _value) return;\r\n\r\n        this._internal.currentInput = _value;\r\n        // @ts-expect-error\r\n        this._format();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    currentValue: {\r\n      type: \"string\",\r\n      displayName: \"Date String\",\r\n      group: \"Value\",\r\n      getter() {\r\n        return this._internal.dateString;\r\n      },\r\n    },\r\n    inputChanged: {\r\n      type: \"signal\",\r\n      displayName: \"Date Changed\",\r\n      group: \"Signals\",\r\n    },\r\n    onError: {\r\n      type: \"signal\",\r\n      displayName: \"Invalid Date\",\r\n      group: \"Signals\",\r\n    },\r\n  },\r\n  methods: {\r\n    _format() {\r\n      try {\r\n        const t = this._internal.currentInput!;\r\n        const format = this._internal.formatString;\r\n        const date = (\"0\" + t.getDate()).slice(-2);\r\n        const month = (\"0\" + (t.getMonth() + 1)).slice(-2);\r\n        const monthShort = new Intl.DateTimeFormat(\"en-US\", {\r\n          month: \"short\",\r\n        }).format(t);\r\n        const year = t.getFullYear();\r\n        const yearShort = year.toString().substring(2);\r\n        const hours = (\"0\" + t.getHours()).slice(-2);\r\n        const minutes = (\"0\" + t.getMinutes()).slice(-2);\r\n        const seconds = (\"0\" + t.getSeconds()).slice(-2);\r\n\r\n        this._internal.dateString = format\r\n          .replace(/\\{date\\}/g, date)\r\n          .replace(/\\{month\\}/g, String(month))\r\n          .replace(/\\{monthShort\\}/g, monthShort)\r\n          .replace(/\\{year\\}/g, String(year))\r\n          .replace(/\\{yearShort\\}/g, String(yearShort))\r\n          .replace(/\\{hours\\}/g, String(hours))\r\n          .replace(/\\{minutes\\}/g, String(minutes))\r\n          .replace(/\\{seconds\\}/g, String(seconds));\r\n      } catch (error) {\r\n        // Set the output to be blank, makes it easier to handle.\r\n        this._internal.dateString = \"\";\r\n        this.flagOutputDirty(\"onError\");\r\n      }\r\n\r\n      // Flag that the value have changed\r\n      this.flagOutputDirty(\"currentValue\");\r\n      this.sendSignalOnOutput(\"inputChanged\");\r\n    },\r\n  },\r\n};\r\n","import type { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  inputs: string[];\r\n  mappings: string[];\r\n  currentInputString?: string;\r\n  defaultMapping?: string;\r\n  mappedString?: string;\r\n  hasScheduledFetch?: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"String Mapper\",\r\n  docs: \"https://docs.noodl.net/nodes/string-manipulation/string-mapper\",\r\n  category: \"Utilities\",\r\n  initialize() {\r\n    this._internal = {\r\n      inputs: [],\r\n      mappings: [],\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.mappedString;\r\n  },\r\n  numberedInputs: {\r\n    input: {\r\n      type: \"string\",\r\n      displayPrefix: \"Input\",\r\n      group: \"Inputs\",\r\n      index: 10,\r\n      createSetter(index: number) {\r\n        return function (value: string) {\r\n          value = value === undefined ? \"\" : String(value);\r\n          this._internal.inputs[index] = value;\r\n          // @ts-expect-error\r\n          this.scheduleMapping();\r\n        };\r\n      },\r\n    },\r\n    output: {\r\n      type: \"string\",\r\n      displayPrefix: \"Mapping\",\r\n      index: 1001,\r\n      group: \"Mappings\",\r\n      createSetter(index: number) {\r\n        return function (value: string) {\r\n          value = value === undefined ? \"\" : String(value);\r\n          this._internal.mappings[index] = value;\r\n          // @ts-expect-error\r\n          this.scheduleMapping();\r\n        };\r\n      },\r\n    },\r\n  },\r\n  inputs: {\r\n    inputString: {\r\n      type: {\r\n        name: \"string\",\r\n      },\r\n      index: 1,\r\n      displayName: \"Input String\",\r\n      set(value: unknown) {\r\n        this._internal.currentInputString =\r\n          value !== undefined ? String(value) : undefined;\r\n        // @ts-expect-error\r\n        this.scheduleMapping();\r\n      },\r\n    },\r\n    defaultMapping: {\r\n      type: \"string\",\r\n      displayName: \"Default\",\r\n      index: 1000,\r\n      group: \"Mappings\",\r\n      set(value: string) {\r\n        this._internal.defaultMapping = value;\r\n        // @ts-expect-error\r\n        this.scheduleMapping();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    mappedString: {\r\n      type: \"string\",\r\n      displayName: \"Mapped String\",\r\n      group: \"Value\",\r\n      getter() {\r\n        return this._internal.mappedString;\r\n      },\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    doMapping() {\r\n      this._internal.hasScheduledFetch = false;\r\n      const idx = this._internal.inputs.indexOf(\r\n        this._internal.currentInputString!\r\n      );\r\n      if (idx !== -1)\r\n        this._internal.mappedString = this._internal.mappings[idx];\r\n      else this._internal.mappedString = this._internal.defaultMapping;\r\n\r\n      this.flagOutputDirty(\"mappedString\");\r\n    },\r\n    scheduleMapping() {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledFetch) {\r\n        internal.hasScheduledFetch = true;\r\n        // @ts-expect-error\r\n        this.scheduleAfterInputsHaveUpdated(this.doMapping.bind(this));\r\n      }\r\n    },\r\n  },\r\n};\r\n","import type { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  currentValue?: boolean;\r\n}\r\n\r\nfunction invert(value?: boolean): boolean | undefined {\r\n  if (value === undefined) {\r\n    return undefined;\r\n  }\r\n  return !value;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Inverter\",\r\n  docs: \"https://docs.noodl.net/nodes/logic/inverter\",\r\n  category: \"Logic\",\r\n  initialize() {\r\n    this._internal.currentValue = undefined;\r\n  },\r\n  getInspectInfo() {\r\n    return String(invert(this._internal.currentValue));\r\n  },\r\n  inputs: {\r\n    value: {\r\n      type: {\r\n        name: \"boolean\",\r\n      },\r\n      displayName: \"Value\",\r\n      set(value: boolean) {\r\n        this._internal.currentValue = value;\r\n        this.flagOutputDirty(\"result\");\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: \"boolean\",\r\n      displayName: \"Result\",\r\n      getter() {\r\n        return invert(this._internal.currentValue);\r\n      },\r\n    },\r\n  },\r\n};\r\n","import type { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  startIndex: number;\r\n  endIndex: number;\r\n  cachedResult: string;\r\n  inputString: string;\r\n  resultDirty: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Substring\",\r\n  docs: \"https://docs.noodl.net/nodes/string-manipulation/substring\",\r\n  category: \"String Manipulation\",\r\n  initialize() {\r\n    var internal = this._internal;\r\n    internal.startIndex = 0;\r\n    internal.endIndex = -1;\r\n    internal.cachedResult = \"\";\r\n    internal.inputString = \"\";\r\n    internal.resultDirty = false;\r\n  },\r\n  inputs: {\r\n    start: {\r\n      type: \"number\",\r\n      displayName: \"Start\",\r\n      default: 0,\r\n      set(value: number) {\r\n        this._internal.startIndex = value;\r\n        this._internal.resultDirty = true;\r\n        this.flagOutputDirty(\"result\");\r\n      },\r\n    },\r\n    end: {\r\n      type: \"number\",\r\n      displayName: \"End\",\r\n      default: 0,\r\n      set(value: number) {\r\n        this._internal.endIndex = value;\r\n        this._internal.resultDirty = true;\r\n        this.flagOutputDirty(\"result\");\r\n      },\r\n    },\r\n    string: {\r\n      type: {\r\n        name: \"string\",\r\n      },\r\n      displayName: \"String\",\r\n      default: \"\",\r\n      set(value: unknown) {\r\n        const stringValue = String(value);\r\n        this._internal.inputString = stringValue;\r\n        this._internal.resultDirty = true;\r\n        this.flagOutputDirty(\"result\");\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: \"string\",\r\n      displayName: \"Result\",\r\n      getter() {\r\n        var internal = this._internal;\r\n\r\n        if (internal.resultDirty) {\r\n          if (internal.endIndex === -1) {\r\n            internal.cachedResult = internal.inputString.substr(\r\n              internal.startIndex\r\n            );\r\n          } else {\r\n            internal.cachedResult = internal.inputString.substr(\r\n              internal.startIndex,\r\n              internal.endIndex - internal.startIndex\r\n            );\r\n          }\r\n          internal.resultDirty = false;\r\n        }\r\n        return internal.cachedResult;\r\n      },\r\n    },\r\n  },\r\n};\r\n","import { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  format: string;\r\n  cachedResult: string;\r\n  resultDirty: boolean;\r\n  inputValues: Record<string, any>;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"String Format\",\r\n  docs: \"https://docs.noodl.net/nodes/string-manipulation/string-format\",\r\n  category: \"String Manipulation\",\r\n  usePortAsLabel: \"format\",\r\n  portLabelTruncationMode: \"length\" as const,\r\n  initialize() {\r\n    const internal = this._internal;\r\n    internal.format = \"\";\r\n    internal.cachedResult = \"\";\r\n    internal.resultDirty = false;\r\n    internal.inputValues = {};\r\n  },\r\n  getInspectInfo() {\r\n    // @ts-expect-error\r\n    return this.formatValue();\r\n  },\r\n  inputs: {\r\n    format: {\r\n      type: { name: \"string\", multiline: true },\r\n      displayName: \"Format\",\r\n      set(value: string): void {\r\n        if (this._internal.format === value) return;\r\n\r\n        this._internal.format = value;\r\n        this._internal.resultDirty = true;\r\n        // @ts-expect-error\r\n        this.scheduleFormat();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    formatted: {\r\n      type: \"string\",\r\n      displayName: \"Formatted\",\r\n      get() {\r\n        // @ts-expect-error\r\n        return this.formatValue();\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    formatValue(): string {\r\n      const internal = this._internal;\r\n\r\n      if (internal.resultDirty) {\r\n        let formatted = internal.format;\r\n\r\n        const matches = internal.format.match(/\\{[A-Za-z0-9_]*\\}/g);\r\n        let inputs: string[] = [];\r\n        if (matches) {\r\n          inputs = matches.map((name) => {\r\n            return name.replace(\"{\", \"\").replace(\"}\", \"\");\r\n          });\r\n        }\r\n\r\n        inputs.forEach((name) => {\r\n          const v = internal.inputValues[name];\r\n          formatted = formatted.replace(\r\n            \"{\" + name + \"}\",\r\n            v !== undefined ? v : \"\"\r\n          );\r\n        });\r\n\r\n        internal.cachedResult = formatted;\r\n        internal.resultDirty = false;\r\n      }\r\n\r\n      return internal.cachedResult;\r\n    },\r\n    registerInputIfNeeded(name: string): void {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerInput(name, {\r\n        set(value) {\r\n          if (this._internal.inputValues[name] === value) return;\r\n\r\n          this._internal.inputValues[name] = value;\r\n          this._internal.resultDirty = true;\r\n          // @ts-expect-error\r\n          this.scheduleFormat();\r\n        },\r\n      });\r\n    },\r\n    scheduleFormat(): void {\r\n      // @ts-expect-error\r\n      if (this.formatScheduled) return;\r\n\r\n      // @ts-expect-error\r\n      this.formatScheduled = true;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.formatValue();\r\n        this.flagOutputDirty(\"formatted\");\r\n        // @ts-expect-error\r\n        this.formatScheduled = false;\r\n      });\r\n    },\r\n  },\r\n};\r\n\r\ninterface EditorConnection {\r\n  isRunningLocally: () => boolean;\r\n  sendDynamicPorts: (id: string, ports: Port[]) => void;\r\n}\r\n\r\ninterface Port {\r\n  name: string;\r\n  type: string;\r\n  plug: string;\r\n}\r\n\r\ninterface GraphNode {\r\n  id: string;\r\n  parameters: {\r\n    format?: string;\r\n  };\r\n  on: (event: string, callback: (event: any) => void) => void;\r\n}\r\n\r\ninterface GraphModel {\r\n  on: (event: string, callback: (node: GraphNode) => void) => void;\r\n}\r\n\r\ninterface Context {\r\n  editorConnection?: EditorConnection;\r\n}\r\n\r\nfunction updatePorts(\r\n  id: string,\r\n  format: string,\r\n  editorConnection: EditorConnection\r\n): void {\r\n  const inputs = format.match(/\\{[A-Za-z0-9_]*\\}/g) || [];\r\n  const portsNames = inputs.map((def) => {\r\n    return def.replace(\"{\", \"\").replace(\"}\", \"\");\r\n  });\r\n\r\n  const ports = portsNames\r\n    //get unique names\r\n    .filter((value, index, self) => {\r\n      return self.indexOf(value) === index;\r\n    })\r\n    //and map names to ports\r\n    .map((name) => {\r\n      return {\r\n        name: name,\r\n        type: \"string\",\r\n        plug: \"input\",\r\n      };\r\n    });\r\n\r\n  editorConnection.sendDynamicPorts(id, ports);\r\n}\r\n\r\nexport function setup(context: Context, graphModel: GraphModel): void {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  graphModel.on(\"nodeAdded.String Format\", (node: GraphNode) => {\r\n    if (node.parameters.format) {\r\n      updatePorts(node.id, node.parameters.format, context.editorConnection!);\r\n    }\r\n    node.on(\"parameterUpdated\", (event: { name: string }) => {\r\n      if (event.name === \"format\") {\r\n        updatePorts(\r\n          node.id,\r\n          node.parameters.format!,\r\n          context.editorConnection!\r\n        );\r\n      }\r\n    });\r\n  });\r\n}\r\n","import type { NodeDefinition } from \"../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  currentValue: number;\r\n  startValue: number;\r\n  startValueSet: boolean;\r\n  limitsEnabled: boolean;\r\n  limitsMin: number;\r\n  limitsMax: number;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Counter\",\r\n  docs: \"https://docs.noodl.net/nodes/math/counter\",\r\n  category: \"Math\",\r\n  initialize() {\r\n    this._internal.currentValue = 0;\r\n    this._internal.startValue = 0;\r\n    this._internal.startValueSet = false;\r\n\r\n    this._internal.limitsEnabled = false;\r\n    this._internal.limitsMin = 0;\r\n    this._internal.limitsMax = 0;\r\n  },\r\n  getInspectInfo() {\r\n    return \"Count: \" + this._internal.currentValue;\r\n  },\r\n  inputs: {\r\n    increase: {\r\n      group: \"Actions\",\r\n      displayName: \"Increase Count\",\r\n      valueChangedToTrue() {\r\n        if (\r\n          this._internal.limitsEnabled &&\r\n          this._internal.currentValue >= this._internal.limitsMax\r\n        ) {\r\n          return;\r\n        }\r\n\r\n        this._internal.currentValue++;\r\n        this.flagOutputDirty(\"currentCount\");\r\n        this.sendSignalOnOutput(\"countChanged\");\r\n      },\r\n    },\r\n    decrease: {\r\n      group: \"Actions\",\r\n      displayName: \"Decrease Count\",\r\n      valueChangedToTrue() {\r\n        if (\r\n          this._internal.limitsEnabled &&\r\n          this._internal.currentValue <= this._internal.limitsMin\r\n        ) {\r\n          return;\r\n        }\r\n\r\n        this._internal.currentValue--;\r\n        this.flagOutputDirty(\"currentCount\");\r\n        this.sendSignalOnOutput(\"countChanged\");\r\n      },\r\n    },\r\n    reset: {\r\n      group: \"Actions\",\r\n      displayName: \"Reset To Start\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        if (this.currentValue === 0) {\r\n          return;\r\n        }\r\n        this._internal.currentValue = this._internal.startValue;\r\n        this.flagOutputDirty(\"currentCount\");\r\n        this.sendSignalOnOutput(\"countChanged\");\r\n      },\r\n    },\r\n    startValue: {\r\n      type: \"number\",\r\n      displayName: \"Start Value\",\r\n      default: 0,\r\n      set(value: number) {\r\n        this._internal.startValue = Number(value);\r\n\r\n        if (this._internal.startValueSet === false) {\r\n          this._internal.startValueSet = true;\r\n          this._internal.currentValue = this._internal.startValue;\r\n          this.flagOutputDirty(\"currentCount\");\r\n          this.sendSignalOnOutput(\"countChanged\");\r\n        }\r\n      },\r\n    },\r\n    limitsMin: {\r\n      type: {\r\n        name: \"number\",\r\n      },\r\n      displayName: \"Min Value\",\r\n      group: \"Limits\",\r\n      default: 0,\r\n      set(value: number) {\r\n        this._internal.limitsMin = Number(value);\r\n      },\r\n    },\r\n    limitsMax: {\r\n      type: {\r\n        name: \"number\",\r\n      },\r\n      displayName: \"Max Value\",\r\n      group: \"Limits\",\r\n      default: 0,\r\n      set(value: number) {\r\n        this._internal.limitsMax = Number(value);\r\n      },\r\n    },\r\n    limitsEnabled: {\r\n      type: {\r\n        name: \"boolean\",\r\n      },\r\n      displayName: \"Limits Enabled\",\r\n      group: \"Limits\",\r\n      default: false,\r\n      set(value: boolean) {\r\n        this._internal.limitsEnabled = value ? true : false;\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    currentCount: {\r\n      displayName: \"Current Count\",\r\n      type: \"number\",\r\n      getter() {\r\n        return this._internal.currentValue;\r\n      },\r\n    },\r\n    countChanged: {\r\n      displayName: \"Count Changed\",\r\n      type: \"signal\",\r\n    },\r\n  },\r\n};\r\n","import { NodeDefinition } from \"../../nodedefinition\";\r\nimport { guid } from \"../../utils\";\r\n\r\ninterface Internal {\r\n  guid: string;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Unique Id\",\r\n  docs: \"https://docs.noodl.net/nodes/utilities/unique-id\",\r\n  category: \"String Manipulation\",\r\n  initialize() {\r\n    const internal = this._internal;\r\n    internal.guid = guid();\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.guid;\r\n  },\r\n  inputs: {\r\n    new: {\r\n      displayName: \"New\",\r\n      valueChangedToTrue: function () {\r\n        const internal = this._internal;\r\n        internal.guid = guid();\r\n        this.flagOutputDirty(\"guid\");\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    guid: {\r\n      type: \"string\",\r\n      displayName: \"Id\",\r\n      getter: function () {\r\n        const internal = this._internal;\r\n        return internal.guid;\r\n      },\r\n    },\r\n  },\r\n  prototypeExtensions: {},\r\n};\r\n","import type { NodeContext } from \"../../../nodecontext\";\r\nimport type { GraphModel } from \"../../../models/graphmodel\";\r\nimport type { Port } from \"../../../models/componentmodel\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  userProperties: { [key: string]: any };\r\n  error?: string;\r\n  email?: string;\r\n  username?: string;\r\n}\r\n\r\ninterface SchemaProperty {\r\n  type: string;\r\n}\r\n\r\ninterface Collection {\r\n  name: string;\r\n  schema?: {\r\n    properties: {\r\n      [key: string]: SchemaProperty;\r\n    };\r\n  };\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"net.noodl.user.SetUserProperties\",\r\n  docs: \"https://docs.noodl.net/nodes/data/user/set-user-properties\",\r\n  displayNodeName: \"Set User Properties\",\r\n  category: \"Cloud Services\",\r\n  color: \"data\",\r\n  initialize() {\r\n    const internal = this._internal;\r\n    internal.userProperties = {};\r\n  },\r\n  outputs: {\r\n    success: {\r\n      type: \"signal\",\r\n      displayName: \"Success\",\r\n      group: \"Events\",\r\n    },\r\n    failure: {\r\n      type: \"signal\",\r\n      displayName: \"Failure\",\r\n      group: \"Events\",\r\n    },\r\n    error: {\r\n      type: \"string\",\r\n      displayName: \"Error\",\r\n      group: \"Error\",\r\n      getter() {\r\n        return this._internal.error;\r\n      },\r\n    },\r\n  },\r\n  inputs: {\r\n    store: {\r\n      displayName: \"Do\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleStore();\r\n      },\r\n    },\r\n    email: {\r\n      displayName: \"Email\",\r\n      type: \"string\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.email = value;\r\n      },\r\n    },\r\n    username: {\r\n      displayName: \"Username\",\r\n      type: \"string\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.username = value;\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    setError(err: string) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty(\"error\");\r\n      this.sendSignalOnOutput(\"failure\");\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          this.nodeScope!.componentOwner.name,\r\n          this.id,\r\n          \"user-set-warning\",\r\n          {\r\n            message: err,\r\n            showGlobally: true,\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          this.nodeScope!.componentOwner.name,\r\n          this.id,\r\n          \"user-set-warning\"\r\n        );\r\n      }\r\n    },\r\n    scheduleStore() {\r\n      const internal = this._internal;\r\n\r\n      // @ts-expect-error\r\n      if (this.storeScheduled === true) return;\r\n      // @ts-expect-error\r\n      this.storeScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.storeScheduled = false;\r\n\r\n        // @ts-expect-error\r\n        const UserService = NoodlRuntime.Services.UserService;\r\n        UserService.forScope(this.nodeScope!.modelScope).setUserProperties({\r\n          email: this._internal.email,\r\n          username: this._internal.username,\r\n          properties: internal.userProperties,\r\n          success: () => {\r\n            this.sendSignalOnOutput(\"success\");\r\n          },\r\n          error: (e: string) => {\r\n            // @ts-expect-error\r\n            this.setError(e);\r\n          },\r\n        });\r\n      });\r\n    },\r\n    setUserProperty(name: string, value: any) {\r\n      this._internal.userProperties[name] = value;\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"prop-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setUserProperty.bind(this, name.substring(\"prop-\".length)),\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\nfunction updatePorts(\r\n  nodeId: string,\r\n  parameters: any,\r\n  editorConnection: any,\r\n  systemCollections: Collection[]\r\n) {\r\n  const ports: Port[] = [];\r\n\r\n  if (systemCollections) {\r\n    // Fetch ports from collection keys\r\n    const c = systemCollections.find((c) => c.name === \"_User\");\r\n    if (c && c.schema && c.schema.properties) {\r\n      const props = c.schema.properties;\r\n\r\n      const _ignoreKeys =\r\n        // @ts-expect-error\r\n        typeof _noodl_cloud_runtime_version === \"undefined\"\r\n          ? [\r\n              \"authData\",\r\n              \"createdAt\",\r\n              \"updatedAt\",\r\n              \"email\",\r\n              \"username\",\r\n              \"emailVerified\",\r\n              \"password\",\r\n            ]\r\n          : [\"authData\", \"createdAt\", \"updatedAt\", \"email\", \"username\"];\r\n\r\n      for (const key in props) {\r\n        if (_ignoreKeys.indexOf(key) !== -1) continue;\r\n\r\n        const p = props[key];\r\n        if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n        if (p.type === \"Relation\") {\r\n        } else {\r\n          // Other schema type ports\r\n          const _typeMap: { [key: string]: string } = {\r\n            String: \"string\",\r\n            Boolean: \"boolean\",\r\n            Number: \"number\",\r\n            Date: \"date\",\r\n          };\r\n\r\n          ports.push({\r\n            type: {\r\n              name: _typeMap[p.type] ? _typeMap[p.type] : \"*\",\r\n            },\r\n            plug: \"input\",\r\n            group: \"Properties\",\r\n            name: \"prop-\" + key,\r\n            displayName: key,\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    updatePorts(\r\n      node.id,\r\n      node.parameters,\r\n      context.editorConnection,\r\n      graphModel.getMetaData(\"systemCollections\")\r\n    );\r\n\r\n    node.on(\"parameterUpdated\", function (event: any) {\r\n      updatePorts(\r\n        node.id,\r\n        node.parameters,\r\n        context.editorConnection,\r\n        graphModel.getMetaData(\"systemCollections\")\r\n      );\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.systemCollections\", function (data: any) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\r\n      \"nodeAdded.net.noodl.user.SetUserProperties\",\r\n      function (node: any) {\r\n        _managePortsForNode(node);\r\n      }\r\n    );\r\n\r\n    for (const node of graphModel.getNodesWithType(\r\n      \"net.noodl.user.SetUserProperties\"\r\n    )) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import type { GraphModel } from \"../../../models/graphmodel\";\r\nimport type { NodeContext } from \"../../../nodecontext\";\r\nimport { NodeDefinition } from \"../../../nodedefinition\";\r\n\r\ninterface Internal {\r\n  onModelChangedCallback?: (args: { name: string }) => void;\r\n  model?: any;\r\n  error?: string;\r\n  [key: string]: any;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"net.noodl.user.User\",\r\n  docs: \"https://docs.noodl.net/nodes/data/user/user-node\",\r\n  displayNodeName: \"User\",\r\n  category: \"Cloud Services\",\r\n  color: \"data\",\r\n  initialize() {\r\n    const _this = this;\r\n    this._internal.onModelChangedCallback = function (args) {\r\n      if (_this.isInputConnected(\"fetch\")) return;\r\n\r\n      if (_this.hasOutput(\"prop-\" + args.name))\r\n        _this.flagOutputDirty(\"prop-\" + args.name);\r\n\r\n      if (_this.hasOutput(\"changed-\" + args.name))\r\n        _this.sendSignalOnOutput(\"changed-\" + args.name);\r\n\r\n      _this.sendSignalOnOutput(\"changed\");\r\n    };\r\n\r\n    // @ts-expect-error\r\n    const userService = NoodlRuntime.Services.UserService.forScope(\r\n      // @ts-expect-error\r\n      this.nodeScope.modelScope\r\n    );\r\n\r\n    // @ts-expect-error\r\n    this.setUserModel(userService.current);\r\n    userService.on(\"loggedIn\", () => {\r\n      // @ts-expect-error\r\n      this.setUserModel(userService.current);\r\n\r\n      if (this.hasOutput(\"loggedIn\")) this.sendSignalOnOutput(\"loggedIn\");\r\n    });\r\n\r\n    userService.on(\"sessionGained\", () => {\r\n      // @ts-expect-error\r\n      this.setUserModel(userService.current);\r\n    });\r\n\r\n    userService.on(\"loggedOut\", () => {\r\n      // @ts-expect-error\r\n      this.setUserModel(undefined);\r\n      if (this.hasOutput(\"loggedOut\")) this.sendSignalOnOutput(\"loggedOut\");\r\n    });\r\n\r\n    userService.on(\"sessionLost\", () => {\r\n      // @ts-expect-error\r\n      this.setUserModel(undefined);\r\n      if (this.hasOutput(\"sessionLost\")) this.sendSignalOnOutput(\"sessionLost\");\r\n    });\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return \"[No Model]\";\r\n\r\n    return [\r\n      { type: \"text\", value: \"Id: \" + model.getId() },\r\n      { type: \"value\", value: this._internal.model.data },\r\n    ];\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: \"string\",\r\n      displayName: \"Id\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.model !== undefined\r\n          ? this._internal.model.getId()\r\n          : undefined;\r\n      },\r\n    },\r\n    fetched: {\r\n      type: \"signal\",\r\n      displayName: \"Fetched\",\r\n      group: \"Events\",\r\n    },\r\n    changed: {\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n      group: \"Events\",\r\n    },\r\n    failure: {\r\n      type: \"signal\",\r\n      displayName: \"Failure\",\r\n      group: \"Events\",\r\n    },\r\n    error: {\r\n      type: \"string\",\r\n      displayName: \"Error\",\r\n      group: \"Error\",\r\n      getter() {\r\n        return this._internal.error;\r\n      },\r\n    },\r\n    username: {\r\n      type: \"string\",\r\n      displayName: \"Username\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.model !== undefined\r\n          ? this._internal.model.get(\"username\")\r\n          : undefined;\r\n      },\r\n    },\r\n    email: {\r\n      type: \"string\",\r\n      displayName: \"Email\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.model !== undefined\r\n          ? this._internal.model.get(\"email\")\r\n          : undefined;\r\n      },\r\n    },\r\n    authenticated: {\r\n      type: \"boolean\",\r\n      displayName: \"Authenticated\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.model !== undefined;\r\n      },\r\n    },\r\n  },\r\n  inputs: {\r\n    fetch: {\r\n      displayName: \"Fetch\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleFetch();\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    _onNodeDeleted() {\r\n      // @ts-expect-error\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      if (this._internal.model)\r\n        this._internal.model.off(\r\n          \"change\",\r\n          this._internal.onModelChangedCallback\r\n        );\r\n    },\r\n    scheduleOnce(type: string, cb: () => void) {\r\n      const _this = this;\r\n      const _type = \"hasScheduled\" + type;\r\n      if (this._internal[_type]) return;\r\n      this._internal[_type] = true;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        _this._internal[_type] = false;\r\n        cb();\r\n      });\r\n    },\r\n    setError(err: string) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty(\"error\");\r\n      this.sendSignalOnOutput(\"failure\");\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          this.nodeScope!.componentOwner.name,\r\n          this.id,\r\n          \"user-warning\",\r\n          {\r\n            message: err,\r\n            showGlobally: true,\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          this.nodeScope!.componentOwner.name,\r\n          this.id,\r\n          \"user-warning\"\r\n        );\r\n      }\r\n    },\r\n    setUserModel(model: any) {\r\n      const internal = this._internal;\r\n\r\n      if (internal.model !== model) {\r\n        // Check if we need to change model\r\n        if (internal.model)\r\n          // Remove old listener if existing\r\n          internal.model.off(\"change\", internal.onModelChangedCallback);\r\n\r\n        internal.model = model;\r\n        if (model) model.on(\"change\", internal.onModelChangedCallback);\r\n      }\r\n      this.flagOutputDirty(\"id\");\r\n      this.flagOutputDirty(\"authenticated\");\r\n      this.flagOutputDirty(\"email\");\r\n      this.flagOutputDirty(\"username\");\r\n\r\n      // Notify all properties changed\r\n      if (model)\r\n        for (const key in model.data) {\r\n          if (this.hasOutput(\"prop-\" + key))\r\n            this.flagOutputDirty(\"prop-\" + key);\r\n        }\r\n    },\r\n    scheduleFetch() {\r\n      const internal = this._internal;\r\n\r\n      // @ts-expect-error\r\n      this.scheduleOnce(\"Fetch\", () => {\r\n        // @ts-expect-error\r\n        const userService = NoodlRuntime.Services.UserService.forScope(\r\n          this.nodeScope!.modelScope\r\n        );\r\n        userService.fetchCurrentUser({\r\n          success: (response: any) => {\r\n            // @ts-expect-error\r\n            this.setUserModel(userService.current);\r\n\r\n            this.sendSignalOnOutput(\"fetched\");\r\n          },\r\n          error: (err: string) => {\r\n            // @ts-expect-error\r\n            this.setError(err || \"Failed to fetch.\");\r\n          },\r\n        });\r\n      });\r\n    },\r\n    registerOutputIfNeeded(name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (\r\n        name === \"loggedOut\" ||\r\n        name === \"loggedIn\" ||\r\n        name === \"sessionLost\"\r\n      ) {\r\n        this.registerOutput(name, {\r\n          getter: () => {} /* No getter needed, signal */,\r\n        });\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"prop-\"))\r\n        this.registerOutput(name, {\r\n          // @ts-expect-error\r\n          getter: this.getUserProperty.bind(\r\n            this,\r\n            name.substring(\"prop-\".length)\r\n          ),\r\n        });\r\n    },\r\n    getUserProperty(name: string) {\r\n      return this._internal.model !== undefined\r\n        ? this._internal.model.get(name)\r\n        : undefined;\r\n    },\r\n  },\r\n};\r\n\r\ninterface Port {\r\n  type:\r\n    | {\r\n        name: string;\r\n      }\r\n    | string;\r\n  plug: string;\r\n  group: string;\r\n  name: string;\r\n  displayName: string;\r\n}\r\n\r\ninterface SchemaProperty {\r\n  type: string;\r\n}\r\n\r\ninterface Collection {\r\n  name: string;\r\n  schema?: {\r\n    properties: {\r\n      [key: string]: SchemaProperty;\r\n    };\r\n  };\r\n}\r\n\r\nfunction updatePorts(\r\n  nodeId: string,\r\n  parameters: any,\r\n  editorConnection: any,\r\n  systemCollections: Collection[]\r\n) {\r\n  const ports: Port[] = [];\r\n\r\n  if (systemCollections) {\r\n    // Fetch ports from collection keys\r\n    const c = systemCollections.find((c) => c.name === \"_User\");\r\n    if (c && c.schema && c.schema.properties) {\r\n      const props = c.schema.properties;\r\n      const _ignoreKeys = [\"authData\", \"password\", \"username\", \"email\"];\r\n      for (const key in props) {\r\n        if (_ignoreKeys.indexOf(key) !== -1) continue;\r\n\r\n        const p = props[key];\r\n        if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n        if (p.type === \"Relation\") {\r\n        } else {\r\n          // Other schema type ports\r\n          const _typeMap: { [key: string]: string } = {\r\n            String: \"string\",\r\n            Boolean: \"boolean\",\r\n            Number: \"number\",\r\n            Date: \"date\",\r\n          };\r\n\r\n          ports.push({\r\n            type: {\r\n              name: _typeMap[p.type] ? _typeMap[p.type] : \"*\",\r\n            },\r\n            plug: \"output\",\r\n            group: \"Properties\",\r\n            name: \"prop-\" + key,\r\n            displayName: key,\r\n          });\r\n\r\n          ports.push({\r\n            type: \"signal\",\r\n            plug: \"output\",\r\n            group: \"Changed Events\",\r\n            displayName: key + \" Changed\",\r\n            name: \"changed-\" + key,\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // @ts-expect-error\r\n  if (typeof _noodl_cloud_runtime_version === \"undefined\") {\r\n    // On the client we have some extra outputs\r\n    ports.push({\r\n      plug: \"output\",\r\n      name: \"loggedIn\",\r\n      type: \"signal\",\r\n      displayName: \"Logged In\",\r\n      group: \"Events\",\r\n    });\r\n\r\n    ports.push({\r\n      plug: \"output\",\r\n      name: \"loggedOut\",\r\n      type: \"signal\",\r\n      displayName: \"Logged Out\",\r\n      group: \"Events\",\r\n    });\r\n\r\n    ports.push({\r\n      plug: \"output\",\r\n      name: \"sessionLost\",\r\n      type: \"signal\",\r\n      displayName: \"Session Lost\",\r\n      group: \"Events\",\r\n    });\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    updatePorts(\r\n      node.id,\r\n      node.parameters,\r\n      context.editorConnection,\r\n      graphModel.getMetaData(\"systemCollections\")\r\n    );\r\n\r\n    node.on(\"parameterUpdated\", function (event: any) {\r\n      updatePorts(\r\n        node.id,\r\n        node.parameters,\r\n        context.editorConnection,\r\n        graphModel.getMetaData(\"systemCollections\")\r\n      );\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.systemCollections\", function (data: any) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.net.noodl.user.User\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"net.noodl.user.User\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import { NodeContext } from \"./nodecontext\";\r\nimport { EditorConnection, Platform } from \"./editorconnection\";\r\nimport { generateNodeLibrary } from \"./nodelibraryexport\";\r\nimport { Module, generateProjectSettings } from \"./projectsettings\";\r\nimport { GraphModel } from \"./models/graphmodel\";\r\nimport { Node } from \"./node\";\r\nimport { handleEvent } from \"./editormodeleventshandler\";\r\nimport { Services } from \"./services\";\r\nimport { createSetter } from \"./edgetriggeredinput\";\r\nimport { EventEmitter } from \"eventemitter3\";\r\nimport { asyncPool } from \"./async-pool\";\r\nimport { defineNode, NodeDefinition } from \"./nodedefinition\";\r\nimport { registerNodes } from \"./runtime.nodes\";\r\n\r\ninterface RuntimeArgs {\r\n  type?: string;\r\n  platform: Platform;\r\n  runDeployed?: boolean;\r\n  dontCreateRootComponent?: boolean;\r\n  componentFilter?: (component: any) => boolean;\r\n  editorConnection?: any;\r\n}\r\n\r\n/**\r\n * Defines a node which contains a node definition and a setup function.\r\n */\r\nexport type NodeModule<TInternal extends Record<string, any> = {}> = {\r\n  node: NodeDefinition<TInternal>;\r\n  setup?: (context: NodeContext, graphModel: GraphModel) => void;\r\n};\r\n\r\nexport default class NoodlRuntime {\r\n  static instance: NoodlRuntime;\r\n  static Services = Services;\r\n  static Node = Node;\r\n  static NodeDefinition = { defineNode };\r\n  static EdgeTriggeredInput = createSetter;\r\n\r\n  private type: string;\r\n  private noodlModules: Module[];\r\n  eventEmitter: EventEmitter;\r\n  private updateScheduled: boolean;\r\n  rootComponent: any;\r\n  private _currentLoadedData: any;\r\n  private isWaitingForExport: boolean;\r\n  graphModel: GraphModel;\r\n  private errorHandlers: ((message: string) => void)[];\r\n  private frameNumber: number;\r\n  private dontCreateRootComponent: boolean;\r\n  private componentFilter?: (component: any) => boolean;\r\n  private runningInEditor: boolean;\r\n  private platform: Platform;\r\n  editorConnection: EditorConnection;\r\n  context: NodeContext;\r\n  private projectSettings?: any;\r\n  private lastSentNodeLibrary?: string;\r\n  private _disableLoad?: boolean;\r\n\r\n  constructor(args: RuntimeArgs) {\r\n    args.platform = args.platform || {};\r\n    NoodlRuntime.instance = this;\r\n\r\n    this.type = args.type || \"browser\";\r\n    this.noodlModules = [];\r\n    this.eventEmitter = new EventEmitter();\r\n    this.updateScheduled = false;\r\n    this.rootComponent = null;\r\n    this._currentLoadedData = null;\r\n    this.isWaitingForExport = true;\r\n    this.graphModel = new GraphModel();\r\n    this.errorHandlers = [];\r\n    this.frameNumber = 0;\r\n    this.dontCreateRootComponent = !!args.dontCreateRootComponent;\r\n    this.componentFilter = args.componentFilter;\r\n\r\n    this.runningInEditor = args.runDeployed ? false : true;\r\n\r\n    this.platform = {\r\n      requestUpdate: args.platform.requestUpdate,\r\n      getCurrentTime: args.platform.getCurrentTime,\r\n      webSocketOptions: args.platform.webSocketOptions,\r\n      objectToString: args.platform.objectToString,\r\n    };\r\n\r\n    if (!args.platform.requestUpdate) {\r\n      throw new Error(\"platform.requestUpdate must be set\");\r\n    }\r\n\r\n    if (!args.platform.getCurrentTime) {\r\n      throw new Error(\"platform.getCurrentTime must be set\");\r\n    }\r\n\r\n    this.editorConnection = new EditorConnection({\r\n      platform: args.platform,\r\n      runtimeType: this.type,\r\n    });\r\n\r\n    this.context = new NodeContext({\r\n      runningInEditor: args.runDeployed ? false : true,\r\n      editorConnection: this.editorConnection,\r\n      platform: this.platform,\r\n      graphModel: this.graphModel,\r\n    });\r\n\r\n    this.context.eventEmitter.on(\r\n      \"scheduleUpdate\",\r\n      this.scheduleUpdate.bind(this)\r\n    );\r\n\r\n    if (!args.runDeployed) {\r\n      this._setupEditorCommunication(args);\r\n    }\r\n\r\n    this.registerGraphModelListeners();\r\n\r\n    registerNodes(this);\r\n  }\r\n\r\n  async prefetchBundles(\r\n    bundleNames: string[],\r\n    numParallelFetches: number\r\n  ): Promise<void> {\r\n    await asyncPool(numParallelFetches, bundleNames, async (name) => {\r\n      await this.context.fetchComponentBundle(name);\r\n    });\r\n  }\r\n\r\n  private _setupEditorCommunication(args: RuntimeArgs): void {\r\n    function objectEquals(x: any, y: any): boolean {\r\n      if (x === null || x === undefined || y === null || y === undefined) {\r\n        return x === y;\r\n      }\r\n      if (x === y) {\r\n        return true;\r\n      }\r\n      if (Array.isArray(x) && x.length !== y.length) {\r\n        return false;\r\n      }\r\n\r\n      if (!(x instanceof Object)) {\r\n        return false;\r\n      }\r\n      if (!(y instanceof Object)) {\r\n        return false;\r\n      }\r\n\r\n      const p = Object.keys(x);\r\n      return (\r\n        Object.keys(y).every((i) => p.indexOf(i) !== -1) &&\r\n        p.every((i) => objectEquals(x[i], y[i]))\r\n      );\r\n    }\r\n\r\n    this.editorConnection.on(\"exportDataFull\", async (exportData: any) => {\r\n      if (this.graphModel.isEmpty() === false) {\r\n        this.reload();\r\n        return;\r\n      }\r\n\r\n      this.isWaitingForExport = false;\r\n      if (objectEquals(this._currentLoadedData, exportData) === false) {\r\n        if (this.componentFilter) {\r\n          exportData.components = exportData.components.filter((c: any) =>\r\n            this.componentFilter!(c)\r\n          );\r\n        }\r\n\r\n        await this.setData(exportData);\r\n\r\n        if (exportData.componentIndex) {\r\n          const allBundles = Object.keys(exportData.componentIndex);\r\n          await this.prefetchBundles(allBundles, 2);\r\n        }\r\n\r\n        this.graphModel.emit(\"editorImportComplete\");\r\n      }\r\n    });\r\n\r\n    this.editorConnection.on(\"reload\", this.reload.bind(this));\r\n    this.editorConnection.on(\r\n      \"modelUpdate\",\r\n      this.onModelUpdateReceived.bind(this)\r\n    );\r\n    this.editorConnection.on(\r\n      \"metadataUpdate\",\r\n      this.onMetaDataUpdateReceived.bind(this)\r\n    );\r\n\r\n    this.editorConnection.on(\"connected\", () => {\r\n      this.sendNodeLibrary();\r\n    });\r\n  }\r\n\r\n  setDebugInspectorsEnabled(enabled: boolean): void {\r\n    this.context.setDebugInspectorsEnabled(enabled);\r\n  }\r\n\r\n  registerModule(module: Module): void {\r\n    if (module.nodes) {\r\n      for (let nodeDefinition of module.nodes) {\r\n        if (!nodeDefinition.node) nodeDefinition = { node: nodeDefinition };\r\n        nodeDefinition.node.module = module.name || \"Unknown Module\";\r\n        this.registerNode(nodeDefinition);\r\n      }\r\n    }\r\n\r\n    this.noodlModules.push(module);\r\n  }\r\n\r\n  private registerGraphModelListeners(): void {\r\n    this.graphModel.on(\r\n      \"componentAdded\",\r\n      (component: any) => {\r\n        this.context.registerComponentModel(component);\r\n      },\r\n      this\r\n    );\r\n\r\n    this.graphModel.on(\r\n      \"componentRemoved\",\r\n      (component: any) => {\r\n        this.context.deregisterComponentModel(component);\r\n      },\r\n      this\r\n    );\r\n  }\r\n\r\n  reload(): void {\r\n    location.reload();\r\n  }\r\n\r\n  registerNode(nodeDefinition: NodeModule): void {\r\n    if (nodeDefinition.node) {\r\n      const definedNode = defineNode(nodeDefinition.node);\r\n      this.context.nodeRegister.register(definedNode);\r\n\r\n      definedNode.setupNumberedInputDynamicPorts &&\r\n        definedNode.setupNumberedInputDynamicPorts(\r\n          this.context,\r\n          this.graphModel\r\n        );\r\n    } else {\r\n      // TODO: Should this just be nodeDefinition?\r\n      this.context.nodeRegister.register(nodeDefinition.node);\r\n    }\r\n\r\n    nodeDefinition.setup && nodeDefinition.setup(this.context, this.graphModel);\r\n  }\r\n\r\n  private async _setRootComponent(\r\n    rootComponentName: string | null\r\n  ): Promise<void> {\r\n    if (this.rootComponent && this.rootComponent.name === rootComponentName)\r\n      return;\r\n\r\n    if (this.rootComponent) {\r\n      this.rootComponent.model &&\r\n        this.rootComponent.model.removeListenersWithRef(this);\r\n      this.rootComponent = undefined;\r\n    }\r\n\r\n    if (rootComponentName) {\r\n      this.rootComponent = await this.context.createComponentInstanceNode(\r\n        rootComponentName,\r\n        \"rootComponent\",\r\n        null\r\n      );\r\n\r\n      this.rootComponent.componentModel.on(\r\n        \"rootAdded\",\r\n        () => this.eventEmitter.emit(\"rootComponentUpdated\"),\r\n        this\r\n      );\r\n      this.rootComponent.componentModel.on(\r\n        \"rootRemoved\",\r\n        () => this.eventEmitter.emit(\"rootComponentUpdated\"),\r\n        this\r\n      );\r\n\r\n      this.context.setRootComponent(this.rootComponent);\r\n    }\r\n\r\n    this.eventEmitter.emit(\"rootComponentUpdated\");\r\n  }\r\n\r\n  async setData(graphData: any): Promise<void> {\r\n    if (this._disableLoad) return;\r\n\r\n    this._currentLoadedData = graphData;\r\n    await this.graphModel.importEditorData(graphData);\r\n\r\n    for (const module of this.noodlModules) {\r\n      typeof module.setup === \"function\" && module.setup();\r\n    }\r\n\r\n    if (this.dontCreateRootComponent !== true) {\r\n      await this._setRootComponent(this.graphModel.rootComponent || null);\r\n\r\n      this.graphModel.on(\"rootComponentNameUpdated\", (name: string) => {\r\n        this._setRootComponent(name);\r\n      });\r\n\r\n      this.graphModel.on(\"componentRemoved\", (componentModel: any) => {\r\n        if (\r\n          this.rootComponent &&\r\n          this.rootComponent.name === componentModel.name\r\n        ) {\r\n          this._setRootComponent(null);\r\n        }\r\n      });\r\n\r\n      this.graphModel.on(\"componentAdded\", (componentModel: any) => {\r\n        setTimeout(() => {\r\n          if (\r\n            !this.rootComponent &&\r\n            this.graphModel.rootComponent === componentModel.name\r\n          ) {\r\n            this._setRootComponent(componentModel.name);\r\n          }\r\n        }, 1);\r\n      });\r\n    }\r\n\r\n    this.scheduleUpdate();\r\n  }\r\n\r\n  scheduleUpdate(): void {\r\n    if (this.updateScheduled) {\r\n      return;\r\n    }\r\n\r\n    this.updateScheduled = true;\r\n    this.platform.requestUpdate?.(this._doUpdate.bind(this));\r\n  }\r\n\r\n  private _doUpdate(): void {\r\n    this.updateScheduled = false;\r\n\r\n    this.context.currentFrameTime = this.platform.getCurrentTime();\r\n\r\n    this.context.eventEmitter.emit(\"frameStart\");\r\n\r\n    this.context.update();\r\n\r\n    this.context.eventEmitter.emit(\"frameEnd\");\r\n\r\n    this.frameNumber++;\r\n  }\r\n\r\n  setProjectSettings(settings: any): void {\r\n    this.projectSettings = settings;\r\n  }\r\n\r\n  getNodeLibrary(): string {\r\n    const projectSettings = generateProjectSettings(\r\n      this.graphModel.getSettings(),\r\n      this.noodlModules\r\n    );\r\n\r\n    if (this.projectSettings) {\r\n      this.projectSettings.ports &&\r\n        (projectSettings.ports = projectSettings.ports.concat(\r\n          this.projectSettings.ports\r\n        ));\r\n      this.projectSettings.dynamicports &&\r\n        (projectSettings.dynamicports = projectSettings.ports.concat(\r\n          this.projectSettings.dynamicports\r\n        ));\r\n    }\r\n\r\n    const nodeLibrary = generateNodeLibrary(this.context.nodeRegister);\r\n    nodeLibrary.projectsettings = projectSettings;\r\n    return JSON.stringify(nodeLibrary, null, 3);\r\n  }\r\n\r\n  sendNodeLibrary(): void {\r\n    const nodeLibrary = this.getNodeLibrary();\r\n    if (this.lastSentNodeLibrary !== nodeLibrary) {\r\n      this.lastSentNodeLibrary = nodeLibrary;\r\n      this.editorConnection.sendNodeLibrary(nodeLibrary);\r\n    }\r\n  }\r\n\r\n  connectToEditor(address: string): void {\r\n    this.editorConnection.connect(address);\r\n  }\r\n\r\n  onMetaDataUpdateReceived(event: any): void {\r\n    if (!this.graphModel.isEmpty()) {\r\n      handleEvent(this.context, this.graphModel, event);\r\n    }\r\n  }\r\n\r\n  async onModelUpdateReceived(event: any): Promise<void> {\r\n    if (this.isWaitingForExport) {\r\n      return;\r\n    }\r\n\r\n    if (event.type === \"projectInstanceChanged\") {\r\n      this.reload();\r\n    } else if (this.graphModel.isEmpty() === false) {\r\n      await handleEvent(this.context, this.graphModel, event);\r\n    }\r\n  }\r\n\r\n  addErrorHandler(callback: (message: string) => void): void {\r\n    this.errorHandlers.push(callback);\r\n  }\r\n\r\n  reportError(message: string): void {\r\n    this.errorHandlers.forEach((eh) => {\r\n      eh(message);\r\n    });\r\n  }\r\n\r\n  getProjectSettings(): any {\r\n    return this.graphModel.getSettings();\r\n  }\r\n\r\n  getMetaData(key: string): any {\r\n    return this.graphModel.getMetaData(key);\r\n  }\r\n}\r\n","import type NoodlRuntime from \"./runtime\";\r\n\r\nimport * as componentinputs from \"./nodes/componentinputs\";\r\nimport * as componentoutputs from \"./nodes/componentoutputs\";\r\n\r\nimport * as runtasks from \"./nodes/std-library/runtasks\";\r\n\r\n// Data\r\nimport * as restnode from \"./nodes/std-library/data/restnode\";\r\n\r\n// Custom code\r\nimport * as expression from \"./nodes/std-library/expression\";\r\nimport * as simplejavascript from \"./nodes/std-library/simplejavascript\";\r\n\r\n// Records\r\nimport * as dbcollectionnode2 from \"./nodes/std-library/data/dbcollectionnode2\";\r\nimport * as dbmodelnode2 from \"./nodes/std-library/data/dbmodelnode2\";\r\nimport * as setdbmodelpropertiesnode from \"./nodes/std-library/data/setdbmodelpropertiesnode\";\r\nimport * as deletedbmodelpropertiesnode from \"./nodes/std-library/data/deletedbmodelpropertiesnode\";\r\nimport * as newdbmodelpropertiesnode from \"./nodes/std-library/data/newdbmodelpropertiesnode\";\r\nimport * as dbmodelnodeAddrelation from \"./nodes/std-library/data/dbmodelnode-addrelation\";\r\nimport * as dbmodelnodeRemoverelation from \"./nodes/std-library/data/dbmodelnode-removerelation\";\r\nimport * as filterdbmodelsnode from \"./nodes/std-library/data/filterdbmodelsnode\";\r\n\r\n// Object\r\nimport * as modelnode2 from \"./nodes/std-library/data/modelnode2\";\r\nimport * as setmodelpropertiesnode from \"./nodes/std-library/data/setmodelpropertiesnode\";\r\nimport * as newmodelnode from \"./nodes/std-library/data/newmodelnode\";\r\n\r\n// Cloud\r\nimport * as cloudfilenode from \"./nodes/std-library/data/cloudfilenode\";\r\nimport * as dbconfig from \"./nodes/std-library/data/dbconfig\";\r\n\r\n// Variables\r\nimport * as number from \"./nodes/std-library/variables/number\";\r\nimport * as string from \"./nodes/std-library/variables/string\";\r\nimport * as boolean from \"./nodes/std-library/variables/boolean\";\r\n\r\n// Utils\r\nimport * as condition from \"./nodes/std-library/condition\";\r\nimport * as and from \"./nodes/std-library/and\";\r\nimport * as or from \"./nodes/std-library/or\";\r\nimport * as booleantostring from \"./nodes/std-library/booleantostring\";\r\nimport * as datetostring from \"./nodes/std-library/datetostring\";\r\nimport * as stringmapper from \"./nodes/std-library/stringmapper\";\r\nimport * as inverter from \"./nodes/std-library/inverter\";\r\nimport * as substring from \"./nodes/std-library/substring\";\r\nimport * as stringformat from \"./nodes/std-library/stringformat\";\r\nimport * as counter from \"./nodes/std-library/counter\";\r\nimport * as uniqueid from \"./nodes/std-library/uniqueid\";\r\n\r\n// User\r\nimport * as setuserproperties from \"./nodes/std-library/user/setuserproperties\";\r\nimport * as user from \"./nodes/std-library/user/user\";\r\n\r\nexport function registerNodes(noodlRuntime: NoodlRuntime): void {\r\n  [\r\n    componentinputs,\r\n    componentoutputs,\r\n\r\n    runtasks,\r\n\r\n    // Data\r\n    restnode,\r\n\r\n    // Custom code\r\n    expression,\r\n    simplejavascript,\r\n\r\n    // Records\r\n    dbcollectionnode2,\r\n    dbmodelnode2,\r\n    setdbmodelpropertiesnode,\r\n    deletedbmodelpropertiesnode,\r\n    newdbmodelpropertiesnode,\r\n    dbmodelnodeAddrelation,\r\n    dbmodelnodeRemoverelation,\r\n    filterdbmodelsnode,\r\n\r\n    // Object\r\n    modelnode2,\r\n    setmodelpropertiesnode,\r\n    newmodelnode,\r\n\r\n    // Cloud\r\n    cloudfilenode,\r\n    dbconfig,\r\n\r\n    // Variables\r\n    number,\r\n    string,\r\n    boolean,\r\n\r\n    // Utils\r\n    condition,\r\n    and,\r\n    or,\r\n    booleantostring,\r\n    datetostring,\r\n    stringmapper,\r\n    inverter,\r\n    substring,\r\n    stringformat,\r\n    counter,\r\n    uniqueid,\r\n\r\n    // User\r\n    setuserproperties,\r\n    user,\r\n\r\n    // @ts-expect-error\r\n  ].forEach((node) => noodlRuntime.registerNode(node));\r\n}\r\n","/**\r\n * Executes async functions with a concurrency limit\r\n * @param poolLimit Maximum number of concurrent executions\r\n * @param values Array of input values to process\r\n * @param iteratorFn Function to execute for each value\r\n * @returns Promise that resolves with array of results\r\n */\r\nexport async function asyncPool<T, R>(\r\n  poolLimit: number,\r\n  values: T[],\r\n  iteratorFn: (item: T, array: T[]) => Promise<R>\r\n): Promise<R[]> {\r\n  const ret: Promise<R>[] = [];\r\n  const executing: Promise<void>[] = [];\r\n\r\n  for (const item of values) {\r\n    const p = Promise.resolve().then(() => iteratorFn(item, values));\r\n    ret.push(p);\r\n\r\n    if (poolLimit <= values.length) {\r\n      const e = p.then((): void => {\r\n        executing.splice(executing.indexOf(e), 1);\r\n      });\r\n      executing.push(e);\r\n      if (executing.length >= poolLimit) {\r\n        await Promise.race(executing);\r\n      }\r\n    }\r\n  }\r\n\r\n  return Promise.all(ret);\r\n}\r\n","interface Port {\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface Module {\r\n  settings?: Port[];\r\n  name?: string;\r\n  nodes?: any[];\r\n  setup?: () => void;\r\n}\r\n\r\ninterface ProjectSettings {\r\n  [key: string]: any;\r\n}\r\n\r\ninterface ProjectSettingsResult {\r\n  dynamicports: any[];\r\n  ports: Port[];\r\n}\r\n\r\nfunction addModuleSettings(\r\n  result: ProjectSettingsResult,\r\n  modules: Module[]\r\n): void {\r\n  // Add module settings\r\n  for (let i = 0; i < modules.length; i++) {\r\n    const m = modules[i];\r\n    if (m.settings) {\r\n      m.settings.forEach((p: Port) => {\r\n        result.ports.push(p);\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport function generateProjectSettings(\r\n  // TODO: What is this?\r\n  projectSettings: ProjectSettings,\r\n  modules: Module[]\r\n): ProjectSettingsResult {\r\n  const result: ProjectSettingsResult = {\r\n    dynamicports: [],\r\n    ports: [],\r\n  };\r\n\r\n  addModuleSettings(result, modules);\r\n\r\n  return result;\r\n}\r\n","declare global {\r\n  interface Window {\r\n    Noodl: {\r\n      baseUrl?: string;\r\n    };\r\n  }\r\n}\r\n\r\n//this just assumes the base url is '/' always\r\nexport function getAbsoluteUrl(_url: unknown): string {\r\n  if (_url === null || _url === undefined || _url === \"\") {\r\n    return window.Noodl.baseUrl || \"/\";\r\n  }\r\n\r\n  //convert to string in case the _url is a Cloud File (which is an object with a custom toString())\r\n  const url = String(_url);\r\n\r\n  //only add a the base url if this is a local URL (e.g. not a https url or  base64 string)\r\n  if (\r\n    !url ||\r\n    url[0] === \"/\" ||\r\n    url.includes(\"://\") ||\r\n    url.startsWith(\"data:\")\r\n  ) {\r\n    return url;\r\n  }\r\n\r\n  return (window.Noodl.baseUrl || \"/\") + url;\r\n}\r\n\r\n/**\r\n * Log an error thrown by the JavaScript nodes.\r\n */\r\nexport function logJavaScriptNodeError(error: unknown): void {\r\n  if (typeof error === \"string\") {\r\n    console.log(\"Error in JS node run code.\", error);\r\n  } else if (error instanceof Error) {\r\n    console.log(\r\n      \"Error in JS node run code.\",\r\n      Object.getPrototypeOf(error).constructor.name + \": \" + error.message,\r\n      error.stack\r\n    );\r\n  }\r\n}\r\n\r\n//adapted from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\r\nexport function guid(): string {\r\n  function s4(): string {\r\n    return Math.floor((1 + Math.random()) * 0x10000)\r\n      .toString(16)\r\n      .substring(1);\r\n  }\r\n  return (\r\n    s4() +\r\n    s4() +\r\n    \"-\" +\r\n    s4() +\r\n    \"-\" +\r\n    s4() +\r\n    \"-\" +\r\n    s4() +\r\n    \"-\" +\r\n    s4() +\r\n    s4() +\r\n    s4()\r\n  );\r\n}\r\n\r\nexport function randomString(size: number): string {\r\n  if (size === 0) {\r\n    throw new Error(\"Zero-length randomString is useless.\");\r\n  }\r\n  const chars =\r\n    \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\" + \"abcdefghijklmnopqrstuvwxyz\" + \"0123456789\";\r\n  let objectId = \"\";\r\n  for (let i = 0; i < size; ++i) {\r\n    objectId += chars[Math.floor((1 + Math.random()) * 0x10000) % chars.length];\r\n  }\r\n  return objectId;\r\n}\r\n","interface EaseCurves {\r\n  easeOutQuartic(start: number, end: number, t: number): number;\r\n  easeInQuartic(start: number, end: number, t: number): number;\r\n  easeInOutQuartic(start: number, end: number, t: number): number;\r\n  easeOutCubic(start: number, end: number, t: number): number;\r\n  easeInCubic(start: number, end: number, t: number): number;\r\n  easeInOutCubic(start: number, end: number, t: number): number;\r\n  easeOutQuadratic(start: number, end: number, t: number): number;\r\n  easeInQuadratic(start: number, end: number, t: number): number;\r\n  easeInOutQuadratic(start: number, end: number, t: number): number;\r\n  linear(start: number, end: number, t: number): number;\r\n\r\n  easeIn: (start: number, end: number, t: number) => number;\r\n  easeOut: (start: number, end: number, t: number) => number;\r\n  easeInOut: (start: number, end: number, t: number) => number;\r\n}\r\n\r\nconst easeCurves: EaseCurves = {\r\n  easeOutQuartic: function (start, end, t) {\r\n    t--;\r\n    return -(end - start) * (t * t * t * t - 1.0) + start;\r\n  },\r\n  easeInQuartic: function (start, end, t) {\r\n    return (end - start) * (t * t * t * t) + start;\r\n  },\r\n  easeInOutQuartic: function (start, end, t) {\r\n    t *= 2.0;\r\n    if (t < 1.0) {\r\n      return ((end - start) / 2.0) * t * t * t * t + start;\r\n    }\r\n    t -= 2.0;\r\n    return (-(end - start) / 2.0) * (t * t * t * t - 2.0) + start;\r\n  },\r\n  easeOutCubic: function (start, end, t) {\r\n    t--;\r\n    return (end - start) * (t * t * t + 1.0) + start;\r\n  },\r\n  easeInCubic: function (start, end, t) {\r\n    return (end - start) * (t * t * t) + start;\r\n  },\r\n  easeInOutCubic: function (start, end, t) {\r\n    t *= 2.0;\r\n    if (t < 1.0) {\r\n      return ((end - start) / 2.0) * t * t * t + start;\r\n    }\r\n    t -= 2.0;\r\n    return ((end - start) / 2.0) * (t * t * t + 2.0) + start;\r\n  },\r\n  easeOutQuadratic: function (start, end, t) {\r\n    return -(end - start) * t * (t - 2.0) + start;\r\n  },\r\n  easeInQuadratic: function (start, end, t) {\r\n    return (end - start) * (t * t) + start;\r\n  },\r\n  easeInOutQuadratic: function (start, end, t) {\r\n    t *= 2.0;\r\n    if (t < 1.0) {\r\n      return ((end - start) / 2.0) * t * t + start;\r\n    }\r\n    t -= 1.0;\r\n    return (-(end - start) / 2.0) * (t * (t - 2) - 1.0) + start;\r\n  },\r\n  linear: function (start, end, t) {\r\n    return start + (end - start) * t;\r\n  },\r\n  easeIn: () => 0,\r\n  easeOut: () => 0,\r\n  easeInOut: () => 0,\r\n};\r\n\r\n//default interpolation curves\r\neaseCurves.easeIn = easeCurves.easeInCubic;\r\neaseCurves.easeOut = easeCurves.easeOutCubic;\r\neaseCurves.easeInOut = easeCurves.easeInOutCubic;\r\n\r\nexport default easeCurves;\r\n","import { createSetter } from \"@fluxscape/runtime/src/edgetriggeredinput\";\r\nimport { GraphModel } from \"@fluxscape/runtime\";\r\nimport { NodeContext } from \"@fluxscape/runtime/src/nodecontext\";\r\nimport { NodeDefinition } from \"@fluxscape/runtime/src/nodedefinition\";\r\n\r\ninterface ClosePopupNodeInternal {\r\n  resultValues: Record<string, any>;\r\n  results?: string[];\r\n  closeActions?: string[];\r\n  closeCallback?: (action: string, resultValues: Record<string, any>) => void;\r\n  closeAction?: string;\r\n  hasScheduledClose?: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<ClosePopupNodeInternal> = {\r\n  name: \"NavigationClosePopup\",\r\n  displayNodeName: \"Close Popup\",\r\n  category: \"Navigation\",\r\n  docs: \"https://docs.noodl.net/nodes/popups/close-popup\",\r\n  _internal: {\r\n    resultValues: {},\r\n  },\r\n  inputs: {\r\n    results: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      group: \"Results\",\r\n      set(value: string[]) {\r\n        this._internal.results = value;\r\n      },\r\n    },\r\n    closeActions: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      group: \"Close Actions\",\r\n      set(value: string[]) {\r\n        this._internal.closeActions = value;\r\n      },\r\n    },\r\n    close: {\r\n      type: \"Signal\",\r\n      displayName: \"Close\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleClose();\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    setResultValue(key: string, value: any) {\r\n      this._internal.resultValues[key] = value;\r\n    },\r\n    _setCloseCallback(\r\n      cb: (action: string, resultValues: Record<string, any>) => void\r\n    ) {\r\n      this._internal.closeCallback = cb;\r\n    },\r\n    scheduleClose() {\r\n      const _this = this;\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledClose) {\r\n        internal.hasScheduledClose = true;\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          internal.hasScheduledClose = false;\r\n          // @ts-expect-error\r\n          _this.close();\r\n        });\r\n      }\r\n    },\r\n    close() {\r\n      if (this._internal.closeCallback) {\r\n        this._internal.closeCallback(\r\n          this._internal.closeAction || \"\",\r\n          this._internal.resultValues\r\n        );\r\n      }\r\n    },\r\n    closeActionTriggered(name: string) {\r\n      this._internal.closeAction = name;\r\n      // @ts-expect-error\r\n      this.scheduleClose();\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"result-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setResultValue.bind(this, name.substring(\"result-\".length)),\r\n        });\r\n\r\n      if (name.startsWith(\"closeAction-\"))\r\n        return this.registerInput(name, {\r\n          set: createSetter({\r\n            // @ts-expect-error\r\n            valueChangedToTrue: this.closeActionTriggered.bind(this, name),\r\n          }),\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    function _updatePorts() {\r\n      const ports: any[] = [];\r\n\r\n      // Add results inputs\r\n      const results = node.parameters[\"results\"];\r\n      if (results) {\r\n        const resultsArray = results ? results.split(\",\") : undefined;\r\n        for (const p of resultsArray) {\r\n          ports.push({\r\n            type: {\r\n              name: \"*\",\r\n            },\r\n            plug: \"input\",\r\n            group: \"Results\",\r\n            name: \"result-\" + p,\r\n            displayName: p,\r\n          });\r\n        }\r\n      }\r\n\r\n      // Add close actions\r\n      const closeActions = node.parameters[\"closeActions\"];\r\n      if (closeActions) {\r\n        const closeActionsArray = closeActions\r\n          ? closeActions.split(\",\")\r\n          : undefined;\r\n        for (const p of closeActionsArray) {\r\n          ports.push({\r\n            type: \"signal\",\r\n            plug: \"input\",\r\n            group: \"Close Actions\",\r\n            name: \"closeAction-\" + p,\r\n            displayName: p,\r\n          });\r\n        }\r\n      }\r\n\r\n      context.editorConnection?.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    _updatePorts();\r\n    node.on(\"parameterUpdated\", function (event: any) {\r\n      if (event.name === \"results\" || event.name === \"closeActions\") {\r\n        _updatePorts();\r\n      }\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.NavigationClosePopup\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"NavigationClosePopup\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import { GraphModel } from \"@fluxscape/runtime\";\r\nimport { NodeContext } from \"@fluxscape/runtime/src/nodecontext\";\r\nimport { NodeDefinition } from \"@fluxscape/runtime/src/nodedefinition\";\r\n\r\ninterface Internal {\r\n  resultValues: Record<string, any>;\r\n  results?: string[];\r\n  backActions?: string[];\r\n  backCallback?: (args: any) => void;\r\n  backAction?: string;\r\n  hasScheduledNavigate?: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"PageStackNavigateBack\",\r\n  displayNodeName: \"Pop Component Stack\",\r\n  category: \"Navigation\",\r\n  docs: \"https://docs.noodl.net/nodes/component-stack/pop-component\",\r\n  inputs: {\r\n    navigate: {\r\n      displayName: \"Navigate\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleNavigate();\r\n      },\r\n    },\r\n    results: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      group: \"Results\",\r\n      set(value) {\r\n        this._internal.results = value;\r\n      },\r\n    },\r\n    backActions: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      group: \"Back Actions\",\r\n      set(value) {\r\n        this._internal.backActions = value;\r\n      },\r\n    },\r\n  },\r\n  initialize() {\r\n    this._internal.resultValues = {};\r\n  },\r\n  methods: {\r\n    scheduleNavigate() {\r\n      var _this = this;\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledNavigate) {\r\n        internal.hasScheduledNavigate = true;\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          internal.hasScheduledNavigate = false;\r\n          // @ts-expect-error\r\n          _this.navigate();\r\n        });\r\n      }\r\n    },\r\n    _setBackCallback(cb) {\r\n      this._internal.backCallback = cb;\r\n    },\r\n    navigate() {\r\n      if (this._internal.backCallback === undefined) return;\r\n\r\n      this._internal.backCallback({\r\n        backAction: this._internal.backAction,\r\n        results: this._internal.resultValues,\r\n      });\r\n    },\r\n    setResultValue(key: string, value: any) {\r\n      this._internal.resultValues[key] = value;\r\n    },\r\n    backActionTriggered(name: string) {\r\n      this._internal.backAction = name;\r\n      // @ts-expect-error\r\n      this.scheduleNavigate();\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"result-\")) {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setResultValue.bind(this, name.substring(\"result-\".length)),\r\n        });\r\n      }\r\n\r\n      if (name.startsWith(\"backAction-\")) {\r\n        return this.registerInput(name, {\r\n          set: (value) => {\r\n            // @ts-expect-error\r\n            value && this.backActionTriggered(name);\r\n          },\r\n        });\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    function _updatePorts() {\r\n      var ports: any[] = [];\r\n\r\n      // Add results inputs\r\n      var results = node.parameters.results;\r\n      if (results) {\r\n        results = results ? results.split(\",\") : undefined;\r\n        for (var i in results) {\r\n          var p = results[i];\r\n\r\n          ports.push({\r\n            type: {\r\n              name: \"*\",\r\n            },\r\n            plug: \"input\",\r\n            group: \"Results\",\r\n            name: \"result-\" + p,\r\n            displayName: p,\r\n          });\r\n        }\r\n      }\r\n\r\n      // Add back actions\r\n      var backActions = node.parameters.backActions;\r\n      if (backActions) {\r\n        backActions = backActions ? backActions.split(\",\") : undefined;\r\n        for (var i in backActions) {\r\n          var p = backActions[i];\r\n\r\n          ports.push({\r\n            type: \"signal\",\r\n            plug: \"input\",\r\n            group: \"Back Actions\",\r\n            name: \"backAction-\" + p,\r\n            displayName: p,\r\n          });\r\n        }\r\n      }\r\n\r\n      context.editorConnection?.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    _updatePorts();\r\n    node.on(\"parameterUpdated\", function (event: any) {\r\n      if (event.name === \"results\" || event.name === \"backActions\") {\r\n        _updatePorts();\r\n      }\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.PageStackNavigateBack\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"PageStackNavigateBack\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import NoodlRuntime from \"@fluxscape/runtime\";\r\nimport { GraphModel } from \"@fluxscape/runtime\";\r\nimport { NodeContext } from \"@fluxscape/runtime/src/nodecontext\";\r\nimport { NodeDefinition } from \"@fluxscape/runtime/src/nodedefinition\";\r\n\r\ninterface Internal {\r\n  params: Record<string, any>;\r\n  query: Record<string, any>;\r\n  openInNewTab: boolean;\r\n  path?: string;\r\n  queryNames?: string;\r\n  hasScheduledNavigate?: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"PageStackNavigateToPath\",\r\n  displayNodeName: \"Navigate To Path\",\r\n  category: \"Navigation\",\r\n  docs: \"https://docs.noodl.net/nodes/navigation/navigate-to-path\",\r\n  initialize() {\r\n    const internal = this._internal;\r\n    internal.params = {};\r\n    internal.query = {};\r\n    internal.openInNewTab = false;\r\n  },\r\n  inputs: {\r\n    path: {\r\n      type: { name: \"string\" },\r\n      displayName: \"Path\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.path = value;\r\n      },\r\n    },\r\n    queryNames: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      displayName: \"Query\",\r\n      group: \"Query\",\r\n      set(value: string) {\r\n        this._internal.queryNames = value;\r\n      },\r\n    },\r\n    openInNewTab: {\r\n      index: 10,\r\n      displayName: \"Open in new tab\",\r\n      group: \"General\",\r\n      default: false,\r\n      type: \"boolean\",\r\n      set(value: boolean) {\r\n        this._internal.openInNewTab = !!value;\r\n      },\r\n    },\r\n    navigate: {\r\n      displayName: \"Navigate\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleNavigate();\r\n      },\r\n    },\r\n  },\r\n  outputs: {},\r\n  methods: {\r\n    scheduleNavigate() {\r\n      const internal = this._internal;\r\n\r\n      if (!internal.hasScheduledNavigate) {\r\n        internal.hasScheduledNavigate = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          internal.hasScheduledNavigate = false;\r\n          // @ts-expect-error\r\n          this.navigate();\r\n        });\r\n      }\r\n    },\r\n    navigate() {\r\n      const internal = this._internal;\r\n\r\n      let formattedPath = internal.path;\r\n      if (formattedPath === undefined) return;\r\n\r\n      const matches = internal.path?.match(/\\{[A-Za-z0-9_]*\\}/g);\r\n      let inputs: string[] = [];\r\n      if (matches) {\r\n        inputs = matches.map((name) => name.replace(\"{\", \"\").replace(\"}\", \"\"));\r\n      }\r\n\r\n      inputs.forEach((name) => {\r\n        const v = internal.params[name];\r\n        formattedPath = formattedPath!.replace(\r\n          \"{\" + name + \"}\",\r\n          v !== undefined ? v : \"\"\r\n        );\r\n      });\r\n\r\n      let urlPath: string | undefined, hashPath: string | undefined;\r\n      const navigationPathType =\r\n        NoodlRuntime.instance.getProjectSettings()[\"navigationPathType\"];\r\n      if (navigationPathType === undefined || navigationPathType === \"hash\")\r\n        hashPath = formattedPath;\r\n      else urlPath = formattedPath;\r\n\r\n      const query: string[] = [];\r\n      if (internal.queryNames !== undefined) {\r\n        internal.queryNames.split(\",\").forEach((q) => {\r\n          if (internal.query[q] !== undefined) {\r\n            query.push(q + \"=\" + internal.query[q]);\r\n          }\r\n        });\r\n      }\r\n\r\n      const compiledUrl =\r\n        (urlPath !== undefined ? urlPath : \"\") +\r\n        (query.length >= 1 ? \"?\" + query.join(\"&\") : \"\") +\r\n        (hashPath !== undefined ? \"#\" + hashPath : \"\");\r\n\r\n      if (this._internal.openInNewTab) {\r\n        window.open(compiledUrl, \"_blank\");\r\n      } else {\r\n        window.history.pushState({}, \"\", compiledUrl);\r\n        dispatchEvent(new PopStateEvent(\"popstate\", {}));\r\n      }\r\n    },\r\n    setParam(name: string, value: any) {\r\n      this._internal.params[name] = value;\r\n    },\r\n    setQuery(name: string, value: any) {\r\n      this._internal.query[name] = value;\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"p-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setParam.bind(this, name.substring(\"p-\".length)),\r\n        });\r\n\r\n      if (name.startsWith(\"q-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setQuery.bind(this, name.substring(\"q-\".length)),\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    function _updatePorts() {\r\n      const ports: any[] = [];\r\n\r\n      if (node.parameters[\"path\"] !== undefined) {\r\n        const inputs =\r\n          node.parameters[\"path\"].match(/\\{[A-Za-z0-9_]*\\}/g) || [];\r\n        const portsNames = inputs.map((def) =>\r\n          def.replace(\"{\", \"\").replace(\"}\", \"\")\r\n        );\r\n\r\n        const uniquePorts = portsNames\r\n          //get unique names\r\n          .filter((value, index, self) => self.indexOf(value) === index)\r\n          //and map names to ports\r\n          .map((name) => ({\r\n            name: \"p-\" + name,\r\n            displayName: name,\r\n            group: \"Parameter\",\r\n            type: \"*\",\r\n            plug: \"input\",\r\n          }));\r\n\r\n        ports.push(...uniquePorts);\r\n      }\r\n\r\n      if (node.parameters[\"queryNames\"] !== undefined) {\r\n        node.parameters[\"queryNames\"].split(\",\").forEach((q) => {\r\n          ports.push({\r\n            name: \"q-\" + q,\r\n            displayName: q,\r\n            group: \"Query\",\r\n            plug: \"input\",\r\n            type: \"*\",\r\n          });\r\n        });\r\n      }\r\n\r\n      context.editorConnection?.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    _updatePorts();\r\n    node.on(\"parameterUpdated\", function (event: any) {\r\n      _updatePorts();\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.PageStackNavigateToPath\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"PageStackNavigateToPath\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import { NodeDefinition } from \"@fluxscape/runtime/src/nodedefinition\";\r\nimport { GraphModel } from \"@fluxscape/runtime\";\r\nimport { NodeContext } from \"@fluxscape/runtime/src/nodecontext\";\r\nimport { Transitions } from \"./transitions\";\r\nimport NavigationHandler from \"./navigation-handler\";\r\n\r\ninterface Internal {\r\n  transitionParams: Record<string, any>;\r\n  pageParams: Record<string, any>;\r\n  backResults: Record<string, any>;\r\n  stack: string;\r\n  navigationMode: \"push\" | \"replace\" | undefined;\r\n  target: string;\r\n  transition: string;\r\n  hasScheduledNavigate?: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"PageStackNavigate\",\r\n  displayNodeName: \"Push Component To Stack\",\r\n  category: \"Navigation\",\r\n  docs: \"https://docs.noodl.net/nodes/component-stack/push-component\",\r\n  initialize() {\r\n    this._internal.transitionParams = {};\r\n    this._internal.pageParams = {};\r\n    this._internal.backResults = {};\r\n  },\r\n  inputs: {\r\n    stack: {\r\n      type: { name: \"string\", identifierOf: \"PackStack\" },\r\n      displayName: \"Stack\",\r\n      group: \"General\",\r\n      default: \"Main\",\r\n      set(value: string) {\r\n        this._internal.stack = value;\r\n      },\r\n    },\r\n    mode: {\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Push\", value: \"push\" },\r\n          { label: \"Replace\", value: \"replace\" },\r\n        ],\r\n      },\r\n      displayName: \"Mode\",\r\n      default: \"push\",\r\n      group: \"General\",\r\n      set(value: \"push\" | \"replace\") {\r\n        this._internal.navigationMode = value;\r\n      },\r\n    },\r\n    navigate: {\r\n      displayName: \"Navigate\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleNavigate();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    navigated: {\r\n      type: \"signal\",\r\n      displayName: \"Navigated\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n  methods: {\r\n    scheduleNavigate() {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledNavigate) {\r\n        internal.hasScheduledNavigate = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          internal.hasScheduledNavigate = false;\r\n          // @ts-expect-error\r\n          this.navigate();\r\n        });\r\n      }\r\n    },\r\n    navigate() {\r\n      if (\r\n        this._internal.navigationMode === \"push\" ||\r\n        this._internal.navigationMode === undefined\r\n      ) {\r\n        NavigationHandler.instance.navigate(this._internal.stack, {\r\n          target: this._internal.target,\r\n          transition: {\r\n            ...{ type: this._internal.transition },\r\n            ...this._internal.transitionParams,\r\n          },\r\n          params: this._internal.pageParams,\r\n          backCallback: (action, results) => {\r\n            this._internal.backResults = results;\r\n\r\n            for (const key in results) {\r\n              if (this.hasOutput(\"backResult-\" + key)) {\r\n                this.flagOutputDirty(\"backResult-\" + key);\r\n              }\r\n            }\r\n\r\n            if (action !== undefined) this.sendSignalOnOutput(action);\r\n          },\r\n          hasNavigated: () => {\r\n            this.sendSignalOnOutput(\"navigated\");\r\n          },\r\n        });\r\n      } else if (this._internal.navigationMode === \"replace\") {\r\n        NavigationHandler.instance.replace(this._internal.stack, {\r\n          target: this._internal.target,\r\n          params: this._internal.pageParams,\r\n          hasNavigated: () => {\r\n            this.scheduleAfterInputsHaveUpdated(() => {\r\n              this.sendSignalOnOutput(\"navigated\");\r\n            });\r\n          },\r\n        });\r\n      }\r\n    },\r\n    setTransitionParam(param: string, value: any) {\r\n      this._internal.transitionParams[param] = value;\r\n    },\r\n    setPageParam(param: string, value: any) {\r\n      this._internal.pageParams[param] = value;\r\n    },\r\n    getBackResult(param: string) {\r\n      return this._internal.backResults[param];\r\n    },\r\n    setTargetPageId(pageId: string) {\r\n      this._internal.target = pageId;\r\n    },\r\n    setTransition(value: string) {\r\n      this._internal.transition = value;\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"target\") {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setTargetPageId.bind(this),\r\n        });\r\n      } else if (name === \"transition\") {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setTransition.bind(this),\r\n        });\r\n      } else if (name.startsWith(\"tr-\")) {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setTransitionParam.bind(this, name.substring(\"tr-\".length)),\r\n        });\r\n      } else if (name.startsWith(\"pm-\")) {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setPageParam.bind(this, name.substring(\"pm-\".length)),\r\n        });\r\n      }\r\n    },\r\n    registerOutputIfNeeded(name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"backResult-\"))\r\n        return this.registerOutput(name, {\r\n          // @ts-expect-error\r\n          getter: this.getBackResult.bind(\r\n            this,\r\n            name.substring(\"backResult-\".length)\r\n          ),\r\n        });\r\n      else if (name.startsWith(\"backAction-\"))\r\n        return this.registerOutput(name, {\r\n          getter() {\r\n            /** No needed for signals */\r\n          },\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    function _updatePorts() {\r\n      const ports: any[] = [];\r\n\r\n      // Only push mode have transition\r\n      if (\r\n        node.parameters[\"mode\"] === \"push\" ||\r\n        node.parameters[\"mode\"] === undefined\r\n      ) {\r\n        ports.push({\r\n          name: \"transition\",\r\n          plug: \"input\",\r\n          type: { name: \"enum\", enums: Object.keys(Transitions) },\r\n          default: \"Push\",\r\n          displayName: \"Transition\",\r\n          group: \"Transition\",\r\n        });\r\n\r\n        const transition = node.parameters[\"transition\"] || \"Push\";\r\n        if (Transitions[transition])\r\n          ports.push(...Transitions[transition].ports(node.parameters));\r\n      }\r\n\r\n      const pageStacks = graphModel.getNodesWithType(\"Page Stack\");\r\n      const pageStack = pageStacks.find(\r\n        (ps) =>\r\n          (ps.parameters[\"name\"] || \"Main\") ===\r\n          (node.parameters[\"stack\"] || \"Main\")\r\n      );\r\n\r\n      if (pageStack !== undefined) {\r\n        const pages = pageStack.parameters[\"pages\"];\r\n        if (pages !== undefined && pages.length > 0) {\r\n          ports.push({\r\n            plug: \"input\",\r\n            type: {\r\n              name: \"enum\",\r\n              enums: pages.map((p: any) => ({\r\n                label: p.label,\r\n                value: p.id,\r\n              })),\r\n            },\r\n            group: \"General\",\r\n            displayName: \"Target Page\",\r\n            name: \"target\",\r\n            default: pages[0].id,\r\n          });\r\n\r\n          // See if there is a target page with component\r\n          const targetPageId = node.parameters[\"target\"] || pages[0].id;\r\n          const targetComponentName =\r\n            pageStack.parameters[\"pageComp-\" + targetPageId];\r\n          if (targetComponentName !== undefined) {\r\n            // @ts-expect-error\r\n            const component = graphModel.components[targetComponentName];\r\n\r\n            if (component !== undefined) {\r\n              // Make all inputs of the component to inputs of this navigation node\r\n              for (const inputName in component.inputPorts) {\r\n                ports.push({\r\n                  name: \"pm-\" + inputName,\r\n                  displayName: inputName,\r\n                  type: \"*\",\r\n                  plug: \"input\",\r\n                  group: \"Parameters\",\r\n                });\r\n              }\r\n\r\n              // Find all navigate back nodes and compile the back actions as\r\n              // outputs of this node\r\n              for (const backNode of component.getNodesWithType(\r\n                \"PageStackNavigateBack\"\r\n              )) {\r\n                if (backNode.parameters[\"backActions\"] !== undefined) {\r\n                  backNode.parameters[\"backActions\"]\r\n                    .split(\",\")\r\n                    .forEach((a: string) => {\r\n                      if (\r\n                        ports.find((_p: any) => _p.name === \"backAction-\" + a)\r\n                      )\r\n                        return;\r\n\r\n                      ports.push({\r\n                        name: \"backAction-\" + a,\r\n                        displayName: a,\r\n                        type: \"signal\",\r\n                        plug: \"output\",\r\n                        group: \"Back Actions\",\r\n                      });\r\n                    });\r\n                }\r\n\r\n                if (backNode.parameters[\"results\"]) {\r\n                  backNode.parameters[\"results\"]\r\n                    .split(\",\")\r\n                    .forEach((p: string) => {\r\n                      if (\r\n                        ports.find((_p: any) => _p.name === \"backResult-\" + p)\r\n                      )\r\n                        return;\r\n\r\n                      ports.push({\r\n                        name: \"backResult-\" + p,\r\n                        displayName: p,\r\n                        type: \"*\",\r\n                        plug: \"output\",\r\n                        group: \"Back Results\",\r\n                      });\r\n                    });\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      context.editorConnection?.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    function _trackTargetComponent() {\r\n      const pageStacks = graphModel.getNodesWithType(\"Page Stack\");\r\n      const pageStack = pageStacks.find(\r\n        (ps) => ps.parameters[\"name\"] === node.parameters[\"stack\"]\r\n      );\r\n      if (pageStack === undefined) return;\r\n\r\n      const pages = pageStack.parameters[\"pages\"];\r\n      if (pages === undefined || pages.length === 0) return;\r\n\r\n      const targetComponent =\r\n        pageStack.parameters[\r\n          \"pageComp-\" + (node.parameters[\"target\"] || pages[0].id)\r\n        ];\r\n      if (targetComponent === undefined) return;\r\n      // @ts-expect-error\r\n      const c = graphModel.components[targetComponent];\r\n      if (c === undefined) return;\r\n\r\n      c.on(\"inputPortAdded\", _updatePorts);\r\n      c.on(\"inputPortRemoved\", _updatePorts);\r\n\r\n      // Also track all back navigate for changes\r\n      for (const _n of c.getNodesWithType(\"PageStackNavigateBack\")) {\r\n        _n.on(\"parameterUpdated\", _updatePorts);\r\n      }\r\n\r\n      // Track back navigate added and removed\r\n      c.on(\"nodeAdded\", (_n: any) => {\r\n        if (_n.type === \"PageStackNavigateBack\") {\r\n          _n.on(\"parameterUpdated\", _updatePorts);\r\n          _updatePorts();\r\n        }\r\n      });\r\n\r\n      c.on(\"nodeWasRemoved\", (_n: any) => {\r\n        if (_n.type === \"PageStackNavigateBack\") _updatePorts();\r\n      });\r\n    }\r\n\r\n    _updatePorts();\r\n    _trackTargetComponent();\r\n    node.on(\"parameterUpdated\", function (ev: any) {\r\n      if (ev.name === \"target\") {\r\n        _trackTargetComponent();\r\n        _updatePorts();\r\n      } else if (ev.name === \"stack\" || ev.name === \"mode\" || ev.name === \"transition\" || ev.name.startsWith(\"tr-\")) _updatePorts();\r\n    });\r\n\r\n    // Track all page stacks for changes (if there are any changes to the pages of the name of a stack we might have to update)\r\n    function _trackPageStack(node: any) {\r\n      node.on(\"parameterUpdated\", function (ev: any) {\r\n        if (ev.name === \"pages\" || ev.name === \"name\") _updatePorts();\r\n      });\r\n    }\r\n    graphModel.on(\"nodeAdded.Page Stack\", _trackPageStack);\r\n    graphModel.on(\"nodeWasRemoved.Page Stack\", _updatePorts);\r\n\r\n    for (const node of graphModel.getNodesWithType(\"Page Stack\")) {\r\n      _trackPageStack(node);\r\n    }\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.PageStackNavigate\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"PageStackNavigate\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","export default class NavigationHandler {\r\n  public static instance = new NavigationHandler();\r\n\r\n  private _pageStacks: Record<string, any[]> = {};\r\n  private _navigationQueue: { name: string; args: any; type: string }[] = [];\r\n\r\n  private _performNavigation(\r\n    name: string = \"Main\",\r\n    args: any,\r\n    type: \"navigate\" | \"replace\"\r\n  ): void {\r\n    if (this._pageStacks[name]) {\r\n      for (const pageStack of this._pageStacks[name]) {\r\n        type === \"navigate\"\r\n          ? pageStack.navigate(args)\r\n          : pageStack.replace(args);\r\n      }\r\n    } else {\r\n      this._navigationQueue.push({ name, args, type });\r\n    }\r\n  }\r\n\r\n  public navigate(name: string = \"Main\", args: any): void {\r\n    this._performNavigation(name, args, \"navigate\");\r\n  }\r\n\r\n  public replace(name: string = \"Main\", args: any): void {\r\n    this._performNavigation(name, args, \"replace\");\r\n  }\r\n\r\n  public registerPageStack(name: string = \"Main\", pageStack: any): void {\r\n    if (!this._pageStacks[name]) {\r\n      this._pageStacks[name] = [];\r\n    }\r\n\r\n    this._pageStacks[name].push(pageStack);\r\n\r\n    let hasReset = false;\r\n    let hasNavigated = false;\r\n\r\n    let i = 0;\r\n    while (i < this._navigationQueue.length) {\r\n      const e = this._navigationQueue[i];\r\n      if (e.name === name) {\r\n        if (e.type === \"navigate\") {\r\n          if (!hasReset) {\r\n            // we need to reset to the start page before doing the first navigation\r\n            pageStack.reset();\r\n            hasReset = true;\r\n          }\r\n          pageStack.navigate(e.args);\r\n        } else {\r\n          pageStack.replace(e.args);\r\n        }\r\n\r\n        hasNavigated = true;\r\n        this._navigationQueue.splice(i, 1);\r\n      } else {\r\n        i++;\r\n      }\r\n    }\r\n\r\n    if (!hasNavigated) {\r\n      pageStack.reset(); // no navigation has happened, call reset() so the start page is created\r\n    }\r\n  }\r\n\r\n  public deregisterPageStack(name: string = \"Main\", pageStack: any): void {\r\n    if (!this._pageStacks[name]) {\r\n      return;\r\n    }\r\n\r\n    const index = this._pageStacks[name].indexOf(pageStack);\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n\r\n    this._pageStacks[name].splice(index, 1);\r\n    if (this._pageStacks[name].length === 0) {\r\n      delete this._pageStacks[name];\r\n    }\r\n  }\r\n}\r\n","import { NodeDefinition } from \"@fluxscape/runtime/src/nodedefinition\";\r\nimport { NodeContext } from \"@fluxscape/runtime/src/nodecontext\";\r\nimport { GraphModel } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  params: Record<string, any>;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"PageInputs\",\r\n  displayNodeName: \"Page Inputs\",\r\n  category: \"Navigation\",\r\n  docs: \"https://docs.noodl.net/nodes/navigation/page-inputs\",\r\n  color: \"component\",\r\n  initialize() {\r\n    this._internal.params = {};\r\n  },\r\n  inputs: {\r\n    pathParams: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      group: \"Path Parameters\",\r\n    },\r\n    queryParams: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      group: \"Query Parameters\",\r\n    },\r\n  },\r\n  outputs: {},\r\n  methods: {\r\n    _setPageParams(params: Record<string, any>) {\r\n      for (const key in params) {\r\n        this._internal.params[key] = params[key];\r\n        if (this.hasOutput(\"pm-\" + key)) this.flagOutputDirty(\"pm-\" + key);\r\n      }\r\n    },\r\n    getPageParam(name: string) {\r\n      return this._internal.params[name];\r\n    },\r\n    registerOutputIfNeeded(name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"pm-\"))\r\n        return this.registerOutput(name, {\r\n          // @ts-expect-error\r\n          getter: this.getPageParam.bind(this, name.substring(\"pm-\".length)),\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    function _updatePorts() {\r\n      const ports: any[] = [];\r\n      const uniqueNames: Record<string, boolean> = {};\r\n\r\n      if (node.parameters[\"pathParams\"] !== undefined) {\r\n        node.parameters[\"pathParams\"].split(\",\").forEach((p: string) => {\r\n          uniqueNames[p] = true;\r\n        });\r\n      }\r\n\r\n      if (node.parameters[\"queryParams\"] !== undefined) {\r\n        node.parameters[\"queryParams\"].split(\",\").forEach((p: string) => {\r\n          uniqueNames[p] = true;\r\n        });\r\n      }\r\n\r\n      Object.keys(uniqueNames).forEach((outputName) => {\r\n        ports.push({\r\n          name: \"pm-\" + outputName,\r\n          displayName: outputName,\r\n          type: \"*\",\r\n          plug: \"output\",\r\n          group: \"Parameters\",\r\n        });\r\n      });\r\n\r\n      context.editorConnection?.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    // Track page node in this component, update if there are any changes\r\n    _updatePorts();\r\n    node.on(\"parameterUpdated\", function () {\r\n      _updatePorts();\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.PageInputs\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"PageInputs\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import NoodlRuntime from \"@fluxscape/runtime\";\r\nimport type { NodeConstructor } from \"../../../typings/global\";\r\n\r\nexport type NavigateArgs = {\r\n  target: string;\r\n  params: Record<string, string | number | boolean>;\r\n  openInNewTab?: boolean;\r\n  hasNavigated?: () => void;\r\n};\r\n\r\nexport type ComponentPageInfo = {\r\n  path: string;\r\n  title: string;\r\n  component: string;\r\n};\r\n\r\nexport class RouterHandler {\r\n  static instance = new RouterHandler();\r\n\r\n  _routers: Record<string, any>;\r\n  _navigationQueue: any[];\r\n\r\n  constructor() {\r\n    this._routers = {};\r\n    this._navigationQueue = [];\r\n  }\r\n\r\n  navigate(name: string, args: NavigateArgs) {\r\n    //add a 1ms timeout so other nodes have a chance to run before the page is destroyed.\r\n    setTimeout(() => {\r\n      const routerNames = Object.keys(this._routers);\r\n      if (routerNames.length === 1) {\r\n        name = routerNames[0];\r\n      }\r\n\r\n      if (this._routers[name]) {\r\n        for (const router of this._routers[name]) {\r\n          router.navigate(args);\r\n        }\r\n      } else {\r\n        this._navigationQueue.push({ name, args });\r\n      }\r\n    }, 1);\r\n  }\r\n\r\n  registerRouter(name: string, router: NodeConstructor) {\r\n    name = name || \"Main\";\r\n    if (!this._routers[name]) {\r\n      this._routers[name] = [];\r\n    }\r\n\r\n    this._routers[name].push(router);\r\n\r\n    let hasNavigated = false;\r\n\r\n    let i = 0;\r\n    while (i < this._navigationQueue.length) {\r\n      const e = this._navigationQueue[i];\r\n      if (e.name === name) {\r\n        router.navigate(e.args);\r\n        hasNavigated = true;\r\n        this._navigationQueue.splice(i, 1);\r\n      } else {\r\n        i++;\r\n      }\r\n    }\r\n\r\n    if (!hasNavigated) {\r\n      router.reset(); //no navigation has happened, call reset() so the start page is created\r\n    }\r\n  }\r\n\r\n  deregisterRouter(name: string, router: NodeConstructor) {\r\n    name = name || \"Main\";\r\n\r\n    if (!this._routers[name]) {\r\n      return;\r\n    }\r\n\r\n    const index = this._routers[name].indexOf(router);\r\n    if (index === -1) {\r\n      return;\r\n    }\r\n\r\n    this._routers[name].splice(index, 1);\r\n    if (this._routers[name].length === 0) {\r\n      delete this._routers[name];\r\n    }\r\n  }\r\n\r\n  getPagesForRouter(name: string) {\r\n    const routerIndex = NoodlRuntime.instance.graphModel.routerIndex;\r\n    const routers = routerIndex!.routers;\r\n\r\n    if (routers === undefined || routers.length === 0) return [];\r\n\r\n    const matchingRouters =\r\n      name === undefined\r\n        ? [routers[0]]\r\n        : routers.filter((r) => r.name === name);\r\n\r\n    const pageComponents = new Set();\r\n    matchingRouters.forEach((r) => {\r\n      const pages = r.pages;\r\n      if (pages !== undefined && pages.routes !== undefined) {\r\n        pages.routes.forEach((r) => {\r\n          pageComponents.add(r);\r\n        });\r\n      }\r\n    });\r\n\r\n    return Array.from(pageComponents)\r\n      .map((c) => this.getPageInfoForComponent(String(c)))\r\n      .filter((item) => !!item);\r\n  }\r\n\r\n  getPageInfoForComponent(\r\n    componentName: string\r\n  ): ComponentPageInfo | undefined {\r\n    const routerIndex = NoodlRuntime.instance.graphModel.routerIndex;\r\n    const page = routerIndex!.pages.find((p) => p.component === componentName);\r\n    return page;\r\n  }\r\n\r\n  /**\r\n   * Occurs when the Router navigates to a new page.\r\n   *\r\n   * @param routerName\r\n   * @param page\r\n   */\r\n  onNavigated(routerName: string, page: ComponentPageInfo) {\r\n    // @ts-expect-error window.Noodl is not defined\r\n    window.Noodl.Events.emit(\"NoodlApp_Navigated\", {\r\n      routerName,\r\n      ...page,\r\n    });\r\n  }\r\n}\r\n","import { NodeDefinition } from \"@fluxscape/runtime/src/nodedefinition\";\r\nimport { RouterHandler } from \"./router-handler\";\r\n\r\ninterface Internal {\r\n  pageParams: any;\r\n  openInNewTab: boolean;\r\n  hasScheduledNavigate: boolean;\r\n  target: string;\r\n  router: string;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"RouterNavigate\",\r\n  displayNodeName: \"Navigate\",\r\n  category: \"Navigation\",\r\n  docs: \"https://docs.noodl.net/nodes/navigation/navigate\",\r\n  initialize() {\r\n    this._internal.pageParams = {};\r\n    this._internal.openInNewTab = false;\r\n  },\r\n  inputs: {\r\n    navigate: {\r\n      displayName: \"Navigate\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleNavigate();\r\n      },\r\n    },\r\n    openInNewTab: {\r\n      index: 10,\r\n      displayName: \"Open in new tab\",\r\n      group: \"General\",\r\n      default: false,\r\n      type: \"boolean\",\r\n      set(value: boolean) {\r\n        this._internal.openInNewTab = !!value;\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    navigated: {\r\n      type: \"signal\",\r\n      displayName: \"Navigated\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n  methods: {\r\n    scheduleNavigate() {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledNavigate) {\r\n        internal.hasScheduledNavigate = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          internal.hasScheduledNavigate = false;\r\n          // @ts-expect-error\r\n          this.navigate();\r\n        });\r\n      }\r\n    },\r\n    navigate() {\r\n      RouterHandler.instance.navigate(this._internal.router, {\r\n        target: this._internal.target,\r\n        params: this._internal.pageParams,\r\n        openInNewTab: this._internal.openInNewTab,\r\n        hasNavigated: () => {\r\n          this.scheduleAfterInputsHaveUpdated(() => {\r\n            this.sendSignalOnOutput(\"navigated\");\r\n          });\r\n        },\r\n      });\r\n    },\r\n    setPageParam(param: string, value: any) {\r\n      this._internal.pageParams[param] = value;\r\n    },\r\n    setTargetPage(page: string) {\r\n      this._internal.target = page;\r\n    },\r\n    setRouter(value: any) {\r\n      this._internal.router = value;\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"target\") {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setTargetPage.bind(this),\r\n        });\r\n      } else if (name === \"router\") {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setRouter.bind(this),\r\n        });\r\n      } else if (name.startsWith(\"pm-\")) {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setPageParam.bind(this, name.substring(\"pm-\".length)),\r\n        });\r\n      }\r\n    },\r\n  },\r\n};\r\n","import { GraphModel } from \"@fluxscape/runtime\";\r\nimport { NodeContext } from \"@fluxscape/runtime/src/nodecontext\";\r\nimport { NodeDefinition } from \"@fluxscape/runtime/src/nodedefinition\";\r\n\r\ninterface Internal {\r\n  popupParams: any;\r\n  closeResults: any;\r\n  hasScheduledShow: boolean;\r\n  target: string;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"NavigationShowPopup\",\r\n  displayNodeName: \"Show Popup\",\r\n  category: \"Navigation\",\r\n  docs: \"https://docs.noodl.net/nodes/popups/show-popup\",\r\n  initialize() {\r\n    this._internal.popupParams = {};\r\n    this._internal.closeResults = {};\r\n  },\r\n  inputs: {\r\n    target: {\r\n      type: \"component\",\r\n      displayName: \"Target\",\r\n      group: \"General\",\r\n      set(value: any) {\r\n        this._internal.target = value;\r\n      },\r\n    },\r\n    show: {\r\n      type: \"signal\",\r\n      displayName: \"Show\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleShow();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    Closed: {\r\n      type: \"signal\",\r\n    },\r\n  },\r\n  methods: {\r\n    setPopupParam(param: string, value: any) {\r\n      this._internal.popupParams[param] = value;\r\n    },\r\n    getCloseResult(param: string) {\r\n      return this._internal.closeResults[param];\r\n    },\r\n    scheduleShow() {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledShow) {\r\n        internal.hasScheduledShow = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          internal.hasScheduledShow = false;\r\n          // @ts-expect-error\r\n          this.show();\r\n        });\r\n      }\r\n    },\r\n    show() {\r\n      if (this._internal.target === undefined) return;\r\n\r\n      this.context.showPopup(\r\n        this._internal.target,\r\n        this._internal.popupParams,\r\n        {\r\n          // @ts-expect-error\r\n          senderNode: this.nodeScope.componentOwner,\r\n          onClosePopup: (action: string | undefined, results: any) => {\r\n            this._internal.closeResults = results;\r\n\r\n            for (const key in results) {\r\n              if (this.hasOutput(\"closeResult-\" + key)) {\r\n                this.flagOutputDirty(\"closeResult-\" + key);\r\n              }\r\n            }\r\n\r\n            if (!action) {\r\n              this.sendSignalOnOutput(\"Closed\");\r\n            } else {\r\n              this.sendSignalOnOutput(action);\r\n            }\r\n          },\r\n        }\r\n      );\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"popupParam-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setPopupParam.bind(\r\n            this,\r\n            name.substring(\"popupParam-\".length)\r\n          ),\r\n        });\r\n    },\r\n    registerOutputIfNeeded(name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"closeResult-\"))\r\n        return this.registerOutput(name, {\r\n          // @ts-expect-error\r\n          getter: this.getCloseResult.bind(\r\n            this,\r\n            name.substring(\"closeResult-\".length)\r\n          ),\r\n        });\r\n\r\n      if (name.startsWith(\"closeAction-\"))\r\n        return this.registerOutput(name, {\r\n          getter() {\r\n            /** No needed for signals */\r\n          },\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    function _updatePorts() {\r\n      const ports: any[] = [];\r\n\r\n      const targetComponentName = node.parameters[\"target\"];\r\n      if (targetComponentName !== undefined) {\r\n        // @ts-expect-error\r\n        const c = graphModel.components[targetComponentName];\r\n        if (c) {\r\n          for (const inputName in c.inputPorts) {\r\n            const o = c.inputPorts[inputName];\r\n            ports.push({\r\n              name: \"popupParam-\" + inputName,\r\n              displayName: inputName,\r\n              type: o.type || \"*\",\r\n              plug: \"input\",\r\n              group: \"Params\",\r\n            });\r\n          }\r\n\r\n          for (const _n of c.getNodesWithType(\"NavigationClosePopup\")) {\r\n            if (_n.parameters[\"closeActions\"] !== undefined) {\r\n              _n.parameters[\"closeActions\"].split(\",\").forEach((a: string) => {\r\n                if (ports.find((p) => p.name === a)) return;\r\n\r\n                ports.push({\r\n                  name: \"closeAction-\" + a,\r\n                  displayName: a,\r\n                  type: \"signal\",\r\n                  plug: \"output\",\r\n                  group: \"Close Actions\",\r\n                });\r\n              });\r\n            }\r\n\r\n            if (_n.parameters[\"results\"] !== undefined) {\r\n              _n.parameters[\"results\"].split(\",\").forEach((p: string) => {\r\n                ports.push({\r\n                  name: \"closeResult-\" + p,\r\n                  displayName: p,\r\n                  type: \"*\",\r\n                  plug: \"output\",\r\n                  group: \"Close Results\",\r\n                });\r\n              });\r\n            }\r\n          }\r\n        }\r\n      }\r\n      context.editorConnection?.sendDynamicPorts(node.id, ports);\r\n    }\r\n\r\n    function _trackTargetComponent(name: string | undefined) {\r\n      if (name === undefined) return;\r\n      // @ts-expect-error\r\n      const c = graphModel.components[name];\r\n      if (c === undefined) return;\r\n\r\n      c.on(\"inputPortAdded\", _updatePorts);\r\n      c.on(\"inputPortRemoved\", _updatePorts);\r\n\r\n      for (const _n of c.getNodesWithType(\"NavigationClosePopup\")) {\r\n        _n.on(\"parameterUpdated\", _updatePorts);\r\n      }\r\n\r\n      c.on(\"nodeAdded\", (_n: any) => {\r\n        if (_n.type === \"NavigationClosePopup\") {\r\n          _n.on(\"parameterUpdated\", _updatePorts);\r\n          _updatePorts();\r\n        }\r\n      });\r\n\r\n      c.on(\"nodeWasRemoved\", (_n: any) => {\r\n        if (_n.type === \"NavigationClosePopup\") _updatePorts();\r\n      });\r\n    }\r\n\r\n    _updatePorts();\r\n    _trackTargetComponent(node.parameters[\"target\"]);\r\n\r\n    node.on(\"parameterUpdated\", function (event: { name: string }) {\r\n      if (event.name === \"target\") {\r\n        _updatePorts();\r\n        _trackTargetComponent(node.parameters[\"target\"]);\r\n      }\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.NavigationShowPopup\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"NavigationShowPopup\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","export class Transition {\r\n  private _frame: () => void;\r\n  private cb?: () => void;\r\n  private transitionForward: boolean = false;\r\n  private startTime: number = 0;\r\n\r\n  timing: { delay: number; dur: number } = { delay: 0, dur: 0 };\r\n\r\n  constructor() {\r\n    this._frame = this.frame.bind(this);\r\n    this.timing = { delay: 0, dur: 0 }; // Initialize timing with default values\r\n  }\r\n\r\n  start(args: { end: () => void; back: boolean }) {\r\n    this.cb = args.end;\r\n\r\n    if (this.timing.delay + this.timing.dur === 0) {\r\n      this.end();\r\n    } else {\r\n      this.transitionForward = !args.back;\r\n      this.startTime = window.performance.now();\r\n      requestAnimationFrame(this._frame);\r\n    }\r\n  }\r\n\r\n  frame() {\r\n    const t =\r\n      (window.performance.now() - (this.startTime + this.timing.delay)) /\r\n      this.timing.dur;\r\n    const _t = Math.max(0, Math.min(t, 1));\r\n\r\n    this.transitionForward ? this.forward(_t) : this.back(_t);\r\n\r\n    if (\r\n      window.performance.now() <=\r\n      this.startTime + this.timing.dur + this.timing.delay\r\n    ) {\r\n      requestAnimationFrame(this._frame);\r\n    } else {\r\n      this.end();\r\n    }\r\n  }\r\n\r\n  end() {\r\n    this.cb && this.cb();\r\n  }\r\n\r\n  forward(t: number) {\r\n    // Implementation of forward transition\r\n  }\r\n\r\n  back(t: number) {\r\n    // Implementation of back transition\r\n  }\r\n}\r\n","import { NoneTransition } from \"./transitions/none-transition\";\r\nimport { PushTransition } from \"./transitions/push-transition\";\r\nimport { PopupTransition } from \"./transitions/popup-transition\";\r\n\r\nexport const Transitions = {\r\n  None: NoneTransition,\r\n  Push: PushTransition,\r\n  Popup: PopupTransition,\r\n};\r\n","import { Transition } from \"./transition\";\r\n\r\nexport class NoneTransition extends Transition {\r\n  from: any;\r\n  to: any;\r\n\r\n  constructor(from: any, to: any, params: any) {\r\n    super();\r\n\r\n    this.from = from;\r\n    this.to = to;\r\n\r\n    this.timing = { dur: 0, delay: 0 };\r\n  }\r\n\r\n  update(t: number): void {}\r\n\r\n  forward(t: number): void {}\r\n\r\n  back(t: number): void {}\r\n\r\n  static ports(): any[] {\r\n    return [];\r\n  }\r\n}\r\n","import { Transition } from \"./transition\";\r\nimport BezierEasing from \"bezier-easing\";\r\n\r\ninterface Params {\r\n  timing?: { curve: number[]; dur: number; delay: number };\r\n  shift?: number | { value: number; unit: string };\r\n  direction?: \"Right\" | \"Left\" | \"Up\" | \"Down\" | \"In\" | \"Out\";\r\n  crossfade?: boolean;\r\n  darkoverlay?: boolean;\r\n  darkoverlayamount?: number;\r\n  zoom?: number | { value: number; unit: string };\r\n}\r\n\r\nexport class PushTransition extends Transition {\r\n  from: any;\r\n  to: any;\r\n  timing: { curve: number[]; dur: number; delay: number };\r\n  distance: { value: number; unit: string };\r\n  direction: \"Right\" | \"Left\" | \"Up\" | \"Down\" | \"In\" | \"Out\";\r\n  ease: (t: number) => number;\r\n  crossfade: boolean;\r\n  darkOverlay: any;\r\n  darkOverlayAmount: number;\r\n  zoom: { value: number; unit: string };\r\n\r\n  constructor(from: any, to: any, params: Params) {\r\n    super();\r\n\r\n    this.from = from;\r\n    this.to = to;\r\n\r\n    this.timing = params.timing || {\r\n      curve: [0.0, 0.0, 0.58, 1.0],\r\n      dur: 300,\r\n      delay: 0,\r\n    };\r\n    // @ts-expect-error\r\n    this.distance = params.shift || { value: 25, unit: \"%\" };\r\n    if (typeof this.distance === \"number\")\r\n      this.distance = { value: this.distance, unit: \"%\" };\r\n    this.direction = params.direction || \"Left\";\r\n\r\n    this.timing.curve[0] = Math.min(1, Math.max(0, this.timing.curve[0]));\r\n    this.timing.curve[2] = Math.min(1, Math.max(0, this.timing.curve[2]));\r\n    this.ease = BezierEasing.apply(null, this.timing.curve).get;\r\n\r\n    this.crossfade = params.crossfade === undefined ? false : params.crossfade;\r\n    this.darkOverlay =\r\n      params.darkoverlay === undefined ? true : params.darkoverlay;\r\n    this.darkOverlayAmount =\r\n      params.darkoverlayamount === undefined ? 0.5 : params.darkoverlayamount;\r\n\r\n    // @ts-expect-error\r\n    this.zoom = params.zoom || { value: 25, unit: \"%\" };\r\n    if (typeof this.zoom === \"number\")\r\n      this.zoom = { value: this.zoom, unit: \"%\" };\r\n\r\n    if (this.darkOverlay) {\r\n      this.darkOverlay = from.nodeScope.createPrimitiveNode(\"Group\");\r\n      this.darkOverlay.setInputValue(\"position\", \"absolute\");\r\n      this.darkOverlay.setInputValue(\"sizeMode\", \"explicit\");\r\n      this.darkOverlay.setInputValue(\"width\", { value: 100, unit: \"%\" });\r\n      this.darkOverlay.setInputValue(\"height\", { value: 100, unit: \"%\" });\r\n      this.darkOverlay.setInputValue(\"backgroundColor\", \"#000000\");\r\n      this.darkOverlay.setInputValue(\"opacity\", 0);\r\n    }\r\n  }\r\n\r\n  update(t: number) {\r\n    if (this.direction === \"In\" || this.direction === \"Out\") {\r\n      let zoom = this.zoom.value / 100;\r\n\r\n      zoom = this.direction === \"Out\" ? -zoom : zoom;\r\n\r\n      this.from.setStyle({\r\n        transform: \"scale(\" + (1 + zoom * t) + \")\",\r\n        opacity: this.crossfade ? 1 - t : 1,\r\n      });\r\n\r\n      this.to.setStyle({\r\n        transform: \"scale(\" + (1 - zoom * (1 - t)) + \")\",\r\n        opacity: this.crossfade ? t : 1,\r\n      });\r\n    } else {\r\n      const dist = this.distance.value;\r\n      const unit = this.distance.unit;\r\n\r\n      const targets = {\r\n        Up: { x: 0, y: -1 },\r\n        Down: { x: 0, y: 1 },\r\n        Left: { x: -1, y: 0 },\r\n        Right: { x: 1, y: 0 },\r\n      };\r\n\r\n      const from = {\r\n        x: targets[this.direction].x * dist,\r\n        y: targets[this.direction].y * dist,\r\n      };\r\n\r\n      const target = {\r\n        x: targets[this.direction].x * 100,\r\n        y: targets[this.direction].y * 100,\r\n      };\r\n\r\n      this.from.setStyle({\r\n        transform:\r\n          \"translate(\" + from.x * t + unit + \",\" + from.y * t + unit + \")\",\r\n        opacity: this.crossfade ? 1 - t : 1,\r\n      });\r\n\r\n      this.to.setStyle({\r\n        transform:\r\n          \"translate(\" +\r\n          target.x * (t - 1) +\r\n          unit +\r\n          \",\" +\r\n          target.y * (t - 1) +\r\n          \"%)\",\r\n        opacity: this.crossfade ? t : 1,\r\n      });\r\n    }\r\n\r\n    if (this.darkOverlay) {\r\n      this.darkOverlay.setStyle({\r\n        opacity: t * this.darkOverlayAmount,\r\n      });\r\n    }\r\n  }\r\n\r\n  forward(t: number) {\r\n    const _t = this.ease(t);\r\n    this.update(_t);\r\n  }\r\n\r\n  back(t: number) {\r\n    const _t = this.ease(t);\r\n    this.update(1 - _t);\r\n  }\r\n\r\n  start(args: any) {\r\n    super.start(args);\r\n    if (this.darkOverlay) {\r\n      this.from.addChild(this.darkOverlay);\r\n    }\r\n  }\r\n\r\n  end() {\r\n    if (this.darkOverlay) {\r\n      this.from.removeChild(this.darkOverlay);\r\n    }\r\n    super.end();\r\n  }\r\n\r\n  static ports(parameters: any) {\r\n    const ports: any[] = [];\r\n\r\n    ports.push({\r\n      name: \"tr-direction\",\r\n      displayName: \"Direction\",\r\n      group: \"Transition\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\"Right\", \"Left\", \"Up\", \"Down\", \"In\", \"Out\"],\r\n      },\r\n      default: \"Left\",\r\n      plug: \"input\",\r\n    });\r\n\r\n    if (\r\n      parameters[\"tr-direction\"] === \"In\" ||\r\n      parameters[\"tr-direction\"] === \"Out\"\r\n    ) {\r\n      ports.push({\r\n        name: \"tr-zoom\",\r\n        displayName: \"Zoom\",\r\n        group: \"Transition\",\r\n        type: { name: \"number\", units: [\"%\"] },\r\n        default: { value: 25, unit: \"%\" },\r\n        plug: \"input\",\r\n      });\r\n    } else {\r\n      ports.push({\r\n        name: \"tr-shift\",\r\n        displayName: \"Shift Distance\",\r\n        group: \"Transition\",\r\n        type: { name: \"number\", units: [\"%\", \"px\"] },\r\n        default: { value: 25, unit: \"%\" },\r\n        plug: \"input\",\r\n      });\r\n    }\r\n\r\n    ports.push({\r\n      name: \"tr-crossfade\",\r\n      displayName: \"Crossfade\",\r\n      group: \"Transition\",\r\n      type: \"boolean\",\r\n      default: false,\r\n      plug: \"input\",\r\n    });\r\n\r\n    ports.push({\r\n      name: \"tr-darkoverlay\",\r\n      displayName: \"Dark Overlay\",\r\n      group: \"Transition\",\r\n      type: \"boolean\",\r\n      default: true,\r\n      plug: \"input\",\r\n    });\r\n\r\n    ports.push({\r\n      name: \"tr-darkoverlayamount\",\r\n      displayName: \"Dark Overlay Amount\",\r\n      group: \"Transition\",\r\n      type: \"number\",\r\n      default: 0.5,\r\n      plug: \"input\",\r\n    });\r\n\r\n    ports.push({\r\n      name: \"tr-timing\",\r\n      displayName: \"Timing\",\r\n      group: \"Transition\",\r\n      type: \"curve\",\r\n      plug: \"input\",\r\n    });\r\n\r\n    return ports;\r\n  }\r\n}\r\n","import { Transition } from \"./transition\";\r\nimport BezierEasing from \"bezier-easing\";\r\n\r\ninterface Params {\r\n  timing?: { curve: number[]; dur: number; delay: number };\r\n  shift?: number | { value: number; unit: string };\r\n  direction?: \"Right\" | \"Left\" | \"Up\" | \"Down\" | \"In\" | \"Out\";\r\n  fadein?: boolean;\r\n  zoom?: number | { value: number; unit: string };\r\n}\r\n\r\nexport class PopupTransition extends Transition {\r\n  from: any;\r\n  to: any;\r\n  timing: { curve: number[]; dur: number; delay: number };\r\n  distance: { value: number; unit: string };\r\n  direction: \"Right\" | \"Left\" | \"Up\" | \"Down\" | \"In\" | \"Out\";\r\n  ease: (t: number) => number;\r\n  fadein: boolean;\r\n  zoom: { value: number; unit: string };\r\n\r\n  constructor(from: any, to: any, params: Params) {\r\n    super();\r\n\r\n    this.from = from;\r\n    this.to = to;\r\n\r\n    this.timing = params.timing || {\r\n      curve: [0.0, 0.0, 0.58, 1.0],\r\n      dur: 300,\r\n      delay: 0,\r\n    };\r\n    // @ts-expect-error\r\n    this.distance = params.shift || { value: 25, unit: \"%\" };\r\n    if (typeof this.distance === \"number\")\r\n      this.distance = { value: this.distance, unit: \"%\" };\r\n    this.direction = params.direction || \"Right\";\r\n\r\n    this.timing.curve[0] = Math.min(1, Math.max(0, this.timing.curve[0]));\r\n    this.timing.curve[2] = Math.min(1, Math.max(0, this.timing.curve[2]));\r\n    this.ease = BezierEasing.apply(null, this.timing.curve).get;\r\n\r\n    this.fadein = params.fadein === undefined ? false : params.fadein;\r\n\r\n    // @ts-expect-error\r\n    this.zoom = params.zoom || { value: 25, unit: \"%\" };\r\n    if (typeof this.zoom === \"number\")\r\n      this.zoom = { value: this.zoom, unit: \"%\" };\r\n  }\r\n\r\n  update(t: number) {\r\n    if (this.direction === \"In\" || this.direction === \"Out\") {\r\n      let zoom = this.zoom.value / 100;\r\n\r\n      zoom = this.direction === \"Out\" ? -zoom : zoom;\r\n\r\n      this.to.setStyle({\r\n        transform: \"scale(\" + (1 - zoom * (1 - t)) + \")\",\r\n        // @ts-expect-error\r\n        opacity: this.crossfade ? t : 1,\r\n      });\r\n    } else {\r\n      const dist = this.distance.value;\r\n      const unit = this.distance.unit;\r\n\r\n      const targets: { [key: string]: { x: number; y: number } } = {\r\n        Up: { x: 0, y: -1 },\r\n        Down: { x: 0, y: 1 },\r\n        Left: { x: -1, y: 0 },\r\n        Right: { x: 1, y: 0 },\r\n      };\r\n      const target = {\r\n        x: targets[this.direction].x * dist,\r\n        y: targets[this.direction].y * dist,\r\n      };\r\n\r\n      this.to.setStyle({\r\n        transform:\r\n          \"translate(\" +\r\n          target.x * (t - 1) +\r\n          unit +\r\n          \",\" +\r\n          target.y * (t - 1) +\r\n          unit +\r\n          \")\",\r\n        opacity: this.fadein ? t : 1,\r\n      });\r\n    }\r\n  }\r\n\r\n  forward(t: number) {\r\n    const _t = this.ease(t);\r\n    this.update(_t);\r\n  }\r\n\r\n  back(t: number) {\r\n    const _t = this.ease(t);\r\n    this.update(1 - _t);\r\n  }\r\n\r\n  static ports(parameters: any) {\r\n    const ports: any[] = [];\r\n\r\n    ports.push({\r\n      name: \"tr-direction\",\r\n      displayName: \"Direction\",\r\n      group: \"Transition\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\"Right\", \"Left\", \"Up\", \"Down\", \"In\", \"Out\"],\r\n      },\r\n      default: \"Right\",\r\n      plug: \"input\",\r\n    });\r\n\r\n    if (\r\n      parameters[\"tr-direction\"] === \"In\" ||\r\n      parameters[\"tr-direction\"] === \"Out\"\r\n    ) {\r\n      ports.push({\r\n        name: \"tr-zoom\",\r\n        displayName: \"Zoom\",\r\n        group: \"Transition\",\r\n        type: { name: \"number\", units: [\"%\"] },\r\n        default: { value: 25, unit: \"%\" },\r\n        plug: \"input\",\r\n      });\r\n    } else {\r\n      ports.push({\r\n        name: \"tr-shift\",\r\n        displayName: \"Shift Distance\",\r\n        group: \"Transition\",\r\n        type: { name: \"number\", units: [\"%\", \"px\"] },\r\n        default: { value: 25, unit: \"%\" },\r\n        plug: \"input\",\r\n      });\r\n    }\r\n\r\n    ports.push({\r\n      name: \"tr-fadein\",\r\n      displayName: \"Fade In\",\r\n      group: \"Transition\",\r\n      type: \"boolean\",\r\n      default: false,\r\n      plug: \"input\",\r\n    });\r\n\r\n    ports.push({\r\n      name: \"tr-timing\",\r\n      displayName: \"Timing\",\r\n      group: \"Transition\",\r\n      type: \"curve\",\r\n      plug: \"input\",\r\n    });\r\n\r\n    return ports;\r\n  }\r\n}\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\nimport EaseCurves from \"../../easecurves\";\r\n\r\nconst defaultDuration = 300;\r\n\r\ninterface Internal {\r\n  currentNumber: number;\r\n  numberInitialized: boolean;\r\n  animationStarted: boolean;\r\n  setCurrentNumberEnabled: boolean;\r\n  overrideValue: number;\r\n  _animation: any;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"net.noodl.animatetovalue\",\r\n  docs: \"https://docs.noodl.net/nodes/logic/animate-to-value\",\r\n  displayName: \"Animate To Value\",\r\n  shortDesc:\r\n    \"This node can interpolate smoothly from the current value to a target value.\",\r\n  category: \"Animation\",\r\n  initialize() {\r\n    const _internal = this._internal;\r\n\r\n    _internal.currentNumber = 0;\r\n    _internal.numberInitialized = false;\r\n    _internal.animationStarted = false;\r\n    _internal.setCurrentNumberEnabled = false;\r\n    _internal.overrideValue = 0;\r\n\r\n    _internal._animation = this.context.timerScheduler.createTimer({\r\n      duration: defaultDuration,\r\n      startValue: 0,\r\n      endValue: 0,\r\n      ease: EaseCurves.easeOut,\r\n      onStart: () => {\r\n        _internal.animationStarted = true;\r\n      },\r\n      onRunning: (t) => {\r\n        // @ts-expect-error\r\n        _internal.currentNumber = this.ease(this.startValue, this.endValue, t);\r\n        this.flagOutputDirty(\"currentValue\");\r\n      },\r\n      onFinish: () => {\r\n        this.sendSignalOnOutput(\"atTargetValue\");\r\n      },\r\n    });\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.currentNumber;\r\n  },\r\n  inputs: {\r\n    targetValue: {\r\n      type: { name: \"number\" },\r\n      displayName: \"Target Value\",\r\n      group: \"Target Value\",\r\n      default: undefined,\r\n      set(value) {\r\n        if (value === true) {\r\n          value = 1;\r\n        } else if (value === false) {\r\n          value = 0;\r\n        }\r\n\r\n        value = Number(value);\r\n\r\n        if (isNaN(value)) {\r\n          return;\r\n        }\r\n\r\n        const internal = this._internal;\r\n\r\n        if (!internal.numberInitialized) {\r\n          internal.currentNumber = value;\r\n          internal.numberInitialized = true;\r\n          internal._animation.endValue = value;\r\n          this.flagOutputDirty(\"currentValue\");\r\n          return;\r\n        } else if (value === internal._animation.endValue) {\r\n          return;\r\n        }\r\n\r\n        internal._animation.startValue = internal.currentNumber;\r\n        internal._animation.endValue = value;\r\n        internal._animation.start();\r\n      },\r\n    },\r\n    duration: {\r\n      type: \"number\",\r\n      group: \"Parameters\",\r\n      displayName: \"Duration\",\r\n      default: defaultDuration,\r\n      set(value) {\r\n        this._internal._animation.duration = value;\r\n      },\r\n    },\r\n    delay: {\r\n      type: \"number\",\r\n      group: \"Parameters\",\r\n      displayName: \"Delay\",\r\n      default: 0,\r\n      set(value) {\r\n        this._internal._animation.delay = value;\r\n      },\r\n    },\r\n    easingCurve: {\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { value: \"easeOut\", label: \"Ease Out\" },\r\n          { value: \"easeIn\", label: \"Ease In\" },\r\n          { value: \"linear\", label: \"Linear\" },\r\n          { value: \"easeInOut\", label: \"Ease In Out\" },\r\n        ],\r\n      },\r\n      default: \"easeOut\",\r\n      displayName: \"Easing Curve\",\r\n      group: \"Parameters\",\r\n      set(value) {\r\n        this._internal._animation.ease = EaseCurves[value];\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    currentValue: {\r\n      type: \"number\",\r\n      displayName: \"Current Value\",\r\n      group: \"Current State\",\r\n      getter() {\r\n        return this._internal.currentNumber;\r\n      },\r\n    },\r\n    atTargetValue: {\r\n      type: \"signal\",\r\n      displayName: \"At Target Value\",\r\n      group: \"Signals\",\r\n    },\r\n  },\r\n};\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\nimport EaseCurves from \"../../easecurves\";\r\n\r\nfunction clamp(min: number, max: number, value: number): number {\r\n  return Math.max(min, Math.min(max, value));\r\n}\r\n\r\nfunction setRGB(result: number[], hex: string): void {\r\n  for (let i = 0; i < 3; ++i) {\r\n    const index = 1 + i * 2;\r\n    result[i] = parseInt(hex.substring(index, index + 2), 16);\r\n  }\r\n}\r\n\r\nfunction componentToHex(c: number): string {\r\n  const hex = c.toString(16);\r\n  return hex.length === 1 ? \"0\" + hex : hex;\r\n}\r\n\r\nfunction rgbToHex(rgb: number[]): string {\r\n  return (\r\n    \"#\" +\r\n    componentToHex(rgb[0]) +\r\n    componentToHex(rgb[1]) +\r\n    componentToHex(rgb[2])\r\n  );\r\n}\r\n\r\n// Reusing these to reduce GC pressure\r\nlet rgb0: number[] = [0, 0, 0];\r\nlet rgb1: number[] = [0, 0, 0];\r\nlet rgb2: number[] = [0, 0, 0];\r\n\r\ninterface Internal {\r\n  resultColor: string;\r\n  blendValue: number;\r\n  colors: string[];\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Color Blend\",\r\n  docs: \"https://docs.noodl.net/nodes/utilities/color-blend\",\r\n  shortDesc:\r\n    \"Given any number of input colors this node can interpolate between these and give the result color as output.\",\r\n  category: \"Interpolation\",\r\n  getInspectInfo() {\r\n    return [{ type: \"color\", value: this._internal.resultColor }];\r\n  },\r\n  initialize() {\r\n    const internal = this._internal;\r\n\r\n    internal.resultColor = \"#000000\";\r\n    internal.blendValue = 0;\r\n    internal.colors = [];\r\n  },\r\n  numberedInputs: {\r\n    color: {\r\n      type: \"color\",\r\n      displayPrefix: \"Color\",\r\n      createSetter(index: number) {\r\n        return (value: string) => {\r\n          // @ts-expect-error\r\n          this._internal.colors[index] = value;\r\n          // @ts-expect-error\r\n          this.updateColor();\r\n        };\r\n      },\r\n    },\r\n  },\r\n  inputs: {\r\n    blendValue: {\r\n      type: \"number\",\r\n      displayName: \"Blend Value\",\r\n      default: 0,\r\n      set(value: number) {\r\n        this._internal.blendValue = value;\r\n        // @ts-expect-error\r\n        this.updateColor();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    result: {\r\n      type: \"color\",\r\n      displayName: \"Result\",\r\n      getter() {\r\n        return this._internal.resultColor;\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    updateColor() {\r\n      const colors = this._internal.colors;\r\n      if (colors.length === 0) {\r\n        return;\r\n      }\r\n\r\n      const getColor = (index: number): string => {\r\n        return colors[index] ? colors[index] : \"#000000\";\r\n      };\r\n\r\n      const clampedBlendValue = clamp(\r\n        0,\r\n        colors.length - 1,\r\n        this._internal.blendValue\r\n      );\r\n      const index = Math.floor(clampedBlendValue);\r\n      const t = clampedBlendValue - index;\r\n\r\n      if (t === 0) {\r\n        this._internal.resultColor = getColor(index);\r\n      } else {\r\n        setRGB(rgb0, getColor(index));\r\n        setRGB(rgb1, getColor(index + 1));\r\n\r\n        rgb2[0] = Math.floor(EaseCurves.linear(rgb0[0], rgb1[0], t));\r\n        rgb2[1] = Math.floor(EaseCurves.linear(rgb0[1], rgb1[1], t));\r\n        rgb2[2] = Math.floor(EaseCurves.linear(rgb0[2], rgb1[2], t));\r\n        this._internal.resultColor = rgbToHex(rgb2);\r\n      }\r\n\r\n      this.flagOutputDirty(\"result\");\r\n    },\r\n  },\r\n};\r\n","import NoodlRuntime, { NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  paramsValues: Record<string, any>;\r\n  resultsValues: Record<string, any>;\r\n  lastCallResult?: any;\r\n  error?: string;\r\n  functionName?: string;\r\n  hasScheduledCall?: boolean;\r\n}\r\n\r\nfunction _makeRequest(\r\n  path: string,\r\n  options: {\r\n    method?: string;\r\n    endpoint: string;\r\n    appId: string;\r\n    content: any;\r\n    success: (res: any) => void;\r\n    error: (err: any) => void;\r\n  }\r\n) {\r\n  const xhr = new XMLHttpRequest();\r\n\r\n  xhr.onreadystatechange = function () {\r\n    if (xhr.readyState === 4) {\r\n      let json;\r\n      try {\r\n        json = JSON.parse(xhr.response);\r\n      } catch (e) {}\r\n\r\n      if (xhr.status === 200 || xhr.status === 201) {\r\n        options.success(json);\r\n      } else {\r\n        options.error(json);\r\n      }\r\n    }\r\n  };\r\n\r\n  xhr.open(options.method || \"GET\", options.endpoint + path, true);\r\n\r\n  xhr.setRequestHeader(\"X-Parse-Application-Id\", options.appId);\r\n  xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n\r\n  const cloudServices = NoodlRuntime.instance.getMetaData(\"cloudservices\");\r\n  if (cloudServices && cloudServices.deployVersion) {\r\n    xhr.setRequestHeader(\"x-noodl-cloud-version\", cloudServices.deployVersion);\r\n  }\r\n\r\n  // Check for current users\r\n  const _cu = localStorage[\"Parse/\" + options.appId + \"/currentUser\"];\r\n  if (_cu !== undefined) {\r\n    try {\r\n      const currentUser = JSON.parse(_cu);\r\n      xhr.setRequestHeader(\"X-Parse-Session-Token\", currentUser.sessionToken);\r\n    } catch (e) {\r\n      // Failed to extract session token\r\n    }\r\n  }\r\n\r\n  xhr.send(JSON.stringify(options.content));\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"CloudFunction2\",\r\n  displayName: \"Cloud Function\",\r\n  category: \"Cloud Services\",\r\n  color: \"data\",\r\n  usePortAsLabel: \"function\",\r\n  docs: \"https://docs.noodl.net/nodes/data/cloud-data/cloud-function\",\r\n  _internal: {\r\n    paramsValues: {},\r\n    resultsValues: {},\r\n  },\r\n  initialize: function () {\r\n    this._internal.paramsValues = {};\r\n    this._internal.resultsValues = {};\r\n  },\r\n  getInspectInfo() {\r\n    const result = this._internal.lastCallResult;\r\n    if (!result) return \"[Not executed yet]\";\r\n\r\n    return [{ type: \"value\", value: result }];\r\n  },\r\n  inputs: {\r\n    call: {\r\n      type: \"signal\",\r\n      displayName: \"Call\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue: function () {\r\n        // @ts-expect-error\r\n        this.scheduleCall();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    success: {\r\n      type: \"signal\",\r\n      displayName: \"Success\",\r\n      group: \"Signals\",\r\n    },\r\n    failure: {\r\n      type: \"signal\",\r\n      displayName: \"Failure\",\r\n      group: \"Signals\",\r\n    },\r\n    error: {\r\n      type: \"string\",\r\n      displayName: \"Error\",\r\n      group: \"Error\",\r\n      getter: function () {\r\n        return this._internal.error;\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    setError: function (err: string) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty(\"error\");\r\n      this.sendSignalOnOutput(\"failure\");\r\n    },\r\n    getResultsValue: function (name: string) {\r\n      return this._internal.resultsValues[name];\r\n    },\r\n    registerOutputIfNeeded: function (name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"out-\"))\r\n        this.registerOutput(name, {\r\n          // @ts-expect-error\r\n          getter: this.getResultsValue.bind(\r\n            this,\r\n            name.substring(\"out-\".length)\r\n          ),\r\n        });\r\n    },\r\n    setParamsValue: function (name: string, value: any) {\r\n      this._internal.paramsValues[name] = value;\r\n    },\r\n    setFunctionName: function (value: string) {\r\n      this._internal.functionName = value;\r\n    },\r\n    registerInputIfNeeded: function (name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"function\")\r\n        this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setFunctionName.bind(this),\r\n        });\r\n\r\n      if (name.startsWith(\"in-\"))\r\n        this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setParamsValue.bind(this, name.substring(\"in-\".length)),\r\n        });\r\n    },\r\n    scheduleCall: function () {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledCall) {\r\n        internal.hasScheduledCall = true;\r\n        // @ts-expect-error\r\n        this.scheduleAfterInputsHaveUpdated(this.doCall.bind(this));\r\n      }\r\n    },\r\n    doCall: function () {\r\n      this._internal.hasScheduledCall = false;\r\n\r\n      const cloudServices = NoodlRuntime.instance.getMetaData(\"cloudservices\");\r\n      if (this.context.editorConnection) {\r\n        if (\r\n          cloudServices === undefined ||\r\n          cloudServices.endpoint === undefined\r\n        ) {\r\n          this.context.editorConnection.sendWarning(\r\n            // @ts-expect-error\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"cloud-function-2\",\r\n            {\r\n              message: \"No cloud services defined in this project.\",\r\n            }\r\n          );\r\n        } else if (this._internal.functionName === undefined) {\r\n          this.context.editorConnection.sendWarning(\r\n            // @ts-expect-error\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"cloud-function-2\",\r\n            {\r\n              message: \"No function specified\",\r\n            }\r\n          );\r\n        } else {\r\n          this.context.editorConnection.clearWarning(\r\n            // @ts-expect-error\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"cloud-function-2\"\r\n          );\r\n        }\r\n      }\r\n\r\n      const appId = cloudServices.appId;\r\n      // @ts-expect-error\r\n      const endpoint = this.context.editorConnection.isRunningLocally()\r\n        ? `http://${window.location.hostname}:8577`\r\n        : cloudServices.endpoint;\r\n\r\n      _makeRequest(\r\n        // @ts-expect-error\r\n        \"/functions/\" + encodeURIComponent(this._internal.functionName),\r\n        {\r\n          appId,\r\n          endpoint,\r\n          content: this._internal.paramsValues,\r\n          method: \"POST\",\r\n          success: (res) => {\r\n            if (res === undefined) {\r\n              // No result, still success\r\n\r\n              this._internal.lastCallResult = {\r\n                status: \"success\",\r\n                parameters: this._internal.paramsValues,\r\n                results: \"empty\",\r\n              };\r\n            } else {\r\n              const results = res.result || {};\r\n              for (let key in results) {\r\n                this._internal.resultsValues[key] = results[key];\r\n                if (this.hasOutput(\"out-\" + key))\r\n                  this.flagOutputDirty(\"out-\" + key);\r\n              }\r\n\r\n              this._internal.lastCallResult = {\r\n                status: \"success\",\r\n                parameters: this._internal.paramsValues,\r\n                results: this._internal.resultsValues,\r\n              };\r\n            }\r\n\r\n            this.sendSignalOnOutput(\"success\");\r\n          },\r\n          error: (e) => {\r\n            const error =\r\n              typeof e === \"string\"\r\n                ? e\r\n                : e.error || \"Failed running cloud function.\";\r\n            this._internal.lastCallResult = {\r\n              status: \"failure\",\r\n              error,\r\n            };\r\n\r\n            // @ts-expect-error\r\n            this.setError(error);\r\n          },\r\n        }\r\n      );\r\n    },\r\n  },\r\n};\r\n","import { Collection, Model, NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  collection: Collection<Model>;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"CollectionClear\",\r\n  docs: \"https://docs.noodl.net/nodes/data/array/clear-array\",\r\n  displayNodeName: \"Clear Array\",\r\n  category: \"Data\",\r\n  usePortAsLabel: \"collectionId\",\r\n  color: \"data\",\r\n  inputs: {\r\n    collectionId: {\r\n      type: {\r\n        name: \"string\",\r\n        identifierOf: \"CollectionName\",\r\n        identifierDisplayName: \"Array Ids\",\r\n      },\r\n      displayName: \"Array Id\",\r\n      group: \"General\",\r\n      set: function (value) {\r\n        if (value instanceof Collection) value = value.getId();\r\n        // Can be passed as collection as well\r\n        // @ts-expect-error\r\n        this.setCollectionID(value);\r\n      },\r\n    },\r\n    clear: {\r\n      displayName: \"Do\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue: function () {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const collection = this._internal.collection;\r\n\r\n          collection.set([]);\r\n          this.sendSignalOnOutput(\"modified\");\r\n        });\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    modified: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Done\",\r\n    },\r\n  },\r\n  methods: {\r\n    setCollectionID: function (id: string) {\r\n      // @ts-expect-error\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection: function (collection: Collection<Model>) {\r\n      this._internal.collection = collection;\r\n    },\r\n  },\r\n};\r\n","import { Collection, Model, NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  modifyId: string;\r\n  collection: Collection<Model>;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"CollectionInsert\",\r\n  docs: \"https://docs.noodl.net/nodes/data/array/insert-into-array\",\r\n  displayNodeName: \"Insert Object Into Array\",\r\n  shortDesc:\r\n    \"A collection of models, mainly used together with a For Each Node.\",\r\n  category: \"Data\",\r\n  usePortAsLabel: \"collectionId\",\r\n  color: \"data\",\r\n  inputs: {\r\n    collectionId: {\r\n      type: {\r\n        name: \"string\",\r\n        identifierOf: \"CollectionName\",\r\n        identifierDisplayName: \"Array Ids\",\r\n      },\r\n      displayName: \"Array Id\",\r\n      group: \"General\",\r\n      set(value: string | Collection<Model>) {\r\n        if (value instanceof Collection) value = value.getId();\r\n        // Can be passed as collection as well\r\n        // @ts-expect-error\r\n        this.setCollectionID(value);\r\n      },\r\n    },\r\n    modifyId: {\r\n      type: { name: \"string\", allowConnectionsOnly: true },\r\n      displayName: \"Object Id\",\r\n      group: \"Modify\",\r\n      set(value: string) {\r\n        this._internal.modifyId = value;\r\n      },\r\n    },\r\n    add: {\r\n      displayName: \"Do\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue: function () {\r\n        const internal = this._internal;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          if (this.context.editorConnection) {\r\n            this.context.editorConnection.clearWarning(\r\n              // @ts-expect-error\r\n              this.nodeScope.componentOwner.name,\r\n              this.id,\r\n              \"insert-warning\"\r\n            );\r\n          }\r\n\r\n          if (internal.modifyId === undefined) {\r\n            if (this.context.editorConnection) {\r\n              this.context.editorConnection.sendWarning(\r\n                // @ts-expect-error\r\n                this.nodeScope.componentOwner.name,\r\n                this.id,\r\n                \"insert-warning\",\r\n                {\r\n                  showGlobally: true,\r\n                  message: \"No Object Id specified\",\r\n                }\r\n              );\r\n            }\r\n            return;\r\n          }\r\n\r\n          if (internal.collection === undefined) {\r\n            if (this.context.editorConnection) {\r\n              this.context.editorConnection.sendWarning(\r\n                // @ts-expect-error\r\n                this.nodeScope.componentOwner.name,\r\n                this.id,\r\n                \"insert-warning\",\r\n                {\r\n                  showGlobally: true,\r\n                  message: \"No Array Id specified\",\r\n                }\r\n              );\r\n            }\r\n            return;\r\n          }\r\n\r\n          const model = Model.get(internal.modifyId);\r\n          internal.collection.add(model);\r\n          this.sendSignalOnOutput(\"modified\");\r\n        });\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    modified: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Done\",\r\n    },\r\n  },\r\n  methods: {\r\n    setCollectionID(id: string) {\r\n      // @ts-expect-error\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection(collection: Collection<Model>) {\r\n      this._internal.collection = collection;\r\n    },\r\n  },\r\n};\r\n","import { Collection, NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  sourceCollection: any[];\r\n  collection?: Collection<any>;\r\n  collectionId?: string;\r\n  hasScheduledNew: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"CollectionNew\",\r\n  docs: \"https://docs.noodl.net/nodes/data/array/create-new-array\",\r\n  displayNodeName: \"Create New Array\",\r\n  shortDesc:\r\n    \"A collection of models, mainly used together with a For Each Node.\",\r\n  category: \"Data\",\r\n  color: \"data\",\r\n  initialize() {},\r\n  inputs: {\r\n    new: {\r\n      displayName: \"Do\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleNew();\r\n      },\r\n    },\r\n    items: {\r\n      type: \"array\",\r\n      group: \"General\",\r\n      displayName: \"Items\",\r\n      set(value: any[]) {\r\n        this._internal.sourceCollection = value;\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: \"string\",\r\n      displayName: \"Id\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.collection\r\n          ? this._internal.collection.getId()\r\n          : this._internal.collectionId;\r\n      },\r\n    },\r\n    created: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Done\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionID(id: string) {\r\n      // @ts-expect-error\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection(collection: Collection<any>) {\r\n      this._internal.collection = collection;\r\n      this.flagOutputDirty(\"id\");\r\n    },\r\n    scheduleNew() {\r\n      // @ts-expect-error\r\n      if (this.hasScheduledNew) return;\r\n      // @ts-expect-error\r\n      this.hasScheduledNew = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.hasScheduledNew = false;\r\n\r\n        const collection = Collection.get();\r\n        if (this._internal.sourceCollection !== undefined)\r\n          collection.set(this._internal.sourceCollection);\r\n\r\n        // @ts-expect-error\r\n        this.setCollection(collection);\r\n\r\n        this.sendSignalOnOutput(\"created\");\r\n      });\r\n    },\r\n  },\r\n};\r\n","import { Model, Collection, NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  modifyId?: string;\r\n  collection?: Collection<Model>;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"CollectionRemove\",\r\n  docs: \"https://docs.noodl.net/nodes/data/array/remove-from-array\",\r\n  displayNodeName: \"Remove Object From Array\",\r\n  shortDesc:\r\n    \"A collection of models, mainly used together with a For Each Node.\",\r\n  category: \"Data\",\r\n  usePortAsLabel: \"collectionId\",\r\n  color: \"data\",\r\n  initialize: function () {},\r\n  inputs: {\r\n    collectionId: {\r\n      type: {\r\n        name: \"string\",\r\n        identifierOf: \"CollectionName\",\r\n        identifierDisplayName: \"Array Ids\",\r\n      },\r\n      displayName: \"Array Id\",\r\n      group: \"General\",\r\n      set: function (value: string | Collection<Model>) {\r\n        if (value instanceof Collection) value = value.getId();\r\n        // Can be passed as collection as well\r\n        // @ts-expect-error\r\n        this.setCollectionID(value);\r\n      },\r\n    },\r\n    modifyId: {\r\n      type: { name: \"string\", allowConnectionsOnly: true },\r\n      displayName: \"Object Id\",\r\n      group: \"Modify\",\r\n      set: function (value: string) {\r\n        this._internal.modifyId = value;\r\n      },\r\n    },\r\n    remove: {\r\n      displayName: \"Do\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue: function () {\r\n        const _this = this;\r\n        const internal = this._internal;\r\n\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          if (internal.modifyId === undefined) return;\r\n          if (internal.collection === undefined) return;\r\n\r\n          const model = Model.get(internal.modifyId);\r\n          internal.collection.remove(model);\r\n          _this.sendSignalOnOutput(\"modified\");\r\n        });\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    modified: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Done\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionID: function (id: string) {\r\n      // @ts-expect-error\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection: function (collection: Collection<Model>) {\r\n      this._internal.collection = collection;\r\n    },\r\n  },\r\n};\r\n","import { Model, Collection, NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  collectionChangedCallback: () => void;\r\n  sourceCollectionChangedCallback: () => void;\r\n  collection: Collection<Model> | undefined;\r\n  collectionId: string;\r\n  pendingSourceCollection: Collection<Model> | undefined;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Collection2\",\r\n  docs: \"https://docs.noodl.net/nodes/data/array/array-node\",\r\n  displayNodeName: \"Array\",\r\n  shortDesc:\r\n    \"A collection of models, mainly used together with a For Each Node.\",\r\n  category: \"Data\",\r\n  usePortAsLabel: \"collectionId\",\r\n  color: \"data\",\r\n  initialize() {\r\n    let collectionChangedScheduled = false;\r\n    this._internal.collectionChangedCallback = () => {\r\n      if (this.isInputConnected(\"fetch\")) return; // Ignore if we have explicit fetch connection\r\n\r\n      // Optimize by only updating outputs once\r\n      if (collectionChangedScheduled) return;\r\n      collectionChangedScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.sendSignalOnOutput(\"changed\");\r\n        this.flagOutputDirty(\"firstItemId\");\r\n        this.flagOutputDirty(\"count\");\r\n        collectionChangedScheduled = false;\r\n      });\r\n    };\r\n\r\n    // When the source collection has changed, copy items into this collection\r\n    this._internal.sourceCollectionChangedCallback = () => {\r\n      if (this.isInputConnected(\"store\")) return; // Ignore if we have explicit store connection\r\n\r\n      // @ts-expect-error\r\n      this.scheduleCopyItems();\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    const collection = this._internal.collection;\r\n    if (!collection) {\r\n      return { type: \"text\", value: \"[No Array]\" };\r\n    }\r\n\r\n    return [\r\n      {\r\n        type: \"text\",\r\n        value: \"Id: \" + collection.getId(),\r\n      },\r\n      {\r\n        type: \"value\",\r\n        value: collection.items,\r\n      },\r\n    ];\r\n  },\r\n  inputs: {\r\n    collectionId: {\r\n      type: {\r\n        name: \"string\",\r\n        identifierOf: \"CollectionName\",\r\n        identifierDisplayName: \"Array Ids\",\r\n      },\r\n      displayName: \"Id\",\r\n      group: \"General\",\r\n      set(value) {\r\n        if (value instanceof Collection) value = value.getId(); // Can be passed as collection as well\r\n        this._internal.collectionId = value; // Wait to fetch data\r\n        if (!this.isInputConnected(\"fetch\")) {\r\n          // @ts-expect-error\r\n          this.setCollectionID(value);\r\n        } else {\r\n          this.flagOutputDirty(\"id\");\r\n        }\r\n      },\r\n    },\r\n    items: {\r\n      type: \"array\",\r\n      group: \"General\",\r\n      displayName: \"Items\",\r\n      set(value) {\r\n        if (value === undefined) return;\r\n        if (value === this._internal.collection) return;\r\n\r\n        this._internal.pendingSourceCollection = value;\r\n        if (!this.isInputConnected(\"store\")) {\r\n          // Don't auto copy if we have connections to store\r\n          this.scheduleAfterInputsHaveUpdated(() => {\r\n            // @ts-expect-error\r\n            this.setSourceCollection(value);\r\n          });\r\n        }\r\n      },\r\n    },\r\n    fetch: {\r\n      displayName: \"Fetch\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleSetCollection();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    id: {\r\n      type: \"string\",\r\n      displayName: \"Id\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.collection\r\n          ? this._internal.collection.getId()\r\n          : this._internal.collectionId;\r\n      },\r\n    },\r\n    items: {\r\n      type: \"array\",\r\n      displayName: \"Items\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.collection;\r\n      },\r\n    },\r\n    firstItemId: {\r\n      type: \"string\",\r\n      displayName: \"First Item Id\",\r\n      group: \"General\",\r\n      getter() {\r\n        if (this._internal.collection) {\r\n          const firstItem = this._internal.collection.get(0);\r\n          if (firstItem !== undefined) return firstItem.getId();\r\n        }\r\n      },\r\n    },\r\n    count: {\r\n      type: \"number\",\r\n      displayName: \"Count\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.collection ? this._internal.collection.size() : 0;\r\n      },\r\n    },\r\n    changed: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n    },\r\n    fetched: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Fetched\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    setCollectionID(id: string) {\r\n      // @ts-expect-error\r\n      this.setCollection(Collection.get(id));\r\n    },\r\n    setCollection(collection: Collection<Model>) {\r\n      if (this._internal.collection) {\r\n        // Remove old listener if existing\r\n        this._internal.collection.off(\r\n          \"change\",\r\n          // @ts-expect-error\r\n          this._internal.collectionChangedCallback\r\n        );\r\n      }\r\n\r\n      this._internal.collection = collection;\r\n      this.flagOutputDirty(\"id\");\r\n      // @ts-expect-error\r\n      collection.on(\"change\", this._internal.collectionChangedCallback);\r\n\r\n      this.flagOutputDirty(\"items\");\r\n      this.flagOutputDirty(\"firstItemId\");\r\n      this.flagOutputDirty(\"count\");\r\n    },\r\n    setSourceCollection(collection: Collection<Model>) {\r\n      const internal = this._internal;\r\n\r\n      if (\r\n        // @ts-expect-error\r\n        internal.sourceCollection &&\r\n        // @ts-expect-error\r\n        internal.sourceCollection instanceof Collection\r\n      ) {\r\n        // Remove old listener if existing\r\n        // @ts-expect-error\r\n        internal.sourceCollection.off(\r\n          \"change\",\r\n          internal.sourceCollectionChangedCallback\r\n        );\r\n      }\r\n\r\n      // @ts-expect-error\r\n      internal.sourceCollection = collection;\r\n      // @ts-expect-error\r\n      if (internal.sourceCollection instanceof Collection) {\r\n        // @ts-expect-error\r\n        internal.sourceCollection.on(\r\n          \"change\",\r\n          internal.sourceCollectionChangedCallback\r\n        );\r\n      }\r\n\r\n      // @ts-expect-error\r\n      this._copySourceItems();\r\n    },\r\n    scheduleSetCollection() {\r\n      // @ts-expect-error\r\n      if (this.hasScheduledSetCollection) return;\r\n      // @ts-expect-error\r\n      this.hasScheduledSetCollection = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.hasScheduledSetCollection = false;\r\n        // @ts-expect-error\r\n        this.setCollectionID(this._internal.collectionId);\r\n        this.sendSignalOnOutput(\"fetched\");\r\n      });\r\n    },\r\n    scheduleStore() {\r\n      // @ts-expect-error\r\n      if (this.hasScheduledStore) return;\r\n      // @ts-expect-error\r\n      this.hasScheduledStore = true;\r\n\r\n      const internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.hasScheduledStore = false;\r\n        // @ts-expect-error\r\n        this.setSourceCollection(internal.pendingSourceCollection);\r\n      });\r\n    },\r\n    _copySourceItems() {\r\n      const internal = this._internal;\r\n\r\n      if (\r\n        internal.collection === undefined &&\r\n        !this.isInputConnected(\"fetch\")\r\n      ) {\r\n        // @ts-expect-error\r\n        this.setCollection(Collection.get());\r\n      }\r\n      // @ts-expect-error\r\n      internal.collection && internal.collection.set(internal.sourceCollection);\r\n    },\r\n    scheduleCopyItems() {\r\n      // @ts-expect-error\r\n      if (this.hasScheduledCopyItems) return;\r\n      // @ts-expect-error\r\n      this.hasScheduledCopyItems = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.hasScheduledCopyItems = false;\r\n        // @ts-expect-error\r\n        this._copySourceItems();\r\n      });\r\n    },\r\n    _onNodeDeleted() {\r\n      // @ts-expect-error\r\n      Node.prototype._onNodeDeleted.call(this);\r\n\r\n      if (this._internal.collection) {\r\n        // Remove old listener if existing\r\n        this._internal.collection.off(\r\n          \"change\",\r\n          // @ts-expect-error\r\n          this._internal.collectionChangedCallback\r\n        );\r\n      }\r\n    },\r\n  },\r\n};\r\n","import {\r\n  Node,\r\n  Model,\r\n  createSetter,\r\n  Collection,\r\n  NodeDefinition,\r\n} from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  collectionChangedCallback: () => void;\r\n  enabled: boolean;\r\n  filterSettings: Record<string, any>;\r\n  filteredCollection?: Collection<Model>;\r\n  collection?: Collection<Model>;\r\n  collectionChangedScheduled?: boolean;\r\n}\r\n\r\nconst applyFilter = (\r\n  item: Record<string, any>,\r\n  filter: Record<string, any>\r\n): boolean => {\r\n  for (const key in filter) {\r\n    const op = filter[key];\r\n\r\n    if (op[\"$neq\"] !== undefined) {\r\n      if (!(item[key] != op[\"$neq\"])) return false;\r\n    } else if (item[key] === undefined) return false;\r\n    else if (op[\"$eq\"] !== undefined && !(item[key] == op[\"$eq\"])) return false;\r\n    else if (op[\"$gt\"] !== undefined && !(item[key] > op[\"$gt\"])) return false;\r\n    else if (op[\"$lt\"] !== undefined && !(item[key] < op[\"$lt\"])) return false;\r\n    else if (op[\"$gte\"] !== undefined && !(item[key] >= op[\"$gte\"]))\r\n      return false;\r\n    else if (op[\"$lte\"] !== undefined && !(item[key] <= op[\"$lte\"]))\r\n      return false;\r\n    else if (op[\"$regex\"] !== undefined) {\r\n      const a = item[key] + \"\"; // Convert to string\r\n      const regex = new RegExp(\r\n        op[\"$regex\"],\r\n        op[\"$case\"] !== true ? \"i\" : undefined\r\n      );\r\n      if (!regex.test(a)) return false;\r\n    }\r\n  }\r\n  return true;\r\n};\r\n\r\nconst sorter = function (this: Record<string, number>, a: any, b: any): number {\r\n  if (a instanceof Model) a = a.data;\r\n  if (b instanceof Model) b = b.data;\r\n\r\n  for (const key in this) {\r\n    const _a = a[key];\r\n    const _b = b[key];\r\n    if (_a !== _b) {\r\n      if (typeof _a === \"string\" && typeof _b === \"string\") {\r\n        return this[key] === 1 ? (_a > _b ? 1 : -1) : _a > _b ? -1 : 1;\r\n      } else if (typeof _a === \"number\" && typeof _b === \"number\") {\r\n        return this[key] === 1 ? _a - _b : _b - _a;\r\n      } else {\r\n        return this[key] === 1 ? (_a > _b ? 1 : -1) : _a > _b ? -1 : 1;\r\n      }\r\n    }\r\n  }\r\n  return 0;\r\n};\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Filter Collection\",\r\n  docs: \"https://docs.noodl.net/nodes/data/array/array-filter\",\r\n  displayNodeName: \"Array Filter\",\r\n  shortDesc: \"Filter, sort and limit array\",\r\n  category: \"Data\",\r\n  color: \"data\",\r\n  initialize: function () {\r\n    this._internal.collectionChangedCallback = () => {\r\n      if (this.isInputConnected(\"filter\") === true) return;\r\n      // @ts-expect-error\r\n      this.scheduleFilter();\r\n    };\r\n\r\n    this._internal.enabled = true;\r\n    this._internal.filterSettings = {};\r\n  },\r\n  getInspectInfo() {\r\n    const collection = this._internal.filteredCollection;\r\n\r\n    if (!collection) {\r\n      return { type: \"text\", value: \"[Not executed yet]\" };\r\n    }\r\n\r\n    return [\r\n      {\r\n        type: \"text\",\r\n        value: \"Id: \" + collection.getId(),\r\n      },\r\n      {\r\n        type: \"value\",\r\n        value: collection.items,\r\n      },\r\n    ];\r\n  },\r\n  inputs: {\r\n    items: {\r\n      type: \"array\",\r\n      displayName: \"Items\",\r\n      group: \"General\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this.bindCollection(value);\r\n        // @ts-expect-error\r\n        if (!this.isInputConnected(\"filter\")) this.scheduleFilter();\r\n      },\r\n    },\r\n    enabled: {\r\n      type: \"boolean\",\r\n      group: \"General\",\r\n      displayName: \"Enabled\",\r\n      default: true,\r\n      set: function (value) {\r\n        this._internal.enabled = value;\r\n        // @ts-expect-error\r\n        if (!this.isInputConnected(\"filter\")) this.scheduleFilter();\r\n      },\r\n    },\r\n    filter: {\r\n      type: \"signal\",\r\n      group: \"Actions\",\r\n      displayName: \"Filter\",\r\n      valueChangedToTrue: function () {\r\n        // @ts-expect-error\r\n        this.scheduleFilter();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    items: {\r\n      type: \"array\",\r\n      displayName: \"Items\",\r\n      group: \"General\",\r\n      getter: function () {\r\n        return this._internal.filteredCollection;\r\n      },\r\n    },\r\n    firstItemId: {\r\n      type: \"string\",\r\n      displayName: \"First Item Id\",\r\n      group: \"General\",\r\n      getter: function () {\r\n        if (this._internal.filteredCollection !== undefined) {\r\n          const firstItem = this._internal.filteredCollection.get(0);\r\n          if (firstItem !== undefined) return firstItem.getId();\r\n        }\r\n      },\r\n    },\r\n    count: {\r\n      type: \"number\",\r\n      displayName: \"Count\",\r\n      group: \"General\",\r\n      getter: function () {\r\n        return this._internal.filteredCollection\r\n          ? this._internal.filteredCollection.size()\r\n          : 0;\r\n      },\r\n    },\r\n    modified: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Filtered\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    unbindCurrentCollection: function () {\r\n      const collection = this._internal.collection;\r\n      if (!collection) return;\r\n      // @ts-expect-error\r\n      collection.off(\"change\", this._internal.collectionChangedCallback);\r\n      this._internal.collection = undefined;\r\n    },\r\n    bindCollection: function (collection: Collection<Model>) {\r\n      // @ts-expect-error\r\n      this.unbindCurrentCollection();\r\n      this._internal.collection = collection;\r\n      collection &&\r\n        // @ts-expect-error\r\n        collection.on(\"change\", this._internal.collectionChangedCallback);\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      // @ts-expect-error\r\n      this.unbindCurrentCollection();\r\n    },\r\n    // @ts-expect-error\r\n    getFilter: function () {\r\n      const filterSettings = this._internal.filterSettings;\r\n      const options = [\"case\"];\r\n\r\n      if (filterSettings[\"filterFilter\"]) {\r\n        const filters = filterSettings[\"filterFilter\"].split(\",\");\r\n        const _filter: Record<string, any> = {};\r\n        filters.forEach((f) => {\r\n          const op = \"$\" + (filterSettings[\"filterFilterOp-\" + f] || \"eq\");\r\n          _filter[f] = {};\r\n          _filter[f][op] = filterSettings[\"filterFilterValue-\" + f];\r\n\r\n          options.forEach((o) => {\r\n            const option = filterSettings[\"filterFilterOption-\" + o + \"-\" + f];\r\n            if (option) _filter[f][\"$\" + o] = option;\r\n          });\r\n        });\r\n        return _filter;\r\n      }\r\n    },\r\n    // @ts-expect-error\r\n    getSort: function () {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      if (filterSettings[\"filterSort\"]) {\r\n        const sort = filterSettings[\"filterSort\"].split(\",\");\r\n        const _sort: Record<string, number> = {};\r\n        sort.forEach((s) => {\r\n          _sort[s] =\r\n            filterSettings[\"filterSort-\" + s] === \"descending\" ? -1 : 1;\r\n        });\r\n        return _sort;\r\n      }\r\n    },\r\n    getLimit: function () {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      if (!filterSettings[\"filterEnableLimit\"]) return;\r\n      return filterSettings[\"filterLimit\"] || 10;\r\n    },\r\n    getSkip: function () {\r\n      const filterSettings = this._internal.filterSettings;\r\n\r\n      if (!filterSettings[\"filterEnableLimit\"]) return;\r\n      return filterSettings[\"filterSkip\"] || 0;\r\n    },\r\n    scheduleFilter: function () {\r\n      // @ts-expect-error\r\n      if (this.collectionChangedScheduled) return;\r\n      // @ts-expect-error\r\n      this.collectionChangedScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.collectionChangedScheduled = false;\r\n        if (!this._internal.collection) return;\r\n\r\n        // @ts-expect-error\r\n        let filtered = [].concat(this._internal.collection.items);\r\n\r\n        if (this._internal.enabled) {\r\n          // @ts-expect-error\r\n          const filter = this.getFilter();\r\n          if (filter)\r\n            // @ts-expect-error\r\n            filtered = filtered.filter((m) => applyFilter(m.data, filter));\r\n\r\n          // @ts-expect-error\r\n          const sort = this.getSort();\r\n          if (sort) filtered.sort(sorter.bind(sort));\r\n\r\n          // @ts-expect-error\r\n          const skip = this.getSkip();\r\n          if (skip) filtered = filtered.slice(skip, filtered.length);\r\n\r\n          // @ts-expect-error\r\n          const limit = this.getLimit();\r\n          if (limit) filtered = filtered.slice(0, limit);\r\n        }\r\n\r\n        this._internal.filteredCollection = Collection.create(filtered);\r\n\r\n        this.sendSignalOnOutput(\"modified\");\r\n        this.flagOutputDirty(\"firstItemId\");\r\n        this.flagOutputDirty(\"items\");\r\n        this.flagOutputDirty(\"count\");\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      this.registerInput(name, {\r\n        set: userInputSetter.bind(this, name),\r\n      });\r\n    },\r\n  },\r\n};\r\n\r\nfunction userInputSetter(name: string, value: any) {\r\n  // @ts-expect-error\r\n  this._internal.filterSettings[name] = value;\r\n  // @ts-expect-error\r\n  if (!this.isInputConnected(\"filter\")) this.scheduleFilter();\r\n}\r\n\r\nfunction updatePorts(\r\n  nodeId: string,\r\n  parameters: Record<string, any>,\r\n  editorConnection: any,\r\n  dbCollections: any\r\n) {\r\n  const ports: any[] = [];\r\n\r\n  ports.push({\r\n    type: \"boolean\",\r\n    plug: \"input\",\r\n    group: \"Limit\",\r\n    name: \"filterEnableLimit\",\r\n    displayName: \"Use limit\",\r\n  });\r\n\r\n  if (parameters[\"filterEnableLimit\"]) {\r\n    ports.push({\r\n      type: \"number\",\r\n      default: 10,\r\n      plug: \"input\",\r\n      group: \"Limit\",\r\n      name: \"filterLimit\",\r\n      displayName: \"Limit\",\r\n    });\r\n\r\n    ports.push({\r\n      type: \"number\",\r\n      default: 0,\r\n      plug: \"input\",\r\n      group: \"Limit\",\r\n      name: \"filterSkip\",\r\n      displayName: \"Skip\",\r\n    });\r\n  }\r\n\r\n  ports.push({\r\n    type: { name: \"stringlist\", allowEditOnly: true },\r\n    plug: \"input\",\r\n    group: \"Filter\",\r\n    name: \"filterFilter\",\r\n    displayName: \"Filter\",\r\n  });\r\n\r\n  ports.push({\r\n    type: { name: \"stringlist\", allowEditOnly: true },\r\n    plug: \"input\",\r\n    group: \"Sort\",\r\n    name: \"filterSort\",\r\n    displayName: \"Sort\",\r\n  });\r\n\r\n  const filterOps = {\r\n    string: [\r\n      { value: \"eq\", label: \"Equals\" },\r\n      { value: \"neq\", label: \"Not Equals\" },\r\n      { value: \"regex\", label: \"Matches RegEx\" },\r\n    ],\r\n    boolean: [\r\n      { value: \"eq\", label: \"Equals\" },\r\n      { value: \"neq\", label: \"Not Equals\" },\r\n    ],\r\n    number: [\r\n      { value: \"eq\", label: \"Equals\" },\r\n      { value: \"neq\", label: \"Not Equals\" },\r\n      { value: \"lt\", label: \"Less than\" },\r\n      { value: \"gt\", label: \"Greater than\" },\r\n      { value: \"gte\", label: \"Greater than or equal\" },\r\n      { value: \"lte\", label: \"Less than or equal\" },\r\n    ],\r\n  };\r\n\r\n  if (parameters[\"filterFilter\"]) {\r\n    const filters = parameters[\"filterFilter\"].split(\",\");\r\n    filters.forEach((f) => {\r\n      ports.push({\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { value: \"string\", label: \"String\" },\r\n            { value: \"number\", label: \"Number\" },\r\n            { value: \"boolean\", label: \"Boolean\" },\r\n          ],\r\n        },\r\n        default: \"string\",\r\n        plug: \"input\",\r\n        group: f + \" filter\",\r\n        displayName: \"Type\",\r\n        editorName: f + \" filter | Type\",\r\n        name: \"filterFilterType-\" + f,\r\n      });\r\n\r\n      const type = parameters[\"filterFilterType-\" + f];\r\n\r\n      ports.push({\r\n        type: { name: \"enum\", enums: filterOps[type || \"string\"] },\r\n        default: \"eq\",\r\n        plug: \"input\",\r\n        group: f + \" filter\",\r\n        displayName: \"Op\",\r\n        editorName: f + \" filter| Op\",\r\n        name: \"filterFilterOp-\" + f,\r\n      });\r\n\r\n      if (parameters[\"filterFilterOp-\" + f] === \"regex\") {\r\n        ports.push({\r\n          type: \"boolean\",\r\n          default: false,\r\n          plug: \"input\",\r\n          group: f + \" filter\",\r\n          displayName: \"Case sensitive\",\r\n          editorName: f + \" filter| Case\",\r\n          name: \"filterFilterOption-case-\" + f,\r\n        });\r\n      }\r\n\r\n      ports.push({\r\n        type: type || \"string\",\r\n        plug: \"input\",\r\n        group: f + \" filter\",\r\n        displayName: \"Value\",\r\n        editorName: f + \" Filter Value\",\r\n        name: \"filterFilterValue-\" + f,\r\n      });\r\n    });\r\n  }\r\n\r\n  if (parameters[\"filterSort\"]) {\r\n    const filters = parameters[\"filterSort\"].split(\",\");\r\n    filters.forEach((f) => {\r\n      ports.push({\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { value: \"ascending\", label: \"Ascending\" },\r\n            { value: \"descending\", label: \"Descending\" },\r\n          ],\r\n        },\r\n        default: \"ascending\",\r\n        plug: \"input\",\r\n        group: f + \" sort\",\r\n        displayName: \"Sort\",\r\n        editorName: f + \" sorting\",\r\n        name: \"filterSort-\" + f,\r\n      });\r\n    });\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nexport function setup(context: any, graphModel: any) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  graphModel.on(\"nodeAdded.Filter Collection\", function (node: any) {\r\n    updatePorts(\r\n      node.id,\r\n      node.parameters,\r\n      context.editorConnection,\r\n      graphModel.getMetaData(\"dbCollections\")\r\n    );\r\n\r\n    node.on(\"parameterUpdated\", function (event: any) {\r\n      if (event.name.startsWith(\"filter\")) {\r\n        updatePorts(\r\n          node.id,\r\n          node.parameters,\r\n          context.editorConnection,\r\n          graphModel.getMetaData(\"dbCollections\")\r\n        );\r\n      }\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.dbCollections\", function (data: any) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n    });\r\n  });\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport NoodlRuntime, {\r\n  Model,\r\n  NodeModel,\r\n  Node,\r\n  Collection,\r\n  guid,\r\n} from \"@fluxscape/runtime\";\r\nimport { ReactNodeDefinition } from \"../../../ReactNodeDefinition\";\r\n\r\nconst ForEachComponent: React.FC<{\r\n  didMount: () => void;\r\n  willUnmount: () => void;\r\n}> = (props) => {\r\n  const { didMount, willUnmount } = props;\r\n\r\n  useEffect(() => {\r\n    didMount();\r\n    return () => {\r\n      willUnmount();\r\n    };\r\n  }, [didMount, willUnmount]);\r\n\r\n  return null;\r\n};\r\n\r\nconst defaultDynamicScript =\r\n  \"// Set the 'component' variable to the name of the desired component for this item.\\n\" +\r\n  \"// Component name must start with a '/'.\\n\" +\r\n  \"// A component in a sheet is referred to by '/#Sheet Name/Comopnent Name'.\\n\" +\r\n  \"// The data for each item is available in a variable called 'item'\\n\" +\r\n  \"component = '/MyComponent';\";\r\n\r\ninterface Internal {\r\n  itemNodes: any[];\r\n  itemOutputSignals: any;\r\n  itemOutputs: any;\r\n  collection: Collection<Model>;\r\n  queuedOperations: any[];\r\n  mountedOperations: any[];\r\n  target?: any;\r\n  items?: any;\r\n  templateType?: any;\r\n  template?: any;\r\n  templateFunction?: any;\r\n  itemActionItemId?: any;\r\n  hasScheduledRefresh?: any;\r\n  onItemsCollectionChanged?: any;\r\n  inputMapFunc?: any;\r\n  itemActionParameters?: any;\r\n  hasScheduledCopyItems?: any;\r\n  itemActionSignal?: any;\r\n  hasScheduledTriggerItemOutputSignal?: any;\r\n  inputMappingScript?: any;\r\n}\r\n\r\nconst ForEachDefinition: ReactNodeDefinition<Internal> = {\r\n  name: \"For Each\",\r\n  displayNodeName: \"Repeater\",\r\n  docs: \"https://docs.noodl.net/nodes/ui-controls/repeater\",\r\n  color: \"visual\",\r\n  category: \"Visual\",\r\n  dynamicports: [\r\n    {\r\n      name: \"conditionalports/extended\",\r\n      condition: \"templateType = explicit OR templateType NOT SET\",\r\n      inputs: [\"template\"],\r\n    },\r\n    {\r\n      name: \"conditionalports/extended\",\r\n      condition: \"templateType = dynamic\",\r\n      inputs: [\"templateScript\"],\r\n    },\r\n  ],\r\n  initialize() {\r\n    this._internal.itemNodes = [];\r\n    this._internal.itemOutputSignals = {};\r\n    this._internal.itemOutputs = {};\r\n    this._internal.collection = Collection.get(); // We keep an internal collection so we don't have to refresh all content if the input items collection changes\r\n    this._internal.queuedOperations = [];\r\n    this._internal.mountedOperations = [];\r\n\r\n    // Add an item\r\n    this._internal.collection.on(\"add\", async (args) => {\r\n      if (!this._internal.target) return;\r\n\r\n      // @ts-expect-error\r\n      this._queueOperation(async () => {\r\n        const baseIndex = this._internal.target.getChildren().indexOf(this) + 1;\r\n        // @ts-expect-error\r\n        await this.addItem(args.item, baseIndex + args.index);\r\n      });\r\n    });\r\n\r\n    // Remove an item\r\n    // @ts-expect-error\r\n    this._internal.collection.on(\"remove\", (args) => {\r\n      // @ts-expect-error\r\n      this._queueOperation(() => {\r\n        // @ts-expect-error\r\n        this.removeItem(args.item);\r\n      });\r\n    });\r\n\r\n    // On collection changed\r\n    this._internal.onItemsCollectionChanged = () => {\r\n      const repeaterDisabledWhenUnmounted =\r\n        NoodlRuntime.instance.getProjectSettings()\r\n          .repeaterDisabledWhenUnmounted;\r\n\r\n      // @ts-expect-error\r\n      if (repeaterDisabledWhenUnmounted && !this.isMounted) {\r\n        this._internal.mountedOperations.push(() => {\r\n          this._internal.collection.set(this._internal.items);\r\n        });\r\n      } else {\r\n        // @ts-expect-error\r\n        this._queueOperation(() => {\r\n          this._internal.collection.set(this._internal.items);\r\n        });\r\n      }\r\n    };\r\n\r\n    this.addDeleteListener(() => {\r\n      // @ts-expect-error\r\n      this._deleteAllItemNodes();\r\n    });\r\n  },\r\n  inputs: {\r\n    items: {\r\n      group: \"Data\",\r\n      displayName: \"Items\",\r\n      type: \"array\",\r\n      set(value) {\r\n        if (!value) return;\r\n        if (value === this._internal.items) return;\r\n        // @ts-expect-error\r\n        this.bindCollection(value);\r\n        //this.scheduleRefresh();\r\n      },\r\n    },\r\n    templateType: {\r\n      group: \"Appearance\",\r\n      displayName: \"Template Type\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Explicit\", value: \"explicit\" },\r\n          { label: \"Dynamic\", value: \"dynamic\" },\r\n        ],\r\n      },\r\n      default: \"explicit\",\r\n      set(value) {\r\n        this._internal.templateType = value;\r\n        // @ts-expect-error\r\n        this.scheduleRefresh();\r\n      },\r\n    },\r\n    template: {\r\n      type: \"component\",\r\n      displayName: \"Template\",\r\n      group: \"Appearance\",\r\n      set(value) {\r\n        this._internal.template = value;\r\n        // @ts-expect-error\r\n        this.scheduleRefresh();\r\n      },\r\n    },\r\n    templateScript: {\r\n      type: { name: \"string\", codeeditor: \"javascript\", allowEditOnly: true },\r\n      displayName: \"Script\",\r\n      group: \"Appearance\",\r\n      default: defaultDynamicScript,\r\n      set(value) {\r\n        try {\r\n          this._internal.templateFunction = new Function(\r\n            \"item\",\r\n            \"var component;\" + value + \";return component;\"\r\n          );\r\n        } catch (e) {\r\n          console.log(e);\r\n          if (this.context.editorConnection) {\r\n            this.context.editorConnection.sendWarning(\r\n              // @ts-expect-error\r\n              this.nodeScope.componentOwner.name,\r\n              this.id,\r\n              \"foreach-syntax-warning\",\r\n              // @ts-expect-error\r\n              { message: \"<strong>Syntax</strong>: \" + e.message }\r\n            );\r\n          }\r\n        }\r\n        // @ts-expect-error\r\n        this.scheduleRefresh();\r\n      },\r\n    },\r\n    refresh: {\r\n      group: \"Appearance\",\r\n      displayName: \"Refresh\",\r\n      type: \"signal\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleRefresh();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    itemActionItemId: {\r\n      type: \"string\",\r\n      group: \"Actions\",\r\n      displayName: \"Item Id\",\r\n      getter() {\r\n        return this._internal.itemActionItemId;\r\n      },\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    updateTarget(targetId) {\r\n      this._internal.target = targetId\r\n        ? // @ts-expect-error\r\n          this.nodeScope.getNodeWithId(targetId)\r\n        : undefined;\r\n      // @ts-expect-error\r\n      this.scheduleRefresh();\r\n    },\r\n    setNodeModel(nodeModel: NodeModel) {\r\n      Node.prototype.setNodeModel.call(this, nodeModel);\r\n      if (nodeModel.parent) {\r\n        // @ts-expect-error\r\n        this.updateTarget(nodeModel.parent.id);\r\n      }\r\n      var self = this;\r\n      nodeModel.on(\r\n        \"parentUpdated\",\r\n        function (newParent) {\r\n          // @ts-expect-error\r\n          self.updateTarget(newParent ? newParent.id : undefined);\r\n        },\r\n        this\r\n      );\r\n    },\r\n    scheduleRefresh() {\r\n      var _this = this;\r\n      var internal = this._internal;\r\n      if (!internal.hasScheduledRefresh) {\r\n        internal.hasScheduledRefresh = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          // @ts-expect-error\r\n          this._queueOperation(() => {\r\n            // @ts-expect-error\r\n            this.refresh();\r\n          });\r\n        });\r\n      }\r\n    },\r\n    unbindCurrentCollection() {\r\n      var collection = this._internal.items;\r\n      if (!collection) return;\r\n\r\n      Collection.instanceOf(collection) &&\r\n        collection.off(\"change\", this._internal.onItemsCollectionChanged);\r\n      this._internal.items = undefined;\r\n    },\r\n    bindCollection(collection) {\r\n      var internal = this._internal;\r\n\r\n      // @ts-expect-error\r\n      this.unbindCurrentCollection();\r\n\r\n      Collection.instanceOf(collection) &&\r\n        collection.on(\"change\", this._internal.onItemsCollectionChanged);\r\n\r\n      internal.items = collection;\r\n      // @ts-expect-error\r\n      this.scheduleCopyItems();\r\n    },\r\n    getTemplateForModel(model) {\r\n      var internal = this._internal;\r\n      if (\r\n        internal.templateType === undefined ||\r\n        internal.templateType === \"explicit\"\r\n      )\r\n        return internal.template;\r\n\r\n      if (!internal.templateFunction) return;\r\n      try {\r\n        var template = internal.templateFunction(model);\r\n      } catch (e) {\r\n        console.log(e);\r\n        if (this.context.editorConnection) {\r\n          this.context.editorConnection.sendWarning(\r\n            // @ts-expect-error\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"foreach-dynamic-warning\",\r\n            // @ts-expect-error\r\n            { message: \"<strong>Dynamic template</strong>: \" + e.message }\r\n          );\r\n        }\r\n      }\r\n\r\n      //simple (and limited) way to support ./ and ../ at the start of component template names\r\n      if (template) {\r\n        if (template.startsWith(\"./\")) {\r\n          // @ts-expect-error\r\n          template = this.model.component.name + template.substring(1);\r\n        }\r\n\r\n        if (template.startsWith(\"../\")) {\r\n          // @ts-expect-error\r\n          const pathParts = this.model.component.name.split(\"/\");\r\n          const parentPath = pathParts.slice(0, pathParts.length - 1).join(\"/\");\r\n          template = parentPath + template.substring(2);\r\n        }\r\n      }\r\n\r\n      return template;\r\n    },\r\n    _mapInputs(itemNode, model) {\r\n      if (this._internal.inputMapFunc !== undefined) {\r\n        // We have a mapping function, run the function and use the mapped values\r\n        // as inputs\r\n        this._internal.inputMapFunc(function (mappings) {\r\n          for (var key in mappings) {\r\n            if (itemNode.hasInput(key)) {\r\n              if (typeof mappings[key] === \"function\") {\r\n                itemNode.setInputValue(key, mappings[key](model));\r\n              } else if (typeof mappings[key] === \"string\") {\r\n                itemNode.setInputValue(key, model.get(mappings[key]));\r\n              }\r\n            }\r\n          }\r\n        }, model);\r\n      }\r\n    },\r\n    // @ts-expect-error\r\n    addItem: async function (model, index) {\r\n      var internal = this._internal;\r\n\r\n      // Create a new component for this item\r\n      // @ts-expect-error\r\n      var template = this.getTemplateForModel(model);\r\n      if (!template) return;\r\n\r\n      // @ts-expect-error\r\n      var itemNode = await this.nodeScope.createNode(template, guid(), {\r\n        _forEachModel: model,\r\n        _forEachNode: this,\r\n      });\r\n\r\n      // Set input values for all model data, and track changes\r\n      if (this._internal.inputMapFunc === undefined) {\r\n        //set component inputs with values from model\r\n        if (itemNode.hasInput(\"Id\")) {\r\n          itemNode.setInputValue(\"Id\", model.getId());\r\n        }\r\n        if (itemNode.hasInput(\"id\")) {\r\n          itemNode.setInputValue(\"id\", model.getId());\r\n        }\r\n\r\n        for (var inputKey in itemNode._inputs) {\r\n          if (model.data[inputKey] !== undefined)\r\n            itemNode.setInputValue(inputKey, model.data[inputKey]);\r\n        }\r\n\r\n        //listen to changes on model\r\n        itemNode._forEachModelChangeListener = function (ev) {\r\n          if (itemNode._inputs[ev.name])\r\n            itemNode.setInputValue(ev.name, ev.value);\r\n        };\r\n        model.on(\"change\", itemNode._forEachModelChangeListener);\r\n\r\n        //listen to changes to the component inputs\r\n        itemNode.componentModel.on(\r\n          \"inputPortAdded\",\r\n          (port) => {\r\n            if (port.name === \"id\") itemNode.setInputValue(\"id\", model.getId());\r\n            if (port.name === \"Id\") itemNode.setInputValue(\"Id\", model.getId());\r\n\r\n            if (model.data[port.name] !== undefined) {\r\n              itemNode.setInputValue(port.name, model.data[port.name]);\r\n            }\r\n          },\r\n          this\r\n        );\r\n      } else {\r\n        // If there is a map script, then use it\r\n        // @ts-expect-error\r\n        this._mapInputs(itemNode, model);\r\n        itemNode._forEachModelChangeListener = () =>\r\n          // @ts-expect-error\r\n          this._mapInputs(itemNode, model);\r\n        model.on(\"change\", itemNode._forEachModelChangeListener);\r\n      }\r\n\r\n      // Create connections for all item output signals that we should forward\r\n      itemNode._internal.creatorCallbacks = {\r\n        onOutputChanged: (name, value, oldValue) => {\r\n          if (\r\n            (oldValue === false || oldValue === undefined) &&\r\n            value === true &&\r\n            internal.itemOutputSignals[name]\r\n          ) {\r\n            // @ts-expect-error\r\n            this.itemOutputSignalTriggered(name, model, itemNode);\r\n          }\r\n        },\r\n      };\r\n\r\n      // Connect all model nodes of the component that have id type = instance\r\n      /*var itemScopes = itemNode.nodeScope.getNodesWithType('Model')\r\n      if(itemScopes && itemScopes.length>0) {\r\n        for(var j = 0; j < itemScopes.length; j++) {\r\n          itemScopes[j].hasInstanceIDType()&&itemScopes[j].setModel(model);\r\n        }\r\n      }*/\r\n\r\n      // If there is a for each actions node, signal that the item has been added\r\n      var forEachActions =\r\n        itemNode.nodeScope.getNodesWithType(\"For Each Actions\");\r\n      for (var j = 0; j < forEachActions.length; j++) {\r\n        forEachActions[j].signalAdded();\r\n      }\r\n\r\n      internal.itemNodes.push(itemNode);\r\n      internal.target.addChild(itemNode, index);\r\n    },\r\n    removeItem(model) {\r\n      var internal = this._internal;\r\n      if (!internal.target) return;\r\n\r\n      function findChild() {\r\n        var children = internal.target.getChildren();\r\n        for (var i in children) {\r\n          var c = children[i];\r\n          if (c._forEachModel === model && !c._forEachRemoveInProgress)\r\n            return c;\r\n        }\r\n      }\r\n      var child = findChild();\r\n      if (!child) return;\r\n\r\n      var forEachActions = child.nodeScope.getNodesWithType(\"For Each Actions\");\r\n      if (forEachActions && forEachActions.length > 0) {\r\n        // Run a try remove on the for each actions, remove the child when completed\r\n        child._forEachRemoveInProgress = true;\r\n        // @ts-expect-error\r\n        forEachActions[0].tryRemove(() => this._deleteItem(child));\r\n      } else {\r\n        // There are no for each actions, just remove the item\r\n        // @ts-expect-error\r\n        this._deleteItem(child);\r\n      }\r\n\r\n      var idx = internal.itemNodes.indexOf(child);\r\n      idx !== -1 && internal.itemNodes.splice(idx, 1);\r\n    },\r\n    _deleteItem(item) {\r\n      item._forEachModel.off(\"change\", item._forEachModelChangeListener);\r\n\r\n      item.model && item.model.removeListenersWithRef(this);\r\n      item.componentModel && item.componentModel.removeListenersWithRef(this);\r\n\r\n      const parent = item.parent;\r\n      if (item._deleted || !parent) return;\r\n\r\n      parent.removeChild(item);\r\n      // @ts-expect-error\r\n      this.nodeScope.deleteNode(item);\r\n    },\r\n    _deleteAllItemNodes() {\r\n      if (!this._internal.itemNodes) return;\r\n\r\n      for (const itemNode of this._internal.itemNodes) {\r\n        // @ts-expect-error\r\n        this._deleteItem(itemNode);\r\n      }\r\n\r\n      this._internal.itemNodes = [];\r\n    },\r\n    // @ts-expect-error\r\n    refresh: async function () {\r\n      var internal = this._internal;\r\n      internal.hasScheduledRefresh = false;\r\n      if (!(internal.template || internal.templateFunction) || !internal.items)\r\n        return;\r\n\r\n      // @ts-expect-error\r\n      this._deleteAllItemNodes();\r\n\r\n      //check if we have a target to add nodes to\r\n      if (!internal.target) return;\r\n\r\n      // figure out our index in our target\r\n      const baseIndex = this._internal.target.getChildren().indexOf(this) + 1;\r\n\r\n      // Iterate over all models and create items\r\n      for (var i = 0; i < internal.collection.size(); i++) {\r\n        var model = internal.collection.get(i);\r\n\r\n        // @ts-expect-error\r\n        await this.addItem(model, baseIndex + i);\r\n      }\r\n    },\r\n    _queueOperation(op) {\r\n      this._internal.queuedOperations.push(op);\r\n      // @ts-expect-error\r\n      this._runQueueOperations();\r\n    },\r\n    // @ts-expect-error\r\n    async _runQueueOperations() {\r\n      // @ts-expect-error\r\n      if (this.runningOperations) {\r\n        return;\r\n      }\r\n      // @ts-expect-error\r\n      this.runningOperations = true;\r\n\r\n      const repeaterCreateComponentsAsync =\r\n        NoodlRuntime.instance.getProjectSettings()\r\n          .repeaterCreateComponentsAsync;\r\n\r\n      if (repeaterCreateComponentsAsync) {\r\n        //create items in chunks of roughly 25ms at a time\r\n        //so basically trying to keep ~30 fps\r\n        const runOps = async () => {\r\n          const start = performance.now();\r\n\r\n          while (\r\n            this._internal.queuedOperations.length &&\r\n            performance.now() - start < 25\r\n          ) {\r\n            const op = this._internal.queuedOperations.shift();\r\n            await op();\r\n          }\r\n\r\n          if (this._internal.queuedOperations.length) {\r\n            setTimeout(runOps, 0);\r\n          } else {\r\n            // @ts-expect-error\r\n            this.runningOperations = false;\r\n          }\r\n        };\r\n\r\n        runOps();\r\n      } else {\r\n        while (this._internal.queuedOperations.length) {\r\n          const op = this._internal.queuedOperations.shift();\r\n          await op();\r\n        }\r\n\r\n        // @ts-expect-error\r\n        this.runningOperations = false;\r\n      }\r\n    },\r\n    _onNodeDeleted() {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this._internal.queuedOperations.length = 0; //delete all queued operations\r\n      // @ts-expect-error\r\n      this.unbindCurrentCollection();\r\n    },\r\n    // @ts-expect-error\r\n    render() {\r\n      return (\r\n        <ForEachComponent\r\n          key={this.id}\r\n          // @ts-expect-error\r\n          didMount={() => this.didMount()}\r\n          // @ts-expect-error\r\n          willUnmount={() => this.willUnmount()}\r\n        />\r\n      );\r\n    },\r\n    didMount() {\r\n      // @ts-expect-error\r\n      this.isMounted = true;\r\n\r\n      for (const op of this._internal.mountedOperations) {\r\n        // @ts-expect-error\r\n        this._queueOperation(op);\r\n      }\r\n      this._internal.mountedOperations = [];\r\n    },\r\n    willUnmount() {\r\n      // @ts-expect-error\r\n      this.isMounted = false;\r\n    },\r\n    getItemActionParameter(name) {\r\n      if (!this._internal.itemActionParameters) return;\r\n      return this._internal.itemActionParameters[name];\r\n    },\r\n    scheduleCopyItems() {\r\n      if (this._internal.hasScheduledCopyItems) return;\r\n      this._internal.hasScheduledCopyItems = true;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this._internal.hasScheduledCopyItems = false;\r\n\r\n        if (this._internal.items === undefined) return;\r\n\r\n        const repeaterDisabledWhenUnmounted =\r\n          NoodlRuntime.instance.getProjectSettings()\r\n            .repeaterDisabledWhenUnmounted;\r\n\r\n        // @ts-expect-error\r\n        if (repeaterDisabledWhenUnmounted && !this.isMounted) {\r\n          this._internal.mountedOperations.push(() => {\r\n            this._internal.collection.set(this._internal.items);\r\n          });\r\n        } else {\r\n          this._internal.collection.set(this._internal.items);\r\n        }\r\n      });\r\n    },\r\n    itemOutputSignalTriggered(name, model, itemNode) {\r\n      this._internal.itemActionItemId = model.getId();\r\n      this._internal.itemActionSignal = name;\r\n      this.flagOutputDirty(\"itemActionItemId\");\r\n\r\n      // Send signal and update item outputs after they have been correctly updated\r\n      if (!this._internal.hasScheduledTriggerItemOutputSignal) {\r\n        this._internal.hasScheduledTriggerItemOutputSignal = true;\r\n        this.context.scheduleAfterUpdate(() => {\r\n          this._internal.hasScheduledTriggerItemOutputSignal = false;\r\n          for (var key in itemNode._outputs) {\r\n            var _output = \"itemOutput-\" + key;\r\n            if (this.hasOutput(_output)) {\r\n              this._internal.itemOutputs[key] = itemNode._outputs[key].value;\r\n              this.flagOutputDirty(_output);\r\n            }\r\n          }\r\n          this.sendSignalOnOutput(\r\n            \"itemOutputSignal-\" + this._internal.itemActionSignal\r\n          );\r\n        });\r\n      }\r\n    },\r\n    getItemOutput(name) {\r\n      return this._internal.itemOutputs[name];\r\n    },\r\n    registerOutputIfNeeded(name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"itemOutputSignal-\")) {\r\n        this._internal.itemOutputSignals[\r\n          name.substring(\"itemOutputSignal-\".length)\r\n        ] = true;\r\n        this.registerOutput(name, {\r\n          getter() {\r\n            /** No needed for signals */\r\n          },\r\n        });\r\n      } else if (name.startsWith(\"itemOutput-\"))\r\n        this.registerOutput(name, {\r\n          // @ts-expect-error\r\n          getter: this.getItemOutput.bind(\r\n            this,\r\n            name.substring(\"itemOutput-\".length)\r\n          ),\r\n        });\r\n    },\r\n    setInputMappingScript(value) {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          // @ts-expect-error\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          \"foreach-inputmapping-warning\"\r\n        );\r\n      }\r\n\r\n      this._internal.inputMappingScript = value;\r\n\r\n      if (this._internal.inputMappingScript) {\r\n        try {\r\n          this._internal.inputMapFunc = new Function(\r\n            \"map\",\r\n            \"object\",\r\n            this._internal.inputMappingScript\r\n          );\r\n        } catch (e) {\r\n          this._internal.inputMapFunc = undefined;\r\n          if (this.context.editorConnection) {\r\n            this.context.editorConnection.sendWarning(\r\n              // @ts-expect-error\r\n              this.nodeScope.componentOwner.name,\r\n              this.id,\r\n              \"foreach-inputmapping-warning\",\r\n              // @ts-expect-error\r\n              { message: \"<strong>Input mapping</strong>: \" + e.message }\r\n            );\r\n          }\r\n        }\r\n      } else {\r\n        this._internal.inputMapFunc = undefined;\r\n      }\r\n\r\n      // @ts-expect-error\r\n      this.scheduleRefresh();\r\n    },\r\n    registerInputIfNeeded(name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"inputMappingScript\")\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setInputMappingScript.bind(this),\r\n        });\r\n    },\r\n  },\r\n};\r\n\r\nfunction _typeName(t) {\r\n  if (typeof t === \"object\") return t.name;\r\n  else return t;\r\n}\r\n\r\nconst defaultMapCode =\r\n  \"// Here you add mappings between the properties of the item objects and the inputs of the components.\\n\" +\r\n  \"// 'myComponentInput': 'myObjectProperty',\\n\" +\r\n  \"// 'anotherComponentInput'() { return object.get('someProperty') + ' ' + object.get('otherProp') }\\n\" +\r\n  \"// These are the default mappings based on the selected template component.\\n\" +\r\n  \"map({\\n\" +\r\n  \"{{#mappings}}\" +\r\n  \"})\\n\";\r\n\r\nexport const node = ForEachDefinition;\r\nexport const setup = function (context, graphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node) {\r\n    function _collectPortsInTemplateComponent() {\r\n      var templateComponentName = node.parameters.template;\r\n      if (templateComponentName === undefined) return;\r\n\r\n      var ports = [];\r\n      var c = graphModel.components[templateComponentName];\r\n      if (c === undefined) return;\r\n\r\n      // Collect item outputs and signals\r\n      for (var outputName in c.outputPorts) {\r\n        var o = c.outputPorts[outputName];\r\n        if (_typeName(o.type) === \"signal\") {\r\n          // @ts-expect-error\r\n          ports.push({\r\n            name: \"itemOutputSignal-\" + outputName,\r\n            displayName: outputName,\r\n            type: \"signal\",\r\n            plug: \"output\",\r\n            group: \"Item Signals\",\r\n          });\r\n        } else {\r\n          // @ts-expect-error\r\n          ports.push({\r\n            name: \"itemOutput-\" + outputName,\r\n            displayName: outputName,\r\n            type: o.type,\r\n            plug: \"output\",\r\n            group: \"Item Outputs\",\r\n          });\r\n        }\r\n      }\r\n\r\n      // Collect default mappings for template component inputs\r\n      var defaultMappings = \"\";\r\n      for (var inputName in c.inputPorts) {\r\n        var o = c.inputPorts[inputName];\r\n        if (_typeName(o.type) !== \"signal\") {\r\n          defaultMappings += \"\\t'\" + inputName + \"': '\" + inputName + \"',\\n\";\r\n        }\r\n      }\r\n\r\n      // @ts-expect-error\r\n      ports.push({\r\n        name: \"inputMappingScript\",\r\n        type: { name: \"string\", codeeditor: \"javascript\" },\r\n        displayName: \"Script\",\r\n        group: \"Input Mapping\",\r\n        default: defaultMapCode.replace(\"{{#mappings}}\", defaultMappings),\r\n        plug: \"input\",\r\n      });\r\n\r\n      context.editorConnection.sendDynamicPorts(node.id, ports, {\r\n        detectRenamed: {\r\n          plug: \"output\",\r\n          prefix: \"itemOutput\",\r\n        },\r\n      });\r\n    }\r\n\r\n    function _trackComponentOutputs(componentName) {\r\n      if (componentName === undefined) return;\r\n      var c = graphModel.components[componentName];\r\n      if (c === undefined) return;\r\n\r\n      c.on(\"outputPortAdded\", _collectPortsInTemplateComponent);\r\n      c.on(\"outputPortRemoved\", _collectPortsInTemplateComponent);\r\n      c.on(\"outputPortTypesUpdated\", _collectPortsInTemplateComponent);\r\n\r\n      c.on(\"inputPortTypesUpdated\", _collectPortsInTemplateComponent);\r\n      c.on(\"inputPortAdded\", _collectPortsInTemplateComponent);\r\n      c.on(\"inputPortRemoved\", _collectPortsInTemplateComponent);\r\n    }\r\n\r\n    _collectPortsInTemplateComponent();\r\n    _trackComponentOutputs(node.parameters.template);\r\n    node.on(\"parameterUpdated\", function (event) {\r\n      if (event.name === \"template\") {\r\n        _collectPortsInTemplateComponent();\r\n        _trackComponentOutputs(node.parameters.template);\r\n      }\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.For Each\", function (node) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"For Each\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n};\r\n","import { createSetter, NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  removeCompletedCallback?: () => void;\r\n  actionParameters?: Record<string, any>;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"For Each Actions\",\r\n  docs: \"https://docs.noodl.net/nodes/ui-controls/repeater-item\",\r\n  displayNodeName: \"Repeater Item\",\r\n  category: \"Data\",\r\n  color: \"data\",\r\n  inputs: {\r\n    removeCompleted: {\r\n      type: { name: \"boolean\", allowConnectionsOnly: true },\r\n      displayName: \"Remove Completed\",\r\n      group: \"Events\",\r\n      valueChangedToTrue: function () {\r\n        this._internal.removeCompletedCallback &&\r\n          this._internal.removeCompletedCallback();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    added: {\r\n      type: \"signal\",\r\n      displayName: \"Added\",\r\n      group: \"Events\",\r\n    },\r\n    tryRemove: {\r\n      type: \"signal\",\r\n      displayName: \"Try Remove\",\r\n      group: \"Events\",\r\n    },\r\n    itemId: {\r\n      type: \"string\",\r\n      displayName: \"Item Id\",\r\n      group: \"General\",\r\n      get() {\r\n        // @ts-expect-error\r\n        return this.getItemId();\r\n      },\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    getItemId() {\r\n      // @ts-expect-error\r\n      const model = this.nodeScope.componentOwner._forEachModel;\r\n      return model && model.getId();\r\n    },\r\n    signalAdded: function () {\r\n      this.sendSignalOnOutput(\"added\");\r\n    },\r\n    tryRemove: function (callback) {\r\n      if (this.getOutput(\"tryRemove\").hasConnections()) {\r\n        this._internal.removeCompletedCallback = callback;\r\n        this.sendSignalOnOutput(\"tryRemove\");\r\n      } else {\r\n        // Schedule for later in this frame so any collection nodes\r\n        // being delete can complete data persistence before being\r\n        // deleted\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          callback();\r\n        });\r\n      }\r\n    },\r\n    itemActionTriggered(name) {\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        const itemId = this.getItemId();\r\n        // @ts-expect-error\r\n        const parentForEach = this.nodeScope.componentOwner._forEachNode;\r\n        parentForEach.signalItemAction(\r\n          name,\r\n          itemId,\r\n          this._internal.actionParameters || {}\r\n        );\r\n      });\r\n    },\r\n    setItemActionParameter(name: string) {\r\n      if (!this._internal.actionParameters)\r\n        this._internal.actionParameters = {};\r\n      this._internal.actionParameters[name] = name;\r\n    },\r\n    registerInputIfNeeded: function (name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"itemAction-\"))\r\n        return this.registerInput(name, {\r\n          set: createSetter({\r\n            // @ts-expect-error\r\n            valueChangedToTrue: this.itemActionTriggered.bind(this, name),\r\n          }),\r\n        });\r\n\r\n      if (name.startsWith(\"itemActionParameter-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setItemActionParameter.bind(this, name),\r\n        });\r\n    },\r\n  },\r\n};\r\n","import { Node, NodeDefinition, Model, Collection } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  collectionChangedCallback: () => void;\r\n  mappedCollection?: Collection<Model>;\r\n  mapCode?: string;\r\n  mapFunc?: (map: any, object: any) => void;\r\n  collection?: Collection<Model>;\r\n  collectionChangedScheduled?: boolean;\r\n}\r\n\r\nconst defaultMapCode =\r\n  \"map({\\n\" +\r\n  \"\\t// Here you add mappings between the input object and the mapped output object.\\n\" +\r\n  \"\\t//myOutputProp: 'inputProp',\\n\" +\r\n  \"\\t//anotherProperty: function(object) { return object.get('someProperty') + ' ' + object.get('otherProp') }\\n\" +\r\n  \"})\\n\";\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Map Collection\",\r\n  docs: \"https://docs.noodl.net/nodes/data/array/array-map\",\r\n  displayNodeName: \"Array Map\",\r\n  shortDesc: \"Map array fields\",\r\n  category: \"Data\",\r\n  color: \"data\",\r\n  initialize: function () {\r\n    this._internal.collectionChangedCallback = () => {\r\n      // @ts-expect-error\r\n      this.scheduleMap();\r\n    };\r\n  },\r\n  inputs: {\r\n    items: {\r\n      type: \"array\",\r\n      displayName: \"Items\",\r\n      group: \"General\",\r\n      set: function (value) {\r\n        // @ts-expect-error\r\n        this.setCollection(value);\r\n        // @ts-expect-error\r\n        this.scheduleMap();\r\n      },\r\n    },\r\n    mapScript: {\r\n      type: {\r\n        name: \"string\",\r\n        allowEditOnly: true,\r\n        codeeditor: \"javascript\",\r\n      },\r\n      displayName: \"Script\",\r\n      default: defaultMapCode,\r\n      set: function (value) {\r\n        this._internal.mapCode = value;\r\n        try {\r\n          // @ts-expect-error\r\n          this._internal.mapFunc = new Function(\r\n            \"map\",\r\n            \"object\",\r\n            // @ts-expect-error\r\n            this._internal.mapCode\r\n          );\r\n        } catch (e) {\r\n          this._internal.mapFunc = undefined;\r\n          console.log(\"Error while parsing map script: \" + e);\r\n        }\r\n        // @ts-expect-error\r\n        this.scheduleMap();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    items: {\r\n      type: \"array\",\r\n      displayName: \"Items\",\r\n      group: \"General\",\r\n      getter: function () {\r\n        return this._internal.mappedCollection;\r\n      },\r\n    },\r\n    count: {\r\n      type: \"number\",\r\n      displayName: \"Count\",\r\n      group: \"General\",\r\n      getter: function () {\r\n        return this._internal.mappedCollection\r\n          ? this._internal.mappedCollection.size()\r\n          : 0;\r\n      },\r\n    },\r\n    modified: {\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    setCollection: function (collection) {\r\n      // @ts-expect-error\r\n      this.bindCollection(collection);\r\n      this.flagOutputDirty(\"items\");\r\n      this.flagOutputDirty(\"count\");\r\n    },\r\n    unbindCurrentCollection: function () {\r\n      const collection = this._internal.collection;\r\n      if (!collection) return;\r\n      // @ts-expect-error\r\n      collection.off(\"change\", this._internal.collectionChangedCallback);\r\n      this._internal.collection = undefined;\r\n    },\r\n    bindCollection: function (collection) {\r\n      // @ts-expect-error\r\n      this.unbindCurrentCollection();\r\n      this._internal.collection = collection;\r\n      collection &&\r\n        collection.on(\"change\", this._internal.collectionChangedCallback);\r\n    },\r\n    _onNodeDeleted: function () {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      // @ts-expect-error\r\n      this.unbindCurrentCollection();\r\n    },\r\n    scheduleMap: function () {\r\n      // @ts-expect-error\r\n      if (this.collectionChangedScheduled) return;\r\n      // @ts-expect-error\r\n      this.collectionChangedScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.collectionChangedScheduled = false;\r\n        if (this._internal.collection === undefined) return;\r\n\r\n        const mappedModels = this._internal.collection.map((model) => {\r\n          const m = Model.create();\r\n          // @ts-expect-error\r\n          this._internal.mapFunc(function (mappings) {\r\n            for (const key in mappings) {\r\n              if (typeof mappings[key] === \"function\") {\r\n                m.set(key, mappings[key](model));\r\n              } else if (typeof mappings[key] === \"string\") {\r\n                m.set(key, model.get(mappings[key]));\r\n              }\r\n            }\r\n          }, model);\r\n          return m;\r\n        });\r\n\r\n        this._internal.mappedCollection = Collection.create(mappedModels);\r\n\r\n        this.sendSignalOnOutput(\"modified\");\r\n        this.flagOutputDirty(\"items\");\r\n        this.flagOutputDirty(\"count\");\r\n      });\r\n    },\r\n  },\r\n};\r\n","import {\r\n  Model,\r\n  Collection,\r\n  NodeDefinition,\r\n  NodeContext,\r\n  GraphModel,\r\n} from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  name?: string;\r\n  setWith?: string;\r\n  value?: any;\r\n  variablesModel: any; // Adjust type as necessary\r\n  hasScheduledStore?: boolean;\r\n}\r\n\r\nconst SetVariableNodeDefinition: NodeDefinition<Internal> = {\r\n  name: \"Set Variable\",\r\n  docs: \"https://docs.noodl.net/nodes/data/variable/set-variable\",\r\n  category: \"Data\",\r\n  usePortAsLabel: \"name\",\r\n  color: \"data\",\r\n  initialize() {\r\n    const internal = this._internal;\r\n    internal.variablesModel = Model.get(\"--ndl--global-variables\");\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal.name) {\r\n      return this._internal.variablesModel.get(this._internal.name);\r\n    }\r\n    return \"[No value set]\";\r\n  },\r\n  outputs: {\r\n    done: {\r\n      type: \"signal\",\r\n      displayName: \"Done\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n  inputs: {\r\n    name: {\r\n      type: {\r\n        name: \"string\",\r\n        identifierOf: \"VariableName\",\r\n        identifierDisplayName: \"Variable names\",\r\n      },\r\n      displayName: \"Name\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.name = value;\r\n      },\r\n    },\r\n    setWith: {\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"String\", value: \"string\" },\r\n          { label: \"Boolean\", value: \"boolean\" },\r\n          { label: \"Number\", value: \"number\" },\r\n          { label: \"Empty string\", value: \"emptyString\" },\r\n          { label: \"Date\", value: \"date\" },\r\n          { label: \"Object\", value: \"object\" },\r\n          { label: \"Array\", value: \"array\" },\r\n          { label: \"Any\", value: \"*\" },\r\n        ],\r\n        allowEditOnly: true,\r\n      },\r\n      displayName: \"Set as\",\r\n      default: \"*\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.setWith = value;\r\n      },\r\n    },\r\n    do: {\r\n      displayName: \"Do\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleStore();\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    setValue(value: any) {\r\n      this._internal.value = value;\r\n    },\r\n    scheduleStore() {\r\n      // @ts-expect-error\r\n      if (this.hasScheduledStore) return;\r\n      // @ts-expect-error\r\n      this.hasScheduledStore = true;\r\n\r\n      const internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.hasScheduledStore = false;\r\n\r\n        let value = internal.setWith === \"emptyString\" ? \"\" : internal.value;\r\n\r\n        if (internal.setWith === \"object\" && typeof value === \"string\") {\r\n          value = Model.get(value);\r\n        }\r\n\r\n        if (internal.setWith === \"array\" && typeof value === \"string\") {\r\n          value = Collection.get(value);\r\n        }\r\n\r\n        if (internal.setWith === \"boolean\") value = !!value;\r\n\r\n        internal.variablesModel.set(internal.name, value, {\r\n          forceChange: true,\r\n        });\r\n        this.sendSignalOnOutput(\"done\");\r\n      });\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"value\") {\r\n        this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setValue.bind(this),\r\n        });\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  graphModel.on(\"nodeAdded.Set Variable\", (node: any) => {\r\n    const _updatePorts = () => {\r\n      const ports: any[] = [];\r\n\r\n      if (node.parameters.setWith !== \"emptyString\") {\r\n        ports.push({\r\n          type:\r\n            node.parameters.setWith !== undefined\r\n              ? node.parameters.setWith\r\n              : \"*\",\r\n          plug: \"input\",\r\n          group: \"General\",\r\n          name: \"value\",\r\n          displayName: \"Value\",\r\n        });\r\n      }\r\n\r\n      context.editorConnection?.sendDynamicPorts(node.id, ports);\r\n    };\r\n\r\n    _updatePorts();\r\n\r\n    node.on(\"parameterUpdated\", () => {\r\n      _updatePorts();\r\n    });\r\n  });\r\n}\r\n\r\nexport { SetVariableNodeDefinition as node };\r\n","import { NodeDefinition, Collection } from \"@fluxscape/runtime\";\r\n\r\nfunction CSVToArray(strData: string, strDelimiter: string = \",\"): string[][] {\r\n  const objPattern = new RegExp(\r\n    \"(\\\\\" +\r\n      strDelimiter +\r\n      \"|\\\\r?\\\\n|\\\\r|^)\" +\r\n      '(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|' +\r\n      '([^\"\\\\' +\r\n      strDelimiter +\r\n      \"\\\\r\\\\n]*))\",\r\n    \"gi\"\r\n  );\r\n\r\n  const arrData: string[][] = [[]];\r\n  let arrMatches: RegExpExecArray | null;\r\n  let prevLastIndex: number;\r\n\r\n  while (\r\n    (arrMatches = objPattern.exec(strData)) &&\r\n    // @ts-expect-error\r\n    prevLastIndex !== objPattern.lastIndex\r\n  ) {\r\n    prevLastIndex = objPattern.lastIndex;\r\n    const strMatchedDelimiter = arrMatches[1];\r\n\r\n    if (strMatchedDelimiter.length && strMatchedDelimiter !== strDelimiter) {\r\n      arrData.push([]);\r\n    }\r\n\r\n    let strMatchedValue: string;\r\n\r\n    if (arrMatches[2]) {\r\n      strMatchedValue = arrMatches[2].replace(new RegExp('\"\"', \"g\"), '\"');\r\n    } else {\r\n      strMatchedValue = arrMatches[3];\r\n    }\r\n\r\n    arrData[arrData.length - 1].push(strMatchedValue);\r\n  }\r\n\r\n  return arrData;\r\n}\r\n\r\ninterface Internal {\r\n  collection: Collection<any>;\r\n  type?: string;\r\n  csv?: string;\r\n  json?: string;\r\n  hasScheduledParseData?: boolean;\r\n}\r\n\r\nconst CSVNode: NodeDefinition<Internal> = {\r\n  name: \"Static Data\",\r\n  docs: \"https://docs.noodl.net/nodes/data/array/static-array\",\r\n  displayNodeName: \"Static Array\",\r\n  shortDesc: \"Store static data to populate a Collection with items.\",\r\n  category: \"Data\",\r\n  color: \"data\",\r\n  nodeDoubleClickAction: [{ focusPort: \"JSON\" }, { focusPort: \"CSV\" }],\r\n  getInspectInfo() {\r\n    if (this._internal.collection) {\r\n      return [{ type: \"value\", value: this._internal.collection.items }];\r\n    }\r\n  },\r\n  dynamicports: [\r\n    {\r\n      name: \"conditionalports/extended\",\r\n      condition: \"type = csv OR type NOT SET\",\r\n      inputs: [\"csv\"],\r\n    },\r\n    {\r\n      name: \"conditionalports/extended\",\r\n      condition: \"type = json\",\r\n      inputs: [\"json\"],\r\n    },\r\n  ],\r\n  inputs: {\r\n    type: {\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"CSV\", value: \"csv\" },\r\n          { label: \"JSON\", value: \"json\" },\r\n        ],\r\n        allowEditOnly: true,\r\n      },\r\n      displayName: \"Type\",\r\n      group: \"General\",\r\n      default: \"csv\",\r\n      set(value: string) {\r\n        this._internal.type = value;\r\n      },\r\n    },\r\n    csv: {\r\n      type: { name: \"string\", codeeditor: \"text\", allowEditOnly: true },\r\n      displayName: \"CSV\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.csv = value;\r\n        // @ts-expect-error\r\n        this.scheduleParseData();\r\n      },\r\n    },\r\n    json: {\r\n      type: { name: \"string\", codeeditor: \"json\", allowEditOnly: true },\r\n      displayName: \"JSON\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.json = value;\r\n        // @ts-expect-error\r\n        this.scheduleParseData();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    items: {\r\n      type: \"array\",\r\n      displayName: \"Items\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.collection;\r\n      },\r\n    },\r\n    count: {\r\n      type: \"number\",\r\n      displayName: \"Count\",\r\n      group: \"General\",\r\n      get() {\r\n        return this._internal.collection ? this._internal.collection.size() : 0;\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    scheduleParseData() {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledParseData) {\r\n        internal.hasScheduledParseData = true;\r\n        // @ts-expect-error\r\n        this.scheduleAfterInputsHaveUpdated(this.parseData.bind(this));\r\n      }\r\n    },\r\n    parseData() {\r\n      const internal = this._internal;\r\n      internal.hasScheduledParseData = false;\r\n      internal.collection = Collection.get();\r\n\r\n      if (internal.type === undefined || internal.type === \"csv\") {\r\n        // @ts-expect-error\r\n        const data = CSVToArray(internal.csv);\r\n        const json: any[] = [];\r\n        const fields = data[0];\r\n        for (let i = 1; i < data.length; i++) {\r\n          const row = data[i];\r\n          const obj: any = {};\r\n          for (let j = 0; j < fields.length; j++) {\r\n            obj[fields[j]] = row[j];\r\n          }\r\n          json.push(obj);\r\n        }\r\n\r\n        internal.collection.set(json);\r\n        this.flagOutputDirty(\"items\");\r\n        this.flagOutputDirty(\"count\");\r\n      } else if (internal.type === \"json\") {\r\n        if (this.context.editorConnection) {\r\n          this.context.editorConnection.clearWarning(\r\n            // @ts-expect-error\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"json-parse-warning\"\r\n          );\r\n        }\r\n\r\n        try {\r\n          // @ts-expect-error\r\n          const json = JSON.parse(internal.json);\r\n          internal.collection.set(json);\r\n          this.flagOutputDirty(\"items\");\r\n          this.flagOutputDirty(\"count\");\r\n        } catch (e) {\r\n          if (this.context.editorConnection) {\r\n            this.context.editorConnection.sendWarning(\r\n              // @ts-expect-error\r\n              this.nodeScope.componentOwner.name,\r\n              this.id,\r\n              \"json-parse-warning\",\r\n              {\r\n                showGlobally: true,\r\n                // @ts-expect-error\r\n                message: e.message,\r\n              }\r\n            );\r\n          }\r\n        }\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nexport const node = CSVNode;\r\nexport function setup() {\r\n  // Setup logic if needed\r\n}\r\n","import { NodeDefinition, Model, Node } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  name: string;\r\n  value: any;\r\n  variablesModel: any;\r\n  onModelChangedCallback: (args: { name: string }) => void;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Variable2\",\r\n  displayNodeName: \"Variable\",\r\n  docs: \"https://docs.noodl.net/nodes/data/variable/variable-node\",\r\n  category: \"Data\",\r\n  usePortAsLabel: \"name\",\r\n  color: \"data\",\r\n  initialize() {\r\n    const internal = this._internal;\r\n\r\n    this._internal.onModelChangedCallback = (args) => {\r\n      if (!this.isInputConnected(\"fetch\") && args.name === internal.name) {\r\n        this.sendSignalOnOutput(\"changed\");\r\n        this.flagOutputDirty(\"value\");\r\n      }\r\n    };\r\n\r\n    internal.variablesModel = Model.get(\"--ndl--global-variables\");\r\n    internal.variablesModel.on(\"change\", this._internal.onModelChangedCallback);\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal.name) {\r\n      return this._internal.variablesModel.get(this._internal.name);\r\n    }\r\n    return \"[No value set]\";\r\n  },\r\n  outputs: {\r\n    name: {\r\n      type: \"string\",\r\n      displayName: \"Name\",\r\n      group: \"General\",\r\n      getter() {\r\n        return this._internal.name;\r\n      },\r\n    },\r\n    changed: {\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n      group: \"Events\",\r\n    },\r\n    fetched: {\r\n      type: \"signal\",\r\n      displayName: \"Fetched\",\r\n      group: \"Events\",\r\n    },\r\n    value: {\r\n      type: \"*\",\r\n      displayName: \"Value\",\r\n      group: \"General\",\r\n      getter() {\r\n        const internal = this._internal;\r\n        if (!internal.name) return;\r\n        return internal.variablesModel.get(internal.name);\r\n      },\r\n    },\r\n  },\r\n  inputs: {\r\n    name: {\r\n      type: {\r\n        name: \"string\",\r\n        identifierOf: \"VariableName\",\r\n        identifierDisplayName: \"Variable names\",\r\n      },\r\n      displayName: \"Name\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        if (!this.isInputConnected(\"fetch\")) {\r\n          // @ts-expect-error\r\n          this.setVariableName(value);\r\n        } else {\r\n          this._internal.name = value; // Wait to fetch data\r\n          this.flagOutputDirty(\"name\");\r\n        }\r\n      },\r\n    },\r\n    fetch: {\r\n      displayName: \"Fetch\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.setVariableName(this._internal.name);\r\n      },\r\n    },\r\n    value: {\r\n      type: \"*\",\r\n      displayName: \"Value\",\r\n      group: \"General\",\r\n      set(value: any) {\r\n        this._internal.value = value;\r\n        // @ts-expect-error\r\n        this.scheduleStore();\r\n      },\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    scheduleStore() {\r\n      // @ts-expect-error\r\n      if (this.hasScheduledStore) return;\r\n      // @ts-expect-error\r\n      this.hasScheduledStore = true;\r\n\r\n      const internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.hasScheduledStore = false;\r\n        internal.variablesModel.set(internal.name, internal.value);\r\n      });\r\n    },\r\n    setVariableName(name: string) {\r\n      this._internal.name = name;\r\n      this.flagOutputDirty(\"name\");\r\n      this.flagOutputDirty(\"value\");\r\n      this.sendSignalOnOutput(\"fetched\");\r\n    },\r\n    _onNodeDeleted() {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this._internal.variablesModel.off(\r\n        \"change\",\r\n        this._internal.onModelChangedCallback\r\n      );\r\n    },\r\n  },\r\n};\r\n","import { GraphModel, NodeContext, NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  outputValues: Record<string, any>;\r\n  outputNames: string[];\r\n  eventReceived: boolean;\r\n  _isEnabled: boolean;\r\n  channelName: string;\r\n  consume: string;\r\n  onEventReceivedCallback?: (eventData: any) => void | null;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Event Receiver\",\r\n  docs: \"https://docs.noodl.net/nodes/events/receive-event\",\r\n  displayNodeName: \"Receive Event\",\r\n  category: \"Events\",\r\n  usePortAsLabel: \"channelName\",\r\n  color: \"component\",\r\n  initialize() {\r\n    this._internal.outputValues = {};\r\n    this._internal.outputNames = [];\r\n    this._internal.eventReceived = false;\r\n    this._internal._isEnabled = true;\r\n    this._internal.channelName = \"\";\r\n  },\r\n  inputs: {\r\n    enabled: {\r\n      displayName: \"Enabled\",\r\n      type: \"boolean\",\r\n      default: true,\r\n      set(value) {\r\n        this._internal._isEnabled = value;\r\n      },\r\n    },\r\n    consume: {\r\n      displayName: \"Consume\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Never\", value: \"never\" },\r\n          { label: \"Always\", value: \"always\" },\r\n        ],\r\n      },\r\n      default: \"never\",\r\n      set(value) {\r\n        this._internal.consume = value;\r\n      },\r\n    },\r\n    channelName: {\r\n      type: { name: \"string\", identifierOf: \"EventChannelName\" },\r\n      displayName: \"Channel\",\r\n      set(value) {\r\n        if (this._internal.onEventReceivedCallback) {\r\n          //remove old listener\r\n          this.context.eventSenderEmitter.removeListener(\r\n            this._internal.channelName,\r\n            this._internal.onEventReceivedCallback\r\n          );\r\n          // @ts-expect-error\r\n          this._internal.onEventReceivedCallback = null;\r\n        }\r\n\r\n        this._internal.channelName = value;\r\n        // @ts-expect-error\r\n        this.registerListenersForChannel(value);\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    eventReceived: {\r\n      displayName: \"Received\",\r\n      type: \"signal\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    registerOutputIfNeeded(name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      this._internal.outputNames.push(name);\r\n      this.registerOutput(name, {\r\n        getter: () => this._internal.outputValues[name],\r\n      });\r\n    },\r\n    // @ts-expect-error\r\n    handleEvent(eventData) {\r\n      if (!this._internal._isEnabled) {\r\n        return;\r\n      }\r\n      this.sendSignalOnOutput(\"eventReceived\");\r\n\r\n      for (const name in eventData) {\r\n        if (this.hasOutput(name)) {\r\n          this._internal.outputValues[name] = eventData[name];\r\n          this.flagOutputDirty(name);\r\n        }\r\n      }\r\n\r\n      return this._internal.consume === \"always\";\r\n    },\r\n    onEventReceived(eventData) {\r\n      // @ts-expect-error\r\n      this.handleEvent(eventData);\r\n    },\r\n    _onNodeDeleted() {\r\n      // @ts-expect-error\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      if (this._internal.onEventReceivedCallback) {\r\n        const eventEmitter = this.context.eventSenderEmitter;\r\n        eventEmitter.removeListener(\r\n          this._internal.channelName,\r\n          this._internal.onEventReceivedCallback\r\n        );\r\n      }\r\n    },\r\n    registerListenersForChannel(channelName) {\r\n      const eventEmitter = this.context.eventSenderEmitter;\r\n      // @ts-expect-error\r\n      this._internal.onEventReceivedCallback = this.onEventReceived.bind(this);\r\n      // @ts-expect-error\r\n      eventEmitter.on(channelName, this._internal.onEventReceivedCallback);\r\n\r\n      this.context.eventEmitter.once(\"applicationDataReloaded\", () => {\r\n        if (this._internal.onEventReceivedCallback) {\r\n          eventEmitter.removeListener(\r\n            channelName,\r\n            this._internal.onEventReceivedCallback\r\n          );\r\n        }\r\n      });\r\n    },\r\n    // @ts-expect-error\r\n    getChannelName() {\r\n      return this._internal.channelName;\r\n    },\r\n  },\r\n};\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function onEventReceiver(node) {\r\n    let channelName = node.parameters.channelName;\r\n\r\n    function _collectPayloadPorts() {\r\n      const eventSenders = graphModel.getNodesWithType(\"Event Sender\");\r\n      const matching = eventSenders.filter(\r\n        (node) => node.parameters.channelName === channelName\r\n      );\r\n\r\n      const portKeys: Record<string, boolean> = {};\r\n      matching.forEach((node) => {\r\n        const ports = node.parameters.payload\r\n          ? node.parameters.payload.split(\",\")\r\n          : [];\r\n        for (const key of ports) {\r\n          portKeys[key] = true;\r\n        }\r\n      });\r\n\r\n      const ports = Object.keys(portKeys).map((key) => ({\r\n        name: key,\r\n        type: \"*\",\r\n        plug: \"output\",\r\n        displayName: key,\r\n      }));\r\n\r\n      context.editorConnection?.sendDynamicPorts(node.id, ports, {\r\n        detectRenamed: {\r\n          plug: \"output\",\r\n        },\r\n      });\r\n    }\r\n\r\n    _collectPayloadPorts();\r\n    node.on(\"parameterUpdated\", function (event) {\r\n      if (event.name === \"channelName\") {\r\n        channelName = event.value;\r\n        _collectPayloadPorts();\r\n      }\r\n    });\r\n\r\n    function _trackEventSender(node) {\r\n      node.on(\"inputPortAdded\", _collectPayloadPorts);\r\n      node.on(\"inputPortRemoved\", _collectPayloadPorts);\r\n      node.on(\"parameterUpdated\", function (event) {\r\n        if (event.name === \"channelName\") {\r\n          _collectPayloadPorts();\r\n        }\r\n      });\r\n    }\r\n\r\n    graphModel.getNodesWithType(\"Event Sender\").forEach(_trackEventSender);\r\n    graphModel.on(\"nodeAdded.Event Sender\", _trackEventSender);\r\n    graphModel.on(\"nodeRemoved.Event Sender\", _collectPayloadPorts);\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.Event Receiver\", onEventReceiver);\r\n    graphModel.getNodesWithType(\"Event Receiver\").forEach(onEventReceiver);\r\n  });\r\n}\r\n","import { GraphModel, NodeContext, NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  inputValues: Record<string, any>;\r\n  channelName: string;\r\n  propagation: string;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Event Sender\",\r\n  docs: \"https://docs.noodl.net/nodes/events/send-event\",\r\n  displayNodeName: \"Send Event\",\r\n  category: \"Events\",\r\n  usePortAsLabel: \"channelName\",\r\n  color: \"component\",\r\n  exportDynamicPorts: true,\r\n  initialize: function () {\r\n    this._internal.inputValues = {};\r\n    this._internal.channelName = \"\";\r\n    this._internal.propagation = \"global\";\r\n  },\r\n  inputs: {\r\n    sendEvent: {\r\n      displayName: \"Send\",\r\n      valueChangedToTrue: function () {\r\n        const self = this;\r\n\r\n        //wait for all other inputs to update before sending\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          if (self._internal.propagation === \"global\") {\r\n            self.context.sendGlobalEventFromEventSender(\r\n              self._internal.channelName,\r\n              self._internal.inputValues\r\n            );\r\n          } else {\r\n            self.nodeScope!.sendEventFromThisScope(\r\n              self._internal.channelName,\r\n              self._internal.inputValues,\r\n              self._internal.propagation\r\n            );\r\n          }\r\n        });\r\n      },\r\n    },\r\n    channelName: {\r\n      type: {\r\n        name: \"string\",\r\n        allowEditOnly: true,\r\n        identifierOf: \"EventChannelName\",\r\n        identifierDisplayName: \"Event Channels\",\r\n      },\r\n      default: \"\",\r\n      group: \"Settings\",\r\n      displayName: \"Channel Name\",\r\n      set: function (value) {\r\n        this._internal.channelName = value;\r\n        this._internal.inputValues._channelName = value;\r\n      },\r\n    },\r\n    propagation: {\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { value: \"global\", label: \"Global\" },\r\n          { value: \"parent\", label: \"Parent\" },\r\n          { value: \"children\", label: \"Children\" },\r\n          { value: \"siblings\", label: \"Siblings\" },\r\n        ],\r\n      },\r\n      default: \"global\",\r\n      group: \"Settings\",\r\n      displayName: \"Send to\",\r\n      set: function (value) {\r\n        this._internal.propagation = value;\r\n      },\r\n    },\r\n    payload: {\r\n      type: {\r\n        name: \"stringlist\",\r\n        allowEditOnly: true,\r\n      },\r\n      group: \"Payload\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    registerInputIfNeeded(name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n      const self = this;\r\n      this.registerInput(name, {\r\n        set: function (value) {\r\n          self._internal.inputValues[name] = value;\r\n        },\r\n      });\r\n    },\r\n  },\r\n};\r\n\r\nfunction updatePorts(nodeId: string, parameters: any, editorConnection: any) {\r\n  const ports: any[] = [];\r\n\r\n  // Add payload inputs\r\n  let payload = parameters.payload;\r\n  if (payload) {\r\n    payload = payload.split(\",\");\r\n    for (const p of payload) {\r\n      ports.push({\r\n        type: {\r\n          name: \"*\",\r\n          allowConnectionsOnly: true,\r\n        },\r\n        plug: \"input\",\r\n        group: \"Payload\",\r\n        name: p,\r\n        displayName: p,\r\n      });\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: \"input\",\r\n    },\r\n  });\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  graphModel.on(\"nodeAdded.Event Sender\", function (node: any) {\r\n    updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n    node.on(\"parameterUpdated\", function (event: any) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n    });\r\n  });\r\n}\r\n","import {\r\n  Node,\r\n  NodeDefinition,\r\n  logJavaScriptNodeError,\r\n  guid,\r\n  NodeContext,\r\n  GraphModel,\r\n  JavascriptNodeParser,\r\n} from \"@fluxscape/runtime\";\r\n\r\nconst defaultCode = \"\";\r\n\r\ninterface Internal {\r\n  inputValues: Record<string, any>;\r\n  outputValues: Record<string, any>;\r\n  outputProperties: Record<string, any>;\r\n  runScheduled: boolean;\r\n  setupScheduled: boolean;\r\n  runNextFrameScheduled: boolean;\r\n  isWaitingForExternalFileToLoad: boolean;\r\n  useExternalFile: boolean;\r\n  runFunction?: Function;\r\n  destroyFunction?: Function;\r\n  setupFunction?: Function;\r\n  hasParsedCode: boolean;\r\n  changedInputs: Record<string, any>;\r\n  signalScheduled: Record<string, boolean>;\r\n  killed: boolean;\r\n  inputQueue: Array<{ name: string; value: any }>;\r\n  userFunctionScope: {\r\n    createComponent: (componentName: string) => any;\r\n    deleteComponent: (component: any) => void;\r\n    flagOutputDirty: (name: string) => void;\r\n    runNextFrame: () => void;\r\n    sendSignalOnOutput: (name: string) => void;\r\n  };\r\n  onFrameStart: () => void;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Javascript2\",\r\n  docs: \"https://docs.noodl.net/nodes/javascript/script\",\r\n  displayNodeName: \"Script\",\r\n  category: \"CustomCode\",\r\n  color: \"javascript\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"Code\",\r\n  },\r\n  searchTags: [\"javascript\"],\r\n  exportDynamicPorts: true,\r\n  initialize: function () {\r\n    const internal: Internal = this._internal;\r\n    internal.inputValues = {};\r\n    internal.outputValues = {};\r\n    internal.outputProperties = {};\r\n    internal.runScheduled = false;\r\n    internal.setupScheduled = false;\r\n    internal.runNextFrameScheduled = false;\r\n    internal.isWaitingForExternalFileToLoad = false;\r\n    internal.useExternalFile = false;\r\n    internal.runFunction = undefined;\r\n    internal.destroyFunction = undefined;\r\n    internal.setupFunction = undefined;\r\n    internal.hasParsedCode = false;\r\n    internal.changedInputs = {};\r\n    internal.signalScheduled = {};\r\n    internal.killed = false;\r\n    internal.inputQueue = [];\r\n\r\n    const self = this;\r\n    internal.userFunctionScope = {\r\n      createComponent(componentName: string) {\r\n        if (\r\n          componentName &&\r\n          componentName.length > 0 &&\r\n          componentName[0] !== \"/\"\r\n        ) {\r\n          componentName = \"/\" + componentName;\r\n        }\r\n        // @ts-expect-error\r\n        return self.nodeScope.createNode(componentName, guid());\r\n      },\r\n      deleteComponent(component) {\r\n        // @ts-expect-error\r\n        self.nodeScope.deleteNode(component);\r\n      },\r\n      flagOutputDirty(name: string) {\r\n        if (!name) {\r\n          throw new Error(\"Output port name must be specified\");\r\n        }\r\n        self.flagOutputDirty(name);\r\n      },\r\n      runNextFrame() {\r\n        if (internal.runNextFrameScheduled) {\r\n          return;\r\n        }\r\n        internal.runNextFrameScheduled = true;\r\n        self.context.scheduleNextFrame(function () {\r\n          internal.runNextFrameScheduled = false;\r\n          if (!internal.killed) {\r\n            scheduleRun.call(self);\r\n          }\r\n        });\r\n      },\r\n      sendSignalOnOutput(name: string) {\r\n        self.sendSignalOnOutput(name);\r\n      },\r\n    };\r\n\r\n    internal.onFrameStart = onFrameStart.bind(this);\r\n  },\r\n  dynamicports: [\r\n    {\r\n      condition: \"useExternalFile = no OR useExternalFile NOT SET\",\r\n      inputs: [\"code\"],\r\n    },\r\n    {\r\n      condition: \"useExternalFile = yes\",\r\n      inputs: [\"externalFile\"],\r\n    },\r\n  ],\r\n  inputs: {\r\n    scriptInputs: {\r\n      type: {\r\n        name: \"proplist\",\r\n        allowEditOnly: true,\r\n      },\r\n      group: \"Script Inputs\",\r\n      set(value: any) {\r\n        // ignore\r\n      },\r\n    },\r\n    scriptOutputs: {\r\n      type: {\r\n        name: \"proplist\",\r\n        allowEditOnly: true,\r\n      },\r\n      group: \"Script Outputs\",\r\n      set(value: any) {\r\n        // ignore\r\n      },\r\n    },\r\n    useExternalFile: {\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          {\r\n            value: \"yes\",\r\n            label: \"Yes\",\r\n          },\r\n          {\r\n            value: \"no\",\r\n            label: \"No\",\r\n          },\r\n        ],\r\n        allowEditOnly: true,\r\n      },\r\n      default: \"no\",\r\n      displayName: \"Use External File\",\r\n      group: \"Code\",\r\n      set(value: string) {\r\n        this._internal.isWaitingForExternalFileToLoad = value === \"yes\";\r\n        this._internal.useExternalFile = value === \"yes\";\r\n      },\r\n    },\r\n    code: {\r\n      displayName: \"Code\",\r\n      group: \"Code\",\r\n      type: {\r\n        name: \"string\",\r\n        allowEditOnly: true,\r\n        codeeditor: \"javascript\",\r\n      },\r\n      default: defaultCode,\r\n      set(value: string) {\r\n        if (!value) {\r\n          return;\r\n        }\r\n        const self = this;\r\n        this.scheduleAfterInputsHaveUpdated(function () {\r\n          if (this._internal.useExternalFile === false) {\r\n            // @ts-expect-error\r\n            this._callDestroyFunction();\r\n            const parser = JavascriptNodeParser.createFromCode(value, {\r\n              node: this,\r\n            });\r\n            // @ts-expect-error\r\n            self._onCodeParsed(parser);\r\n          }\r\n        });\r\n      },\r\n    },\r\n    externalFile: {\r\n      displayName: \"File Path\",\r\n      group: \"Code\",\r\n      type: {\r\n        name: \"source\",\r\n        allowEditOnly: true,\r\n      },\r\n      set(url: string) {\r\n        if (this._internal.useExternalFile === false) {\r\n          return;\r\n        }\r\n\r\n        const self = this;\r\n        JavascriptNodeParser.createFromURL(\r\n          url,\r\n          function (parser) {\r\n            self._internal.isWaitingForExternalFileToLoad = false;\r\n            // @ts-expect-error\r\n            self._onCodeParsed(parser);\r\n          },\r\n          {\r\n            node: this,\r\n          }\r\n        );\r\n      },\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    _onNodeDeleted() {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this._internal.killed = true;\r\n      // @ts-expect-error\r\n      this._callDestroyFunction();\r\n    },\r\n    update() {\r\n      if (this._internal.isWaitingForExternalFileToLoad === true) {\r\n        // @ts-expect-error\r\n        this._dirty = false;\r\n      } else {\r\n        Node.prototype.update.call(this);\r\n      }\r\n    },\r\n    _onCodeParsed(parser: any) {\r\n      const editorConnection = this.context.editorConnection;\r\n\r\n      if (editorConnection) {\r\n        for (const w of [\r\n          \"js-destroy-waring\",\r\n          \"js-run-waring\",\r\n          \"js-setup-waring\",\r\n        ]) {\r\n          editorConnection.clearWarning(\r\n            // @ts-expect-error\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            w\r\n          );\r\n        }\r\n      }\r\n\r\n      if (parser.error) {\r\n        return;\r\n      }\r\n\r\n      // register all color inputs with type 'color' to enable color resolving\r\n      // @ts-expect-error\r\n      Object.keys(this.model.inputPorts).forEach((name) => {\r\n        // @ts-expect-error\r\n        const type = this.model.inputPorts[name].type;\r\n        // @ts-expect-error\r\n        if (type === \"color\" || type.name === \"color\") {\r\n          this._internal.inputValues[name] = undefined;\r\n\r\n          if (!this.hasInput(name)) {\r\n            this.registerInput(name, {\r\n              type: \"color\",\r\n              set: userInputSetter.bind(this, name),\r\n            });\r\n          } else {\r\n            // input was registered before js was done parsing\r\n            // patch it instead of creating a new one\r\n            // @ts-expect-error\r\n            this.getInput(name).type = \"color\";\r\n          }\r\n        }\r\n      });\r\n\r\n      // @ts-expect-error\r\n      Object.keys(this.model.outputPorts).forEach((name) => {\r\n        // @ts-expect-error\r\n        this.registerOutputIfNeeded(name);\r\n      });\r\n\r\n      this._internal.setupFunction = parser.setup;\r\n      this._internal.runFunction = parser.change; // Run function is actually called change\r\n      this._internal.destroyFunction = parser.destroy;\r\n\r\n      // @ts-expect-error\r\n      this._internal.definedObject = parser.definedObject;\r\n\r\n      if (this._internal.setupFunction) {\r\n        scheduleSetup.call(this);\r\n      }\r\n\r\n      if (this._internal.runFunction) {\r\n        scheduleRun.call(this);\r\n      }\r\n\r\n      this._internal.hasParsedCode = true;\r\n\r\n      // set all the inputs that arrived before the code was parsed\r\n      if (this._internal.inputQueue) {\r\n        for (const { name, value } of this._internal.inputQueue) {\r\n          this.setInputValue(name, value);\r\n        }\r\n\r\n        // delete the queue, not needed anymore\r\n        // @ts-expect-error\r\n        this._internal.inputQueue = undefined;\r\n      }\r\n\r\n      // Node API\r\n      parser.apis.Node.Inputs = this._internal.inputValues;\r\n      parser.apis.Node.Outputs = this._internal.outputProperties;\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      this._internal.inputValues[name] = undefined;\r\n\r\n      this.registerInput(name, {\r\n        set: userInputSetter.bind(this, name),\r\n      });\r\n    },\r\n    registerOutputIfNeeded(name: string) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      const self = this;\r\n\r\n      const isSignal =\r\n        // @ts-expect-error\r\n        _typename(this.model.outputPorts[name].type) === \"signal\";\r\n\r\n      Object.defineProperty(this._internal.outputProperties, name, {\r\n        set(value) {\r\n          if (isSignal) return; // Cannot set signal functions\r\n\r\n          self._internal.outputValues[name] = value;\r\n          self.flagOutputDirty(name);\r\n        },\r\n        get() {\r\n          if (isSignal)\r\n            return () => {\r\n              if (self.hasOutput(name)) self.sendSignalOnOutput(name);\r\n            };\r\n          return self._internal.outputValues[name];\r\n        },\r\n      });\r\n\r\n      this.registerOutput(name, {\r\n        getter: userOutputGetter.bind(this, name),\r\n      });\r\n    },\r\n    _callRunFunction() {\r\n      const internal = this._internal;\r\n      if (!internal.runFunction || internal.killed) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        internal.runFunction.call(\r\n          internal.userFunctionScope,\r\n          internal.inputValues,\r\n          internal.outputProperties,\r\n          internal.changedInputs\r\n        );\r\n      } catch (e) {\r\n        logJavaScriptNodeError(e);\r\n\r\n        if (\r\n          this.context.editorConnection &&\r\n          this.context.isWarningTypeEnabled(\"javascriptExecution\")\r\n        ) {\r\n          this.context.editorConnection.sendWarning(\r\n            // @ts-expect-error\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"js-run-waring\",\r\n            {\r\n              showGlobally: true,\r\n              // @ts-expect-error\r\n              message: \"<strong>run</strong>: \" + e.message,\r\n            }\r\n          );\r\n        }\r\n      }\r\n    },\r\n    _callSignalFunction(name: string) {\r\n      const internal = this._internal;\r\n      // @ts-expect-error\r\n      if (!internal.definedObject || internal.killed) {\r\n        return;\r\n      }\r\n\r\n      if (\r\n        // @ts-expect-error\r\n        !internal.definedObject[name] ||\r\n        // @ts-expect-error\r\n        typeof internal.definedObject[name] !== \"function\"\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // @ts-expect-error\r\n        internal.definedObject[name].call(\r\n          internal.userFunctionScope,\r\n          internal.inputValues,\r\n          internal.outputProperties\r\n        );\r\n      } catch (e) {\r\n        console.log(\r\n          \"Error in JS node signal function code.\",\r\n          // @ts-expect-error\r\n          Object.getPrototypeOf(e).constructor.name + \": \" + e.message\r\n        );\r\n        if (\r\n          this.context.editorConnection &&\r\n          this.context.isWarningTypeEnabled(\"javascriptExecution\")\r\n        ) {\r\n          this.context.editorConnection.sendWarning(\r\n            // @ts-expect-error\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"js-run-waring\",\r\n            {\r\n              showGlobally: true,\r\n              // @ts-expect-error\r\n              message: \"<strong>run</strong>: \" + e.message,\r\n            }\r\n          );\r\n        }\r\n      }\r\n    },\r\n    _callDestroyFunction() {\r\n      const internal = this._internal;\r\n\r\n      if (!internal.destroyFunction) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        internal.destroyFunction.call(\r\n          internal.userFunctionScope,\r\n          internal.inputValues,\r\n          internal.outputProperties\r\n        );\r\n      } catch (e) {\r\n        console.log(\r\n          \"Error in JS node destroy code.\",\r\n          // @ts-expect-error\r\n          Object.getPrototypeOf(e).constructor.name + \": \" + e.message\r\n        );\r\n        if (\r\n          this.context.editorConnection &&\r\n          this.context.isWarningTypeEnabled(\"javascriptExecution\")\r\n        ) {\r\n          this.context.editorConnection.sendWarning(\r\n            // @ts-expect-error\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"js-destroy-waring\",\r\n            {\r\n              showGlobally: true,\r\n              // @ts-expect-error\r\n              message: \"<strong>setup</strong>: \" + e.message,\r\n            }\r\n          );\r\n        }\r\n      }\r\n    },\r\n    _callSetupFunction() {\r\n      const internal = this._internal;\r\n      if (!internal.setupFunction || internal.killed) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        internal.setupFunction.call(\r\n          internal.userFunctionScope,\r\n          internal.inputValues,\r\n          internal.outputProperties\r\n        );\r\n      } catch (e) {\r\n        console.log(\r\n          \"Error in JS node setup code.\",\r\n          // @ts-expect-error\r\n          Object.getPrototypeOf(e).constructor.name + \": \" + e.message\r\n        );\r\n        if (\r\n          this.context.editorConnection &&\r\n          this.context.isWarningTypeEnabled(\"javascriptExecution\")\r\n        ) {\r\n          this.context.editorConnection.sendWarning(\r\n            // @ts-expect-error\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"js-setup-waring\",\r\n            {\r\n              showGlobally: true,\r\n              // @ts-expect-error\r\n              message: \"<strong>setup</strong>: \" + e.message,\r\n            }\r\n          );\r\n        }\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nfunction scheduleSetup() {\r\n  // @ts-expect-error\r\n  if (this._internal.setupScheduled) {\r\n    return;\r\n  }\r\n\r\n  // @ts-expect-error\r\n  this._internal.setupScheduled = true;\r\n  // @ts-expect-error\r\n  this.scheduleAfterInputsHaveUpdated(function () {\r\n    // @ts-expect-error\r\n    if (!this._internal.killed) {\r\n      // @ts-expect-error\r\n      this._callSetupFunction();\r\n      // @ts-expect-error\r\n      this._internal.setupScheduled = false;\r\n    }\r\n  });\r\n}\r\n\r\nfunction scheduleRun() {\r\n  // @ts-expect-error\r\n  if (this._internal.runScheduled || this._internal.killed) {\r\n    return;\r\n  }\r\n\r\n  // @ts-expect-error\r\n  this._internal.runScheduled = true;\r\n  // @ts-expect-error\r\n  this.scheduleAfterInputsHaveUpdated(function () {\r\n    // @ts-expect-error\r\n    if (!this._internal.killed) {\r\n      // @ts-expect-error\r\n      this._callRunFunction();\r\n      // @ts-expect-error\r\n      this._internal.changedInputs = {};\r\n      // @ts-expect-error\r\n      this._internal.runScheduled = false;\r\n    }\r\n  });\r\n}\r\n\r\nfunction scheduleSignal(name: string) {\r\n  // @ts-expect-error\r\n  if (this._internal.signalScheduled[name] || this._internal.killed) {\r\n    return;\r\n  }\r\n\r\n  // @ts-expect-error\r\n  this._internal.signalScheduled[name] = true;\r\n  // @ts-expect-error\r\n  this.scheduleAfterInputsHaveUpdated(function () {\r\n    // @ts-expect-error\r\n    if (!this._internal.killed) {\r\n      // @ts-expect-error\r\n      this._callSignalFunction(name);\r\n      // @ts-expect-error\r\n      this._internal.signalScheduled[name] = false;\r\n    }\r\n  });\r\n}\r\n\r\nfunction onFrameStart() {\r\n  // @ts-expect-error\r\n  this._internal.runNextFrame = false;\r\n  // @ts-expect-error\r\n  scheduleRun.call(this);\r\n}\r\n\r\nfunction _typename(type: any) {\r\n  if (typeof type === \"string\") return type;\r\n  else return type.name;\r\n}\r\n\r\nfunction userInputSetter(name: string, value: any) {\r\n  // @ts-expect-error\r\n  if (this._internal.hasParsedCode === true) {\r\n    if (\r\n      // @ts-expect-error\r\n      this.model.inputPorts[name] !== undefined &&\r\n      // @ts-expect-error\r\n      _typename(this.model.inputPorts[name].type) === \"signal\"\r\n    ) {\r\n      // If this is a signal, call the signal function\r\n      if (\r\n        // @ts-expect-error\r\n        this._internal.definedObject &&\r\n        // @ts-expect-error\r\n        typeof this._internal.definedObject[name] === \"function\"\r\n      ) {\r\n        // This is a signal input, schedule a call to the signal function\r\n        // @ts-expect-error\r\n        if (value) scheduleSignal.call(this, name);\r\n      }\r\n    } else {\r\n      // @ts-expect-error\r\n      this._internal.inputValues[name] = value;\r\n      // @ts-expect-error\r\n      this._internal.changedInputs[name] = true;\r\n      // @ts-expect-error\r\n      scheduleRun.call(this);\r\n    }\r\n  } else {\r\n    // inputs are arriving before the code is parsed\r\n    // queue them up and set them later to make sure signals are\r\n    // properly recognized\r\n    // @ts-expect-error\r\n    this._internal.inputQueue.push({\r\n      name,\r\n      value,\r\n    });\r\n  }\r\n}\r\n\r\nfunction userOutputGetter(name: string) {\r\n  // @ts-expect-error\r\n  return this._internal.outputValues[name];\r\n}\r\n\r\nfunction _parseAndSourceJavascript(\r\n  nodeModel: any,\r\n  context: any,\r\n  fn: (ports: any) => void\r\n) {\r\n  const editorConnection = context.editorConnection;\r\n\r\n  if (!nodeModel.parameters) {\r\n    return;\r\n  }\r\n\r\n  function clearWarnings() {\r\n    for (const w of [\r\n      \"js-parse-waring\",\r\n      \"js-destroy-waring\",\r\n      \"js-run-waring\",\r\n      \"js-setup-waring\",\r\n    ]) {\r\n      editorConnection.clearWarning(nodeModel.component.name, nodeModel.id, w);\r\n    }\r\n  }\r\n\r\n  function onCodeParsed(parser: any) {\r\n    if (parser.error) {\r\n      editorConnection.sendWarning(\r\n        nodeModel.component.name,\r\n        nodeModel.id,\r\n        \"js-parse-waring\",\r\n        {\r\n          showGlobally: true,\r\n          message: parser.error,\r\n        }\r\n      );\r\n    } else {\r\n      clearWarnings();\r\n    }\r\n\r\n    fn(parser.getPorts());\r\n  }\r\n\r\n  if (\r\n    nodeModel.parameters.externalFile &&\r\n    nodeModel.parameters.useExternalFile === \"yes\"\r\n  ) {\r\n    const url = nodeModel.parameters.externalFile;\r\n    JavascriptNodeParser.createFromURL(url, onCodeParsed);\r\n  } else if (nodeModel.parameters.code) {\r\n    const parser = JavascriptNodeParser.createFromCode(\r\n      nodeModel.parameters.code\r\n    );\r\n    onCodeParsed(parser);\r\n  } else {\r\n    // no code, just send empty port list\r\n    clearWarnings();\r\n    fn([]);\r\n  }\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    function _updatePorts() {\r\n      const ports: any[] = [];\r\n\r\n      const _inputTypeEnums = [\r\n        {\r\n          value: \"string\",\r\n          label: \"String\",\r\n        },\r\n        {\r\n          value: \"boolean\",\r\n          label: \"Boolean\",\r\n        },\r\n        {\r\n          value: \"number\",\r\n          label: \"Number\",\r\n        },\r\n        {\r\n          value: \"object\",\r\n          label: \"Object\",\r\n        },\r\n        {\r\n          value: \"array\",\r\n          label: \"Array\",\r\n        },\r\n      ];\r\n\r\n      const _outputTypeEnums = [\r\n        {\r\n          value: \"string\",\r\n          label: \"String\",\r\n        },\r\n        {\r\n          value: \"boolean\",\r\n          label: \"Boolean\",\r\n        },\r\n        {\r\n          value: \"number\",\r\n          label: \"Number\",\r\n        },\r\n        {\r\n          value: \"object\",\r\n          label: \"Object\",\r\n        },\r\n        {\r\n          value: \"array\",\r\n          label: \"Array\",\r\n        },\r\n        {\r\n          value: \"signal\",\r\n          label: \"Signal\",\r\n        },\r\n      ];\r\n\r\n      // Outputs\r\n      if (\r\n        node.parameters[\"scriptOutputs\"] !== undefined &&\r\n        node.parameters[\"scriptOutputs\"].length > 0\r\n      ) {\r\n        node.parameters[\"scriptOutputs\"].forEach((p: any) => {\r\n          // Type for output\r\n          ports.push({\r\n            name: \"outtype-\" + p.label,\r\n            displayName: \"Type\",\r\n            plug: \"input\",\r\n            type: {\r\n              name: \"enum\",\r\n              enums: _outputTypeEnums,\r\n              allowEditOnly: true,\r\n            },\r\n            default: \"string\",\r\n            parent: \"scriptOutputs\",\r\n            parentItemId: p.id,\r\n          });\r\n\r\n          // Value for output\r\n          ports.push({\r\n            name: p.label,\r\n            plug: \"output\",\r\n            type: node.parameters[\"outtype-\" + p.label] || \"*\",\r\n            group: \"Outputs\",\r\n          });\r\n        });\r\n      }\r\n\r\n      // Inputs\r\n      if (\r\n        node.parameters[\"scriptInputs\"] !== undefined &&\r\n        node.parameters[\"scriptInputs\"].length > 0\r\n      ) {\r\n        node.parameters[\"scriptInputs\"].forEach((p: any) => {\r\n          // Type for input\r\n          ports.push({\r\n            name: \"intype-\" + p.label,\r\n            displayName: \"Type\",\r\n            plug: \"input\",\r\n            type: {\r\n              name: \"enum\",\r\n              enums: _inputTypeEnums,\r\n              allowEditOnly: true,\r\n            },\r\n            default: \"string\",\r\n            parent: \"scriptInputs\",\r\n            parentItemId: p.id,\r\n          });\r\n\r\n          // Default Value for input\r\n          ports.push({\r\n            name: p.label,\r\n            plug: \"input\",\r\n            type: node.parameters[\"intype-\" + p.label] || \"string\",\r\n            group: \"Inputs\",\r\n          });\r\n        });\r\n      }\r\n\r\n      _parseAndSourceJavascript(node, context, function (_ports: any) {\r\n        // Merge in ports from script\r\n        _ports.forEach((p: any) => {\r\n          if (ports.find((_p) => _p.name === p.name && _p.plug === p.plug))\r\n            return; // Port already exists\r\n\r\n          ports.push(p);\r\n        });\r\n\r\n        context.editorConnection?.sendDynamicPorts(node.id, ports);\r\n      });\r\n    }\r\n\r\n    _updatePorts();\r\n    node.on(\"parameterUpdated\", function () {\r\n      _updatePorts();\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.Javascript2\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"Javascript2\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  _currentInputValue: number;\r\n  _remappedValue: number;\r\n  _minInputValue: number;\r\n  _maxInputValue: number;\r\n  _minOutputValue: number;\r\n  _maxOutputValue: number;\r\n  _clampOutput: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Number Remapper\",\r\n  docs: \"https://docs.noodl.net/nodes/math/number-remapper\",\r\n  category: \"Math\",\r\n  initialize() {\r\n    const internal = this._internal;\r\n    internal._currentInputValue = 0;\r\n    internal._remappedValue = 0;\r\n    internal._minInputValue = 0;\r\n    internal._maxInputValue = 0;\r\n    internal._minOutputValue = 0;\r\n    internal._maxOutputValue = 1;\r\n    internal._clampOutput = true;\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal._remappedValue;\r\n  },\r\n  inputs: {\r\n    inputValue: {\r\n      group: \"Value to Remap\",\r\n      type: {\r\n        name: \"number\",\r\n        allowConnectionOnly: true,\r\n      },\r\n      default: 0,\r\n      displayName: \"Input Value\",\r\n      set(value: number) {\r\n        this._internal._currentInputValue = value;\r\n        // @ts-expect-error\r\n        this._calculateNewOutputValue();\r\n      },\r\n    },\r\n    minInputValue: {\r\n      group: \"Input Parameters\",\r\n      type: {\r\n        name: \"number\",\r\n      },\r\n      default: 0,\r\n      displayName: \"Input Minimum\",\r\n      set(value: number) {\r\n        this._internal._minInputValue = value;\r\n        // @ts-expect-error\r\n        this._calculateNewOutputValue();\r\n      },\r\n    },\r\n    maxInputValue: {\r\n      group: \"Input Parameters\",\r\n      type: {\r\n        name: \"number\",\r\n      },\r\n      default: 0,\r\n      displayName: \"Input Maximum\",\r\n      set(value: number) {\r\n        this._internal._maxInputValue = value;\r\n        // @ts-expect-error\r\n        this._calculateNewOutputValue();\r\n      },\r\n    },\r\n    minOutputValue: {\r\n      group: \"Output Parameters\",\r\n      type: {\r\n        name: \"number\",\r\n      },\r\n      default: 0,\r\n      displayName: \"Output Minimum\",\r\n      set(value: number) {\r\n        this._internal._minOutputValue = value;\r\n        // @ts-expect-error\r\n        this._calculateNewOutputValue();\r\n      },\r\n    },\r\n    maxOutputValue: {\r\n      group: \"Output Parameters\",\r\n      type: {\r\n        name: \"number\",\r\n      },\r\n      default: 1,\r\n      displayName: \"Output Maximum\",\r\n      set(value: number) {\r\n        this._internal._maxOutputValue = value;\r\n        // @ts-expect-error\r\n        this._calculateNewOutputValue();\r\n      },\r\n    },\r\n    clamp: {\r\n      group: \"Output Parameters\",\r\n      type: {\r\n        name: \"boolean\",\r\n        allowEditOnly: true,\r\n      },\r\n      default: true,\r\n      displayName: \"Clamp Output\",\r\n      set(value: boolean) {\r\n        this._internal._clampOutput = value;\r\n        // @ts-expect-error\r\n        this._calculateNewOutputValue();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    remappedValue: {\r\n      type: \"number\",\r\n      displayName: \"Remapped Value\",\r\n      group: \"Outputs\",\r\n      getter() {\r\n        return this._internal._remappedValue;\r\n      },\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    _calculateNewOutputValue() {\r\n      let normalizedValue: number;\r\n      const internal = this._internal;\r\n\r\n      if (internal._maxInputValue === internal._minInputValue) {\r\n        normalizedValue = 0;\r\n      } else {\r\n        normalizedValue =\r\n          (internal._currentInputValue - internal._minInputValue) /\r\n          (internal._maxInputValue - internal._minInputValue);\r\n      }\r\n\r\n      if (internal._clampOutput) {\r\n        normalizedValue = Math.max(0, Math.min(1, normalizedValue));\r\n      }\r\n      internal._remappedValue =\r\n        internal._minOutputValue +\r\n        normalizedValue * (internal._maxOutputValue - internal._minOutputValue);\r\n      this.flagOutputDirty(\"remappedValue\");\r\n    },\r\n  },\r\n};\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  file?: File;\r\n  inputElement: HTMLInputElement;\r\n  acceptedFileTypes?: string;\r\n  capture?: string;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Open File Picker\",\r\n  docs: \"https://docs.noodl.net/nodes/utilities/open-file-picker\",\r\n  category: \"Utilities\",\r\n  getInspectInfo() {\r\n    if (this._internal.file) {\r\n      // @ts-expect-error\r\n      return this._internal.file.path;\r\n    }\r\n  },\r\n  initialize() {\r\n    //for some reason the input element has to be created here, it doesn't\r\n    //work predictably in Safari when created in the open signal function.\r\n    //Creating it here and reusing it seems to work correctly in all browsers.\r\n    const input = document.createElement(\"input\");\r\n    input.type = \"file\";\r\n\r\n    this._internal.inputElement = input;\r\n  },\r\n  inputs: {\r\n    open: {\r\n      type: \"signal\",\r\n      displayName: \"Open\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        const input = this._internal.inputElement;\r\n\r\n        const onChange = (e: Event) => {\r\n          const target = e.target as HTMLInputElement;\r\n          this._internal.file = target.files ? target.files[0] : undefined;\r\n\r\n          this.flagOutputDirty(\"file\");\r\n          this.flagOutputDirty(\"path\");\r\n          this.flagOutputDirty(\"name\");\r\n          this.flagOutputDirty(\"sizeInBytes\");\r\n          this.flagOutputDirty(\"type\");\r\n\r\n          this.sendSignalOnOutput(\"success\");\r\n\r\n          input.onchange = null;\r\n          input.value = \"\"; //reset value so the same file can be picked again\r\n        };\r\n\r\n        input.accept = this._internal.acceptedFileTypes || \"\";\r\n\r\n        if (this._internal.capture) {\r\n          input.capture = this._internal.capture;\r\n        }\r\n\r\n        input.onchange = onChange;\r\n        input.click();\r\n      },\r\n    },\r\n    acceptedFileTypes: {\r\n      group: \"General\",\r\n      type: \"string\",\r\n      displayName: \"Accepted file types\",\r\n      set(value: string) {\r\n        this._internal.acceptedFileTypes = value;\r\n      },\r\n    },\r\n    capture: {\r\n      group: \"General\",\r\n      type: \"string\",\r\n      displayName: \"Capture\",\r\n      set(value: string) {\r\n        this._internal.capture = value;\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    file: {\r\n      type: \"*\",\r\n      displayName: \"File\",\r\n      group: \"General\",\r\n      get() {\r\n        return this._internal.file;\r\n      },\r\n    },\r\n    path: {\r\n      displayName: \"Path\",\r\n      group: \"Metadata\",\r\n      type: \"string\",\r\n      get() {\r\n        // @ts-expect-error\r\n        return this._internal.file && this._internal.file.path;\r\n      },\r\n    },\r\n    name: {\r\n      displayName: \"Name\",\r\n      group: \"Metadata\",\r\n      type: \"string\",\r\n      get() {\r\n        return this._internal.file && this._internal.file.name;\r\n      },\r\n    },\r\n    sizeInBytes: {\r\n      displayName: \"Size in bytes\",\r\n      group: \"Metadata\",\r\n      type: \"number\",\r\n      get() {\r\n        return this._internal.file && this._internal.file.size;\r\n      },\r\n    },\r\n    type: {\r\n      displayName: \"Type\",\r\n      group: \"Metadata\",\r\n      type: \"string\",\r\n      get() {\r\n        return this._internal.file && this._internal.file.type;\r\n      },\r\n    },\r\n    success: {\r\n      type: \"signal\",\r\n      group: \"Events\",\r\n      displayName: \"Success\",\r\n    },\r\n  },\r\n};\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Screen Resolution\",\r\n  docs: \"https://docs.noodl.net/nodes/utilities/screen-resolution\",\r\n  category: \"Utilities\",\r\n  initialize() {\r\n    // Add SSR Support\r\n    if (typeof window === \"undefined\") return;\r\n\r\n    window.addEventListener(\"resize\", () => {\r\n      // @ts-expect-error\r\n      this._viewportSizeChanged();\r\n    });\r\n    // @ts-expect-error\r\n    this._viewportSizeChanged();\r\n  },\r\n  getInspectInfo() {\r\n    return `${this._internal.width} x ${this._internal.height}`;\r\n  },\r\n  outputs: {\r\n    width: {\r\n      type: \"number\",\r\n      displayName: \"Width\",\r\n      get() {\r\n        return this._internal.width;\r\n      },\r\n    },\r\n    height: {\r\n      type: \"number\",\r\n      displayName: \"Height\",\r\n      get() {\r\n        return this._internal.height;\r\n      },\r\n    },\r\n    aspectRatio: {\r\n      type: \"number\",\r\n      displayName: \"Aspect Ratio\",\r\n      get() {\r\n        return this._internal.width / this._internal.height;\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    _viewportSizeChanged() {\r\n      this._internal.width = window.innerWidth;\r\n      this._internal.height = window.innerHeight;\r\n      this.flagAllOutputsDirty();\r\n    },\r\n  },\r\n};\r\n","import {\r\n  createSetter,\r\n  GraphModel,\r\n  NodeContext,\r\n  NodeDefinition,\r\n} from \"@fluxscape/runtime\";\r\nimport EaseCurves from \"../../easecurves\";\r\nimport BezierEasing from \"bezier-easing\";\r\n\r\nconst defaultDuration = 300;\r\nconst previousStates: Record<string, string[]> = {};\r\nconst previousValues: Record<string, string[]> = {};\r\n\r\nfunction setRGBA(result: number[], hex: string) {\r\n  if (hex === \"transparent\" || !hex) {\r\n    result[3] = 0;\r\n    return;\r\n  }\r\n\r\n  const numComponents = (hex.length - 1) / 2;\r\n\r\n  for (let i = 0; i < numComponents; ++i) {\r\n    const index = 1 + i * 2;\r\n    result[i] = parseInt(hex.substring(index, index + 2), 16);\r\n  }\r\n}\r\n\r\nfunction componentToHex(c: number): string {\r\n  const hex = c.toString(16);\r\n  return hex.length === 1 ? \"0\" + hex : hex;\r\n}\r\n\r\nfunction rgbaToHex(rgba: number[]): string {\r\n  return (\r\n    \"#\" +\r\n    componentToHex(rgba[0]) +\r\n    componentToHex(rgba[1]) +\r\n    componentToHex(rgba[2]) +\r\n    componentToHex(rgba[3])\r\n  );\r\n}\r\n\r\ninterface Internal {\r\n  useTransitions: boolean;\r\n  currentValues: Record<string, any>;\r\n  stateParameters: Record<string, any>;\r\n  stateParameterTypes: Record<string, any>;\r\n  startValues: Record<string, any>;\r\n  bezierEaseCurves: Record<string, any>;\r\n  transitionFuncs: Record<string, any>;\r\n  valuesAreInitialised: boolean;\r\n  animation: any; // Replace with actual type if known\r\n  states?: string[];\r\n  state?: string;\r\n  startState?: string;\r\n  goToState?: string;\r\n  values?: string[];\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"States\",\r\n  docs: \"https://docs.noodl.net/nodes/utilities/logic/states\",\r\n  shortDesc:\r\n    \"Define states with values and this node can interpolate between these values when the state is changed.\",\r\n  category: \"Animation\",\r\n  initialize() {\r\n    const _this = this;\r\n    const _internal = this._internal;\r\n\r\n    _internal.useTransitions = true;\r\n    _internal.currentValues = {};\r\n    _internal.stateParameters = {};\r\n    _internal.stateParameterTypes = {};\r\n    _internal.startValues = {};\r\n    _internal.bezierEaseCurves = {};\r\n    _internal.transitionFuncs = {};\r\n\r\n    _internal.valuesAreInitialised = false;\r\n    _internal.animation = this.context.timerScheduler.createTimer({\r\n      duration: defaultDuration,\r\n      ease: EaseCurves.easeOut,\r\n      onStart() {\r\n        const startValues = _internal.startValues;\r\n        const stateValues = _internal.stateParameters;\r\n        const valueTypes = _internal.stateParameterTypes;\r\n        const prefix = \"value-\" + _internal.state + \"-\";\r\n\r\n        this.targetValues = {};\r\n        this.startValues = {};\r\n        this.valueTypes = {};\r\n\r\n        for (const v in this.transitionCurves) {\r\n          if (\r\n            valueTypes[\"type-\" + v] === \"number\" ||\r\n            valueTypes[\"type-\" + v] === undefined\r\n          ) {\r\n            this.valueTypes[v] = \"number\";\r\n            this.startValues[v] = startValues[v];\r\n            this.targetValues[v] = stateValues[prefix + v] || 0;\r\n          } else if (valueTypes[\"type-\" + v] === \"color\") {\r\n            this.valueTypes[v] = \"color\";\r\n\r\n            this.startValues[v] = [0, 0, 0, 255];\r\n            setRGBA(\r\n              this.startValues[v],\r\n              _this.context.styles?.resolveColor(startValues[v] || \"#000000\")\r\n            );\r\n\r\n            this.targetValues[v] = [0, 0, 0, 255];\r\n            setRGBA(\r\n              this.targetValues[v],\r\n              _this.context.styles?.resolveColor(\r\n                stateValues[prefix + v] || \"#000000\"\r\n              )\r\n            );\r\n          }\r\n        }\r\n      },\r\n      onRunning(t) {\r\n        const ms = t * this.duration!;\r\n        const currentValues = _internal.currentValues;\r\n\r\n        const rgba2 = [0, 0, 0, 255];\r\n        for (const v in this.transitionCurves) {\r\n          const c = this.transitionCurves[v];\r\n\r\n          if (ms < c.delay) currentValues[v] = this.startValues[v];\r\n          else if (ms >= c.delay + c.dur)\r\n            currentValues[v] =\r\n              this.valueTypes[v] === \"color\"\r\n                ? rgbaToHex(this.targetValues[v])\r\n                : this.targetValues[v];\r\n          else {\r\n            const _t = _internal.transitionFuncs[v].get((ms - c.delay) / c.dur);\r\n            if (this.valueTypes[v] === \"number\") {\r\n              currentValues[v] = EaseCurves.linear(\r\n                Number(this.startValues[v]),\r\n                Number(this.targetValues[v]),\r\n                _t\r\n              );\r\n            } else if (this.valueTypes[v] === \"color\") {\r\n              const rgba0 = this.startValues[v];\r\n              const rgba1 = this.targetValues[v];\r\n              rgba2[0] = Math.floor(EaseCurves.linear(rgba0[0], rgba1[0], _t));\r\n              rgba2[1] = Math.floor(EaseCurves.linear(rgba0[1], rgba1[1], _t));\r\n              rgba2[2] = Math.floor(EaseCurves.linear(rgba0[2], rgba1[2], _t));\r\n              rgba2[3] = Math.floor(EaseCurves.linear(rgba0[3], rgba1[3], _t));\r\n\r\n              currentValues[v] = rgbaToHex(rgba2);\r\n            }\r\n          }\r\n          _this.flagOutputDirty(v);\r\n        }\r\n      },\r\n      onFinish() {\r\n        const port = \"reached-\" + _internal.state;\r\n        if (_this.hasOutput(port)) _this.sendSignalOnOutput(port);\r\n      },\r\n    });\r\n  },\r\n  getInspectInfo() {\r\n    return `Current state: ${this._internal.state}`;\r\n  },\r\n  inputs: {\r\n    states: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      displayName: \"States\",\r\n      group: \"States\",\r\n      set(value: string) {\r\n        this._internal.states = value ? value.split(\",\") : [];\r\n\r\n        if (this._internal.states.length > 0) {\r\n          const _this = this;\r\n          if (!_this._internal.state)\r\n            // @ts-expect-error\r\n            this.scheduleGoToState(\r\n              // @ts-expect-error\r\n              _this._internal.startState || _this._internal.states[0]\r\n            );\r\n        }\r\n      },\r\n    },\r\n    values: {\r\n      type: { name: \"stringlist\", allowEditOnly: true },\r\n      displayName: \"Values\",\r\n      group: \"Values\",\r\n      set(value: string) {\r\n        const internal = this._internal;\r\n        internal.values = value.split(\",\");\r\n\r\n        for (const i in internal.values) {\r\n          // @ts-expect-error\r\n          this.registerOutputIfNeeded(internal.values[i]);\r\n        }\r\n      },\r\n    },\r\n    toggle: {\r\n      group: \"Go to state\",\r\n      displayName: \"Toggle\",\r\n      valueChangedToTrue() {\r\n        const internal = this._internal;\r\n        const _this = this;\r\n\r\n        if (!internal.states) return;\r\n\r\n        // @ts-expect-error\r\n        const idx = internal.states.indexOf(internal.state);\r\n        const nextIdx = (idx + 1) % internal.states.length;\r\n\r\n        // @ts-expect-error\r\n        this.scheduleGoToState(internal.states[nextIdx]);\r\n      },\r\n    },\r\n    useTransitions: {\r\n      type: \"boolean\",\r\n      displayName: \"Use Transitions\",\r\n      group: \"General\",\r\n      default: true,\r\n      set(value: boolean) {\r\n        const internal = this._internal;\r\n        internal.useTransitions = value;\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    currentState: {\r\n      type: \"string\",\r\n      displayName: \"State\",\r\n      group: \"Current State\",\r\n      getter() {\r\n        return this._internal.state;\r\n      },\r\n    },\r\n    stateChanged: {\r\n      type: \"signal\",\r\n      displayName: \"State Changed\",\r\n      group: \"Current State\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    registerOutputIfNeeded(name: string) {\r\n      const internal = this._internal;\r\n\r\n      if (this.hasOutput(name)) return;\r\n\r\n      this.registerOutput(name, {\r\n        getter() {\r\n          return internal.currentValues[name];\r\n        },\r\n      });\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      const _this = this;\r\n      const internal = this._internal;\r\n\r\n      if (this.hasInput(name)) return;\r\n\r\n      if (name.indexOf(\"to-\") === 0) {\r\n        const state = name.substring(3);\r\n        this.registerInput(name, {\r\n          set: createSetter({\r\n            valueChangedToTrue() {\r\n              // @ts-expect-error\r\n              this.scheduleGoToState(state);\r\n            },\r\n          }),\r\n        });\r\n      } else if (name === \"startState\") {\r\n        this.registerInput(name, {\r\n          set(value: string) {\r\n            this._internal.startState = value;\r\n            // @ts-expect-error\r\n            this.scheduleGoToState(value);\r\n          },\r\n        });\r\n      } else if (name === \"currentState\") {\r\n        this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.scheduleGoToState.bind(this),\r\n        });\r\n      } else if (name.indexOf(\"type-\") === 0) {\r\n        this.registerInput(name, {\r\n          set(value: string) {\r\n            internal.stateParameterTypes[name] = value;\r\n          },\r\n        });\r\n      } else if (name.indexOf(\"value-\") === 0) {\r\n        const parts = name.split(\"-\");\r\n        const state = parts[1];\r\n        const valueName = parts[2];\r\n\r\n        this.registerInput(name, {\r\n          set(value: any) {\r\n            internal.stateParameters[name] = value;\r\n            if (internal.state === state) {\r\n              internal.currentValues[valueName] = value;\r\n              _this.flagOutputDirty(valueName);\r\n            }\r\n          },\r\n        });\r\n      } else if (name.search(/duration-/g) === 0) {\r\n        this.registerInput(name, {\r\n          set(value: any) {\r\n            internal.stateParameters[name] = value;\r\n          },\r\n        });\r\n      } else if (name.search(/transition/g) === 0) {\r\n        const state = name.substring(11);\r\n        this.registerInput(name, {\r\n          set(value: any) {\r\n            internal.stateParameters[name] = value;\r\n          },\r\n        });\r\n      }\r\n    },\r\n    setCurrentState(value: string) {\r\n      // @ts-expect-error\r\n      this.scheduleGoToState(value);\r\n    },\r\n    jumpToState(state: string) {\r\n      const internal = this._internal;\r\n      if (!internal.states) return;\r\n      if (!state) state = internal.states[0];\r\n      if (internal.state === state) return;\r\n\r\n      internal.animation.stop();\r\n\r\n      const prefix = \"value-\" + state + \"-\";\r\n      for (const i in internal.values) {\r\n        const v = internal.values[i];\r\n\r\n        internal.currentValues[v] = internal.stateParameters[prefix + v] || 0;\r\n\r\n        this.flagOutputDirty(v);\r\n      }\r\n\r\n      internal.state = state;\r\n      this.flagOutputDirty(\"currentState\");\r\n\r\n      if (internal.valuesAreInitialised) {\r\n        this.sendSignalOnOutput(\"stateChanged\");\r\n      }\r\n      internal.valuesAreInitialised = true;\r\n\r\n      // @ts-expect-error\r\n      this.updateAtStatePorts();\r\n    },\r\n    scheduleGoToState(state: string) {\r\n      const _this = this;\r\n\r\n      this._internal.goToState = state;\r\n\r\n      // @ts-expect-error\r\n      if (this.hasScheduledGoToState) return;\r\n      // @ts-expect-error\r\n      this.hasScheduledGoToState = true;\r\n      this.scheduleAfterInputsHaveUpdated(function () {\r\n        // @ts-expect-error\r\n        _this.hasScheduledGoToState = false;\r\n        // @ts-expect-error\r\n        _this.goToState(_this._internal.goToState);\r\n      });\r\n    },\r\n    goToState(state: string) {\r\n      const internal = this._internal;\r\n      if (!internal.states) return;\r\n      if (!state) state = internal.states[0];\r\n      if (internal.state === state) return;\r\n\r\n      if (!internal.valuesAreInitialised) {\r\n        // @ts-expect-error\r\n        this.jumpToState(state);\r\n      } else {\r\n        let delay = 0;\r\n        let dur = 0;\r\n        const transitionCurves: Record<string, any> = {};\r\n        for (const i in internal.values) {\r\n          const v = internal.values[i];\r\n\r\n          internal.startValues[v] = internal.currentValues[v];\r\n\r\n          const parameterType = internal.stateParameterTypes[\"type-\" + v];\r\n          if (parameterType === \"boolean\") {\r\n            const _b = internal.stateParameters[\"value-\" + state + \"-\" + v];\r\n            internal.currentValues[v] = _b === undefined ? false : !!_b;\r\n            this.flagOutputDirty(v);\r\n          } else if (\r\n            parameterType === \"string\" ||\r\n            parameterType === \"textStyle\"\r\n          ) {\r\n            internal.currentValues[v] =\r\n              internal.stateParameters[\"value-\" + state + \"-\" + v];\r\n            this.flagOutputDirty(v);\r\n          } else {\r\n            let transitionCurve =\r\n              internal.stateParameters[\"transition-\" + state + \"-\" + v];\r\n            if (!transitionCurve)\r\n              transitionCurve = internal.stateParameters[\r\n                \"transitiondef-\" + state\r\n              ] || {\r\n                curve: [0.0, 0.0, 0.58, 1.0],\r\n                dur: 300,\r\n                delay: 0,\r\n              };\r\n\r\n            if (\r\n              (transitionCurve.dur === 0 && transitionCurve.delay === 0) ||\r\n              !internal.useTransitions\r\n            ) {\r\n              internal.currentValues[v] =\r\n                internal.stateParameters[\"value-\" + state + \"-\" + v];\r\n              this.flagOutputDirty(v);\r\n            } else {\r\n              internal.transitionFuncs[v] = BezierEasing(transitionCurve.curve);\r\n              transitionCurves[v] = transitionCurve;\r\n              delay = Math.min(delay, transitionCurve.delay);\r\n              dur = Math.max(dur, transitionCurve.dur + transitionCurve.delay);\r\n            }\r\n          }\r\n        }\r\n\r\n        if (dur > 0 || delay > 0) {\r\n          internal.animation.transitionCurves = transitionCurves;\r\n          internal.animation.duration = dur;\r\n          internal.animation.delay = delay;\r\n          internal.animation.start();\r\n        }\r\n\r\n        internal.state = state;\r\n        this.flagOutputDirty(\"currentState\");\r\n\r\n        this.sendSignalOnOutput(\"stateChanged\");\r\n        // @ts-expect-error\r\n        this.updateAtStatePorts();\r\n\r\n        if (dur === 0 && delay === 0) {\r\n          const port = \"reached-\" + internal.state;\r\n          if (this.hasOutput(port)) this.sendSignalOnOutput(port);\r\n        }\r\n      }\r\n    },\r\n    updateAtStatePorts() {\r\n      const internal = this._internal;\r\n      const states = internal.states;\r\n      for (const i in states) {\r\n        const s = states[i];\r\n        const port = \"at-\" + s;\r\n\r\n        internal.currentValues[port] = internal.state === s;\r\n        if (this.hasOutput(port)) this.flagOutputDirty(port);\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nfunction detectRename(\r\n  before: string[],\r\n  after: string[]\r\n): { before?: string; after?: string } | undefined {\r\n  if (!before || !after) return;\r\n\r\n  if (before.length !== after.length) return;\r\n\r\n  const res: { before?: string; after?: string } = {};\r\n  for (let i = 0; i < before.length; i++) {\r\n    if (after.indexOf(before[i]) === -1) {\r\n      if (res.before) return;\r\n      res.before = before[i];\r\n    }\r\n\r\n    if (before.indexOf(after[i]) === -1) {\r\n      if (res.after) return;\r\n      res.after = after[i];\r\n    }\r\n  }\r\n\r\n  return res.before && res.after ? res : undefined;\r\n}\r\n\r\nfunction updatePorts(nodeId: string, parameters: any, editorConnection: any) {\r\n  const states = parameters.states;\r\n  const values = parameters.values;\r\n\r\n  const ports: any[] = [];\r\n\r\n  const valueArray = values ? values.split(\",\") : undefined;\r\n  for (const p of valueArray || []) {\r\n    ports.push({\r\n      type: {\r\n        name: parameters[\"type-\" + p] || \"number\",\r\n        allowConnectionsOnly: true,\r\n      },\r\n      plug: \"output\",\r\n      group: \"Values\",\r\n      name: p,\r\n    });\r\n\r\n    ports.push({\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Number\", value: \"number\" },\r\n          { label: \"String\", value: \"string\" },\r\n          { label: \"Boolean\", value: \"boolean\" },\r\n          { label: \"Color\", value: \"color\" },\r\n          { label: \"Text Style\", value: \"textStyle\" },\r\n        ],\r\n        allowEditOnly: true,\r\n      },\r\n      default: \"number\",\r\n      plug: \"input\",\r\n      group: \"Types\",\r\n      displayName: p,\r\n      name: \"type-\" + p,\r\n    });\r\n  }\r\n\r\n  const stateArray = states ? states.split(\",\") : undefined;\r\n  stateArray &&\r\n    stateArray.forEach((state) => {\r\n      valueArray &&\r\n        valueArray.forEach((value) => {\r\n          ports.push({\r\n            plug: \"input\",\r\n            type: parameters[\"type-\" + value] || \"number\",\r\n            group: state + \" Values\",\r\n            name: \"value-\" + state + \"-\" + value,\r\n            displayName: value,\r\n            editorName: state + \"|\" + value,\r\n          });\r\n        });\r\n\r\n      if (valueArray && parameters[\"useTransitions\"] !== false) {\r\n        ports.push({\r\n          plug: \"input\",\r\n          type: \"curve\",\r\n          displayName: \"Default\",\r\n          default: { curve: [0.0, 0.0, 0.58, 1.0], dur: 300, delay: 0 },\r\n          group: state + \" Transitions\",\r\n          name: \"transitiondef-\" + state,\r\n        });\r\n\r\n        valueArray.forEach((value) => {\r\n          if (\r\n            parameters[\"type-\" + value] === undefined ||\r\n            parameters[\"type-\" + value] === \"number\" ||\r\n            parameters[\"type-\" + value] === \"color\"\r\n          ) {\r\n            ports.push({\r\n              plug: \"input\",\r\n              type: { name: \"curve\" },\r\n              default: parameters[\"transitiondef-\" + state] || {\r\n                curve: [0.0, 0.0, 0.58, 1.0],\r\n                dur: 300,\r\n                delay: 0,\r\n              },\r\n              group: state + \" Transitions\",\r\n              name: \"transition-\" + state + \"-\" + value,\r\n              displayName: value,\r\n              editorName: \"Transition \" + state + \"|\" + value,\r\n            });\r\n          }\r\n        });\r\n      }\r\n\r\n      ports.push({\r\n        plug: \"input\",\r\n        type: { name: \"signal\", allowConnectionsOnly: true },\r\n        displayName: \"To \" + state,\r\n        name: \"to-\" + state,\r\n        group: \"Go to state\",\r\n      });\r\n\r\n      ports.push({\r\n        plug: \"output\",\r\n        type: \"boolean\",\r\n        displayName: \"At \" + state,\r\n        name: \"at-\" + state,\r\n        group: \"Current state\",\r\n      });\r\n\r\n      ports.push({\r\n        plug: \"output\",\r\n        type: \"signal\",\r\n        displayName: \"Has Reached \" + state,\r\n        name: \"reached-\" + state,\r\n        group: \"Current state\",\r\n      });\r\n    });\r\n\r\n  if (states) {\r\n    ports.push({\r\n      plug: \"input\",\r\n      type: { name: \"enum\", enums: states },\r\n      group: \"States\",\r\n      displayName: \"State\",\r\n      name: \"currentState\",\r\n      default: parameters[\"startState\"] || states[0],\r\n    });\r\n  }\r\n\r\n  const stateRenamed = detectRename(previousStates[nodeId], states);\r\n  previousStates[nodeId] = states;\r\n\r\n  const valueRenamed = detectRename(previousValues[nodeId], values);\r\n  previousValues[nodeId] = values;\r\n\r\n  let renamed;\r\n  if (stateRenamed) {\r\n    renamed = {\r\n      plug: \"input\",\r\n      before: stateRenamed.before,\r\n      after: stateRenamed.after,\r\n      patterns: [\"transition-{{*}}\", \"to-{{*}}\", \"at-{{*}}\", \"reached-{{*}}\"],\r\n    };\r\n\r\n    valueArray &&\r\n      valueArray.forEach((value) => {\r\n        renamed.patterns.push(\"value-{{*}}-\" + value);\r\n      });\r\n  } else if (valueRenamed) {\r\n    renamed = [\r\n      {\r\n        plug: \"output\",\r\n        before: valueRenamed.before,\r\n        after: valueRenamed.after,\r\n        patterns: [\"{{*}}\"],\r\n      },\r\n      {\r\n        plug: \"input\",\r\n        before: valueRenamed.before,\r\n        after: valueRenamed.after,\r\n        patterns: [\"type-{{*}}\"],\r\n      },\r\n      {\r\n        plug: \"input\",\r\n        before: valueRenamed.before,\r\n        after: valueRenamed.after,\r\n        patterns: states\r\n          ? states.map((s) => {\r\n              return \"value-\" + s + \"-\" + \"{{*}}\";\r\n            })\r\n          : undefined,\r\n      },\r\n    ];\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, { renamed: renamed });\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  graphModel.on(\"nodeAdded.States\", function (node: any) {\r\n    if (node.parameters.states) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n    }\r\n    node.on(\"parameterUpdated\", function (event: any) {\r\n      if (\r\n        event.name === \"useTransitions\" ||\r\n        event.name === \"states\" ||\r\n        event.name === \"values\" ||\r\n        event.name.startsWith(\"transition\") ||\r\n        event.name.startsWith(\"type-\")\r\n      ) {\r\n        updatePorts(node.id, node.parameters, context.editorConnection);\r\n      }\r\n    });\r\n  });\r\n}\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  state: boolean;\r\n  initialized: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Switch\",\r\n  docs: \"https://docs.noodl.net/nodes/logic/switch\",\r\n  category: \"Logic\",\r\n  initialize() {\r\n    this._internal.state = false;\r\n    this._internal.initialized = false;\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.state;\r\n  },\r\n  inputs: {\r\n    on: {\r\n      displayName: \"On\",\r\n      group: \"Change State\",\r\n      valueChangedToTrue() {\r\n        if (this._internal.state === true) {\r\n          return;\r\n        }\r\n        this._internal.state = true;\r\n        this.flagOutputDirty(\"state\");\r\n        // @ts-expect-error\r\n        this.emitSignals();\r\n      },\r\n    },\r\n    off: {\r\n      displayName: \"Off\",\r\n      group: \"Change State\",\r\n      valueChangedToTrue() {\r\n        if (this._internal.state === false) {\r\n          return;\r\n        }\r\n        this._internal.state = false;\r\n        this.flagOutputDirty(\"state\");\r\n        // @ts-expect-error\r\n        this.emitSignals();\r\n      },\r\n    },\r\n    flip: {\r\n      displayName: \"Flip\",\r\n      group: \"Change State\",\r\n      valueChangedToTrue() {\r\n        this._internal.state = !this._internal.state;\r\n        this.flagOutputDirty(\"state\");\r\n        // @ts-expect-error\r\n        this.emitSignals();\r\n      },\r\n    },\r\n    onFromStart: {\r\n      type: \"boolean\",\r\n      displayName: \"State\",\r\n      group: \"General\",\r\n      default: false,\r\n      set(value) {\r\n        this._internal.state = !!value;\r\n        this.flagOutputDirty(\"state\");\r\n        // @ts-expect-error\r\n        this.emitSignals();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    state: {\r\n      type: \"boolean\",\r\n      displayName: \"Current State\",\r\n      getter() {\r\n        return this._internal.state;\r\n      },\r\n    },\r\n    switched: {\r\n      displayName: \"Switched\",\r\n      type: \"signal\",\r\n      group: \"Signals\",\r\n    },\r\n    switchedToOn: {\r\n      displayName: \"Switched To On\",\r\n      type: \"signal\",\r\n      group: \"Signals\",\r\n    },\r\n    switchedToOff: {\r\n      displayName: \"Switched To Off\",\r\n      type: \"signal\",\r\n      group: \"Signals\",\r\n    },\r\n  },\r\n  prototypeExtensions: {\r\n    emitSignals() {\r\n      if (this._internal.state === true) {\r\n        this.sendSignalOnOutput(\"switchedToOn\");\r\n      } else {\r\n        this.sendSignalOnOutput(\"switchedToOff\");\r\n      }\r\n      this.sendSignalOnOutput(\"switched\");\r\n    },\r\n  },\r\n};\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  _animation: any;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Timer\",\r\n  docs: \"https://docs.noodl.net/nodes/utilities/delay\",\r\n  displayName: \"Delay\",\r\n  category: \"Utilities\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"duration\",\r\n  },\r\n  initialize() {\r\n    const self = this;\r\n    this._internal._animation = this.context.timerScheduler.createTimer({\r\n      duration: 0,\r\n      onStart() {\r\n        self.sendSignalOnOutput(\"timerStarted\");\r\n      },\r\n      onFinish() {\r\n        self.sendSignalOnOutput(\"timerFinished\");\r\n      },\r\n    });\r\n\r\n    this.addDeleteListener(() => {\r\n      this._internal._animation.stop();\r\n    });\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal._animation.isRunning()) {\r\n      return (\r\n        Math.floor(this._internal._animation.durationLeft() / 10) / 100 +\r\n        \" seconds\"\r\n      );\r\n    }\r\n    return \"Not running\";\r\n  },\r\n  inputs: {\r\n    start: {\r\n      displayName: \"Start\",\r\n      valueChangedToTrue() {\r\n        if (this._internal._animation._isRunning === false) {\r\n          this._internal._animation.start();\r\n        }\r\n      },\r\n    },\r\n    restart: {\r\n      displayName: \"Restart\",\r\n      valueChangedToTrue() {\r\n        this._internal._animation.start();\r\n      },\r\n    },\r\n    duration: {\r\n      type: \"number\",\r\n      displayName: \"Duration\",\r\n      default: 0,\r\n      set(value) {\r\n        this._internal._animation.duration = value;\r\n      },\r\n    },\r\n    startDelay: {\r\n      type: \"number\",\r\n      displayName: \"Start Delay\",\r\n      default: 0,\r\n      set(value) {\r\n        this._internal._animation.delay = value;\r\n      },\r\n    },\r\n    stop: {\r\n      displayName: \"Stop\",\r\n      valueChangedToTrue() {\r\n        this._internal._animation.stop();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    timerStarted: {\r\n      type: \"signal\",\r\n      displayName: \"Started\",\r\n    },\r\n    timerFinished: {\r\n      type: \"signal\",\r\n      displayName: \"Finished\",\r\n    },\r\n  },\r\n};\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\nimport { CloudFile } from \"@fluxscape/runtime/src/api/cloudfile\";\r\nimport { CloudStore } from \"@fluxscape/runtime/src/api/cloudstore\";\r\n\r\ninterface Internal {\r\n  file: any;\r\n  cloudFile: CloudFile | null;\r\n  error: string | null;\r\n  errorStatus: number;\r\n  progressTotal: number;\r\n  progressLoaded: number;\r\n  response: any;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Upload File\",\r\n  docs: \"https://docs.noodl.net/nodes/data/cloud-data/upload-file\",\r\n  category: \"Cloud Services\",\r\n  color: \"data\",\r\n  getInspectInfo() {\r\n    return this._internal.response;\r\n  },\r\n  inputs: {\r\n    file: {\r\n      group: \"General\",\r\n      displayName: \"File\",\r\n      type: \"*\",\r\n      set(file: any) {\r\n        this._internal.file = file;\r\n      },\r\n    },\r\n    upload: {\r\n      type: \"signal\",\r\n      displayName: \"Upload\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const file = this._internal.file;\r\n\r\n          if (!file) {\r\n            // @ts-expect-error\r\n            this.setError(\"No file specified\");\r\n            return;\r\n          }\r\n\r\n          // @ts-expect-error\r\n          CloudStore.instance.uploadFile({\r\n            file,\r\n            onUploadProgress: (p: { total: number; loaded: number }) => {\r\n              this._internal.progressTotal = p.total;\r\n              this._internal.progressLoaded = p.loaded;\r\n\r\n              this.flagOutputDirty(\"progressTotalBytes\");\r\n              this.flagOutputDirty(\"progressLoadedBytes\");\r\n              this.flagOutputDirty(\"progressLoadedPercent\");\r\n              this.sendSignalOnOutput(\"progressChanged\");\r\n            },\r\n            success: (response: any) => {\r\n              this._internal.cloudFile = new CloudFile(response);\r\n              this.flagOutputDirty(\"cloudFile\");\r\n              this.sendSignalOnOutput(\"success\");\r\n            },\r\n            // @ts-expect-error\r\n            error: (e: any) => this.setError(e),\r\n          });\r\n        });\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    cloudFile: {\r\n      group: \"General\",\r\n      displayName: \"Cloud File\",\r\n      type: \"cloudfile\",\r\n      get() {\r\n        return this._internal.cloudFile;\r\n      },\r\n    },\r\n    success: {\r\n      group: \"Events\",\r\n      displayName: \"Success\",\r\n      type: \"signal\",\r\n    },\r\n    failure: {\r\n      group: \"Events\",\r\n      displayName: \"Failure\",\r\n      type: \"signal\",\r\n    },\r\n    error: {\r\n      type: \"string\",\r\n      displayName: \"Error\",\r\n      group: \"Error\",\r\n      get() {\r\n        return this._internal.error;\r\n      },\r\n    },\r\n    errorStatus: {\r\n      type: \"number\",\r\n      displayName: \"Error Status Code\",\r\n      group: \"Error\",\r\n      get() {\r\n        return this._internal.errorStatus;\r\n      },\r\n    },\r\n    progressChanged: {\r\n      type: \"signal\",\r\n      displayName: \"Progress Changed\",\r\n      group: \"Events\",\r\n    },\r\n    progressTotalBytes: {\r\n      type: \"number\",\r\n      displayName: \"Total Bytes\",\r\n      group: \"Progress\",\r\n      get() {\r\n        return this._internal.progressTotal;\r\n      },\r\n    },\r\n    progressLoadedBytes: {\r\n      type: \"number\",\r\n      displayName: \"Uploaded Bytes\",\r\n      group: \"Progress\",\r\n      get() {\r\n        return this._internal.progressLoaded;\r\n      },\r\n    },\r\n    progressLoadedPercent: {\r\n      type: \"number\",\r\n      displayName: \"Uploaded Percent\",\r\n      group: \"Progress\",\r\n      get() {\r\n        if (!this._internal.progressTotal) return 0;\r\n        return (\r\n          (this._internal.progressLoaded / this._internal.progressTotal) * 100\r\n        );\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    setError(err: any) {\r\n      this._internal.error = err.hasOwnProperty(\"error\") ? err.error : err;\r\n      this._internal.errorStatus = err.code || err.status || 0;\r\n      this.flagOutputDirty(\"error\");\r\n      this.flagOutputDirty(\"errorStatus\");\r\n      this.sendSignalOnOutput(\"failure\");\r\n    },\r\n  },\r\n};\r\n","import UserService from \"./userservice\";\r\nimport { NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  username: string;\r\n  password: string;\r\n  error: string;\r\n  logInScheduled: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"net.noodl.user.LogIn\",\r\n  docs: \"https://docs.noodl.net/nodes/data/user/log-in\",\r\n  displayNodeName: \"Log In\",\r\n  category: \"Cloud Services\",\r\n  color: \"data\",\r\n  outputs: {\r\n    success: {\r\n      type: \"signal\",\r\n      displayName: \"Success\",\r\n      group: \"Events\",\r\n    },\r\n    failure: {\r\n      type: \"signal\",\r\n      displayName: \"Failure\",\r\n      group: \"Events\",\r\n    },\r\n    error: {\r\n      type: \"string\",\r\n      displayName: \"Error\",\r\n      group: \"Error\",\r\n      getter() {\r\n        return this._internal.error;\r\n      },\r\n    },\r\n  },\r\n  inputs: {\r\n    login: {\r\n      displayName: \"Do\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleLogIn();\r\n      },\r\n    },\r\n    username: {\r\n      displayName: \"Username\",\r\n      type: \"string\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.username = value;\r\n      },\r\n    },\r\n    password: {\r\n      displayName: \"Password\",\r\n      type: \"string\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.password = value;\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    setError(err: string) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty(\"error\");\r\n      this.sendSignalOnOutput(\"failure\");\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          // @ts-expect-error\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          \"user-login-warning\",\r\n          {\r\n            message: err,\r\n            showGlobally: true,\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          // @ts-expect-error\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          \"user-login-warning\"\r\n        );\r\n      }\r\n    },\r\n    scheduleLogIn() {\r\n      // @ts-expect-error\r\n      if (this.logInScheduled === true) return;\r\n      // @ts-expect-error\r\n      this.logInScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.logInScheduled = false;\r\n\r\n        UserService.instance.logIn({\r\n          username: this._internal.username,\r\n          password: this._internal.password,\r\n          success: () => {\r\n            this.sendSignalOnOutput(\"success\");\r\n          },\r\n          error: (e: string) => {\r\n            // @ts-expect-error\r\n            this.setError(e);\r\n          },\r\n        });\r\n      });\r\n    },\r\n  },\r\n};\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\nimport UserService from \"./userservice\";\r\n\r\ninterface Internal {\r\n  error: string;\r\n  logOutScheduled: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"net.noodl.user.LogOut\",\r\n  docs: \"https://docs.noodl.net/nodes/data/user/log-out\",\r\n  displayNodeName: \"Log Out\",\r\n  category: \"Cloud Services\",\r\n  color: \"data\",\r\n  outputs: {\r\n    success: {\r\n      type: \"signal\",\r\n      displayName: \"Success\",\r\n      group: \"Events\",\r\n    },\r\n    failure: {\r\n      type: \"signal\",\r\n      displayName: \"Failure\",\r\n      group: \"Events\",\r\n    },\r\n    error: {\r\n      type: \"string\",\r\n      displayName: \"Error\",\r\n      group: \"Error\",\r\n      getter() {\r\n        return this._internal.error;\r\n      },\r\n    },\r\n  },\r\n  inputs: {\r\n    login: {\r\n      displayName: \"Do\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleLogOut();\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    setError(err: string) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty(\"error\");\r\n      this.sendSignalOnOutput(\"failure\");\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          // @ts-expect-error\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          \"user-login-warning\",\r\n          {\r\n            message: err,\r\n            showGlobally: true,\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          // @ts-expect-error\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          \"user-login-warning\"\r\n        );\r\n      }\r\n    },\r\n    scheduleLogOut() {\r\n      // @ts-expect-error\r\n      if (this.logOutScheduled === true) return;\r\n      // @ts-expect-error\r\n      this.logOutScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.logOutScheduled = false;\r\n\r\n        UserService.instance.logOut({\r\n          success: () => {\r\n            this.sendSignalOnOutput(\"success\");\r\n          },\r\n          error: (e: string) => {\r\n            // @ts-expect-error\r\n            this.setError(e);\r\n          },\r\n        });\r\n      });\r\n    },\r\n  },\r\n};\r\n","import UserService from \"./userservice\";\r\nimport { GraphModel, NodeContext, NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  userProperties: Record<string, any>;\r\n  username: string;\r\n  password: string;\r\n  email: string;\r\n  error: string;\r\n  signUpScheduled: boolean;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"net.noodl.user.SignUp\",\r\n  docs: \"https://docs.noodl.net/nodes/data/user/sign-up\",\r\n  displayNodeName: \"Sign Up\",\r\n  category: \"Cloud Services\",\r\n  color: \"data\",\r\n  initialize() {\r\n    const internal = this._internal;\r\n    internal.userProperties = {};\r\n    internal.signUpScheduled = false;\r\n  },\r\n  outputs: {\r\n    success: {\r\n      type: \"signal\",\r\n      displayName: \"Success\",\r\n      group: \"Events\",\r\n    },\r\n    failure: {\r\n      type: \"signal\",\r\n      displayName: \"Failure\",\r\n      group: \"Events\",\r\n    },\r\n    error: {\r\n      type: \"string\",\r\n      displayName: \"Error\",\r\n      group: \"Error\",\r\n      getter() {\r\n        return this._internal.error;\r\n      },\r\n    },\r\n  },\r\n  inputs: {\r\n    signup: {\r\n      displayName: \"Do\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleSignUp();\r\n      },\r\n    },\r\n    username: {\r\n      displayName: \"Username\",\r\n      type: \"string\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.username = value;\r\n      },\r\n    },\r\n    password: {\r\n      displayName: \"Password\",\r\n      type: \"string\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.password = value;\r\n      },\r\n    },\r\n    email: {\r\n      displayName: \"Email\",\r\n      type: \"string\",\r\n      group: \"General\",\r\n      set(value: string) {\r\n        this._internal.email = value;\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    setError(err: string) {\r\n      this._internal.error = err;\r\n      this.flagOutputDirty(\"error\");\r\n      this.sendSignalOnOutput(\"failure\");\r\n\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.sendWarning(\r\n          // @ts-expect-error\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          \"user-login-warning\",\r\n          {\r\n            message: err,\r\n            showGlobally: true,\r\n          }\r\n        );\r\n      }\r\n    },\r\n    clearWarnings() {\r\n      if (this.context.editorConnection) {\r\n        this.context.editorConnection.clearWarning(\r\n          // @ts-expect-error\r\n          this.nodeScope.componentOwner.name,\r\n          this.id,\r\n          \"user-login-warning\"\r\n        );\r\n      }\r\n    },\r\n    scheduleSignUp() {\r\n      const internal = this._internal;\r\n\r\n      // @ts-expect-error\r\n      if (this.signUpScheduled === true) return;\r\n      // @ts-expect-error\r\n      this.signUpScheduled = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        // @ts-expect-error\r\n        this.signUpScheduled = false;\r\n\r\n        UserService.instance.signUp({\r\n          username: this._internal.username,\r\n          password: this._internal.password,\r\n          email: this._internal.email,\r\n          properties: internal.userProperties,\r\n          success: () => {\r\n            this.sendSignalOnOutput(\"success\");\r\n          },\r\n          error: (e: string) => {\r\n            // @ts-expect-error\r\n            this.setError(e);\r\n          },\r\n        });\r\n      });\r\n    },\r\n    setUserProperty(name: string, value: any) {\r\n      this._internal.userProperties[name] = value;\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"prop-\")) {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setUserProperty.bind(this, name.substring(\"prop-\".length)),\r\n        });\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nfunction updatePorts(\r\n  nodeId: string,\r\n  _parameters: any,\r\n  editorConnection: any,\r\n  systemCollections: any\r\n) {\r\n  const ports: any[] = [];\r\n\r\n  if (systemCollections) {\r\n    // Fetch ports from collection keys\r\n    const c = systemCollections.find((c: any) => c.name === \"_User\");\r\n    if (c && c.schema && c.schema.properties) {\r\n      const props = c.schema.properties;\r\n      const _ignoreKeys = [\r\n        \"authData\",\r\n        \"password\",\r\n        \"username\",\r\n        \"createdAt\",\r\n        \"updatedAt\",\r\n        \"emailVerified\",\r\n        \"email\",\r\n      ];\r\n      for (const key in props) {\r\n        if (_ignoreKeys.indexOf(key) !== -1) continue;\r\n\r\n        const p = props[key];\r\n        if (ports.find((_p) => _p.name === key)) continue;\r\n\r\n        if (p.type === \"Relation\") {\r\n          // Handle Relation type if needed\r\n        } else {\r\n          // Other schema type ports\r\n          const _typeMap: Record<string, string> = {\r\n            String: \"string\",\r\n            Boolean: \"boolean\",\r\n            Number: \"number\",\r\n            Date: \"date\",\r\n          };\r\n\r\n          ports.push({\r\n            type: {\r\n              name: _typeMap[p.type] ? _typeMap[p.type] : \"*\",\r\n            },\r\n            plug: \"input\",\r\n            group: \"Properties\",\r\n            name: \"prop-\" + key,\r\n            displayName: key,\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports);\r\n}\r\n\r\nexport function setup(context: NodeContext, graphModel: GraphModel) {\r\n  if (\r\n    !context.editorConnection ||\r\n    !context.editorConnection.isRunningLocally()\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  function _managePortsForNode(node: any) {\r\n    updatePorts(\r\n      node.id,\r\n      node.parameters,\r\n      context.editorConnection,\r\n      graphModel.getMetaData(\"systemCollections\")\r\n    );\r\n\r\n    node.on(\"parameterUpdated\", function (_event: any) {\r\n      updatePorts(\r\n        node.id,\r\n        node.parameters,\r\n        context.editorConnection,\r\n        graphModel.getMetaData(\"systemCollections\")\r\n      );\r\n    });\r\n\r\n    graphModel.on(\"metadataChanged.systemCollections\", function (data: any) {\r\n      updatePorts(node.id, node.parameters, context.editorConnection, data);\r\n    });\r\n  }\r\n\r\n  graphModel.on(\"editorImportComplete\", () => {\r\n    graphModel.on(\"nodeAdded.net.noodl.user.SignUp\", function (node: any) {\r\n      _managePortsForNode(node);\r\n    });\r\n\r\n    for (const node of graphModel.getNodesWithType(\"net.noodl.user.SignUp\")) {\r\n      _managePortsForNode(node);\r\n    }\r\n  });\r\n}\r\n","import NoodlRuntime, { guid, ModelScope } from \"@fluxscape/runtime\";\r\nimport { EventEmitter } from \"events\";\r\nimport { CloudStore } from \"@fluxscape/runtime/src/api/cloudstore\";\r\n\r\ninterface UserServiceOptions {\r\n  username: string;\r\n  password: string;\r\n  email?: string;\r\n  properties?: Record<string, any>;\r\n  sessionToken?: string;\r\n  token?: string;\r\n  newPassword?: string;\r\n\r\n  success?: (response: any) => void;\r\n  error?: (error: any) => void;\r\n}\r\n\r\ninterface FetchCurrentUserOptions {\r\n  sessionToken?: string;\r\n  success: (response: any) => void;\r\n  error: (error: any) => void;\r\n}\r\n\r\nclass UserService {\r\n  static forScope(_modelScope: ModelScope) {\r\n    // On the viewer, always return main scope\r\n    return UserService.instance;\r\n  }\r\n\r\n  static _instance: UserService | undefined;\r\n  static get instance() {\r\n    if (UserService._instance === undefined)\r\n      UserService._instance = new UserService();\r\n    return UserService._instance;\r\n  }\r\n\r\n  private events: EventEmitter;\r\n  private appId?: string;\r\n  private endpoint?: string;\r\n  public current?: any;\r\n\r\n  constructor() {\r\n    this._initCloudServices();\r\n\r\n    this.events = new EventEmitter();\r\n    this.events.setMaxListeners(100000);\r\n\r\n    // Check for current user session, and validate if it exists\r\n    const currentUser = this.getUserFromLocalStorage();\r\n\r\n    if (currentUser) {\r\n      this.current = this.getUserModel();\r\n      this.fetchCurrentUser({\r\n        success: () => {},\r\n        error: () => {\r\n          // The session is no longer valid\r\n          delete localStorage[\"Parse/\" + this.appId + \"/currentUser\"];\r\n          delete this.current;\r\n          this.events.emit(\"sessionLost\");\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  private getUserFromLocalStorage(): any | undefined {\r\n    const currentUser = localStorage[\"Parse/\" + this.appId + \"/currentUser\"];\r\n    if (currentUser) {\r\n      try {\r\n        return JSON.parse(currentUser);\r\n      } catch (e) {\r\n        // do nothing\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  private _initCloudServices() {\r\n    const cloudServices = NoodlRuntime.instance.getMetaData(\"cloudservices\");\r\n\r\n    if (cloudServices) {\r\n      this.appId = cloudServices.appId;\r\n      this.endpoint = cloudServices.endpoint;\r\n    }\r\n  }\r\n\r\n  public on(...args: Parameters<EventEmitter[\"on\"]>) {\r\n    this.events.on(...args);\r\n  }\r\n\r\n  public off(...args: Parameters<EventEmitter[\"off\"]>) {\r\n    this.events.off(...args);\r\n  }\r\n\r\n  private _makeRequest(path: string, options: any) {\r\n    if (!this.endpoint) {\r\n      if (options.error) {\r\n        options.error({ error: \"No active cloud service\", status: 0 });\r\n      }\r\n      return;\r\n    }\r\n\r\n    const xhr = new XMLHttpRequest();\r\n\r\n    xhr.onreadystatechange = () => {\r\n      if (xhr.readyState === 4) {\r\n        let json;\r\n        try {\r\n          json = JSON.parse(xhr.response);\r\n        } catch (e) {}\r\n\r\n        if (xhr.status === 200 || xhr.status === 201) {\r\n          options.success(json || xhr.response);\r\n        } else {\r\n          options.error(\r\n            json || { error: xhr.responseText, status: xhr.status }\r\n          );\r\n        }\r\n      }\r\n    };\r\n\r\n    xhr.open(options.method || \"GET\", this.endpoint + path, true);\r\n\r\n    xhr.setRequestHeader(\"X-Parse-Application-Id\", this.appId!);\r\n\r\n    // Installation Id\r\n    let _iid = localStorage[\"Parse/\" + this.appId + \"/installationId\"];\r\n    if (_iid === undefined) {\r\n      _iid = localStorage[\"Parse/\" + this.appId + \"/installationId\"] = guid();\r\n    }\r\n    xhr.setRequestHeader(\"X-Parse-Installation-Id\", _iid);\r\n\r\n    // Check for current users\r\n    if (options.sessionToken) {\r\n      xhr.setRequestHeader(\"X-Parse-Session-Token\", options.sessionToken);\r\n    } else {\r\n      const currentUser = this.getUserFromLocalStorage();\r\n      if (currentUser !== undefined) {\r\n        xhr.setRequestHeader(\"X-Parse-Session-Token\", currentUser.sessionToken);\r\n      }\r\n    }\r\n\r\n    xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n    xhr.send(JSON.stringify(options.content));\r\n  }\r\n\r\n  public logIn(options: UserServiceOptions) {\r\n    this._makeRequest(\"/login\", {\r\n      method: \"POST\",\r\n      content: {\r\n        username: options.username,\r\n        password: options.password,\r\n        _method: \"GET\",\r\n      },\r\n      success: (response: any) => {\r\n        // Store current user\r\n        localStorage[\"Parse/\" + this.appId + \"/currentUser\"] =\r\n          JSON.stringify(response);\r\n        this.current = this.getUserModel(); // Make sure the user model is updated\r\n        options?.success?.(response);\r\n        this.events.emit(\"loggedIn\");\r\n      },\r\n      error: (e: any) => {\r\n        options?.error?.(e.error);\r\n      },\r\n    });\r\n  }\r\n\r\n  public logOut(options: { success: () => void; error: (error: any) => void }) {\r\n    this._makeRequest(\"/logout\", {\r\n      method: \"POST\",\r\n      content: {},\r\n      success: (response: any) => {\r\n        // Store current user\r\n        delete localStorage[\"Parse/\" + this.appId + \"/currentUser\"];\r\n        delete this.current;\r\n        options.success();\r\n        this.events.emit(\"loggedOut\");\r\n      },\r\n      error: (e: any) => {\r\n        options.error(e.error);\r\n      },\r\n    });\r\n  }\r\n\r\n  public signUp(options: UserServiceOptions) {\r\n    // make a shallow copy to feed through CloudStore._serializeObject, which will modify the object\r\n    const additionalUserProps = options.properties\r\n      ? CloudStore._serializeObject({ ...options.properties }, \"_User\")\r\n      : {};\r\n\r\n    this._makeRequest(\"/users\", {\r\n      method: \"POST\",\r\n      content: {\r\n        ...additionalUserProps,\r\n        username: options.username,\r\n        password: options.password,\r\n        email: options.email,\r\n      },\r\n      success: (response: any) => {\r\n        // Store current user\r\n        const _cu = {\r\n          ...response,\r\n          username: options.username,\r\n          ...options.properties,\r\n        };\r\n        localStorage[\"Parse/\" + this.appId + \"/currentUser\"] =\r\n          JSON.stringify(_cu);\r\n        this.current = this.getUserModel(); // Make sure the user model is updated\r\n        options?.success?.(response);\r\n        this.events.emit(\"loggedIn\");\r\n      },\r\n      error: (e: any) => {\r\n        options?.error?.(e.error);\r\n      },\r\n    });\r\n  }\r\n\r\n  public setUserProperties(options: {\r\n    properties: Record<string, any>;\r\n    email?: string;\r\n    username?: string;\r\n    success: (response: any) => void;\r\n    error: (error: any) => void;\r\n  }) {\r\n    const _cu = this.getCurrentUser();\r\n    if (_cu !== undefined) {\r\n      // make a shallow copy to feed through CloudStore._serializeObject, which will modify the object\r\n      const propsToSave = CloudStore._serializeObject(\r\n        { ...options.properties },\r\n        \"_User\"\r\n      );\r\n\r\n      const _content = {\r\n        email: options.email,\r\n        username: options.username,\r\n        ...propsToSave,\r\n      };\r\n\r\n      delete _content.emailVerified; // Remove props you cannot set\r\n      delete _content.createdAt;\r\n      delete _content.updatedAt;\r\n\r\n      this._makeRequest(\"/users/\" + _cu.objectId, {\r\n        method: \"PUT\",\r\n        content: _content,\r\n        success: (response: any) => {\r\n          // Store current user\r\n          Object.assign(_cu, _content);\r\n          localStorage[\"Parse/\" + this.appId + \"/currentUser\"] =\r\n            JSON.stringify(_cu);\r\n          this.current = this.getUserModel(); // Make sure the user model is updated\r\n          options.success(response);\r\n        },\r\n        error: (e: any) => {\r\n          options.error(e.error);\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  public fetchCurrentUser(options: FetchCurrentUserOptions) {\r\n    this._makeRequest(\"/users/me\", {\r\n      method: \"GET\",\r\n      sessionToken: options.sessionToken,\r\n      success: (response: any) => {\r\n        // Store current user\r\n        localStorage[\"Parse/\" + this.appId + \"/currentUser\"] =\r\n          JSON.stringify(response);\r\n        this.current = this.getUserModel(); // Make sure the user model is updated\r\n        this.events.emit(\"sessionGained\");\r\n        options.success(response);\r\n      },\r\n      error: (e: any) => {\r\n        if (e.code === 209) {\r\n          delete localStorage[\"Parse/\" + this.appId + \"/currentUser\"];\r\n          this.events.emit(\"sessionLost\");\r\n        }\r\n        options.error(e.error);\r\n      },\r\n    });\r\n  }\r\n\r\n  public verifyEmail(options: {\r\n    username: string;\r\n    token: string;\r\n    success: () => void;\r\n    error: (error: any) => void;\r\n  }) {\r\n    this._makeRequest(\r\n      \"/apps/\" +\r\n        this.appId +\r\n        \"/verify_email?username=\" +\r\n        options.username +\r\n        \"&token=\" +\r\n        options.token,\r\n      {\r\n        method: \"GET\",\r\n        success: (response: any) => {\r\n          if (response.indexOf(\"Successfully verified your email\") !== -1) {\r\n            options.success();\r\n          } else if (response.indexOf(\"Invalid Verification Link\")) {\r\n            options.error(\"Invalid verification token\");\r\n          } else {\r\n            options.error(\"Failed to verify email\");\r\n          }\r\n        },\r\n        error: (e: any) => {\r\n          options.error(e.error);\r\n        },\r\n      }\r\n    );\r\n  }\r\n\r\n  public sendEmailVerification(options: {\r\n    email: string;\r\n    success: () => void;\r\n    error: (error: any) => void;\r\n  }) {\r\n    this._makeRequest(\"/verificationEmailRequest\", {\r\n      method: \"POST\",\r\n      content: { email: options.email },\r\n      success: (response: any) => {\r\n        options.success();\r\n      },\r\n      error: (e: any) => {\r\n        options.error(e.error);\r\n      },\r\n    });\r\n  }\r\n\r\n  public resetPassword(options: {\r\n    username: string;\r\n    token: string;\r\n    newPassword: string;\r\n    success: () => void;\r\n    error: (error: any) => void;\r\n  }) {\r\n    this._makeRequest(\"/apps/\" + this.appId + \"/request_password_reset\", {\r\n      method: \"POST\",\r\n      content: {\r\n        username: options.username,\r\n        token: options.token,\r\n        new_password: options.newPassword,\r\n      },\r\n      success: (response: any) => {\r\n        if (\r\n          response.indexOf(\"Password successfully reset\") !== -1 ||\r\n          response.indexOf(\"Successfully updated your password\") !== -1\r\n        ) {\r\n          options.success();\r\n        } else if (response.indexOf(\"Invalid Link\")) {\r\n          options.error(\"Invalid verification token\");\r\n        } else {\r\n          options.error(\"Failed to verify email\");\r\n        }\r\n      },\r\n      error: (e: any) => {\r\n        options.error(e.error);\r\n      },\r\n    });\r\n  }\r\n\r\n  public requestPasswordReset(options: {\r\n    email: string;\r\n    success: () => void;\r\n    error: (error: any) => void;\r\n  }) {\r\n    this._makeRequest(\"/requestPasswordReset\", {\r\n      method: \"POST\",\r\n      content: { email: options.email },\r\n      success: (response: any) => {\r\n        options.success();\r\n      },\r\n      error: (e: any) => {\r\n        options.error(e.error);\r\n      },\r\n    });\r\n  }\r\n\r\n  public getCurrentUser(): any | undefined {\r\n    const _cu = localStorage[\"Parse/\" + this.appId + \"/currentUser\"];\r\n    if (_cu !== undefined) return JSON.parse(_cu);\r\n  }\r\n\r\n  public getUserModel(): any | undefined {\r\n    const _cu = this.getCurrentUser();\r\n    if (_cu !== undefined) {\r\n      delete _cu.sessionToken;\r\n      delete _cu.ACL;\r\n      delete _cu.className;\r\n      delete _cu.__type;\r\n      return CloudStore._fromJSON(_cu, \"_User\");\r\n    }\r\n  }\r\n}\r\n\r\n// @ts-expect-error\r\nNoodlRuntime.Services.UserService = UserService;\r\n\r\nexport default UserService;\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  lastValue: any;\r\n  changeCount: number;\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"Value Changed\",\r\n  docs: \"https://docs.noodl.net/nodes/logic/value-changed\",\r\n  category: \"Logic\",\r\n  initialize: function () {\r\n    this._internal.lastValue = undefined;\r\n    this._internal.changeCount = 0;\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal.changeCount) {\r\n      return (\r\n        \"Triggered \" +\r\n        this._internal.changeCount +\r\n        (this._internal.changeCount === 1 ? \" time\" : \" times\")\r\n      );\r\n    }\r\n    return \"Not triggered\";\r\n  },\r\n  inputs: {\r\n    value: {\r\n      type: \"*\",\r\n      displayName: \"Input\",\r\n      set: function (value) {\r\n        if (this._internal.lastValue === value) {\r\n          return;\r\n        }\r\n\r\n        this._internal.changeCount++;\r\n        this.sendSignalOnOutput(\"valueChanged\");\r\n        this._internal.lastValue = value;\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    valueChanged: {\r\n      type: \"signal\",\r\n      displayName: \"Value Changed\",\r\n    },\r\n  },\r\n};\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\nexport const node: NodeDefinition = {\r\n  name: \"Color\",\r\n  category: \"Variables\",\r\n  docs: \"https://docs.noodl.net/nodes/data/color\",\r\n  // @ts-expect-error What is this?\r\n  startValue: \"#f1f2f4\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"value\",\r\n  },\r\n  type: {\r\n    name: \"color\",\r\n  },\r\n  cast(value: any): any {\r\n    return value;\r\n  },\r\n};\r\n","/* Web Font Loader v1.6.28 - (c) Adobe Systems, Google. License: Apache 2.0 */(function(){function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?aa:ba;return p.apply(null,arguments)}var q=Date.now||function(){return+new Date};function ca(a,b){this.a=a;this.o=b||a;this.c=this.o.document}var da=!!window.FontFace;function t(a,b,c,d){b=a.c.createElement(b);if(c)for(var e in c)c.hasOwnProperty(e)&&(\"style\"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));d&&b.appendChild(a.c.createTextNode(d));return b}function u(a,b,c){a=a.c.getElementsByTagName(b)[0];a||(a=document.documentElement);a.insertBefore(c,a.lastChild)}function v(a){a.parentNode&&a.parentNode.removeChild(a)}\nfunction w(a,b,c){b=b||[];c=c||[];for(var d=a.className.split(/\\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}b=[];for(e=0;e<d.length;e+=1){f=!1;for(g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(\" \").replace(/\\s+/g,\" \").replace(/^\\s+|\\s+$/,\"\")}function y(a,b){for(var c=a.className.split(/\\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}\nfunction ea(a){return a.o.location.hostname||a.a.location.hostname}function z(a,b,c){function d(){m&&e&&f&&(m(g),m=null)}b=t(a,\"link\",{rel:\"stylesheet\",href:b,media:\"all\"});var e=!1,f=!0,g=null,m=c||null;da?(b.onload=function(){e=!0;d()},b.onerror=function(){e=!0;g=Error(\"Stylesheet failed to load\");d()}):setTimeout(function(){e=!0;d()},0);u(a,\"head\",b)}\nfunction A(a,b,c,d){var e=a.c.getElementsByTagName(\"head\")[0];if(e){var f=t(a,\"script\",{src:b}),g=!1;f.onload=f.onreadystatechange=function(){g||this.readyState&&\"loaded\"!=this.readyState&&\"complete\"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,\"HEAD\"==f.parentNode.tagName&&e.removeChild(f))};e.appendChild(f);setTimeout(function(){g||(g=!0,c&&c(Error(\"Script load timeout\")))},d||5E3);return f}return null};function B(){this.a=0;this.c=null}function C(a){a.a++;return function(){a.a--;D(a)}}function E(a,b){a.c=b;D(a)}function D(a){0==a.a&&a.c&&(a.c(),a.c=null)};function F(a){this.a=a||\"-\"}F.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\\W_]+/g,\"\").toLowerCase());return b.join(this.a)};function G(a,b){this.c=a;this.f=4;this.a=\"n\";var c=(b||\"n4\").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function fa(a){return H(a)+\" \"+(a.f+\"00\")+\" 300px \"+I(a.c)}function I(a){var b=[];a=a.split(/,\\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['\"]/g,\"\");-1!=d.indexOf(\" \")||/^\\d/.test(d)?b.push(\"'\"+d+\"'\"):b.push(d)}return b.join(\",\")}function J(a){return a.a+a.f}function H(a){var b=\"normal\";\"o\"===a.a?b=\"oblique\":\"i\"===a.a&&(b=\"italic\");return b}\nfunction ga(a){var b=4,c=\"n\",d=null;a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10))));return c+b};function ha(a,b){this.c=a;this.f=a.o.document.documentElement;this.h=b;this.a=new F(\"-\");this.j=!1!==b.events;this.g=!1!==b.classes}function ia(a){a.g&&w(a.f,[a.a.c(\"wf\",\"loading\")]);K(a,\"loading\")}function L(a){if(a.g){var b=y(a.f,a.a.c(\"wf\",\"active\")),c=[],d=[a.a.c(\"wf\",\"loading\")];b||c.push(a.a.c(\"wf\",\"inactive\"));w(a.f,c,d)}K(a,\"inactive\")}function K(a,b,c){if(a.j&&a.h[b])if(c)a.h[b](c.c,J(c));else a.h[b]()};function ja(){this.c={}}function ka(a,b,c){var d=[],e;for(e in b)if(b.hasOwnProperty(e)){var f=a.c[e];f&&d.push(f(b[e],c))}return d};function M(a,b){this.c=a;this.f=b;this.a=t(this.c,\"span\",{\"aria-hidden\":\"true\"},this.f)}function N(a){u(a.c,\"body\",a.a)}function O(a){return\"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:\"+I(a.c)+\";\"+(\"font-style:\"+H(a)+\";font-weight:\"+(a.f+\"00\")+\";\")};function P(a,b,c,d,e,f){this.g=a;this.j=b;this.a=d;this.c=c;this.f=e||3E3;this.h=f||void 0}P.prototype.start=function(){var a=this.c.o.document,b=this,c=q(),d=new Promise(function(d,e){function f(){q()-c>=b.f?e():a.fonts.load(fa(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(f,25)},function(){e()})}f()}),e=null,f=new Promise(function(a,d){e=setTimeout(d,b.f)});Promise.race([f,d]).then(function(){e&&(clearTimeout(e),e=null);b.g(b.a)},function(){b.j(b.a)})};function Q(a,b,c,d,e,f,g){this.v=a;this.B=b;this.c=c;this.a=d;this.s=g||\"BESbswy\";this.f={};this.w=e||3E3;this.u=f||null;this.m=this.j=this.h=this.g=null;this.g=new M(this.c,this.s);this.h=new M(this.c,this.s);this.j=new M(this.c,this.s);this.m=new M(this.c,this.s);a=new G(this.a.c+\",serif\",J(this.a));a=O(a);this.g.a.style.cssText=a;a=new G(this.a.c+\",sans-serif\",J(this.a));a=O(a);this.h.a.style.cssText=a;a=new G(\"serif\",J(this.a));a=O(a);this.j.a.style.cssText=a;a=new G(\"sans-serif\",J(this.a));a=\nO(a);this.m.a.style.cssText=a;N(this.g);N(this.h);N(this.j);N(this.m)}var R={D:\"serif\",C:\"sans-serif\"},S=null;function T(){if(null===S){var a=/AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))/.exec(window.navigator.userAgent);S=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return S}Q.prototype.start=function(){this.f.serif=this.j.a.offsetWidth;this.f[\"sans-serif\"]=this.m.a.offsetWidth;this.A=q();U(this)};\nfunction la(a,b,c){for(var d in R)if(R.hasOwnProperty(d)&&b===a.f[R[d]]&&c===a.f[R[d]])return!0;return!1}function U(a){var b=a.g.a.offsetWidth,c=a.h.a.offsetWidth,d;(d=b===a.f.serif&&c===a.f[\"sans-serif\"])||(d=T()&&la(a,b,c));d?q()-a.A>=a.w?T()&&la(a,b,c)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?V(a,a.v):V(a,a.B):ma(a):V(a,a.v)}function ma(a){setTimeout(p(function(){U(this)},a),50)}function V(a,b){setTimeout(p(function(){v(this.g.a);v(this.h.a);v(this.j.a);v(this.m.a);b(this.a)},a),0)};function W(a,b,c){this.c=a;this.a=b;this.f=0;this.m=this.j=!1;this.s=c}var X=null;W.prototype.g=function(a){var b=this.a;b.g&&w(b.f,[b.a.c(\"wf\",a.c,J(a).toString(),\"active\")],[b.a.c(\"wf\",a.c,J(a).toString(),\"loading\"),b.a.c(\"wf\",a.c,J(a).toString(),\"inactive\")]);K(b,\"fontactive\",a);this.m=!0;na(this)};\nW.prototype.h=function(a){var b=this.a;if(b.g){var c=y(b.f,b.a.c(\"wf\",a.c,J(a).toString(),\"active\")),d=[],e=[b.a.c(\"wf\",a.c,J(a).toString(),\"loading\")];c||d.push(b.a.c(\"wf\",a.c,J(a).toString(),\"inactive\"));w(b.f,d,e)}K(b,\"fontinactive\",a);na(this)};function na(a){0==--a.f&&a.j&&(a.m?(a=a.a,a.g&&w(a.f,[a.a.c(\"wf\",\"active\")],[a.a.c(\"wf\",\"loading\"),a.a.c(\"wf\",\"inactive\")]),K(a,\"active\")):L(a.a))};function oa(a){this.j=a;this.a=new ja;this.h=0;this.f=this.g=!0}oa.prototype.load=function(a){this.c=new ca(this.j,a.context||this.j);this.g=!1!==a.events;this.f=!1!==a.classes;pa(this,new ha(this.c,a),a)};\nfunction qa(a,b,c,d,e){var f=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=e||null,m=d||null||{};if(0===c.length&&f)L(b.a);else{b.f+=c.length;f&&(b.j=f);var h,l=[];for(h=0;h<c.length;h++){var k=c[h],n=m[k.c],r=b.a,x=k;r.g&&w(r.f,[r.a.c(\"wf\",x.c,J(x).toString(),\"loading\")]);K(r,\"fontloading\",x);r=null;if(null===X)if(window.FontFace){var x=/Gecko.*Firefox\\/(\\d+)/.exec(window.navigator.userAgent),xa=/OS X.*Version\\/10\\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);\nX=x?42<parseInt(x[1],10):xa?!1:!0}else X=!1;X?r=new P(p(b.g,b),p(b.h,b),b.c,k,b.s,n):r=new Q(p(b.g,b),p(b.h,b),b.c,k,b.s,a,n);l.push(r)}for(h=0;h<l.length;h++)l[h].start()}},0)}function pa(a,b,c){var d=[],e=c.timeout;ia(b);var d=ka(a.a,c,a.c),f=new W(a.c,b,e);a.h=d.length;b=0;for(c=d.length;b<c;b++)d[b].load(function(b,d,c){qa(a,f,b,d,c)})};function ra(a,b){this.c=a;this.a=b}\nra.prototype.load=function(a){function b(){if(f[\"__mti_fntLst\"+d]){var c=f[\"__mti_fntLst\"+d](),e=[],h;if(c)for(var l=0;l<c.length;l++){var k=c[l].fontfamily;void 0!=c[l].fontStyle&&void 0!=c[l].fontWeight?(h=c[l].fontStyle+c[l].fontWeight,e.push(new G(k,h))):e.push(new G(k))}a(e)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.o;A(this.c,(c.a.api||\"https://fast.fonts.net/jsapi\")+\"/\"+d+\".js\"+(e?\"?v=\"+e:\"\"),function(e){e?a([]):(f[\"__MonotypeConfiguration__\"+\nd]=function(){return c.a},b())}).id=\"__MonotypeAPIScript__\"+d}else a([])};function sa(a,b){this.c=a;this.a=b}sa.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new B;b=0;for(c=d.length;b<c;b++)z(this.c,d[b],C(g));var m=[];b=0;for(c=e.length;b<c;b++)if(d=e[b].split(\":\"),d[1])for(var h=d[1].split(\",\"),l=0;l<h.length;l+=1)m.push(new G(d[0],h[l]));else m.push(new G(d[0]));E(g,function(){a(m,f)})};function ta(a,b){a?this.c=a:this.c=ua;this.a=[];this.f=[];this.g=b||\"\"}var ua=\"https://fonts.googleapis.com/css\";function va(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(\":\");3==e.length&&a.f.push(e.pop());var f=\"\";2==e.length&&\"\"!=e[1]&&(f=\":\");a.a.push(e.join(f))}}\nfunction wa(a){if(0==a.a.length)throw Error(\"No fonts to load!\");if(-1!=a.c.indexOf(\"kit=\"))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,\"+\"));b=a.c+\"?family=\"+c.join(\"%7C\");0<a.f.length&&(b+=\"&subset=\"+a.f.join(\",\"));0<a.g.length&&(b+=\"&text=\"+encodeURIComponent(a.g));return b};function ya(a){this.f=a;this.a=[];this.c={}}\nvar za={latin:\"BESbswy\",\"latin-ext\":\"\\u00e7\\u00f6\\u00fc\\u011f\\u015f\",cyrillic:\"\\u0439\\u044f\\u0416\",greek:\"\\u03b1\\u03b2\\u03a3\",khmer:\"\\u1780\\u1781\\u1782\",Hanuman:\"\\u1780\\u1781\\u1782\"},Aa={thin:\"1\",extralight:\"2\",\"extra-light\":\"2\",ultralight:\"2\",\"ultra-light\":\"2\",light:\"3\",regular:\"4\",book:\"4\",medium:\"5\",\"semi-bold\":\"6\",semibold:\"6\",\"demi-bold\":\"6\",demibold:\"6\",bold:\"7\",\"extra-bold\":\"8\",extrabold:\"8\",\"ultra-bold\":\"8\",ultrabold:\"8\",black:\"9\",heavy:\"9\",l:\"3\",r:\"4\",b:\"7\"},Ba={i:\"i\",italic:\"i\",n:\"n\",normal:\"n\"},\nCa=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;\nfunction Da(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(\":\"),e=d[0].replace(/\\+/g,\" \"),f=[\"n4\"];if(2<=d.length){var g;var m=d[1];g=[];if(m)for(var m=m.split(\",\"),h=m.length,l=0;l<h;l++){var k;k=m[l];if(k.match(/^[\\w-]+$/)){var n=Ca.exec(k.toLowerCase());if(null==n)k=\"\";else{k=n[2];k=null==k||\"\"==k?\"n\":Ba[k];n=n[1];if(null==n||\"\"==n)n=\"4\";else var r=Aa[n],n=r?r:isNaN(n)?\"4\":n.substr(0,1);k=[k,n].join(\"\")}}else k=\"\";k&&g.push(k)}0<g.length&&(f=g);3==d.length&&(d=d[2],g=[],d=d?d.split(\",\"):\ng,0<d.length&&(d=za[d[0]])&&(a.c[e]=d))}a.c[e]||(d=za[e])&&(a.c[e]=d);for(d=0;d<f.length;d+=1)a.a.push(new G(e,f[d]))}};function Ea(a,b){this.c=a;this.a=b}var Fa={Arimo:!0,Cousine:!0,Tinos:!0};Ea.prototype.load=function(a){var b=new B,c=this.c,d=new ta(this.a.api,this.a.text),e=this.a.families;va(d,e);var f=new ya(e);Da(f);z(c,wa(d),C(b));E(b,function(){a(f.a,f.c,Fa)})};function Ga(a,b){this.c=a;this.a=b}Ga.prototype.load=function(a){var b=this.a.id,c=this.c.o;b?A(this.c,(this.a.api||\"https://use.typekit.net\")+\"/\"+b+\".js\",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var e=[],f=0;f<b.length;f+=2)for(var g=b[f],m=b[f+1],h=0;h<m.length;h++)e.push(new G(g,m[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(l){}a(e)}},2E3):a([])};function Ha(a,b){this.c=a;this.f=b;this.a=[]}Ha.prototype.load=function(a){var b=this.f.id,c=this.c.o,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var g=0,m=c.fonts.length;g<m;++g){var h=c.fonts[g];d.a.push(new G(h.name,ga(\"font-weight:\"+h.weight+\";font-style:\"+h.style)))}a(d.a)},A(this.c,(this.f.api||\"https://f.fontdeck.com/s/css/js/\")+ea(this.c)+\"/\"+b+\".js\",function(b){b&&a([])})):a([])};var Y=new oa(window);Y.a.c.custom=function(a,b){return new sa(b,a)};Y.a.c.fontdeck=function(a,b){return new Ha(b,a)};Y.a.c.monotype=function(a,b){return new ra(b,a)};Y.a.c.typekit=function(a,b){return new Ga(b,a)};Y.a.c.google=function(a,b){return new Ea(b,a)};var Z={load:p(Y.load,Y)};\"function\"===typeof define&&define.amd?define(function(){return Z}):\"undefined\"!==typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig));}());\n","const { default: NoodlRuntime } = require(\"@fluxscape/runtime\");\r\n\r\nfunction _makeRequest(path, options) {\r\n  var xhr = new XMLHttpRequest();\r\n\r\n  xhr.onreadystatechange = function () {\r\n    if (xhr.readyState === 4) {\r\n      var json;\r\n      try {\r\n        json = JSON.parse(xhr.response);\r\n      } catch (e) {}\r\n\r\n      if (xhr.status === 200 || xhr.status === 201) {\r\n        options.success(json);\r\n      } else options.error(json);\r\n    }\r\n  };\r\n\r\n  xhr.open(options.method || \"GET\", options.endpoint + path, true);\r\n\r\n  xhr.setRequestHeader(\"X-Parse-Application-Id\", options.appId);\r\n  xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n\r\n  const cloudServices = NoodlRuntime.instance.getMetaData(\"cloudservices\");\r\n  if (cloudServices && cloudServices.deployVersion) {\r\n    xhr.setRequestHeader(\"x-noodl-cloud-version\", cloudServices.deployVersion);\r\n  }\r\n\r\n  // Check for current users\r\n  var _cu = localStorage[\"Parse/\" + options.appId + \"/currentUser\"];\r\n  if (_cu !== undefined) {\r\n    try {\r\n      const currentUser = JSON.parse(_cu);\r\n      xhr.setRequestHeader(\"X-Parse-Session-Token\", currentUser.sessionToken);\r\n    } catch (e) {\r\n      // Failed to extract session token\r\n    }\r\n  }\r\n\r\n  xhr.send(JSON.stringify(options.content));\r\n}\r\n\r\nconst cloudfunctions = {\r\n  async run(functionName, params) {\r\n    return new Promise((resolve, reject) => {\r\n      const cloudServices = NoodlRuntime.instance.getMetaData(\"cloudservices\");\r\n      if (cloudServices === undefined) {\r\n        reject(\"No cloud services defined in this project.\");\r\n        return;\r\n      }\r\n\r\n      const appId = cloudServices.appId;\r\n      const endpoint = NoodlRuntime.instance.editorConnection.isRunningLocally()\r\n        ? `http://${window.location.hostname}:8577`\r\n        : cloudServices.endpoint;\r\n\r\n      _makeRequest(\"/functions/\" + encodeURIComponent(functionName), {\r\n        appId,\r\n        endpoint,\r\n        content: params,\r\n        method: \"POST\",\r\n        success: (res) => {\r\n          resolve(res ? res.result : undefined);\r\n        },\r\n        error: (err) => {\r\n          reject(err);\r\n        },\r\n      });\r\n    });\r\n  },\r\n};\r\n\r\nmodule.exports = cloudfunctions;\r\n","const UserService = require('../nodes/std-library/user/userservice')\r\n\r\nconst users = {\r\n    async logIn(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.logIn({\r\n                username:options.username,\r\n                password:options.password,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async signUp(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.signUp({\r\n                username:options.username,\r\n                password:options.password,\r\n                email:options.email,\r\n                properties:options.properties,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async become(sessionToken) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.fetchCurrentUser({\r\n                sessionToken,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    // Deprecated use cloud functions instead\r\n  /*  async requestPasswordReset(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.requestPasswordReset({\r\n                email:options.email,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async resetPassword(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.resetPassword({\r\n                token:options.token,\r\n                username:options.username,\r\n                newPassword:options.newPassword,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },   \r\n\r\n    async sendEmailVerification(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.sendEmailVerification({\r\n                email:options.email,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async verifyEmail(options) {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.verifyEmail({\r\n                username:options.username,\r\n                token:options.token,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },*/\r\n\r\n    on(event,cb) {\r\n        UserService.instance.on(event,cb)\r\n    },\r\n\r\n    off(event,cb) {\r\n        UserService.instance.off(event,cb)\r\n    }, \r\n}\r\n\r\nconst _currentUser = {\r\n    async logOut() {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.logOut({\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async save() {\r\n        return new Promise((resolve,reject) => {\r\n            const props = Object.assign({},_currentUser.Properties.data)\r\n\r\n            UserService.instance.setUserProperties({\r\n                properties:props,\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    },\r\n\r\n    async fetch() {\r\n        return new Promise((resolve,reject) => {\r\n            UserService.instance.fetchCurrentUser({\r\n                success:() => {\r\n                    resolve()\r\n                },\r\n                error:(e) => {\r\n                    reject(e)\r\n                }\r\n            })\r\n        })\r\n    }\r\n}\r\n\r\nObject.defineProperty(users, 'Current', { \r\n    get: function() { \r\n        const _user = UserService.instance.current; \r\n        if(_user === undefined) return; \r\n        else {\r\n            _currentUser.email = _user.email;\r\n            _currentUser.username = _user.username;\r\n            _currentUser.id = _user.id;\r\n            _currentUser.emailVerified = _user.emailVerified;\r\n            _currentUser.Properties = _user\r\n            return _currentUser\r\n        } \r\n    } \r\n});\r\n\r\nmodule.exports = users","module.exports = function patchedMomentum(current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\r\n  if (options === void 0) {\r\n    options = this.options;\r\n  }\r\n  var distance = current - start;\r\n  var speed = Math.abs(distance) / time;\r\n  var deceleration = options.deceleration,\r\n    swipeBounceTime = options.swipeBounceTime,\r\n    swipeTime = options.swipeTime;\r\n  var momentumData = {\r\n    destination: current + (speed / deceleration) * (distance < 0 ? -1 : 1),\r\n    duration: swipeTime,\r\n    rate: 15\r\n  };\r\n  this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\r\n  if (momentumData.destination < lowerMargin) {\r\n    momentumData.destination = wrapperSize\r\n      ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - (wrapperSize / momentumData.rate) * speed)\r\n      : lowerMargin;\r\n    momentumData.duration = Math.abs(momentumData.destination - current) / speed;\r\n  } else if (momentumData.destination > upperMargin) {\r\n    momentumData.destination = wrapperSize\r\n      ? Math.min(upperMargin + wrapperSize / 4, upperMargin + (wrapperSize / momentumData.rate) * speed)\r\n      : upperMargin;\r\n    // momentumData.duration = swipeBounceTime;\r\n    momentumData.duration = Math.abs(momentumData.destination - current) / speed;\r\n  }\r\n  momentumData.destination = Math.round(momentumData.destination);\r\n  return momentumData;\r\n};\r\n","\"use strict\";\r\n\r\nconst Model = require(\"@fluxscape/runtime\");\r\n\r\nfunction extendSetComponentObjectProperties(def) {\r\n  const SetComponentObjectProperties = {\r\n    name: def.name,\r\n    displayNodeName: def.displayName,\r\n    category: \"Component Utilities\",\r\n    color: \"component\",\r\n    docs: def.docs,\r\n    initialize: function () {\r\n      this._internal.inputValues = {};\r\n    },\r\n    inputs: {\r\n      properties: {\r\n        type: {\r\n          name: \"stringlist\",\r\n          allowEditOnly: true,\r\n        },\r\n        displayName: \"Properties\",\r\n        group: \"Properties\",\r\n        set(value) {},\r\n      },\r\n      store: {\r\n        type: \"signal\",\r\n        group: \"Actions\",\r\n        displayName: \"Do\",\r\n        valueChangedToTrue() {\r\n          this.scheduleStore();\r\n        },\r\n      },\r\n    },\r\n    outputs: {\r\n      stored: {\r\n        type: \"signal\",\r\n        group: \"Events\",\r\n        displayName: \"Done\",\r\n      },\r\n    },\r\n    methods: {\r\n      getComponentObjectId: def.getComponentObjectId,\r\n      scheduleStore() {\r\n        if (this.hasScheduledStore) return;\r\n        this.hasScheduledStore = true;\r\n\r\n        var internal = this._internal;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const model = Model.get(this.getComponentObjectId());\r\n          this.hasScheduledStore = false;\r\n\r\n          const properties = this.model.parameters.properties || \"\";\r\n          const validProperties = properties.split(\",\");\r\n\r\n          const keysToSet = Object.keys(internal.inputValues).filter(\r\n            (key) => validProperties.indexOf(key) !== -1\r\n          );\r\n\r\n          for (const i of keysToSet) {\r\n            model.set(i, internal.inputValues[i], { resolve: true });\r\n          }\r\n          this.sendSignalOnOutput(\"stored\");\r\n        });\r\n      },\r\n      registerInputIfNeeded: function (name) {\r\n        if (this.hasInput(name)) {\r\n          return;\r\n        }\r\n\r\n        if (name.startsWith(\"prop-\")) {\r\n          const propertyName = name.substring(\"prop-\".length);\r\n          this.registerInput(name, {\r\n            set(value) {\r\n              this._internal.inputValues[propertyName] = value;\r\n            },\r\n          });\r\n        } else if (name.startsWith(\"type-\")) {\r\n          this.registerInput(name, {\r\n            set(value) {},\r\n          });\r\n        }\r\n      },\r\n    },\r\n  };\r\n\r\n  function updatePorts(nodeId, parameters, editorConnection) {\r\n    var ports = [];\r\n\r\n    const _types = [\r\n      { label: \"String\", value: \"string\" },\r\n      { label: \"Boolean\", value: \"boolean\" },\r\n      { label: \"Number\", value: \"number\" },\r\n      { label: \"Date\", value: \"date\" },\r\n      { label: \"Array\", value: \"array\" },\r\n      { label: \"Object\", value: \"object\" },\r\n      { label: \"Any\", value: \"*\" },\r\n    ];\r\n\r\n    // Add value outputs\r\n    var properties = parameters.properties;\r\n    if (properties) {\r\n      properties = properties ? properties.split(\",\") : undefined;\r\n      for (var i in properties) {\r\n        var p = properties[i];\r\n\r\n        // Property input\r\n        ports.push({\r\n          type: {\r\n            name:\r\n              parameters[\"type-\" + p] === undefined\r\n                ? \"*\"\r\n                : parameters[\"type-\" + p],\r\n          },\r\n          plug: \"input\",\r\n          group: \"Property Values\",\r\n          displayName: p,\r\n          //  editorName:p,\r\n          name: \"prop-\" + p,\r\n        });\r\n\r\n        // Property type\r\n        ports.push({\r\n          type: {\r\n            name: \"enum\",\r\n            enums: _types,\r\n            allowEditOnly: true,\r\n          },\r\n          plug: \"input\",\r\n          group: \"Property Types\",\r\n          displayName: p,\r\n          default: \"*\",\r\n          name: \"type-\" + p,\r\n        });\r\n      }\r\n    }\r\n\r\n    editorConnection.sendDynamicPorts(nodeId, ports, {\r\n      detectRenamed: {\r\n        plug: \"input\",\r\n      },\r\n    });\r\n  }\r\n\r\n  return {\r\n    node: SetComponentObjectProperties,\r\n    setup: function (context, graphModel) {\r\n      if (\r\n        !context.editorConnection ||\r\n        !context.editorConnection.isRunningLocally()\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      graphModel.on(\"nodeAdded.\" + def.name, (node) => {\r\n        updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n        node.on(\"parameterUpdated\", (event) => {\r\n          if (event.name === \"properties\" || event.name.startsWith(\"type-\")) {\r\n            updatePorts(node.id, node.parameters, context.editorConnection);\r\n          }\r\n        });\r\n      });\r\n    },\r\n  };\r\n}\r\n\r\nmodule.exports = {\r\n  extendSetComponentObjectProperties,\r\n};\r\n","\"use strict\";\r\n\r\nconst { Node } = require(\"@fluxscape/runtime\");\r\nconst Model = require(\"@fluxscape/runtime\");\r\n\r\nconst ComponentObject = {\r\n  name: \"net.noodl.ComponentObject\",\r\n  displayNodeName: \"Component Object\",\r\n  category: \"Component Utilities\",\r\n  color: \"component\",\r\n  docs: \"https://docs.noodl.net/nodes/component-utilities/component-object\",\r\n  initialize: function () {\r\n    this._internal.inputValues = {};\r\n    this._internal.dirtyValues = {};\r\n\r\n    this._internal.onModelChangedCallback = (args) => {\r\n      if (this.isInputConnected(\"fetch\") !== false) return;\r\n\r\n      if (this.hasOutput(\"value-\" + args.name)) {\r\n        this.flagOutputDirty(\"value-\" + args.name);\r\n      }\r\n\r\n      if (this.hasOutput(\"changed-\" + args.name)) {\r\n        this.sendSignalOnOutput(\"changed-\" + args.name);\r\n      }\r\n\r\n      this.sendSignalOnOutput(\"changed\");\r\n    };\r\n\r\n    const model = Model.get(\r\n      \"componentState\" + this.nodeScope.componentOwner.getInstanceId()\r\n    );\r\n    this._internal.model = model;\r\n\r\n    model.on(\"change\", this._internal.onModelChangedCallback);\r\n  },\r\n  getInspectInfo() {\r\n    return {\r\n      type: \"value\",\r\n      value: this._internal.model.data,\r\n    };\r\n  },\r\n  inputs: {\r\n    properties: {\r\n      type: {\r\n        name: \"stringlist\",\r\n        allowEditOnly: true,\r\n      },\r\n      displayName: \"Properties\",\r\n      group: \"Properties\",\r\n      set(value) {},\r\n    },\r\n    fetch: {\r\n      displayName: \"Fetch\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        this.scheduleFetch();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    changed: {\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n      group: \"Events\",\r\n    },\r\n    fetched: {\r\n      type: \"signal\",\r\n      displayName: \"Fetched\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n  methods: {\r\n    scheduleStore() {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledStore = false;\r\n        for (var i in internal.dirtyValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n        internal.dirtyValues = {};\r\n      });\r\n    },\r\n    scheduleFetch() {\r\n      if (this.hasScheduledFetch) return;\r\n      this.hasScheduledFetch = true;\r\n\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledFetch = false;\r\n        this.fetch();\r\n      });\r\n    },\r\n    fetch() {\r\n      for (var key in this._internal.model.data) {\r\n        if (this.hasOutput(\"value-\" + key)) {\r\n          this.flagOutputDirty(\"value-\" + key);\r\n          if (this.hasOutput(\"changed-\" + key)) {\r\n            this.sendSignalOnOutput(\"changed-\" + key);\r\n          }\r\n        }\r\n      }\r\n      this.sendSignalOnOutput(\"fetched\");\r\n    },\r\n    _onNodeDeleted() {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n      this._internal.model.off(\"change\", this._internal.onModelChangedCallback);\r\n    },\r\n    registerOutputIfNeeded(name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      const split = name.split(\"-\");\r\n      const propertyName = split[split.length - 1];\r\n\r\n      this.registerOutput(name, {\r\n        get() {\r\n          return this._internal.model.get(propertyName, { resolve: true });\r\n        },\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"value-\")) {\r\n        const propertyName = name.substring(\"value-\".length);\r\n        this.registerInput(name, {\r\n          set(value) {\r\n            this._internal.inputValues[propertyName] = value;\r\n            this._internal.dirtyValues[propertyName] = true;\r\n\r\n            this.scheduleStore();\r\n          },\r\n        });\r\n      }\r\n      /*  else if (name.startsWith('start-value-')) {\r\n                this.registerInput(name, {\r\n                    set(value) {\r\n                        this._internal.model.set(propertyName, value)\r\n                    }\r\n                });\r\n            }\r\n            else if (name.startsWith('type-')) {\r\n                this.registerInput(name, {\r\n                    set(value) {}\r\n                });\r\n            }*/\r\n    },\r\n  },\r\n};\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection) {\r\n  const ports = [];\r\n\r\n  // Add value outputs\r\n  if (parameters.properties) {\r\n    var properties = parameters.properties.split(\",\");\r\n    for (var i in properties) {\r\n      var p = properties[i];\r\n\r\n      ports.push({\r\n        type: {\r\n          name: \"*\",\r\n          allowConnectionsOnly: true,\r\n        },\r\n        plug: \"input/output\",\r\n        group: \"Properties\",\r\n        name: \"value-\" + p,\r\n        displayName: p,\r\n      });\r\n      /*   ports.push({\r\n                type: {\r\n                    name: parameters['type-' + p] || 'string',\r\n                    allowEditOnly: true\r\n                },\r\n                plug: 'input',\r\n                group: 'Start Values',\r\n                name: 'start-value-' + p,\r\n                displayName: p\r\n            });\r\n\r\n            ports.push({\r\n                type: {\r\n                    name: 'enum',\r\n                    enums: [\r\n                        { label: 'Number', value: 'number' },\r\n                        { label: 'String', value: 'string' },\r\n                        { label: 'Boolean', value: 'boolean' },\r\n                        { label: 'Color', value: 'color' },\r\n                        { label: 'Image', value: 'image' }\r\n                    ],\r\n                    allowEditOnly: true\r\n                },\r\n                default: 'string',\r\n                plug: 'input',\r\n                group: 'Types',\r\n                displayName: p,\r\n                name: 'type-' + p,\r\n            });*/\r\n\r\n      ports.push({\r\n        type: \"signal\",\r\n        plug: \"output\",\r\n        group: \"Changed Events\",\r\n        displayName: p + \" Changed\",\r\n        name: \"changed-\" + p,\r\n      });\r\n    }\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: \"input/output\",\r\n    },\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: ComponentObject,\r\n  setup: function (context, graphModel) {\r\n    if (\r\n      !context.editorConnection ||\r\n      !context.editorConnection.isRunningLocally()\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on(\"nodeAdded.net.noodl.ComponentObject\", (node) => {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n      node.on(\"parameterUpdated\", (event) => {\r\n        if (event.name === \"properties\") {\r\n          updatePorts(node.id, node.parameters, context.editorConnection);\r\n        }\r\n      });\r\n    });\r\n  },\r\n};\r\n","\"use strict\";\r\n\r\nconst { Node } = require(\"@fluxscape/runtime\");\r\nconst Model = require(\"@fluxscape/runtime\");\r\nconst EventEmitter = require(\"events\").EventEmitter;\r\n\r\nconst graphEventEmitter = new EventEmitter();\r\ngraphEventEmitter.setMaxListeners(1000000);\r\n\r\nconst ParentComponentObject = {\r\n  name: \"net.noodl.ParentComponentObject\",\r\n  displayNodeName: \"Parent Component Object\",\r\n  category: \"Component Utilities\",\r\n  color: \"component\",\r\n  docs: \"https://docs.noodl.net/nodes/component-utilities/parent-component-object\",\r\n  initialize() {\r\n    this._internal.inputValues = {};\r\n\r\n    this._internal.onModelChangedCallback = (args) => {\r\n      if (this.isInputConnected(\"fetch\") !== false) return;\r\n\r\n      if (this.hasOutput(\"value-\" + args.name)) {\r\n        this.flagOutputDirty(\"value-\" + args.name);\r\n      }\r\n\r\n      if (this.hasOutput(\"changed-\" + args.name)) {\r\n        this.sendSignalOnOutput(\"changed-\" + args.name);\r\n      }\r\n\r\n      this.sendSignalOnOutput(\"changed\");\r\n    };\r\n\r\n    //TODO: don't listen for delta updates when running deployed\r\n    this.onComponentStateNodesChanged = () => {\r\n      const id = this.findParentComponentStateModelId();\r\n\r\n      if (this._internal.modelId !== id) {\r\n        this._internal.modelId = id;\r\n\r\n        if (this.isInputConnected(\"fetch\") === false) {\r\n          this.setModelId(this._internal.modelId);\r\n        }\r\n      }\r\n    };\r\n\r\n    graphEventEmitter.on(\r\n      \"componentStateNodesChanged\",\r\n      this.onComponentStateNodesChanged\r\n    );\r\n\r\n    this.updateComponentState();\r\n  },\r\n  //to search up the tree the root nodes in this component must have been initialized\r\n  //we also need the connections to be setup so we can use isInputConnected\r\n  //nodeScopeDidInitialize takes care of that\r\n  nodeScopeDidInitialize() {\r\n    //FIXME: temporary hack. Our parent's node scope might not have finished created yet\r\n    //so just wait until after this update. It'll make the parent component state\r\n    //have a delay in propagating outputs which can cause subtle bugs.\r\n    //The fix is to call this code when the entire node tree has been created,\r\n    //before running updating the next update.\r\n    if (!this._internal.modelId) {\r\n      this.context.scheduleAfterUpdate(() => {\r\n        this.updateComponentState();\r\n      });\r\n    }\r\n  },\r\n  getInspectInfo() {\r\n    const model = this._internal.model;\r\n    if (!model) return \"No parent component state found\";\r\n\r\n    const modelInfo = [\r\n      { type: \"text\", value: this._internal.parentComponentName },\r\n    ];\r\n\r\n    const data = this._internal.model.data;\r\n    return modelInfo.concat(\r\n      Object.keys(data).map((key) => {\r\n        return { type: \"text\", value: key + \": \" + data[key] };\r\n      })\r\n    );\r\n  },\r\n  inputs: {\r\n    properties: {\r\n      type: {\r\n        name: \"stringlist\",\r\n        allowEditOnly: true,\r\n      },\r\n      displayName: \"Properties\",\r\n      group: \"Properties\",\r\n      set(value) {},\r\n    },\r\n    fetch: {\r\n      displayName: \"Fetch\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue: function () {\r\n        this.setModelId(this._internal.modelId);\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    changed: {\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n      group: \"Events\",\r\n    },\r\n    fetched: {\r\n      type: \"signal\",\r\n      displayName: \"Fetched\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n  methods: {\r\n    updateComponentState() {\r\n      this._internal.modelId = this.findParentComponentStateModelId();\r\n      if (this.isInputConnected(\"fetch\") === false) {\r\n        this.setModelId(this._internal.modelId);\r\n      }\r\n    },\r\n    findParentComponentStateModelId() {\r\n      function getParentComponent(component) {\r\n        let parent;\r\n        if (component.getRoots().length > 0) {\r\n          //visual\r\n          const root = component.getRoots()[0];\r\n\r\n          if (root.getVisualParentNode) {\r\n            //regular visual node\r\n            if (root.getVisualParentNode()) {\r\n              parent = root.getVisualParentNode().nodeScope.componentOwner;\r\n            }\r\n          } else if (root.parentNodeScope) {\r\n            //component instance node\r\n            parent = component.parentNodeScope.componentOwner;\r\n          }\r\n        } else if (component.parentNodeScope) {\r\n          parent = component.parentNodeScope.componentOwner;\r\n        }\r\n\r\n        //check that a parent exists and that the component is different\r\n        if (\r\n          parent &&\r\n          parent.nodeScope &&\r\n          parent.nodeScope.componentOwner !== component\r\n        ) {\r\n          //check if parent has a Component State node\r\n          if (\r\n            parent.nodeScope.getNodesWithType(\"net.noodl.ComponentObject\")\r\n              .length > 0\r\n          ) {\r\n            return parent;\r\n          }\r\n\r\n          //if not, continue searching up the tree\r\n          return getParentComponent(parent);\r\n        }\r\n      }\r\n\r\n      const parent = getParentComponent(this.nodeScope.componentOwner);\r\n      if (!parent) return;\r\n\r\n      this._internal.parentComponentName = parent.name;\r\n\r\n      return \"componentState\" + parent.getInstanceId();\r\n    },\r\n    setModelId(id) {\r\n      this._internal.model &&\r\n        this._internal.model.off(\r\n          \"change\",\r\n          this._internal.onModelChangedCallback\r\n        );\r\n      this._internal.model = undefined;\r\n\r\n      if (!id) return;\r\n\r\n      const model = Model.get(id);\r\n      this._internal.model = model;\r\n\r\n      model.on(\"change\", this._internal.onModelChangedCallback);\r\n\r\n      for (var key in model.data) {\r\n        if (this.hasOutput(\"value-\" + key)) {\r\n          this.flagOutputDirty(\"value-\" + key);\r\n        }\r\n        if (this.hasOutput(\"changed-\" + key)) {\r\n          this.sendSignalOnOutput(\"changed-\" + key);\r\n        }\r\n      }\r\n\r\n      this.sendSignalOnOutput(\"changed\");\r\n      this.sendSignalOnOutput(\"fetched\");\r\n    },\r\n    scheduleStore() {\r\n      if (this.hasScheduledStore) return;\r\n      this.hasScheduledStore = true;\r\n\r\n      var internal = this._internal;\r\n      this.scheduleAfterInputsHaveUpdated(() => {\r\n        this.hasScheduledStore = false;\r\n        if (!internal.model) return;\r\n        for (var i in internal.inputValues) {\r\n          internal.model.set(i, internal.inputValues[i], { resolve: true });\r\n        }\r\n      });\r\n    },\r\n    _onNodeDeleted() {\r\n      Node.prototype._onNodeDeleted.call(this);\r\n\r\n      graphEventEmitter.off(\r\n        \"componentStateNodesChanged\",\r\n        this.onComponentStateNodesChanged\r\n      );\r\n      this._internal.model &&\r\n        this._internal.model.off(\r\n          \"change\",\r\n          this._internal.onModelChangedCallback\r\n        );\r\n    },\r\n    registerOutputIfNeeded(name) {\r\n      if (this.hasOutput(name)) {\r\n        return;\r\n      }\r\n\r\n      const propertyName = name.substring(\"value-\".length);\r\n\r\n      this.registerOutput(name, {\r\n        get() {\r\n          if (!this._internal.model) return undefined;\r\n          return this._internal.model.get(propertyName, { resolve: true });\r\n        },\r\n      });\r\n    },\r\n    registerInputIfNeeded: function (name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"value-\")) {\r\n        const propertyName = name.substring(\"value-\".length);\r\n        this.registerInput(name, {\r\n          set(value) {\r\n            this._internal.inputValues[propertyName] = value;\r\n\r\n            this.scheduleStore();\r\n          },\r\n        });\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nfunction updatePorts(nodeId, parameters, editorConnection) {\r\n  const ports = [];\r\n\r\n  // Add value outputs\r\n  var properties = parameters.properties && parameters.properties.split(\",\");\r\n  for (var i in properties) {\r\n    var p = properties[i];\r\n\r\n    ports.push({\r\n      type: {\r\n        name: \"*\", //parameters['type-' + p] || 'string',\r\n        allowConnectionsOnly: true,\r\n      },\r\n      plug: \"input/output\",\r\n      group: \"Properties\",\r\n      name: \"value-\" + p,\r\n      displayName: p,\r\n    });\r\n\r\n    ports.push({\r\n      type: \"signal\",\r\n      plug: \"output\",\r\n      group: \"Changed Events\",\r\n      displayName: p + \" Changed\",\r\n      name: \"changed-\" + p,\r\n    });\r\n  }\r\n\r\n  editorConnection.sendDynamicPorts(nodeId, ports, {\r\n    detectRenamed: {\r\n      plug: \"input/output\",\r\n    },\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  node: ParentComponentObject,\r\n  setup: function (context, graphModel) {\r\n    if (\r\n      !context.editorConnection ||\r\n      !context.editorConnection.isRunningLocally()\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    graphModel.on(\"nodeAdded.net.noodl.ParentComponentObject\", (node) => {\r\n      updatePorts(node.id, node.parameters, context.editorConnection);\r\n\r\n      node.on(\"parameterUpdated\", (event) => {\r\n        updatePorts(node.id, node.parameters, context.editorConnection);\r\n      });\r\n    });\r\n\r\n    //TODO: handle additional delta update event:\r\n    // - visual parent changed\r\n\r\n    //this are the same events that'll create and delete the Comopent State instance node\r\n    //it might not have had a chance to run yet if we're first in the event list, so\r\n    //use a setTimeout\r\n    graphModel.on(\"nodeAdded.net.noodl.ComponentObject\", (node) => {\r\n      setTimeout(() => {\r\n        graphEventEmitter.emit(\"componentStateNodesChanged\");\r\n      }, 0);\r\n    });\r\n    graphModel.on(\"nodeRemoved.net.noodl.ComponentObject\", (node) => {\r\n      setTimeout(() => {\r\n        graphEventEmitter.emit(\"componentStateNodesChanged\");\r\n      });\r\n    });\r\n  },\r\n};\r\n","'use strict';\r\n\r\nconst Base = require('./base');\r\n\r\nmodule.exports = Base.extendSetComponentObjectProperties({\r\n  name: 'net.noodl.SetComponentObjectProperties',\r\n  displayName: 'Set Component Object Properties',\r\n  docs: 'https://docs.noodl.net/nodes/component-utilities/set-component-object-properties',\r\n  getComponentObjectId: function () {\r\n    return 'componentState' + this.nodeScope.componentOwner.getInstanceId();\r\n  }\r\n});\r\n","\"use strict\";\r\n\r\nconst { Node } = require(\"@fluxscape/runtime\");\r\nconst Model = require(\"@fluxscape/runtime\");\r\n\r\nconst Base = require(\"./base\");\r\n\r\nmodule.exports = Base.extendSetComponentObjectProperties({\r\n  name: \"net.noodl.SetParentComponentObjectProperties\",\r\n  displayName: \"Set Parent Component Object Properties\",\r\n  docs: \"https://docs.noodl.net/nodes/component-utilities/set-parent-component-object-properties\",\r\n  getComponentObjectId: function () {\r\n    function getParentComponent(component) {\r\n      let parent;\r\n      if (component.getRoots().length > 0) {\r\n        //visual\r\n        const root = component.getRoots()[0];\r\n\r\n        if (root.getVisualParentNode) {\r\n          //regular visual node\r\n          if (root.getVisualParentNode()) {\r\n            parent = root.getVisualParentNode().nodeScope.componentOwner;\r\n          }\r\n        } else if (root.parentNodeScope) {\r\n          //component instance node\r\n          parent = component.parentNodeScope.componentOwner;\r\n        }\r\n      } else if (component.parentNodeScope) {\r\n        parent = component.parentNodeScope.componentOwner;\r\n      }\r\n\r\n      //check that a parent exists and that the component is different\r\n      if (\r\n        parent &&\r\n        parent.nodeScope &&\r\n        parent.nodeScope.componentOwner !== component\r\n      ) {\r\n        //check if parent has a Component State node\r\n        if (\r\n          parent.nodeScope.getNodesWithType(\"net.noodl.ComponentObject\")\r\n            .length > 0\r\n        ) {\r\n          return parent;\r\n        }\r\n\r\n        //if not, continue searching up the tree\r\n        return getParentComponent(parent);\r\n      }\r\n    }\r\n\r\n    const parent = getParentComponent(this.nodeScope.componentOwner);\r\n    if (!parent) return;\r\n\r\n    this._internal.parentComponentName = parent.name;\r\n\r\n    return \"componentState\" + parent.getInstanceId();\r\n  },\r\n});\r\n","const _refCount = new Map(); //node id to ref count\r\n\r\nconst CSSDefinition = {\r\n  name: 'CSS Definition',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/css-definition',\r\n  category: 'CustomCode',\r\n  color: 'javascript',\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'Style'\r\n  },\r\n  initialize: function () {\r\n    var internal = this._internal;\r\n    internal.style = '';\r\n\r\n    const styleId = this.getStyleRefId();\r\n\r\n    this.addDeleteListener(() => {\r\n      _refCount.set(styleId, _refCount.get(styleId) - 1);\r\n      if (_refCount.get(styleId) === 0) {\r\n        this.removeStyleDeclaration();\r\n        _refCount.delete(styleId);\r\n      }\r\n    });\r\n\r\n    if (!_refCount.has(styleId)) {\r\n      _refCount.set(styleId, 0);\r\n    }\r\n\r\n    _refCount.set(styleId, _refCount.get(styleId) + 1);\r\n  },\r\n  inputs: {\r\n    style: {\r\n      index: 4005,\r\n      type: { name: 'string', allowEditOnly: true, codeeditor: 'css' },\r\n      displayName: 'Style',\r\n      group: 'Content',\r\n      default: '',\r\n\r\n      set: function (value) {\r\n        this.updateStyle(value);\r\n      }\r\n    }\r\n  },\r\n  outputs: {},\r\n  methods: {\r\n    getStyleRefId: function () {\r\n      return 'style_' + this.id;\r\n    },\r\n    removeStyleDeclaration: function () {\r\n      // Add SSR Support\r\n      if (typeof document === 'undefined') return;\r\n\r\n      var styleRefId = this.getStyleRefId();\r\n      var styleObj = document.getElementById(styleRefId);\r\n      if (styleObj !== null) {\r\n        styleObj.parentNode.removeChild(styleObj);\r\n      }\r\n    },\r\n    updateStyle: function (style) {\r\n      // Add SSR Support\r\n      if (typeof document === 'undefined') return;\r\n\r\n      var internal = this._internal;\r\n      var styleRefId = this.getStyleRefId();\r\n      internal.style = style;\r\n\r\n      if (style !== null) {\r\n        var styleObj = document.getElementById(styleRefId);\r\n        if (styleObj === null) {\r\n          styleObj = document.createElement('style');\r\n          styleObj.id = styleRefId;\r\n          styleObj.type = 'text/css';\r\n          document.head.appendChild(styleObj);\r\n        }\r\n\r\n        styleObj.innerHTML = '\\n' + style + '\\n';\r\n      } else {\r\n        this.removeStyleDeclaration();\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  node: CSSDefinition\r\n};\r\n","module.exports = React;","module.exports = ReactDOM;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nc = undefined;","import { EditorConnection } from \"@fluxscape/runtime\";\r\nimport { GraphModel } from \"@fluxscape/runtime\";\r\n\r\nexport default class GraphWarnings {\r\n  private graphModel: any;\r\n  private editorConnection: any;\r\n\r\n  constructor(graphModel: GraphModel, editorConnection: EditorConnection) {\r\n    this.graphModel = graphModel;\r\n    this.editorConnection = editorConnection;\r\n\r\n    this.graphModel\r\n      .getAllComponents()\r\n      .forEach((c: any) => this._bindComponentModel(c));\r\n    this.graphModel.on(\r\n      \"componentAdded\",\r\n      (c: any) => this._bindComponentModel(c),\r\n      this\r\n    );\r\n    this.graphModel.on(\r\n      \"componentRemoved\",\r\n      (c: any) => c.removeListenersWithRef(this),\r\n      this\r\n    );\r\n  }\r\n\r\n  private _bindComponentModel(c: any) {\r\n    c.on(\"rootAdded\", () => this._evaluateWarnings(c), this);\r\n    c.on(\r\n      \"rootRemoved\",\r\n      (root: any) => {\r\n        this.editorConnection.clearWarning(\r\n          c.name,\r\n          root,\r\n          \"multiple-visual-roots-warning\"\r\n        );\r\n        this._evaluateWarnings(c);\r\n      },\r\n      this\r\n    );\r\n    this._evaluateWarnings(c);\r\n  }\r\n\r\n  private _evaluateWarnings(c: any) {\r\n    const roots = c.getRoots();\r\n\r\n    if (roots.length === 0) return;\r\n\r\n    this.editorConnection.clearWarning(\r\n      c.name,\r\n      roots[0],\r\n      \"multiple-visual-roots-warning\"\r\n    );\r\n    for (let i = 1; i < roots.length; i++) {\r\n      this.editorConnection.sendWarning(\r\n        c.name,\r\n        roots[i],\r\n        \"multiple-visual-roots-warning\",\r\n        {\r\n          message:\r\n            \"This node is detached from the main node tree<br>and won't be rendered\",\r\n          level: \"info\",\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  dispose() {\r\n    this.graphModel.getAllComponents().forEach((c: any) => {\r\n      c.removeListenersWithRef(this);\r\n    });\r\n\r\n    this.graphModel.removeListenersWithRef(this);\r\n  }\r\n}\r\n","import NoodlRuntime from \"@fluxscape/runtime\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nexport class Highlighter {\r\n  private highlightedNodes: Map<any, HTMLElement>;\r\n  private selectedNodes: Map<any, HTMLElement>;\r\n  private noodlRuntime: NoodlRuntime;\r\n  private isUpdatingHighlights: boolean;\r\n  private highlightRootDiv: HTMLDivElement;\r\n  private windowBorderDiv: HTMLDivElement;\r\n\r\n  constructor(noodlRuntime: NoodlRuntime) {\r\n    this.highlightedNodes = new Map();\r\n    this.selectedNodes = new Map();\r\n    this.noodlRuntime = noodlRuntime;\r\n\r\n    this.isUpdatingHighlights = false;\r\n\r\n    //create the div that holds the highlight and selection UI\r\n    const div = document.createElement(\"div\");\r\n    div.style.width = \"100%\";\r\n    div.style.height = \"100%\";\r\n    div.style.top = \"0\";\r\n    div.style.left = \"0\";\r\n    div.style.overflow = \"hidden\";\r\n    div.style.position = \"fixed\";\r\n    div.style.zIndex = \"1000000000\";\r\n    div.style.pointerEvents = \"none\";\r\n    document.body.appendChild(div);\r\n    this.highlightRootDiv = div;\r\n\r\n    this.windowBorderDiv = this.createHighlightDiv();\r\n    this.windowBorderDiv.style.position = \"absolute\";\r\n    this.windowBorderDiv.style.top = \"0\";\r\n    this.windowBorderDiv.style.left = \"0\";\r\n    this.windowBorderDiv.style.boxShadow = \"inset 0 0 0 3px #2CA7BA\";\r\n    this.windowBorderDiv.style.opacity = \"1.0\";\r\n    this.windowBorderDiv.style.width = \"100vw\";\r\n    this.windowBorderDiv.style.height = \"100vh\";\r\n  }\r\n\r\n  private createHighlightDiv(): HTMLDivElement {\r\n    const div = document.createElement(\"div\");\r\n    div.style.position = \"absolute\";\r\n    div.style.top = \"0\";\r\n    div.style.left = \"0\";\r\n    div.style.outline = \"2px solid #2CA7BA\";\r\n    div.style.opacity = \"1.0\";\r\n    return div;\r\n  }\r\n\r\n  setWindowSelected(enabled: boolean): void {\r\n    return; //disable this feature for now, needs some iteration\r\n\r\n    /*if (enabled) {\r\n      this.highlightRootDiv.appendChild(this.windowBorderDiv);\r\n    } else {\r\n      this.windowBorderDiv.parentNode && this.windowBorderDiv.parentNode.removeChild(this.windowBorderDiv);\r\n    }*/\r\n  }\r\n\r\n  updateHighlights(): void {\r\n    const items = Array.from(this.highlightedNodes.entries()).concat(\r\n      Array.from(this.selectedNodes.entries())\r\n    );\r\n\r\n    for (const item of items) {\r\n      const domNode =\r\n        item[0].getRef() && ReactDOM.findDOMNode(item[0].getRef());\r\n\r\n      if (!domNode) {\r\n        //user has deleted this node, just remove it\r\n        this.highlightedNodes.delete(item[0]);\r\n        item[1].remove();\r\n        continue;\r\n      }\r\n\r\n      const rect = domNode.getBoundingClientRect();\r\n      const highlight = item[1];\r\n\r\n      highlight.style.transform = `translateX(${rect.x}px) translateY(${rect.y}px)`;\r\n      highlight.style.width = rect.width + \"px\";\r\n      highlight.style.height = rect.height + \"px\";\r\n    }\r\n\r\n    this.isUpdatingHighlights =\r\n      this.highlightedNodes.size > 0 || this.selectedNodes.size > 0;\r\n\r\n    if (this.isUpdatingHighlights) {\r\n      requestAnimationFrame(this.updateHighlights.bind(this));\r\n    }\r\n  }\r\n\r\n  highlightNodesWithId(nodeId: string): void {\r\n    //gather all nodes with a DOM node we can highlight, that aren't already highlighted\r\n    const nodes = getNodes(this.noodlRuntime, nodeId)\r\n      .filter((node: any) => node.getRef)\r\n      .filter((node: any) => !this.highlightedNodes.has(node));\r\n\r\n    for (const node of nodes) {\r\n      const highlight = this.createHighlightDiv();\r\n\r\n      this.highlightRootDiv.appendChild(highlight);\r\n      this.highlightedNodes.set(node, highlight);\r\n    }\r\n\r\n    if (\r\n      (this.selectedNodes.size > 0 || this.highlightedNodes.size > 0) &&\r\n      !this.isUpdatingHighlights\r\n    ) {\r\n      this.updateHighlights();\r\n    }\r\n  }\r\n\r\n  disableHighlight(): void {\r\n    for (const item of this.highlightedNodes) {\r\n      const highlight = item[1];\r\n      if (highlight) {\r\n        highlight.remove();\r\n      }\r\n    }\r\n    this.highlightedNodes.clear();\r\n  }\r\n\r\n  selectNodesWithId(nodeId: string): any[] {\r\n    //we don't track when nodes are created, so if there's no root component, wait a while and then highlight so we can get all the instances\r\n    //TODO: track nodes as they're created so newly created nodes can be selected if their IDs match\r\n    if (!this.noodlRuntime.rootComponent) {\r\n      this.noodlRuntime.eventEmitter.once(\"rootComponentUpdated\", () => {\r\n        setTimeout(() => {\r\n          this.selectNodesWithId(nodeId);\r\n        }, 300);\r\n      });\r\n    }\r\n\r\n    const nodes = getNodes(this.noodlRuntime, nodeId)\r\n      .filter((node: any) => node.getRef)\r\n      .filter((node: any) => !this.selectedNodes.has(node));\r\n\r\n    for (const node of nodes) {\r\n      const selection = this.createHighlightDiv();\r\n\r\n      this.highlightRootDiv.appendChild(selection);\r\n      this.selectedNodes.set(node, selection);\r\n    }\r\n\r\n    if (this.selectedNodes.size > 0) {\r\n      this.setWindowSelected(false);\r\n    }\r\n\r\n    if (\r\n      (this.selectedNodes.size > 0 || this.highlightedNodes.size > 0) &&\r\n      !this.isUpdatingHighlights\r\n    ) {\r\n      this.updateHighlights();\r\n    }\r\n\r\n    return nodes;\r\n  }\r\n\r\n  deselectNodes(): void {\r\n    for (const item of this.selectedNodes) {\r\n      const selection = item[1];\r\n      if (selection) {\r\n        selection.remove();\r\n      }\r\n    }\r\n    this.selectedNodes.clear();\r\n  }\r\n}\r\n\r\nfunction getNodes(noodlRuntime: NoodlRuntime, nodeId: string): any[] {\r\n  if (!noodlRuntime.rootComponent) {\r\n    return [];\r\n  }\r\n  return noodlRuntime.rootComponent.nodeScope.getNodesWithIdRecursive(nodeId);\r\n}\r\n","export class Inspector {\r\n  private component?: any;\r\n  private onDisableHighlight: () => void;\r\n  private onMouseMove: (e: MouseEvent) => void;\r\n  private onClick: (e: MouseEvent) => void;\r\n  private onContextMenu: (e: MouseEvent) => void;\r\n  private onMouseOut: (e: MouseEvent) => void;\r\n  private blockEvent: (e: Event) => void;\r\n\r\n  constructor({\r\n    onInspect,\r\n    onHighlight,\r\n    onDisableHighlight,\r\n  }: {\r\n    onInspect: (ids: string[]) => void;\r\n    onHighlight: (id: string) => void;\r\n    onDisableHighlight: () => void;\r\n  }) {\r\n    this.onMouseMove = (e: MouseEvent) => {\r\n      onDisableHighlight();\r\n\r\n      const noodlNode = this.findNoodlNode(e.target as HTMLElement);\r\n      if (noodlNode) {\r\n        document.body.style.cursor = \"pointer\";\r\n        onHighlight(noodlNode.id);\r\n      } else {\r\n        document.body.style.cursor = \"initial\";\r\n      }\r\n\r\n      e.stopPropagation();\r\n    };\r\n\r\n    this.onClick = (e: MouseEvent) => {\r\n      onDisableHighlight();\r\n\r\n      const noodlNode = this.findNoodlNode(e.target as HTMLElement);\r\n      if (noodlNode) {\r\n        onInspect([noodlNode.id]);\r\n      }\r\n\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n\r\n      //not sure how to stop React input elements from getting focus, so blurring the potential element that got focus on click\r\n      if (document.activeElement) {\r\n        (document.activeElement as HTMLElement).blur();\r\n      }\r\n    };\r\n\r\n    this.onContextMenu = (e: MouseEvent) => {\r\n      const nodeIds = document\r\n        .elementsFromPoint(e.clientX, e.clientY)\r\n        .map((dom) => this.findNoodlNode(dom as HTMLElement))\r\n        .filter((node) => !!node)\r\n        .map((node) => node.id);\r\n\r\n      if (nodeIds.length) {\r\n        onInspect(nodeIds);\r\n      }\r\n\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n\r\n      //not sure how to stop React input elements from getting focus, so blurring the potential element that got focus on click\r\n      if (document.activeElement) {\r\n        (document.activeElement as HTMLElement).blur();\r\n      }\r\n    };\r\n\r\n    this.onMouseOut = (e: MouseEvent) => {\r\n      onDisableHighlight();\r\n    };\r\n\r\n    this.blockEvent = (e: Event) => {\r\n      e.stopPropagation();\r\n    };\r\n\r\n    this.onDisableHighlight = onDisableHighlight;\r\n  }\r\n\r\n  setComponent(component: any) {\r\n    this.component = component;\r\n  }\r\n\r\n  enable() {\r\n    //blur active element, if any\r\n    if (document.activeElement) {\r\n      (document.activeElement as HTMLElement).blur();\r\n    }\r\n\r\n    //get events from capture phase, before they tunnel down the tree\r\n    document.addEventListener(\"mouseenter\", this.blockEvent, true);\r\n    document.addEventListener(\"mouseover\", this.blockEvent, true);\r\n    document.addEventListener(\"mousedown\", this.blockEvent, true);\r\n    document.addEventListener(\"mouseup\", this.blockEvent, true);\r\n    document.addEventListener(\"mousemove\", this.onMouseMove, true);\r\n    document.addEventListener(\"mouseout\", this.onMouseOut, true);\r\n    document.addEventListener(\"click\", this.onClick, true);\r\n    document.addEventListener(\"contextmenu\", this.onContextMenu, true);\r\n  }\r\n\r\n  disable() {\r\n    document.body.style.cursor = \"initial\";\r\n\r\n    document.removeEventListener(\"mouseenter\", this.blockEvent, true);\r\n    document.removeEventListener(\"mouseover\", this.blockEvent, true);\r\n    document.removeEventListener(\"mousedown\", this.blockEvent, true);\r\n    document.removeEventListener(\"mouseup\", this.blockEvent, true);\r\n    document.removeEventListener(\"mousemove\", this.onMouseMove, true);\r\n    document.removeEventListener(\"mouseout\", this.onMouseOut, true);\r\n    document.removeEventListener(\"click\", this.onClick, true);\r\n    document.removeEventListener(\"contextmenu\", this.onContextMenu, true);\r\n\r\n    this.onDisableHighlight();\r\n  }\r\n\r\n  findNoodlNode(dom: HTMLElement | null): any {\r\n    //walk the dom tree upwards until a dom element with react state is found\r\n    let domFiber: any;\r\n    while (!domFiber && dom) {\r\n      const key = Object.keys(dom).find((key) =>\r\n        key.startsWith(\"__reactInternalInstance$\")\r\n      );\r\n      domFiber = key ? dom[key] : null;\r\n      if (!domFiber) {\r\n        dom = dom.parentElement;\r\n      }\r\n    }\r\n\r\n    //found none\r\n    if (!domFiber) {\r\n      return undefined;\r\n    }\r\n\r\n    const GetCompFiber = (fiber: any) => {\r\n      let parentFiber = fiber.return;\r\n      while (parentFiber && typeof parentFiber.type === \"string\") {\r\n        parentFiber = parentFiber.return;\r\n      }\r\n      return parentFiber;\r\n    };\r\n\r\n    //found a react node, now walk the react tree until a noodl node is found\r\n    //(identified by having a noodlNode prop)\r\n    let compFiber = GetCompFiber(domFiber);\r\n    while (\r\n      compFiber &&\r\n      (!compFiber.stateNode ||\r\n        !compFiber.stateNode.props ||\r\n        !compFiber.stateNode.props.noodlNode)\r\n    ) {\r\n      compFiber = GetCompFiber(compFiber);\r\n    }\r\n\r\n    const noodlNode = compFiber\r\n      ? compFiber.stateNode.props.noodlNode\r\n      : undefined;\r\n    if (!noodlNode) return;\r\n\r\n    if (this.component) {\r\n      let node = noodlNode;\r\n\r\n      while (node) {\r\n        if (node.parentNodeScope) {\r\n          if (\r\n            node.parentNodeScope.componentOwner.name === this.component.name\r\n          ) {\r\n            return node;\r\n          }\r\n          node = node.parentNodeScope.componentOwner;\r\n        } else {\r\n          if (node.nodeScope.componentOwner.name === this.component.name) {\r\n            return node;\r\n          }\r\n          node = node.nodeScope.componentOwner;\r\n        }\r\n      }\r\n\r\n      return node;\r\n    }\r\n\r\n    return noodlNode;\r\n  }\r\n}\r\n","const IS_BROWSER = typeof document !== \"undefined\";\r\n\r\nexport class SeoApi {\r\n  private _title = \"\";\r\n  private _meta: Record<string, string> = {};\r\n\r\n  /** Returns the current document title. */\r\n  get title(): string {\r\n    return IS_BROWSER ? document.title : this._title;\r\n  }\r\n\r\n  /** Set the document title. */\r\n  setTitle(value: string) {\r\n    this._title = value;\r\n\r\n    if (IS_BROWSER) {\r\n      document.title = value;\r\n    }\r\n  }\r\n\r\n  /** Returns all the current meta-tags  */\r\n  get meta(): Readonly<SeoApi[\"_meta\"]> {\r\n    return this._meta;\r\n  }\r\n\r\n  /** Clear all the meta-tags. */\r\n  clearMeta(): void {\r\n    if (IS_BROWSER) {\r\n      // Remove all the meta-tags, technically this is useless when running client-side.\r\n      Object.keys(this._meta).forEach((key) => {\r\n        const metaTag = document.querySelector(`meta[name=\"${key}\"]`);\r\n        if (metaTag) {\r\n          metaTag.remove();\r\n        }\r\n      });\r\n    }\r\n\r\n    this._meta = {};\r\n  }\r\n\r\n  /** Returns a specific meta-tag by name. */\r\n  getMeta(key: string) {\r\n    // NOTE: We are not querying if the meta-tag exist, maybe something we would like to do?\r\n    return this._meta[key];\r\n  }\r\n\r\n  /**\r\n   * Set a meta-tag.\r\n   *\r\n   * @param key The 'name' and/or the 'property' key used for the meta-tags.\r\n   * @param value The meta-tag content; if undefined, the meta-tag is removed.\r\n   */\r\n  setMeta(key: string, value: string | undefined): void {\r\n    // @ts-expect-error\r\n    this._meta[key] = value;\r\n\r\n    if (IS_BROWSER) {\r\n      const metaTag = document.querySelector(`meta[name=\"${key}\"]`);\r\n      if (metaTag) {\r\n        if (!value) {\r\n          metaTag.remove();\r\n        } else {\r\n          metaTag.setAttribute(\"content\", value);\r\n        }\r\n      } else if (value) {\r\n        const newMetaTag = document.createElement(\"meta\");\r\n        newMetaTag.setAttribute(\"name\", key);\r\n        newMetaTag.setAttribute(\"property\", key);\r\n        newMetaTag.setAttribute(\"content\", value);\r\n        document.head.appendChild(newMetaTag);\r\n      }\r\n    }\r\n  }\r\n}\r\n","import NoodlRuntime from \"@fluxscape/runtime/src/runtime\";\r\nimport { RouterHandler } from \"../nodes/navigation/router-handler\";\r\n\r\ninterface ShowPopupOptions {\r\n  onClosePopup: (action: string | undefined, results: any) => void;\r\n}\r\n\r\ninterface NavigateOptions {\r\n  query?: Record<string, string>;\r\n}\r\n\r\ninterface Navigation {\r\n  _noodlRuntime: NoodlRuntime | undefined;\r\n  showPopup(\r\n    componentPath: string,\r\n    params: any\r\n  ): Promise<{ action: string | undefined; parameters: any }>;\r\n  navigate(routerName: string, targetPageName: string, params: any): void;\r\n  navigateToPath(path: string, options?: NavigateOptions): void;\r\n}\r\n\r\nconst navigation: Navigation = {\r\n  /**\r\n   * This is set by \"packages/noodl-viewer-react/src/noodl-js-api.js\"\r\n   */\r\n  _noodlRuntime: undefined,\r\n\r\n  async showPopup(\r\n    componentPath: string,\r\n    params: any\r\n  ): Promise<{ action: string | undefined; parameters: any }> {\r\n    return new Promise<{ action: string | undefined; parameters: any }>(\r\n      (resolve) => {\r\n        navigation._noodlRuntime!.context.showPopup(componentPath, params, {\r\n          onClosePopup: (action, results) => {\r\n            resolve({\r\n              action: action?.replace(\"closeAction-\", \"\"),\r\n              parameters: results,\r\n            });\r\n          },\r\n        });\r\n      }\r\n    );\r\n  },\r\n\r\n  navigate(routerName: string, targetPageName: string, params: any): void {\r\n    RouterHandler.instance.navigate(routerName, {\r\n      target: targetPageName,\r\n      params: params,\r\n    });\r\n  },\r\n\r\n  navigateToPath(path: string, options?: NavigateOptions): void {\r\n    let hashPath: string | undefined, urlPath: string | undefined;\r\n    const navigationPathType =\r\n      NoodlRuntime.instance.getProjectSettings()[\"navigationPathType\"];\r\n    if (navigationPathType === undefined || navigationPathType === \"hash\") {\r\n      hashPath = path;\r\n    } else {\r\n      urlPath = path;\r\n    }\r\n\r\n    const query: string[] = [];\r\n    if (options && options.query !== undefined) {\r\n      for (const key in options.query) {\r\n        query.push(`${key}=${options.query[key]}`);\r\n      }\r\n    }\r\n\r\n    const compiledUrl =\r\n      (urlPath !== undefined ? urlPath : \"\") +\r\n      (query.length >= 1 ? \"?\" + query.join(\"&\") : \"\") +\r\n      (hashPath !== undefined ? \"#\" + hashPath : \"\");\r\n\r\n    window.history.pushState({}, \"\", compiledUrl);\r\n    dispatchEvent(new PopStateEvent(\"popstate\", {}));\r\n  },\r\n};\r\n\r\nexport default navigation;\r\n","import { CloudStore } from \"@fluxscape/runtime/src/api/cloudstore\";\r\nimport { CloudFile } from \"@fluxscape/runtime/src/api/cloudfile\";\r\n\r\ninterface UploadOptions {\r\n  onProgress?: (progress: number) => void;\r\n}\r\n\r\nconst files = {\r\n  async upload(file: File, options?: UploadOptions): Promise<CloudFile> {\r\n    return new Promise((resolve, reject) => {\r\n      CloudStore.instance.uploadFile({\r\n        file,\r\n        // @ts-expect-error process is not typed\r\n        onUploadProgress: (p: number) => {\r\n          options?.onProgress?.(p);\r\n        },\r\n        success: (response: any) => {\r\n          resolve(new CloudFile(response));\r\n        },\r\n        error: (e: any) => {\r\n          reject(e);\r\n        },\r\n      });\r\n    });\r\n  },\r\n};\r\n\r\nexport default files;\r\n","export default {\r\n  ports: [\r\n    {\r\n      name: \"htmlTitle\",\r\n      displayName: \"Title\",\r\n      group: \"General\",\r\n      plug: \"input\",\r\n      type: \"string\",\r\n      default: \"Fluxscape Viewer\",\r\n      tooltip: \"The title that web browsers show\",\r\n      ignoreInExport: true,\r\n    },\r\n    {\r\n      name: \"headCode\",\r\n      displayName: \"Head Code\",\r\n      group: \"Custom Code\",\r\n      plug: \"input\",\r\n      type: {\r\n        name: \"string\",\r\n        codeeditor: \"html\",\r\n      },\r\n      tooltip: \"Add custom code to the &lt;head&gt; tag\",\r\n      ignoreInExport: true,\r\n    },\r\n    {\r\n      name: \"navigationPathType\",\r\n      displayName: \"URL Path Type\",\r\n      group: \"Navigation\",\r\n      plug: \"input\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Hash\", value: \"hash\" },\r\n          { label: \"Path\", value: \"path\" },\r\n        ],\r\n      },\r\n      default: \"hash\",\r\n    },\r\n    {\r\n      name: \"bodyScroll\",\r\n      displayName: \"Body Scroll\",\r\n      group: \"Experimental features\",\r\n      plug: \"input\",\r\n      type: {\r\n        name: \"boolean\",\r\n      },\r\n      tooltip: \"Changes so the &lt;body&gt; tag will scroll by default\",\r\n    },\r\n    {\r\n      name: \"repeaterDisabledWhenUnmounted\",\r\n      displayName: \"Disable when unmounted\",\r\n      group: \"Experimental features - Repeater\",\r\n      plug: \"input\",\r\n      type: {\r\n        name: \"boolean\",\r\n      },\r\n      tooltip: \"Repeater will only create components when it's mounted\",\r\n    },\r\n    {\r\n      name: \"repeaterCreateComponentsAsync\",\r\n      displayName: \"Create asynchronously\",\r\n      group: \"Experimental features - Repeater\",\r\n      plug: \"input\",\r\n      type: {\r\n        name: \"boolean\",\r\n      },\r\n      tooltip: \"Repeater items will be created in chunks to keep UI responsive\",\r\n    },\r\n  ],\r\n};\r\n","export class DOMBoundingBoxObserver {\r\n  private isRunning: boolean;\r\n  private numBoundingBoxObservers: number;\r\n  private callback: (type: string, boundingBox: DOMRect) => void;\r\n  private pollDelay?: number;\r\n  private target?: HTMLElement;\r\n\r\n  constructor(\r\n    callback: (type: string, boundingBox: DOMRect) => void,\r\n    pollDelay?: number\r\n  ) {\r\n    this.isRunning = false;\r\n    this.numBoundingBoxObservers = 0;\r\n    this.callback = callback;\r\n    this.pollDelay = pollDelay;\r\n  }\r\n\r\n  addObserver() {\r\n    this.numBoundingBoxObservers++;\r\n\r\n    if (!this.isRunning) {\r\n      this._startObserver();\r\n    }\r\n  }\r\n\r\n  removeObserver() {\r\n    this.numBoundingBoxObservers--;\r\n    if (this.numBoundingBoxObservers === 0) {\r\n      this._stopObserver();\r\n    }\r\n  }\r\n\r\n  setTarget(target: HTMLElement) {\r\n    this.target = target;\r\n    if (this.numBoundingBoxObservers > 0 && !this.isRunning) {\r\n      this._startObserver();\r\n    }\r\n  }\r\n\r\n  private _startObserver() {\r\n    if (this.isRunning) return;\r\n    if (!this.target) return;\r\n\r\n    this.isRunning = true;\r\n\r\n    let boundingRect: DOMRect = this.target.getBoundingClientRect();\r\n    const observer = () => {\r\n      if (!this.target) {\r\n        this.isRunning = false;\r\n        return;\r\n      }\r\n\r\n      const bb = this.target.getBoundingClientRect();\r\n      if (boundingRect.x !== bb.x) {\r\n        this.callback(\"x\", bb);\r\n      }\r\n      if (boundingRect.y !== bb.y) {\r\n        this.callback(\"y\", bb);\r\n      }\r\n      if (boundingRect.width !== bb.width) {\r\n        this.callback(\"width\", bb);\r\n      }\r\n      if (boundingRect.height !== bb.height) {\r\n        this.callback(\"height\", bb);\r\n      }\r\n      boundingRect = bb;\r\n\r\n      if (this.isRunning) {\r\n        if (this.pollDelay) {\r\n          setTimeout(observer, this.pollDelay);\r\n        } else {\r\n          //poll as quickly as possible\r\n          window.requestAnimationFrame(observer);\r\n        }\r\n      }\r\n    };\r\n\r\n    window.requestAnimationFrame(observer);\r\n  }\r\n\r\n  private _stopObserver() {\r\n    this.isRunning = false;\r\n  }\r\n}\r\n","function isPercentage(size) {\r\n  return size && size[size.length - 1] === \"%\";\r\n}\r\n\r\nfunction getPercentage(size) {\r\n  return Number(size.slice(0, -1));\r\n}\r\n\r\nfunction getSizeWithMargins(size, startMargin, endMargin) {\r\n  if (!startMargin && !endMargin) {\r\n    return size;\r\n  }\r\n\r\n  let css = `calc(${size}`;\r\n  if (startMargin) {\r\n    css += ` - ${startMargin}`;\r\n  }\r\n  if (endMargin) {\r\n    css += ` - ${endMargin}`;\r\n  }\r\n  css += \")\";\r\n\r\n  return css;\r\n}\r\n\r\nexport default {\r\n  size(style, props) {\r\n    if (props.parentLayout === \"none\") {\r\n      style.position = \"absolute\";\r\n    }\r\n\r\n    if (props.sizeMode === \"explicit\") {\r\n      style.width = props.width;\r\n      style.height = props.height;\r\n    } else if (props.sizeMode === \"contentHeight\") {\r\n      style.width = props.width;\r\n    } else if (props.sizeMode === \"contentWidth\") {\r\n      style.height = props.height;\r\n    }\r\n\r\n    style.flexShrink = 0;\r\n\r\n    if (props.parentLayout === \"row\" && style.position === \"relative\") {\r\n      if (isPercentage(style.width) && !props.fixedWidth) {\r\n        style.flexGrow = getPercentage(style.width);\r\n        style.flexShrink = 1;\r\n      }\r\n\r\n      if (isPercentage(style.height) && !props.fixedHeight) {\r\n        style.height = getSizeWithMargins(\r\n          style.height,\r\n          style.marginTop,\r\n          style.marginBottom\r\n        );\r\n      }\r\n    } else if (\r\n      props.parentLayout === \"column\" &&\r\n      style.position === \"relative\"\r\n    ) {\r\n      if (isPercentage(style.width) && !props.fixedWidth) {\r\n        style.width = getSizeWithMargins(\r\n          style.width,\r\n          style.marginLeft,\r\n          style.marginRight\r\n        );\r\n      }\r\n\r\n      if (isPercentage(style.height) && !props.fixedHeight) {\r\n        style.flexGrow = getPercentage(style.height);\r\n        style.flexShrink = 1;\r\n      }\r\n    } else if (style.position !== \"relative\") {\r\n      if (isPercentage(style.width)) {\r\n        style.width = getSizeWithMargins(\r\n          style.width,\r\n          style.marginLeft,\r\n          style.marginRight\r\n        );\r\n      }\r\n      if (isPercentage(style.height)) {\r\n        style.height = getSizeWithMargins(\r\n          style.height,\r\n          style.marginTop,\r\n          style.marginBottom\r\n        );\r\n      }\r\n    }\r\n  },\r\n  align(style, props) {\r\n    const { position } = style;\r\n    let { alignX, alignY } = props;\r\n\r\n    //Elements with position absolute get's a default alignment.\r\n    //This keeps backward compability, and makes sense for most use cases of\r\n    //absolutely positioned elements\r\n    if (position !== \"relative\") {\r\n      alignX = alignX || \"left\";\r\n      alignY = alignY || \"top\";\r\n    }\r\n\r\n    let transform = \"\";\r\n\r\n    const parentFlexDirection = props.parentLayout || \"column\";\r\n    if (alignX) {\r\n      if (position !== \"relative\") {\r\n        if (alignX === \"left\") {\r\n          style.left = 0;\r\n        } else if (alignX === \"center\") {\r\n          style.left = \"50%\";\r\n          transform += \"translateX(-50%) \";\r\n        } else {\r\n          style.right = 0;\r\n        }\r\n      } else if (position === \"relative\" && parentFlexDirection === \"row\") {\r\n        switch (alignX) {\r\n          case \"left\":\r\n            style.marginRight = style.marginRight ? style.marginRight : \"auto\";\r\n            break;\r\n          case \"center\":\r\n            style.marginRight = style.marginRight ? style.marginRight : \"auto\";\r\n            style.marginLeft = style.marginLeft ? style.marginLeft : \"auto\";\r\n            break;\r\n          case \"right\":\r\n            style.marginLeft = style.marginLeft ? style.marginLeft : \"auto\";\r\n            break;\r\n        }\r\n      } else if (position === \"relative\" && parentFlexDirection === \"column\") {\r\n        switch (alignX) {\r\n          case \"left\":\r\n            style.alignSelf = \"flex-start\";\r\n            break;\r\n          case \"center\":\r\n            style.alignSelf = \"center\";\r\n            break;\r\n          case \"right\":\r\n            style.alignSelf = \"flex-end\";\r\n            break;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (alignY) {\r\n      if (position !== \"relative\") {\r\n        if (alignY === \"top\") {\r\n          style.top = 0;\r\n        } else if (alignY === \"center\") {\r\n          style.top = \"50%\";\r\n          transform += \"translateY(-50%)\";\r\n        } else {\r\n          style.bottom = 0;\r\n        }\r\n      } else if (position === \"relative\" && parentFlexDirection === \"column\") {\r\n        switch (alignY) {\r\n          case \"top\":\r\n            style.marginBottom = style.marginBottom\r\n              ? style.marginBottom\r\n              : \"auto\";\r\n            break;\r\n          case \"center\":\r\n            style.marginTop = style.marginTop ? style.marginTop : \"auto\";\r\n            style.marginBottom = style.marginBottom\r\n              ? style.marginBottom\r\n              : \"auto\";\r\n            break;\r\n          case \"bottom\":\r\n            style.marginTop = style.marginTop ? style.marginTop : \"auto\";\r\n            break;\r\n        }\r\n      } else if (position === \"relative\" && parentFlexDirection === \"row\") {\r\n        switch (alignY) {\r\n          case \"top\":\r\n            style.alignSelf = \"flex-start\";\r\n            break;\r\n          case \"center\":\r\n            style.alignSelf = \"center\";\r\n            break;\r\n          case \"bottom\":\r\n            style.alignSelf = \"flex-end\";\r\n            break;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (transform) {\r\n      style.transform = transform + (style.transform || \"\");\r\n    }\r\n  },\r\n};\r\n","function isObject(item: any): item is Record<string, any> {\r\n  return item && typeof item === \"object\" && !Array.isArray(item);\r\n}\r\n\r\nexport default function mergeDeep(\r\n  target: Record<string, any>,\r\n  ...sources: Array<Record<string, any>>\r\n): Record<string, any> {\r\n  if (!sources.length) return target;\r\n  const source = sources.shift();\r\n\r\n  if (isObject(target) && isObject(source)) {\r\n    for (const key in source) {\r\n      if (isObject(source[key])) {\r\n        if (!target[key]) Object.assign(target, { [key]: {} });\r\n        mergeDeep(target[key], source[key]);\r\n      } else {\r\n        Object.assign(target, { [key]: source[key] });\r\n      }\r\n    }\r\n  }\r\n\r\n  return mergeDeep(target, ...sources);\r\n}\r\n","import { getAbsoluteUrl } from \"@fluxscape/runtime\";\r\n\r\nexport class FontLoader {\r\n  static instance = new FontLoader();\r\n\r\n  loadedFontFamilies: { [key: string]: boolean };\r\n  fontCssFamiliesAdded: { [key: string]: boolean };\r\n  fontCallbacks: { [key: string]: Function[] };\r\n\r\n  constructor() {\r\n    this.loadedFontFamilies = {};\r\n    this.fontCssFamiliesAdded = {};\r\n    this.fontCallbacks = {};\r\n\r\n    const defaultFonts = [\r\n      \"Arial\",\r\n      \"Arial Black\",\r\n      \"Courier New\",\r\n      \"Helvetica\",\r\n      \"Impact\",\r\n      \"Lucida Console\",\r\n      \"Tahoma\",\r\n      \"Times New Roman\",\r\n    ];\r\n\r\n    defaultFonts.forEach((fontFamily) => {\r\n      this.loadedFontFamilies[fontFamily] = true;\r\n    });\r\n  }\r\n\r\n  private removeFileEnding(url: string): string {\r\n    return url.replace(/\\.[^/.]+$/, \"\");\r\n  }\r\n\r\n  loadFont(fontURL: string): void {\r\n    // Support SSR\r\n    if (typeof document === \"undefined\") return;\r\n\r\n    fontURL = getAbsoluteUrl(fontURL);\r\n\r\n    // get file name without path and file ending\r\n    const family = this.removeFileEnding(fontURL).split(\"/\").pop()!;\r\n\r\n    // check if it's already loaded\r\n    if (this.loadedFontFamilies[family]) {\r\n      this.fontCallbacks[family]?.forEach((callback) => {\r\n        callback();\r\n      });\r\n      return;\r\n    }\r\n\r\n    // check if font is already being loaded, we're just waiting for the callback\r\n    if (this.fontCssFamiliesAdded[family]) {\r\n      return;\r\n    }\r\n\r\n    this.fontCssFamiliesAdded[family] = true;\r\n\r\n    const newStyle = document.createElement(\"style\");\r\n    newStyle.type = \"text/css\";\r\n\r\n    // @ts-expect-error\r\n    const baseUrl = Noodl.Env[\"BaseUrl\"] || \"/\";\r\n\r\n    if (fontURL.startsWith(\"/\")) {\r\n      fontURL = fontURL.substring(1);\r\n    }\r\n\r\n    newStyle.appendChild(\r\n      document.createTextNode(\r\n        `@font-face { font-family: '${family}'; src: url('${baseUrl}${fontURL}'); }\\n`\r\n      )\r\n    );\r\n    document.head.appendChild(newStyle);\r\n\r\n    // Support SSR\r\n    if (typeof window !== \"undefined\") {\r\n      const WebFontLoader = require(\"webfontloader\");\r\n      WebFontLoader.load({\r\n        timeout: 1000 * 600, // 10 minutes in case the bandwidth is reeeeeeally low\r\n        custom: {\r\n          families: [family],\r\n        },\r\n        fontactive: (loadedFamily) => {\r\n          this.loadedFontFamilies[loadedFamily] = true;\r\n          this.fontCallbacks[loadedFamily]?.forEach((callback) => {\r\n            callback();\r\n          });\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  callWhenFontIsActive(family: string, callback: Function): void {\r\n    if (this.loadedFontFamilies[family]) {\r\n      callback();\r\n      return;\r\n    }\r\n\r\n    if (!this.fontCallbacks[family]) {\r\n      this.fontCallbacks[family] = [];\r\n    }\r\n    this.fontCallbacks[family].push(callback);\r\n  }\r\n}\r\n","export function createTooltip({\r\n  title,\r\n  body,\r\n  images,\r\n}: {\r\n  title: string;\r\n  body?: string | string[];\r\n  images?: { src: string; label?: string; body?: string }[];\r\n}): string {\r\n  let html = `<h3>${title}</h3>`;\r\n  if (body) {\r\n    body = Array.isArray(body) ? body : [body];\r\n\r\n    html += body.map((text) => `<p>${text}</p>`).join(\"\");\r\n  }\r\n\r\n  if (images) {\r\n    let imgHtml = \"\";\r\n\r\n    images.forEach((e) => {\r\n      imgHtml += `<div class=\"popup-layer-image-item\">`;\r\n      imgHtml += `<img src=\"../assets/images/tooltips/${e.src}\">`;\r\n      if (e.label) {\r\n        imgHtml += `<h3>${e.label}</h3>`;\r\n      }\r\n      if (e.body) {\r\n        imgHtml += `<p>${e.body}</p>`;\r\n      }\r\n      imgHtml += `</div>`;\r\n    });\r\n\r\n    html += `<div class=\"popup-layer-image-row\">${imgHtml}</div>`;\r\n  }\r\n\r\n  return html;\r\n}\r\n","import { getAbsoluteUrl } from \"@fluxscape/runtime\";\r\n\r\nimport { FontLoader } from \"./fontloader\";\r\nimport { createTooltip } from \"./tooltips\";\r\n\r\nfunction addInputCss(definition, inputs) {\r\n  if (!definition.inputCss) {\r\n    definition.inputCss = {};\r\n  }\r\n\r\n  if (!definition.defaultCss) {\r\n    definition.defaultCss = {};\r\n  }\r\n\r\n  for (const name in inputs) {\r\n    definition.inputCss[name] = inputs[name];\r\n  }\r\n}\r\n\r\nfunction mergeAttribute(definition, attribute, values) {\r\n  if (!definition[attribute]) {\r\n    definition[attribute] = {};\r\n  }\r\n\r\n  for (const name in values) {\r\n    definition[attribute][name] = values[name];\r\n  }\r\n}\r\n\r\nfunction addInputs(definition, values) {\r\n  mergeAttribute(definition, \"inputs\", values);\r\n}\r\n\r\nfunction addInputProps(definition, values) {\r\n  mergeAttribute(definition, \"inputProps\", values);\r\n}\r\n\r\nfunction addDynamicInputPorts(definition, condition, inputs) {\r\n  if (!definition.dynamicports) {\r\n    definition.dynamicports = [];\r\n  }\r\n\r\n  definition.dynamicports.push({ condition, inputs });\r\n}\r\n\r\nfunction addOutputProps(definition, values) {\r\n  mergeAttribute(definition, \"outputProps\", values);\r\n}\r\n\r\nexport default {\r\n  addInputProps,\r\n  addInputs,\r\n  addDynamicInputPorts,\r\n  addInputCss,\r\n  addSharedVisualInputs(definition) {\r\n    addInputCss(definition, {\r\n      opacity: {\r\n        index: 200,\r\n        group: \"Style\",\r\n        displayName: \"Opacity\",\r\n        type: \"number\",\r\n        default: 1,\r\n        allowVisualStates: true,\r\n      },\r\n      mixBlendMode: {\r\n        index: 201,\r\n        group: \"Style\",\r\n        displayName: \"Blend Mode\",\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"Normal\", value: \"normal\" },\r\n            { label: \"Multiply\", value: \"multiply\" },\r\n            { label: \"Screen\", value: \"screen\" },\r\n            { label: \"Overlay\", value: \"overlay\" },\r\n            { label: \"Darken\", value: \"darken\" },\r\n            { label: \"Lighten\", value: \"lighten\" },\r\n            { label: \"Color Dodge\", value: \"color-dodge\" },\r\n            { label: \"Color Burn\", value: \"color-burn\" },\r\n            { label: \"Hard Light\", value: \"hard-light\" },\r\n            { label: \"Soft Light\", value: \"soft-light\" },\r\n            { label: \"Difference\", value: \"difference\" },\r\n            { label: \"Exclusion\", value: \"exclusion\" },\r\n            { label: \"Hue\", value: \"hue\" },\r\n            { label: \"Saturation\", value: \"saturation\" },\r\n            { label: \"Color\", value: \"color\" },\r\n            { label: \"Luminosity\", value: \"luminosity\" },\r\n          ],\r\n        },\r\n        default: \"normal\",\r\n        applyDefault: false,\r\n        allowVisualStates: true,\r\n      },\r\n    });\r\n\r\n    addInputs(definition, {\r\n      visible: {\r\n        index: 210,\r\n        displayName: \"Visible\",\r\n        group: \"Style\",\r\n        default: true,\r\n        type: \"boolean\",\r\n        set(value) {\r\n          if (value) {\r\n            this.removeStyle([\"visibility\"]);\r\n          } else {\r\n            this.setStyle({ visibility: \"hidden\" });\r\n          }\r\n        },\r\n      },\r\n      zIndex: {\r\n        index: 211,\r\n        displayName: \"zIndex\",\r\n        group: \"Style\",\r\n        type: \"number\",\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          if (value === undefined) {\r\n            this.removeStyle([\"zIndex\"]);\r\n          } else {\r\n            this.setStyle({ zIndex: Number(value) });\r\n          }\r\n        },\r\n      },\r\n    });\r\n  },\r\n  addMarginInputs(definition) {\r\n    addInputCss(definition, {\r\n      marginLeft: {\r\n        index: 1,\r\n        group: \"Margin and padding\",\r\n        displayName: \"Margin Left\",\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\", \"%\"],\r\n          defaultUnit: \"px\",\r\n          marginPaddingComp: \"margin-left\",\r\n        },\r\n        allowVisualStates: true,\r\n      },\r\n      marginRight: {\r\n        index: 2,\r\n        group: \"Margin and padding\",\r\n        displayName: \"Margin Right\",\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\", \"%\"],\r\n          defaultUnit: \"px\",\r\n          marginPaddingComp: \"margin-right\",\r\n        },\r\n        allowVisualStates: true,\r\n      },\r\n      marginTop: {\r\n        index: 3,\r\n        group: \"Margin and padding\",\r\n        displayName: \"Margin Top\",\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\", \"%\"],\r\n          defaultUnit: \"px\",\r\n          marginPaddingComp: \"margin-top\",\r\n        },\r\n        allowVisualStates: true,\r\n      },\r\n      marginBottom: {\r\n        index: 4,\r\n        group: \"Margin and padding\",\r\n        displayName: \"Margin Bottom\",\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\", \"%\"],\r\n          defaultUnit: \"px\",\r\n          marginPaddingComp: \"margin-bottom\",\r\n        },\r\n        allowVisualStates: true,\r\n      },\r\n    });\r\n  },\r\n  addPaddingInputs(definition, args) {\r\n    args = args || {};\r\n    const defaults = args.defaults ? args.defaults : {};\r\n\r\n    const styleTag = args.styleTag;\r\n\r\n    addInputCss(definition, {\r\n      paddingLeft: {\r\n        index: 64,\r\n        group: \"Margin and padding\",\r\n        default: defaults.paddingLeft || 0,\r\n        applyDefault: false,\r\n        displayName: \"Pad Left\",\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n          marginPaddingComp: \"padding-left\",\r\n        },\r\n        allowVisualStates: true,\r\n        styleTag,\r\n      },\r\n      paddingRight: {\r\n        index: 65,\r\n        group: \"Margin and padding\",\r\n        default: defaults.paddingRight || 0,\r\n        applyDefault: false,\r\n        displayName: \"Pad Right\",\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n          marginPaddingComp: \"padding-right\",\r\n        },\r\n        allowVisualStates: true,\r\n        styleTag,\r\n      },\r\n      paddingTop: {\r\n        index: 66,\r\n        group: \"Margin and padding\",\r\n        displayName: \"Pad Top\",\r\n        default: defaults.paddingTop || 0,\r\n        applyDefault: false,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n          marginPaddingComp: \"padding-top\",\r\n        },\r\n        allowVisualStates: true,\r\n        styleTag,\r\n      },\r\n      paddingBottom: {\r\n        index: 67,\r\n        group: \"Margin and padding\",\r\n        displayName: \"Pad Bottom\",\r\n        default: defaults.paddingBottom || 0,\r\n        applyDefault: false,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n          marginPaddingComp: \"padding-bottom\",\r\n        },\r\n        allowVisualStates: true,\r\n        styleTag,\r\n      },\r\n    });\r\n  },\r\n  addTransformInputs(definition) {\r\n    addInputs(definition, {\r\n      transformX: {\r\n        group: \"Placement\",\r\n        displayName: \"Pos X\",\r\n        default: 0,\r\n        index: 300,\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\", \"%\"],\r\n          defaultUnit: \"px\",\r\n        },\r\n        set(value) {\r\n          if (!this.transforms) this.transforms = {};\r\n          this.transforms.x = value.value + value.unit;\r\n          this.updateTransform();\r\n        },\r\n      },\r\n      transformY: {\r\n        group: \"Placement\",\r\n        displayName: \"Pos Y\",\r\n        default: 0,\r\n        index: 301,\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\", \"%\"],\r\n          defaultUnit: \"px\",\r\n        },\r\n        set(value) {\r\n          if (!this.transforms) this.transforms = {};\r\n          this.transforms.y = value.value + value.unit;\r\n          this.updateTransform();\r\n        },\r\n      },\r\n      transformRotation: {\r\n        index: 302,\r\n        group: \"Placement\",\r\n        displayName: \"Rotation\",\r\n        default: 0,\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"deg\"],\r\n          defaultUnit: \"deg\",\r\n        },\r\n        set(value) {\r\n          if (!this.transforms) this.transforms = {};\r\n          this.transforms.rotation = value.value + value.unit;\r\n          this.updateTransform();\r\n        },\r\n      },\r\n      transformScale: {\r\n        index: 303,\r\n        group: \"Placement\",\r\n        displayName: \"Scale\",\r\n        default: 1,\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: \"number\",\r\n        },\r\n        set(value) {\r\n          if (!this.transforms) this.transforms = {};\r\n          this.transforms.scale = value;\r\n          this.updateTransform();\r\n        },\r\n      },\r\n      transformOriginX: {\r\n        index: 304,\r\n        group: \"Placement\",\r\n        displayName: \"Transform Origin X\",\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\", \"%\"],\r\n          defaultUnit: \"%\",\r\n        },\r\n        default: \"50\",\r\n        set(value) {\r\n          this.transformOriginX = value.value + value.unit;\r\n          this.updateTransformOrigin();\r\n        },\r\n      },\r\n      transformOriginY: {\r\n        index: 305,\r\n        group: \"Placement\",\r\n        displayName: \"Transform Origin Y\",\r\n        allowVisualStates: true,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\", \"%\"],\r\n          defaultUnit: \"%\",\r\n        },\r\n        default: \"50\",\r\n        set(value) {\r\n          this.transformOriginY = value.value + value.unit;\r\n          this.updateTransformOrigin();\r\n        },\r\n      },\r\n    });\r\n\r\n    if (!definition.methods) definition.methods = {};\r\n\r\n    definition.methods.updateTransform = function () {\r\n      let transform = \"\";\r\n\r\n      const { x, y, rotation, scale } = this.transforms;\r\n\r\n      if (x) transform += `translateX(${x}) `;\r\n      if (y) transform += `translateY(${y}) `;\r\n      if (rotation) transform += `rotate(${rotation}) `;\r\n      if (scale !== undefined) transform += `scale(${scale},${scale})`;\r\n\r\n      this.setStyle({ transform });\r\n    };\r\n\r\n    definition.methods.updateTransformOrigin = function () {\r\n      const x =\r\n        this.transformOriginX !== undefined ? this.transformOriginX : \"50%\";\r\n      const y =\r\n        this.transformOriginY !== undefined ? this.transformOriginY : \"50%\";\r\n\r\n      this.setStyle({\r\n        transformOrigin: `${x} ${y}`,\r\n      });\r\n    };\r\n  },\r\n  addAlignInputs(definition) {\r\n    const positions = [\r\n      { label: \"In Layout\", value: \"relative\" },\r\n      { label: \"Absolute\", value: \"absolute\" },\r\n      { label: \"Sticky\", value: \"sticky\" },\r\n      { label: \"Fixed\", value: \"fixed\" },\r\n    ];\r\n\r\n    addInputCss(definition, {\r\n      position: {\r\n        index: 11,\r\n        displayName: \"Position\",\r\n        group: \"Layout\",\r\n        type: {\r\n          name: \"enum\",\r\n          enums: positions,\r\n        },\r\n        default: \"relative\",\r\n      },\r\n    });\r\n\r\n    addInputProps(definition, {\r\n      alignX: {\r\n        index: 5,\r\n        group: \"Alignment\",\r\n        displayName: \"Align X\",\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"Left\", value: \"left\" },\r\n            { label: \"Center\", value: \"center\" },\r\n            { label: \"Right\", value: \"right\" },\r\n          ],\r\n          alignComp: \"horizontal\",\r\n        },\r\n      },\r\n      alignY: {\r\n        index: 6,\r\n        group: \"Alignment\",\r\n        displayName: \"Align Y\",\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"Top\", value: \"top\" },\r\n            { label: \"Center\", value: \"center\" },\r\n            { label: \"Bottom\", value: \"bottom\" },\r\n          ],\r\n          alignComp: \"vertical\",\r\n        },\r\n      },\r\n    });\r\n\r\n    addPositionAndAlignTooltips(definition);\r\n  },\r\n  addPointerEventOutputs(definition) {\r\n    addInputs(definition, {\r\n      pointerEventsMode: {\r\n        index: 403,\r\n        displayName: \"Pointer Events Mode\",\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"Inherit\", value: \"inherit\" },\r\n            { label: \"Explicit\", value: \"explicit\" },\r\n          ],\r\n        },\r\n        default: \"inherit\",\r\n        group: \"Pointer Events\",\r\n        set(value) {\r\n          if (value === \"inherit\") {\r\n            this.removeStyle([\"pointerEvents\"]);\r\n          } else {\r\n            let pointerEvents = \"auto\"; //default to auto\r\n            if (this._internal.pointerEventsEnabled !== undefined) {\r\n              pointerEvents = this._internal.pointerEventsEnabled\r\n                ? \"auto\"\r\n                : \"none\";\r\n            }\r\n            this.setStyle({ pointerEvents });\r\n          }\r\n        },\r\n      },\r\n      pointerEventsEnabled: {\r\n        index: 404,\r\n        displayName: \"Pointer Events Enabled\",\r\n        type: \"boolean\",\r\n        group: \"Pointer Events\",\r\n        default: true,\r\n        set(value) {\r\n          this._internal.pointerEventsEnabled = value ? true : false;\r\n          this.setStyle({\r\n            pointerEvents: this._internal.pointerEventsEnabled\r\n              ? \"auto\"\r\n              : \"none\",\r\n          });\r\n        },\r\n      },\r\n    });\r\n\r\n    addInputProps(definition, {\r\n      blockTouch: {\r\n        index: 450,\r\n        displayName: \"Block Pointer Events\",\r\n        group: \"Pointer Events\",\r\n        type: \"boolean\",\r\n      },\r\n    });\r\n\r\n    addDynamicInputPorts(definition, \"pointerEventsMode = explicit\", [\r\n      \"pointerEventsEnabled\",\r\n    ]);\r\n\r\n    addOutputProps(definition, {\r\n      onClick: {\r\n        displayName: \"Click\",\r\n        group: \"Events\",\r\n        type: \"signal\",\r\n        propPath: \"pointer\",\r\n      },\r\n      pointerDown: {\r\n        displayName: \"Pointer Down\",\r\n        group: \"Pointer Events\",\r\n        type: \"signal\",\r\n        propPath: \"pointer\",\r\n        props: {\r\n          onMouseDown() {\r\n            this.sendSignalOnOutput(\"pointerDown\");\r\n          },\r\n          onTouchStart() {\r\n            this.sendSignalOnOutput(\"pointerDown\");\r\n          },\r\n        },\r\n      },\r\n      pointerUp: {\r\n        displayName: \"Pointer Up\",\r\n        group: \"Pointer Events\",\r\n        type: \"signal\",\r\n        propPath: \"pointer\",\r\n        props: {\r\n          onMouseUp() {\r\n            this.sendSignalOnOutput(\"pointerUp\");\r\n          },\r\n          onTouchEnd() {\r\n            this.sendSignalOnOutput(\"pointerUp\");\r\n          },\r\n          onTouchCancel() {\r\n            this.sendSignalOnOutput(\"pointerUp\");\r\n          },\r\n        },\r\n      },\r\n      pointerEnter: {\r\n        displayName: \"Pointer Enter\",\r\n        group: \"Pointer Events\",\r\n        type: \"signal\",\r\n        propPath: \"pointer\",\r\n        props: {\r\n          onMouseEnter() {\r\n            this.sendSignalOnOutput(\"pointerEnter\");\r\n          },\r\n        },\r\n      },\r\n      hoverStart: {\r\n        displayName: \"Hover Start\",\r\n        group: \"Hover Events\",\r\n        type: \"signal\",\r\n        propPath: \"pointer\",\r\n        props: {\r\n          onMouseOver() {\r\n            this.sendSignalOnOutput(\"hoverStart\");\r\n            this.setVisualStates([\"hover\"]);\r\n          },\r\n        },\r\n      },\r\n      hoverEnd: {\r\n        displayName: \"Hover End\",\r\n        group: \"Hover Events\",\r\n        type: \"signal\",\r\n        propPath: \"pointer\",\r\n        props: {\r\n          onMouseLeave() {\r\n            this.sendSignalOnOutput(\"hoverEnd\");\r\n            this.setVisualStates([\"\"]);\r\n          },\r\n        },\r\n      },\r\n    });\r\n\r\n    addPointerEventsTooltips(definition);\r\n  },\r\n  addDimensions(\r\n    definition,\r\n    {\r\n      defaultSizeMode = \"explicit\",\r\n      contentLabel = \"Content\",\r\n      useDimensionConstraints = true,\r\n    } = {}\r\n  ) {\r\n    let widthCondition = \"sizeMode = explicit OR sizeMode = contentHeight\";\r\n    let heightCondition = \"sizeMode = explicit OR sizeMode = contentWidth\";\r\n\r\n    if (defaultSizeMode === \"explicit\" || defaultSizeMode === \"contentHeight\") {\r\n      widthCondition += \" OR sizeMode NOT SET\";\r\n    }\r\n\r\n    if (defaultSizeMode === \"explicit\" || defaultSizeMode === \"contentWidth\") {\r\n      heightCondition += \" OR sizeMode NOT SET\";\r\n    }\r\n\r\n    addDynamicInputPorts(definition, widthCondition, [\"width\"]);\r\n    addDynamicInputPorts(definition, heightCondition, [\"height\"]);\r\n\r\n    addInputProps(definition, {\r\n      sizeMode: {\r\n        index: 10,\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { value: \"explicit\", label: \"Explicit\" },\r\n            { value: \"contentWidth\", label: \"Content Width\" },\r\n            { value: \"contentHeight\", label: \"Content Height\" },\r\n            { value: \"contentSize\", label: \"Content Size\" },\r\n          ],\r\n          allowEditOnly: true,\r\n          sizeComp: \"mode\",\r\n        },\r\n        group: \"Dimensions\",\r\n        displayName: \"Size Mode\",\r\n        default: defaultSizeMode,\r\n        allowVisualStates: true,\r\n      },\r\n      width: {\r\n        index: 11,\r\n        group: \"Dimensions\",\r\n        displayName: \"Width\",\r\n        type: {\r\n          name: \"dimension\",\r\n          units: [\"%\", \"px\", \"vw\", \"vh\"],\r\n          defaultUnit: \"%\",\r\n        },\r\n        default: 100,\r\n        allowVisualStates: true,\r\n        onChange(value) {\r\n          this.props.fixedWidth = value.isFixed;\r\n        },\r\n      },\r\n      height: {\r\n        index: 13,\r\n        group: \"Dimensions\",\r\n        displayName: \"Height\",\r\n        type: {\r\n          name: \"dimension\",\r\n          units: [\"%\", \"px\", \"vw\", \"vh\"],\r\n          defaultUnit: \"%\",\r\n        },\r\n        default: 100,\r\n        allowVisualStates: true,\r\n        onChange(value) {\r\n          this.props.fixedHeight = value.isFixed;\r\n        },\r\n      },\r\n    });\r\n\r\n    if (!Noodl.deployed) {\r\n      addDimensionTooltips(definition, contentLabel);\r\n    }\r\n\r\n    if (useDimensionConstraints) {\r\n      addInputCss(definition, {\r\n        minWidth: {\r\n          index: 400,\r\n          group: \"Dimension Constraints\",\r\n          displayName: \"Min Width\",\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: \"number\",\r\n            units: [\"%\", \"px\", \"vw\", \"vh\"],\r\n            defaultUnit: \"%\",\r\n          },\r\n        },\r\n        maxWidth: {\r\n          index: 401,\r\n          group: \"Dimension Constraints\",\r\n          displayName: \"Max Width\",\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: \"number\",\r\n            units: [\"%\", \"px\", \"vw\", \"vh\"],\r\n            defaultUnit: \"%\",\r\n          },\r\n        },\r\n        minHeight: {\r\n          index: 402,\r\n          group: \"Dimension Constraints\",\r\n          displayName: \"Min Height\",\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: \"number\",\r\n            units: [\"%\", \"px\", \"vw\", \"vh\"],\r\n            defaultUnit: \"%\",\r\n          },\r\n        },\r\n        maxHeight: {\r\n          index: 403,\r\n          group: \"Dimension Constraints\",\r\n          displayName: \"Max Height\",\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: \"number\",\r\n            units: [\"%\", \"px\", \"vw\", \"vh\"],\r\n            defaultUnit: \"%\",\r\n          },\r\n        },\r\n      });\r\n\r\n      if (!Noodl.deployed) {\r\n        addDimensionConstraintsTooltips(definition);\r\n      }\r\n    }\r\n  },\r\n  _addCornerRadius(definition, opts) {\r\n    opts = opts || {};\r\n    const defaults = opts.defaults || {};\r\n    const styleTag = opts.styleTag;\r\n\r\n    if (!defaults.borderRadius) defaults.borderRadius = 0;\r\n\r\n    function defineCornerTab(definition, suffix, tabName, indexOffset) {\r\n      const nameWithTab = (name) =>\r\n        `${name} ${suffix ? \"(\" + suffix + \")\" : \"\"}`;\r\n\r\n      const tab = { group: \"corners\", tab: tabName, label: suffix };\r\n      const radiusName = `border${suffix}Radius`;\r\n      addInputs(definition, {\r\n        [radiusName]: {\r\n          index: 240 + indexOffset,\r\n          displayName: \"Corner Radius\",\r\n          editorName: nameWithTab(\"Corner Radius\"),\r\n          group: \"Corner Radius\",\r\n          type: {\r\n            name: \"number\",\r\n            units: [\"px\", \"%\"],\r\n            defaultUnit: \"px\",\r\n          },\r\n          allowVisualStates: true,\r\n          default: defaults[radiusName],\r\n          tab,\r\n          set(value) {\r\n            this._internal.borderRadius[radiusName] =\r\n              value.value === undefined\r\n                ? Number(value) + \"px\"\r\n                : value.value + value.unit;\r\n\r\n            this._updateCornerRadii();\r\n          },\r\n        },\r\n      });\r\n    }\r\n\r\n    defineCornerTab(definition, \"\", \"corners-all\", 0);\r\n    defineCornerTab(definition, \"TopLeft\", \"corners-top-left\", 1);\r\n    defineCornerTab(definition, \"TopRight\", \"corners-top-right\", 2);\r\n    defineCornerTab(definition, \"BottomRight\", \"corners-bottom-right\", 3);\r\n    defineCornerTab(definition, \"BottomLeft\", \"corners-bottom-left\", 4);\r\n\r\n    definition.methods._updateCornerRadii = function () {\r\n      const b = this._internal.borderRadius;\r\n\r\n      function setCorner(style, corner) {\r\n        const r = `border${corner}Radius`;\r\n        style[r] = b[r] || b.borderRadius;\r\n      }\r\n\r\n      const style = {};\r\n      setCorner(style, \"TopLeft\");\r\n      setCorner(style, \"TopRight\");\r\n      setCorner(style, \"BottomRight\");\r\n      setCorner(style, \"BottomLeft\");\r\n\r\n      this.setStyle(style, styleTag);\r\n    };\r\n\r\n    const oldInit = definition.initialize;\r\n    definition.initialize = function () {\r\n      oldInit && oldInit.call(this);\r\n      this._internal.borderRadius = { ...defaults };\r\n      if (defaults.borderRadius) this._updateCornerRadii();\r\n    };\r\n  },\r\n  addBorderInputs(definition, opts) {\r\n    opts = opts || {};\r\n    const defaults = opts.defaults || {};\r\n    const styleTag = opts.styleTag;\r\n\r\n    if (defaults.borderStyle === undefined) defaults.borderStyle = \"none\";\r\n    if (defaults.borderWidth === undefined) defaults.borderWidth = 2;\r\n    if (defaults.borderColor === undefined) defaults.borderColor = \"#000000\";\r\n\r\n    function defineBorderTab(definition, suffix, tabName, indexOffset) {\r\n      const styleName = `border${suffix}Style`;\r\n      const widthName = `border${suffix}Width`;\r\n      const colorName = `border${suffix}Color`;\r\n\r\n      let orNotSet =\r\n        defaults.borderStyle !== \"none\" ? \"OR borderStyle NOT SET\" : \"\";\r\n\r\n      if (suffix) {\r\n        if (defaults[styleName] && defaults[styleName] !== \"none\")\r\n          orNotSet += `OR ${styleName} NOT SET`;\r\n        addDynamicInputPorts(\r\n          definition,\r\n          `${styleName} = solid OR ${styleName} = dashed OR ${styleName} = dotted OR borderStyle = solid OR borderStyle = dashed OR borderStyle = dotted ${orNotSet}`,\r\n          [`${widthName}`, `${colorName}`]\r\n        );\r\n      } else {\r\n        addDynamicInputPorts(\r\n          definition,\r\n          `${styleName} = solid OR ${styleName} = dashed OR ${styleName} = dotted ${orNotSet}`,\r\n          [`${widthName}`, `${colorName}`]\r\n        );\r\n      }\r\n\r\n      const tab = { group: \"border-styles\", tab: tabName, label: suffix };\r\n\r\n      const nameWithTab = (name) =>\r\n        `${name} ${suffix ? \"(\" + suffix + \")\" : \"\"}`;\r\n      const index = 202 + indexOffset * 4;\r\n\r\n      addInputs(definition, {\r\n        [styleName]: {\r\n          index: index + 1,\r\n          displayName: \"Border Style\",\r\n          editorName: nameWithTab(\"Border Style\"),\r\n          group: \"Border Style\",\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: \"enum\",\r\n            enums: [\r\n              { label: \"None\", value: \"none\" },\r\n              { label: \"Solid\", value: \"solid\" },\r\n              { label: \"Dotted\", value: \"dotted\" },\r\n              { label: \"Dashed\", value: \"dashed\" },\r\n            ],\r\n          },\r\n          default: defaults[styleName],\r\n          tab,\r\n          set(value) {\r\n            this._internal.borders[styleName] = value;\r\n            this._updateBorders();\r\n          },\r\n        },\r\n        [widthName]: {\r\n          index: index + 2,\r\n          displayName: \"Border Width\",\r\n          editorName: nameWithTab(\"Border Width\"),\r\n          group: \"Border Style\",\r\n          allowVisualStates: true,\r\n          type: {\r\n            name: \"number\",\r\n            units: [\"px\"],\r\n            defaultUnit: \"px\",\r\n          },\r\n          default: defaults[widthName],\r\n          tab,\r\n          set(value) {\r\n            this._internal.borders[widthName] =\r\n              value.value === undefined\r\n                ? Number(value) + \"px\"\r\n                : value.value + value.unit;\r\n            this._updateBorders();\r\n          },\r\n        },\r\n        [colorName]: {\r\n          index: index + 3,\r\n          displayName: \"Border Color\",\r\n          editorName: nameWithTab(\"Border Color\"),\r\n          group: \"Border Style\",\r\n          type: \"color\",\r\n          default: defaults[colorName],\r\n          allowVisualStates: true,\r\n          tab,\r\n          set(value) {\r\n            this._internal.borders[colorName] = value;\r\n            this._updateBorders();\r\n          },\r\n        },\r\n      });\r\n    }\r\n\r\n    defineBorderTab(definition, \"\", \"borders-all\", 0);\r\n    defineBorderTab(definition, \"Left\", \"borders-left\", 1);\r\n    defineBorderTab(definition, \"Top\", \"borders-top\", 2);\r\n    defineBorderTab(definition, \"Right\", \"borders-right\", 3);\r\n    defineBorderTab(definition, \"Bottom\", \"borders-bottom\", 4);\r\n\r\n    definition.methods._updateBorders = function () {\r\n      const b = this._internal.borders;\r\n\r\n      function setBorder(style, group) {\r\n        const width = `border${group}Width`;\r\n        const color = `border${group}Color`;\r\n        const borderStyle = `border${group}Style`;\r\n\r\n        style[width] = b[width] || b.borderWidth;\r\n        style[color] = b[color] || b.borderColor;\r\n        style[borderStyle] = b[borderStyle] || b.borderStyle;\r\n      }\r\n\r\n      const style = {};\r\n      setBorder(style, \"Top\");\r\n      setBorder(style, \"Right\");\r\n      setBorder(style, \"Bottom\");\r\n      setBorder(style, \"Left\");\r\n\r\n      this.setStyle(style, styleTag);\r\n    };\r\n\r\n    const oldInit = definition.initialize;\r\n    definition.initialize = function () {\r\n      oldInit && oldInit.call(this);\r\n      this._internal.borders = { ...defaults };\r\n\r\n      const hasDefaultBorders =\r\n        defaults.borderStyle !== \"none\" ||\r\n        (defaults.borderTopStyle && defaults.borderTopStyle !== \"none\") ||\r\n        (defaults.borderRightStyle && defaults.borderRightStyle !== \"none\") ||\r\n        (defaults.borderBottomStyle && defaults.borderBottomStyle !== \"none\") ||\r\n        (defaults.borderRightStyle && defaults.borderRightStyle !== \"none\");\r\n\r\n      if (hasDefaultBorders) this._updateBorders();\r\n    };\r\n\r\n    this._addCornerRadius(definition, { defaults, styleTag });\r\n  },\r\n  addShadowInputs(definition, args) {\r\n    args = args || {};\r\n    const styleTag = args.styleTag;\r\n\r\n    addDynamicInputPorts(definition, \"boxShadowEnabled = true\", [\r\n      \"boxShadowOffsetX\",\r\n      \"boxShadowOffsetY\",\r\n      \"boxShadowInset\",\r\n      \"boxShadowBlurRadius\",\r\n      \"boxShadowSpreadRadius\",\r\n      \"boxShadowColor\",\r\n    ]);\r\n\r\n    addInputs(definition, {\r\n      boxShadowEnabled: {\r\n        index: 250,\r\n        group: \"Box Shadow\",\r\n        displayName: \"Shadow Enabled\",\r\n        type: \"boolean\",\r\n        default: false,\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowEnabled = value;\r\n          this._updateBoxShadow();\r\n        },\r\n      },\r\n      boxShadowOffsetX: {\r\n        index: 251,\r\n        group: \"Box Shadow\",\r\n        displayName: \"Offset X\",\r\n        default: 0,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n        },\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowOffsetX = value.value + value.unit;\r\n          this._updateBoxShadow();\r\n        },\r\n      },\r\n      boxShadowOffsetY: {\r\n        index: 252,\r\n        group: \"Box Shadow\",\r\n        displayName: \"Offset Y\",\r\n        default: 0,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n        },\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowOffsetY = value.value + value.unit;\r\n          this._updateBoxShadow();\r\n        },\r\n      },\r\n      boxShadowBlurRadius: {\r\n        index: 253,\r\n        group: \"Box Shadow\",\r\n        displayName: \"Blur Radius\",\r\n        default: 5,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n        },\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowBlurRadius = value.value + value.unit;\r\n          this._updateBoxShadow();\r\n        },\r\n      },\r\n      boxShadowSpreadRadius: {\r\n        index: 254,\r\n        group: \"Box Shadow\",\r\n        displayName: \"Spread Radius\",\r\n        default: 2,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n        },\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowSpreadRadius = value.value + value.unit;\r\n          this._updateBoxShadow();\r\n        },\r\n      },\r\n      boxShadowInset: {\r\n        index: 255,\r\n        group: \"Box Shadow\",\r\n        displayName: \"Inset\",\r\n        type: \"boolean\",\r\n        default: false,\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowInset = value;\r\n          this._updateBoxShadow();\r\n        },\r\n      },\r\n      boxShadowColor: {\r\n        index: 256,\r\n        group: \"Box Shadow\",\r\n        displayName: \"Shadow Color\",\r\n        type: \"color\",\r\n        default: \"#00000033\",\r\n        allowVisualStates: true,\r\n        set(value) {\r\n          this._internal.boxShadowColor = value;\r\n          this._updateBoxShadow();\r\n        },\r\n      },\r\n    });\r\n\r\n    definition.methods._updateBoxShadow = function () {\r\n      const internal = this._internal;\r\n\r\n      if (internal.boxShadowEnabled) {\r\n        this.setStyle(\r\n          {\r\n            boxShadow: `${internal.boxShadowInset ? \"inset \" : \"\"}${\r\n              internal.boxShadowOffsetX\r\n            } ${internal.boxShadowOffsetY} ${internal.boxShadowBlurRadius} ${\r\n              internal.boxShadowSpreadRadius\r\n            } ${internal.boxShadowColor}`,\r\n          },\r\n          styleTag\r\n        );\r\n      } else {\r\n        this.removeStyle([\"boxShadow\"], styleTag);\r\n      }\r\n    };\r\n\r\n    const oldInit = definition.initialize;\r\n    definition.initialize = function () {\r\n      oldInit && oldInit.call(this);\r\n      this._internal.boxShadowOffsetX = 0;\r\n      this._internal.boxShadowOffsetY = 0;\r\n      this._internal.boxShadowBlurRadius = \"5px\";\r\n      this._internal.boxShadowSpreadRadius = \"2px\";\r\n      this._internal.boxShadowColor = \"#00000033\";\r\n    };\r\n  },\r\n  addIconInputs(definition, args) {\r\n    args = args || {};\r\n\r\n    const index = 20;\r\n\r\n    const defaults = {\r\n      useIcon: true,\r\n      iconColor: \"#FFFFFF\",\r\n    };\r\n\r\n    if (args.defaults) {\r\n      Object.assign(defaults, args.defaults);\r\n    }\r\n\r\n    let useIconCondition = \"useIcon = true\";\r\n    if (defaults.useIcon) {\r\n      useIconCondition += \" OR useIcon NOT SET\";\r\n    }\r\n\r\n    const useIconPorts = [\"iconSourceType\", \"iconSize\"];\r\n    if (args.enableIconPlacement) {\r\n      useIconPorts.push(\"iconPlacement\");\r\n      useIconPorts.push(\"iconSpacing\");\r\n    }\r\n\r\n    addDynamicInputPorts(definition, useIconCondition, useIconPorts);\r\n\r\n    if (defaults.useIcon) {\r\n      addDynamicInputPorts(\r\n        definition,\r\n        \"#js (params.useIcon===true || params.useIcon===undefined) && params.iconSourceType === 'image'\",\r\n        [\"iconImageSource\"]\r\n      );\r\n      addDynamicInputPorts(\r\n        definition,\r\n        \"#js (params.useIcon===true || params.useIcon===undefined) && params.iconSourceType === 'icon'\",\r\n        [\"iconIconSource\", \"iconColor\"]\r\n      );\r\n    } else {\r\n      addDynamicInputPorts(\r\n        definition,\r\n        \"useIcon = true AND iconSourceType = image\",\r\n        [\"iconImageSource\"]\r\n      );\r\n      addDynamicInputPorts(\r\n        definition,\r\n        \"useIcon = true AND iconSourceType = icon\",\r\n        [\"iconIconSource\", \"iconColor\"]\r\n      );\r\n    }\r\n\r\n    if (!args.hideEnableIconInput) {\r\n      addInputProps(definition, {\r\n        useIcon: {\r\n          type: \"boolean\",\r\n          group: \"Icon\",\r\n          displayName: \"Enable Icon\",\r\n          default: defaults.useIcon,\r\n          allowVisualStates: true,\r\n          index: index,\r\n        },\r\n      });\r\n    }\r\n\r\n    addInputProps(definition, {\r\n      iconSourceType: {\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"Image\", value: \"image\" },\r\n            { label: \"Icon\", value: \"icon\" },\r\n          ],\r\n        },\r\n        group: \"Icon\",\r\n        displayName: \"Type\",\r\n        default: \"icon\",\r\n        allowVisualStates: true,\r\n        index: index + 1,\r\n      },\r\n      iconIconSource: {\r\n        type: \"icon\",\r\n        displayName: \"Icon Source\",\r\n        group: \"Icon\",\r\n        allowVisualStates: true,\r\n        index: index + 3,\r\n      },\r\n    });\r\n\r\n    addInputs(definition, {\r\n      iconImageSource: {\r\n        type: \"image\",\r\n        displayName: \"Image Source\",\r\n        group: \"Icon\",\r\n        allowVisualStates: true,\r\n        index: index + 2,\r\n        set(iconImageSource) {\r\n          this.props.iconImageSource = getAbsoluteUrl(iconImageSource);\r\n        },\r\n      },\r\n    });\r\n\r\n    if (args.enableIconPlacement) {\r\n      addInputProps(definition, {\r\n        iconSpacing: {\r\n          group: \"Icon\",\r\n          displayName: \"Spacing\",\r\n          default: 10,\r\n          type: {\r\n            name: \"number\",\r\n            units: [\"px\"],\r\n            defaultUnit: \"px\",\r\n          },\r\n          allowVisualStates: true,\r\n          index: index + 4,\r\n        },\r\n        iconPlacement: {\r\n          type: {\r\n            name: \"enum\",\r\n            enums: [\r\n              { label: \"Left\", value: \"left\" },\r\n              { label: \"Right\", value: \"right\" },\r\n            ],\r\n          },\r\n          group: \"Icon\",\r\n          displayName: \"Placement\",\r\n          default: \"left\",\r\n          allowVisualStates: true,\r\n          index: index + 5,\r\n        },\r\n      });\r\n    }\r\n\r\n    addInputProps(definition, {\r\n      iconSize: {\r\n        group: \"Icon\",\r\n        displayName: \"Size\",\r\n        default: 16,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n        },\r\n        allowVisualStates: true,\r\n        index: index + 6,\r\n      },\r\n      iconColor: {\r\n        group: \"Icon\",\r\n        displayName: \"Color\",\r\n        editorName: \"Icon Color\",\r\n        default: defaults.iconColor,\r\n        type: \"color\",\r\n        allowVisualStates: true,\r\n        index: index + 7,\r\n      },\r\n    });\r\n  },\r\n\r\n  addLabelInputs(definition, args) {\r\n    args = args || {};\r\n\r\n    const defaults = {\r\n      useLabel: false,\r\n    };\r\n\r\n    if (args.defaults) {\r\n      Object.assign(defaults, args.defaults);\r\n    }\r\n\r\n    const condition = defaults.useLabel\r\n      ? \"useLabel = true OR useLabel NOT SET\"\r\n      : \"useLabel = true\";\r\n\r\n    const textStylePortPrefix = args.styleTag || \"\";\r\n\r\n    const ports = [\"label\"].concat(\r\n      [\r\n        \"textStyle\",\r\n        \"fontFamily\",\r\n        \"fontSize\",\r\n        \"color\",\r\n        \"letterSpacing\",\r\n        \"lineHeight\",\r\n        \"textTransform\",\r\n      ].map((port) => textStylePortPrefix + port)\r\n    );\r\n    if (args.enableSpacing) {\r\n      ports.push(\"labelSpacing\");\r\n    }\r\n\r\n    addDynamicInputPorts(definition, condition, ports);\r\n\r\n    addInputProps(definition, {\r\n      useLabel: {\r\n        index: 18,\r\n        type: \"boolean\",\r\n        displayName: \"Enable Label\",\r\n        group: \"Label\",\r\n        default: defaults.useLabel,\r\n      },\r\n      label: {\r\n        type: \"string\",\r\n        displayName: \"Label\",\r\n        group: \"Label\",\r\n        default: \"Label\",\r\n      },\r\n    });\r\n\r\n    if (args.enableSpacing) {\r\n      addInputProps(definition, {\r\n        labelSpacing: {\r\n          displayName: \"Spacing\",\r\n          group: \"Label\",\r\n          type: {\r\n            name: \"number\",\r\n            units: [\"px\"],\r\n            defaultUnit: \"px\",\r\n          },\r\n          default: 10,\r\n        },\r\n      });\r\n    }\r\n\r\n    this.addTextStyleInputs(definition, {\r\n      ...args,\r\n      group: \"Label Text Style\",\r\n      popout: {\r\n        group: \"label-text-style\",\r\n        label: \"Text Style\",\r\n        parentGroup: \"Label\",\r\n      },\r\n    });\r\n  },\r\n\r\n  addTextStyleInputs(definition, args) {\r\n    args = args || {};\r\n\r\n    const group = args.group || \"Text Style\";\r\n    const styleTag = args.styleTag;\r\n\r\n    const portPrefix = args.hasOwnProperty(\"portPrefix\")\r\n      ? args.portPrefix\r\n      : args.styleTag || \"\";\r\n\r\n    const textStyleInputName = portPrefix + \"textStyle\";\r\n\r\n    const index = args.portIndex !== undefined ? args.portIndex : 19;\r\n\r\n    function prettyName(name) {\r\n      return args.displayName ? args.displayName + \" \" + name : name;\r\n    }\r\n\r\n    addInputs(definition, {\r\n      [textStyleInputName]: {\r\n        index: index,\r\n        type: {\r\n          name: \"textStyle\",\r\n          childPorts: [\r\n            \"fontFamily\",\r\n            \"fontSize\",\r\n            \"color\",\r\n            \"letterSpacing\",\r\n            \"lineHeight\",\r\n            \"textTransform\",\r\n          ],\r\n          childPortPrefix: portPrefix,\r\n        },\r\n        group: group,\r\n        displayName: \"Text Style\",\r\n        editorName: prettyName(\"Text Style\"),\r\n        default: \"None\",\r\n        set(value) {\r\n          this.props[textStyleInputName] =\r\n            this.context.styles.getTextStyle(value);\r\n          this.forceUpdate();\r\n        },\r\n        allowVisualStates: true,\r\n        popout: args.popout,\r\n      },\r\n      [portPrefix + \"fontFamily\"]: {\r\n        index: index + 1,\r\n        type: {\r\n          name: \"font\",\r\n          parentPort: textStyleInputName,\r\n        },\r\n        group: group,\r\n        displayName: \"Font Family\",\r\n        editorName: prettyName(\"Font Family\"),\r\n        set(value) {\r\n          if (value) {\r\n            let family = value;\r\n            if (family.split(\".\").length > 1) {\r\n              FontLoader.instance.loadFont(family);\r\n              family = family.replace(/\\.[^/.]+$/, \"\");\r\n              family = family.split(\"/\").pop();\r\n            }\r\n            this.setStyle({ fontFamily: family }, styleTag);\r\n          } else {\r\n            this.removeStyle([\"fontFamily\"], styleTag);\r\n          }\r\n\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        },\r\n        allowVisualStates: true,\r\n        popout: args.popout,\r\n      },\r\n    });\r\n\r\n    addInputCss(definition, {\r\n      [portPrefix + \"fontSize\"]: {\r\n        index: index + 2,\r\n        group: group,\r\n        displayName: \"Font Size\",\r\n        editorName: prettyName(\"Font Size\"),\r\n        targetStyleProperty: \"fontSize\",\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n          parentPort: textStyleInputName,\r\n        },\r\n        onChange() {\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        },\r\n        allowVisualStates: true,\r\n        popout: args.popout,\r\n        styleTag,\r\n      },\r\n      [portPrefix + \"color\"]: {\r\n        index: index + 3,\r\n        type: {\r\n          name: \"color\",\r\n          parentPort: textStyleInputName,\r\n        },\r\n        displayName: \"Color\",\r\n        editorName: prettyName(\"Color\"),\r\n        group: group,\r\n        targetStyleProperty: \"color\",\r\n        allowVisualStates: true,\r\n        popout: args.popout,\r\n        styleTag,\r\n        onChange() {\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        },\r\n      },\r\n      [portPrefix + \"letterSpacing\"]: {\r\n        index: index + 4,\r\n        group: group,\r\n        displayName: \"Letter Spacing\",\r\n        editorName: prettyName(\"Letter Spacing\"),\r\n        targetStyleProperty: \"letterSpacing\",\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\", \"em\"],\r\n          defaultUnit: \"px\",\r\n        },\r\n        allowVisualStates: true,\r\n        popout: args.popout,\r\n        styleTag,\r\n        default: \"Auto\",\r\n        applyDefault: false,\r\n        onChange() {\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        },\r\n      },\r\n      [portPrefix + \"lineHeight\"]: {\r\n        index: index + 5,\r\n        group: group,\r\n        displayName: \"Line Height\",\r\n        editorName: prettyName(\"Line Height\"),\r\n        targetStyleProperty: \"lineHeight\",\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"\", \"px\", \"%\"],\r\n          defaultUnit: \"\",\r\n          parentPort: textStyleInputName,\r\n        },\r\n        allowVisualStates: true,\r\n        onChange() {\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        },\r\n        popout: args.popout,\r\n        styleTag,\r\n        default: \"Auto\",\r\n        applyDefault: false,\r\n      },\r\n      [portPrefix + \"textTransform\"]: {\r\n        index: index + 6,\r\n        group: group,\r\n        displayName: \"Case\",\r\n        editorName: prettyName(\"Case\"),\r\n        applyDefault: false,\r\n        targetStyleProperty: \"textTransform\",\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"None\", value: \"none\" },\r\n            { label: \"Uppercase\", value: \"uppercase\" },\r\n            { label: \"Lowercase\", value: \"lowercase\" },\r\n            { label: \"Capitalize\", value: \"capitalize\" },\r\n          ],\r\n          parentPort: textStyleInputName,\r\n        },\r\n        default: \"none\",\r\n        popout: args.popout,\r\n        styleTag,\r\n        allowVisualStates: true,\r\n        onChange() {\r\n          if (this.props[textStyleInputName]) {\r\n            this.forceUpdate();\r\n          }\r\n        },\r\n      },\r\n    });\r\n\r\n    const fontFamilyPort = portPrefix + \"fontFamily\";\r\n\r\n    definition.setup = function (context, graphModel) {\r\n      graphModel.on(\"nodeAdded.\" + definition.name, function (node) {\r\n        if (\r\n          node.parameters[fontFamilyPort] &&\r\n          node.parameters[fontFamilyPort].split(\".\").length > 1\r\n        ) {\r\n          FontLoader.instance.loadFont(node.parameters[fontFamilyPort]);\r\n        }\r\n        node.on(\"parameterUpdated\", function (event) {\r\n          if (event.name === fontFamilyPort && event.value) {\r\n            if (event.value.split(\".\").length > 1) {\r\n              FontLoader.instance.loadFont(event.value);\r\n            }\r\n          }\r\n        });\r\n      });\r\n    };\r\n  },\r\n};\r\n\r\nfunction addDimensionTooltips(definition, contentLabel) {\r\n  definition.inputProps.sizeMode.tooltip = {\r\n    explicit: {\r\n      standard: \"Explicit width & height\",\r\n      extended: createTooltip({\r\n        title: \"Explicit width & height\",\r\n        body: \"Set width & height explicitly in pixels(px), percentage(%) or viewport size(vh/vw).\",\r\n        images: [{ src: \"size-mode-explicit.svg\" }],\r\n      }),\r\n    },\r\n    contentWidth: {\r\n      standard: `${contentLabel} width & explicit height`,\r\n      extended: createTooltip({\r\n        title: `${contentLabel} width & explicit height`,\r\n        body: `The width will match the width of the ${contentLabel.toLowerCase()}. Height is set explicitly.`,\r\n        images: [{ src: \"size-mode-content-width.svg\" }],\r\n      }),\r\n    },\r\n    contentHeight: {\r\n      standard: `Explicit width & ${contentLabel.toLowerCase()} height`,\r\n      extended: createTooltip({\r\n        title: `Explicit width & ${contentLabel.toLowerCase()} height`,\r\n        body: `The width is set explicitly. The height will match the height of the ${contentLabel.toLowerCase()}`,\r\n        images: [{ src: \"size-mode-content-height.svg\" }],\r\n      }),\r\n    },\r\n    contentSize: {\r\n      standard: `${contentLabel} width & height`,\r\n      extended: createTooltip({\r\n        title: `${contentLabel} width & height`,\r\n        body: `The width and height will match the size of the ${contentLabel.toLowerCase()}`,\r\n        images: [{ src: \"size-mode-content-size.svg\" }],\r\n      }),\r\n    },\r\n  };\r\n\r\n  const unitsBodyText = [\r\n    \"- %: Relative to parents size. If 'fixed' is false this element will resize to share space with siblings. If 'Clip Content' is disabled, it'll also expand to fit the boundaries of all its content\",\r\n    \"- px: Pixels\",\r\n    \"- vw: Relative to viewport width. 100 makes the element the same width as the screen\",\r\n    \"- vh: Relative to viewport height. 100 makes the element the same height as the screen\",\r\n  ];\r\n\r\n  const fixedTooltip = createTooltip({\r\n    title: \"Fixed\",\r\n    body: [\r\n      \"- Enabled: Elements will be the exact size set\",\r\n      \"- Disabled: Element will resize to fill up empty space, or shrink to make space for siblings. Use the dimension constraints, min and max size, to control the boundaries\",\r\n    ],\r\n  });\r\n\r\n  definition.inputProps.width.tooltip = {\r\n    dimension: createTooltip({\r\n      title: \"Width\",\r\n      body: unitsBodyText,\r\n    }),\r\n    fixed: fixedTooltip,\r\n  };\r\n\r\n  definition.inputProps.height.tooltip = {\r\n    dimension: createTooltip({\r\n      title: \"Height\",\r\n      body: unitsBodyText,\r\n    }),\r\n    fixed: fixedTooltip,\r\n  };\r\n}\r\n\r\nfunction addDimensionConstraintsTooltips(definition) {\r\n  definition.inputCss.minWidth.tooltip = createTooltip({\r\n    title: \"Minimum width\",\r\n    body: \"This is prioritized over other properties, so the element won't shrink below this size\",\r\n  });\r\n\r\n  definition.inputCss.minHeight.tooltip = createTooltip({\r\n    title: \"Minimum height\",\r\n    body: \"This is prioritized over other properties, so the element won't shrink below this size\",\r\n  });\r\n\r\n  definition.inputCss.maxWidth.tooltip = createTooltip({\r\n    title: \"Maximum width\",\r\n    body: \"This is prioritized over other properties, so the element won't grow beyond this size\",\r\n  });\r\n\r\n  definition.inputCss.maxHeight.tooltip = createTooltip({\r\n    title: \"Maximum height\",\r\n    body: \"This is prioritized over other properties, so the element won't grow beyond this size\",\r\n  });\r\n}\r\n\r\nfunction addPointerEventsTooltips(definition) {\r\n  definition.inputs.pointerEventsMode.tooltip = createTooltip({\r\n    title: \"Pointer events mode\",\r\n    body: [\r\n      \"Control if mouse and touch events are enabled on this node\",\r\n      \"- Inherit: Same settings as parent\",\r\n      \"- Explicit: Enable control on this element\",\r\n    ],\r\n  });\r\n  definition.inputs.pointerEventsEnabled.tooltip = createTooltip({\r\n    title: \"Pointer events enabled\",\r\n    body: [\r\n      \"- Enabled: This element will receive mouse and touch events\",\r\n      \"- Disabled: No mouse or touch events will be captured by this element and the element below will receive it instead\",\r\n    ],\r\n  });\r\n}\r\n\r\nfunction addPositionAndAlignTooltips(definition) {\r\n  definition.inputCss.position.tooltip = createTooltip({\r\n    title: \"Position\",\r\n    images: [\r\n      {\r\n        label: \"Relative\",\r\n        body: \"Relative to its siblings\",\r\n        src: \"position-relative.svg\",\r\n      },\r\n      {\r\n        label: \"Absolute\",\r\n        body: \"Not affected by siblings or parent's layout\",\r\n        src: \"position-absolute.svg\",\r\n      },\r\n      {\r\n        label: \"Sticky\",\r\n        body: \"Stick to parent's edge on overflow\",\r\n        src: \"position-sticky.svg\",\r\n      },\r\n      {\r\n        label: \"Fixed\",\r\n        body: \"Always stay in the same place and take no space in the layout\",\r\n        src: \"position-sticky.svg\",\r\n      },\r\n    ],\r\n  });\r\n}\r\n","import BezierEasing from \"bezier-easing\";\r\nimport { default as EaseCurves } from \"./easecurves\";\r\n\r\ninterface Node {\r\n  _transitions?: { [key: string]: any };\r\n  getInputValue(name: string): any;\r\n  getInput(name: string): { type: string } | null;\r\n  queueInput(name: string, value: any): void;\r\n  context: {\r\n    styles: {\r\n      resolveColor(color: string): string;\r\n    };\r\n    timerScheduler: {\r\n      createTimer(config: {\r\n        duration: number;\r\n        onRunning: (t: number) => void;\r\n        onFinish: () => void;\r\n      }): { start: () => void; stop: () => void };\r\n    };\r\n  };\r\n}\r\n\r\ninterface Transition {\r\n  curve: number[];\r\n  dur: number;\r\n}\r\n\r\nexport default function transitionParameter(\r\n  node: Node,\r\n  name: string,\r\n  endValue: any,\r\n  transition: Transition\r\n): void {\r\n  if (node._transitions && node._transitions[name]) {\r\n    node._transitions[name].stop();\r\n    delete node._transitions[name];\r\n  }\r\n\r\n  const startValue = node.getInputValue(name);\r\n  const input = node.getInput(name);\r\n\r\n  let animation: ((t: number) => any) | undefined;\r\n\r\n  if (input && input.type === \"color\") {\r\n    animation = colorAnimation(\r\n      node.context.styles.resolveColor(startValue),\r\n      node.context.styles.resolveColor(endValue)\r\n    );\r\n  } else if (typeof startValue === \"number\" && typeof endValue === \"number\") {\r\n    animation = numberAnimation(startValue, endValue);\r\n  } else if (\r\n    typeof startValue === \"object\" &&\r\n    startValue.hasOwnProperty(\"value\") &&\r\n    typeof endValue === \"object\" &&\r\n    endValue.hasOwnProperty(\"value\")\r\n  ) {\r\n    animation = numberAnimation(startValue.value, endValue.value);\r\n  }\r\n\r\n  if (animation) {\r\n    if (!node._transitions) node._transitions = {};\r\n\r\n    const ease = BezierEasing(transition.curve);\r\n\r\n    node._transitions[name] = node.context.timerScheduler.createTimer({\r\n      duration: transition.dur,\r\n      onRunning: (t) => {\r\n        // @ts-ignore\r\n        const v = animation(ease.get(t));\r\n        node.queueInput(name, v);\r\n      },\r\n      onFinish: () => {\r\n        // @ts-expect-error\r\n        delete node._transitions[name];\r\n      },\r\n    });\r\n\r\n    node._transitions[name].start();\r\n  } else {\r\n    // no transition supported for this parameter type, so just set it\r\n    node.queueInput(name, endValue);\r\n  }\r\n}\r\n\r\nfunction numberAnimation(start: number, end: number): (t: number) => number {\r\n  return (t) => {\r\n    return EaseCurves.linear(start, end, t);\r\n  };\r\n}\r\n\r\nfunction setRGBA(result: number[], hex: string): void {\r\n  if (hex === \"transparent\" || !hex) {\r\n    result[3] = 0;\r\n    return;\r\n  }\r\n\r\n  const numComponents = (hex.length - 1) / 2;\r\n\r\n  for (let i = 0; i < numComponents; ++i) {\r\n    const index = 1 + i * 2;\r\n    result[i] = parseInt(hex.substring(index, index + 2), 16);\r\n  }\r\n}\r\n\r\nfunction componentToHex(c: number): string {\r\n  const hex = c.toString(16);\r\n  return hex.length === 1 ? \"0\" + hex : hex;\r\n}\r\n\r\nfunction rgbaToHex(rgba: number[]): string {\r\n  return (\r\n    \"#\" +\r\n    componentToHex(rgba[0]) +\r\n    componentToHex(rgba[1]) +\r\n    componentToHex(rgba[2]) +\r\n    componentToHex(rgba[3])\r\n  );\r\n}\r\n\r\nfunction colorAnimation(start: string, end: string): (t: number) => string {\r\n  const rgba0 = [0, 0, 0, 255];\r\n  setRGBA(rgba0, start);\r\n\r\n  const rgba1 = [0, 0, 0, 255];\r\n  setRGBA(rgba1, end);\r\n\r\n  if (!start || start === \"transparent\") {\r\n    rgba0[0] = rgba1[0];\r\n    rgba0[1] = rgba1[1];\r\n    rgba0[2] = rgba1[2];\r\n  }\r\n  if (!end || end === \"transparent\") {\r\n    rgba1[0] = rgba0[0];\r\n    rgba1[1] = rgba0[1];\r\n    rgba1[2] = rgba0[2];\r\n  }\r\n\r\n  const rgba = [0, 0, 0, 0];\r\n\r\n  return (t) => {\r\n    rgba[0] = Math.floor(EaseCurves.linear(rgba0[0], rgba1[0], t));\r\n    rgba[1] = Math.floor(EaseCurves.linear(rgba0[1], rgba1[1], t));\r\n    rgba[2] = Math.floor(EaseCurves.linear(rgba0[2], rgba1[2], t));\r\n    rgba[3] = Math.floor(EaseCurves.linear(rgba0[3], rgba1[3], t));\r\n\r\n    return rgbaToHex(rgba);\r\n  };\r\n}\r\n","\"use strict\";\r\n\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport { DOMBoundingBoxObserver } from \"./dom-boundingbox-oberver\";\r\nimport Layout from \"./layout\";\r\nimport mergeDeep from \"./mergedeep\";\r\nimport NodeSharedPortDefinitions from \"./node-shared-port-definitions\";\r\nimport transitionParameter from \"./node-transitions\";\r\n\r\nfunction addOutputPropHandler(node, propCallbacks, propPath) {\r\n  const props = propPath ? node.props[propPath] : node.props;\r\n\r\n  for (const propName in propCallbacks) {\r\n    if (props[propName]) {\r\n      const prevCb = props[propName];\r\n      props[propName] = () => {\r\n        prevCb();\r\n        propCallbacks[propName].call(node);\r\n      };\r\n    } else {\r\n      props[propName] = propCallbacks[propName].bind(node);\r\n    }\r\n  }\r\n  node.forceUpdate();\r\n}\r\n\r\nfunction addPrimitiveOutputPropHandler(node, name, output) {\r\n  let prop;\r\n\r\n  if (output.type === \"signal\") {\r\n    prop = () => {\r\n      node.sendSignalOnOutput(name);\r\n    };\r\n  } else {\r\n    prop = (...args) => {\r\n      node.outputPropValues[name] = output.getValue\r\n        ? output.getValue.call(node, ...args)\r\n        : args[0];\r\n      node.flagOutputDirty(name);\r\n      output.onChange &&\r\n        output.onChange.call(node, node.outputPropValues[name]);\r\n    };\r\n  }\r\n\r\n  addOutputPropHandler(node, { [name]: prop }, output.propPath);\r\n}\r\n\r\nfunction defineRegularInputProp(input, name) {\r\n  if (!input.type) throw new Error(`input ${name} is missing a type`);\r\n\r\n  if (input.type.units) {\r\n    input.set = function (value) {\r\n      const props = input.propPath ? this.props[input.propPath] : this.props;\r\n      if (value && value.value !== undefined) {\r\n        props[name] = value.value + value.unit;\r\n      } else {\r\n        delete props[name];\r\n      }\r\n      if (input.onChange) {\r\n        input.onChange.call(this, value);\r\n      }\r\n      this.forceUpdate();\r\n    };\r\n  } else {\r\n    input.set = function (value) {\r\n      const props = input.propPath ? this.props[input.propPath] : this.props;\r\n      if (value !== undefined) {\r\n        props[name] = value;\r\n      } else {\r\n        delete props[name];\r\n      }\r\n      if (input.onChange) {\r\n        input.onChange.call(this, value);\r\n      }\r\n      this.forceUpdate();\r\n    };\r\n  }\r\n}\r\n\r\nfunction flattenArray(target, array) {\r\n  for (const e of array) {\r\n    if (Array.isArray(e)) {\r\n      flattenArray(target, e);\r\n    } else if (e !== undefined) {\r\n      target.push(e);\r\n    }\r\n  }\r\n}\r\n\r\nclass NoodlReactComponent extends React.Component {\r\n  componentDidMount() {\r\n    this.props.noodlNode.sendSignalOnOutput(\"didMount\");\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.noodlNode.sendSignalOnOutput(\"willUnmount\");\r\n    //Remove\r\n    const noodlNode = this.props.noodlNode;\r\n    if (noodlNode.currentVisualStates) {\r\n      const statesToRemove = [\"hover\", \"pressed\", \"focused\"];\r\n      const vs = noodlNode.currentVisualStates.filter(\r\n        (s) => !statesToRemove.includes(s)\r\n      );\r\n      noodlNode.setVisualStates(vs);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    //So the props are a bit tricky here...\r\n    //this.props consist of:\r\n    // - the props passed by the ReactComponentNode.render() function, just {noodlNode}\r\n    // - any additional third party props coming from the parent react component.\r\n    //E.g. the drag node adds event handlers, style, and className to this.props.\r\n\r\n    const { noodlNode, style, ...otherProps } = this.props;\r\n\r\n    let finalStyle = noodlNode.style;\r\n\r\n    //check if there's additional styling from the react parent\r\n    //if so, we need to combine it with the style from the Noodl node\r\n    //let the extra style take priority over the noodl style, if they share some attributes\r\n    //this is wrapped in an if for performance reasons, \"...\" is quite slow\r\n    if (style) {\r\n      finalStyle = {\r\n        ...noodlNode.style, //styling from the noodl node\r\n        ...style, //styling from the react component parent\r\n      };\r\n    }\r\n\r\n    const props = {\r\n      ref: (ref) => {\r\n        noodlNode.innerReactComponentRef = ref;\r\n      },\r\n      style: finalStyle,\r\n      //the noodl props coming from the node\r\n      //some components actually have a \"style\" used for something other than css,\r\n      //so make sure this comes after the \"style\" prop above, so it can overwrite it\r\n      //(e.g. Jesper's Icon Material UI)\r\n      ...noodlNode.props,\r\n\r\n      //otherProps can be empty, but some react components add additional props to their children\r\n      ...otherProps,\r\n    };\r\n\r\n    if (noodlNode.noodlNodeAsProp) {\r\n      props.noodlNode = noodlNode;\r\n\r\n      //nodes that want the noodlNode also get the parent layout\r\n      //since it's used by all built in nodes for layout purposes\r\n      const parent = noodlNode.getVisualParentNode();\r\n      if (parent && parent.props.layout) {\r\n        props.parentLayout = parent.props.layout;\r\n      }\r\n    }\r\n\r\n    //optimization. This is used by forceUpdate() to only render this node once per frame.\r\n    noodlNode.renderedAtFrame = noodlNode.context.frameNumber;\r\n\r\n    if (noodlNode.useFrame) {\r\n      if (props.textStyle !== undefined) {\r\n        // Apply text style\r\n        props.style = finalStyle = Object.assign(\r\n          {},\r\n          props.textStyle,\r\n          finalStyle\r\n        );\r\n      }\r\n      Layout.size(finalStyle, props);\r\n      Layout.align(finalStyle, props);\r\n\r\n      /*  if(finalStyle.opacity === 0) {\r\n                finalStyle.pointerEvents = 'none';\r\n            }*/\r\n    }\r\n\r\n    return React.createElement(\r\n      noodlNode.reactComponent,\r\n      props,\r\n      noodlNode.renderChildren()\r\n    );\r\n  }\r\n}\r\n\r\nfunction setStylesOnDOMNode(rootElement, styles, styleTag) {\r\n  let element = rootElement;\r\n\r\n  if (styleTag) {\r\n    //check if the root element has the style tag, if not, find the child that does\r\n    if (element.getAttribute(\"noodl-style-tag\") !== styleTag) {\r\n      element = rootElement.querySelector(`[noodl-style-tag=${styleTag}]`);\r\n    }\r\n  }\r\n\r\n  if (!element) return;\r\n\r\n  for (const p in styles) {\r\n    element.style[p] = styles[p];\r\n  }\r\n}\r\n\r\nlet reactKeyCounter = 0;\r\n\r\nfunction createNodeFromReactComponent(def) {\r\n  // visual frame props\r\n  const { frame } = def;\r\n  if (frame !== undefined) {\r\n    if (frame.dimensions) {\r\n      NodeSharedPortDefinitions.addDimensions(\r\n        def,\r\n        typeof frame.dimensions === \"object\" ? frame.dimensions : undefined\r\n      );\r\n    }\r\n\r\n    if (frame.position) NodeSharedPortDefinitions.addTransformInputs(def);\r\n\r\n    if (frame.margins) NodeSharedPortDefinitions.addMarginInputs(def);\r\n\r\n    if (frame.padding) NodeSharedPortDefinitions.addPaddingInputs(def);\r\n\r\n    if (frame.align) NodeSharedPortDefinitions.addAlignInputs(def);\r\n\r\n    //  NodeSharedPortDefinitions.addSharedVisualInputs(ReactComponentNode);\r\n\r\n    // NodeSharedPortDefinitions.addPointerEventOutputs(ReactComponentNode);\r\n  }\r\n\r\n  const {\r\n    initialize,\r\n    inputs,\r\n    inputProps,\r\n    inputCss,\r\n    outputs,\r\n    outputProps,\r\n    dynamicports,\r\n    defaultCss = {},\r\n    methods,\r\n  } = def;\r\n\r\n  //assign default values to style\r\n  const startStyle = Object.assign({}, defaultCss);\r\n  const startStyles = {};\r\n\r\n  for (const name in inputCss) {\r\n    const input = inputCss[name];\r\n\r\n    const hasDefault =\r\n      input.hasOwnProperty(\"default\") && input.applyDefault !== false;\r\n    if (input.styleTag && !startStyles.hasOwnProperty(input.styleTag)) {\r\n      startStyles[input.styleTag] = {};\r\n    }\r\n\r\n    if (hasDefault) {\r\n      const value = input.type.units\r\n        ? input.default + input.type.defaultUnit\r\n        : input.default;\r\n      if (input.styleTag) {\r\n        startStyles[input.styleTag][name] = value;\r\n      } else {\r\n        startStyle[name] = value;\r\n      }\r\n    }\r\n  }\r\n\r\n  function boundingBoxObserverCallback(attribute, rect) {\r\n    this.clientBoundingRect = rect;\r\n    if (attribute === \"x\") {\r\n      this.flagOutputDirty(\"screenPositionX\");\r\n    } else if (attribute === \"y\") {\r\n      this.flagOutputDirty(\"screenPositionY\");\r\n    } else if (attribute === \"width\") {\r\n      this.flagOutputDirty(\"boundingWidth\");\r\n    } else if (attribute === \"height\") {\r\n      this.flagOutputDirty(\"boundingHeight\");\r\n    }\r\n  }\r\n\r\n  const useVariants = def.useVariants !== undefined ? def.useVariants : true;\r\n\r\n  const ReactComponentNode = {\r\n    name: def.name,\r\n    docs: def.docs,\r\n    displayNodeName: def.displayNodeName || def.displayName,\r\n    shortDesc: \"\",\r\n    category: \"Visual\",\r\n    allowChildren: def.allowChildren === undefined ? true : def.allowChildren, //default to true\r\n    visualStates: def.visualStates,\r\n    allowAsExportRoot: def.allowAsExportRoot,\r\n    singleton: def.singleton,\r\n    useVariants,\r\n    usePortAsLabel: def.usePortAsLabel,\r\n    portLabelTruncationMode: def.portLabelTruncationMode,\r\n    connectionPanel: def.connectionPanel,\r\n    nodeDoubleClickAction: def.nodeDoubleClickAction,\r\n    initialize() {\r\n      this.reactKey = \"key\" + reactKeyCounter;\r\n      reactKeyCounter++;\r\n\r\n      this.children = [];\r\n      if (hasChildCountOutput) {\r\n        this.childrenCount = 0;\r\n      }\r\n\r\n      this.props = { styles: {} };\r\n      this.outputPropValues = {};\r\n      this.style = Object.assign({}, startStyle);\r\n\r\n      for (const styleTag in startStyles) {\r\n        this.props.styles[styleTag] = Object.assign({}, startStyles[styleTag]);\r\n      }\r\n      this.childIndex = 0;\r\n      this.clientBoundingRect = {};\r\n      this.noodlNodeAsProp = def.noodlNodeAsProp ? true : false;\r\n\r\n      const pollDelay = this.context && this.context.runningInCanvas ? 300 : 0;\r\n      this.boundingBoxObserver = new DOMBoundingBoxObserver(\r\n        boundingBoxObserverCallback.bind(this),\r\n        pollDelay\r\n      );\r\n\r\n      this.wantsToBeMounted = true;\r\n\r\n      this.useFrame = !!frame;\r\n\r\n      //assign default values to props\r\n      for (const name in inputProps) {\r\n        const input = inputProps[name];\r\n        if (input.propPath && !this.props.hasOwnProperty(input.propPath)) {\r\n          this.props[input.propPath] = {};\r\n        }\r\n\r\n        const props = input.propPath ? this.props[input.propPath] : this.props;\r\n\r\n        if (input.hasOwnProperty(\"default\")) {\r\n          if (input.type.defaultUnit && input.default !== undefined) {\r\n            props[name] = input.default + input.type.defaultUnit;\r\n          } else {\r\n            props[name] = input.default;\r\n          }\r\n        }\r\n      }\r\n\r\n      //set ut props that send data on noodl outputs\r\n      for (const outputName in outputProps) {\r\n        const output = outputProps[outputName];\r\n        if (output.propPath && !this.props.hasOwnProperty(output.propPath)) {\r\n          this.props[output.propPath] = {};\r\n        }\r\n\r\n        if (!output.props) {\r\n          addPrimitiveOutputPropHandler(this, outputName, output);\r\n        } else {\r\n          addOutputPropHandler(this, output.props, output.propPath);\r\n        }\r\n      }\r\n\r\n      this.reactComponentRef = null;\r\n      this.reactComponent = def.getReactComponent.call(this);\r\n\r\n      if (initialize) {\r\n        initialize.call(this);\r\n      }\r\n    },\r\n    getInspectInfo: def.getInspectInfo,\r\n    nodeScopeDidInitialize: def.nodeScopeDidInitialize,\r\n    dynamicports,\r\n    inputs: {\r\n      cssClassName: {\r\n        index: 100010,\r\n        displayName: \"CSS Class\",\r\n        group: \"Advanced HTML\",\r\n        type: \"string\",\r\n        default: \"\",\r\n        set(value) {\r\n          this.props.className = value;\r\n          this.forceUpdate();\r\n        },\r\n      },\r\n      styleCss: {\r\n        index: 100011,\r\n        displayName: \"CSS Style\",\r\n        group: \"Advanced HTML\",\r\n        type: {\r\n          name: \"string\",\r\n          codeeditor: \"text\",\r\n          allowEditOnly: true,\r\n        },\r\n        default: \"/* background-color: red; */\",\r\n        set(value) {\r\n          this.updateAdvancedStyle({ content: value });\r\n        },\r\n      },\r\n    },\r\n    outputs: {\r\n      childIndex: {\r\n        displayName: \"Child Index\",\r\n        type: \"number\",\r\n        get() {\r\n          return this.childIndex;\r\n        },\r\n      },\r\n      this: {\r\n        displayName: \"This\",\r\n        type: \"reference\",\r\n        get() {\r\n          return this;\r\n        },\r\n      },\r\n      screenPositionX: {\r\n        group: \"Bounding Box\",\r\n        displayName: \"Screen Position X\",\r\n        type: \"number\",\r\n        get() {\r\n          return this.clientBoundingRect.x;\r\n        },\r\n        onFirstConnectionAdded() {\r\n          this.boundingBoxObserver.addObserver();\r\n        },\r\n        onLastConnectionRemoved() {\r\n          this.boundingBoxObserver.removeObserver();\r\n        },\r\n      },\r\n      screenPositionY: {\r\n        group: \"Bounding Box\",\r\n        displayName: \"Screen Position Y\",\r\n        type: \"number\",\r\n        get() {\r\n          return this.clientBoundingRect.y;\r\n        },\r\n        onFirstConnectionAdded() {\r\n          this.boundingBoxObserver.addObserver();\r\n        },\r\n        onLastConnectionRemoved() {\r\n          this.boundingBoxObserver.removeObserver();\r\n        },\r\n      },\r\n      boundingWidth: {\r\n        group: \"Bounding Box\",\r\n        displayName: \"Width\",\r\n        type: \"number\",\r\n        get() {\r\n          return this.clientBoundingRect.width;\r\n        },\r\n        onFirstConnectionAdded() {\r\n          this.boundingBoxObserver.addObserver();\r\n        },\r\n        onLastConnectionRemoved() {\r\n          this.boundingBoxObserver.removeObserver();\r\n        },\r\n      },\r\n      boundingHeight: {\r\n        group: \"Bounding Box\",\r\n        displayName: \"Height\",\r\n        type: \"number\",\r\n        get() {\r\n          return this.clientBoundingRect.height;\r\n        },\r\n        onFirstConnectionAdded() {\r\n          this.boundingBoxObserver.addObserver();\r\n        },\r\n        onLastConnectionRemoved() {\r\n          this.boundingBoxObserver.removeObserver();\r\n        },\r\n      },\r\n      didMount: {\r\n        group: \"Mounted\",\r\n        displayName: \"Did Mount\",\r\n        type: \"signal\",\r\n      },\r\n      willUnmount: {\r\n        group: \"Mounted\",\r\n        displayName: \"Will Unmount\",\r\n        type: \"signal\",\r\n      },\r\n    },\r\n    methods: {\r\n      updateAdvancedStyle(params) {\r\n        //remove previous styles first\r\n        if (this.customCssStyles) {\r\n          this.removeStyle(Object.keys(this.customCssStyles));\r\n          this.customCssStyles = undefined;\r\n        }\r\n\r\n        let style;\r\n        let errorMessage = \"\";\r\n\r\n        let rawCss = (params.content || \"\").replace(\"\\n\", \"\");\r\n\r\n        // strip away comments\r\n        let css = \"\";\r\n        while (rawCss.length) {\r\n          let nextComment = rawCss.indexOf(\"/*\");\r\n          if (nextComment === -1) {\r\n            nextComment = rawCss.length;\r\n          }\r\n          css += rawCss.substring(0, nextComment);\r\n          rawCss = rawCss.substring(nextComment);\r\n\r\n          if (rawCss.length) {\r\n            //were inside a comment\r\n            let endComment = rawCss.indexOf(\"*/\");\r\n            if (endComment === -1) endComment = rawCss.length;\r\n            rawCss = rawCss.substring(endComment + 2);\r\n          }\r\n        }\r\n        function trim(s) {\r\n          return s.replace(/^\\s+|\\s+$/gm, \"\");\r\n        }\r\n\r\n        const styles = css\r\n          .split(\";\")\r\n          .map(trim)\r\n          .filter((s) => s.length);\r\n\r\n        style = {};\r\n        for (const s of styles) {\r\n          const parts = s.split(\":\").map(trim);\r\n\r\n          if (s.indexOf(\"\\n\") !== -1) {\r\n            errorMessage += \"Missing semicolon: \" + s.split(\"\\n\")[0];\r\n          } else if (parts.length !== 2) {\r\n            errorMessage += \"Syntax error: \" + s;\r\n          } else {\r\n            const nameParts = parts[0].split(\"-\");\r\n            for (let i = 1; i < nameParts.length; i++) {\r\n              nameParts[i] =\r\n                nameParts[i][0].toUpperCase() + nameParts[i].substring(1);\r\n            }\r\n            style[nameParts.join(\"\")] = parts[1];\r\n          }\r\n        }\r\n\r\n        if (errorMessage) {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"css-parse-waring\",\r\n            {\r\n              message: \"Error in CSS Style<br>\" + errorMessage,\r\n            }\r\n          );\r\n        } else {\r\n          this.context.editorConnection.clearWarning(\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            \"css-parse-waring\"\r\n          );\r\n          style && this.setStyle(style);\r\n          this.customCssStyles = style;\r\n        }\r\n      },\r\n      setChildIndex(index) {\r\n        this.childIndex = index;\r\n        this.flagOutputDirty(\"childIndex\");\r\n      },\r\n      updateChildIndices() {\r\n        let indexOffset = 0;\r\n        for (let i = 0; i < this.children.length; i++) {\r\n          const child = this.children[i];\r\n          if (\r\n            child.name === \"For Each\" ||\r\n            child.name === \"Component Children\"\r\n          ) {\r\n            indexOffset--;\r\n          }\r\n          child.setChildIndex && child.setChildIndex(i + indexOffset);\r\n        }\r\n      },\r\n      updateChildrenCount() {\r\n        let count = 0;\r\n        this.children.forEach((child) => {\r\n          if (child?.model?.type === \"For Each\") {\r\n            count += child.model.children.length;\r\n          } else {\r\n            count++;\r\n          }\r\n        });\r\n        this.childrenCount = count;\r\n        this.flagOutputDirty(\"childrenCount\");\r\n      },\r\n      addChild(child, index) {\r\n        if (index === undefined) {\r\n          index = this.children.length;\r\n        }\r\n\r\n        child.parent = this;\r\n        this.children.splice(index, 0, child);\r\n        this.cachedChildren = undefined;\r\n        this.scheduleUpdateChildCountAndIndicies();\r\n        this.forceUpdate();\r\n      },\r\n      removeChild(child) {\r\n        const index = this.children.indexOf(child);\r\n        if (index !== -1) {\r\n          this.children.splice(index, 1);\r\n          child.parent = undefined;\r\n\r\n          this.cachedChildren = undefined;\r\n          this.scheduleUpdateChildCountAndIndicies();\r\n          this.forceUpdate();\r\n        }\r\n      },\r\n      contains(node) {\r\n        //breadth first\r\n        const index = this.children.indexOf(node);\r\n        if (index !== -1) return true;\r\n\r\n        return this.children.some(\r\n          (child) => child.contains && child.contains(node)\r\n        );\r\n      },\r\n      scheduleUpdateChildCountAndIndicies() {\r\n        if (this.updateChildIndiciesScheduled) return;\r\n        this.updateChildIndiciesScheduled = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          this.updateChildIndices();\r\n          if (hasChildCountOutput) {\r\n            this.updateChildrenCount();\r\n          }\r\n          this.updateChildIndiciesScheduled = false;\r\n        });\r\n      },\r\n      getChildren() {\r\n        return this.children;\r\n      },\r\n      isChild(child) {\r\n        return this.children.indexOf(child) !== -1;\r\n      },\r\n      getChildRoot() {\r\n        return this;\r\n      },\r\n      forceUpdate() {\r\n        if (this.forceUpdateScheduled === true) return;\r\n        this.forceUpdateScheduled = true;\r\n\r\n        this.context.eventEmitter.once(\"frameEnd\", () => {\r\n          this.forceUpdateScheduled = false;\r\n\r\n          if (this.renderedAtFrame === this.context.frameNumber) {\r\n            return;\r\n          }\r\n\r\n          this.reactComponentRef && this.reactComponentRef.setState({});\r\n        });\r\n        this.context.scheduleUpdate();\r\n      },\r\n      _resetReactVirtualDOM() {\r\n        //reset the react key to force a full re-render\r\n        //this can be required since we're editing the DOM tree, without React knowing\r\n        //and can confuse React in certain cases\r\n        this.reactKey = \"key\" + reactKeyCounter;\r\n        reactKeyCounter++;\r\n        const parent = this.getVisualParentNode();\r\n        if (parent) {\r\n          parent.cachedChildren = undefined;\r\n          parent.forceUpdate();\r\n        }\r\n      },\r\n      /** Added for SSR Support */\r\n      triggerDidMount() {\r\n        if (this.wantsToBeMounted && !this.didCallTriggerDidMount) {\r\n          this.didCallTriggerDidMount = true;\r\n\r\n          if (this.hasOutput(\"didMount\")) {\r\n            this.sendSignalOnOutput(\"didMount\");\r\n          }\r\n\r\n          // HACK: This is requried for the Page Router.\r\n          if (this.props.didMount) {\r\n            this.props.didMount();\r\n          }\r\n\r\n          // HACK: Repeater... same as above\r\n          if (this.didMount) {\r\n            this.didMount();\r\n          }\r\n        }\r\n\r\n        this.children.forEach((child) => {\r\n          // TODO: Repeater is missing triggerDidMount\r\n          child.triggerDidMount && child.triggerDidMount();\r\n        });\r\n      },\r\n      render() {\r\n        if (!this.wantsToBeMounted) {\r\n          return;\r\n        }\r\n\r\n        //these props will only be sent when this component\r\n        //is added to the react tree. Further updates will only call\r\n        //render on the NoodlReactComponent, so make sure these props\r\n        //don't need to change over the lifetime of this node\r\n        return React.createElement(NoodlReactComponent, {\r\n          key: this.reactKey,\r\n          noodlNode: this,\r\n          ref: (ref) => {\r\n            this.reactComponentRef = ref;\r\n            this.boundingBoxObserver.setTarget(ReactDOM.findDOMNode(ref));\r\n          },\r\n        });\r\n      },\r\n      renderChildren() {\r\n        if (!this.cachedChildren) {\r\n          let c = this.children.map((child) => child.render());\r\n\r\n          let children = [];\r\n          flattenArray(children, c);\r\n\r\n          if (children.length === 0) {\r\n            children = null;\r\n          } else if (children.length === 1) {\r\n            //some components expects a single child only, and won't handle arrays\r\n            //and React.Children.only() throws an error on an array with only one child\r\n            children = children[0];\r\n          }\r\n\r\n          this.cachedChildren = children;\r\n        }\r\n\r\n        return this.cachedChildren;\r\n      },\r\n      setStyle(newStyles, styleTag) {\r\n        //this method will try to set css styles directly on the\r\n        //raw DOM elements, circumventing React.\r\n        //However, there's some layout and align attributes that are dependent\r\n        //on each other and need to go through additional processing.\r\n        //This function will detect those and trigger everything to run through the\r\n        //React component when necessary.\r\n\r\n        //TODO: move all these checks to the inputs themselves\r\n        //so the set-method of e.g. marginLeft can do the check and either\r\n        //set the style directly on the dom node, or trigger a react render\r\n        const styleObject = styleTag ? this.props.styles[styleTag] : this.style;\r\n\r\n        for (const p in newStyles) {\r\n          styleObject[p] = newStyles[p];\r\n        }\r\n\r\n        const domElement = this.getDOMElement();\r\n        if (!domElement) return;\r\n\r\n        let forceUpdate = false;\r\n\r\n        if (!styleTag) {\r\n          if (newStyles.hasOwnProperty(\"opacity\")) {\r\n            //opacity change between zero and non-zero can toggle pointer events\r\n            //to be treated differently, so make sure to force update during those transitions\r\n\r\n            //note: properties in domElement.style are all strings\r\n            forceUpdate =\r\n              newStyles.hasOwnProperty(\"opacity\") &&\r\n              ((domElement.style.opacity === \"0\" && newStyles.opacity > 0) ||\r\n                (domElement.style.opacity !== \"0\" && newStyles.opacity === 0));\r\n          }\r\n          if (newStyles.transform) {\r\n            let transform = newStyles.transform;\r\n\r\n            const parent = this.getVisualParentNode();\r\n            //three ways we can be position absolute:\r\n            //1. user explicitly set this node to absolute\r\n            //2. parent has no layout, which translate into no flexDirection\r\n            //3. there is no parent, meaning we're a root in the root component\r\n            if (\r\n              this.style.position === \"absolute\" ||\r\n              !parent ||\r\n              !parent.style.flexDirection\r\n            ) {\r\n              if (\r\n                this.props.alignX === \"center\" &&\r\n                !(domElement.style.marginLeft && domElement.style.marginRight)\r\n              )\r\n                transform = \"translateX(-50%) \" + transform;\r\n              if (\r\n                this.props.alignY === \"center\" &&\r\n                !(domElement.style.marginTop && domElement.style.marginBottom)\r\n              )\r\n                transform = \"translateY(-50%) \" + transform;\r\n            }\r\n\r\n            newStyles.transform = transform;\r\n          }\r\n\r\n          const marginsChanged =\r\n            newStyles.hasOwnProperty(\"marginLeft\") ||\r\n            newStyles.hasOwnProperty(\"marginRight\") ||\r\n            newStyles.hasOwnProperty(\"marginTop\") ||\r\n            newStyles.hasOwnProperty(\"marginBottom\");\r\n          const sizeInPercent =\r\n            (this.props.width &&\r\n              this.props.width[this.props.width.length - 1] === \"%\") ||\r\n            (this.props.height &&\r\n              this.props.height[this.props.height.length - 1] === \"%\");\r\n          if (sizeInPercent && marginsChanged) {\r\n            forceUpdate = true;\r\n          }\r\n\r\n          if (newStyles.position || newStyles.flexDirection || newStyles.clip) {\r\n            forceUpdate = true;\r\n          }\r\n        }\r\n\r\n        if (forceUpdate) {\r\n          this.forceUpdate();\r\n        } else {\r\n          setStylesOnDOMNode(domElement, newStyles, styleTag);\r\n        }\r\n      },\r\n      removeStyle(styles, styleTag) {\r\n        const styleObject = styleTag ? this.props.styles[styleTag] : this.style;\r\n\r\n        for (const p of styles) {\r\n          delete styleObject[p];\r\n        }\r\n\r\n        const domElement = this.getDOMElement();\r\n\r\n        let forceUpdate = false;\r\n        if (!styleTag && domElement) {\r\n          const forceUpdateAttributes = {\r\n            marginTop: true,\r\n            marginBottom: true,\r\n            marginLeft: true,\r\n            marginRight: true,\r\n          };\r\n\r\n          for (const p of styles) {\r\n            if (forceUpdateAttributes[p]) forceUpdate = true;\r\n          }\r\n        }\r\n\r\n        if (domElement) {\r\n          //deleting styles is done by setting them to an empty string\r\n          const newStyles = {};\r\n          for (const p of styles) {\r\n            newStyles[p] = \"\";\r\n          }\r\n          setStylesOnDOMNode(domElement, newStyles, styleTag);\r\n        }\r\n\r\n        if (forceUpdate) {\r\n          this.forceUpdate();\r\n        }\r\n      },\r\n      getStyle(style) {\r\n        return this.style[style];\r\n      },\r\n      getRef() {\r\n        return this.reactComponentRef;\r\n      },\r\n      getDOMElement() {\r\n        const ref = this.getRef();\r\n        if (!ref) return;\r\n\r\n        return ReactDOM.findDOMNode(ref);\r\n      },\r\n      getVisualParentNode() {\r\n        if (this.parent) return this.parent;\r\n\r\n        //we're a root\r\n        let component = this.nodeScope.componentOwner;\r\n        while (!component.parent && component.parentNodeScope) {\r\n          component = component.parentNodeScope.componentOwner;\r\n        }\r\n\r\n        return component ? component.parent : undefined;\r\n      },\r\n      setVariant(variant) {\r\n        //stop any state transitions that are currently running\r\n        this._stopStateTransitions();\r\n\r\n        this.variant = variant;\r\n\r\n        const parameters = {};\r\n        //apply base variant parameters\r\n        variant && mergeDeep(parameters, variant.parameters);\r\n\r\n        //apply base node parameters\r\n        mergeDeep(parameters, this.model.parameters);\r\n\r\n        //and then states, if any\r\n        if (this.currentVisualStates) {\r\n          const stateParameters = this.getParametersForStates(\r\n            this.currentVisualStates\r\n          );\r\n          mergeDeep(parameters, stateParameters);\r\n        }\r\n\r\n        const parametersToSet = Object.keys(parameters).filter(\r\n          (p) => !this._hasInputBeenSetFromAConnection(p)\r\n        );\r\n\r\n        for (const inputName of parametersToSet) {\r\n          this.registerInputIfNeeded(inputName);\r\n\r\n          if (this.hasInput(inputName)) {\r\n            this.queueInput(inputName, parameters[inputName]);\r\n          }\r\n        }\r\n      },\r\n      getParameter(name) {\r\n        if (this.model.parameters.hasOwnProperty(name)) {\r\n          return this.model.parameters[name];\r\n        } else if (\r\n          this.variant &&\r\n          this.variant.parameters.hasOwnProperty(name)\r\n        ) {\r\n          return this.variant.parameters[name];\r\n        } else {\r\n          return this.context.getDefaultValueForInput(this.model.type, name);\r\n        }\r\n      },\r\n      getParametersForStates(states) {\r\n        const params = {};\r\n\r\n        //1. Get the parameters from the variant\r\n        //2. Then override with all local values from the node's neutral state (so a color in neutral will override all states from the variant)\r\n        //3. then apply the node specific state parameters\r\n\r\n        //1. Apply variant states\r\n        if (this.variant) {\r\n          for (const state of states) {\r\n            if (\r\n              this.variant.stateParameters &&\r\n              this.variant.stateParameters.hasOwnProperty(state)\r\n            ) {\r\n              mergeDeep(params, this.variant.stateParameters[state]);\r\n            }\r\n          }\r\n        }\r\n\r\n        //2. Override with local values from the nodes neutral state\r\n        for (const param in params) {\r\n          if (this.model.parameters.hasOwnProperty(param)) {\r\n            if (isObject(params[param])) {\r\n              mergeDeep(params[param], this.model.parameters[param]);\r\n            } else {\r\n              params[param] = this.model.parameters[param];\r\n            }\r\n          }\r\n        }\r\n        // mergeDeep(params, this.model.parameters);\r\n\r\n        //3. Apply node specific state paramters\r\n        if (this.model.stateParameters) {\r\n          for (const state of states) {\r\n            if (this.model.stateParameters.hasOwnProperty(state)) {\r\n              mergeDeep(params, this.model.stateParameters[state]);\r\n            }\r\n          }\r\n        }\r\n\r\n        return params;\r\n      },\r\n      _getNewState(prevStates, newStates) {\r\n        const addedStates = newStates.filter(\r\n          (value) => !(prevStates || []).includes(value)\r\n        );\r\n        const newState = addedStates.length ? addedStates[0] : \"neutral\";\r\n\r\n        return newState === \"\" ? \"neutral\" : newState;\r\n      },\r\n      _getDefaultTransition(state) {\r\n        if (\r\n          this.model.defaultStateTransitions &&\r\n          this.model.defaultStateTransitions[state] &&\r\n          this.model.defaultStateTransitions[state].curve\r\n        ) {\r\n          return this.model.defaultStateTransitions[state];\r\n        } else if (\r\n          this.variant &&\r\n          this.variant.defaultStateTransitions &&\r\n          this.variant.defaultStateTransitions[state] &&\r\n          this.variant.defaultStateTransitions[state].curve\r\n        ) {\r\n          return this.variant.defaultStateTransitions[state];\r\n        }\r\n      },\r\n      _getStateTransition(state) {\r\n        let transitions = {};\r\n\r\n        if (this.model.stateTransitions && this.model.stateTransitions[state]) {\r\n          Object.assign(transitions, this.model.stateTransitions[state]);\r\n        }\r\n\r\n        if (\r\n          this.variant &&\r\n          this.variant.stateTransitions &&\r\n          this.variant.stateTransitions[state]\r\n        ) {\r\n          Object.assign(transitions, this.variant.stateTransitions[state]);\r\n        }\r\n\r\n        return transitions;\r\n      },\r\n      setVisualStates(newStates) {\r\n        if (!this.model) {\r\n          //this node has probably been generated by a router or similar, and is an internal node without a model\r\n          //those nodes can't have visual states\r\n          return;\r\n        }\r\n\r\n        const statesAreEqual =\r\n          this.currentVisualStates &&\r\n          newStates.length === this.currentVisualStates.length &&\r\n          newStates.every(\r\n            (val, index) => val === this.currentVisualStates[index]\r\n          );\r\n        if (statesAreEqual) return;\r\n\r\n        const prevStateParams = this.currentVisualStates\r\n          ? this.getParametersForStates(this.currentVisualStates)\r\n          : {};\r\n        const newStateParams = this.getParametersForStates(newStates);\r\n\r\n        const newState = this._getNewState(this.currentVisualStates, newStates);\r\n\r\n        this.currentVisualStates = newStates;\r\n\r\n        const newValues = {};\r\n\r\n        //all params that were in the old states, but not in the new states, needs to be reset back to original state\r\n        for (const param in prevStateParams) {\r\n          if (\r\n            !newStateParams.hasOwnProperty(param) &&\r\n            !this._hasInputBeenSetFromAConnection(param)\r\n          ) {\r\n            const value = this.getParameter(param);\r\n            if (value !== undefined) {\r\n              newValues[param] = this.getParameter(param);\r\n            }\r\n          }\r\n        }\r\n\r\n        for (const param in newStateParams) {\r\n          if (\r\n            !this._hasInputBeenSetFromAConnection(param) &&\r\n            newStateParams[param] !== undefined\r\n          ) {\r\n            newValues[param] = newStateParams[param];\r\n          }\r\n        }\r\n\r\n        const defaultTransition = this._getDefaultTransition(newState);\r\n        const stateTransition = this._getStateTransition(newState);\r\n\r\n        for (const param in newValues) {\r\n          if (stateTransition[param] && stateTransition[param].curve) {\r\n            transitionParameter(\r\n              this,\r\n              param,\r\n              newValues[param],\r\n              stateTransition[param]\r\n            );\r\n          } else if (!stateTransition[param] && defaultTransition) {\r\n            transitionParameter(\r\n              this,\r\n              param,\r\n              newValues[param],\r\n              defaultTransition\r\n            );\r\n          } else {\r\n            //stop any running transition\r\n            if (this._transitions && this._transitions[param]) {\r\n              this._transitions[param].stop();\r\n              delete this._transitions[param];\r\n            }\r\n\r\n            this.queueInput(param, newValues[param]);\r\n          }\r\n        }\r\n      },\r\n      _getVisualStates() {\r\n        return this.currentVisualStates || [];\r\n      },\r\n      _stopStateTransitions() {\r\n        if (!this._transitions) return;\r\n\r\n        for (const name in this._transitions) {\r\n          this._transitions[name].stop();\r\n          delete this._transitions[name];\r\n        }\r\n      },\r\n    },\r\n  };\r\n\r\n  if (useVariants) {\r\n    ReactComponentNode.inputs.variant = {\r\n      displayName: \"Variant\",\r\n      group: \"General\",\r\n      type: {\r\n        name: \"string\",\r\n        allowConnectionsOnly: true,\r\n      },\r\n      set(variantName) {\r\n        if (this.variant && this.variant.name === variantName) return;\r\n        const variant = this.context.variants.getVariant(\r\n          this.model.type,\r\n          variantName\r\n        );\r\n        variant && this.setVariant(variant);\r\n      },\r\n    };\r\n  }\r\n\r\n  if (def.mountedInput !== false) {\r\n    ReactComponentNode.inputs.mounted = {\r\n      displayName: \"Mounted\",\r\n      index: 9999,\r\n      type: \"boolean\",\r\n      group: \"General\",\r\n      default: true,\r\n      set(value) {\r\n        value = value ? true : false;\r\n        if (this.wantsToBeMounted !== value) {\r\n          this.wantsToBeMounted = value;\r\n          //either we have a direct parent, or we're a root and need to tell\r\n          //the parent of the component instance instead\r\n          const parent = this.getVisualParentNode();\r\n          if (parent) {\r\n            parent.cachedChildren = undefined;\r\n            parent.forceUpdate();\r\n          }\r\n        }\r\n      },\r\n    };\r\n  }\r\n\r\n  const hasChildCountOutput =\r\n    ReactComponentNode.allowChildren || ReactComponentNode.displayName;\r\n\r\n  if (hasChildCountOutput) {\r\n    ReactComponentNode.outputs.childrenCount = {\r\n      displayName: \"Children Count\",\r\n      type: \"number\",\r\n      get() {\r\n        return this.childrenCount;\r\n      },\r\n    };\r\n  }\r\n\r\n  //regular inputs\r\n  for (const name in inputs) {\r\n    ReactComponentNode.inputs[name] = inputs[name];\r\n  }\r\n\r\n  //inputs that set react props\r\n  for (const inputName in inputProps) {\r\n    const input = inputProps[inputName];\r\n    if (input.type === \"node\") {\r\n      input.type = \"reference\";\r\n      input.set = function (value) {\r\n        const props = input.propPath ? this.props[input.propPath] : this.props;\r\n        if (value !== undefined) {\r\n          props[inputName] = value.render();\r\n        } else {\r\n          delete props[inputName];\r\n        }\r\n        this.forceUpdate();\r\n      };\r\n    } else {\r\n      if (input.type === \"signal\") {\r\n        console.error(\r\n          `Error: Signals not supported as a react prop. node: '${def.name}' input: '${inputName}'`\r\n        );\r\n      } else {\r\n        defineRegularInputProp(input, inputName);\r\n      }\r\n    }\r\n\r\n    ReactComponentNode.inputs[inputName] = input;\r\n  }\r\n\r\n  //inputs that set a css attribute\r\n  for (const name in inputCss) {\r\n    const input = inputCss[name];\r\n    const styleTargetName = input.targetStyleProperty || name;\r\n\r\n    if (input.type.units) {\r\n      input.set = function (value) {\r\n        if (typeof value !== \"object\" && input.type.defaultUnit) {\r\n          value = { value, unit: input.type.defaultUnit };\r\n        }\r\n\r\n        if (typeof value === \"object\" && value.value !== undefined) {\r\n          //this is a value with a unit\r\n          this.setStyle(\r\n            { [styleTargetName]: value.value + value.unit },\r\n            input.styleTag\r\n          );\r\n        } else if (value !== undefined) {\r\n          //value without a unit. One example is line height, that can be unitless\r\n          this.setStyle({ [styleTargetName]: value }, input.styleTag);\r\n        } else {\r\n          //value is undefined, so just reset the style\r\n          this.removeStyle([styleTargetName], input.styleTag);\r\n        }\r\n        if (input.onChange) {\r\n          input.onChange.call(this, value);\r\n        }\r\n      };\r\n    } else {\r\n      input.set = function (value) {\r\n        if (value !== undefined) {\r\n          this.setStyle({ [styleTargetName]: value }, input.styleTag);\r\n        } else {\r\n          this.removeStyle([styleTargetName], input.styleTag);\r\n        }\r\n        if (input.onChange) {\r\n          input.onChange.call(this, value);\r\n        }\r\n      };\r\n    }\r\n\r\n    ReactComponentNode.inputs[name] = input;\r\n  }\r\n\r\n  //regular outputs\r\n  for (const name in outputs) {\r\n    ReactComponentNode.outputs[name] = outputs[name];\r\n  }\r\n\r\n  //outputs triggered by react props\r\n  for (const name in outputProps) {\r\n    const output = outputProps[name];\r\n\r\n    if (output.type !== \"signal\") {\r\n      output.get = function () {\r\n        return this.outputPropValues[name];\r\n      };\r\n    }\r\n\r\n    ReactComponentNode.outputs[name] = output;\r\n  }\r\n\r\n  for (const name in methods) {\r\n    ReactComponentNode.methods[name] = methods[name];\r\n  }\r\n\r\n  return {\r\n    node: ReactComponentNode,\r\n    setup: def.setup,\r\n  };\r\n}\r\n\r\nfunction isObject(item) {\r\n  return item && typeof item === \"object\" && !Array.isArray(item);\r\n}\r\n\r\nexport { createNodeFromReactComponent };\r\n","const pointerEvents = [\r\n  \"onClick\",\r\n  \"onMouseDown\",\r\n  \"onMouseMove\",\r\n  \"onMouseUp\",\r\n  \"onMouseEnter\",\r\n  \"onMouseLeave\",\r\n  \"onMouseOver\",\r\n  \"onMouseOut\",\r\n  \"onTouchStart\",\r\n  \"onTouchMove\",\r\n  \"onTouchEnd\",\r\n  \"onTouchCancel\",\r\n  \"onPointerDown\",\r\n  \"onPointerMove\",\r\n  \"onPointerUp\",\r\n  \"onPointerCancel\",\r\n];\r\n\r\n//These should not be blocked, it causes some annoying behaviour when using hover\r\nconst pointerEventsNotToBlock = new Set([\"onMouseLeave\", \"onMouseOut\"]);\r\n\r\nexport default function pointerProps(props) {\r\n  const newProps = {};\r\n\r\n  for (const eventName of pointerEvents) {\r\n    if (props.blockTouch && !pointerEventsNotToBlock.has(eventName)) {\r\n      //Noodl stores pointer event callbacks in props.pointer\r\n      if (props.pointer && props.pointer[eventName]) {\r\n        newProps[eventName] = (e) => {\r\n          props.pointer[eventName](e);\r\n          e.stopPropagation();\r\n        };\r\n      }\r\n      //some third party library might add pointer event callbacks as well, so look for callbacks directly on the props object\r\n      else if (props[eventName]) {\r\n        newProps[eventName] = (e) => {\r\n          props[eventName](e);\r\n          e.stopPropagation();\r\n        };\r\n      } else {\r\n        //there was no existing listener, so create a new one that just blocks\r\n        newProps[eventName] = (e) => {\r\n          e.stopPropagation();\r\n        };\r\n      }\r\n    }\r\n    //check if third party code added a listener\r\n    else if (props[eventName]) {\r\n      newProps[eventName] = props[eventName];\r\n    }\r\n    //check if Noodl added a listener\r\n    else if (props.pointer) {\r\n      newProps[eventName] = props.pointer[eventName];\r\n    }\r\n  }\r\n\r\n  if (props.noodlNode) {\r\n    for (const p in newProps) {\r\n      const f = newProps[p];\r\n      if (f) {\r\n        newProps[p] = (e) => {\r\n          // @ts-expect-error\r\n          f.call(this, e);\r\n          props.noodlNode.context.updateDirtyNodes();\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  return newProps;\r\n}\r\n","import PointerListeners from \"../../pointerlisteners\";\r\n\r\nfunction _shallowCompare(o1, o2) {\r\n  let p;\r\n  for (p in o1) {\r\n    if (o1.hasOwnProperty(p)) {\r\n      if (o1[p] !== o2[p]) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  for (p in o2) {\r\n    if (o2.hasOwnProperty(p)) {\r\n      if (o1[p] !== o2[p]) {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nconst _styleSheets = {};\r\n\r\nfunction updateStylesForClass(_class, props, _styleTemplate) {\r\n  if (_styleSheets[_class]) {\r\n    // Check if props have changed\r\n    if (!_shallowCompare(props, _styleSheets[_class].props)) {\r\n      _styleSheets[_class].style.innerHTML = _styleTemplate(_class, props);\r\n      _styleSheets[_class].props = Object.assign({}, props);\r\n    }\r\n  } else {\r\n    // Create a new style sheet if none exists\r\n    const style = document.createElement(\"style\");\r\n    style.innerHTML = _styleTemplate(_class, props);\r\n    document.head.appendChild(style);\r\n\r\n    _styleSheets[_class] = { style, props: Object.assign({}, props) };\r\n  }\r\n}\r\n\r\nfunction mergeAttribute(definition, attribute, values) {\r\n  if (!definition[attribute]) {\r\n    definition[attribute] = {};\r\n  }\r\n\r\n  for (const name in values) {\r\n    definition[attribute][name] = values[name];\r\n  }\r\n}\r\n\r\nfunction addInputs(definition, values) {\r\n  mergeAttribute(definition, \"inputs\", values);\r\n}\r\n\r\nfunction addInputProps(definition, values) {\r\n  mergeAttribute(definition, \"inputProps\", values);\r\n}\r\n\r\nfunction addOutputProps(definition, values) {\r\n  mergeAttribute(definition, \"outputProps\", values);\r\n}\r\n\r\nfunction addOutputs(definition, values) {\r\n  mergeAttribute(definition, \"outputs\", values);\r\n}\r\n\r\nfunction addControlEventsAndStates(definition, args?) {\r\n  args = args || {};\r\n\r\n  definition.visualStates = [\r\n    { name: \"neutral\", label: \"Neutral\" },\r\n    { name: \"hover\", label: \"Hover\" },\r\n    { name: \"pressed\", label: \"Pressed\" },\r\n    { name: \"focused\", label: \"Focused\" },\r\n    { name: \"disabled\", label: \"Disabled\" },\r\n  ];\r\n\r\n  if (args.checked) {\r\n    definition.visualStates.splice(3, 0, { name: \"checked\", label: \"Checked\" });\r\n  }\r\n\r\n  addInputs(definition, {\r\n    enabled: {\r\n      type: \"boolean\",\r\n      displayName: \"Enabled\",\r\n      group: \"General\",\r\n      default: true,\r\n      set: function (value) {\r\n        value = !!value;\r\n        // @ts-expect-error\r\n        const changed = value !== this._internal.enabled;\r\n        // @ts-expect-error\r\n        this.props.enabled = this._internal.enabled = value;\r\n\r\n        if (changed) {\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n          // @ts-expect-error\r\n          this.forceUpdate();\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"enabled\");\r\n        }\r\n      },\r\n    },\r\n  });\r\n\r\n  addInputProps(definition, {\r\n    blockTouch: {\r\n      index: 450,\r\n      displayName: \"Block Pointer Events\",\r\n      type: \"boolean\",\r\n      group: \"Pointer Events\",\r\n    },\r\n  });\r\n\r\n  definition.methods._updateVisualState = function () {\r\n    const states = [];\r\n\r\n    //make sure they are in the order they should be applied\r\n    if (this._internal.enabled) {\r\n      // @ts-expect-error\r\n      if (this.outputPropValues.hoverState) states.push(\"hover\");\r\n      // @ts-expect-error\r\n      if (this.outputPropValues.pressedState) states.push(\"pressed\");\r\n      // @ts-expect-error\r\n      if (this.outputPropValues.focusState) states.push(\"focused\");\r\n    }\r\n\r\n    // @ts-expect-error\r\n    if (args.checked && this._internal.checked) states.push(\"checked\");\r\n    // @ts-expect-error\r\n    if (!this._internal.enabled) states.push(\"disabled\");\r\n\r\n    this.setVisualStates(states);\r\n  };\r\n\r\n  addOutputProps(definition, {\r\n    // Focus\r\n    focusState: {\r\n      displayName: \"Focused\",\r\n      group: \"States\",\r\n      type: \"boolean\",\r\n      props: {\r\n        onFocus() {\r\n          // @ts-expect-error\r\n          this.outputPropValues.focusState = true;\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"focusState\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        },\r\n        onBlur() {\r\n          // @ts-expect-error\r\n          this.outputPropValues.focusState = false;\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"focusState\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        },\r\n      },\r\n    },\r\n    onFocus: {\r\n      displayName: \"Focused\",\r\n      group: \"Focus Events\",\r\n      type: \"signal\",\r\n      props: {\r\n        onFocus() {\r\n          // @ts-expect-error\r\n          this.sendSignalOnOutput(\"onFocus\");\r\n        },\r\n      },\r\n    },\r\n    onBlur: {\r\n      displayName: \"Blurred\",\r\n      group: \"Focus Events\",\r\n      type: \"signal\",\r\n      props: {\r\n        onBlur() {\r\n          // @ts-expect-error\r\n          this.sendSignalOnOutput(\"onBlur\");\r\n        },\r\n      },\r\n    },\r\n\r\n    // Hover\r\n    hoverState: {\r\n      displayName: \"Hover\",\r\n      group: \"States\",\r\n      type: \"boolean\",\r\n      props: {\r\n        onMouseOver() {\r\n          // @ts-expect-error\r\n          this.outputPropValues.hoverState = true;\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"hoverState\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        },\r\n        onMouseLeave() {\r\n          // @ts-expect-error\r\n          this.outputPropValues.hoverState = false;\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"hoverState\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        },\r\n      },\r\n    },\r\n    hoverStart: {\r\n      displayName: \"Hover Start\",\r\n      group: \"Pointer Events\",\r\n      type: \"signal\",\r\n      props: {\r\n        onMouseOver() {\r\n          // @ts-expect-error\r\n          this.sendSignalOnOutput(\"hoverStart\");\r\n        },\r\n      },\r\n    },\r\n    hoverEnd: {\r\n      displayName: \"Hover End\",\r\n      group: \"Pointer Events\",\r\n      type: \"signal\",\r\n      props: {\r\n        onMouseLeave() {\r\n          // @ts-expect-error\r\n          this.sendSignalOnOutput(\"hoverEnd\");\r\n        },\r\n      },\r\n    },\r\n\r\n    // Pressed\r\n    pressedState: {\r\n      displayName: \"Pressed\",\r\n      group: \"States\",\r\n      type: \"boolean\",\r\n      props: {\r\n        onMouseDown() {\r\n          // @ts-expect-error\r\n          this.outputPropValues.pressedState = true;\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"pressedState\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        },\r\n        onTouchStart() {\r\n          // @ts-expect-error\r\n          this.outputPropValues.pressedState = true;\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"pressedState\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        },\r\n        onMouseUp() {\r\n          // @ts-expect-error\r\n          this.outputPropValues.pressedState = false;\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"pressedState\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        },\r\n        onTouchEnd() {\r\n          // @ts-expect-error\r\n          this.outputPropValues.pressedState = false;\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"pressedState\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        },\r\n        onTouchCancel() {\r\n          // @ts-expect-error\r\n          this.outputPropValues.pressedState = false;\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"pressedState\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        },\r\n        onMouseLeave() {\r\n          // @ts-expect-error\r\n          this.outputPropValues.pressedState = false;\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"pressedState\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        },\r\n      },\r\n    },\r\n    pointerDown: {\r\n      displayName: \"Pointer Down\",\r\n      group: \"Pointer Events\",\r\n      type: \"signal\",\r\n      props: {\r\n        onMouseDown() {\r\n          // @ts-expect-error\r\n          this.sendSignalOnOutput(\"pointerDown\");\r\n        },\r\n        onTouchStart() {\r\n          // @ts-expect-error\r\n          this.sendSignalOnOutput(\"pointerDown\");\r\n        },\r\n      },\r\n    },\r\n    pointerUp: {\r\n      displayName: \"Pointer Up\",\r\n      group: \"Pointer Events\",\r\n      type: \"signal\",\r\n      props: {\r\n        onMouseUp() {\r\n          // @ts-expect-error\r\n          this.sendSignalOnOutput(\"pointerUp\");\r\n        },\r\n        onTouchEnd() {\r\n          // @ts-expect-error\r\n          this.sendSignalOnOutput(\"pointerUp\");\r\n        },\r\n        onTouchCancel() {\r\n          // @ts-expect-error\r\n          this.sendSignalOnOutput(\"pointerUp\");\r\n        },\r\n      },\r\n    },\r\n  });\r\n\r\n  addOutputs(definition, {\r\n    enabled: {\r\n      type: \"boolean\",\r\n      displayName: \"Enabled\",\r\n      group: \"States\",\r\n      getter: function () {\r\n        // @ts-expect-error\r\n        return this._internal.enabled;\r\n      },\r\n    },\r\n  });\r\n\r\n  const oldInit = definition.initialize;\r\n  definition.initialize = function () {\r\n    oldInit && oldInit.call(this);\r\n    this.props.enabled = this._internal.enabled = true;\r\n    this.outputPropValues.hoverState =\r\n      this.outputPropValues.focusState =\r\n      this.outputPropValues.pressedState =\r\n        false;\r\n  };\r\n}\r\n\r\nfunction controlEvents(props) {\r\n  return Object.assign(\r\n    {},\r\n    {\r\n      onFocus: props.onFocus,\r\n      onBlur: props.onBlur,\r\n    },\r\n    PointerListeners(props)\r\n  );\r\n}\r\n\r\nexport default {\r\n  updateStylesForClass,\r\n  addControlEventsAndStates,\r\n  controlEvents,\r\n};\r\n","import React from \"react\";\r\n\r\nimport Layout from \"../../../layout\";\r\nimport Utils from \"../../../nodes/controls/utils\";\r\nimport { Noodl, Slot } from \"../../../types\";\r\n\r\nexport interface ButtonProps extends Noodl.ReactProps {\r\n  enabled: boolean;\r\n  buttonType: \"button\" | \"submit\";\r\n\r\n  attrs: React.Attributes;\r\n\r\n  textStyle: Noodl.TextStyle;\r\n\r\n  useLabel: boolean;\r\n  label: string;\r\n  labelSpacing: string;\r\n  labeltextStyle: Noodl.TextStyle;\r\n\r\n  useIcon: boolean;\r\n  iconPlacement: \"left\" | \"right\";\r\n  iconSpacing: string;\r\n  iconSourceType: \"image\" | \"icon\";\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n\r\n  onClick: () => void;\r\n\r\n  children: Slot;\r\n}\r\n\r\nexport function Button(props: ButtonProps) {\r\n  let style: React.CSSProperties = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (props.textStyle !== undefined) {\r\n    // Apply text style\r\n    style = Object.assign({}, props.textStyle, style);\r\n    style.color = props.noodlNode.context.styles.resolveColor(style.color);\r\n  }\r\n\r\n  function _renderIcon() {\r\n    const iconStyle: React.CSSProperties = {};\r\n\r\n    if (props.useLabel) {\r\n      if (props.iconPlacement === \"left\" || props.iconPlacement === undefined) {\r\n        iconStyle.marginRight = props.iconSpacing;\r\n      } else {\r\n        iconStyle.marginLeft = props.iconSpacing;\r\n      }\r\n    }\r\n\r\n    if (\r\n      props.iconSourceType === \"image\" &&\r\n      props.iconImageSource !== undefined\r\n    ) {\r\n      iconStyle.width = props.iconSize;\r\n      iconStyle.height = props.iconSize;\r\n      return <img alt=\"\" src={props.iconImageSource} style={iconStyle} />;\r\n    } else if (\r\n      props.iconSourceType === \"icon\" &&\r\n      props.iconIconSource !== undefined\r\n    ) {\r\n      iconStyle.fontSize = props.iconSize;\r\n      iconStyle.color = props.iconColor;\r\n\r\n      if (props.iconIconSource.codeAsClass === true) {\r\n        return (\r\n          <span\r\n            className={[\r\n              props.iconIconSource.class,\r\n              props.iconIconSource.code,\r\n            ].join(\" \")}\r\n            style={iconStyle}\r\n          ></span>\r\n        );\r\n      } else {\r\n        return (\r\n          <span className={props.iconIconSource.class} style={iconStyle}>\r\n            {props.iconIconSource.code}\r\n          </span>\r\n        );\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  let className = \"ndl-controls-button\";\r\n  if (props.className) className = className + \" \" + props.className;\r\n\r\n  let content: React.ReactNode = null;\r\n\r\n  if (props.useLabel && props.useIcon) {\r\n    content = (\r\n      <>\r\n        {props.iconPlacement === \"left\" ? _renderIcon() : null}\r\n        {String(props.label)}\r\n        {props.iconPlacement === \"right\" ? _renderIcon() : null}\r\n      </>\r\n    );\r\n  } else if (props.useLabel) {\r\n    content = String(props.label);\r\n  } else if (props.useIcon) {\r\n    content = _renderIcon();\r\n  }\r\n\r\n  return (\r\n    <button\r\n      {...props.attrs}\r\n      className={className}\r\n      disabled={!props.enabled}\r\n      {...Utils.controlEvents(props)}\r\n      type={props.buttonType}\r\n      style={style}\r\n      onClick={props.onClick}\r\n    >\r\n      {content}\r\n      {props.children}\r\n    </button>\r\n  );\r\n}\r\n","import { Button } from \"../../components/controls/Button\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\nimport Utils from \"./utils\";\r\nimport { ReactNodeDefinition } from \"../../ReactNodeDefinition\";\r\n\r\nconst ButtonNode: ReactNodeDefinition = {\r\n  name: \"net.noodl.controls.button\",\r\n  displayName: \"Button\",\r\n  docs: \"https://docs.noodl.net/nodes/ui-controls/button\",\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  usePortAsLabel: \"label\",\r\n  portLabelTruncationMode: \"length\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"label\",\r\n  },\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      \"General\",\r\n      \"Style\",\r\n      \"Actions\",\r\n      \"Events\",\r\n      \"States\",\r\n      \"Mounted\",\r\n      \"Label\",\r\n      \"Label Text Style\",\r\n      \"Hover Events\",\r\n      \"Pointer Events\",\r\n      \"Focus Events\",\r\n    ],\r\n  },\r\n  initialize() {\r\n    // @ts-expect-error\r\n    this.props.attrs = {};\r\n    // @ts-expect-error\r\n    this.props.layout = \"row\"; //Used to tell child nodes what layout to expect\r\n  },\r\n  // @ts-expect-error\r\n  getReactComponent() {\r\n    return Button;\r\n  },\r\n  inputs: {\r\n    testId: {\r\n      index: 100009,\r\n      displayName: \"Test ID Attribute\",\r\n      group: \"Advanced HTML\",\r\n      type: \"string\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 100,\r\n      displayName: \"Background Color\",\r\n      group: \"Style\",\r\n      type: \"color\",\r\n      default: \"#000000\",\r\n      allowVisualStates: true,\r\n    },\r\n  },\r\n  outputProps: {\r\n    onClick: {\r\n      displayName: \"Click\",\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n    },\r\n  },\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(ButtonNode, {\r\n  defaultSizeMode: \"contentSize\",\r\n  contentLabel: \"Content\",\r\n});\r\nNodeSharedPortDefinitions.addTextStyleInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addAlignInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addTransformInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(ButtonNode, {\r\n  defaults: {\r\n    paddingTop: 5,\r\n    paddingRight: 20,\r\n    paddingBottom: 5,\r\n    paddingLeft: 20,\r\n  },\r\n});\r\nNodeSharedPortDefinitions.addMarginInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addLabelInputs(ButtonNode, {\r\n  defaults: { useLabel: true },\r\n});\r\nNodeSharedPortDefinitions.addIconInputs(ButtonNode, {\r\n  enableIconPlacement: true,\r\n  defaults: { useIcon: false },\r\n});\r\nNodeSharedPortDefinitions.addSharedVisualInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addBorderInputs(ButtonNode);\r\nNodeSharedPortDefinitions.addShadowInputs(ButtonNode);\r\n\r\nUtils.addControlEventsAndStates(ButtonNode);\r\n\r\nexport default createNodeFromReactComponent(ButtonNode);\r\n","import React, { useEffect, useState } from \"react\";\r\n\r\nimport Layout from \"../../../layout\";\r\nimport Utils from \"../../../nodes/controls/utils\";\r\nimport { Noodl } from \"../../../types\";\r\n\r\nexport interface CheckboxProps extends Noodl.ReactProps {\r\n  id: string;\r\n  enabled: boolean;\r\n  checked: boolean;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  useLabel: boolean;\r\n  label: string;\r\n  labelSpacing: string;\r\n  labeltextStyle: Noodl.TextStyle;\r\n\r\n  useIcon: boolean;\r\n  iconPlacement: \"left\" | \"right\";\r\n  iconSpacing: string;\r\n  iconSourceType: \"image\" | \"icon\";\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n\r\n  checkedChanged: (checked: boolean) => void;\r\n}\r\n\r\nexport function Checkbox(props: CheckboxProps) {\r\n  const [checked, setChecked] = useState(props.checked);\r\n\r\n  // Report initial values when mounted\r\n  useEffect(() => {\r\n    setChecked(!!props.checked);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setChecked(!!props.checked);\r\n  }, [props.checked]);\r\n\r\n  const style: React.CSSProperties = { ...props.style };\r\n\r\n  if (props.parentLayout === \"none\") {\r\n    style.position = \"absolute\";\r\n  }\r\n\r\n  Layout.align(style, props);\r\n\r\n  const inputProps = {\r\n    ...props.attrs,\r\n    id: props.id,\r\n    className: [props.className, \"ndl-controls-checkbox-2\"].join(\" \"),\r\n    disabled: !props.enabled,\r\n    style: {\r\n      width: props.styles.checkbox.width,\r\n      height: props.styles.checkbox.height,\r\n    },\r\n  };\r\n\r\n  const inputWrapperStyle: React.CSSProperties = {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    flexShrink: 0,\r\n    position: \"relative\",\r\n    ...props.styles.checkbox,\r\n  };\r\n\r\n  if (!props.useLabel) {\r\n    Object.assign(inputProps, Utils.controlEvents(props));\r\n    Object.assign(inputWrapperStyle, style);\r\n  }\r\n\r\n  function _renderIcon() {\r\n    if (props.iconSourceType === \"image\" && props.iconImageSource !== undefined)\r\n      return (\r\n        <img\r\n          alt=\"\"\r\n          src={props.iconImageSource}\r\n          style={{\r\n            width: props.iconSize,\r\n            height: props.iconSize,\r\n            position: \"absolute\",\r\n          }}\r\n        />\r\n      );\r\n    else if (\r\n      props.iconSourceType === \"icon\" &&\r\n      props.iconIconSource !== undefined\r\n    ) {\r\n      const style: React.CSSProperties = {\r\n        fontSize: props.iconSize,\r\n        color: props.iconColor,\r\n        position: \"absolute\",\r\n      };\r\n\r\n      if (props.iconIconSource.codeAsClass === true) {\r\n        return (\r\n          <span\r\n            className={[\r\n              props.iconIconSource.class,\r\n              props.iconIconSource.code,\r\n            ].join(\" \")}\r\n            style={style}\r\n          ></span>\r\n        );\r\n      } else {\r\n        return (\r\n          <span className={props.iconIconSource.class} style={style}>\r\n            {props.iconIconSource.code}\r\n          </span>\r\n        );\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  const checkbox = (\r\n    <div\r\n      className=\"ndl-controls-pointer\"\r\n      style={inputWrapperStyle}\r\n      noodl-style-tag=\"checkbox\"\r\n    >\r\n      {props.useIcon ? _renderIcon() : null}\r\n      <input\r\n        type=\"checkbox\"\r\n        {...inputProps}\r\n        checked={checked}\r\n        onChange={(e) => {\r\n          setChecked(e.target.checked);\r\n          props.checkedChanged && props.checkedChanged(e.target.checked);\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  if (props.useLabel) {\r\n    const labelStyle: React.CSSProperties = {\r\n      marginLeft: props.labelSpacing,\r\n      ...props.labeltextStyle,\r\n      ...props.styles.label,\r\n    };\r\n\r\n    if (!props.enabled) {\r\n      labelStyle.cursor = \"default\";\r\n    }\r\n\r\n    labelStyle.color = props.noodlNode.context.styles.resolveColor(\r\n      labelStyle.color\r\n    );\r\n\r\n    return (\r\n      <div\r\n        style={{ display: \"flex\", alignItems: \"center\", ...style }}\r\n        {...Utils.controlEvents(props)}\r\n      >\r\n        {checkbox}\r\n        <label\r\n          className=\"ndl-controls-pointer\"\r\n          style={labelStyle}\r\n          htmlFor={props.id}\r\n          noodl-style-tag=\"label\"\r\n        >\r\n          {props.label}\r\n        </label>\r\n      </div>\r\n    );\r\n  } else {\r\n    return checkbox;\r\n  }\r\n}\r\n","import { guid } from \"@fluxscape/runtime\";\r\nimport { Checkbox } from \"../../components/controls/Checkbox\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\nimport Utils from \"./utils\";\r\n\r\nconst CheckBoxNode = {\r\n  name: \"net.noodl.controls.checkbox\",\r\n  displayName: \"Checkbox\",\r\n  docs: \"https://docs.noodl.net/nodes/ui-controls/checkbox\",\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"label\",\r\n  },\r\n  usePortAsLabel: \"label\",\r\n  portLabelTruncationMode: \"length\",\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      \"General\",\r\n      \"Style\",\r\n      \"Actions\",\r\n      \"Events\",\r\n      \"States\",\r\n      \"Mounted\",\r\n      \"Label\",\r\n      \"Label Text Style\",\r\n      \"Hover Events\",\r\n      \"Pointer Events\",\r\n      \"Focus Events\",\r\n    ],\r\n  },\r\n  initialize() {\r\n    // @ts-expect-error\r\n    this.props.attrs = {};\r\n    // @ts-expect-error\r\n    this.props.sizeMode = \"explicit\";\r\n    // @ts-expect-error\r\n    this.props.id = \"input-\" + guid();\r\n    // @ts-expect-error\r\n    this.props.checked = this._internal.checked = false;\r\n\r\n    // @ts-expect-error\r\n    this.props.checkedChanged = (checked) => {\r\n      // @ts-expect-error\r\n      const changed = this._internal.checked !== checked;\r\n      // @ts-expect-error\r\n      this._internal.checked = checked;\r\n      if (changed) {\r\n        // @ts-expect-error\r\n        this.flagOutputDirty(\"checked\");\r\n        // @ts-expect-error\r\n        this.sendSignalOnOutput(\"onChange\");\r\n        // @ts-expect-error\r\n        this._updateVisualState();\r\n      }\r\n    };\r\n  },\r\n  getReactComponent() {\r\n    return Checkbox;\r\n  },\r\n  inputs: {\r\n    checked: {\r\n      type: \"boolean\",\r\n      displayName: \"Checked\",\r\n      group: \"General\",\r\n      default: false,\r\n      index: 100,\r\n      set: function (value) {\r\n        value = !!value;\r\n        // @ts-expect-error\r\n        const changed = value !== this._internal.checked;\r\n        // @ts-expect-error\r\n        this.props.checked = this._internal.checked = value;\r\n\r\n        if (changed) {\r\n          // @ts-expect-error\r\n          this.forceUpdate();\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"checked\");\r\n          // @ts-expect-error\r\n          this._updateVisualState();\r\n        }\r\n      },\r\n    },\r\n    check: {\r\n      type: \"signal\",\r\n      displayName: \"Check\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        if (this._internal.checked === true) return;\r\n\r\n        // @ts-expect-error\r\n        this.props.checked = this._internal.checked = true;\r\n\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n        // @ts-expect-error\r\n        this.flagOutputDirty(\"checked\");\r\n        // @ts-expect-error\r\n        this._updateVisualState();\r\n      },\r\n    },\r\n    uncheck: {\r\n      type: \"signal\",\r\n      displayName: \"Uncheck\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        if (this._internal.checked === false) return;\r\n\r\n        // @ts-expect-error\r\n        this.props.checked = this._internal.checked = false;\r\n\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n        // @ts-expect-error\r\n        this.flagOutputDirty(\"checked\");\r\n        // @ts-expect-error\r\n        this._updateVisualState();\r\n      },\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: \"Test ID Attribute\",\r\n      group: \"Advanced HTML\",\r\n      type: \"string\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 201,\r\n      displayName: \"Background Color\",\r\n      group: \"Style\",\r\n      type: \"color\",\r\n      default: \"transparent\",\r\n      applyDefault: false,\r\n      allowVisualStates: true,\r\n      styleTag: \"checkbox\",\r\n    },\r\n    width: {\r\n      index: 11,\r\n      group: \"Dimensions\",\r\n      displayName: \"Width\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\", \"vw\", \"vh\"],\r\n        defaultUnit: \"px\",\r\n      },\r\n      default: 32,\r\n      allowVisualStates: true,\r\n      styleTag: \"checkbox\",\r\n    },\r\n    height: {\r\n      index: 12,\r\n      group: \"Dimensions\",\r\n      displayName: \"Height\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\", \"vw\", \"vh\"],\r\n        defaultUnit: \"px\",\r\n      },\r\n      default: 32,\r\n      allowVisualStates: true,\r\n      styleTag: \"checkbox\",\r\n    },\r\n  },\r\n  outputs: {\r\n    checked: {\r\n      type: \"boolean\",\r\n      displayName: \"Checked\",\r\n      group: \"States\",\r\n      getter: function () {\r\n        // @ts-expect-error\r\n        return this._internal.checked;\r\n      },\r\n    },\r\n    onChange: {\r\n      displayName: \"Changed\",\r\n      group: \"Events\",\r\n      type: \"signal\",\r\n    },\r\n  },\r\n};\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addTransformInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addMarginInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addIconInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addLabelInputs(CheckBoxNode, {\r\n  enableSpacing: true,\r\n  styleTag: \"label\",\r\n});\r\nNodeSharedPortDefinitions.addSharedVisualInputs(CheckBoxNode);\r\nNodeSharedPortDefinitions.addBorderInputs(CheckBoxNode, {\r\n  defaults: {\r\n    borderStyle: \"solid\",\r\n    borderWidth: 2,\r\n    borderColor: \"#000000\",\r\n    borderRadius: 3,\r\n  },\r\n  styleTag: \"checkbox\",\r\n});\r\nNodeSharedPortDefinitions.addShadowInputs(CheckBoxNode, {\r\n  styleTag: \"checkbox\",\r\n});\r\nUtils.addControlEventsAndStates(CheckBoxNode, { checked: true });\r\n\r\nexport default createNodeFromReactComponent(CheckBoxNode);\r\n","import React, { useEffect, useState } from \"react\";\r\n\r\nimport type { TSFixme } from \"../../../../typings/global\";\r\nimport Layout from \"../../../layout\";\r\nimport Utils from \"../../../nodes/controls/utils\";\r\nimport { Noodl } from \"../../../types\";\r\n\r\nexport interface SelectProps extends Noodl.ReactProps {\r\n  id: string;\r\n  value: string;\r\n  enabled: boolean;\r\n  textStyle: Noodl.TextStyle;\r\n  items: TSFixme;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  placeholder: string;\r\n  placeholderOpacity: string;\r\n\r\n  useIcon: boolean;\r\n  iconPlacement: \"left\" | \"right\";\r\n  iconSpacing: string;\r\n  iconSourceType: \"image\" | \"icon\";\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n\r\n  useLabel: boolean;\r\n  label: string;\r\n  labelSpacing: string;\r\n  labeltextStyle: Noodl.TextStyle;\r\n\r\n  onClick: () => void;\r\n  valueChanged: (value: string) => void;\r\n}\r\n\r\nexport function Select(props: SelectProps) {\r\n  const [value, setValue] = useState(props.value);\r\n\r\n  useEffect(() => {\r\n    setValue(props.value);\r\n    props.valueChanged(props.value);\r\n  }, [props.value, props.items]);\r\n\r\n  let style = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (props.textStyle !== undefined) {\r\n    // Apply text style\r\n    style = Object.assign({}, props.textStyle, style);\r\n    style.color = props.noodlNode.context.styles.resolveColor(style.color);\r\n  }\r\n\r\n  // Hide label if there is no selected value, of if value is not in the items array\r\n  const selectedIndex =\r\n    !props.items || value === undefined\r\n      ? -1\r\n      : props.items.findIndex((i) => i.Value === value);\r\n\r\n  const { height, ...otherStyles } = style;\r\n\r\n  function _renderIcon() {\r\n    if (props.iconSourceType === \"image\" && props.iconImageSource !== undefined)\r\n      return (\r\n        <img\r\n          alt=\"\"\r\n          src={props.iconImageSource}\r\n          style={{ width: props.iconSize, height: props.iconSize }}\r\n        ></img>\r\n      );\r\n    else if (\r\n      props.iconSourceType === \"icon\" &&\r\n      props.iconIconSource !== undefined\r\n    ) {\r\n      const style: React.CSSProperties = {\r\n        fontSize: props.iconSize,\r\n        color: props.iconColor,\r\n      };\r\n      if (props.iconPlacement === \"left\" || props.iconPlacement === undefined)\r\n        style.marginRight = props.iconSpacing;\r\n      else style.marginLeft = props.iconSpacing;\r\n\r\n      if (props.iconIconSource.codeAsClass === true) {\r\n        return (\r\n          <span\r\n            className={[\r\n              props.iconIconSource.class,\r\n              props.iconIconSource.code,\r\n            ].join(\" \")}\r\n            style={style}\r\n          ></span>\r\n        );\r\n      } else {\r\n        return (\r\n          <span className={props.iconIconSource.class} style={style}>\r\n            {props.iconIconSource.code}\r\n          </span>\r\n        );\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  const inputProps: React.SelectHTMLAttributes<HTMLSelectElement> = {\r\n    ...props.attrs,\r\n    id: props.id,\r\n    className: props.className,\r\n    style: {\r\n      inset: 0,\r\n      opacity: 0,\r\n      position: \"absolute\" as React.CSSProperties[\"position\"],\r\n      textTransform: \"inherit\",\r\n      cursor: props.enabled ? \"\" : \"default\",\r\n      // @ts-ignore\r\n      \"-webkit-appearance\": \"none\",\r\n    },\r\n    onClick: props.onClick,\r\n  };\r\n\r\n  const inputWrapperStyle = {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    ...props.styles.inputWrapper,\r\n    cursor: props.enabled ? \"\" : \"default\",\r\n  };\r\n\r\n  const heightInPercent = height && height[String(height).length - 1] === \"%\";\r\n\r\n  if (props.useLabel) {\r\n    if (heightInPercent) {\r\n      inputWrapperStyle.flexGrow = 1;\r\n    } else {\r\n      inputWrapperStyle.height = height;\r\n    }\r\n  } else {\r\n    Object.assign(inputWrapperStyle, otherStyles);\r\n    inputWrapperStyle.height = height;\r\n  }\r\n\r\n  let options: JSX.Element[] = [];\r\n\r\n  if (props.items) {\r\n    options = props.items.map((i) => (\r\n      <option\r\n        key={i.Value}\r\n        value={i.Value}\r\n        disabled={\r\n          i.Disabled === \"true\" || i.Disabled === true ? true : undefined\r\n        }\r\n      >\r\n        {i.Label}\r\n      </option>\r\n    ));\r\n    // options.unshift();\r\n  }\r\n\r\n  let label: React.ReactNode | null = null;\r\n\r\n  if (selectedIndex >= 0 && selectedIndex < props.items.length) {\r\n    label = <span>{props.items[selectedIndex].Label}</span>;\r\n  } else if (props.placeholder) {\r\n    label = (\r\n      <span style={{ opacity: props.placeholderOpacity }}>\r\n        {props.placeholder}\r\n      </span>\r\n    );\r\n  }\r\n\r\n  //A hidden first option is preselected and added to the list of options, it makes it possible to select the first item in the dropdown\r\n  const inputWrapper = (\r\n    <div\r\n      className=\"ndl-controls-pointer\"\r\n      style={inputWrapperStyle}\r\n      noodl-style-tag=\"inputWrapper\"\r\n    >\r\n      {props.useIcon && props.iconPlacement === \"left\" ? _renderIcon() : null}\r\n      <div\r\n        style={{\r\n          width: \"100%\",\r\n          height: \"100%\",\r\n          alignItems: \"center\",\r\n          display: \"flex\",\r\n        }}\r\n      >\r\n        {label}\r\n      </div>\r\n      {props.useIcon && props.iconPlacement === \"right\" ? _renderIcon() : null}\r\n      <select\r\n        {...inputProps}\r\n        disabled={!props.enabled}\r\n        value={options.find((i) => i.props.value === value) ? value : undefined}\r\n        {...Utils.controlEvents(props)}\r\n        onChange={(e) => {\r\n          setValue(e.target.value);\r\n          props.valueChanged && props.valueChanged(e.target.value);\r\n        }}\r\n      >\r\n        <option value=\"\" disabled selected hidden />\r\n        {options}\r\n      </select>\r\n    </div>\r\n  );\r\n\r\n  if (props.useLabel) {\r\n    const outerWrapperStyle: React.CSSProperties = {\r\n      ...otherStyles,\r\n      display: \"flex\",\r\n      flexDirection: \"column\",\r\n    };\r\n\r\n    if (heightInPercent) {\r\n      outerWrapperStyle.height = height;\r\n    }\r\n\r\n    return (\r\n      <div style={outerWrapperStyle}>\r\n        <label\r\n          htmlFor={props.id}\r\n          style={{\r\n            ...props.labeltextStyle,\r\n            ...props.styles.label,\r\n            marginBottom: props.labelSpacing,\r\n          }}\r\n          noodl-style-tag=\"label\"\r\n        >\r\n          {props.label}\r\n        </label>\r\n        {inputWrapper}\r\n      </div>\r\n    );\r\n  } else {\r\n    return inputWrapper;\r\n  }\r\n}\r\n","import { Select } from \"../../components/controls/Select\";\r\nimport { guid } from \"@fluxscape/runtime\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\nimport Utils from \"./utils\";\r\n\r\nconst OptionsNode = {\r\n  name: \"net.noodl.controls.options\",\r\n  displayName: \"Dropdown\",\r\n  docs: \"https://docs.noodl.net/nodes/ui-controls/dropdown\",\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  usePortAsLabel: \"label\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"label\",\r\n  },\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      \"General\",\r\n      \"Style\",\r\n      \"Actions\",\r\n      \"Events\",\r\n      \"States\",\r\n      \"Mounted\",\r\n      \"Text Style\",\r\n      \"Label\",\r\n      \"Label Text Style\",\r\n      \"Hover Events\",\r\n      \"Pointer Events\",\r\n      \"Focus Events\",\r\n    ],\r\n  },\r\n  initialize() {\r\n    // @ts-expect-error\r\n    this.props.attrs = {};\r\n    // @ts-expect-error\r\n    this._itemsChanged = () => {\r\n      // @ts-expect-error\r\n      this.forceUpdate();\r\n    };\r\n\r\n    // @ts-expect-error\r\n    this.props.id = \"input-\" + guid();\r\n\r\n    // @ts-expect-error\r\n    this.props.valueChanged = (value) => {\r\n      // @ts-expect-error\r\n      const changed = this._internal.value !== value;\r\n      // @ts-expect-error\r\n      this._internal.value = value;\r\n      if (changed) {\r\n        // @ts-expect-error\r\n        this.flagOutputDirty(\"value\");\r\n        // @ts-expect-error\r\n        this.sendSignalOnOutput(\"onChange\");\r\n      }\r\n    };\r\n  },\r\n  getReactComponent() {\r\n    return Select;\r\n  },\r\n  inputs: {\r\n    items: {\r\n      type: \"array\",\r\n      displayName: \"Items\",\r\n      group: \"General\",\r\n      set: function (newValue) {\r\n        if (\r\n          // @ts-expect-error\r\n          this._internal.items !== newValue &&\r\n          // @ts-expect-error\r\n          this._internal.items !== undefined\r\n        ) {\r\n          // @ts-expect-error\r\n          this._internal.items.off(\"change\", this._itemsChanged);\r\n        }\r\n        // @ts-expect-error\r\n        this._internal.items = newValue;\r\n        // @ts-expect-error\r\n        this._internal.items.on(\"change\", this._itemsChanged);\r\n\r\n        // @ts-expect-error\r\n        this.props.items = this._internal.items;\r\n\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n    value: {\r\n      type: \"string\",\r\n      displayName: \"Value\",\r\n      group: \"General\",\r\n      set: function (value) {\r\n        if (value !== undefined && typeof value !== \"string\") {\r\n          if (value?.toString !== undefined) value = value.toString();\r\n          else return;\r\n        }\r\n\r\n        // // if value is passed in before the items, then items is undefined\r\n        // if (this._internal.items) {\r\n        //   //make sure this is a valid value that exists in the dropdown. If it doesn't, deselect all options\r\n        //   value = this._internal.items.find((i) => i.Value === value) ? value : undefined;\r\n        // }\r\n\r\n        // @ts-expect-error\r\n        const changed = value !== this._internal.value;\r\n        // @ts-expect-error\r\n        this.props.value = this._internal.value = value;\r\n\r\n        if (changed) {\r\n          // @ts-expect-error\r\n          this.forceUpdate();\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"value\");\r\n        }\r\n      },\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: \"Test ID Attribute\",\r\n      group: \"Advanced HTML\",\r\n      type: \"string\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n  },\r\n  inputProps: {\r\n    placeholder: {\r\n      displayName: \"Placeholder\",\r\n      type: \"string\",\r\n      group: \"Placeholder\",\r\n    },\r\n    placeholderOpacity: {\r\n      group: \"Placeholder\",\r\n      displayName: \"Placeholder opacity\",\r\n      type: \"number\",\r\n      default: 0.5,\r\n    },\r\n  },\r\n  outputs: {\r\n    value: {\r\n      type: \"string\",\r\n      displayName: \"Value\",\r\n      group: \"States\",\r\n      getter: function () {\r\n        // @ts-expect-error\r\n        return this._internal.value;\r\n      },\r\n    },\r\n    onChange: {\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 100,\r\n      displayName: \"Background Color\",\r\n      group: \"Style\",\r\n      type: \"color\",\r\n      default: \"transparent\",\r\n      styleTag: \"inputWrapper\",\r\n      allowVisualStates: true,\r\n    },\r\n  },\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(OptionsNode, {\r\n  defaultSizeMode: \"contentSize\",\r\n  contentLabel: \"Content\",\r\n});\r\nNodeSharedPortDefinitions.addAlignInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addTextStyleInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addTransformInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(OptionsNode, {\r\n  styleTag: \"inputWrapper\",\r\n});\r\nNodeSharedPortDefinitions.addMarginInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addIconInputs(OptionsNode, {\r\n  enableIconPlacement: true,\r\n  defaults: { useIcon: false, iconColor: \"#000000\" },\r\n});\r\nNodeSharedPortDefinitions.addLabelInputs(OptionsNode, {\r\n  enableSpacing: true,\r\n  styleTag: \"label\",\r\n});\r\nNodeSharedPortDefinitions.addSharedVisualInputs(OptionsNode);\r\nNodeSharedPortDefinitions.addBorderInputs(OptionsNode, {\r\n  defaults: {\r\n    borderStyle: \"solid\",\r\n    borderWidth: 2,\r\n    borderColor: \"#000000\",\r\n    borderRadius: 5,\r\n  },\r\n  styleTag: \"inputWrapper\",\r\n});\r\n\r\nNodeSharedPortDefinitions.addShadowInputs(OptionsNode, {\r\n  styleTag: \"inputWrapper\",\r\n});\r\nUtils.addControlEventsAndStates(OptionsNode);\r\n\r\nexport default createNodeFromReactComponent(OptionsNode);\r\n","import React from \"react\";\r\n\r\nexport interface IRadioButtonContext {\r\n  name: string | undefined;\r\n  selected: string | undefined;\r\n  checkedChanged?: (value: string) => void;\r\n}\r\n\r\nconst RadioButtonContext = React.createContext<IRadioButtonContext>({\r\n  name: undefined,\r\n  selected: undefined,\r\n  checkedChanged: undefined,\r\n});\r\n\r\nexport default RadioButtonContext;\r\n","import React, { useContext } from \"react\";\r\n\r\nimport RadioButtonContext from \"../../../contexts/radiobuttoncontext\";\r\nimport Layout from \"../../../layout\";\r\nimport Utils from \"../../../nodes/controls/utils\";\r\nimport { Noodl } from \"../../../types\";\r\n\r\nexport interface RadioButtonProps extends Noodl.ReactProps {\r\n  id: string;\r\n  enabled: boolean;\r\n  value: string;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  useLabel: boolean;\r\n  label: string;\r\n  labelSpacing: string;\r\n  labeltextStyle: Noodl.TextStyle;\r\n\r\n  useIcon: boolean;\r\n  iconPlacement: \"left\" | \"right\";\r\n  iconSpacing: string;\r\n  iconSourceType: \"image\" | \"icon\";\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n\r\n  fillSpacing: string;\r\n\r\n  checkedChanged: (value: boolean) => void;\r\n}\r\n\r\nfunction isPercentage(size /* string */) {\r\n  return size && size[size.length - 1] === \"%\";\r\n}\r\n\r\nexport function RadioButton(props: RadioButtonProps) {\r\n  const radioButtonGroup = useContext(RadioButtonContext);\r\n\r\n  const style = { ...props.style };\r\n\r\n  if (props.parentLayout === \"none\") {\r\n    style.position = \"absolute\";\r\n  }\r\n\r\n  Layout.align(style, props);\r\n\r\n  props.checkedChanged &&\r\n    props.checkedChanged(\r\n      radioButtonGroup ? radioButtonGroup.selected === props.value : false\r\n    );\r\n\r\n  const inputProps = {\r\n    ...props.attrs,\r\n    id: props.id,\r\n    disabled: !props.enabled,\r\n    className: [props.className, \"ndl-controls-radio-2\"].join(\" \"),\r\n    style: {\r\n      width: props.styles.radio.width,\r\n      height: props.styles.radio.height,\r\n    },\r\n  };\r\n\r\n  const inputWrapperStyle: React.CSSProperties = {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    position: \"relative\",\r\n    flexShrink: 0,\r\n    ...props.styles.radio,\r\n  };\r\n\r\n  if (props.useLabel) {\r\n    if (isPercentage(props.styles.radio.width)) {\r\n      delete inputWrapperStyle.width;\r\n      inputWrapperStyle.flexGrow = 1;\r\n    }\r\n  } else {\r\n    Object.assign(inputProps, Utils.controlEvents(props));\r\n    Object.assign(inputWrapperStyle, style);\r\n  }\r\n\r\n  function _renderIcon() {\r\n    if (props.iconSourceType === \"image\" && props.iconImageSource !== undefined)\r\n      return (\r\n        <img\r\n          alt=\"\"\r\n          src={props.iconImageSource}\r\n          style={{ width: props.iconSize, height: props.iconSize }}\r\n        />\r\n      );\r\n    else if (\r\n      props.iconSourceType === \"icon\" &&\r\n      props.iconIconSource !== undefined\r\n    ) {\r\n      const style = { fontSize: props.iconSize, color: props.iconColor };\r\n      if (props.iconIconSource.codeAsClass === true) {\r\n        return (\r\n          <span\r\n            className={[\r\n              \"ndl-controls-abs-center\",\r\n              props.iconIconSource.class,\r\n              props.iconIconSource.code,\r\n            ].join(\" \")}\r\n            style={style}\r\n          ></span>\r\n        );\r\n      } else {\r\n        return (\r\n          <span\r\n            className={[\r\n              \"ndl-controls-abs-center\",\r\n              props.iconIconSource.class,\r\n            ].join(\" \")}\r\n            style={style}\r\n          >\r\n            {props.iconIconSource.code}\r\n          </span>\r\n        );\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  const fillStyle: React.CSSProperties = {\r\n    left: props.fillSpacing,\r\n    right: props.fillSpacing,\r\n    top: props.fillSpacing,\r\n    bottom: props.fillSpacing,\r\n    backgroundColor: props.styles.fill.backgroundColor,\r\n    borderRadius: \"inherit\",\r\n    position: \"absolute\",\r\n  };\r\n\r\n  const radioButton = (\r\n    <div\r\n      className=\"ndl-controls-pointer\"\r\n      style={inputWrapperStyle}\r\n      noodl-style-tag=\"radio\"\r\n    >\r\n      <div style={fillStyle} noodl-style-tag=\"fill\" />\r\n      {props.useIcon ? _renderIcon() : null}\r\n      <input\r\n        type=\"radio\"\r\n        name={radioButtonGroup ? radioButtonGroup.name : undefined}\r\n        {...inputProps}\r\n        checked={\r\n          radioButtonGroup ? radioButtonGroup.selected === props.value : false\r\n        }\r\n        onChange={(e) => {\r\n          radioButtonGroup &&\r\n            radioButtonGroup.checkedChanged &&\r\n            radioButtonGroup.checkedChanged(props.value);\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  if (props.useLabel) {\r\n    const labelStyle = {\r\n      marginLeft: props.labelSpacing,\r\n      ...props.labeltextStyle,\r\n      ...props.styles.label,\r\n      cursor: props.enabled ? undefined : \"default\",\r\n    };\r\n\r\n    labelStyle.color = props.noodlNode.context.styles.resolveColor(\r\n      labelStyle.color\r\n    );\r\n\r\n    const wrapperStyle = { display: \"flex\", alignItems: \"center\", ...style };\r\n    if (isPercentage(props.styles.radio.width)) {\r\n      wrapperStyle.width = props.styles.radio.width;\r\n    }\r\n    if (isPercentage(props.styles.radio.height)) {\r\n      wrapperStyle.height = props.styles.radio.height;\r\n    }\r\n\r\n    return (\r\n      <div style={wrapperStyle} {...Utils.controlEvents(props)}>\r\n        {radioButton}\r\n        <label\r\n          className=\"ndl-controls-pointer\"\r\n          style={labelStyle}\r\n          htmlFor={props.id}\r\n          noodl-style-tag=\"label\"\r\n        >\r\n          {props.label}\r\n        </label>\r\n      </div>\r\n    );\r\n  } else {\r\n    return radioButton;\r\n  }\r\n}\r\n","import { RadioButton } from \"../../components/controls/RadioButton\";\r\nimport { guid } from \"@fluxscape/runtime\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\nimport Utils from \"./utils\";\r\n\r\nconst RadioButtonNode = {\r\n  name: \"net.noodl.controls.radiobutton\",\r\n  displayName: \"Radio Button\",\r\n  docs: \"https://docs.noodl.net/nodes/ui-controls/radio-button\",\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  usePortAsLabel: \"label\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"label\",\r\n  },\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      \"General\",\r\n      \"Style\",\r\n      \"Fill Style\",\r\n      \"Actions\",\r\n      \"Events\",\r\n      \"States\",\r\n      \"Mounted\",\r\n      \"Label\",\r\n      \"Label Text Style\",\r\n      \"Hover Events\",\r\n      \"Pointer Events\",\r\n      \"Focus Events\",\r\n    ],\r\n  },\r\n  initialize() {\r\n    // @ts-expect-error\r\n    this.props.attrs = {};\r\n    // @ts-expect-error\r\n    this.props.sizeMode = \"explicit\";\r\n    // @ts-expect-error\r\n    this.props.id = \"input-\" + guid();\r\n\r\n    // @ts-expect-error\r\n    this._internal.checked = false;\r\n\r\n    // @ts-expect-error\r\n    this.props.checkedChanged = (checked) => {\r\n      // @ts-expect-error\r\n      const changed = this._internal.checked !== checked;\r\n      // @ts-expect-error\r\n      this._internal.checked = checked;\r\n      if (changed) {\r\n        // @ts-expect-error\r\n        this.flagOutputDirty(\"checked\");\r\n        // @ts-expect-error\r\n        this._updateVisualState();\r\n      }\r\n    };\r\n\r\n    // @ts-expect-error\r\n    this.props.styles.fill = {};\r\n  },\r\n  getReactComponent() {\r\n    return RadioButton;\r\n  },\r\n  inputs: {\r\n    fillColor: {\r\n      index: 19,\r\n      displayName: \"Fill Color\",\r\n      group: \"Fill Style\",\r\n      type: \"color\",\r\n      allowVisualStates: true,\r\n      styleTag: \"fill\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this.setStyle({ backgroundColor: value }, \"fill\");\r\n      },\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: \"Test ID Attribute\",\r\n      group: \"Advanced HTML\",\r\n      type: \"string\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n  },\r\n  inputProps: {\r\n    value: {\r\n      type: \"string\",\r\n      displayName: \"Value\",\r\n      group: \"General\",\r\n      index: 100,\r\n    },\r\n    fillSpacing: {\r\n      displayName: \"Fill Spacing\",\r\n      group: \"Fill Style\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\", \"vw\", \"vh\"],\r\n        defaultUnit: \"px\",\r\n      },\r\n      allowVisualStates: true,\r\n      default: 2,\r\n    },\r\n  },\r\n  inputCss: {\r\n    width: {\r\n      index: 11,\r\n      group: \"Dimensions\",\r\n      displayName: \"Width\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\", \"%\", \"vw\", \"vh\"],\r\n        defaultUnit: \"px\",\r\n      },\r\n      default: 32,\r\n      allowVisualStates: true,\r\n      styleTag: \"radio\",\r\n      onChange() {\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n    height: {\r\n      index: 12,\r\n      group: \"Dimensions\",\r\n      displayName: \"Height\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\", \"%\"],\r\n        defaultUnit: \"px\",\r\n      },\r\n      default: 32,\r\n      allowVisualStates: true,\r\n      styleTag: \"radio\",\r\n      onChange() {\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n    backgroundColor: {\r\n      index: 201,\r\n      displayName: \"Background Color\",\r\n      group: \"Style\",\r\n      type: \"color\",\r\n      allowVisualStates: true,\r\n      styleTag: \"radio\",\r\n      default: \"transparent\",\r\n      applyDefault: false,\r\n    },\r\n  },\r\n  outputs: {\r\n    checked: {\r\n      type: \"boolean\",\r\n      displayName: \"Checked\",\r\n      group: \"States\",\r\n      get() {\r\n        // @ts-expect-error\r\n        return this._internal.checked;\r\n      },\r\n    },\r\n  },\r\n};\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addTransformInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addMarginInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addIconInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addLabelInputs(RadioButtonNode, {\r\n  enableSpacing: true,\r\n  styleTag: \"label\",\r\n});\r\nNodeSharedPortDefinitions.addSharedVisualInputs(RadioButtonNode);\r\nNodeSharedPortDefinitions.addBorderInputs(RadioButtonNode, {\r\n  defaults: {\r\n    borderStyle: \"solid\",\r\n    borderWidth: 2,\r\n    borderRadius: 16,\r\n  },\r\n  styleTag: \"radio\",\r\n});\r\nNodeSharedPortDefinitions.addShadowInputs(RadioButtonNode, {\r\n  styleTag: \"radio\",\r\n});\r\nUtils.addControlEventsAndStates(RadioButtonNode, { checked: true });\r\n\r\nexport default createNodeFromReactComponent(RadioButtonNode);\r\n","import React, { useEffect, useState } from \"react\";\r\n\r\nimport RadioButtonContext from \"../../../contexts/radiobuttoncontext\";\r\nimport Layout from \"../../../layout\";\r\nimport { Noodl, Slot } from \"../../../types\";\r\n\r\nexport interface RadioButtonGroupProps extends Noodl.ReactProps {\r\n  name: string;\r\n  value: string;\r\n\r\n  valueChanged?: (value: string) => void;\r\n\r\n  children: Slot;\r\n}\r\n\r\nexport function RadioButtonGroup(props: RadioButtonGroupProps) {\r\n  const [selected, setSelected] = useState(props.value);\r\n  const context = {\r\n    selected: selected,\r\n    name: props.name,\r\n    checkedChanged: (value) => {\r\n      setSelected(value);\r\n      props.valueChanged && props.valueChanged(value);\r\n    },\r\n  };\r\n\r\n  useEffect(() => {\r\n    setSelected(props.value);\r\n  }, [props.value]);\r\n\r\n  const style: React.CSSProperties = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  let className = \"ndl-controls-radiobuttongroup\";\r\n  if (props.className) className = className + \" \" + props.className;\r\n\r\n  return (\r\n    <RadioButtonContext.Provider value={context}>\r\n      <div className={className} style={style}>\r\n        {props.children}\r\n      </div>\r\n    </RadioButtonContext.Provider>\r\n  );\r\n}\r\n","export const flexDirectionValues = [\r\n  \"row\",\r\n  \"row-reverse\",\r\n  \"column\",\r\n  \"column-reverse\",\r\n  \"inherit\",\r\n  \"initial\",\r\n  \"revert\",\r\n  \"unset\",\r\n];\r\n","import { RadioButtonGroup } from \"../../components/controls/RadioButtonGroup\";\r\nimport { flexDirectionValues } from \"../../constants/flex\";\r\nimport { guid } from \"@fluxscape/runtime\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\n\r\nconst RadioButtonGroupNode = {\r\n  name: \"Radio Button Group\",\r\n  displayName: \"Radio Button Group\",\r\n  docs: \"https://docs.noodl.net/nodes/ui-controls/radio-button-group\",\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  useVariants: false,\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      \"General\",\r\n      \"Style\",\r\n      \"Actions\",\r\n      \"Events\",\r\n      \"Mounted\",\r\n      \"States\",\r\n    ],\r\n  },\r\n  initialize() {\r\n    // @ts-expect-error\r\n    this.props.name = \"radio-\" + guid();\r\n\r\n    // @ts-expect-error\r\n    this.props.valueChanged = (value) => {\r\n      // @ts-expect-error\r\n      const changed = this._internal.value !== value;\r\n      // @ts-expect-error\r\n      this._internal.value = value;\r\n      // @ts-expect-error\r\n      this.props.value = value;\r\n      if (changed) {\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n        // @ts-expect-error\r\n        this.flagOutputDirty(\"value\");\r\n        // @ts-expect-error\r\n        this.sendSignalOnOutput(\"onChange\");\r\n      }\r\n    };\r\n  },\r\n  getReactComponent() {\r\n    return RadioButtonGroup;\r\n  },\r\n  defaultCss: {\r\n    display: \"flex\",\r\n    position: \"relative\",\r\n    flexDirection: \"column\",\r\n  },\r\n  inputs: {\r\n    flexDirection: {\r\n      //don't rename for backwards compat\r\n      index: 11,\r\n      displayName: \"Layout\",\r\n      group: \"Layout\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Vertical\", value: \"column\" },\r\n          { label: \"Horizontal\", value: \"row\" },\r\n        ],\r\n      },\r\n      default: \"column\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this.props.layout = value;\r\n\r\n        if (value !== \"none\") {\r\n          // @ts-expect-error\r\n          this.setStyle({ flexDirection: value });\r\n        } else {\r\n          // @ts-expect-error\r\n          this.removeStyle([\"flexDirection\"]);\r\n        }\r\n\r\n        // @ts-expect-error\r\n        if (this.context.editorConnection) {\r\n          // Send warning if the value is wrong\r\n          if (value !== \"none\" && !flexDirectionValues.includes(value)) {\r\n            // @ts-expect-error\r\n            this.context.editorConnection.sendWarning(\r\n              // @ts-expect-error\r\n              this.nodeScope.componentOwner.name,\r\n              // @ts-expect-error\r\n              this.id,\r\n              \"layout-warning\",\r\n              {\r\n                message:\r\n                  \"Invalid Layout value has to be a valid flex-direction value.\",\r\n              }\r\n            );\r\n          } else {\r\n            // @ts-expect-error\r\n            this.context.editorConnection.clearWarning(\r\n              // @ts-expect-error\r\n              this.nodeScope.componentOwner.name,\r\n              // @ts-expect-error\r\n              this.id,\r\n              \"layout-warning\"\r\n            );\r\n          }\r\n        }\r\n\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n    value: {\r\n      index: 20,\r\n      type: \"string\",\r\n      displayName: \"Value\",\r\n      group: \"General\",\r\n      set: function (value) {\r\n        if (typeof value !== \"string\" && value.toString !== undefined)\r\n          value = value.toString();\r\n        if (typeof value !== \"string\") return;\r\n\r\n        // @ts-expect-error\r\n        const changed = value !== this._internal.value;\r\n        // @ts-expect-error\r\n        this.props.value = this._internal.value = value;\r\n\r\n        if (changed) {\r\n          // @ts-expect-error\r\n          this.forceUpdate();\r\n          // @ts-expect-error\r\n          this.flagOutputDirty(\"value\");\r\n        }\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    value: {\r\n      type: \"string\",\r\n      displayName: \"Value\",\r\n      group: \"States\",\r\n      getter: function () {\r\n        // @ts-expect-error\r\n        return this._internal.value;\r\n      },\r\n    },\r\n    onChange: {\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n  inputProps: {},\r\n  outputProps: {},\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(RadioButtonGroupNode, {\r\n  defaultSizeMode: \"contentSize\",\r\n  contentLabel: \"Content\",\r\n});\r\nNodeSharedPortDefinitions.addAlignInputs(RadioButtonGroupNode);\r\nNodeSharedPortDefinitions.addTransformInputs(RadioButtonGroupNode);\r\nNodeSharedPortDefinitions.addMarginInputs(RadioButtonGroupNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(RadioButtonGroupNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(RadioButtonGroupNode);\r\n\r\nexport default createNodeFromReactComponent(RadioButtonGroupNode);\r\n","import React, { useEffect, useState } from \"react\";\r\n\r\nimport Layout from \"../../../layout\";\r\nimport Utils from \"../../../nodes/controls/utils\";\r\nimport { Noodl } from \"../../../types\";\r\n\r\nexport interface SliderProps extends Noodl.ReactProps {\r\n  _nodeId: string;\r\n  id: string;\r\n  enabled: boolean;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  value: number;\r\n  min: number;\r\n  max: number;\r\n  step: number;\r\n\r\n  thumbHeight: string;\r\n  thumbWidth: string;\r\n  thumbColor: string;\r\n\r\n  trackHeight: string;\r\n  trackActiveColor: string;\r\n  trackColor: string;\r\n\r\n  onClick: () => void;\r\n  updateOutputValue: (value: number) => void;\r\n}\r\n\r\nfunction _styleTemplate(_class: string, props: SliderProps) {\r\n  return `.${_class}::-webkit-slider-thumb {\r\n  width: ${props.thumbWidth};\r\n}`;\r\n}\r\n\r\nfunction setBorderStyle(\r\n  style: React.CSSProperties,\r\n  prefix: string,\r\n  props: SliderProps\r\n) {\r\n  function setBorder(style: React.CSSProperties, group: string) {\r\n    const width = `${prefix}Border${group}Width`;\r\n    const color = `${prefix}Border${group}Color`;\r\n    const borderStyle = `${prefix}Border${group}Style`;\r\n\r\n    const w = props[width] || props[`${prefix}BorderWidth`];\r\n    if (w !== undefined) style[`border${group}Width`] = w;\r\n\r\n    const c = (style[color] = props[color] || props[`${prefix}BorderColor`]);\r\n    if (c !== undefined) style[`border${group}Color`] = c;\r\n\r\n    const s = props[borderStyle] || props[`${prefix}BorderStyle`];\r\n    if (s !== undefined) style[`border${group}Style`] = s;\r\n  }\r\n\r\n  setBorder(style, \"Top\");\r\n  setBorder(style, \"Right\");\r\n  setBorder(style, \"Bottom\");\r\n  setBorder(style, \"Left\");\r\n}\r\n\r\nfunction setBorderRadius(\r\n  style: React.CSSProperties,\r\n  prefix: string,\r\n  props: SliderProps\r\n) {\r\n  const radius = props[`${prefix}BorderRadius`];\r\n  const tl = props[`${prefix}BorderTopLeftRadius`] || radius;\r\n  const tr = props[`${prefix}BorderTopRightRadius`] || radius;\r\n  const br = props[`${prefix}BorderBottomRightRadius`] || radius;\r\n  const bl = props[`${prefix}BorderBottomLeftRadius`] || radius;\r\n\r\n  style.borderRadius = `${tl} ${tr} ${br} ${bl}`;\r\n}\r\n\r\nfunction setShadow(\r\n  style: React.CSSProperties,\r\n  prefix: string,\r\n  props: SliderProps\r\n) {\r\n  if (!props[`${prefix}BoxShadowEnabled`]) return;\r\n\r\n  const inset = props[`${prefix}BoxShadowInset`];\r\n  const x = props[`${prefix}BoxShadowOffsetX`];\r\n  const y = props[`${prefix}BoxShadowOffsetY`];\r\n  const blur = props[`${prefix}BoxShadowBlurRadius`];\r\n  const spread = props[`${prefix}BoxShadowSpreadRadius`];\r\n  const color = props[`${prefix}BoxShadowColor`];\r\n\r\n  style.boxShadow = `${\r\n    inset ? \"inset \" : \"\"\r\n  }${x} ${y} ${blur} ${spread} ${color}`;\r\n}\r\n\r\nfunction hasUnitPx(value: string) {\r\n  return value && value[value.length - 1] === \"x\";\r\n}\r\n\r\nexport function Slider(props: SliderProps) {\r\n  const [value, setValue] = useState(props.value);\r\n\r\n  useEffect(() => {\r\n    onValueChanged(props.value);\r\n  }, [props.value]);\r\n\r\n  function onValueChanged(value: number) {\r\n    setValue(value);\r\n    props.updateOutputValue(value);\r\n  }\r\n\r\n  const style: React.CSSProperties = { ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  const instanceClassId = \"ndl-controls-range-\" + props._nodeId;\r\n  Utils.updateStylesForClass(instanceClassId, props, _styleTemplate);\r\n\r\n  const className = `ndl-controls-range2 ${instanceClassId} ${\r\n    props.className ? props.className : \"\"\r\n  } `;\r\n\r\n  const inputProps: React.InputHTMLAttributes<HTMLInputElement> = {\r\n    ...props.attrs,\r\n    id: props.id,\r\n    style: {\r\n      width: \"100%\",\r\n      opacity: 0,\r\n    },\r\n    onClick: props.onClick,\r\n    min: props.min,\r\n    max: props.max,\r\n  };\r\n\r\n  inputProps.style = inputProps.style || {};\r\n\r\n  if (props.step) {\r\n    inputProps.step = props.step;\r\n  }\r\n\r\n  //make the input as tall as the tallest element, track or thumb, so the entire area becomes interactive\r\n  //Makes it possible to design sliders with thin tracks and tall thumbs\r\n\r\n  if (hasUnitPx(props.thumbHeight)) {\r\n    if (hasUnitPx(props.trackHeight)) {\r\n      const thumbHeight = Number(props.thumbHeight.slice(0, -2));\r\n      const trackHeight = Number(props.trackHeight.slice(0, -2));\r\n      inputProps.style.height = Math.max(thumbHeight, trackHeight) + \"px\";\r\n    } else {\r\n      inputProps.style.height = props.thumbHeight;\r\n    }\r\n  } else {\r\n    inputProps.style.height = props.trackHeight;\r\n  }\r\n\r\n  const divStyle = {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    ...style,\r\n  };\r\n\r\n  const valueFactor = (value - props.min) / (props.max - props.min);\r\n\r\n  const trackStyle: React.CSSProperties = {\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    height: props.trackHeight,\r\n    background: `linear-gradient(to right, ${props.trackActiveColor} 0%, ${\r\n      props.trackActiveColor\r\n    } ${valueFactor * 100}%, ${props.trackColor} ${valueFactor * 100}%, ${\r\n      props.trackColor\r\n    } 100%)`,\r\n  };\r\n\r\n  setBorderStyle(trackStyle, \"track\", props);\r\n  setBorderRadius(trackStyle, \"track\", props);\r\n  setShadow(trackStyle, \"track\", props);\r\n\r\n  const thumbStyle: React.CSSProperties = {\r\n    position: \"absolute\",\r\n    left: \"calc((100% - \" + props.thumbWidth + \") * \" + valueFactor + \")\",\r\n    width: props.thumbWidth,\r\n    height: props.thumbHeight,\r\n    backgroundColor: props.thumbColor,\r\n  };\r\n\r\n  setBorderStyle(thumbStyle, \"thumb\", props);\r\n  setBorderRadius(thumbStyle, \"thumb\", props);\r\n  setShadow(thumbStyle, \"thumb\", props);\r\n\r\n  return (\r\n    <div style={divStyle}>\r\n      <div style={trackStyle} />\r\n      <div style={thumbStyle} />\r\n      <input\r\n        className={className}\r\n        {...Utils.controlEvents(props)}\r\n        type=\"range\"\r\n        {...inputProps}\r\n        value={value}\r\n        disabled={!props.enabled}\r\n        onChange={(e) => onValueChanged(Number(e.target.value))}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import { Slider, SliderProps } from \"../../components/controls/Slider\";\r\nimport { guid } from \"@fluxscape/runtime\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\nimport Utils from \"./utils\";\r\nimport { ReactNodeDefinition } from \"../../ReactNodeDefinition\";\r\n\r\nconst thumbPopout = { group: \"thumb-styles\", label: \"Thumb Styles\" };\r\nconst trackPopout = { group: \"track-styles\", label: \"Track Styles\" };\r\n\r\ninterface Internal {\r\n  outputValue: number;\r\n  valuePercent: number;\r\n}\r\n\r\nconst RangeNode: ReactNodeDefinition<Internal, SliderProps> = {\r\n  name: \"net.noodl.controls.range\",\r\n  displayNodeName: \"Slider\",\r\n  category: \"Controls\",\r\n  docs: \"https://docs.noodl.net/nodes/ui-controls/slider\",\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      \"General\",\r\n      \"Style\",\r\n      \"Actions\",\r\n      \"Events\",\r\n      \"States\",\r\n      \"Mounted\",\r\n      \"Hover Events\",\r\n      \"Pointer Events\",\r\n      \"Focus Events\",\r\n    ],\r\n  },\r\n  initialize() {\r\n    // @ts-expect-error\r\n    this.props.attrs = {};\r\n    // @ts-expect-error\r\n    this.props.sizeMode = \"contentHeight\";\r\n    // @ts-expect-error\r\n    this.props.id = \"input-\" + guid();\r\n\r\n    // @ts-expect-error\r\n    this.props.value = this.props.min;\r\n    this._internal.outputValue = 0;\r\n\r\n    // @ts-expect-error\r\n    this.props._nodeId = this.id;\r\n\r\n    //this is used by the range to communicate with the node whenever the range changes value\r\n\r\n    // @ts-expect-error\r\n    this.props.updateOutputValue = (value: string | number) => {\r\n      value = typeof value === \"string\" ? parseFloat(value) : value;\r\n\r\n      const valueChanged = this._internal.outputValue !== value;\r\n      if (valueChanged) {\r\n        this._internal.outputValue = value;\r\n        this.flagOutputDirty(\"value\");\r\n        // @ts-expect-error\r\n        this._updateOutputValuePercent(value);\r\n        this.sendSignalOnOutput(\"onChange\");\r\n      }\r\n\r\n      // On first mount, output the initial percentage.\r\n      if (!this._internal.valuePercent) {\r\n        // @ts-expect-error\r\n        this._updateOutputValuePercent(value);\r\n      }\r\n    };\r\n\r\n    // @ts-expect-error\r\n    this.props.updateOutputValue(this.props.value); // Set the value output to an initial value\r\n  },\r\n  getReactComponent() {\r\n    return Slider;\r\n  },\r\n  inputs: {\r\n    value: {\r\n      type: \"string\",\r\n      displayName: \"Value\",\r\n      group: \"General\",\r\n      index: 100,\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this._setInputValue(value);\r\n      },\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: \"Test ID Attribute\",\r\n      group: \"Advanced HTML\",\r\n      type: \"string\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n  },\r\n  outputs: {\r\n    value: {\r\n      type: \"number\",\r\n      displayName: \"Value\",\r\n      group: \"States\",\r\n      get() {\r\n        return this._internal.outputValue;\r\n      },\r\n    },\r\n    valuePercent: {\r\n      type: \"number\",\r\n      displayName: \"Value Percent\",\r\n      group: \"States\",\r\n      get() {\r\n        return this._internal.valuePercent;\r\n      },\r\n    },\r\n    onChange: {\r\n      type: \"signal\",\r\n      displayName: \"Changed\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n  inputProps: {\r\n    min: {\r\n      type: \"number\",\r\n      displayName: \"Min\",\r\n      group: \"General\",\r\n      default: 0,\r\n      index: 100,\r\n      onChange() {\r\n        // @ts-expect-error\r\n        this._setInputValue(this.props.value);\r\n      },\r\n    },\r\n    max: {\r\n      type: \"number\",\r\n      displayName: \"Max\",\r\n      group: \"General\",\r\n      default: 100,\r\n      index: 100,\r\n      onChange() {\r\n        // @ts-expect-error\r\n        this._setInputValue(this.props.value);\r\n      },\r\n    },\r\n    step: {\r\n      type: \"number\",\r\n      displayName: \"Step\",\r\n      group: \"General\",\r\n      default: 1,\r\n      index: 100,\r\n    },\r\n    width: {\r\n      index: 11,\r\n      group: \"Dimensions\",\r\n      displayName: \"Width\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"%\", \"px\", \"vw\"],\r\n        defaultUnit: \"%\",\r\n      },\r\n      default: 100,\r\n      allowVisualStates: true,\r\n    },\r\n    // Styles\r\n    thumbWidth: {\r\n      group: \"Thumb Style\",\r\n      displayName: \"Width\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\", \"vw\", \"%\"],\r\n        defaultUnit: \"px\",\r\n        allowEditOnly: true,\r\n      },\r\n      default: 16,\r\n      popout: thumbPopout,\r\n      allowVisualStates: true,\r\n    },\r\n    thumbHeight: {\r\n      group: \"Thumb Style\",\r\n      displayName: \"Height\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\", \"vh\", \"%\"],\r\n        defaultUnit: \"px\",\r\n        allowEditOnly: true,\r\n      },\r\n      default: 16,\r\n      popout: thumbPopout,\r\n      allowVisualStates: true,\r\n    },\r\n    thumbColor: {\r\n      group: \"Thumb Style\",\r\n      displayName: \"Color\",\r\n      type: { name: \"color\", allowEditOnly: true },\r\n      default: \"#000000\",\r\n      popout: thumbPopout,\r\n      allowVisualStates: true,\r\n    },\r\n    trackHeight: {\r\n      group: \"Track Style\",\r\n      displayName: \"Height\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\", \"vh\", \"%\"],\r\n        defaultUnit: \"px\",\r\n        allowEditOnly: true,\r\n      },\r\n      default: 6,\r\n      popout: trackPopout,\r\n      allowVisualStates: true,\r\n    },\r\n    trackColor: {\r\n      group: \"Track Style\",\r\n      displayName: \"Inactive Color\",\r\n      type: { name: \"color\", allowEditOnly: true },\r\n      default: \"#f0f0f0\",\r\n      popout: trackPopout,\r\n      allowVisualStates: true,\r\n    },\r\n    trackActiveColor: {\r\n      group: \"Track Style\",\r\n      displayName: \"Active Color\",\r\n      type: { name: \"color\", allowEditOnly: true },\r\n      default: \"#f0f0f0\",\r\n      popout: trackPopout,\r\n      allowVisualStates: true,\r\n    },\r\n  },\r\n  methods: {\r\n    _updateOutputValuePercent(value: number) {\r\n      // @ts-expect-error\r\n      const min = this.props.min;\r\n      // @ts-expect-error\r\n      const max = this.props.max;\r\n      const valuePercent = Math.floor(((value - min) / (max - min)) * 100);\r\n      const valuePercentChanged =\r\n        // @ts-expect-error\r\n        this._internal.valuePercentChanged !== valuePercent;\r\n\r\n      this._internal.valuePercent = valuePercent;\r\n      valuePercentChanged && this.flagOutputDirty(\"valuePercent\");\r\n    },\r\n    _setInputValue(newValue) {\r\n      //make sure value never goes out of range\r\n      const value = Math.max(\r\n        // @ts-expect-error\r\n        this.props.min,\r\n        // @ts-expect-error\r\n        Math.min(this.props.max, newValue || 0)\r\n      );\r\n\r\n      // @ts-expect-error\r\n      const changed = value !== this.props.value;\r\n\r\n      if (changed) {\r\n        // @ts-expect-error\r\n        this.props.value = value;\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\n//Add borders\r\nfunction addBorderInputs(definition, opts) {\r\n  opts = opts || {};\r\n  const defaults = opts.defaults || {};\r\n  const popout = opts.popout;\r\n\r\n  defaults.borderStyle = \"none\";\r\n  defaults.borderWidth = 0;\r\n  defaults.borderColor = \"#000000\";\r\n\r\n  const prefixLabel =\r\n    opts.propPrefix[0].toUpperCase() + opts.propPrefix.slice(1);\r\n\r\n  function defineBorderTab(definition, suffix, tabName, indexOffset) {\r\n    const styleName = opts.propPrefix + `Border${suffix}Style`;\r\n    const widthName = opts.propPrefix + `Border${suffix}Width`;\r\n    const colorName = opts.propPrefix + `Border${suffix}Color`;\r\n\r\n    let orNotSet =\r\n      defaults.borderStyle !== \"none\" ? \"OR borderStyle NOT SET\" : \"\";\r\n\r\n    if (suffix) {\r\n      if (defaults[styleName] && defaults[styleName] !== \"none\")\r\n        orNotSet += `OR ${styleName} NOT SET`;\r\n      NodeSharedPortDefinitions.addDynamicInputPorts(\r\n        definition,\r\n        `${styleName} = solid OR ${styleName} = dashed OR ${styleName} = dotted OR borderStyle = solid OR borderStyle = dashed OR borderStyle = dotted ${orNotSet}`,\r\n        [`${widthName}`, `${colorName}`]\r\n      );\r\n    } else {\r\n      NodeSharedPortDefinitions.addDynamicInputPorts(\r\n        definition,\r\n        `${styleName} = solid OR ${styleName} = dashed OR ${styleName} = dotted ${orNotSet}`,\r\n        [`${widthName}`, `${colorName}`]\r\n      );\r\n    }\r\n\r\n    const tab = {\r\n      group: opts.propPrefix + \"-border-styles\",\r\n      tab: tabName,\r\n      label: suffix,\r\n    };\r\n\r\n    const editorName = (name) =>\r\n      `${prefixLabel} ${name} ${suffix ? \"(\" + suffix + \")\" : \"\"}`;\r\n    const index = 202 + indexOffset * 4;\r\n\r\n    const groupName = prefixLabel + \" Border Style\";\r\n\r\n    NodeSharedPortDefinitions.addInputProps(definition, {\r\n      [styleName]: {\r\n        index: index + 1,\r\n        displayName: \"Border Style\",\r\n        editorName: editorName(\"Border Style\"),\r\n        group: groupName,\r\n        type: {\r\n          name: \"enum\",\r\n          enums: [\r\n            { label: \"None\", value: \"none\" },\r\n            { label: \"Solid\", value: \"solid\" },\r\n            { label: \"Dotted\", value: \"dotted\" },\r\n            { label: \"Dashed\", value: \"dashed\" },\r\n          ],\r\n        },\r\n        default: defaults[`border${suffix}Style`],\r\n        tab,\r\n        popout,\r\n        allowVisualStates: true,\r\n      },\r\n      [widthName]: {\r\n        index: index + 2,\r\n        displayName: \"Border Width\",\r\n        editorName: editorName(\"Border Width\"),\r\n        group: groupName,\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\"],\r\n          defaultUnit: \"px\",\r\n        },\r\n        default: defaults[`border${suffix}Width`],\r\n        tab,\r\n        popout,\r\n        allowVisualStates: true,\r\n      },\r\n      [colorName]: {\r\n        index: index + 3,\r\n        displayName: \"Border Color\",\r\n        editorName: editorName(\"Border Color\"),\r\n        group: groupName,\r\n        type: \"color\",\r\n        default: defaults[`border${suffix}Color`],\r\n        tab,\r\n        popout,\r\n        allowVisualStates: true,\r\n      },\r\n    });\r\n  }\r\n\r\n  defineBorderTab(definition, \"\", \"borders-all\", 0);\r\n  defineBorderTab(definition, \"Left\", \"borders-left\", 1);\r\n  defineBorderTab(definition, \"Top\", \"borders-top\", 2);\r\n  defineBorderTab(definition, \"Right\", \"borders-right\", 3);\r\n  defineBorderTab(definition, \"Bottom\", \"borders-bottom\", 4);\r\n}\r\n\r\nfunction addBorderRadius(definition, opts) {\r\n  opts = opts || {};\r\n  const defaults = opts.defaults || {};\r\n  const popout = opts.popout;\r\n\r\n  if (!defaults.borderRadius) defaults.borderRadius = 0;\r\n\r\n  const prefixLabel =\r\n    opts.propPrefix[0].toUpperCase() + opts.propPrefix.slice(1);\r\n\r\n  function defineCornerTab(definition, suffix, tabName, indexOffset) {\r\n    const editorName = (name) =>\r\n      `${prefixLabel} ${name} ${suffix ? \"(\" + suffix + \")\" : \"\"}`;\r\n\r\n    const tab = {\r\n      group: opts.propPrefix + \"-corners\",\r\n      tab: tabName,\r\n      label: suffix,\r\n    };\r\n    const radiusName = `Border${suffix}Radius`;\r\n\r\n    NodeSharedPortDefinitions.addInputProps(definition, {\r\n      [opts.propPrefix + radiusName]: {\r\n        index: 240 + indexOffset,\r\n        displayName: \"Corner Radius\",\r\n        editorName: editorName(\"Corner Radius\"),\r\n        group: prefixLabel + \" Corner Radius\",\r\n        type: {\r\n          name: \"number\",\r\n          units: [\"px\", \"%\"],\r\n          defaultUnit: \"px\",\r\n        },\r\n        default: defaults[`border${suffix}Radius`],\r\n        tab,\r\n        popout,\r\n      },\r\n    });\r\n  }\r\n\r\n  defineCornerTab(definition, \"\", \"corners-all\", 0);\r\n  defineCornerTab(definition, \"TopLeft\", \"corners-top-left\", 1);\r\n  defineCornerTab(definition, \"TopRight\", \"corners-top-right\", 2);\r\n  defineCornerTab(definition, \"BottomRight\", \"corners-bottom-right\", 3);\r\n  defineCornerTab(definition, \"BottomLeft\", \"corners-bottom-left\", 4);\r\n}\r\n\r\nfunction addShadowInputs(definition, opts) {\r\n  opts = opts || {};\r\n  const popout = opts.popout;\r\n  const prefix = opts.propPrefix;\r\n\r\n  NodeSharedPortDefinitions.addDynamicInputPorts(\r\n    definition,\r\n    `${prefix}BoxShadowEnabled = true`,\r\n    [\r\n      `${prefix}BoxShadowOffsetX`,\r\n      `${prefix}BoxShadowOffsetY`,\r\n      `${prefix}BoxShadowInset`,\r\n      `${prefix}BoxShadowBlurRadius`,\r\n      `${prefix}BoxShadowSpreadRadius`,\r\n      `${prefix}BoxShadowColor`,\r\n    ]\r\n  );\r\n\r\n  const prefixLabel =\r\n    opts.propPrefix[0].toUpperCase() + opts.propPrefix.slice(1);\r\n  const editorName = (name) => `${prefixLabel} ${name}`;\r\n\r\n  NodeSharedPortDefinitions.addInputProps(definition, {\r\n    [`${prefix}BoxShadowEnabled`]: {\r\n      index: 250,\r\n      group: opts.group || \"Box Shadow\",\r\n      displayName: \"Shadow Enabled\",\r\n      editorName: editorName(\"Shadow Enabled\"),\r\n      type: \"boolean\",\r\n      allowVisualStates: true,\r\n      popout,\r\n    },\r\n    [`${prefix}BoxShadowOffsetX`]: {\r\n      index: 251,\r\n      group: opts.group || \"Box Shadow\",\r\n      displayName: \"Offset X\",\r\n      editorName: editorName(\"Offset X\"),\r\n      default: 0,\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\"],\r\n        defaultUnit: \"px\",\r\n      },\r\n      allowVisualStates: true,\r\n      popout,\r\n    },\r\n    [`${prefix}BoxShadowOffsetY`]: {\r\n      index: 252,\r\n      group: opts.group || \"Box Shadow\",\r\n      displayName: \"Offset Y\",\r\n      editorName: editorName(\"Offset Y\"),\r\n      default: 0,\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\"],\r\n        defaultUnit: \"px\",\r\n      },\r\n      allowVisualStates: true,\r\n      popout,\r\n    },\r\n    [`${prefix}BoxShadowBlurRadius`]: {\r\n      index: 253,\r\n      group: opts.group || \"Box Shadow\",\r\n      displayName: \"Blur Radius\",\r\n      editorName: editorName(\"Blur Radius\"),\r\n      default: 5,\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\"],\r\n        defaultUnit: \"px\",\r\n      },\r\n      allowVisualStates: true,\r\n      popout,\r\n    },\r\n    [`${prefix}BoxShadowSpreadRadius`]: {\r\n      index: 254,\r\n      group: opts.group || \"Box Shadow\",\r\n      displayName: \"Spread Radius\",\r\n      editorName: editorName(\"Spread Radius\"),\r\n      default: 2,\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"px\"],\r\n        defaultUnit: \"px\",\r\n      },\r\n      allowVisualStates: true,\r\n      popout,\r\n    },\r\n    [`${prefix}BoxShadowInset`]: {\r\n      index: 255,\r\n      group: opts.group || \"Box Shadow\",\r\n      displayName: \"Inset\",\r\n      editorName: editorName(\"Inset\"),\r\n      type: \"boolean\",\r\n      default: false,\r\n      allowVisualStates: true,\r\n      popout,\r\n    },\r\n    [`${prefix}BoxShadowColor`]: {\r\n      index: 256,\r\n      group: opts.group || \"Box Shadow\",\r\n      displayName: \"Shadow Color\",\r\n      editorName: editorName(\"Shadow Color\"),\r\n      type: \"color\",\r\n      default: \"#00000033\",\r\n      allowVisualStates: true,\r\n      popout,\r\n    },\r\n  });\r\n}\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(RangeNode);\r\nNodeSharedPortDefinitions.addTransformInputs(RangeNode);\r\nNodeSharedPortDefinitions.addMarginInputs(RangeNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(RangeNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(RangeNode);\r\naddBorderInputs(RangeNode, { propPrefix: \"track\", popout: trackPopout });\r\naddBorderRadius(RangeNode, { propPrefix: \"track\", popout: trackPopout });\r\naddShadowInputs(RangeNode, {\r\n  propPrefix: \"track\",\r\n  popout: trackPopout,\r\n  group: \"Track Box Shadow\",\r\n});\r\n\r\naddBorderInputs(RangeNode, { propPrefix: \"thumb\", popout: thumbPopout });\r\naddBorderRadius(RangeNode, { propPrefix: \"thumb\", popout: thumbPopout });\r\naddShadowInputs(RangeNode, {\r\n  propPrefix: \"thumb\",\r\n  popout: thumbPopout,\r\n  group: \"Thumb Box Shadow\",\r\n});\r\n\r\nUtils.addControlEventsAndStates(RangeNode);\r\n\r\nexport default createNodeFromReactComponent(RangeNode);\r\n","import React from 'react';\r\n\r\nimport Layout from '../../../layout';\r\nimport Utils from '../../../nodes/controls/utils';\r\nimport { Noodl, Slot } from '../../../types';\r\n\r\n//this stops a text field from being unfocused by the clickHandler in the viewer that handles focus globally.\r\n//The specific case is when a mouseDown is registered in the input, but the mouseUp is outside.\r\n//It'll trigger a focus change that'll blur the input field, which is annyoing when you're selecting text\r\nfunction preventGlobalFocusChange(e) {\r\n  e.stopPropagation();\r\n  window.removeEventListener('click', preventGlobalFocusChange, true);\r\n}\r\n\r\nexport interface TextInputProps extends Noodl.ReactProps {\r\n  id: string;\r\n  type: 'text' | 'textArea' | 'email' | 'number' | 'password' | 'url';\r\n  textStyle: Noodl.TextStyle;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  enabled: boolean;\r\n\r\n  placeholder: string;\r\n  maxLength: number;\r\n\r\n  startValue: string;\r\n  value: string;\r\n\r\n  useLabel: boolean;\r\n  label: string;\r\n  labelSpacing: string;\r\n  labeltextStyle: Noodl.TextStyle;\r\n\r\n  useIcon: boolean;\r\n  iconPlacement: 'left' | 'right';\r\n  iconSpacing: string;\r\n  iconSourceType: 'image' | 'icon';\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n\r\n  onTextChanged?: (value: string) => void;\r\n  onEnter?: () => void;\r\n\r\n  children: Slot;\r\n}\r\n\r\n// Based on (HTMLTextAreaElement | HTMLInputElement)\r\ntype InputRef = (HTMLTextAreaElement | HTMLInputElement) & {\r\n  noodlNode?: Noodl.ReactProps['noodlNode'];\r\n} | null;\r\n\r\ntype State = {\r\n  value: string;\r\n};\r\n\r\nexport class TextInput extends React.Component<TextInputProps, State> {\r\n  ref: React.MutableRefObject<InputRef>;\r\n\r\n  constructor(props: TextInputProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      value: props.startValue\r\n    } satisfies State;\r\n\r\n    this.ref = React.createRef<InputRef>();\r\n  }\r\n\r\n  setText(value: string) {\r\n    this.setState({ value });\r\n    this.props.onTextChanged && this.props.onTextChanged(value);\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Plumbing for the focused signals\r\n    if (this.ref.current) {\r\n      this.ref.current.noodlNode = this.props.noodlNode;\r\n    }\r\n\r\n    this.setText(this.props.startValue);\r\n  }\r\n\r\n  render() {\r\n    const style: React.CSSProperties = { ...this.props.style };\r\n\r\n    Layout.size(style, this.props);\r\n    Layout.align(style, this.props);\r\n\r\n    if (style.opacity === 0) {\r\n      style.pointerEvents = 'none';\r\n    }\r\n\r\n    const { height, ...otherStylesTmp } = style;\r\n    \r\n    // otherStylesTmp is not React.CSSProperties, reassigning it will correct the type.\r\n    const otherStyles: React.CSSProperties = otherStylesTmp;\r\n\r\n    const props = this.props;\r\n\r\n    const _renderIcon = () => {\r\n      if (props.iconSourceType === 'image' && props.iconImageSource !== undefined)\r\n        return (\r\n          <img\r\n            alt=\"\"\r\n            src={props.iconImageSource}\r\n            style={{\r\n              width: props.iconSize,\r\n              height: props.iconSize\r\n            }}\r\n            onClick={() => this.focus()}\r\n          />\r\n        );\r\n      else if (props.iconSourceType === 'icon' && props.iconIconSource !== undefined) {\r\n        const style: React.CSSProperties = {\r\n          userSelect: 'none',\r\n          fontSize: props.iconSize,\r\n          color: props.iconColor\r\n        };\r\n        if (props.iconPlacement === 'left' || props.iconPlacement === undefined) style.marginRight = props.iconSpacing;\r\n        else style.marginLeft = props.iconSpacing;\r\n\r\n        if (props.iconIconSource.codeAsClass === true) {\r\n          return (\r\n            <span className={[props.iconIconSource.class, props.iconIconSource.code].join(' ')} style={style}></span>\r\n          );\r\n        } else {\r\n          return (\r\n            <span className={props.iconIconSource.class} style={style}>\r\n              {props.iconIconSource.code}\r\n            </span>\r\n          );\r\n        }\r\n      }\r\n\r\n      return null;\r\n    };\r\n\r\n    let className = 'ndl-controls-textinput ' + props.id;\r\n    if (props.className) className = className + ' ' + props.className;\r\n\r\n    let inputContent;\r\n\r\n    const inputStyles: React.CSSProperties = {\r\n      ...props.textStyle,\r\n      ...props.styles.input,\r\n      width: '100%',\r\n      height: '100%'\r\n    };\r\n\r\n    inputStyles.color = props.noodlNode.context.styles.resolveColor(inputStyles.color);\r\n\r\n    const inputProps = {\r\n      ...props.attrs,\r\n      id: props.id,\r\n      value: this.state.value,\r\n      ...Utils.controlEvents(props),\r\n      disabled: !props.enabled,\r\n      style: inputStyles,\r\n      className,\r\n      placeholder: props.placeholder,\r\n      maxLength: props.maxLength,\r\n      onChange: (e) => this.onChange(e)\r\n    };\r\n\r\n    if (props.type !== 'textArea') {\r\n      inputContent = (\r\n        <input\r\n          ref={(ref) => (this.ref.current = ref)}\r\n          type={this.props.type}\r\n          {...inputProps}\r\n          onKeyDown={(e) => this.onKeyDown(e)}\r\n          onMouseDown={() => window.addEventListener('click', preventGlobalFocusChange, true)}\r\n          noodl-style-tag=\"input\"\r\n        />\r\n      );\r\n    } else {\r\n      inputProps.style.resize = 'none'; //disable user resizing\r\n      inputContent = (\r\n        <textarea\r\n          ref={(ref) => (this.ref.current = ref)}\r\n          {...inputProps}\r\n          onKeyDown={(e) => this.onKeyDown(e)}\r\n          noodl-style-tag=\"input\"\r\n        />\r\n      );\r\n    }\r\n\r\n    const inputWrapperStyle = {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      ...props.styles.inputWrapper\r\n    };\r\n\r\n    const heightInPercent = height && height[String(height).length - 1] === '%';\r\n\r\n    if (props.useLabel) {\r\n      if (heightInPercent) {\r\n        inputWrapperStyle.flexGrow = 1;\r\n      } else {\r\n        inputWrapperStyle.height = height;\r\n      }\r\n    } else {\r\n      Object.assign(inputWrapperStyle, otherStyles);\r\n      inputWrapperStyle.height = height;\r\n    }\r\n\r\n    if (props.type !== 'textArea') {\r\n      inputWrapperStyle.alignItems = 'center';\r\n    }\r\n\r\n    const inputWithWrapper = (\r\n      <div style={inputWrapperStyle} noodl-style-tag=\"inputWrapper\">\r\n        {props.useIcon && props.iconPlacement === 'left' ? _renderIcon() : null}\r\n        {inputContent}\r\n        {props.useIcon && props.iconPlacement === 'right' ? _renderIcon() : null}\r\n      </div>\r\n    );\r\n\r\n    if (props.useLabel) {\r\n      otherStyles.display = 'flex';\r\n      otherStyles.flexDirection = 'column';\r\n      if (heightInPercent) otherStyles.height = height;\r\n\r\n      const labelStyle: React.CSSProperties = {\r\n        ...props.labeltextStyle,\r\n        ...props.styles.label,\r\n        marginBottom: props.labelSpacing\r\n      };\r\n      labelStyle.color = props.noodlNode.context.styles.resolveColor(labelStyle.color);\r\n\r\n      return (\r\n        <div style={otherStyles}>\r\n          <label htmlFor={props.id} style={labelStyle} noodl-style-tag=\"label\">\r\n            {props.label}\r\n          </label>\r\n          {inputWithWrapper}\r\n        </div>\r\n      );\r\n    } else {\r\n      return inputWithWrapper;\r\n    }\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    if (e.key === 'Enter' || e.which === 13) {\r\n      this.props.onEnter && this.props.onEnter();\r\n    }\r\n  }\r\n\r\n  onChange(event) {\r\n    const value = event.target.value;\r\n    this.setText(value);\r\n  }\r\n\r\n  focus() {\r\n    this.ref.current && this.ref.current.focus();\r\n  }\r\n\r\n  blur() {\r\n    this.ref.current && this.ref.current.blur();\r\n  }\r\n\r\n  hasFocus() {\r\n    return document.activeElement === this.ref.current;\r\n  }\r\n}\r\n","import { TextInput } from \"../../components/controls/TextInput\";\r\nimport { guid } from \"@fluxscape/runtime\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\nimport Utils from \"./utils\";\r\n\r\nfunction _styleTemplate(className, props) {\r\n  return `\r\n    .${className}::placeholder {\r\n        opacity: ${props.placeholderOpacity};\r\n    }\r\n    `;\r\n}\r\n\r\nconst TextInputNode = {\r\n  name: \"net.noodl.controls.textinput\",\r\n  displayName: \"Text Input\",\r\n  docs: \"https://docs.noodl.net/nodes/ui-controls/text-input\",\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  usePortAsLabel: \"label\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"label\",\r\n  },\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      \"General\",\r\n      \"Text\",\r\n      \"Style\",\r\n      \"Actions\",\r\n      \"Events\",\r\n      \"States\",\r\n      \"Mounted\",\r\n      \"Text Style\",\r\n      \"Label\",\r\n      \"Label Text Style\",\r\n      \"Hover Events\",\r\n      \"Pointer Events\",\r\n      \"Focus Events\",\r\n    ],\r\n  },\r\n  getReactComponent() {\r\n    return TextInput;\r\n  },\r\n  initialize() {\r\n    // @ts-expect-error\r\n    this.props.attrs = {};\r\n    // @ts-expect-error\r\n    this.props.startValue = \"\";\r\n    // @ts-expect-error\r\n    this.props.id = this._internal.controlId = \"input-\" + guid();\r\n  },\r\n  inputProps: {\r\n    type: {\r\n      displayName: \"Type\",\r\n      group: \"Text\",\r\n      index: 19,\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Text\", value: \"text\" },\r\n          { label: \"Text Area\", value: \"textArea\" },\r\n          { label: \"Email\", value: \"email\" },\r\n          { label: \"Number\", value: \"number\" },\r\n          { label: \"Password\", value: \"password\" },\r\n          { label: \"URL\", value: \"url\" },\r\n        ],\r\n      },\r\n      default: \"text\",\r\n    },\r\n    placeholder: {\r\n      index: 22,\r\n      group: \"Text\",\r\n      displayName: \"Placeholder\",\r\n      default: \"Type here...\",\r\n      type: {\r\n        name: \"string\",\r\n      },\r\n    },\r\n    maxLength: {\r\n      group: \"Text\",\r\n      displayName: \"Max length\",\r\n      type: \"number\",\r\n      index: 24,\r\n    },\r\n  },\r\n  inputs: {\r\n    placeHolderOpacity: {\r\n      index: 23,\r\n      group: \"Text\",\r\n      displayName: \"Placeholder opacity\",\r\n      type: \"number\",\r\n      default: 0.5,\r\n      set(value) {\r\n        // @ts-expect-error\r\n        const className = this._internal.controlId;\r\n        Utils.updateStylesForClass(\r\n          className,\r\n          { placeholderOpacity: value },\r\n          _styleTemplate\r\n        );\r\n      },\r\n    },\r\n    set: {\r\n      group: \"Actions\",\r\n      displayName: \"Set\",\r\n      type: \"signal\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          // @ts-expect-error\r\n          this.setText(this._internal.text);\r\n        });\r\n      },\r\n    },\r\n    startValue: {\r\n      index: 18,\r\n      displayName: \"Text\",\r\n      type: \"string\",\r\n      group: \"Text\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        if (this._internal.text === value) return;\r\n\r\n        // @ts-expect-error\r\n        this._internal.text = value;\r\n        // @ts-expect-error\r\n        if (this.isInputConnected(\"set\") === false) {\r\n          // @ts-expect-error\r\n          this.setText(value);\r\n        }\r\n      },\r\n    },\r\n    clear: {\r\n      type: \"signal\",\r\n      group: \"Actions\",\r\n      displayName: \"Clear\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.clear();\r\n      },\r\n    },\r\n    focus: {\r\n      type: \"signal\",\r\n      group: \"Actions\",\r\n      displayName: \"Focus\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.context.setNodeFocused(this, true);\r\n      },\r\n    },\r\n    blur: {\r\n      type: \"signal\",\r\n      group: \"Actions\",\r\n      displayName: \"Blur\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.context.setNodeFocused(this, false);\r\n      },\r\n    },\r\n    textAlignX: {\r\n      group: \"Text Alignment\",\r\n      index: 13,\r\n      displayName: \"Text Horizontal Align\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"left\", value: \"left\" },\r\n          { label: \"center\", value: \"center\" },\r\n          { label: \"right\", value: \"right\" },\r\n        ],\r\n        alignComp: \"justify\",\r\n      },\r\n      default: \"left\",\r\n      set(value) {\r\n        switch (value) {\r\n          case \"left\":\r\n            // @ts-expect-error\r\n            this.setStyle({ textAlign: \"left\" }, \"input\");\r\n            break;\r\n          case \"center\":\r\n            // @ts-expect-error\r\n            this.setStyle({ textAlign: \"center\" }, \"input\");\r\n            break;\r\n          case \"right\":\r\n            // @ts-expect-error\r\n            this.setStyle({ textAlign: \"right\" }, \"input\");\r\n            break;\r\n        }\r\n      },\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: \"Test ID Attribute\",\r\n      group: \"Advanced HTML\",\r\n      type: \"string\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        // @ts-expect-error\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      index: 100,\r\n      displayName: \"Background Color\",\r\n      group: \"Style\",\r\n      type: \"color\",\r\n      default: \"transparent\",\r\n      allowVisualStates: true,\r\n      styleTag: \"inputWrapper\",\r\n    },\r\n  },\r\n  outputProps: {\r\n    // Value\r\n    onTextChanged: {\r\n      group: \"General\",\r\n      displayName: \"Text\",\r\n      type: \"string\",\r\n      index: 1,\r\n      onChange() {\r\n        // @ts-expect-error\r\n        this.sendSignalOnOutput(\"textChanged\");\r\n      },\r\n    },\r\n\r\n    // Events\r\n    onEnter: {\r\n      group: \"Events\",\r\n      displayName: \"On Enter\",\r\n      type: \"signal\",\r\n    },\r\n  },\r\n  outputs: {\r\n    textChanged: {\r\n      displayName: \"Text Changed\",\r\n      type: \"signal\",\r\n      group: \"General\",\r\n      index: 2,\r\n    },\r\n  },\r\n  methods: {\r\n    _focus() {\r\n      // @ts-expect-error\r\n      if (!this.innerReactComponentRef) return;\r\n      // @ts-expect-error\r\n      this.innerReactComponentRef.focus();\r\n    },\r\n    _blur() {\r\n      // @ts-expect-error\r\n      if (!this.innerReactComponentRef) return;\r\n      // @ts-expect-error\r\n      this.innerReactComponentRef.blur();\r\n    },\r\n    clear() {\r\n      // @ts-expect-error\r\n      this.props.startValue = \"\";\r\n      // @ts-expect-error\r\n      if (this.innerReactComponentRef) {\r\n        // @ts-expect-error\r\n        this.innerReactComponentRef.setText(\"\");\r\n      }\r\n    },\r\n    setText(text) {\r\n      // @ts-expect-error\r\n      this.props.startValue = text;\r\n      // @ts-expect-error\r\n      if (this.innerReactComponentRef) {\r\n        //the text component is currently mounted, and will signal the onTextChanged output\r\n        // @ts-expect-error\r\n        if (this.innerReactComponentRef.hasFocus() === false) {\r\n          // @ts-expect-error\r\n          this.innerReactComponentRef.setText(text);\r\n        }\r\n        // @ts-expect-error\r\n      } else if (this.outputPropValues[\"onTextChanged\"] !== text) {\r\n        //text component isn't mounted yet, set the output manually\r\n        // @ts-expect-error\r\n        this.outputPropValues[\"onTextChanged\"] = text;\r\n        // @ts-expect-error\r\n        this.flagOutputDirty(\"onTextChanged\");\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(TextInputNode, {\r\n  defaultSizeMode: \"contentSize\",\r\n  contentLabel: \"Text\",\r\n});\r\nNodeSharedPortDefinitions.addIconInputs(TextInputNode, {\r\n  enableIconPlacement: true,\r\n  defaults: { useIcon: false, iconColor: \"#000000\" },\r\n});\r\nNodeSharedPortDefinitions.addLabelInputs(TextInputNode, {\r\n  enableSpacing: true,\r\n  styleTag: \"label\",\r\n  displayName: \"Label\",\r\n});\r\n\r\nNodeSharedPortDefinitions.addTextStyleInputs(TextInputNode, {\r\n  styleTag: \"input\",\r\n  portPrefix: \"\",\r\n  portIndex: 18,\r\n  popout: {\r\n    group: \"input-text-style\",\r\n    label: \"Text Style\",\r\n    parentGroup: \"Text\",\r\n  },\r\n});\r\n\r\nNodeSharedPortDefinitions.addAlignInputs(TextInputNode);\r\nNodeSharedPortDefinitions.addTransformInputs(TextInputNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(TextInputNode, {\r\n  styleTag: \"inputWrapper\",\r\n});\r\nNodeSharedPortDefinitions.addMarginInputs(TextInputNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(TextInputNode);\r\nNodeSharedPortDefinitions.addBorderInputs(TextInputNode, {\r\n  styleTag: \"inputWrapper\",\r\n});\r\nNodeSharedPortDefinitions.addShadowInputs(TextInputNode, {\r\n  styleTag: \"inputWrapper\",\r\n});\r\nUtils.addControlEventsAndStates(TextInputNode);\r\n\r\nexport default createNodeFromReactComponent(TextInputNode);\r\n","export default class ASyncQueue {\r\n  private queue: Array<{\r\n    promise: () => Promise<any>;\r\n    resolve: (value: any) => void;\r\n    reject: (reason?: any) => void;\r\n  }> = [];\r\n  private workingOnPromise: boolean = false;\r\n\r\n  enqueue(promise: () => Promise<any>): Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n      this.queue.push({\r\n        promise,\r\n        resolve,\r\n        reject,\r\n      });\r\n      this.dequeue();\r\n    });\r\n  }\r\n\r\n  private dequeue(): boolean {\r\n    if (this.workingOnPromise) {\r\n      return false;\r\n    }\r\n    const item = this.queue.shift();\r\n    if (!item) {\r\n      return false;\r\n    }\r\n    try {\r\n      this.workingOnPromise = true;\r\n      item\r\n        .promise()\r\n        .then((value) => {\r\n          this.workingOnPromise = false;\r\n          item.resolve(value);\r\n          this.dequeue();\r\n        })\r\n        .catch((err) => {\r\n          this.workingOnPromise = false;\r\n          item.reject(err);\r\n          this.dequeue();\r\n        });\r\n    } catch (err) {\r\n      this.workingOnPromise = false;\r\n      item.reject(err);\r\n      this.dequeue();\r\n    }\r\n    return true;\r\n  }\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport ASyncQueue from \"../../async-queue\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\nimport NavigationHandler from \"./navigation-handler\";\r\nimport NoodlRuntime, { guid } from \"@fluxscape/runtime\";\r\nimport { Transitions } from \"./transitions\";\r\nimport { ReactNodeDefinition } from \"../../ReactNodeDefinition\";\r\n\r\ninterface PageStackProps {\r\n  didMount: () => void;\r\n  willUnmount: () => void;\r\n  style: React.CSSProperties;\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst PageStackReactComponent: React.FC<PageStackProps> = (props) => {\r\n  const { didMount, willUnmount, style, children } = props;\r\n\r\n  useEffect(() => {\r\n    didMount();\r\n    return () => {\r\n      willUnmount();\r\n    };\r\n  }, [didMount, willUnmount]);\r\n\r\n  return <div style={style}>{children}</div>;\r\n};\r\n\r\ninterface Internal {\r\n  stack: any[];\r\n  topPageName: string;\r\n  stackDepth: number;\r\n  pageInfo: Record<string, any>;\r\n  asyncQueue: ASyncQueue;\r\n  isMounted: boolean;\r\n  name: string;\r\n  useRoutes: boolean;\r\n  pages: any[];\r\n  hasScheduledReset: boolean;\r\n  startPageId: string;\r\n  startPage: string;\r\n  remainingNavigationPath: string[] | undefined;\r\n  isTransitioning: boolean;\r\n}\r\n\r\nconst PageStack: ReactNodeDefinition<Internal> = {\r\n  name: \"Page Stack\",\r\n  displayNodeName: \"Component Stack\",\r\n  category: \"Visuals\",\r\n  docs: \"https://docs.noodl.net/nodes/component-stack/component-stack-node\",\r\n  useVariants: false,\r\n  initialize() {\r\n    this._internal.stack = [];\r\n    this._internal.topPageName = \"\";\r\n    this._internal.stackDepth = 0;\r\n    this._internal.pageInfo = {};\r\n    this._internal.asyncQueue = new ASyncQueue();\r\n\r\n    // @ts-expect-error\r\n    this.onScheduleReset = () => {\r\n      // @ts-expect-error\r\n      this.scheduleReset();\r\n    };\r\n\r\n    // @ts-expect-error\r\n    this.props.didMount = () => {\r\n      this._internal.isMounted = true;\r\n\r\n      // @ts-expect-error\r\n      if (window.history && window.history.pushState) {\r\n        // @ts-expect-error\r\n        window.addEventListener(\"popstate\", this.onScheduleReset);\r\n      } else {\r\n        // @ts-expect-error\r\n        window.addEventListener(\"hashchange\", this.onScheduleReset);\r\n      }\r\n\r\n      // @ts-expect-error\r\n      this._registerPageStack();\r\n    };\r\n\r\n    // @ts-expect-error\r\n    this.props.willUnmount = () => {\r\n      this._internal.isMounted = false;\r\n      // @ts-expect-error\r\n      window.removeEventListener(\"popstate\", this.onScheduleReset);\r\n      // @ts-expect-error\r\n      window.removeEventListener(\"hashchange\", this.onScheduleReset);\r\n      // @ts-expect-error\r\n      this._deregisterPageStack();\r\n    };\r\n  },\r\n  getInspectInfo() {\r\n    if (this._internal.stack.length === 0) {\r\n      return \"No active page\";\r\n    }\r\n\r\n    const info = [{ type: \"text\", value: \"Active Components:\" }];\r\n\r\n    return info.concat(\r\n      this._internal.stack.map((p) => {\r\n        // @ts-expect-error\r\n        const pageInfo = this._findPage(p.pageId);\r\n        return {\r\n          type: \"text\",\r\n          value: \"- \" + pageInfo.label,\r\n        };\r\n      })\r\n    );\r\n  },\r\n  defaultCss: {\r\n    width: \"100%\",\r\n    flex: \"1 1 100%\",\r\n    position: \"relative\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n  },\r\n  // @ts-expect-error\r\n  getReactComponent() {\r\n    return PageStackReactComponent;\r\n  },\r\n  inputs: {\r\n    name: {\r\n      type: { name: \"string\", identifierOf: \"PackStack\" },\r\n      displayName: \"Name\",\r\n      group: \"General\",\r\n      default: \"Main\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this._deregisterPageStack();\r\n        this._internal.name = value;\r\n\r\n        if (this._internal.isMounted) {\r\n          // @ts-expect-error\r\n          this._registerPageStack();\r\n        }\r\n      },\r\n    },\r\n    useRoutes: {\r\n      type: \"boolean\",\r\n      displayName: \"Use Routes\",\r\n      group: \"General\",\r\n      default: false,\r\n      set(value) {\r\n        this._internal.useRoutes = !!value;\r\n      },\r\n    },\r\n    clip: {\r\n      displayName: \"Clip Content\",\r\n      type: \"boolean\",\r\n      group: \"Layout\",\r\n      default: true,\r\n      set(value) {\r\n        if (value) {\r\n          // @ts-expect-error\r\n          this.setStyle({ overflow: \"hidden\" });\r\n        } else {\r\n          // @ts-expect-error\r\n          this.removeStyle([\"overflow\"]);\r\n        }\r\n      },\r\n    },\r\n    pages: {\r\n      type: \"proplist\",\r\n      displayName: \"Components\",\r\n      group: \"Components\",\r\n      set(value) {\r\n        this._internal.pages = value;\r\n        if (this._internal.isMounted) {\r\n          // @ts-expect-error\r\n          this.scheduleReset();\r\n        }\r\n      },\r\n    },\r\n    reset: {\r\n      type: \"signal\",\r\n      displayName: \"Reset\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleReset();\r\n      },\r\n    },\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      type: \"color\",\r\n      displayName: \"Background Color\",\r\n      group: \"Style\",\r\n      default: \"transparent\",\r\n      applyDefault: false,\r\n    },\r\n  },\r\n  outputs: {\r\n    topPageName: {\r\n      type: \"string\",\r\n      displayName: \"Top Component Name\",\r\n      group: \"General\",\r\n      get() {\r\n        return this._internal.topPageName;\r\n      },\r\n    },\r\n    stackDepth: {\r\n      type: \"number\",\r\n      displayName: \"Stack Depth\",\r\n      group: \"General\",\r\n      get() {\r\n        return this._internal.stackDepth;\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    _registerPageStack() {\r\n      NavigationHandler.instance.registerPageStack(this._internal.name, this);\r\n    },\r\n    _deregisterPageStack() {\r\n      NavigationHandler.instance.deregisterPageStack(this._internal.name, this);\r\n    },\r\n    _findPage(pageIdOrLabel: string) {\r\n      if (this._internal.pageInfo[pageIdOrLabel]) {\r\n        const pageInfo = this._internal.pageInfo[pageIdOrLabel];\r\n        const pageRef = this._internal.pages.find(\r\n          (x) => x.id === pageIdOrLabel\r\n        );\r\n        return {\r\n          component: String(pageInfo.component),\r\n          label: String(pageRef.label),\r\n          id: String(pageIdOrLabel),\r\n        };\r\n      }\r\n\r\n      const pageRef = this._internal.pages.find(\r\n        (x) => x.label === pageIdOrLabel\r\n      );\r\n      if (pageRef) {\r\n        const pageInfo = this._internal.pageInfo[pageRef.id];\r\n        return {\r\n          component: String(pageInfo.component),\r\n          label: String(pageRef.label),\r\n          id: String(pageRef.id),\r\n        };\r\n      }\r\n\r\n      return undefined;\r\n    },\r\n    setPageOutputs(outputs: Record<string, any>) {\r\n      for (const prop in outputs) {\r\n        this._internal[prop] = outputs[prop];\r\n        this.flagOutputDirty(prop);\r\n      }\r\n    },\r\n    scheduleReset() {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledReset) {\r\n        internal.hasScheduledReset = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          internal.hasScheduledReset = false;\r\n          // @ts-expect-error\r\n          this.reset();\r\n        });\r\n      }\r\n    },\r\n    createPageContainer() {\r\n      const group = this.nodeScope!.createPrimitiveNode(\"Group\");\r\n      group.setStyle({ flex: \"1 0 100%\" });\r\n      return group;\r\n    },\r\n    reset() {\r\n      // @ts-expect-error\r\n      this._internal.asyncQueue.enqueue(this.resetAsync.bind(this));\r\n    },\r\n    async resetAsync() {\r\n      // @ts-expect-error\r\n      const children = this.getChildren();\r\n      for (const c of children) {\r\n        // @ts-expect-error\r\n        this.removeChild(c);\r\n        // @ts-expect-error\r\n        this.nodeScope.deleteNode(c);\r\n      }\r\n\r\n      if (\r\n        this._internal.pages === undefined ||\r\n        this._internal.pages.length === 0\r\n      )\r\n        return;\r\n\r\n      let startPageId;\r\n      let params = {};\r\n\r\n      // @ts-expect-error\r\n      const pageFromUrl = this.matchPageFromUrl();\r\n      if (pageFromUrl !== undefined) {\r\n        startPageId = pageFromUrl.pageId;\r\n        params = { ...pageFromUrl.query, ...pageFromUrl.params };\r\n      } else {\r\n        startPageId = this._internal.startPageId;\r\n        if (startPageId === undefined) startPageId = this._internal.pages[0].id;\r\n      }\r\n\r\n      // @ts-expect-error\r\n      const pageInfo = this._findPage(startPageId);\r\n      if (pageInfo === undefined || pageInfo.component === undefined) {\r\n        return;\r\n      }\r\n\r\n      // @ts-expect-error\r\n      const content = await this.nodeScope.createNode(\r\n        pageInfo.component,\r\n        guid()\r\n      );\r\n\r\n      for (const key in params) {\r\n        content.setInputValue(key, params[key]);\r\n      }\r\n\r\n      // @ts-expect-error\r\n      const group = this.createPageContainer();\r\n      group.addChild(content);\r\n\r\n      // @ts-expect-error\r\n      this.addChild(group);\r\n      this._internal.stack = [\r\n        {\r\n          from: null,\r\n          page: group,\r\n          pageId: startPageId,\r\n          pageInfo: pageInfo,\r\n          params: params,\r\n          componentName: this._internal.startPage,\r\n        },\r\n      ];\r\n\r\n      // @ts-expect-error\r\n      this.setPageOutputs({\r\n        topPageName: pageInfo.label,\r\n        stackDepth: this._internal.stack.length,\r\n      });\r\n    },\r\n    getRelativeURL() {\r\n      const top = this._internal.stack[this._internal.stack.length - 1];\r\n      if (top === undefined) return;\r\n\r\n      let urlPath = top.pageInfo.path;\r\n      if (urlPath === undefined) {\r\n        const pageItem = this._internal.pages.find((p) => p.id == top.pageId);\r\n        if (pageItem === undefined) return;\r\n\r\n        urlPath = pageItem.label.replace(/\\s+/g, \"-\").toLowerCase();\r\n      }\r\n\r\n      const paramsInPath = urlPath.match(/{([^}]+)}/g);\r\n      const params = { ...top.params };\r\n      if (paramsInPath) {\r\n        for (const param of paramsInPath) {\r\n          const key = param.replace(/[{}]/g, \"\");\r\n          if (top.params[key] !== undefined) {\r\n            urlPath = urlPath.replace(param, encodeURIComponent(params[key]));\r\n            delete params[key];\r\n          }\r\n        }\r\n      }\r\n\r\n      const query = Object.keys(params).map((key) => ({\r\n        name: key,\r\n        value: params[key],\r\n      }));\r\n\r\n      if (urlPath.startsWith(\"/\")) urlPath = urlPath.substring(1);\r\n\r\n      return {\r\n        path: urlPath,\r\n        query: query,\r\n      };\r\n    },\r\n    getNavigationAbsoluteURL() {\r\n      // @ts-expect-error\r\n      let parent = this.parent;\r\n\r\n      while (\r\n        parent !== undefined &&\r\n        typeof parent.getNavigationAbsoluteURL !== \"function\"\r\n      ) {\r\n        parent = parent.getVisualParentNode();\r\n      }\r\n\r\n      const parentUrl =\r\n        parent === undefined\r\n          ? { path: \"\", query: [] }\r\n          : parent.getNavigationAbsoluteURL();\r\n      // @ts-expect-error\r\n      const thisUrl = this.getRelativeURL();\r\n      if (thisUrl === undefined) return parentUrl;\r\n\r\n      return {\r\n        path:\r\n          parentUrl.path +\r\n          (parentUrl.path.endsWith(\"/\") ? \"\" : \"/\") +\r\n          thisUrl.path,\r\n        query: parentUrl.query.concat(thisUrl.query),\r\n      };\r\n    },\r\n    _getLocationPath() {\r\n      const navigationPathType =\r\n        NoodlRuntime.instance.getProjectSettings()[\"navigationPathType\"];\r\n      if (navigationPathType === undefined || navigationPathType === \"hash\") {\r\n        let hash = location.hash;\r\n        if (hash) {\r\n          if (hash[0] === \"#\") hash = hash.substring(1);\r\n          if (hash[0] === \"/\") hash = hash.substring(1);\r\n        }\r\n        return hash;\r\n      } else {\r\n        let path = location.pathname;\r\n        if (path) {\r\n          if (path[0] === \"/\") path = path.substring(1);\r\n        }\r\n        return path;\r\n      }\r\n    },\r\n    _getSearchParams() {\r\n      const pl = /\\+/g;\r\n      const search = /([^&=]+)=?([^&]*)/g;\r\n      const decode = (s: string) => decodeURIComponent(s.replace(pl, \" \"));\r\n      const query = window.location.search.substring(1);\r\n\r\n      let match: RegExpExecArray | null;\r\n      const urlParams: Record<string, string> = {};\r\n      while ((match = search.exec(query))) {\r\n        urlParams[decode(match[1])] = decode(match[2]);\r\n      }\r\n\r\n      return urlParams;\r\n    },\r\n    getNavigationRemainingPath() {\r\n      return this._internal.remainingNavigationPath;\r\n    },\r\n    matchPageFromUrl(url?: string) {\r\n      if (!this._internal.useRoutes) return;\r\n      if (\r\n        this._internal.pages === undefined ||\r\n        this._internal.pages.length === 0\r\n      )\r\n        return;\r\n\r\n      // @ts-expect-error\r\n      let parent = this.parent;\r\n      while (\r\n        parent !== undefined &&\r\n        typeof parent.getNavigationRemainingPath !== \"function\"\r\n      ) {\r\n        parent = parent.getVisualParentNode();\r\n      }\r\n\r\n      const pathParts =\r\n        parent === undefined\r\n          ? // @ts-expect-error\r\n            this._getLocationPath().split(\"/\").filter(Boolean)\r\n          : parent.getNavigationRemainingPath();\r\n      if (pathParts === undefined) return;\r\n\r\n      // @ts-expect-error\r\n      const urlQuery = this._getSearchParams();\r\n\r\n      const _matchPathParts = (path: string[], pattern: string[]) => {\r\n        const params: Record<string, string> = {};\r\n        for (let i = 0; i < pattern.length; i++) {\r\n          if (path[i] === undefined) return;\r\n\r\n          const _p = pattern[i];\r\n          if (_p[0] === \"{\" && _p[_p.length - 1] === \"}\") {\r\n            params[_p.substring(1, _p.length - 1)] = decodeURIComponent(\r\n              path[i]\r\n            );\r\n          } else if (_p !== path[i]) return;\r\n        }\r\n        return {\r\n          params: params,\r\n          remainingPathParts: path.splice(pattern.length),\r\n        };\r\n      };\r\n\r\n      for (const page of this._internal.pages) {\r\n        const pageInfo = this._internal.pageInfo[page.id];\r\n        if (pageInfo === undefined) continue;\r\n\r\n        let pagePattern = pageInfo.path;\r\n        if (pagePattern === undefined) {\r\n          pagePattern = page.label.replace(/\\s+/g, \"-\").toLowerCase();\r\n        }\r\n        if (pagePattern[0] === \"/\") pagePattern = pagePattern.substring(1);\r\n\r\n        const match = _matchPathParts(pathParts, pagePattern.split(\"/\"));\r\n        if (match) {\r\n          this._internal.remainingNavigationPath = match.remainingPathParts;\r\n          return {\r\n            pageId: page.id,\r\n            params: match.params,\r\n            query: urlQuery,\r\n          };\r\n        }\r\n      }\r\n    },\r\n    _updateUrlWithTopPage() {\r\n      if (this._internal.useRoutes && window.history !== undefined) {\r\n        // @ts-expect-error\r\n        const url = this.getNavigationAbsoluteURL();\r\n\r\n        let urlPath, hashPath;\r\n        const navigationPathType =\r\n          NoodlRuntime.instance.getProjectSettings()[\"navigationPathType\"];\r\n        if (navigationPathType === undefined || navigationPathType === \"hash\") {\r\n          hashPath = url.path;\r\n        } else {\r\n          urlPath = url.path;\r\n        }\r\n\r\n        const query = url.query.map((q) => `${q.name}=${q.value}`);\r\n        const compiledUrl =\r\n          (urlPath !== undefined ? urlPath : \"\") +\r\n          (query.length >= 1 ? \"?\" + query.join(\"&\") : \"\") +\r\n          (hashPath !== undefined ? \"#\" + hashPath : \"\");\r\n\r\n        this._internal.remainingNavigationPath = undefined;\r\n        window.history.pushState({}, \"\", compiledUrl);\r\n      }\r\n    },\r\n    replace(args: any) {\r\n      // @ts-expect-error\r\n      this._internal.asyncQueue.enqueue(this.replaceAsync.bind(this, args));\r\n    },\r\n    async replaceAsync(args: any) {\r\n      if (\r\n        this._internal.pages === undefined ||\r\n        this._internal.pages.length === 0\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      if (this._internal.isTransitioning) {\r\n        return;\r\n      }\r\n\r\n      const pageId = args.target || this._internal.pages[0].id;\r\n\r\n      // @ts-expect-error\r\n      const pageInfo = this._findPage(pageId);\r\n      if (pageInfo === undefined || pageInfo.component === undefined) {\r\n        return;\r\n      }\r\n\r\n      // @ts-expect-error\r\n      const children = this.getChildren();\r\n      for (const c of children) {\r\n        // @ts-expect-error\r\n        this.removeChild(c);\r\n        // @ts-expect-error\r\n        this.nodeScope.deleteNode(c);\r\n      }\r\n\r\n      // @ts-expect-error\r\n      const group = this.createPageContainer();\r\n      // @ts-expect-error\r\n      const content = await this.nodeScope.createNode(\r\n        pageInfo.component,\r\n        guid()\r\n      );\r\n      for (const key in args.params) {\r\n        content.setInputValue(key, args.params[key]);\r\n      }\r\n      group.addChild(content);\r\n      // @ts-expect-error\r\n      this.addChild(group);\r\n\r\n      this._internal.stack = [\r\n        {\r\n          from: null,\r\n          page: group,\r\n          pageId: pageId,\r\n          pageInfo: pageInfo,\r\n          params: args.params,\r\n          componentName: args.target,\r\n        },\r\n      ];\r\n\r\n      // @ts-expect-error\r\n      this.setPageOutputs({\r\n        topPageName: pageInfo.label,\r\n        stackDepth: this._internal.stack.length,\r\n      });\r\n\r\n      // @ts-expect-error\r\n      this._updateUrlWithTopPage();\r\n      args.hasNavigated && args.hasNavigated();\r\n    },\r\n    navigate(args: any) {\r\n      // @ts-expect-error\r\n      this._internal.asyncQueue.enqueue(this.navigateAsync.bind(this, args));\r\n    },\r\n    async navigateAsync(args: any) {\r\n      if (\r\n        this._internal.pages === undefined ||\r\n        this._internal.pages.length === 0\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      if (this._internal.isTransitioning) {\r\n        return;\r\n      }\r\n\r\n      const pageId = args.target || this._internal.pages[0].id;\r\n\r\n      // @ts-expect-error\r\n      const pageInfo = this._findPage(pageId);\r\n      if (pageInfo === undefined || pageInfo.component === undefined) {\r\n        return;\r\n      }\r\n\r\n      // @ts-expect-error\r\n      const group = this.createPageContainer();\r\n      group.setInputValue(\"position\", \"absolute\");\r\n\r\n      // @ts-expect-error\r\n      const content = await this.nodeScope.createNode(\r\n        pageInfo.component,\r\n        guid()\r\n      );\r\n      for (const key in args.params) {\r\n        content.setInputValue(key, args.params[key]);\r\n      }\r\n      group.addChild(content);\r\n\r\n      const navigateBackNodes = content.nodeScope.getNodesWithType(\r\n        \"PageStackNavigateBack\"\r\n      );\r\n      if (navigateBackNodes && navigateBackNodes.length > 0) {\r\n        for (const node of navigateBackNodes) {\r\n          // @ts-expect-error\r\n          node._setBackCallback(this.back.bind(this));\r\n        }\r\n      }\r\n\r\n      const top = this._internal.stack[this._internal.stack.length - 1];\r\n      const newTop = {\r\n        from: top.page,\r\n        page: group,\r\n        pageInfo: pageInfo,\r\n        pageId: pageId,\r\n        params: args.params,\r\n        transition: new Transitions[args.transition.type || \"Push\"](\r\n          top.page,\r\n          group,\r\n          args.transition\r\n        ),\r\n        backCallback: args.backCallback,\r\n        componentName: args.target,\r\n      };\r\n      this._internal.stack.push(newTop);\r\n      // @ts-expect-error\r\n      this.setPageOutputs({\r\n        topPageName: pageInfo.label,\r\n        stackDepth: this._internal.stack.length,\r\n      });\r\n      // @ts-expect-error\r\n      this._updateUrlWithTopPage();\r\n\r\n      newTop.transition.forward(0);\r\n      this._internal.isTransitioning = true;\r\n      newTop.transition.start({\r\n        end: () => {\r\n          this._internal.isTransitioning = false;\r\n          // @ts-expect-error\r\n          this.removeChild(top.page);\r\n          group.setInputValue(\"position\", \"relative\");\r\n        },\r\n      });\r\n\r\n      // @ts-expect-error\r\n      this.addChild(group);\r\n      args.hasNavigated && args.hasNavigated();\r\n    },\r\n    back(args: any) {\r\n      if (this._internal.stack.length <= 1) return;\r\n      if (this._internal.isTransitioning) return;\r\n\r\n      const top = this._internal.stack[this._internal.stack.length - 1];\r\n      top.page.setInputValue(\"position\", \"absolute\");\r\n      // @ts-expect-error\r\n      this.addChild(top.from, 0);\r\n      top.backCallback && top.backCallback(args.backAction, args.results);\r\n\r\n      // @ts-expect-error\r\n      const pageInfo = this._findPage(\r\n        this._internal.stack[this._internal.stack.length - 2].pageId\r\n      );\r\n      // @ts-expect-error\r\n      this.setPageOutputs({\r\n        topPageName: pageInfo.label,\r\n        stackDepth: this._internal.stack.length - 1,\r\n      });\r\n\r\n      this._internal.isTransitioning = true;\r\n      top.transition.start({\r\n        end: () => {\r\n          this._internal.isTransitioning = false;\r\n          top.page.setInputValue(\"position\", \"relative\");\r\n          // @ts-expect-error\r\n          this.removeChild(top.page);\r\n          // @ts-expect-error\r\n          this.nodeScope.deleteNode(top.page);\r\n          this._internal.stack.pop();\r\n          // @ts-expect-error\r\n          this._updateUrlWithTopPage();\r\n        },\r\n        back: true,\r\n      });\r\n    },\r\n    setPageComponent(pageId: string, component: any) {\r\n      const internal = this._internal;\r\n      if (!internal.pageInfo[pageId]) internal.pageInfo[pageId] = {};\r\n      internal.pageInfo[pageId].component = component;\r\n    },\r\n    setPagePath(pageId: string, path: string) {\r\n      const internal = this._internal;\r\n      if (!internal.pageInfo[pageId]) internal.pageInfo[pageId] = {};\r\n      internal.pageInfo[pageId].path = path;\r\n    },\r\n    setStartPage(pageId: string) {\r\n      this._internal.startPageId = pageId;\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name.startsWith(\"pageComp-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setPageComponent.bind(\r\n            this,\r\n            name.substring(\"pageComp-\".length)\r\n          ),\r\n        });\r\n\r\n      if (name.startsWith(\"pagePath-\"))\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setPagePath.bind(this, name.substring(\"pagePath-\".length)),\r\n        });\r\n\r\n      if (name === \"startPage\")\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setStartPage.bind(this),\r\n        });\r\n    },\r\n  },\r\n  setup(context: any, graphModel: any) {\r\n    if (\r\n      !context.editorConnection ||\r\n      !context.editorConnection.isRunningLocally()\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node: any) {\r\n      function _updatePorts() {\r\n        const ports: any[] = [];\r\n\r\n        if (\r\n          node.parameters[\"pages\"] !== undefined &&\r\n          node.parameters[\"pages\"].length > 0\r\n        ) {\r\n          node.parameters[\"pages\"].forEach((p: any) => {\r\n            ports.push({\r\n              name: \"pageComp-\" + p.id,\r\n              displayName: \"Component\",\r\n              editorName: p.label + \" | Component\",\r\n              plug: \"input\",\r\n              type: \"component\",\r\n              parent: \"pages\",\r\n              parentItemId: p.id,\r\n            });\r\n\r\n            if (node.parameters[\"useRoutes\"] === true) {\r\n              ports.push({\r\n                name: \"pagePath-\" + p.id,\r\n                displayName: \"Path\",\r\n                editorName: p.label + \" | Path\",\r\n                plug: \"input\",\r\n                type: \"string\",\r\n                default: p.label.replace(/\\s+/g, \"-\").toLowerCase(),\r\n                parent: \"pages\",\r\n                parentItemId: p.id,\r\n              });\r\n            }\r\n          });\r\n\r\n          ports.push({\r\n            plug: \"input\",\r\n            type: {\r\n              name: \"enum\",\r\n              enums: node.parameters[\"pages\"].map((p: any) => ({\r\n                label: p.label,\r\n                value: p.id,\r\n              })),\r\n              allowEditOnly: true,\r\n            },\r\n            group: \"General\",\r\n            displayName: \"Start Page\",\r\n            name: \"startPage\",\r\n            default: node.parameters[\"pages\"][0].id,\r\n          });\r\n        }\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on(\"parameterUpdated\", function (ev: any) {\r\n        if (ev.name === \"pages\" || ev.name === \"useRoutes\") _updatePorts();\r\n      });\r\n    }\r\n\r\n    graphModel.on(\"editorImportComplete\", () => {\r\n      graphModel.on(\"nodeAdded.Page Stack\", function (node: any) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType(\"Page Stack\")) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  },\r\n};\r\n\r\nexport default createNodeFromReactComponent(PageStack);\r\n","import React from \"react\";\r\n\r\nimport type { TSFixme } from \"../../../../typings/global\";\r\nimport Layout from \"../../../layout\";\r\nimport { Noodl, Slot } from \"../../../types\";\r\n\r\ntype MetaTag = {\r\n  isProperty: boolean;\r\n  key: string;\r\n  displayName: string;\r\n  editorName?: string;\r\n  group: string;\r\n  type?: string;\r\n  popout?: TSFixme;\r\n};\r\n\r\nconst ogPopout = {\r\n  group: \"seo-og\",\r\n  label: \"Open Graph\",\r\n  parentGroup: \"Experimental SEO\",\r\n};\r\n\r\nconst twitterPopout = {\r\n  group: \"seo-twitter\",\r\n  label: \"Twitter\",\r\n  parentGroup: \"Experimental SEO\",\r\n};\r\n\r\nexport const META_TAGS: MetaTag[] = [\r\n  {\r\n    isProperty: true,\r\n    key: \"description\",\r\n    displayName: \"Description\",\r\n    group: \"Experimental SEO\",\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: \"robots\",\r\n    displayName: \"Robots\",\r\n    group: \"Experimental SEO\",\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: \"og:title\",\r\n    displayName: \"Title\",\r\n    editorName: \"OG Title\",\r\n    group: \"General\",\r\n    popout: ogPopout,\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: \"og:description\",\r\n    displayName: \"Description\",\r\n    editorName: \"OG Description\",\r\n    group: \"General\",\r\n    popout: ogPopout,\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: \"og:url\",\r\n    displayName: \"Url\",\r\n    editorName: \"OG Url\",\r\n    group: \"General\",\r\n    popout: ogPopout,\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: \"og:type\",\r\n    displayName: \"Type\",\r\n    editorName: \"OG Type\",\r\n    group: \"General\",\r\n    popout: ogPopout,\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: \"og:image\",\r\n    displayName: \"Image\",\r\n    editorName: \"OG Image\",\r\n    group: \"Image\",\r\n    popout: ogPopout,\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: \"og:image:width\",\r\n    displayName: \"Image Width\",\r\n    editorName: \"OG Image Width\",\r\n    group: \"Image\",\r\n    popout: ogPopout,\r\n  },\r\n  {\r\n    isProperty: true,\r\n    key: \"og:image:height\",\r\n    displayName: \"Image Height\",\r\n    editorName: \"OG Image Height\",\r\n    group: \"Image\",\r\n    popout: ogPopout,\r\n  },\r\n  {\r\n    isProperty: false,\r\n    key: \"twitter:card\",\r\n    displayName: \"Card\",\r\n    editorName: \"Twitter Card\",\r\n    group: \"General\",\r\n    popout: twitterPopout,\r\n  },\r\n  {\r\n    isProperty: false,\r\n    key: \"twitter:title\",\r\n    displayName: \"Title\",\r\n    editorName: \"Twitter Title\",\r\n    group: \"General\",\r\n    popout: twitterPopout,\r\n  },\r\n  {\r\n    isProperty: false,\r\n    key: \"twitter:description\",\r\n    displayName: \"Description\",\r\n    editorName: \"Twitter Description\",\r\n    group: \"General\",\r\n    popout: twitterPopout,\r\n  },\r\n  {\r\n    isProperty: false,\r\n    key: \"twitter:image\",\r\n    displayName: \"Image\",\r\n    editorName: \"Twitter Image\",\r\n    group: \"General\",\r\n    popout: twitterPopout,\r\n  },\r\n];\r\n\r\ntype MetaTagKey = typeof META_TAGS[number][\"key\"];\r\n\r\nexport interface PageProps extends Noodl.ReactProps {\r\n  metatags?: Record<MetaTagKey, string>;\r\n\r\n  children: Slot;\r\n}\r\n\r\nexport function Page(props: PageProps) {\r\n  const { style, children } = props;\r\n\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  // Allow changing the metatags from inputs\r\n  META_TAGS.forEach((item) => {\r\n    const value = props.metatags && props.metatags[item.key];\r\n    // @ts-expect-error Noodl is globally defined.\r\n    Noodl.SEO.setMeta(item.key, value);\r\n  });\r\n\r\n  return (\r\n    <div style={style} className={props.className}>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n","import { META_TAGS, Page } from \"../../components/navigation/Page\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\nimport { ReactNodeDefinition } from \"../../ReactNodeDefinition\";\r\n\r\ninterface Internal {\r\n  urlPath?: string;\r\n  title?: string;\r\n}\r\n\r\nexport const node: ReactNodeDefinition<Internal> = {\r\n  name: \"Page\",\r\n  displayNodeName: \"Page\",\r\n  category: \"Visuals\",\r\n  docs: \"https://docs.noodl.net/nodes/navigation/page\",\r\n  useVariants: false,\r\n  mountedInput: false,\r\n  allowAsExportRoot: false,\r\n  singleton: true,\r\n  connectionPanel: {\r\n    groupPriority: [\"General\", \"Mounted\"],\r\n  },\r\n  initialize() {\r\n    // @ts-expect-error\r\n    this.props.layout = \"column\"; // this allows the children to know what type of layout type they're in\r\n    if (this.isInputConnected(\"onPageReady\")) {\r\n      // @ts-expect-error\r\n      this.nodeScope.context.eventEmitter.emit(\"SSR_PageLoading\", this.id);\r\n    }\r\n  },\r\n  defaultCss: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    position: \"relative\",\r\n    alignItems: \"flex-start\",\r\n    flex: \"1 1\",\r\n    alignSelf: \"stretch\",\r\n  },\r\n  // @ts-expect-error\r\n  getReactComponent() {\r\n    return Page;\r\n  },\r\n  inputs: {\r\n    sitemapIncluded: {\r\n      index: 80001,\r\n      displayName: \"Included\",\r\n      group: \"Experimental Sitemap\",\r\n      default: true,\r\n      type: {\r\n        name: \"boolean\",\r\n        allowEditOnly: true,\r\n      },\r\n    },\r\n    sitemapChangefreq: {\r\n      index: 80002,\r\n      displayName: \"Change Freq\",\r\n      group: \"Experimental Sitemap\",\r\n      default: \"weekly\",\r\n      type: {\r\n        name: \"enum\",\r\n        allowEditOnly: true,\r\n        enums: [\r\n          { label: \"always\", value: \"always\" },\r\n          { label: \"hourly\", value: \"hourly\" },\r\n          { label: \"daily\", value: \"daily\" },\r\n          { label: \"weekly\", value: \"weekly\" },\r\n          { label: \"monthly\", value: \"monthly\" },\r\n          { label: \"yearly\", value: \"yearly\" },\r\n          { label: \"never\", value: \"never\" },\r\n        ],\r\n      },\r\n    },\r\n    sitemapPriority: {\r\n      index: 80003,\r\n      displayName: \"Priority\",\r\n      group: \"Experimental Sitemap\",\r\n      default: 0.5,\r\n      type: {\r\n        name: \"number\",\r\n        allowEditOnly: true,\r\n      },\r\n    },\r\n  },\r\n  inputProps: META_TAGS.reduce((result, x, index) => {\r\n    result[x.key] = {\r\n      index: 80000 + index,\r\n      displayName: x.displayName,\r\n      editorName: x.editorName || x.displayName,\r\n      propPath: \"metatags\",\r\n      group: x.group,\r\n      popout: x.popout,\r\n      type: x.type || \"string\",\r\n    };\r\n    return result;\r\n  }, {}),\r\n  methods: {\r\n    getUrlPath() {\r\n      return this._internal.urlPath;\r\n    },\r\n    getTitle() {\r\n      return this._internal.title;\r\n    },\r\n    setTitle(value: string) {\r\n      this._internal.title = value;\r\n    },\r\n    setUrlPath(value: string) {\r\n      this._internal.urlPath = value;\r\n    },\r\n    registerInputIfNeeded(name: string) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n\r\n      if (name === \"title\") {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setTitle.bind(this),\r\n        });\r\n      }\r\n\r\n      if (name === \"urlPath\") {\r\n        return this.registerInput(name, {\r\n          // @ts-expect-error\r\n          set: this.setUrlPath.bind(this),\r\n        });\r\n      }\r\n    },\r\n  },\r\n  setup(context, graphModel) {\r\n    if (\r\n      !context.editorConnection ||\r\n      !context.editorConnection.isRunningLocally()\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    function _managePortsForNode(node) {\r\n      function _updatePorts() {\r\n        const ports = [];\r\n\r\n        // Title and urlpath ports\r\n        const titleParts = node.component.name.split(\"/\");\r\n        // @ts-expect-error\r\n        ports.push({\r\n          name: \"title\",\r\n          displayName: \"Title\",\r\n          type: \"string\",\r\n          group: \"General\",\r\n          plug: \"input\",\r\n          default: titleParts[titleParts.length - 1],\r\n        });\r\n\r\n        const title =\r\n          node.parameters[\"title\"] || titleParts[titleParts.length - 1];\r\n        const defaultUrlPath = title.replace(/\\s+/g, \"-\").toLowerCase();\r\n        // @ts-expect-error\r\n        ports.push({\r\n          name: \"urlPath\",\r\n          displayName: \"Url Path\",\r\n          type: \"string\",\r\n          group: \"General\",\r\n          plug: \"input\",\r\n          default: defaultUrlPath,\r\n        });\r\n\r\n        context.editorConnection.sendDynamicPorts(node.id, ports);\r\n      }\r\n\r\n      _updatePorts();\r\n      node.on(\"parameterUpdated\", function (ev) {\r\n        if (ev.name === \"title\") _updatePorts();\r\n      });\r\n    }\r\n\r\n    graphModel.on(\"editorImportComplete\", () => {\r\n      graphModel.on(\"nodeAdded.Page\", function (node) {\r\n        _managePortsForNode(node);\r\n      });\r\n\r\n      graphModel.on(\"componentRenamed\", function (component) {\r\n        const page = graphModel\r\n          .getNodesWithType(\"Page\")\r\n          .filter((x) => component.roots.includes(x.id));\r\n        if (page.length > 0) {\r\n          _managePortsForNode(page[0]);\r\n        }\r\n      });\r\n\r\n      for (const node of graphModel.getNodesWithType(\"Page\")) {\r\n        _managePortsForNode(node);\r\n      }\r\n    });\r\n  },\r\n};\r\n\r\nNodeSharedPortDefinitions.addPaddingInputs(node);\r\n\r\nexport default createNodeFromReactComponent(node);\r\n","import React, { useEffect } from \"react\";\r\n\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\nimport { Noodl, Slot } from \"../../types\";\r\nimport {\r\n  ComponentPageInfo,\r\n  NavigateArgs,\r\n  RouterHandler,\r\n} from \"./router-handler\";\r\nimport ASyncQueue from \"../../async-queue\";\r\nimport { ReactNodeDefinition } from \"../../ReactNodeDefinition\";\r\nimport NoodlRuntime, { guid } from \"@fluxscape/runtime\";\r\n\r\nexport interface RouterReactComponentProps extends Noodl.ReactProps {\r\n  didMount: () => void;\r\n  willUnmount: () => void;\r\n\r\n  children: Slot;\r\n}\r\n\r\nfunction RouterReactComponent(props: RouterReactComponentProps) {\r\n  const { didMount, willUnmount, children, style } = props;\r\n\r\n  useEffect(() => {\r\n    didMount();\r\n    return () => {\r\n      willUnmount();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div className={props.className} style={style}>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction _trimUrlPart(url) {\r\n  if (url[0] === \"/\") url = url.substring(1);\r\n  if (url[url.length - 1] === \"/\") url = url.substring(0, url.length - 1);\r\n  return url;\r\n}\r\n\r\nfunction getBaseUrlLength(url: string): number {\r\n  // If the URL is a full URL, then we only want to get the pathname.\r\n  // Otherwise we just return the url length which should be the pathname.\r\n  if (!url.startsWith(\"/\")) {\r\n    try {\r\n      // Lets say the baseUrl is:\r\n      // \"https://collar-zippy-overcome.sandbox.noodl.app/my-folder\"\r\n      // Then we want to remove \"/my-folder\" from the substring\r\n      return new URL(url).pathname.length;\r\n    } catch {\r\n      /* noop */\r\n    }\r\n  }\r\n\r\n  return url.length;\r\n}\r\n\r\ninterface Internal {\r\n  asyncQueue: ASyncQueue;\r\n  isMounted: boolean;\r\n  hasScheduledReset: boolean;\r\n  currentUrl: string;\r\n  currentPage: ComponentPageInfo;\r\n  currentPageComponent: Node;\r\n  currentParams: NavigateArgs[\"params\"];\r\n  remainingNavigationPath: string[];\r\n  urlPath: string;\r\n  name: string;\r\n}\r\n\r\nconst RouterNode: ReactNodeDefinition<Internal, RouterReactComponentProps> = {\r\n  name: \"Router\",\r\n  displayNodeName: \"Page Router\",\r\n  category: \"Visuals\",\r\n  docs: \"https://docs.noodl.net/nodes/navigation/page-router\",\r\n  useVariants: false,\r\n  connectionPanel: {\r\n    groupPriority: [\"General\", \"Actions\", \"Events\", \"Mounted\"],\r\n  },\r\n  initialize() {\r\n    this._internal.asyncQueue = new ASyncQueue();\r\n\r\n    // @ts-expect-error\r\n    this.onScheduleReset = () => {\r\n      // @ts-expect-error\r\n      this.scheduleReset();\r\n    };\r\n\r\n    // @ts-expect-error\r\n    this.props.didMount = () => {\r\n      this._internal.isMounted = true;\r\n\r\n      // SSR Support\r\n      if (typeof window !== \"undefined\") {\r\n        // Listen to push state events and update stack\r\n        // @ts-expect-error\r\n        if (window.history && window.history.pushState) {\r\n          //this is event is manually sent on push, so covers both pop and push state\r\n          // @ts-expect-error\r\n          window.addEventListener(\"popstate\", this.onScheduleReset);\r\n        } else {\r\n          // Only hash support\r\n          // @ts-expect-error\r\n          window.addEventListener(\"hashchange\", this.onScheduleReset);\r\n        }\r\n      }\r\n\r\n      // @ts-expect-error\r\n      this._registerRouter();\r\n    };\r\n\r\n    // @ts-expect-error\r\n    this.props.willUnmount = () => {\r\n      this._internal.isMounted = false;\r\n\r\n      // @ts-expect-error\r\n      window.removeEventListener(\"popstate\", this.onScheduleReset);\r\n      // @ts-expect-error\r\n      window.removeEventListener(\"hashchange\", this.onScheduleReset);\r\n\r\n      // @ts-expect-error\r\n      this._deregisterRouter();\r\n    };\r\n\r\n    // @ts-expect-error\r\n    this.props.layout = \"column\";\r\n  },\r\n  getInspectInfo() {\r\n    return this._internal.currentUrl;\r\n  },\r\n  defaultCss: {\r\n    flex: \"1 1\",\r\n    alignSelf: \"stretch\",\r\n    position: \"relative\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n  },\r\n  getReactComponent() {\r\n    return RouterReactComponent;\r\n  },\r\n  inputs: {\r\n    name: {\r\n      type: \"string\",\r\n      displayName: \"Name\",\r\n      group: \"General\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this._deregisterRouter();\r\n        this._internal.name = value;\r\n\r\n        if (this._internal.isMounted) {\r\n          // @ts-expect-error\r\n          this._registerRouter();\r\n        }\r\n      },\r\n    },\r\n    pages: {\r\n      type: { name: \"pages\", allowEditOnly: true },\r\n      displayName: \"Pages\",\r\n      group: \"Pages\",\r\n      set(value) {\r\n        // @ts-expect-error\r\n        this._internal.pages = value;\r\n        if (this._internal.isMounted) {\r\n          // @ts-expect-error\r\n          this.scheduleReset();\r\n        }\r\n      },\r\n    },\r\n    urlPath: {\r\n      type: \"string\",\r\n      displayName: \"Url path\",\r\n      group: \"General\",\r\n      set(value) {\r\n        this._internal.urlPath = value;\r\n      },\r\n    },\r\n    clip: {\r\n      displayName: \"Clip Behavior\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { value: \"contentHeight\", label: \"Expand to content size\" },\r\n          { value: \"scroll\", label: \"Scroll\" },\r\n          { value: \"clip\", label: \"Clip content\" },\r\n        ],\r\n      },\r\n      group: \"Layout\",\r\n      default: \"contentHeight\",\r\n      set(value) {\r\n        switch (value) {\r\n          case \"scroll\":\r\n            // @ts-expect-error\r\n            this.setStyle({ overflow: \"auto\" });\r\n            break;\r\n          case \"clip\":\r\n            // @ts-expect-error\r\n            this.setStyle({ overflow: \"hidden\" });\r\n            break;\r\n          default:\r\n            // @ts-expect-error\r\n            this.removeStyle([\"overflow\"]);\r\n            break;\r\n        }\r\n      },\r\n    },\r\n    reset: {\r\n      type: \"signal\",\r\n      displayName: \"Reset\",\r\n      group: \"Actions\",\r\n      valueChangedToTrue() {\r\n        // @ts-expect-error\r\n        this.scheduleReset();\r\n      },\r\n    },\r\n  },\r\n  inputCss: {\r\n    backgroundColor: {\r\n      type: \"color\",\r\n      displayName: \"Background Color\",\r\n      group: \"Style\",\r\n      default: \"transparent\",\r\n      applyDefault: false,\r\n    },\r\n  },\r\n  outputs: {\r\n    currentPageTitle: {\r\n      type: \"string\",\r\n      group: \"General\",\r\n      displayName: \"Current Page Title\",\r\n      getter() {\r\n        return this._internal.currentPage !== undefined\r\n          ? this._internal.currentPage.title\r\n          : undefined;\r\n      },\r\n    },\r\n    currentPageComponent: {\r\n      type: \"string\",\r\n      group: \"General\",\r\n      displayName: \"Current Page Component\",\r\n      getter() {\r\n        return this._internal.currentPage !== undefined\r\n          ? this._internal.currentPage.component\r\n          : undefined;\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    _registerRouter() {\r\n      RouterHandler.instance.registerRouter(this._internal.name, this);\r\n    },\r\n    _deregisterRouter() {\r\n      RouterHandler.instance.deregisterRouter(this._internal.name, this);\r\n    },\r\n    setPageOutputs(outputs) {\r\n      for (const prop in outputs) {\r\n        this._internal[prop] = outputs[prop];\r\n        this.flagOutputDirty(prop);\r\n      }\r\n    },\r\n    scheduleReset() {\r\n      const internal = this._internal;\r\n      if (!internal.hasScheduledReset) {\r\n        internal.hasScheduledReset = true;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          internal.hasScheduledReset = false;\r\n          // @ts-expect-error\r\n          this.reset();\r\n        });\r\n      }\r\n    },\r\n    createPageContainer() {\r\n      const group = this.nodeScope!.createPrimitiveNode(\"Group\");\r\n      group.setStyle({ flex: \"1 0 100%\" });\r\n      return group;\r\n    },\r\n    reset() {\r\n      // @ts-expect-error\r\n      this._internal.asyncQueue.enqueue(this.resetAsync.bind(this));\r\n    },\r\n    scrollToTop() {\r\n      // @ts-expect-error\r\n      const dom = this.getDOMElement();\r\n      if (dom) {\r\n        dom.scrollTop = 0;\r\n\r\n        if (NoodlRuntime.instance.getProjectSettings().bodyScroll) {\r\n          //Automatically scroll the page router into view in case it's currently outside the viewport\r\n          //Might want to add an option to disable this\r\n          dom.scrollIntoView();\r\n        }\r\n      }\r\n    },\r\n    async resetAsync() {\r\n      let component: string;\r\n      let params = {};\r\n\r\n      // @ts-expect-error\r\n      const matchFromUrl = this.matchPageFromUrl();\r\n      if (matchFromUrl) {\r\n        if (!matchFromUrl.page) {\r\n          // Use the start page\r\n          component =\r\n            // @ts-expect-error\r\n            this._internal.pages !== undefined\r\n              ? // @ts-expect-error\r\n                this._internal.pages.startPage\r\n              : undefined;\r\n          params = Object.assign({}, matchFromUrl.params, matchFromUrl.query);\r\n        } else {\r\n          // Use the matching page\r\n          component = matchFromUrl.page.component;\r\n          params = Object.assign({}, matchFromUrl.params, matchFromUrl.query);\r\n        }\r\n      } else {\r\n        // TODO: Clean up matchPageFromUrl, in this case it returns undefined.\r\n        //       remainingNavigationPath is undefined, since it have to run\r\n        //       matchPageFromUrl to get the path. So it feels like it needs\r\n        //       some bigger refactoring to make it understandable.\r\n        // @ts-expect-error\r\n        component = this._internal.pages.startPage;\r\n        params = {};\r\n      }\r\n\r\n      if (component === undefined) return; // No component specified for page\r\n\r\n      const currentPage =\r\n        RouterHandler.instance.getPageInfoForComponent(component);\r\n\r\n      if (this._internal.currentPage === currentPage) {\r\n        //already at the correct page, keep the current page\r\n        //update page inputs if they have changed\r\n        //TODO: fix if a parameter goes from a value to undefined, the old value will still exist in the connection from previous navigation\r\n        if (!shallowObjectsEqual(this._internal.currentParams, params)) {\r\n          this._internal.currentParams = params;\r\n          // @ts-expect-error\r\n          this._updatePageInputs(\r\n            // @ts-expect-error\r\n            this._internal.currentPageComponent.nodeScope,\r\n            params\r\n          );\r\n        }\r\n        return;\r\n      }\r\n\r\n      // @ts-expect-error\r\n      this.scrollToTop();\r\n\r\n      // Reset the current page for this router\r\n      // First remove all children\r\n      // @ts-expect-error\r\n      const children = this.getChildren();\r\n      for (const i in children) {\r\n        const c = children[i];\r\n        // @ts-expect-error\r\n        this.removeChild(c);\r\n        // @ts-expect-error\r\n        this.nodeScope.deleteNode(c);\r\n      }\r\n\r\n      const content = await this.nodeScope!.createNode(component, guid());\r\n      this._internal.currentPageComponent = content;\r\n\r\n      // Find the root page node\r\n      const pageNodes = content.nodeScope.getNodesWithType(\"Page\");\r\n      if (pageNodes === undefined || pageNodes.length !== 1) {\r\n        return; // Should be only one page root\r\n      }\r\n\r\n      // @ts-expect-error\r\n      this._internal.currentPage =\r\n        RouterHandler.instance.getPageInfoForComponent(component);\r\n      this._internal.currentParams = params;\r\n\r\n      this.flagOutputDirty(\"currentPageTitle\");\r\n      this.flagOutputDirty(\"currentPageComponent\");\r\n      // @ts-expect-error Noodl is not defined\r\n      Noodl.SEO.setTitle(this._internal.currentPage.title);\r\n\r\n      // @ts-expect-error\r\n      this._updatePageInputs(\r\n        // @ts-expect-error\r\n        this._internal.currentPageComponent.nodeScope,\r\n        params\r\n      );\r\n\r\n      // @ts-expect-error\r\n      const group = this.createPageContainer();\r\n      group.addChild(content);\r\n\r\n      // @ts-expect-error\r\n      this.addChild(group);\r\n\r\n      /*\tthis.setPageOutputs({\r\n\t\t\t\tcurrentUrl: pageInfo.path,\r\n\t\t\t\tcurrentTitle: pageInfo.title\r\n\t\t\t});*/\r\n    },\r\n    _updatePageInputs(nodeScope, params) {\r\n      for (const pageInputNode of nodeScope.getNodesWithType(\"PageInputs\")) {\r\n        pageInputNode._setPageParams(params);\r\n      }\r\n    },\r\n    getRelativeURL(\r\n      targetPage: ComponentPageInfo,\r\n      pageParams: NavigateArgs[\"params\"]\r\n    ) {\r\n      if (!targetPage) return;\r\n\r\n      let urlPath = targetPage.path;\r\n      if (urlPath === undefined) return;\r\n\r\n      // First add matching parameters to path\r\n      const paramsInPath = urlPath.match(/{([^}]+)}/g);\r\n\r\n      const params = Object.assign({}, pageParams);\r\n      if (paramsInPath) {\r\n        for (const param of paramsInPath) {\r\n          const key = param.replace(/[{}]/g, \"\");\r\n          if (pageParams[key] !== undefined) {\r\n            urlPath = urlPath.replace(param, encodeURIComponent(params[key]));\r\n            delete params[key];\r\n          }\r\n        }\r\n      }\r\n\r\n      // Add other paramters as query\r\n      const query = [];\r\n      for (const key in params) {\r\n        // @ts-expect-error\r\n        query.push({\r\n          name: key,\r\n          value: encodeURIComponent(params[key]),\r\n        });\r\n      }\r\n\r\n      urlPath = _trimUrlPart(urlPath);\r\n\r\n      // Prepend this routers url path if there is one\r\n      if (this._internal.urlPath !== undefined)\r\n        urlPath = _trimUrlPart(this._internal.urlPath) + \"/\" + urlPath;\r\n\r\n      return {\r\n        path: urlPath,\r\n        query: query,\r\n      };\r\n    },\r\n    getNavigationAbsoluteURL(\r\n      targetPage: ComponentPageInfo,\r\n      pageParams: NavigateArgs[\"params\"]\r\n    ) {\r\n      // @ts-expect-error\r\n      let parent = this.parent;\r\n      let parentUrl = { path: \"\", query: [] };\r\n\r\n      while (\r\n        parent !== undefined &&\r\n        typeof parent.getNavigationAbsoluteURL !== \"function\"\r\n      ) {\r\n        parent = parent.getVisualParentNode();\r\n      }\r\n\r\n      if (parent) {\r\n        parentUrl = parent.getNavigationAbsoluteURL(\r\n          parent._internal.currentPage,\r\n          parent._internal.currentParams\r\n        );\r\n      }\r\n\r\n      // @ts-expect-error\r\n      const thisUrl = this.getRelativeURL(targetPage, pageParams);\r\n      if (thisUrl) {\r\n        const haveForwardSlash =\r\n          parentUrl.path.endsWith(\"/\") || thisUrl.path.startsWith(\"/\");\r\n        return {\r\n          path: parentUrl.path + (haveForwardSlash ? \"\" : \"/\") + thisUrl.path,\r\n          query: parentUrl.query.concat(thisUrl.query),\r\n        };\r\n      }\r\n\r\n      return parentUrl;\r\n    },\r\n    _getLocationPath: function () {\r\n      const navigationPathType =\r\n        NoodlRuntime.instance.getProjectSettings()[\"navigationPathType\"];\r\n      if (navigationPathType === undefined || navigationPathType === \"hash\") {\r\n        // Use hash as path\r\n        let hash = location.hash;\r\n        if (hash) {\r\n          if (hash[0] === \"#\") hash = hash.substring(1);\r\n          if (hash[0] === \"/\") hash = hash.substring(1);\r\n        }\r\n        return decodeURI(hash);\r\n      } else {\r\n        // Use url as path\r\n        let path = location.pathname;\r\n        if (path) {\r\n          if (path[0] === \"/\") {\r\n            // @ts-expect-error missing Noodl typings\r\n            const baseUrl = Noodl.Env[\"BaseUrl\"];\r\n            if (baseUrl) {\r\n              const pathnameLength = getBaseUrlLength(baseUrl);\r\n              path = path.substring(pathnameLength);\r\n            } else {\r\n              path = path.substring(1);\r\n            }\r\n          }\r\n        }\r\n        return decodeURI(path);\r\n      }\r\n    },\r\n    _getSearchParams: function () {\r\n      // Regex for replacing addition symbol with a space\r\n      const pl = /\\+/g;\r\n      const search = /([^&=]+)=?([^&]*)/g;\r\n      const decode = function (s) {\r\n        return decodeURIComponent(s.replace(pl, \" \"));\r\n      };\r\n      const query = location.search.substring(1);\r\n\r\n      let match: RegExpExecArray;\r\n\r\n      const urlParams = {};\r\n      // @ts-expect-error\r\n      while ((match = search.exec(query)))\r\n        urlParams[decode(match[1])] = decode(match[2]);\r\n\r\n      return urlParams;\r\n    },\r\n    getNavigationRemainingPath() {\r\n      return this._internal.remainingNavigationPath;\r\n    },\r\n    matchPageFromUrl() {\r\n      // Attempt to find relative path from closest navigation parent\r\n      // @ts-expect-error\r\n      let parent = this.parent;\r\n      while (\r\n        parent !== undefined &&\r\n        typeof parent.getNavigationRemainingPath !== \"function\"\r\n      ) {\r\n        parent = parent.getVisualParentNode();\r\n      }\r\n\r\n      let pathParts = undefined;\r\n\r\n      // Either use current browser location if we have no parent, or use remaining path\r\n      // from parent\r\n      if (parent === undefined) {\r\n        // @ts-expect-error\r\n        let urlPath = this._getLocationPath();\r\n        if (urlPath[0] === \"/\") urlPath = urlPath.substring(1);\r\n        pathParts = urlPath.split(\"/\");\r\n      } else {\r\n        pathParts = parent.getNavigationRemainingPath();\r\n      }\r\n      if (pathParts === undefined) return;\r\n\r\n      // @ts-expect-error\r\n      const urlQuery = this._getSearchParams();\r\n\r\n      function _matchPathParts(path, pattern) {\r\n        const params = {};\r\n        for (let i = 0; i < pattern.length; i++) {\r\n          const _p = pattern[i];\r\n          if (_p[0] === \"{\" && _p[_p.length - 1] === \"}\") {\r\n            // This is a param, collect it\r\n            if (path[i] !== undefined) {\r\n              params[_p.substring(1, _p.length - 1)] = decodeURIComponent(\r\n                path[i]\r\n              );\r\n            }\r\n          } else if (path[i] === undefined || _p !== path[i]) return;\r\n        }\r\n        return {\r\n          params: params,\r\n          remainingPathParts: path.slice().splice(pattern.length), // Make copy\r\n        };\r\n      }\r\n\r\n      const pages = RouterHandler.instance.getPagesForRouter(\r\n        this._internal.name\r\n      );\r\n      if (pages === undefined || pages.length === 0) return;\r\n\r\n      let matchedPage,\r\n        bestMatchLength = 9999;\r\n      for (const pageInfo of pages) {\r\n        let pagePattern = pageInfo!.path;\r\n        if (pagePattern === undefined) continue;\r\n        pagePattern = _trimUrlPart(pagePattern);\r\n\r\n        // Prepend this routers url path if there is one\r\n        if (this._internal.urlPath !== undefined)\r\n          pagePattern =\r\n            _trimUrlPart(this._internal.urlPath) + \"/\" + pagePattern;\r\n\r\n        const pagePatternParts = pagePattern.split(\"/\");\r\n        const match = _matchPathParts(pathParts, pagePatternParts);\r\n\r\n        // @ts-expect-error\r\n        const dist = Math.abs(pagePatternParts.length - pathParts.length);\r\n        if (match && bestMatchLength > dist) {\r\n          // This page is a match\r\n          matchedPage = { match, pageInfo };\r\n          bestMatchLength = dist;\r\n        }\r\n      }\r\n\r\n      if (matchedPage) {\r\n        this._internal.remainingNavigationPath =\r\n          matchedPage.match.remainingPathParts;\r\n        return {\r\n          page: matchedPage.pageInfo,\r\n          params: matchedPage.match.params,\r\n          query: urlQuery,\r\n        };\r\n      } else {\r\n        return {\r\n          page: undefined, // no matched page\r\n          params: {},\r\n          query: urlQuery,\r\n        };\r\n      }\r\n    },\r\n    _getCompleteUrlToPage(\r\n      page: ComponentPageInfo,\r\n      pageParams: NavigateArgs[\"params\"]\r\n    ) {\r\n      // @ts-expect-error\r\n      const url = this.getNavigationAbsoluteURL(page, pageParams);\r\n\r\n      let urlPath, hashPath;\r\n      const navigationPathType =\r\n        NoodlRuntime.instance.getProjectSettings()[\"navigationPathType\"];\r\n      if (navigationPathType === undefined || navigationPathType === \"hash\") {\r\n        hashPath = url.path;\r\n      } else {\r\n        urlPath = url.path;\r\n      }\r\n\r\n      const query = url.query.map((q) => q.name + \"=\" + q.value);\r\n      const compiledUrl =\r\n        (urlPath !== undefined ? urlPath : \"\") +\r\n        (query.length >= 1 ? \"?\" + query.join(\"&\") : \"\") +\r\n        (hashPath !== undefined ? \"#\" + hashPath : \"\");\r\n\r\n      return compiledUrl;\r\n    },\r\n    _updateUrlWithTopPage() {\r\n      // Push the state to the browser url\r\n      if (window.history !== undefined) {\r\n        // @ts-expect-error\r\n        this._internal.remainingNavigationPath = undefined; // Reset remaining nav path\r\n\r\n        // @ts-expect-error\r\n        const url = this._getCompleteUrlToPage(\r\n          this._internal.currentPage,\r\n          this._internal.currentParams\r\n        );\r\n        window.history.pushState({}, \"\", url);\r\n      }\r\n    },\r\n    navigate(args) {\r\n      // @ts-expect-error\r\n      this._internal.asyncQueue.enqueue(this.navigateAsync.bind(this, args));\r\n    },\r\n    async navigateAsync(args: NavigateArgs) {\r\n      if (args.target === undefined) return;\r\n\r\n      const newPage = RouterHandler.instance.getPageInfoForComponent(\r\n        args.target\r\n      );\r\n      if (!newPage) return; //TODO: send error to editor, \"invalid page component name\"\r\n\r\n      if (args.openInNewTab) {\r\n        // @ts-expect-error\r\n        const url = this._getCompleteUrlToPage(newPage, args.params);\r\n        window.open(url, \"_blank\");\r\n        args.hasNavigated && args.hasNavigated();\r\n      } else {\r\n        // @ts-expect-error\r\n        await this._navigateInCurrentWindow(newPage, args);\r\n      }\r\n    },\r\n    async _navigateInCurrentWindow(\r\n      newPage: ComponentPageInfo,\r\n      args: NavigateArgs\r\n    ) {\r\n      // @ts-expect-error\r\n      this.scrollToTop();\r\n\r\n      // Remove all current pages in the stack\r\n      // @ts-expect-error\r\n      const children = this.getChildren();\r\n      for (const i in children) {\r\n        const c = children[i];\r\n        // @ts-expect-error\r\n        this.removeChild(c);\r\n        // @ts-expect-error\r\n        this.nodeScope.deleteNode(c);\r\n      }\r\n\r\n      // @ts-expect-error\r\n      const group = this.createPageContainer();\r\n\r\n      // Create the page content\r\n      // @ts-expect-error\r\n      const content = await this.nodeScope.createNode(args.target, guid());\r\n\r\n      this._internal.currentPage = newPage;\r\n      this._internal.currentParams = args.params;\r\n\r\n      this.flagOutputDirty(\"currentPageTitle\");\r\n      this.flagOutputDirty(\"currentPageComponent\");\r\n      // @ts-expect-error Noodl is not defined\r\n      Noodl.SEO.setTitle(this._internal.currentPage.title);\r\n\r\n      const pageInputNodes = content.nodeScope.getNodesWithType(\"PageInputs\");\r\n      if (pageInputNodes !== undefined && pageInputNodes.length > 0) {\r\n        pageInputNodes.forEach((node) => {\r\n          node._setPageParams(args.params);\r\n        });\r\n      }\r\n\r\n      group.addChild(content);\r\n      // @ts-expect-error\r\n      this.addChild(group);\r\n\r\n      // @ts-expect-error\r\n      this._updateUrlWithTopPage();\r\n\r\n      args.hasNavigated && args.hasNavigated();\r\n      RouterHandler.instance.onNavigated(this._internal.name, newPage);\r\n    },\r\n    registerInputIfNeeded(name) {\r\n      if (this.hasInput(name)) {\r\n        return;\r\n      }\r\n    },\r\n  },\r\n};\r\n\r\nfunction shallowObjectsEqual(object1, object2) {\r\n  const keys1 = Object.keys(object1 || {});\r\n  const keys2 = Object.keys(object2 || {});\r\n\r\n  if (keys1.length !== keys2.length) {\r\n    return false;\r\n  }\r\n\r\n  return keys1.every((key) => object1[key] === object2[key]);\r\n}\r\n\r\nexport default createNodeFromReactComponent(RouterNode);\r\n","import { NodeDefinition } from \"@fluxscape/runtime\";\r\n\r\ninterface Internal {\r\n  // Define any internal state if needed\r\n}\r\n\r\nexport const node: NodeDefinition<Internal> = {\r\n  name: \"net.noodl.externallink\",\r\n  displayNodeName: \"External Link\",\r\n  docs: \"https://docs.noodl.net/nodes/navigation/external-link\",\r\n  category: \"Navigation\",\r\n  nodeDoubleClickAction: {\r\n    focusPort: \"link\",\r\n  },\r\n  inputs: {\r\n    link: {\r\n      type: \"string\",\r\n      displayName: \"Link\",\r\n    },\r\n    openInNewTab: {\r\n      type: \"boolean\",\r\n      displayName: \"Open In New Tab\",\r\n      default: true,\r\n    },\r\n    do: {\r\n      type: \"signal\",\r\n      displayName: \"Do\",\r\n      valueChangedToTrue() {\r\n        const openInNewTab = this.getInputValue(\"openInNewTab\");\r\n        const params = openInNewTab ? \"noopener,noreferrer\" : \"\";\r\n        const target =\r\n          openInNewTab === true || openInNewTab === undefined\r\n            ? \"_blank\"\r\n            : \"_self\";\r\n\r\n        window.open(this.getInputValue(\"link\"), target, params);\r\n      },\r\n    },\r\n  },\r\n};\r\n","import React from \"react\";\r\n\r\nimport Layout from \"../../../layout\";\r\nimport PointerListeners from \"../../../pointerlisteners\";\r\nimport { Noodl } from \"../../../types\";\r\n\r\nexport interface CircleProps extends Noodl.ReactProps {\r\n  size: number;\r\n  startAngle: number;\r\n  endAngle: number;\r\n\r\n  fillEnabled: boolean;\r\n  fillColor: Noodl.Color;\r\n\r\n  strokeEnabled: boolean;\r\n  strokeColor: Noodl.Color;\r\n  strokeWidth: number;\r\n  strokeLineCap: \"butt\" | \"round\";\r\n\r\n  dom: any;\r\n}\r\n\r\nfunction polarToCartesian(\r\n  centerX: number,\r\n  centerY: number,\r\n  radius: number,\r\n  angleInDegrees: number\r\n): { x: number; y: number } {\r\n  const angleInRadians = ((angleInDegrees - 90) * Math.PI) / 180.0;\r\n\r\n  return {\r\n    x: centerX + radius * Math.cos(angleInRadians),\r\n    y: centerY + radius * Math.sin(angleInRadians),\r\n  };\r\n}\r\n\r\nfunction filledArc(\r\n  x: number,\r\n  y: number,\r\n  radius: number,\r\n  startAngle: number,\r\n  endAngle: number\r\n): string {\r\n  if (endAngle % 360 === startAngle % 360) {\r\n    endAngle -= 0.0001;\r\n  }\r\n\r\n  const start = polarToCartesian(x, y, radius, endAngle);\r\n  const end = polarToCartesian(x, y, radius, startAngle);\r\n\r\n  const arcSweep = endAngle - startAngle <= 180 ? \"0\" : \"1\";\r\n\r\n  return [\r\n    \"M\",\r\n    start.x,\r\n    start.y,\r\n    \"A\",\r\n    radius,\r\n    radius,\r\n    0,\r\n    arcSweep,\r\n    0,\r\n    end.x,\r\n    end.y,\r\n    \"L\",\r\n    x,\r\n    y,\r\n    \"L\",\r\n    start.x,\r\n    start.y,\r\n  ].join(\" \");\r\n}\r\n\r\nfunction arc(\r\n  x: number,\r\n  y: number,\r\n  radius: number,\r\n  startAngle: number,\r\n  endAngle: number\r\n): string {\r\n  if (endAngle % 360 === startAngle % 360) {\r\n    endAngle -= 0.0001;\r\n  }\r\n\r\n  const start = polarToCartesian(x, y, radius, endAngle);\r\n  const end = polarToCartesian(x, y, radius, startAngle);\r\n\r\n  const arcSweep = endAngle - startAngle <= 180 ? \"0\" : \"1\";\r\n\r\n  return [\r\n    \"M\",\r\n    start.x,\r\n    start.y,\r\n    \"A\",\r\n    radius,\r\n    radius,\r\n    0,\r\n    arcSweep,\r\n    0,\r\n    end.x,\r\n    end.y,\r\n  ].join(\" \");\r\n}\r\n\r\nexport class Circle extends React.Component<CircleProps> {\r\n  constructor(props: CircleProps) {\r\n    super(props);\r\n  }\r\n\r\n  render(): React.ReactNode {\r\n    //SVG can only do strokes centered on a path, and we want to render it inside.\r\n    //We'll do it manually by adding another path on top of the filled circle\r\n\r\n    let fill: React.ReactNode;\r\n    let stroke: React.ReactNode;\r\n\r\n    const r = this.props.size / 2;\r\n    const { startAngle, endAngle } = this.props;\r\n\r\n    if (this.props.fillEnabled) {\r\n      const r = this.props.size / 2;\r\n      fill = (\r\n        <path\r\n          d={filledArc(r, r, r, startAngle, endAngle)}\r\n          fill={this.props.fillColor}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (this.props.strokeEnabled) {\r\n      const { strokeColor, strokeWidth, strokeLineCap } = this.props;\r\n      const strokeRadius = r - this.props.strokeWidth / 2;\r\n      const path = arc(r, r, strokeRadius, startAngle, endAngle);\r\n      stroke = (\r\n        <path\r\n          d={path}\r\n          stroke={strokeColor}\r\n          strokeWidth={strokeWidth}\r\n          fill=\"transparent\"\r\n          strokeLinecap={strokeLineCap}\r\n        />\r\n      );\r\n    }\r\n\r\n    const style: React.CSSProperties = { ...this.props.style };\r\n    Layout.size(style, this.props);\r\n    Layout.align(style, this.props);\r\n\r\n    if (style.opacity === 0) {\r\n      style.pointerEvents = \"none\";\r\n    }\r\n\r\n    //the SVG element lack some properties like offsetLeft, offsetTop that the drag node depends on.\r\n    //Let's wrap it in a div to make it work properly\r\n    return (\r\n      <div\r\n        className={this.props.className}\r\n        {...this.props.dom}\r\n        {...PointerListeners(this.props)}\r\n        style={style}\r\n      >\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          width={this.props.size}\r\n          height={this.props.size}\r\n        >\r\n          {fill}\r\n          {stroke}\r\n        </svg>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import { Circle } from \"../../components/visual/Circle\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\nimport { ReactNodeDefinition } from \"../../ReactNodeDefinition\";\r\n\r\ninterface Internal {\r\n  size?: number;\r\n  fillEnabled?: boolean;\r\n  fillColor?: string;\r\n  strokeEnabled?: boolean;\r\n  strokeWidth?: number;\r\n  strokeColor?: string;\r\n  strokeLineCap?: \"butt\" | \"round\";\r\n  startAngle?: number;\r\n  endAngle?: number;\r\n}\r\n\r\nconst CircleNode: ReactNodeDefinition<Internal> = {\r\n  name: \"Circle\",\r\n  docs: \"https://docs.noodl.net/nodes/basic-elements/circle\",\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      \"General\",\r\n      \"Fill\",\r\n      \"Stroke\",\r\n      \"Dimensions\",\r\n      \"Style\",\r\n      \"Actions\",\r\n      \"Events\",\r\n      \"Mounted\",\r\n      \"Margin and padding\",\r\n      \"Pointer Events\",\r\n      \"Hover Events\",\r\n    ],\r\n  },\r\n  // @ts-expect-error\r\n  getReactComponent() {\r\n    return Circle;\r\n  },\r\n  noodlNodeAsProp: true,\r\n  allowChildren: false,\r\n  defaultCss: {\r\n    // @ts-expect-error\r\n    flexShrink: 0,\r\n    position: \"relative\",\r\n    display: \"flex\",\r\n  },\r\n  inputProps: {\r\n    size: {\r\n      displayName: \"Size\",\r\n      default: \"100\",\r\n      group: \"Dimension\",\r\n      type: {\r\n        name: \"number\",\r\n      },\r\n      index: 10,\r\n      allowVisualStates: true,\r\n    },\r\n    fillEnabled: {\r\n      group: \"Fill\",\r\n      displayName: \"Fill\",\r\n      default: true,\r\n      type: \"boolean\",\r\n      index: 20,\r\n      allowVisualStates: true,\r\n    },\r\n    fillColor: {\r\n      group: \"Fill\",\r\n      displayName: \"Fill Color\",\r\n      default: \"red\",\r\n      type: \"color\",\r\n      index: 21,\r\n      allowVisualStates: true,\r\n    },\r\n    strokeEnabled: {\r\n      index: 23,\r\n      group: \"Stroke\",\r\n      default: false,\r\n      displayName: \"Stroke\",\r\n      type: \"boolean\",\r\n      allowVisualStates: true,\r\n    },\r\n    strokeWidth: {\r\n      index: 24,\r\n      group: \"Stroke\",\r\n      displayName: \"Stroke Width\",\r\n      default: 10,\r\n      type: {\r\n        name: \"number\",\r\n      },\r\n      allowVisualStates: true,\r\n    },\r\n    strokeColor: {\r\n      index: 25,\r\n      group: \"Stroke\",\r\n      displayName: \"Stroke Color\",\r\n      type: \"color\",\r\n      default: \"black\",\r\n      allowVisualStates: true,\r\n    },\r\n    strokeLineCap: {\r\n      index: 26,\r\n      group: \"Stroke\",\r\n      displayName: \"Line Cap\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Butt\", value: \"butt\" },\r\n          { label: \"Round\", value: \"round\" },\r\n        ],\r\n      },\r\n      default: \"butt\",\r\n      allowVisualStates: true,\r\n    },\r\n    startAngle: {\r\n      displayName: \"Start Angle\",\r\n      type: \"number\",\r\n      default: 0,\r\n      group: \"Style\",\r\n      index: 198,\r\n      allowVisualStates: true,\r\n    },\r\n    endAngle: {\r\n      displayName: \"End Angle\",\r\n      type: \"number\",\r\n      default: 360,\r\n      group: \"Style\",\r\n      index: 199,\r\n      allowVisualStates: true,\r\n    },\r\n  },\r\n  setup(context, graphModel) {\r\n    NodeSharedPortDefinitions.addTransformInputs(CircleNode);\r\n    NodeSharedPortDefinitions.addMarginInputs(CircleNode);\r\n    NodeSharedPortDefinitions.addSharedVisualInputs(CircleNode);\r\n    NodeSharedPortDefinitions.addAlignInputs(CircleNode);\r\n    NodeSharedPortDefinitions.addPointerEventOutputs(CircleNode);\r\n  },\r\n};\r\n\r\nexport default createNodeFromReactComponent(CircleNode);\r\n","import React, { useRef, useState, useEffect } from \"react\";\r\n\r\nimport { node as ForEachComponent } from \"../../../nodes/std-library/data/foreach\";\r\nimport { Noodl, Slot } from \"../../../types\";\r\nimport { Node } from \"@fluxscape/runtime/dist/types/node\";\r\n\r\nexport interface ColumnsProps extends Noodl.ReactProps {\r\n  marginX: string;\r\n  marginY: string;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  justifyContent: \"flex-start\" | \"flex-end\" | \"center\";\r\n  direction: \"row\" | \"column\";\r\n  minWidth: string;\r\n  layoutString: string;\r\n\r\n  children: Slot;\r\n}\r\n\r\nfunction calcAutofold(layout, minWidths, containerWidth, marginX) {\r\n  const first = _calcAutofold(layout, minWidths, containerWidth, marginX);\r\n  const second = _calcAutofold(\r\n    first.layout,\r\n    minWidths,\r\n    containerWidth,\r\n    marginX\r\n  );\r\n\r\n  if (first.totalFractions === second.totalFractions) {\r\n    return first;\r\n  } else {\r\n    return calcAutofold(second.layout, minWidths, containerWidth, marginX);\r\n  }\r\n}\r\n\r\nfunction _calcAutofold(layout, minWidth, containerWidth, marginX) {\r\n  const totalFractions = layout.reduce((a, b) => a + b, 0);\r\n  const fractionSize = 100 / totalFractions;\r\n\r\n  const rowWidth = layout.reduce(\r\n    (acc, curr, i) => {\r\n      return {\r\n        expected: acc.expected + (fractionSize / 100) * containerWidth * curr,\r\n        min: acc.min + parseFloat(minWidth) + marginX,\r\n      };\r\n    },\r\n    { expected: 0, min: 0, max: null }\r\n  );\r\n\r\n  const newLayout = layout;\r\n\r\n  if (rowWidth.expected < rowWidth.min) {\r\n    newLayout.pop();\r\n  }\r\n\r\n  const newTotalFractions = newLayout.reduce((a, b) => a + b, 0);\r\n  const newFractionSize = 100 / newTotalFractions;\r\n  const newColumnAmount = newLayout.length;\r\n\r\n  return {\r\n    layout: newLayout,\r\n    totalFractions: newTotalFractions,\r\n    fractionSize: newFractionSize,\r\n    columnAmount: newColumnAmount,\r\n  };\r\n}\r\n\r\nexport function Columns(props: ColumnsProps) {\r\n  if (!props.children) return null;\r\n  let columnLayout: string | null = null;\r\n\r\n  const containerRef = useRef<HTMLDivElement | null>(null);\r\n  const [containerWidth, setContainerWidth] = useState<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    if (!container) return;\r\n\r\n    const observer = new ResizeObserver(() => {\r\n      const container = containerRef.current;\r\n      if (!container) return;\r\n      setContainerWidth(container.offsetWidth);\r\n    });\r\n\r\n    observer.observe(container);\r\n\r\n    return () => {\r\n      observer.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  switch (typeof props.layoutString) {\r\n    case \"string\":\r\n      columnLayout = props.layoutString.trim();\r\n      break;\r\n\r\n    case \"number\":\r\n      columnLayout = String(props.layoutString).trim();\r\n      break;\r\n\r\n    default:\r\n      columnLayout = null;\r\n  }\r\n\r\n  if (!columnLayout) {\r\n    return <>{props.children}</>;\r\n  }\r\n\r\n  // all data for childrens width calculation\r\n  const targetLayout = columnLayout\r\n    .split(\" \")\r\n    .map((number) => parseInt(number));\r\n\r\n  // constraints\r\n  const { layout, columnAmount, fractionSize } = calcAutofold(\r\n    targetLayout,\r\n    props.minWidth,\r\n    containerWidth || 0,\r\n    props.marginX\r\n  );\r\n\r\n  let children: React.ReactNode[] = [];\r\n  let forEachComponent = null;\r\n\r\n  // ForEachCompoent breaks the layout but is needed to send onMount/onUnmount\r\n  if (!Array.isArray(props.children)) {\r\n    // @ts-expect-error props.children.type is any\r\n    if (props.children.type !== ForEachComponent) {\r\n      children = [props.children];\r\n    }\r\n  } else {\r\n    children = props.children.filter((child: React.ReactNode | Node) => {\r\n      // @ts-expect-error\r\n      return React.isValidElement(child) && child.type !== ForEachComponent;\r\n    });\r\n    forEachComponent = props.children.find(\r\n      // @ts-expect-error\r\n      (child) => React.isValidElement(child) && child.type === ForEachComponent\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div\r\n      {...props.attrs}\r\n      className={[\"columns-container\", props.className].join(\" \")}\r\n      ref={containerRef}\r\n      style={{\r\n        visibility: containerWidth === null ? \"hidden\" : \"visible\",\r\n        marginTop: parseFloat(props.marginY) * -1,\r\n        marginLeft: parseFloat(props.marginX) * -1,\r\n        display: \"flex\",\r\n        flexWrap: \"wrap\",\r\n        alignItems: \"stretch\",\r\n        justifyContent: props.justifyContent,\r\n        flexDirection: props.direction,\r\n        width: `calc(100% + (${parseFloat(props.marginX)}px)`,\r\n        boxSizing: \"border-box\",\r\n        ...props.style,\r\n      }}\r\n    >\r\n      {forEachComponent && forEachComponent}\r\n\r\n      {children.map((child, i) => {\r\n        if (React.isValidElement(child)) {\r\n          return (\r\n            <div\r\n              className=\"column-item\"\r\n              key={i}\r\n              style={{\r\n                boxSizing: \"border-box\",\r\n                paddingTop: props.marginY,\r\n                paddingLeft: props.marginX,\r\n                width: layout[i % columnAmount] * fractionSize + \"%\",\r\n                flexShrink: 0,\r\n                flexGrow: 0,\r\n                minWidth: props.minWidth,\r\n              }}\r\n            >\r\n              {React.cloneElement(child)}\r\n            </div>\r\n          );\r\n        }\r\n        return null;\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import { Columns } from '../../components/visual/Columns';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst ColumnsNode = {\r\n  name: 'net.noodl.visual.columns',\r\n  displayName: 'Columns',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/columns',\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'States',\r\n      'Mounted',\r\n      'Label',\r\n      'Label Text Style',\r\n      'Hover Events',\r\n      'Pointer Events',\r\n      'Focus Events'\r\n    ]\r\n  },\r\n\r\n  initialize() {    this.props.attrs = {};\r\n    this.props.layoutString = '1 2 1';\r\n    this.props.minWidth = 0;\r\n    this.props.marginX = 16;\r\n    this.props.marginY = 16;\r\n    this.props.direction = 'row';\r\n    this.props.justifyContent = 'flex-start';\r\n  },\r\n\r\n  getReactComponent() {\r\n    return Columns;\r\n  },\r\n\r\n  inputs: {\r\n    layoutString: {\r\n      group: 'Layout Settings',\r\n      displayName: 'Layout String',\r\n      type: 'string',\r\n      default: '1 2 1',\r\n      set(value) {\r\n        this.props.layoutString = value;\r\n\r\n        if (typeof value !== 'string') {\r\n          this.context.editorConnection.sendWarning(\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            'layout-type-warning',\r\n            {\r\n              message: 'Layout String needs to be a string.'\r\n            }\r\n          );\r\n        } else {\r\n          this.context.editorConnection.clearWarning(\r\n            this.nodeScope.componentOwner.name,\r\n            this.id,\r\n            'layout-type-warning'\r\n          );\r\n        }\r\n\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n\r\n  inputProps: {\r\n    marginX: {\r\n      group: 'Layout Settings',\r\n      displayName: 'Horizontal Gap',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 16\r\n    },\r\n    marginY: {\r\n      group: 'Layout Settings',\r\n      displayName: 'Vertical Gap',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 16\r\n    },\r\n    minWidth: {\r\n      group: 'Constraints',\r\n      displayName: 'Min Column Width',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 0\r\n    },\r\n    direction: {\r\n      group: 'Layout Settings',\r\n      displayName: 'Layout Direction',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          {\r\n            label: 'Horizontal',\r\n            value: 'row'\r\n          },\r\n          {\r\n            label: 'Vertical',\r\n            value: 'column'\r\n          }\r\n        ]\r\n      },\r\n      default: 'row'\r\n    },\r\n    justifyContent: {\r\n      group: 'Justify Content',\r\n      displayName: 'Justify Content',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Start', value: 'flex-start' },\r\n          { label: 'End', value: 'flex-end' },\r\n          { label: 'Center', value: 'center' }\r\n        ],\r\n        alignComp: 'align-items'\r\n      },\r\n      default: 'flex-start'\r\n    }\r\n  }\r\n};\r\n\r\nexport default createNodeFromReactComponent(ColumnsNode);\r\n","import React from 'react';\r\nimport Draggable from 'react-draggable';\r\n\r\nimport EaseCurves from '../../../easecurves';\r\nimport { Noodl } from '../../../types';\r\n\r\nexport interface DragProps extends Noodl.ReactProps {\r\n  inputPositionX: number;\r\n  inputPositionY: number;\r\n\r\n  enabled: boolean;\r\n  scale: number;\r\n  axis: 'x' | 'y' | 'both';\r\n\r\n  useParentBounds: boolean;\r\n\r\n  onStart?: () => void;\r\n  onStop?: () => void;\r\n  onDrag?: () => void;\r\n\r\n  positionX?: (value: number) => void;\r\n  positionY?: (value: number) => void;\r\n  deltaX?: (value: number) => void;\r\n  deltaY?: (value: number) => void;\r\n}\r\n\r\nfunction setDragValues(event, props) {\r\n  props.positionX && props.positionX(event.x);\r\n  props.positionY && props.positionY(event.y);\r\n  props.deltaX && props.deltaX(event.deltaX);\r\n  props.deltaY && props.deltaY(event.deltaY);\r\n}\r\n\r\ntype State = {\r\n  x: number\r\n  y: number\r\n}\r\n\r\nexport class Drag extends React.Component<DragProps, State> {\r\n  snapToPositionXTimer: any;\r\n  snapToPositionYTimer: any;\r\n\r\n  constructor(props: DragProps) {\r\n    super(props);\r\n    this.state = { x: 0, y: 0 } satisfies State;\r\n  }\r\n\r\n  snapToPosition({ timerScheduler, propCallback, duration, axis, endValue }) {\r\n    const _this = this;\r\n    return timerScheduler\r\n      .createTimer({\r\n        duration: duration === undefined ? 300 : duration,\r\n        startValue: this.state[axis],\r\n        endValue: endValue,\r\n        ease: EaseCurves.easeOut,\r\n        onRunning: function (t) {\r\n          const value = this.ease(this.startValue, this.endValue, t);\r\n          // @ts-expect-error Either x or y...\r\n          _this.setState({ [axis]: value });\r\n          propCallback && propCallback(value);\r\n        }\r\n      })\r\n      .start();\r\n  }\r\n\r\n  componentDidMount() {\r\n    const x = this.props.inputPositionX ? this.props.inputPositionX : 0;\r\n    const y = this.props.inputPositionY ? this.props.inputPositionY : 0;\r\n\r\n    this.setState({ x, y });\r\n    setDragValues({ x, y, deltaX: 0, deltaY: 0 }, this.props);\r\n  }\r\n\r\n  UNSAFE_componentWillReceiveProps(nextProps: DragProps) {\r\n    const props = this.props;\r\n\r\n    if (props.inputPositionX !== nextProps.inputPositionX) {\r\n      this.setState({ x: nextProps.inputPositionX });\r\n      props.positionX && props.positionX(nextProps.inputPositionX);\r\n      props.deltaX && props.deltaX(nextProps.inputPositionX - props.inputPositionX);\r\n    }\r\n    if (props.inputPositionY !== nextProps.inputPositionY) {\r\n      this.setState({ y: nextProps.inputPositionY });\r\n      props.positionY && props.positionY(nextProps.inputPositionY);\r\n      props.deltaY && props.deltaY(nextProps.inputPositionY - props.inputPositionY);\r\n    }\r\n  }\r\n\r\n  snapToPositionX(x, duration) {\r\n    if (this.state.x === x) return;\r\n\r\n    this.snapToPositionXTimer && this.snapToPositionXTimer.stop();\r\n    this.snapToPositionXTimer = this.snapToPosition({\r\n      timerScheduler: this.props.noodlNode.context.timerScheduler,\r\n      propCallback: this.props.positionX,\r\n      duration,\r\n      axis: 'x',\r\n      endValue: x\r\n    });\r\n  }\r\n\r\n  snapToPositionY(y, duration) {\r\n    if (this.state.y === y) return;\r\n\r\n    this.snapToPositionYTimer && this.snapToPositionYTimer.stop();\r\n    this.snapToPositionYTimer = this.snapToPosition({\r\n      timerScheduler: this.props.noodlNode.context.timerScheduler,\r\n      propCallback: this.props.positionY,\r\n      duration,\r\n      axis: 'y',\r\n      endValue: y\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const props = this.props;\r\n    const bounds = props.useParentBounds ? 'parent' : undefined;\r\n\r\n    let child;\r\n    if (React.Children.count(props.children) > 0) {\r\n      child = React.Children.toArray(props.children)[0];\r\n    } else {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <Draggable\r\n        axis={props.axis}\r\n        bounds={bounds}\r\n        disabled={props.enabled === false}\r\n        scale={props.scale || 0}\r\n        position={{ x: this.state.x, y: this.state.y }}\r\n        onStart={(e, data) => {\r\n          setDragValues(data, props);\r\n          props.onStart && props.onStart();\r\n          this.snapToPositionXTimer && this.snapToPositionXTimer.stop();\r\n          this.snapToPositionYTimer && this.snapToPositionYTimer.stop();\r\n        }}\r\n        onStop={(e, data) => {\r\n          if (props.axis === 'x' || props.axis === 'both') {\r\n            this.setState({ x: data.x });\r\n          }\r\n          if (props.axis === 'y' || props.axis === 'both') {\r\n            this.setState({ y: data.y });\r\n          }\r\n          props.positionX && props.positionX(data.x);\r\n          props.positionY && props.positionY(data.y);\r\n          props.onStop && props.onStop();\r\n        }}\r\n        onDrag={(e, data) => {\r\n          setDragValues(data, props);\r\n          props.onDrag && props.onDrag();\r\n        }}\r\n      >\r\n        {React.cloneElement(child, { parentLayout: props.parentLayout })}\r\n      </Draggable>\r\n    );\r\n  }\r\n}\r\n","import { Drag } from '../../components/visual/Drag';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst DragNode = {\r\n  name: 'Drag',\r\n  docs: 'https://docs.noodl.net/nodes/utilities/drag',\r\n  allowChildren: true,\r\n  noodlNodeAsProp: true,\r\n  getReactComponent() {\r\n    return Drag;\r\n  },\r\n  initialize() {\r\n    this._internal.snapPositionX = 0;\r\n    this._internal.snapPositionY = 0;\r\n    this._internal.snapDurationX = 300;\r\n    this._internal.snapDurationY = 300;\r\n  },\r\n  inputs: {\r\n    'snapToPositionX.do': {\r\n      group: 'Snap To Position X',\r\n      displayName: 'Do',\r\n      editorName: 'Do|Snap To Position X',\r\n      type: 'signal',\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const { snapPositionX, snapDurationX } = this._internal;\r\n          this.innerReactComponentRef && this.innerReactComponentRef.snapToPositionX(snapPositionX, snapDurationX);\r\n        });\r\n      }\r\n    },\r\n    'snapToPositionX.value': {\r\n      default: 0,\r\n      group: 'Snap To Position X',\r\n      displayName: 'Value',\r\n      editorName: 'Value|Snap To Position X',\r\n      type: 'number',\r\n      set(value) {\r\n        this._internal.snapPositionX = value;\r\n      }\r\n    },\r\n    'snapToPositionX.duration': {\r\n      default: 300,\r\n      group: 'Snap To Position X',\r\n      displayName: 'Duration',\r\n      editorName: 'Duration|Snap To Position X',\r\n      type: 'number',\r\n      set(value) {\r\n        this._internal.snapDurationX = value;\r\n      }\r\n    },\r\n    'snapToPositionY.do': {\r\n      group: 'Snap To Position Y',\r\n      displayName: 'Do',\r\n      editorName: 'Do|Snap To Position Y',\r\n      type: 'signal',\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const { snapPositionY, snapDurationY } = this._internal;\r\n          this.innerReactComponentRef && this.innerReactComponentRef.snapToPositionY(snapPositionY, snapDurationY);\r\n        });\r\n      }\r\n    },\r\n    'snapToPositionY.value': {\r\n      default: 0,\r\n      group: 'Snap To Position Y',\r\n      displayName: 'Value',\r\n      editorName: 'Value|Snap To Position Y',\r\n      type: 'number',\r\n      set(value) {\r\n        this._internal.snapPositionY = value;\r\n      }\r\n    },\r\n    'snapToPositionY.duration': {\r\n      default: 300,\r\n      group: 'Snap To Position Y',\r\n      displayName: 'Duration',\r\n      editorName: 'Duration|Snap To Position Y',\r\n      type: 'number',\r\n      set(value) {\r\n        this._internal.snapDurationY = value;\r\n      }\r\n    }\r\n  },\r\n  inputProps: {\r\n    enabled: {\r\n      group: 'Drag',\r\n      displayName: 'Enabled',\r\n      type: 'boolean',\r\n      default: true\r\n    },\r\n    axis: {\r\n      group: 'Drag',\r\n      displayName: 'Axis',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'X', value: 'x' },\r\n          { label: 'Y', value: 'y' },\r\n          { label: 'Both', value: 'both' }\r\n        ]\r\n      },\r\n      default: 'x'\r\n    },\r\n    useParentBounds: {\r\n      group: 'Drag',\r\n      displayName: 'Constrain to parent',\r\n      type: 'boolean',\r\n      default: true\r\n    },\r\n    inputPositionX: {\r\n      displayName: 'Start Drag X',\r\n      type: {\r\n        name: 'number'\r\n      }\r\n    },\r\n    inputPositionY: {\r\n      displayName: 'Start Drag Y',\r\n      type: {\r\n        name: 'number'\r\n      }\r\n    },\r\n    scale: {\r\n      displayName: 'Scale',\r\n      default: 1.0,\r\n      type: {\r\n        name: 'number'\r\n      }\r\n    }\r\n  },\r\n  outputProps: {\r\n    onStart: {\r\n      group: 'Signals',\r\n      type: 'signal',\r\n      displayName: 'Drag Started'\r\n    },\r\n    onStop: {\r\n      group: 'Signals',\r\n      type: 'signal',\r\n      displayName: 'Drag Ended'\r\n    },\r\n    onDrag: {\r\n      group: 'Signals',\r\n      type: 'signal',\r\n      displayName: 'Drag Moved'\r\n    },\r\n    positionX: {\r\n      group: 'Values',\r\n      displayName: 'Drag X',\r\n      type: 'number'\r\n    },\r\n    positionY: {\r\n      group: 'Values',\r\n      displayName: 'Drag Y',\r\n      type: 'number'\r\n    },\r\n    deltaX: {\r\n      group: 'Values',\r\n      displayName: 'Delta X',\r\n      type: 'number'\r\n    },\r\n    deltaY: {\r\n      group: 'Values',\r\n      displayName: 'Delta Y',\r\n      type: 'number'\r\n    }\r\n  }\r\n};\r\n\r\nexport default createNodeFromReactComponent(DragNode);\r\n","/*!\n * better-scroll / core\n * (c) 2016-2023 ustbhuangyi\n * Released under the MIT License.\n */\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\nvar propertiesConfig = [\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.currentPos',\r\n        key: 'x'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.currentPos',\r\n        key: 'y'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.hasScroll',\r\n        key: 'hasHorizontalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.hasScroll',\r\n        key: 'hasVerticalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.contentSize',\r\n        key: 'scrollerWidth'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.contentSize',\r\n        key: 'scrollerHeight'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.maxScrollPos',\r\n        key: 'maxScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.maxScrollPos',\r\n        key: 'maxScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.minScrollPos',\r\n        key: 'minScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.minScrollPos',\r\n        key: 'minScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.movingDirection',\r\n        key: 'movingDirectionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.movingDirection',\r\n        key: 'movingDirectionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.direction',\r\n        key: 'directionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.direction',\r\n        key: 'directionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.actions.enabled',\r\n        key: 'enabled'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.pending',\r\n        key: 'pending'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.stop',\r\n        key: 'stop'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollTo',\r\n        key: 'scrollTo'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBy',\r\n        key: 'scrollBy'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollToElement',\r\n        key: 'scrollToElement'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.resetPosition',\r\n        key: 'resetPosition'\r\n    }\r\n];\n\nfunction warn(msg) {\r\n    console.error(\"[BScroll warn]: \" + msg);\r\n}\n\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\nvar isWeChatDevTools = !!(ua && /wechatdevtools/.test(ua));\r\nvar isAndroid = ua && ua.indexOf('android') > 0;\r\n/* istanbul ignore next */\r\nvar isIOSBadVersion = (function () {\r\n    if (typeof ua === 'string') {\r\n        var regex = /os (\\d\\d?_\\d(_\\d)?)/;\r\n        var matches = regex.exec(ua);\r\n        if (!matches)\r\n            return false;\r\n        var parts = matches[1].split('_').map(function (item) {\r\n            return parseInt(item, 10);\r\n        });\r\n        // ios version >= 13.4 issue 982\r\n        return !!(parts[0] === 13 && parts[1] >= 4);\r\n    }\r\n    return false;\r\n})();\r\n/* istanbul ignore next */\r\nvar supportsPassive = false;\r\n/* istanbul ignore next */\r\nif (inBrowser) {\r\n    var EventName = 'test-passive';\r\n    try {\r\n        var opts = {};\r\n        Object.defineProperty(opts, 'passive', {\r\n            get: function () {\r\n                supportsPassive = true;\r\n            },\r\n        }); // https://github.com/facebook/flow/issues/285\r\n        window.addEventListener(EventName, function () { }, opts);\r\n    }\r\n    catch (e) { }\r\n}\n\nfunction getNow() {\r\n    return window.performance &&\r\n        window.performance.now &&\r\n        window.performance.timing\r\n        ? window.performance.now() + window.performance.timing.navigationStart\r\n        : +new Date();\r\n}\r\nvar extend = function (target, source) {\r\n    for (var key in source) {\r\n        target[key] = source[key];\r\n    }\r\n    return target;\r\n};\r\nfunction isUndef(v) {\r\n    return v === undefined || v === null;\r\n}\r\nfunction between(x, min, max) {\r\n    if (x < min) {\r\n        return min;\r\n    }\r\n    if (x > max) {\r\n        return max;\r\n    }\r\n    return x;\r\n}\n\nvar elementStyle = (inBrowser &&\r\n    document.createElement('div').style);\r\nvar vendor = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return false;\r\n    }\r\n    var transformNames = [\r\n        {\r\n            key: 'standard',\r\n            value: 'transform',\r\n        },\r\n        {\r\n            key: 'webkit',\r\n            value: 'webkitTransform',\r\n        },\r\n        {\r\n            key: 'Moz',\r\n            value: 'MozTransform',\r\n        },\r\n        {\r\n            key: 'O',\r\n            value: 'OTransform',\r\n        },\r\n        {\r\n            key: 'ms',\r\n            value: 'msTransform',\r\n        },\r\n    ];\r\n    for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\r\n        var obj = transformNames_1[_i];\r\n        if (elementStyle[obj.value] !== undefined) {\r\n            return obj.key;\r\n        }\r\n    }\r\n    /* istanbul ignore next  */\r\n    return false;\r\n})();\r\n/* istanbul ignore next  */\r\nfunction prefixStyle(style) {\r\n    if (vendor === false) {\r\n        return style;\r\n    }\r\n    if (vendor === 'standard') {\r\n        if (style === 'transitionEnd') {\r\n            return 'transitionend';\r\n        }\r\n        return style;\r\n    }\r\n    return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nfunction getElement(el) {\r\n    return (typeof el === 'string' ? document.querySelector(el) : el);\r\n}\r\nfunction addEvent(el, type, fn, capture) {\r\n    var useCapture = supportsPassive\r\n        ? {\r\n            passive: false,\r\n            capture: !!capture,\r\n        }\r\n        : !!capture;\r\n    el.addEventListener(type, fn, useCapture);\r\n}\r\nfunction removeEvent(el, type, fn, capture) {\r\n    el.removeEventListener(type, fn, {\r\n        capture: !!capture,\r\n    });\r\n}\r\nfunction maybePrevent(e) {\r\n    if (e.cancelable) {\r\n        e.preventDefault();\r\n    }\r\n}\r\nfunction offset(el) {\r\n    var left = 0;\r\n    var top = 0;\r\n    while (el) {\r\n        left -= el.offsetLeft;\r\n        top -= el.offsetTop;\r\n        el = el.offsetParent;\r\n    }\r\n    return {\r\n        left: left,\r\n        top: top,\r\n    };\r\n}\r\nvendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle;\r\n// fix issue #361\r\nvar hasTouch = inBrowser && ('ontouchstart' in window || isWeChatDevTools);\r\nvar hasTransition = inBrowser && transition in elementStyle;\r\nvar style = {\r\n    transform: transform,\r\n    transition: transition,\r\n    transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n    transitionDuration: prefixStyle('transitionDuration'),\r\n    transitionDelay: prefixStyle('transitionDelay'),\r\n    transformOrigin: prefixStyle('transformOrigin'),\r\n    transitionEnd: prefixStyle('transitionEnd'),\r\n    transitionProperty: prefixStyle('transitionProperty'),\r\n};\r\nvar eventTypeMap = {\r\n    touchstart: 1,\r\n    touchmove: 1,\r\n    touchend: 1,\r\n    touchcancel: 1,\r\n    mousedown: 2,\r\n    mousemove: 2,\r\n    mouseup: 2,\r\n};\r\nfunction getRect(el) {\r\n    /* istanbul ignore if  */\r\n    if (el instanceof window.SVGElement) {\r\n        var rect = el.getBoundingClientRect();\r\n        return {\r\n            top: rect.top,\r\n            left: rect.left,\r\n            width: rect.width,\r\n            height: rect.height,\r\n        };\r\n    }\r\n    else {\r\n        return {\r\n            top: el.offsetTop,\r\n            left: el.offsetLeft,\r\n            width: el.offsetWidth,\r\n            height: el.offsetHeight,\r\n        };\r\n    }\r\n}\r\nfunction preventDefaultExceptionFn(el, exceptions) {\r\n    for (var i in exceptions) {\r\n        if (exceptions[i].test(el[i])) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nvar tagExceptionFn = preventDefaultExceptionFn;\r\nfunction tap(e, eventName) {\r\n    var ev = document.createEvent('Event');\r\n    ev.initEvent(eventName, true, true);\r\n    ev.pageX = e.pageX;\r\n    ev.pageY = e.pageY;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction click(e, event) {\r\n    if (event === void 0) { event = 'click'; }\r\n    var eventSource;\r\n    if (e.type === 'mouseup') {\r\n        eventSource = e;\r\n    }\r\n    else if (e.type === 'touchend' || e.type === 'touchcancel') {\r\n        eventSource = e.changedTouches[0];\r\n    }\r\n    var posSrc = {};\r\n    if (eventSource) {\r\n        posSrc.screenX = eventSource.screenX || 0;\r\n        posSrc.screenY = eventSource.screenY || 0;\r\n        posSrc.clientX = eventSource.clientX || 0;\r\n        posSrc.clientY = eventSource.clientY || 0;\r\n    }\r\n    var ev;\r\n    var bubbles = true;\r\n    var cancelable = true;\r\n    var ctrlKey = e.ctrlKey, shiftKey = e.shiftKey, altKey = e.altKey, metaKey = e.metaKey;\r\n    var pressedKeysMap = {\r\n        ctrlKey: ctrlKey,\r\n        shiftKey: shiftKey,\r\n        altKey: altKey,\r\n        metaKey: metaKey,\r\n    };\r\n    if (typeof MouseEvent !== 'undefined') {\r\n        try {\r\n            ev = new MouseEvent(event, extend(__assign({ bubbles: bubbles,\r\n                cancelable: cancelable }, pressedKeysMap), posSrc));\r\n        }\r\n        catch (e) {\r\n            /* istanbul ignore next */\r\n            createEvent();\r\n        }\r\n    }\r\n    else {\r\n        createEvent();\r\n    }\r\n    function createEvent() {\r\n        ev = document.createEvent('Event');\r\n        ev.initEvent(event, bubbles, cancelable);\r\n        extend(ev, posSrc);\r\n    }\r\n    // forwardedTouchEvent set to true in case of the conflict with fastclick\r\n    ev.forwardedTouchEvent = true;\r\n    ev._constructed = true;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction dblclick(e) {\r\n    click(e, 'dblclick');\r\n}\n\nvar ease = {\r\n    // easeOutQuint\r\n    swipe: {\r\n        style: 'cubic-bezier(0.23, 1, 0.32, 1)',\r\n        fn: function (t) {\r\n            return 1 + --t * t * t * t * t;\r\n        }\r\n    },\r\n    // easeOutQuard\r\n    swipeBounce: {\r\n        style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n        fn: function (t) {\r\n            return t * (2 - t);\r\n        }\r\n    },\r\n    // easeOutQuart\r\n    bounce: {\r\n        style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\r\n        fn: function (t) {\r\n            return 1 - --t * t * t * t;\r\n        }\r\n    }\r\n};\n\nvar DEFAULT_INTERVAL = 1000 / 60;\r\nvar windowCompat = inBrowser && window;\r\n/* istanbul ignore next */\r\nfunction noop$1() { }\r\nvar requestAnimationFrame = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return noop$1;\r\n    }\r\n    return (windowCompat.requestAnimationFrame ||\r\n        windowCompat.webkitRequestAnimationFrame ||\r\n        windowCompat.mozRequestAnimationFrame ||\r\n        windowCompat.oRequestAnimationFrame ||\r\n        // if all else fails, use setTimeout\r\n        function (callback) {\r\n            return window.setTimeout(callback, callback.interval || DEFAULT_INTERVAL); // make interval as precise as possible.\r\n        });\r\n})();\r\nvar cancelAnimationFrame = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return noop$1;\r\n    }\r\n    return (windowCompat.cancelAnimationFrame ||\r\n        windowCompat.webkitCancelAnimationFrame ||\r\n        windowCompat.mozCancelAnimationFrame ||\r\n        windowCompat.oCancelAnimationFrame ||\r\n        function (id) {\r\n            window.clearTimeout(id);\r\n        });\r\n})();\n\n/* istanbul ignore next */\r\nvar noop = function (val) { };\r\nvar sharedPropertyDefinition = {\r\n    enumerable: true,\r\n    configurable: true,\r\n    get: noop,\r\n    set: noop,\r\n};\r\nvar getProperty = function (obj, key) {\r\n    var keys = key.split('.');\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        obj = obj[keys[i]];\r\n        if (typeof obj !== 'object' || !obj)\r\n            return;\r\n    }\r\n    var lastKey = keys.pop();\r\n    if (typeof obj[lastKey] === 'function') {\r\n        return function () {\r\n            return obj[lastKey].apply(obj, arguments);\r\n        };\r\n    }\r\n    else {\r\n        return obj[lastKey];\r\n    }\r\n};\r\nvar setProperty = function (obj, key, value) {\r\n    var keys = key.split('.');\r\n    var temp;\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        temp = keys[i];\r\n        if (!obj[temp])\r\n            obj[temp] = {};\r\n        obj = obj[temp];\r\n    }\r\n    obj[keys.pop()] = value;\r\n};\r\nfunction propertiesProxy(target, sourceKey, key) {\r\n    sharedPropertyDefinition.get = function proxyGetter() {\r\n        return getProperty(this, sourceKey);\r\n    };\r\n    sharedPropertyDefinition.set = function proxySetter(val) {\r\n        setProperty(this, sourceKey, val);\r\n    };\r\n    Object.defineProperty(target, key, sharedPropertyDefinition);\r\n}\n\nvar EventEmitter = /** @class */ (function () {\r\n    function EventEmitter(names) {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n        this.registerType(names);\r\n    }\r\n    EventEmitter.prototype.on = function (type, fn, context) {\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        if (!this.events[type]) {\r\n            this.events[type] = [];\r\n        }\r\n        this.events[type].push([fn, context]);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.once = function (type, fn, context) {\r\n        var _this = this;\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        var magic = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            _this.off(type, magic);\r\n            var ret = fn.apply(context, args);\r\n            if (ret === true) {\r\n                return ret;\r\n            }\r\n        };\r\n        magic.fn = fn;\r\n        this.on(type, magic);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.off = function (type, fn) {\r\n        if (!type && !fn) {\r\n            this.events = {};\r\n            return this;\r\n        }\r\n        if (type) {\r\n            this.hasType(type);\r\n            if (!fn) {\r\n                this.events[type] = [];\r\n                return this;\r\n            }\r\n            var events = this.events[type];\r\n            if (!events) {\r\n                return this;\r\n            }\r\n            var count = events.length;\r\n            while (count--) {\r\n                if (events[count][0] === fn ||\r\n                    (events[count][0] && events[count][0].fn === fn)) {\r\n                    events.splice(count, 1);\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    EventEmitter.prototype.trigger = function (type) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        this.hasType(type);\r\n        var events = this.events[type];\r\n        if (!events) {\r\n            return;\r\n        }\r\n        var len = events.length;\r\n        var eventsCopy = __spreadArrays(events);\r\n        var ret;\r\n        for (var i = 0; i < len; i++) {\r\n            var event_1 = eventsCopy[i];\r\n            var fn = event_1[0], context = event_1[1];\r\n            if (fn) {\r\n                ret = fn.apply(context, args);\r\n                if (ret === true) {\r\n                    return ret;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    EventEmitter.prototype.registerType = function (names) {\r\n        var _this = this;\r\n        names.forEach(function (type) {\r\n            _this.eventTypes[type] = type;\r\n        });\r\n    };\r\n    EventEmitter.prototype.destroy = function () {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n    };\r\n    EventEmitter.prototype.hasType = function (type) {\r\n        var types = this.eventTypes;\r\n        var isType = types[type] === type;\r\n        if (!isType) {\r\n            warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" +\r\n                (\"\" + Object.keys(types).map(function (_) { return JSON.stringify(_); })) +\r\n                \"]\");\r\n        }\r\n    };\r\n    return EventEmitter;\r\n}());\r\nvar EventRegister = /** @class */ (function () {\r\n    function EventRegister(wrapper, events) {\r\n        this.wrapper = wrapper;\r\n        this.events = events;\r\n        this.addDOMEvents();\r\n    }\r\n    EventRegister.prototype.destroy = function () {\r\n        this.removeDOMEvents();\r\n        this.events = [];\r\n    };\r\n    EventRegister.prototype.addDOMEvents = function () {\r\n        this.handleDOMEvents(addEvent);\r\n    };\r\n    EventRegister.prototype.removeDOMEvents = function () {\r\n        this.handleDOMEvents(removeEvent);\r\n    };\r\n    EventRegister.prototype.handleDOMEvents = function (eventOperation) {\r\n        var _this = this;\r\n        var wrapper = this.wrapper;\r\n        this.events.forEach(function (event) {\r\n            eventOperation(wrapper, event.name, _this, !!event.capture);\r\n        });\r\n    };\r\n    EventRegister.prototype.handleEvent = function (e) {\r\n        var eventType = e.type;\r\n        this.events.some(function (event) {\r\n            if (event.name === eventType) {\r\n                event.handler(e);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    };\r\n    return EventRegister;\r\n}());\n\nvar CustomOptions = /** @class */ (function () {\r\n    function CustomOptions() {\r\n    }\r\n    return CustomOptions;\r\n}());\r\nvar OptionsConstructor = /** @class */ (function (_super) {\r\n    __extends(OptionsConstructor, _super);\r\n    function OptionsConstructor() {\r\n        var _this = _super.call(this) || this;\r\n        _this.startX = 0;\r\n        _this.startY = 0;\r\n        _this.scrollX = false;\r\n        _this.scrollY = true;\r\n        _this.freeScroll = false;\r\n        _this.directionLockThreshold = 0;\r\n        _this.eventPassthrough = \"\" /* None */;\r\n        _this.click = false;\r\n        _this.dblclick = false;\r\n        _this.tap = '';\r\n        _this.bounce = {\r\n            top: true,\r\n            bottom: true,\r\n            left: true,\r\n            right: true,\r\n        };\r\n        _this.bounceTime = 800;\r\n        _this.momentum = true;\r\n        _this.momentumLimitTime = 300;\r\n        _this.momentumLimitDistance = 15;\r\n        _this.swipeTime = 2500;\r\n        _this.swipeBounceTime = 500;\r\n        _this.deceleration = 0.0015;\r\n        _this.flickLimitTime = 200;\r\n        _this.flickLimitDistance = 100;\r\n        _this.resizePolling = 60;\r\n        _this.probeType = 0 /* Default */;\r\n        _this.stopPropagation = false;\r\n        _this.preventDefault = true;\r\n        _this.preventDefaultException = {\r\n            tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/,\r\n        };\r\n        _this.tagException = {\r\n            tagName: /^TEXTAREA$/,\r\n        };\r\n        _this.HWCompositing = true;\r\n        _this.useTransition = true;\r\n        _this.bindToWrapper = false;\r\n        _this.bindToTarget = false;\r\n        _this.disableMouse = hasTouch;\r\n        _this.disableTouch = !hasTouch;\r\n        _this.autoBlur = true;\r\n        _this.autoEndDistance = 5;\r\n        _this.outOfBoundaryDampingFactor = 1 / 3;\r\n        _this.specifiedIndexAsContent = 0;\r\n        _this.quadrant = 1 /* First */;\r\n        return _this;\r\n    }\r\n    OptionsConstructor.prototype.merge = function (options) {\r\n        if (!options)\r\n            return this;\r\n        for (var key in options) {\r\n            if (key === 'bounce') {\r\n                this.bounce = this.resolveBounce(options[key]);\r\n                continue;\r\n            }\r\n            this[key] = options[key];\r\n        }\r\n        return this;\r\n    };\r\n    OptionsConstructor.prototype.process = function () {\r\n        this.translateZ =\r\n            this.HWCompositing && hasPerspective ? ' translateZ(1px)' : '';\r\n        this.useTransition = this.useTransition && hasTransition;\r\n        this.preventDefault = !this.eventPassthrough && this.preventDefault;\r\n        // If you want eventPassthrough I have to lock one of the axes\r\n        this.scrollX =\r\n            this.eventPassthrough === \"horizontal\" /* Horizontal */\r\n                ? false\r\n                : this.scrollX;\r\n        this.scrollY =\r\n            this.eventPassthrough === \"vertical\" /* Vertical */ ? false : this.scrollY;\r\n        // With eventPassthrough we also need lockDirection mechanism\r\n        this.freeScroll = this.freeScroll && !this.eventPassthrough;\r\n        // force true when freeScroll is true\r\n        this.scrollX = this.freeScroll ? true : this.scrollX;\r\n        this.scrollY = this.freeScroll ? true : this.scrollY;\r\n        this.directionLockThreshold = this.eventPassthrough\r\n            ? 0\r\n            : this.directionLockThreshold;\r\n        return this;\r\n    };\r\n    OptionsConstructor.prototype.resolveBounce = function (bounceOptions) {\r\n        var DEFAULT_BOUNCE = {\r\n            top: true,\r\n            right: true,\r\n            bottom: true,\r\n            left: true,\r\n        };\r\n        var NEGATED_BOUNCE = {\r\n            top: false,\r\n            right: false,\r\n            bottom: false,\r\n            left: false,\r\n        };\r\n        var ret;\r\n        if (typeof bounceOptions === 'object') {\r\n            ret = extend(DEFAULT_BOUNCE, bounceOptions);\r\n        }\r\n        else {\r\n            ret = bounceOptions ? DEFAULT_BOUNCE : NEGATED_BOUNCE;\r\n        }\r\n        return ret;\r\n    };\r\n    return OptionsConstructor;\r\n}(CustomOptions));\n\nvar ActionsHandler = /** @class */ (function () {\r\n    function ActionsHandler(wrapper, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'start',\r\n            'move',\r\n            'end',\r\n            'click',\r\n        ]);\r\n        this.handleDOMEvents();\r\n    }\r\n    ActionsHandler.prototype.handleDOMEvents = function () {\r\n        var _a = this.options, bindToWrapper = _a.bindToWrapper, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch, click = _a.click;\r\n        var wrapper = this.wrapper;\r\n        var target = bindToWrapper ? wrapper : window;\r\n        var wrapperEvents = [];\r\n        var targetEvents = [];\r\n        var shouldRegisterTouch = !disableTouch;\r\n        var shouldRegisterMouse = !disableMouse;\r\n        if (click) {\r\n            wrapperEvents.push({\r\n                name: 'click',\r\n                handler: this.click.bind(this),\r\n                capture: true,\r\n            });\r\n        }\r\n        if (shouldRegisterTouch) {\r\n            wrapperEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            targetEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            }, {\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (shouldRegisterMouse) {\r\n            wrapperEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            targetEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            }, {\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.wrapperEventRegister = new EventRegister(wrapper, wrapperEvents);\r\n        this.targetEventRegister = new EventRegister(target, targetEvents);\r\n    };\r\n    ActionsHandler.prototype.beforeHandler = function (e, type) {\r\n        var _a = this.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        var preventDefaultConditions = {\r\n            start: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            end: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            move: function () {\r\n                return preventDefault;\r\n            },\r\n        };\r\n        if (preventDefaultConditions[type]()) {\r\n            e.preventDefault();\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.setInitiated = function (type) {\r\n        if (type === void 0) { type = 0; }\r\n        this.initiated = type;\r\n    };\r\n    ActionsHandler.prototype.start = function (e) {\r\n        var _eventType = eventTypeMap[e.type];\r\n        if (this.initiated && this.initiated !== _eventType) {\r\n            return;\r\n        }\r\n        this.setInitiated(_eventType);\r\n        // if textarea or other html tags in options.tagException is manipulated\r\n        // do not make bs scroll\r\n        if (tagExceptionFn(e.target, this.options.tagException)) {\r\n            this.setInitiated();\r\n            return;\r\n        }\r\n        // only allow mouse left button\r\n        if (_eventType === 2 /* Mouse */ && e.button !== 0 /* Left */)\r\n            return;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeStart, e)) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'start');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ActionsHandler.prototype.move = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'move');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var deltaX = point.pageX - this.pointX;\r\n        var deltaY = point.pageY - this.pointY;\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.move, {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY,\r\n            e: e,\r\n        })) {\r\n            return;\r\n        }\r\n        // auto end when out of viewport\r\n        var scrollLeft = document.documentElement.scrollLeft ||\r\n            window.pageXOffset ||\r\n            document.body.scrollLeft;\r\n        var scrollTop = document.documentElement.scrollTop ||\r\n            window.pageYOffset ||\r\n            document.body.scrollTop;\r\n        var pX = this.pointX - scrollLeft;\r\n        var pY = this.pointY - scrollTop;\r\n        var autoEndDistance = this.options.autoEndDistance;\r\n        if (pX > document.documentElement.clientWidth - autoEndDistance ||\r\n            pY > document.documentElement.clientHeight - autoEndDistance ||\r\n            pX < autoEndDistance ||\r\n            pY < autoEndDistance) {\r\n            this.end(e);\r\n        }\r\n    };\r\n    ActionsHandler.prototype.end = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.setInitiated();\r\n        this.beforeHandler(e, 'end');\r\n        this.hooks.trigger(this.hooks.eventTypes.end, e);\r\n    };\r\n    ActionsHandler.prototype.click = function (e) {\r\n        this.hooks.trigger(this.hooks.eventTypes.click, e);\r\n    };\r\n    ActionsHandler.prototype.setContent = function (content) {\r\n        if (content !== this.wrapper) {\r\n            this.wrapper = content;\r\n            this.rebindDOMEvents();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.rebindDOMEvents = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.handleDOMEvents();\r\n    };\r\n    ActionsHandler.prototype.destroy = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.hooks.destroy();\r\n    };\r\n    return ActionsHandler;\r\n}());\n\nvar translaterMetaData = {\r\n    x: ['translateX', 'px'],\r\n    y: ['translateY', 'px'],\r\n};\r\nvar Translater = /** @class */ (function () {\r\n    function Translater(content) {\r\n        this.setContent(content);\r\n        this.hooks = new EventEmitter(['beforeTranslate', 'translate']);\r\n    }\r\n    Translater.prototype.getComputedPosition = function () {\r\n        var cssStyle = window.getComputedStyle(this.content, null);\r\n        var matrix = cssStyle[style.transform].split(')')[0].split(', ');\r\n        var x = +(matrix[12] || matrix[4]) || 0;\r\n        var y = +(matrix[13] || matrix[5]) || 0;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n        };\r\n    };\r\n    Translater.prototype.translate = function (point) {\r\n        var transformStyle = [];\r\n        Object.keys(point).forEach(function (key) {\r\n            if (!translaterMetaData[key]) {\r\n                return;\r\n            }\r\n            var transformFnName = translaterMetaData[key][0];\r\n            if (transformFnName) {\r\n                var transformFnArgUnit = translaterMetaData[key][1];\r\n                var transformFnArg = point[key];\r\n                transformStyle.push(transformFnName + \"(\" + transformFnArg + transformFnArgUnit + \")\");\r\n            }\r\n        });\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeTranslate, transformStyle, point);\r\n        this.style[style.transform] = transformStyle.join(' ');\r\n        this.hooks.trigger(this.hooks.eventTypes.translate, point);\r\n    };\r\n    Translater.prototype.setContent = function (content) {\r\n        if (this.content !== content) {\r\n            this.content = content;\r\n            this.style = content.style;\r\n        }\r\n    };\r\n    Translater.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Translater;\r\n}());\n\nvar Base = /** @class */ (function () {\r\n    function Base(content, translater, options) {\r\n        this.translater = translater;\r\n        this.options = options;\r\n        this.timer = 0;\r\n        this.hooks = new EventEmitter([\r\n            'move',\r\n            'end',\r\n            'beforeForceStop',\r\n            'forceStop',\r\n            'callStop',\r\n            'time',\r\n            'timeFunction',\r\n        ]);\r\n        this.setContent(content);\r\n    }\r\n    Base.prototype.translate = function (endPoint) {\r\n        this.translater.translate(endPoint);\r\n    };\r\n    Base.prototype.setPending = function (pending) {\r\n        this.pending = pending;\r\n    };\r\n    Base.prototype.setForceStopped = function (forceStopped) {\r\n        this.forceStopped = forceStopped;\r\n    };\r\n    Base.prototype.setCallStop = function (called) {\r\n        this.callStopWhenPending = called;\r\n    };\r\n    Base.prototype.setContent = function (content) {\r\n        if (this.content !== content) {\r\n            this.content = content;\r\n            this.style = content.style;\r\n            this.stop();\r\n        }\r\n    };\r\n    Base.prototype.clearTimer = function () {\r\n        if (this.timer) {\r\n            cancelAnimationFrame(this.timer);\r\n            this.timer = 0;\r\n        }\r\n    };\r\n    Base.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n        cancelAnimationFrame(this.timer);\r\n    };\r\n    return Base;\r\n}());\n\n// iOS 13.6 - 14.x, window.getComputedStyle sometimes will get wrong transform value\r\n// when bs use transition mode\r\n// eg: translateY -100px -> -200px, when the last frame which is about to scroll to -200px\r\n// window.getComputedStyle(this.content) will calculate transformY to be -100px(startPoint)\r\n// it is weird\r\n// so we should validate position caculated by 'window.getComputedStyle'\r\nvar isValidPostion = function (startPoint, endPoint, currentPos, prePos) {\r\n    var computeDirection = function (endValue, startValue) {\r\n        var delta = endValue - startValue;\r\n        var direction = delta > 0\r\n            ? -1 /* Negative */\r\n            : delta < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        return direction;\r\n    };\r\n    var directionX = computeDirection(endPoint.x, startPoint.x);\r\n    var directionY = computeDirection(endPoint.y, startPoint.y);\r\n    var deltaX = currentPos.x - prePos.x;\r\n    var deltaY = currentPos.y - prePos.y;\r\n    return directionX * deltaX <= 0 && directionY * deltaY <= 0;\r\n};\n\nvar Transition = /** @class */ (function (_super) {\r\n    __extends(Transition, _super);\r\n    function Transition() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Transition.prototype.startProbe = function (startPoint, endPoint) {\r\n        var _this = this;\r\n        var prePos = startPoint;\r\n        var probe = function () {\r\n            var pos = _this.translater.getComputedPosition();\r\n            if (isValidPostion(startPoint, endPoint, pos, prePos)) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, pos);\r\n            }\r\n            // call bs.stop() should not dispatch end hook again.\r\n            // forceStop hook will do this.\r\n            /* istanbul ignore if  */\r\n            if (!_this.pending) {\r\n                if (_this.callStopWhenPending) {\r\n                    _this.callStopWhenPending = false;\r\n                }\r\n                else {\r\n                    // transition ends should dispatch end hook.\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.end, pos);\r\n                }\r\n            }\r\n            prePos = pos;\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(probe);\r\n            }\r\n        };\r\n        // when manually call bs.stop(), then bs.scrollTo()\r\n        // we should reset callStopWhenPending to dispatch end hook\r\n        if (this.callStopWhenPending) {\r\n            this.setCallStop(false);\r\n        }\r\n        cancelAnimationFrame(this.timer);\r\n        probe();\r\n    };\r\n    Transition.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.style[style.transitionDuration] = time + 'ms';\r\n        this.hooks.trigger(this.hooks.eventTypes.time, time);\r\n    };\r\n    Transition.prototype.transitionTimingFunction = function (easing) {\r\n        this.style[style.transitionTimingFunction] = easing;\r\n        this.hooks.trigger(this.hooks.eventTypes.timeFunction, easing);\r\n    };\r\n    Transition.prototype.transitionProperty = function () {\r\n        this.style[style.transitionProperty] = style.transform;\r\n    };\r\n    Transition.prototype.move = function (startPoint, endPoint, time, easingFn) {\r\n        this.setPending(time > 0);\r\n        this.transitionTimingFunction(easingFn);\r\n        this.transitionProperty();\r\n        this.transitionTime(time);\r\n        this.translate(endPoint);\r\n        var isRealtimeProbeType = this.options.probeType === 3 /* Realtime */;\r\n        if (time && isRealtimeProbeType) {\r\n            this.startProbe(startPoint, endPoint);\r\n        }\r\n        // if we change content's transformY in a tick\r\n        // such as: 0 -> 50px -> 0\r\n        // transitionend will not be triggered\r\n        // so we forceupdate by reflow\r\n        if (!time) {\r\n            this._reflow = this.content.offsetHeight;\r\n            if (isRealtimeProbeType) {\r\n                this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n        }\r\n    };\r\n    Transition.prototype.doStop = function () {\r\n        var pending = this.pending;\r\n        this.setForceStopped(false);\r\n        this.setCallStop(false);\r\n        // still in transition\r\n        if (pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var _a = this.translater.getComputedPosition(), x = _a.x, y = _a.y;\r\n            this.transitionTime();\r\n            this.translate({ x: x, y: y });\r\n            this.setForceStopped(true);\r\n            this.setCallStop(true);\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, { x: x, y: y });\r\n        }\r\n        return pending;\r\n    };\r\n    Transition.prototype.stop = function () {\r\n        var stopFromTransition = this.doStop();\r\n        if (stopFromTransition) {\r\n            this.hooks.trigger(this.hooks.eventTypes.callStop);\r\n        }\r\n    };\r\n    return Transition;\r\n}(Base));\n\nvar Animation = /** @class */ (function (_super) {\r\n    __extends(Animation, _super);\r\n    function Animation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Animation.prototype.move = function (startPoint, endPoint, time, easingFn) {\r\n        // time is 0\r\n        if (!time) {\r\n            this.translate(endPoint);\r\n            if (this.options.probeType === 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n            return;\r\n        }\r\n        this.animate(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Animation.prototype.animate = function (startPoint, endPoint, duration, easingFn) {\r\n        var _this = this;\r\n        var startTime = getNow();\r\n        var destTime = startTime + duration;\r\n        var isRealtimeProbeType = this.options.probeType === 3 /* Realtime */;\r\n        var step = function () {\r\n            var now = getNow();\r\n            // js animation end\r\n            if (now >= destTime) {\r\n                _this.translate(endPoint);\r\n                if (isRealtimeProbeType) {\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.move, endPoint);\r\n                }\r\n                _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                return;\r\n            }\r\n            now = (now - startTime) / duration;\r\n            var easing = easingFn(now);\r\n            var newPoint = {};\r\n            Object.keys(endPoint).forEach(function (key) {\r\n                var startValue = startPoint[key];\r\n                var endValue = endPoint[key];\r\n                newPoint[key] = (endValue - startValue) * easing + startValue;\r\n            });\r\n            _this.translate(newPoint);\r\n            if (isRealtimeProbeType) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, newPoint);\r\n            }\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(step);\r\n            }\r\n            // call bs.stop() should not dispatch end hook again.\r\n            // forceStop hook will do this.\r\n            /* istanbul ignore if  */\r\n            if (!_this.pending) {\r\n                if (_this.callStopWhenPending) {\r\n                    _this.callStopWhenPending = false;\r\n                }\r\n                else {\r\n                    // raf ends should dispatch end hook.\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                }\r\n            }\r\n        };\r\n        this.setPending(true);\r\n        // when manually call bs.stop(), then bs.scrollTo()\r\n        // we should reset callStopWhenPending to dispatch end hook\r\n        if (this.callStopWhenPending) {\r\n            this.setCallStop(false);\r\n        }\r\n        cancelAnimationFrame(this.timer);\r\n        step();\r\n    };\r\n    Animation.prototype.doStop = function () {\r\n        var pending = this.pending;\r\n        this.setForceStopped(false);\r\n        this.setCallStop(false);\r\n        // still in requestFrameAnimation\r\n        if (pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var pos = this.translater.getComputedPosition();\r\n            this.setForceStopped(true);\r\n            this.setCallStop(true);\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, pos);\r\n        }\r\n        return pending;\r\n    };\r\n    Animation.prototype.stop = function () {\r\n        var stopFromAnimation = this.doStop();\r\n        if (stopFromAnimation) {\r\n            this.hooks.trigger(this.hooks.eventTypes.callStop);\r\n        }\r\n    };\r\n    return Animation;\r\n}(Base));\n\nfunction createAnimater(element, translater, options) {\r\n    var useTransition = options.useTransition;\r\n    var animaterOptions = {};\r\n    Object.defineProperty(animaterOptions, 'probeType', {\r\n        enumerable: true,\r\n        configurable: false,\r\n        get: function () {\r\n            return options.probeType;\r\n        },\r\n    });\r\n    if (useTransition) {\r\n        return new Transition(element, translater, animaterOptions);\r\n    }\r\n    else {\r\n        return new Animation(element, translater, animaterOptions);\r\n    }\r\n}\n\nvar Behavior = /** @class */ (function () {\r\n    function Behavior(wrapper, content, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeComputeBoundary',\r\n            'computeBoundary',\r\n            'momentum',\r\n            'end',\r\n            'ignoreHasScroll'\r\n        ]);\r\n        this.refresh(content);\r\n    }\r\n    Behavior.prototype.start = function () {\r\n        this.dist = 0;\r\n        this.setMovingDirection(0 /* Default */);\r\n        this.setDirection(0 /* Default */);\r\n    };\r\n    Behavior.prototype.move = function (delta) {\r\n        delta = this.hasScroll ? delta : 0;\r\n        this.setMovingDirection(delta);\r\n        return this.performDampingAlgorithm(delta, this.options.outOfBoundaryDampingFactor);\r\n    };\r\n    Behavior.prototype.setMovingDirection = function (delta) {\r\n        this.movingDirection =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.setDirection = function (delta) {\r\n        this.direction =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.performDampingAlgorithm = function (delta, dampingFactor) {\r\n        var newPos = this.currentPos + delta;\r\n        // Slow down or stop if outside of the boundaries\r\n        if (newPos > this.minScrollPos || newPos < this.maxScrollPos) {\r\n            if ((newPos > this.minScrollPos && this.options.bounces[0]) ||\r\n                (newPos < this.maxScrollPos && this.options.bounces[1])) {\r\n                newPos = this.currentPos + delta * dampingFactor;\r\n            }\r\n            else {\r\n                newPos =\r\n                    newPos > this.minScrollPos ? this.minScrollPos : this.maxScrollPos;\r\n            }\r\n        }\r\n        return newPos;\r\n    };\r\n    Behavior.prototype.end = function (duration) {\r\n        var momentumInfo = {\r\n            duration: 0\r\n        };\r\n        var absDist = Math.abs(this.currentPos - this.startPos);\r\n        // start momentum animation if needed\r\n        if (this.options.momentum &&\r\n            duration < this.options.momentumLimitTime &&\r\n            absDist > this.options.momentumLimitDistance) {\r\n            var wrapperSize = (this.direction === -1 /* Negative */ && this.options.bounces[0]) ||\r\n                (this.direction === 1 /* Positive */ && this.options.bounces[1])\r\n                ? this.wrapperSize\r\n                : 0;\r\n            momentumInfo = this.hasScroll\r\n                ? this.momentum(this.currentPos, this.startPos, duration, this.maxScrollPos, this.minScrollPos, wrapperSize, this.options)\r\n                : { destination: this.currentPos, duration: 0 };\r\n        }\r\n        else {\r\n            this.hooks.trigger(this.hooks.eventTypes.end, momentumInfo);\r\n        }\r\n        return momentumInfo;\r\n    };\r\n    Behavior.prototype.momentum = function (current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\r\n        if (options === void 0) { options = this.options; }\r\n        var distance = current - start;\r\n        var speed = Math.abs(distance) / time;\r\n        var deceleration = options.deceleration, swipeBounceTime = options.swipeBounceTime, swipeTime = options.swipeTime;\r\n        var duration = Math.min(swipeTime, (speed * 2) / deceleration);\r\n        var momentumData = {\r\n            destination: current + ((speed * speed) / deceleration) * (distance < 0 ? -1 : 1),\r\n            duration: duration,\r\n            rate: 15\r\n        };\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\r\n        if (momentumData.destination < lowerMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - (wrapperSize / momentumData.rate) * speed)\r\n                : lowerMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        else if (momentumData.destination > upperMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.min(upperMargin + wrapperSize / 4, upperMargin + (wrapperSize / momentumData.rate) * speed)\r\n                : upperMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        momentumData.destination = Math.round(momentumData.destination);\r\n        return momentumData;\r\n    };\r\n    Behavior.prototype.updateDirection = function () {\r\n        var absDist = this.currentPos - this.absStartPos;\r\n        this.setDirection(absDist);\r\n    };\r\n    Behavior.prototype.refresh = function (content) {\r\n        var _a = this.options.rect, size = _a.size, position = _a.position;\r\n        var isWrapperStatic = window.getComputedStyle(this.wrapper, null).position === 'static';\r\n        // Force reflow\r\n        var wrapperRect = getRect(this.wrapper);\r\n        // use client is more fair than offset\r\n        this.wrapperSize = this.wrapper[size === 'width' ? 'clientWidth' : 'clientHeight'];\r\n        this.setContent(content);\r\n        var contentRect = getRect(this.content);\r\n        this.contentSize = contentRect[size];\r\n        this.relativeOffset = contentRect[position];\r\n        /* istanbul ignore if  */\r\n        if (isWrapperStatic) {\r\n            this.relativeOffset -= wrapperRect[position];\r\n        }\r\n        this.computeBoundary();\r\n        this.setDirection(0 /* Default */);\r\n    };\r\n    Behavior.prototype.setContent = function (content) {\r\n        if (content !== this.content) {\r\n            this.content = content;\r\n            this.resetState();\r\n        }\r\n    };\r\n    Behavior.prototype.resetState = function () {\r\n        this.currentPos = 0;\r\n        this.startPos = 0;\r\n        this.dist = 0;\r\n        this.setDirection(0 /* Default */);\r\n        this.setMovingDirection(0 /* Default */);\r\n        this.resetStartPos();\r\n    };\r\n    Behavior.prototype.computeBoundary = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeComputeBoundary);\r\n        var boundary = {\r\n            minScrollPos: 0,\r\n            maxScrollPos: this.wrapperSize - this.contentSize\r\n        };\r\n        if (boundary.maxScrollPos < 0) {\r\n            boundary.maxScrollPos -= this.relativeOffset;\r\n            if (this.options.specifiedIndexAsContent === 0) {\r\n                boundary.minScrollPos = -this.relativeOffset;\r\n            }\r\n        }\r\n        this.hooks.trigger(this.hooks.eventTypes.computeBoundary, boundary);\r\n        this.minScrollPos = boundary.minScrollPos;\r\n        this.maxScrollPos = boundary.maxScrollPos;\r\n        this.hasScroll =\r\n            this.options.scrollable && this.maxScrollPos < this.minScrollPos;\r\n        if (!this.hasScroll && this.minScrollPos < this.maxScrollPos) {\r\n            this.maxScrollPos = this.minScrollPos;\r\n            this.contentSize = this.wrapperSize;\r\n        }\r\n    };\r\n    Behavior.prototype.updatePosition = function (pos) {\r\n        this.currentPos = pos;\r\n    };\r\n    Behavior.prototype.getCurrentPos = function () {\r\n        return this.currentPos;\r\n    };\r\n    Behavior.prototype.checkInBoundary = function () {\r\n        var position = this.adjustPosition(this.currentPos);\r\n        var inBoundary = position === this.getCurrentPos();\r\n        return {\r\n            position: position,\r\n            inBoundary: inBoundary\r\n        };\r\n    };\r\n    // adjust position when out of boundary\r\n    Behavior.prototype.adjustPosition = function (pos) {\r\n        if (!this.hasScroll &&\r\n            !this.hooks.trigger(this.hooks.eventTypes.ignoreHasScroll)) {\r\n            pos = this.minScrollPos;\r\n        }\r\n        else if (pos > this.minScrollPos) {\r\n            pos = this.minScrollPos;\r\n        }\r\n        else if (pos < this.maxScrollPos) {\r\n            pos = this.maxScrollPos;\r\n        }\r\n        return pos;\r\n    };\r\n    Behavior.prototype.updateStartPos = function () {\r\n        this.startPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.updateAbsStartPos = function () {\r\n        this.absStartPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.resetStartPos = function () {\r\n        this.updateStartPos();\r\n        this.updateAbsStartPos();\r\n    };\r\n    Behavior.prototype.getAbsDist = function (delta) {\r\n        this.dist += delta;\r\n        return Math.abs(this.dist);\r\n    };\r\n    Behavior.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Behavior;\r\n}());\n\nvar _a, _b, _c, _d;\r\nvar PassthroughHandlers = (_a = {},\r\n    _a[\"yes\" /* Yes */] = function (e) {\r\n        return true;\r\n    },\r\n    _a[\"no\" /* No */] = function (e) {\r\n        maybePrevent(e);\r\n        return false;\r\n    },\r\n    _a);\r\nvar DirectionMap = (_b = {},\r\n    _b[\"horizontal\" /* Horizontal */] = (_c = {},\r\n        _c[\"yes\" /* Yes */] = \"horizontal\" /* Horizontal */,\r\n        _c[\"no\" /* No */] = \"vertical\" /* Vertical */,\r\n        _c),\r\n    _b[\"vertical\" /* Vertical */] = (_d = {},\r\n        _d[\"yes\" /* Yes */] = \"vertical\" /* Vertical */,\r\n        _d[\"no\" /* No */] = \"horizontal\" /* Horizontal */,\r\n        _d),\r\n    _b);\r\nvar DirectionLockAction = /** @class */ (function () {\r\n    function DirectionLockAction(directionLockThreshold, freeScroll, eventPassthrough) {\r\n        this.directionLockThreshold = directionLockThreshold;\r\n        this.freeScroll = freeScroll;\r\n        this.eventPassthrough = eventPassthrough;\r\n        this.reset();\r\n    }\r\n    DirectionLockAction.prototype.reset = function () {\r\n        this.directionLocked = \"\" /* Default */;\r\n    };\r\n    DirectionLockAction.prototype.checkMovingDirection = function (absDistX, absDistY, e) {\r\n        this.computeDirectionLock(absDistX, absDistY);\r\n        return this.handleEventPassthrough(e);\r\n    };\r\n    DirectionLockAction.prototype.adjustDelta = function (deltaX, deltaY) {\r\n        if (this.directionLocked === \"horizontal\" /* Horizontal */) {\r\n            deltaY = 0;\r\n        }\r\n        else if (this.directionLocked === \"vertical\" /* Vertical */) {\r\n            deltaX = 0;\r\n        }\r\n        return {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY,\r\n        };\r\n    };\r\n    DirectionLockAction.prototype.computeDirectionLock = function (absDistX, absDistY) {\r\n        // If you are scrolling in one direction, lock it\r\n        if (this.directionLocked === \"\" /* Default */ && !this.freeScroll) {\r\n            if (absDistX > absDistY + this.directionLockThreshold) {\r\n                this.directionLocked = \"horizontal\" /* Horizontal */; // lock horizontally\r\n            }\r\n            else if (absDistY >= absDistX + this.directionLockThreshold) {\r\n                this.directionLocked = \"vertical\" /* Vertical */; // lock vertically\r\n            }\r\n            else {\r\n                this.directionLocked = \"none\" /* None */; // no lock\r\n            }\r\n        }\r\n    };\r\n    DirectionLockAction.prototype.handleEventPassthrough = function (e) {\r\n        var handleMap = DirectionMap[this.directionLocked];\r\n        if (handleMap) {\r\n            if (this.eventPassthrough === handleMap[\"yes\" /* Yes */]) {\r\n                return PassthroughHandlers[\"yes\" /* Yes */](e);\r\n            }\r\n            else if (this.eventPassthrough === handleMap[\"no\" /* No */]) {\r\n                return PassthroughHandlers[\"no\" /* No */](e);\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    return DirectionLockAction;\r\n}());\n\nvar applyQuadrantTransformation = function (deltaX, deltaY, quadrant) {\r\n    if (quadrant === 2 /* Second */) {\r\n        return [deltaY, -deltaX];\r\n    }\r\n    else if (quadrant === 3 /* Third */) {\r\n        return [-deltaX, -deltaY];\r\n    }\r\n    else if (quadrant === 4 /* Forth */) {\r\n        return [-deltaY, deltaX];\r\n    }\r\n    else {\r\n        return [deltaX, deltaY];\r\n    }\r\n};\r\nvar ScrollerActions = /** @class */ (function () {\r\n    function ScrollerActions(scrollBehaviorX, scrollBehaviorY, actionsHandler, animater, options) {\r\n        this.hooks = new EventEmitter([\r\n            'start',\r\n            'beforeMove',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'end',\r\n            'scrollEnd',\r\n            'contentNotMoved',\r\n            'detectMovingDirection',\r\n            'coordinateTransformation',\r\n        ]);\r\n        this.scrollBehaviorX = scrollBehaviorX;\r\n        this.scrollBehaviorY = scrollBehaviorY;\r\n        this.actionsHandler = actionsHandler;\r\n        this.animater = animater;\r\n        this.options = options;\r\n        this.directionLockAction = new DirectionLockAction(options.directionLockThreshold, options.freeScroll, options.eventPassthrough);\r\n        this.enabled = true;\r\n        this.bindActionsHandler();\r\n    }\r\n    ScrollerActions.prototype.bindActionsHandler = function () {\r\n        var _this = this;\r\n        // [mouse|touch]start event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleStart(e);\r\n        });\r\n        // [mouse|touch]move event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move, function (_a) {\r\n            var deltaX = _a.deltaX, deltaY = _a.deltaY, e = _a.e;\r\n            if (!_this.enabled)\r\n                return true;\r\n            var _b = applyQuadrantTransformation(deltaX, deltaY, _this.options.quadrant), transformateDeltaX = _b[0], transformateDeltaY = _b[1];\r\n            var transformateDeltaData = {\r\n                deltaX: transformateDeltaX,\r\n                deltaY: transformateDeltaY,\r\n            };\r\n            _this.hooks.trigger(_this.hooks.eventTypes.coordinateTransformation, transformateDeltaData);\r\n            return _this.handleMove(transformateDeltaData.deltaX, transformateDeltaData.deltaY, e);\r\n        });\r\n        // [mouse|touch]end event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleEnd(e);\r\n        });\r\n        // click\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click, function (e) {\r\n            // handle native click event\r\n            if (_this.enabled && !e._constructed) {\r\n                _this.handleClick(e);\r\n            }\r\n        });\r\n    };\r\n    ScrollerActions.prototype.handleStart = function (e) {\r\n        var timestamp = getNow();\r\n        this.fingerMoved = false;\r\n        this.contentMoved = false;\r\n        this.startTime = timestamp;\r\n        this.directionLockAction.reset();\r\n        this.scrollBehaviorX.start();\r\n        this.scrollBehaviorY.start();\r\n        // force stopping last transition or animation\r\n        this.animater.doStop();\r\n        this.scrollBehaviorX.resetStartPos();\r\n        this.scrollBehaviorY.resetStartPos();\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ScrollerActions.prototype.handleMove = function (deltaX, deltaY, e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeMove, e)) {\r\n            return;\r\n        }\r\n        var absDistX = this.scrollBehaviorX.getAbsDist(deltaX);\r\n        var absDistY = this.scrollBehaviorY.getAbsDist(deltaY);\r\n        var timestamp = getNow();\r\n        // We need to move at least momentumLimitDistance pixels\r\n        // for the scrolling to initiate\r\n        if (this.checkMomentum(absDistX, absDistY, timestamp)) {\r\n            return true;\r\n        }\r\n        if (this.directionLockAction.checkMovingDirection(absDistX, absDistY, e)) {\r\n            this.actionsHandler.setInitiated();\r\n            return true;\r\n        }\r\n        var delta = this.directionLockAction.adjustDelta(deltaX, deltaY);\r\n        var prevX = this.scrollBehaviorX.getCurrentPos();\r\n        var newX = this.scrollBehaviorX.move(delta.deltaX);\r\n        var prevY = this.scrollBehaviorY.getCurrentPos();\r\n        var newY = this.scrollBehaviorY.move(delta.deltaY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.detectMovingDirection)) {\r\n            return;\r\n        }\r\n        if (!this.fingerMoved) {\r\n            this.fingerMoved = true;\r\n        }\r\n        var positionChanged = newX !== prevX || newY !== prevY;\r\n        if (!this.contentMoved && !positionChanged) {\r\n            this.hooks.trigger(this.hooks.eventTypes.contentNotMoved);\r\n        }\r\n        if (!this.contentMoved && positionChanged) {\r\n            this.contentMoved = true;\r\n            this.hooks.trigger(this.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.contentMoved && positionChanged) {\r\n            this.animater.translate({\r\n                x: newX,\r\n                y: newY,\r\n            });\r\n            this.dispatchScroll(timestamp);\r\n        }\r\n    };\r\n    ScrollerActions.prototype.dispatchScroll = function (timestamp) {\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > this.options.momentumLimitTime) {\r\n            // refresh time and starting position to initiate a momentum\r\n            this.startTime = timestamp;\r\n            this.scrollBehaviorX.updateStartPos();\r\n            this.scrollBehaviorY.updateStartPos();\r\n            if (this.options.probeType === 1 /* Throttle */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (this.options.probeType > 1 /* Throttle */) {\r\n            this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n        }\r\n    };\r\n    ScrollerActions.prototype.checkMomentum = function (absDistX, absDistY, timestamp) {\r\n        return (timestamp - this.endTime > this.options.momentumLimitTime &&\r\n            absDistY < this.options.momentumLimitDistance &&\r\n            absDistX < this.options.momentumLimitDistance);\r\n    };\r\n    ScrollerActions.prototype.handleEnd = function (e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeEnd, e)) {\r\n            return;\r\n        }\r\n        var currentPos = this.getCurrentPos();\r\n        this.scrollBehaviorX.updateDirection();\r\n        this.scrollBehaviorY.updateDirection();\r\n        if (this.hooks.trigger(this.hooks.eventTypes.end, e, currentPos)) {\r\n            return true;\r\n        }\r\n        currentPos = this.ensureIntegerPos(currentPos);\r\n        this.animater.translate(currentPos);\r\n        this.endTime = getNow();\r\n        var duration = this.endTime - this.startTime;\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollEnd, currentPos, duration);\r\n    };\r\n    ScrollerActions.prototype.ensureIntegerPos = function (currentPos) {\r\n        this.ensuringInteger = true;\r\n        var x = currentPos.x, y = currentPos.y;\r\n        var _a = this.scrollBehaviorX, minScrollPosX = _a.minScrollPos, maxScrollPosX = _a.maxScrollPos;\r\n        var _b = this.scrollBehaviorY, minScrollPosY = _b.minScrollPos, maxScrollPosY = _b.maxScrollPos;\r\n        x = x > 0 ? Math.ceil(x) : Math.floor(x);\r\n        y = y > 0 ? Math.ceil(y) : Math.floor(y);\r\n        x = between(x, maxScrollPosX, minScrollPosX);\r\n        y = between(y, maxScrollPosY, minScrollPosY);\r\n        return { x: x, y: y };\r\n    };\r\n    ScrollerActions.prototype.handleClick = function (e) {\r\n        if (!preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n            maybePrevent(e);\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ScrollerActions.prototype.getCurrentPos = function () {\r\n        return {\r\n            x: this.scrollBehaviorX.getCurrentPos(),\r\n            y: this.scrollBehaviorY.getCurrentPos(),\r\n        };\r\n    };\r\n    ScrollerActions.prototype.refresh = function () {\r\n        this.endTime = 0;\r\n    };\r\n    ScrollerActions.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return ScrollerActions;\r\n}());\n\nfunction createActionsHandlerOptions(bsOptions) {\r\n    var options = [\r\n        'click',\r\n        'bindToWrapper',\r\n        'disableMouse',\r\n        'disableTouch',\r\n        'preventDefault',\r\n        'stopPropagation',\r\n        'tagException',\r\n        'preventDefaultException',\r\n        'autoEndDistance',\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    return options;\r\n}\r\nfunction createBehaviorOptions(bsOptions, extraProp, bounces, rect) {\r\n    var options = [\r\n        'momentum',\r\n        'momentumLimitTime',\r\n        'momentumLimitDistance',\r\n        'deceleration',\r\n        'swipeBounceTime',\r\n        'swipeTime',\r\n        'outOfBoundaryDampingFactor',\r\n        'specifiedIndexAsContent',\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    // add extra property\r\n    options.scrollable = !!bsOptions[extraProp];\r\n    options.bounces = bounces;\r\n    options.rect = rect;\r\n    return options;\r\n}\n\nfunction bubbling(source, target, events) {\r\n    events.forEach(function (event) {\r\n        var sourceEvent;\r\n        var targetEvent;\r\n        if (typeof event === 'string') {\r\n            sourceEvent = targetEvent = event;\r\n        }\r\n        else {\r\n            sourceEvent = event.source;\r\n            targetEvent = event.target;\r\n        }\r\n        source.on(sourceEvent, function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return target.trigger.apply(target, __spreadArrays([targetEvent], args));\r\n        });\r\n    });\r\n}\n\nfunction isSamePoint(startPoint, endPoint) {\r\n    // keys of startPoint and endPoint should be equal\r\n    var keys = Object.keys(startPoint);\r\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n        var key = keys_1[_i];\r\n        if (startPoint[key] !== endPoint[key])\r\n            return false;\r\n    }\r\n    return true;\r\n}\n\nvar MIN_SCROLL_DISTANCE = 1;\r\nvar Scroller = /** @class */ (function () {\r\n    function Scroller(wrapper, content, options) {\r\n        this.wrapper = wrapper;\r\n        this.content = content;\r\n        this.resizeTimeout = 0;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'beforeMove',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'scrollEnd',\r\n            'resize',\r\n            'touchEnd',\r\n            'end',\r\n            'flick',\r\n            'scrollCancel',\r\n            'momentum',\r\n            'scrollTo',\r\n            'minDistanceScroll',\r\n            'scrollToElement',\r\n            'beforeRefresh',\r\n        ]);\r\n        this.options = options;\r\n        var _a = this.options.bounce, left = _a.left, right = _a.right, top = _a.top, bottom = _a.bottom;\r\n        // direction X\r\n        this.scrollBehaviorX = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollX', [left, right], {\r\n            size: 'width',\r\n            position: 'left',\r\n        }));\r\n        // direction Y\r\n        this.scrollBehaviorY = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollY', [top, bottom], {\r\n            size: 'height',\r\n            position: 'top',\r\n        }));\r\n        this.translater = new Translater(this.content);\r\n        this.animater = createAnimater(this.content, this.translater, this.options);\r\n        this.actionsHandler = new ActionsHandler(this.options.bindToTarget ? this.content : wrapper, createActionsHandlerOptions(this.options));\r\n        this.actions = new ScrollerActions(this.scrollBehaviorX, this.scrollBehaviorY, this.actionsHandler, this.animater, this.options);\r\n        var resizeHandler = this.resize.bind(this);\r\n        this.resizeRegister = new EventRegister(window, [\r\n            {\r\n                name: 'orientationchange',\r\n                handler: resizeHandler,\r\n            },\r\n            {\r\n                name: 'resize',\r\n                handler: resizeHandler,\r\n            },\r\n        ]);\r\n        this.registerTransitionEnd();\r\n        this.init();\r\n    }\r\n    Scroller.prototype.init = function () {\r\n        var _this = this;\r\n        this.bindTranslater();\r\n        this.bindAnimater();\r\n        this.bindActions();\r\n        // enable pointer events when scrolling ends\r\n        this.hooks.on(this.hooks.eventTypes.scrollEnd, function () {\r\n            _this.togglePointerEvents(true);\r\n        });\r\n    };\r\n    Scroller.prototype.registerTransitionEnd = function () {\r\n        this.transitionEndRegister = new EventRegister(this.content, [\r\n            {\r\n                name: style.transitionEnd,\r\n                handler: this.transitionEnd.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindTranslater = function () {\r\n        var _this = this;\r\n        var hooks = this.translater.hooks;\r\n        hooks.on(hooks.eventTypes.beforeTranslate, function (transformStyle) {\r\n            if (_this.options.translateZ) {\r\n                transformStyle.push(_this.options.translateZ);\r\n            }\r\n        });\r\n        // disable pointer events when scrolling\r\n        hooks.on(hooks.eventTypes.translate, function (pos) {\r\n            var prevPos = _this.getCurrentPos();\r\n            _this.updatePositions(pos);\r\n            // scrollEnd will dispatch when scroll is force stopping in touchstart handler\r\n            // so in touchend handler, don't toggle pointer-events\r\n            if (_this.actions.ensuringInteger === true) {\r\n                _this.actions.ensuringInteger = false;\r\n                return;\r\n            }\r\n            // a valid translate\r\n            if (pos.x !== prevPos.x || pos.y !== prevPos.y) {\r\n                _this.togglePointerEvents(false);\r\n            }\r\n        });\r\n    };\r\n    Scroller.prototype.bindAnimater = function () {\r\n        var _this = this;\r\n        // reset position\r\n        this.animater.hooks.on(this.animater.hooks.eventTypes.end, function (pos) {\r\n            if (!_this.resetPosition(_this.options.bounceTime)) {\r\n                _this.animater.setPending(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n        });\r\n        bubbling(this.animater.hooks, this.hooks, [\r\n            {\r\n                source: this.animater.hooks.eventTypes.move,\r\n                target: this.hooks.eventTypes.scroll,\r\n            },\r\n            {\r\n                source: this.animater.hooks.eventTypes.forceStop,\r\n                target: this.hooks.eventTypes.scrollEnd,\r\n            },\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindActions = function () {\r\n        var _this = this;\r\n        var actions = this.actions;\r\n        bubbling(actions.hooks, this.hooks, [\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeScrollStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeMove,\r\n                target: this.hooks.eventTypes.beforeMove,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scrollStart,\r\n                target: this.hooks.eventTypes.scrollStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scroll,\r\n                target: this.hooks.eventTypes.scroll,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeEnd,\r\n                target: this.hooks.eventTypes.beforeEnd,\r\n            },\r\n        ]);\r\n        actions.hooks.on(actions.hooks.eventTypes.end, function (e, pos) {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.touchEnd, pos);\r\n            if (_this.hooks.trigger(_this.hooks.eventTypes.end, pos)) {\r\n                return true;\r\n            }\r\n            // check if it is a click operation\r\n            if (!actions.fingerMoved) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollCancel);\r\n                if (_this.checkClick(e)) {\r\n                    return true;\r\n                }\r\n            }\r\n            // reset if we are outside of the boundaries\r\n            if (_this.resetPosition(_this.options.bounceTime, ease.bounce)) {\r\n                _this.animater.setForceStopped(false);\r\n                return true;\r\n            }\r\n        });\r\n        actions.hooks.on(actions.hooks.eventTypes.scrollEnd, function (pos, duration) {\r\n            var deltaX = Math.abs(pos.x - _this.scrollBehaviorX.startPos);\r\n            var deltaY = Math.abs(pos.y - _this.scrollBehaviorY.startPos);\r\n            if (_this.checkFlick(duration, deltaX, deltaY)) {\r\n                _this.animater.setForceStopped(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.flick);\r\n                return;\r\n            }\r\n            if (_this.momentum(pos, duration)) {\r\n                _this.animater.setForceStopped(false);\r\n                return;\r\n            }\r\n            if (actions.contentMoved) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n            if (_this.animater.forceStopped) {\r\n                _this.animater.setForceStopped(false);\r\n            }\r\n        });\r\n    };\r\n    Scroller.prototype.checkFlick = function (duration, deltaX, deltaY) {\r\n        var flickMinMovingDistance = 1; // distinguish flick from click\r\n        if (this.hooks.events.flick.length > 1 &&\r\n            duration < this.options.flickLimitTime &&\r\n            deltaX < this.options.flickLimitDistance &&\r\n            deltaY < this.options.flickLimitDistance &&\r\n            (deltaY > flickMinMovingDistance || deltaX > flickMinMovingDistance)) {\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.momentum = function (pos, duration) {\r\n        var meta = {\r\n            time: 0,\r\n            easing: ease.swiper,\r\n            newX: pos.x,\r\n            newY: pos.y,\r\n        };\r\n        // start momentum animation if needed\r\n        var momentumX = this.scrollBehaviorX.end(duration);\r\n        var momentumY = this.scrollBehaviorY.end(duration);\r\n        meta.newX = isUndef(momentumX.destination)\r\n            ? meta.newX\r\n            : momentumX.destination;\r\n        meta.newY = isUndef(momentumY.destination)\r\n            ? meta.newY\r\n            : momentumY.destination;\r\n        meta.time = Math.max(momentumX.duration, momentumY.duration);\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, meta, this);\r\n        // when x or y changed, do momentum animation now!\r\n        if (meta.newX !== pos.x || meta.newY !== pos.y) {\r\n            // change easing function when scroller goes out of the boundaries\r\n            if (meta.newX > this.scrollBehaviorX.minScrollPos ||\r\n                meta.newX < this.scrollBehaviorX.maxScrollPos ||\r\n                meta.newY > this.scrollBehaviorY.minScrollPos ||\r\n                meta.newY < this.scrollBehaviorY.maxScrollPos) {\r\n                meta.easing = ease.swipeBounce;\r\n            }\r\n            this.scrollTo(meta.newX, meta.newY, meta.time, meta.easing);\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.checkClick = function (e) {\r\n        var cancelable = {\r\n            preventClick: this.animater.forceStopped,\r\n        };\r\n        // we scrolled less than momentumLimitDistance pixels\r\n        if (this.hooks.trigger(this.hooks.eventTypes.checkClick)) {\r\n            this.animater.setForceStopped(false);\r\n            return true;\r\n        }\r\n        if (!cancelable.preventClick) {\r\n            var _dblclick = this.options.dblclick;\r\n            var dblclickTrigged = false;\r\n            if (_dblclick && this.lastClickTime) {\r\n                var _a = _dblclick.delay, delay = _a === void 0 ? 300 : _a;\r\n                if (getNow() - this.lastClickTime < delay) {\r\n                    dblclickTrigged = true;\r\n                    dblclick(e);\r\n                }\r\n            }\r\n            if (this.options.tap) {\r\n                tap(e, this.options.tap);\r\n            }\r\n            if (this.options.click &&\r\n                !preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n                click(e);\r\n            }\r\n            this.lastClickTime = dblclickTrigged ? null : getNow();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Scroller.prototype.resize = function () {\r\n        var _this = this;\r\n        if (!this.actions.enabled) {\r\n            return;\r\n        }\r\n        // fix a scroll problem under Android condition\r\n        /* istanbul ignore if  */\r\n        if (isAndroid) {\r\n            this.wrapper.scrollTop = 0;\r\n        }\r\n        clearTimeout(this.resizeTimeout);\r\n        this.resizeTimeout = window.setTimeout(function () {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.resize);\r\n        }, this.options.resizePolling);\r\n    };\r\n    /* istanbul ignore next */\r\n    Scroller.prototype.transitionEnd = function (e) {\r\n        if (e.target !== this.content || !this.animater.pending) {\r\n            return;\r\n        }\r\n        var animater = this.animater;\r\n        animater.transitionTime();\r\n        if (!this.resetPosition(this.options.bounceTime, ease.bounce)) {\r\n            this.animater.setPending(false);\r\n            if (this.options.probeType !== 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scrollEnd, this.getCurrentPos());\r\n            }\r\n        }\r\n    };\r\n    Scroller.prototype.togglePointerEvents = function (enabled) {\r\n        if (enabled === void 0) { enabled = true; }\r\n        var el = this.content.children.length\r\n            ? this.content.children\r\n            : [this.content];\r\n        var pointerEvents = enabled ? 'auto' : 'none';\r\n        for (var i = 0; i < el.length; i++) {\r\n            var node = el[i];\r\n            // ignore BetterScroll instance's wrapper DOM\r\n            /* istanbul ignore if  */\r\n            if (node.isBScrollContainer) {\r\n                continue;\r\n            }\r\n            node.style.pointerEvents = pointerEvents;\r\n        }\r\n    };\r\n    Scroller.prototype.refresh = function (content) {\r\n        var contentChanged = this.setContent(content);\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeRefresh);\r\n        this.scrollBehaviorX.refresh(content);\r\n        this.scrollBehaviorY.refresh(content);\r\n        if (contentChanged) {\r\n            this.translater.setContent(content);\r\n            this.animater.setContent(content);\r\n            this.transitionEndRegister.destroy();\r\n            this.registerTransitionEnd();\r\n            if (this.options.bindToTarget) {\r\n                this.actionsHandler.setContent(content);\r\n            }\r\n        }\r\n        this.actions.refresh();\r\n        this.wrapperOffset = offset(this.wrapper);\r\n    };\r\n    Scroller.prototype.setContent = function (content) {\r\n        var contentChanged = content !== this.content;\r\n        if (contentChanged) {\r\n            this.content = content;\r\n        }\r\n        return contentChanged;\r\n    };\r\n    Scroller.prototype.scrollBy = function (deltaX, deltaY, time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        var _a = this.getCurrentPos(), x = _a.x, y = _a.y;\r\n        easing = !easing ? ease.bounce : easing;\r\n        deltaX += x;\r\n        deltaY += y;\r\n        this.scrollTo(deltaX, deltaY, time, easing);\r\n    };\r\n    Scroller.prototype.scrollTo = function (x, y, time, easing, extraTransform) {\r\n        if (time === void 0) { time = 0; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        if (extraTransform === void 0) { extraTransform = {\r\n            start: {},\r\n            end: {},\r\n        }; }\r\n        var easingFn = this.options.useTransition ? easing.style : easing.fn;\r\n        var currentPos = this.getCurrentPos();\r\n        var startPoint = __assign({ x: currentPos.x, y: currentPos.y }, extraTransform.start);\r\n        var endPoint = __assign({ x: x,\r\n            y: y }, extraTransform.end);\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollTo, endPoint);\r\n        // it is an useless move\r\n        if (isSamePoint(startPoint, endPoint))\r\n            return;\r\n        var deltaX = Math.abs(endPoint.x - startPoint.x);\r\n        var deltaY = Math.abs(endPoint.y - startPoint.y);\r\n        // considering of browser compatibility for decimal transform value\r\n        // force translating immediately\r\n        if (deltaX < MIN_SCROLL_DISTANCE && deltaY < MIN_SCROLL_DISTANCE) {\r\n            time = 0;\r\n            this.hooks.trigger(this.hooks.eventTypes.minDistanceScroll);\r\n        }\r\n        this.animater.move(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Scroller.prototype.scrollToElement = function (el, time, offsetX, offsetY, easing) {\r\n        var targetEle = getElement(el);\r\n        var pos = offset(targetEle);\r\n        var getOffset = function (offset, size, wrapperSize) {\r\n            if (typeof offset === 'number') {\r\n                return offset;\r\n            }\r\n            // if offsetX/Y are true we center the element to the screen\r\n            return offset ? Math.round(size / 2 - wrapperSize / 2) : 0;\r\n        };\r\n        offsetX = getOffset(offsetX, targetEle.offsetWidth, this.wrapper.offsetWidth);\r\n        offsetY = getOffset(offsetY, targetEle.offsetHeight, this.wrapper.offsetHeight);\r\n        var getPos = function (pos, wrapperPos, offset, scrollBehavior) {\r\n            pos -= wrapperPos;\r\n            pos = scrollBehavior.adjustPosition(pos - offset);\r\n            return pos;\r\n        };\r\n        pos.left = getPos(pos.left, this.wrapperOffset.left, offsetX, this.scrollBehaviorX);\r\n        pos.top = getPos(pos.top, this.wrapperOffset.top, offsetY, this.scrollBehaviorY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.scrollToElement, targetEle, pos)) {\r\n            return;\r\n        }\r\n        this.scrollTo(pos.left, pos.top, time, easing);\r\n    };\r\n    Scroller.prototype.resetPosition = function (time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        var _a = this.scrollBehaviorX.checkInBoundary(), x = _a.position, xInBoundary = _a.inBoundary;\r\n        var _b = this.scrollBehaviorY.checkInBoundary(), y = _b.position, yInBoundary = _b.inBoundary;\r\n        if (xInBoundary && yInBoundary) {\r\n            return false;\r\n        }\r\n        /* istanbul ignore if  */\r\n        if (isIOSBadVersion) {\r\n            // fix ios 13.4 bouncing\r\n            // see it in issues 982\r\n            this.reflow();\r\n        }\r\n        // out of boundary\r\n        this.scrollTo(x, y, time, easing);\r\n        return true;\r\n    };\r\n    /* istanbul ignore next */\r\n    Scroller.prototype.reflow = function () {\r\n        this._reflow = this.content.offsetHeight;\r\n    };\r\n    Scroller.prototype.updatePositions = function (pos) {\r\n        this.scrollBehaviorX.updatePosition(pos.x);\r\n        this.scrollBehaviorY.updatePosition(pos.y);\r\n    };\r\n    Scroller.prototype.getCurrentPos = function () {\r\n        return this.actions.getCurrentPos();\r\n    };\r\n    Scroller.prototype.enable = function () {\r\n        this.actions.enabled = true;\r\n    };\r\n    Scroller.prototype.disable = function () {\r\n        cancelAnimationFrame(this.animater.timer);\r\n        this.actions.enabled = false;\r\n    };\r\n    Scroller.prototype.destroy = function () {\r\n        var _this = this;\r\n        var keys = [\r\n            'resizeRegister',\r\n            'transitionEndRegister',\r\n            'actionsHandler',\r\n            'actions',\r\n            'hooks',\r\n            'animater',\r\n            'translater',\r\n            'scrollBehaviorX',\r\n            'scrollBehaviorY',\r\n        ];\r\n        keys.forEach(function (key) { return _this[key].destroy(); });\r\n    };\r\n    return Scroller;\r\n}());\n\nvar BScrollConstructor = /** @class */ (function (_super) {\r\n    __extends(BScrollConstructor, _super);\r\n    function BScrollConstructor(el, options) {\r\n        var _this = _super.call(this, [\r\n            'refresh',\r\n            'contentChanged',\r\n            'enable',\r\n            'disable',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'scrollEnd',\r\n            'scrollCancel',\r\n            'touchEnd',\r\n            'flick',\r\n            'destroy'\r\n        ]) || this;\r\n        var wrapper = getElement(el);\r\n        if (!wrapper) {\r\n            warn('Can not resolve the wrapper DOM.');\r\n            return _this;\r\n        }\r\n        _this.plugins = {};\r\n        _this.options = new OptionsConstructor().merge(options).process();\r\n        if (!_this.setContent(wrapper).valid) {\r\n            return _this;\r\n        }\r\n        _this.hooks = new EventEmitter([\r\n            'refresh',\r\n            'enable',\r\n            'disable',\r\n            'destroy',\r\n            'beforeInitialScrollTo',\r\n            'contentChanged'\r\n        ]);\r\n        _this.init(wrapper);\r\n        return _this;\r\n    }\r\n    BScrollConstructor.use = function (ctor) {\r\n        var name = ctor.pluginName;\r\n        var installed = BScrollConstructor.plugins.some(function (plugin) { return ctor === plugin.ctor; });\r\n        if (installed)\r\n            return BScrollConstructor;\r\n        if (isUndef(name)) {\r\n            warn(\"Plugin Class must specify plugin's name in static property by 'pluginName' field.\");\r\n            return BScrollConstructor;\r\n        }\r\n        BScrollConstructor.pluginsMap[name] = true;\r\n        BScrollConstructor.plugins.push({\r\n            name: name,\r\n            applyOrder: ctor.applyOrder,\r\n            ctor: ctor\r\n        });\r\n        return BScrollConstructor;\r\n    };\r\n    BScrollConstructor.prototype.setContent = function (wrapper) {\r\n        var contentChanged = false;\r\n        var valid = true;\r\n        var content = wrapper.children[this.options.specifiedIndexAsContent];\r\n        if (!content) {\r\n            warn('The wrapper need at least one child element to be content element to scroll.');\r\n            valid = false;\r\n        }\r\n        else {\r\n            contentChanged = this.content !== content;\r\n            if (contentChanged) {\r\n                this.content = content;\r\n            }\r\n        }\r\n        return {\r\n            valid: valid,\r\n            contentChanged: contentChanged\r\n        };\r\n    };\r\n    BScrollConstructor.prototype.init = function (wrapper) {\r\n        var _this = this;\r\n        this.wrapper = wrapper;\r\n        // mark wrapper to recognize bs instance by DOM attribute\r\n        wrapper.isBScrollContainer = true;\r\n        this.scroller = new Scroller(wrapper, this.content, this.options);\r\n        this.scroller.hooks.on(this.scroller.hooks.eventTypes.resize, function () {\r\n            _this.refresh();\r\n        });\r\n        this.eventBubbling();\r\n        this.handleAutoBlur();\r\n        this.enable();\r\n        this.proxy(propertiesConfig);\r\n        this.applyPlugins();\r\n        // maybe boundary has changed, should refresh\r\n        this.refreshWithoutReset(this.content);\r\n        var _a = this.options, startX = _a.startX, startY = _a.startY;\r\n        var position = {\r\n            x: startX,\r\n            y: startY\r\n        };\r\n        // maybe plugins want to control scroll position\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeInitialScrollTo, position)) {\r\n            return;\r\n        }\r\n        this.scroller.scrollTo(position.x, position.y);\r\n    };\r\n    BScrollConstructor.prototype.applyPlugins = function () {\r\n        var _this = this;\r\n        var options = this.options;\r\n        BScrollConstructor.plugins\r\n            .sort(function (a, b) {\r\n            var _a;\r\n            var applyOrderMap = (_a = {},\r\n                _a[\"pre\" /* Pre */] = -1,\r\n                _a[\"post\" /* Post */] = 1,\r\n                _a);\r\n            var aOrder = a.applyOrder ? applyOrderMap[a.applyOrder] : 0;\r\n            var bOrder = b.applyOrder ? applyOrderMap[b.applyOrder] : 0;\r\n            return aOrder - bOrder;\r\n        })\r\n            .forEach(function (item) {\r\n            var ctor = item.ctor;\r\n            if (options[item.name] && typeof ctor === 'function') {\r\n                _this.plugins[item.name] = new ctor(_this);\r\n            }\r\n        });\r\n    };\r\n    BScrollConstructor.prototype.handleAutoBlur = function () {\r\n        /* istanbul ignore if  */\r\n        if (this.options.autoBlur) {\r\n            this.on(this.eventTypes.beforeScrollStart, function () {\r\n                var activeElement = document.activeElement;\r\n                if (activeElement &&\r\n                    (activeElement.tagName === 'INPUT' ||\r\n                        activeElement.tagName === 'TEXTAREA')) {\r\n                    activeElement.blur();\r\n                }\r\n            });\r\n        }\r\n    };\r\n    BScrollConstructor.prototype.eventBubbling = function () {\r\n        bubbling(this.scroller.hooks, this, [\r\n            this.eventTypes.beforeScrollStart,\r\n            this.eventTypes.scrollStart,\r\n            this.eventTypes.scroll,\r\n            this.eventTypes.scrollEnd,\r\n            this.eventTypes.scrollCancel,\r\n            this.eventTypes.touchEnd,\r\n            this.eventTypes.flick\r\n        ]);\r\n    };\r\n    BScrollConstructor.prototype.refreshWithoutReset = function (content) {\r\n        this.scroller.refresh(content);\r\n        this.hooks.trigger(this.hooks.eventTypes.refresh, content);\r\n        this.trigger(this.eventTypes.refresh, content);\r\n    };\r\n    BScrollConstructor.prototype.proxy = function (propertiesConfig) {\r\n        var _this = this;\r\n        propertiesConfig.forEach(function (_a) {\r\n            var key = _a.key, sourceKey = _a.sourceKey;\r\n            propertiesProxy(_this, sourceKey, key);\r\n        });\r\n    };\r\n    BScrollConstructor.prototype.refresh = function () {\r\n        var _a = this.setContent(this.wrapper), contentChanged = _a.contentChanged, valid = _a.valid;\r\n        if (valid) {\r\n            var content = this.content;\r\n            this.refreshWithoutReset(content);\r\n            if (contentChanged) {\r\n                this.hooks.trigger(this.hooks.eventTypes.contentChanged, content);\r\n                this.trigger(this.eventTypes.contentChanged, content);\r\n            }\r\n            this.scroller.resetPosition();\r\n        }\r\n    };\r\n    BScrollConstructor.prototype.enable = function () {\r\n        this.scroller.enable();\r\n        this.hooks.trigger(this.hooks.eventTypes.enable);\r\n        this.trigger(this.eventTypes.enable);\r\n    };\r\n    BScrollConstructor.prototype.disable = function () {\r\n        this.scroller.disable();\r\n        this.hooks.trigger(this.hooks.eventTypes.disable);\r\n        this.trigger(this.eventTypes.disable);\r\n    };\r\n    BScrollConstructor.prototype.destroy = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.destroy);\r\n        this.trigger(this.eventTypes.destroy);\r\n        this.scroller.destroy();\r\n    };\r\n    BScrollConstructor.prototype.eventRegister = function (names) {\r\n        this.registerType(names);\r\n    };\r\n    BScrollConstructor.plugins = [];\r\n    BScrollConstructor.pluginsMap = {};\r\n    return BScrollConstructor;\r\n}(EventEmitter));\r\nfunction createBScroll(el, options) {\r\n    var bs = new BScrollConstructor(el, options);\r\n    return bs;\r\n}\r\ncreateBScroll.use = BScrollConstructor.use;\r\ncreateBScroll.plugins = BScrollConstructor.plugins;\r\ncreateBScroll.pluginsMap = BScrollConstructor.pluginsMap;\r\nvar BScroll = createBScroll;\n\nexport { Behavior, CustomOptions, createBScroll, BScroll as default };\n","/*!\n * better-scroll / mouse-wheel\n * (c) 2016-2023 ustbhuangyi\n * Released under the MIT License.\n */\nfunction warn(msg) {\r\n    console.error(\"[BScroll warn]: \" + msg);\r\n}\n\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\n!!(ua && /wechatdevtools/.test(ua));\r\nua && ua.indexOf('android') > 0;\r\n/* istanbul ignore next */\r\n((function () {\r\n    if (typeof ua === 'string') {\r\n        var regex = /os (\\d\\d?_\\d(_\\d)?)/;\r\n        var matches = regex.exec(ua);\r\n        if (!matches)\r\n            return false;\r\n        var parts = matches[1].split('_').map(function (item) {\r\n            return parseInt(item, 10);\r\n        });\r\n        // ios version >= 13.4 issue 982\r\n        return !!(parts[0] === 13 && parts[1] >= 4);\r\n    }\r\n    return false;\r\n}))();\r\n/* istanbul ignore next */\r\nvar supportsPassive = false;\r\n/* istanbul ignore next */\r\nif (inBrowser) {\r\n    var EventName = 'test-passive';\r\n    try {\r\n        var opts = {};\r\n        Object.defineProperty(opts, 'passive', {\r\n            get: function () {\r\n                supportsPassive = true;\r\n            },\r\n        }); // https://github.com/facebook/flow/issues/285\r\n        window.addEventListener(EventName, function () { }, opts);\r\n    }\r\n    catch (e) { }\r\n}\n\nvar extend = function (target, source) {\r\n    for (var key in source) {\r\n        target[key] = source[key];\r\n    }\r\n    return target;\r\n};\n\nvar elementStyle = (inBrowser &&\r\n    document.createElement('div').style);\r\nvar vendor = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return false;\r\n    }\r\n    var transformNames = [\r\n        {\r\n            key: 'standard',\r\n            value: 'transform',\r\n        },\r\n        {\r\n            key: 'webkit',\r\n            value: 'webkitTransform',\r\n        },\r\n        {\r\n            key: 'Moz',\r\n            value: 'MozTransform',\r\n        },\r\n        {\r\n            key: 'O',\r\n            value: 'OTransform',\r\n        },\r\n        {\r\n            key: 'ms',\r\n            value: 'msTransform',\r\n        },\r\n    ];\r\n    for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\r\n        var obj = transformNames_1[_i];\r\n        if (elementStyle[obj.value] !== undefined) {\r\n            return obj.key;\r\n        }\r\n    }\r\n    /* istanbul ignore next  */\r\n    return false;\r\n})();\r\n/* istanbul ignore next  */\r\nfunction prefixStyle(style) {\r\n    if (vendor === false) {\r\n        return style;\r\n    }\r\n    if (vendor === 'standard') {\r\n        if (style === 'transitionEnd') {\r\n            return 'transitionend';\r\n        }\r\n        return style;\r\n    }\r\n    return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nfunction addEvent(el, type, fn, capture) {\r\n    var useCapture = supportsPassive\r\n        ? {\r\n            passive: false,\r\n            capture: !!capture,\r\n        }\r\n        : !!capture;\r\n    el.addEventListener(type, fn, useCapture);\r\n}\r\nfunction removeEvent(el, type, fn, capture) {\r\n    el.removeEventListener(type, fn, {\r\n        capture: !!capture,\r\n    });\r\n}\r\nfunction maybePrevent(e) {\r\n    if (e.cancelable) {\r\n        e.preventDefault();\r\n    }\r\n}\r\nvendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\ninBrowser && prefixStyle('perspective') in elementStyle;\r\n({\r\n    transform: transform,\r\n    transition: transition,\r\n    transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n    transitionDuration: prefixStyle('transitionDuration'),\r\n    transitionDelay: prefixStyle('transitionDelay'),\r\n    transformOrigin: prefixStyle('transformOrigin'),\r\n    transitionEnd: prefixStyle('transitionEnd'),\r\n    transitionProperty: prefixStyle('transitionProperty'),\r\n});\r\nfunction preventDefaultExceptionFn(el, exceptions) {\r\n    for (var i in exceptions) {\r\n        if (exceptions[i].test(el[i])) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\n\nvar EventRegister = /** @class */ (function () {\r\n    function EventRegister(wrapper, events) {\r\n        this.wrapper = wrapper;\r\n        this.events = events;\r\n        this.addDOMEvents();\r\n    }\r\n    EventRegister.prototype.destroy = function () {\r\n        this.removeDOMEvents();\r\n        this.events = [];\r\n    };\r\n    EventRegister.prototype.addDOMEvents = function () {\r\n        this.handleDOMEvents(addEvent);\r\n    };\r\n    EventRegister.prototype.removeDOMEvents = function () {\r\n        this.handleDOMEvents(removeEvent);\r\n    };\r\n    EventRegister.prototype.handleDOMEvents = function (eventOperation) {\r\n        var _this = this;\r\n        var wrapper = this.wrapper;\r\n        this.events.forEach(function (event) {\r\n            eventOperation(wrapper, event.name, _this, !!event.capture);\r\n        });\r\n    };\r\n    EventRegister.prototype.handleEvent = function (e) {\r\n        var eventType = e.type;\r\n        this.events.some(function (event) {\r\n            if (event.name === eventType) {\r\n                event.handler(e);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    };\r\n    return EventRegister;\r\n}());\n\nvar MouseWheel = /** @class */ (function () {\r\n    function MouseWheel(scroll) {\r\n        this.scroll = scroll;\r\n        this.wheelEndTimer = 0;\r\n        this.wheelMoveTimer = 0;\r\n        this.wheelStart = false;\r\n        this.init();\r\n    }\r\n    MouseWheel.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n        this.registerEvent();\r\n    };\r\n    MouseWheel.prototype.handleBScroll = function () {\r\n        this.scroll.registerType([\r\n            'alterOptions',\r\n            'mousewheelStart',\r\n            'mousewheelMove',\r\n            'mousewheelEnd',\r\n        ]);\r\n    };\r\n    MouseWheel.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.mouseWheel === true\r\n            ? {}\r\n            : this.scroll.options.mouseWheel);\r\n        var defaultOptions = {\r\n            speed: 20,\r\n            invert: false,\r\n            easeTime: 300,\r\n            discreteTime: 400,\r\n            throttleTime: 0,\r\n            dampingFactor: 0.1,\r\n        };\r\n        this.mouseWheelOpt = extend(defaultOptions, userOptions);\r\n    };\r\n    MouseWheel.prototype.handleHooks = function () {\r\n        this.hooksFn = [];\r\n        this.registerHooks(this.scroll.hooks, 'destroy', this.destroy);\r\n    };\r\n    MouseWheel.prototype.registerEvent = function () {\r\n        this.eventRegister = new EventRegister(this.scroll.scroller.wrapper, [\r\n            {\r\n                name: 'wheel',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n            {\r\n                name: 'mousewheel',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n            {\r\n                name: 'DOMMouseScroll',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    MouseWheel.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    MouseWheel.prototype.wheelHandler = function (e) {\r\n        if (!this.scroll.enabled) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e);\r\n        // start\r\n        if (!this.wheelStart) {\r\n            this.wheelStartHandler(e);\r\n            this.wheelStart = true;\r\n        }\r\n        // move\r\n        var delta = this.getWheelDelta(e);\r\n        this.wheelMoveHandler(delta);\r\n        // end\r\n        this.wheelEndDetector(delta);\r\n    };\r\n    MouseWheel.prototype.wheelStartHandler = function (e) {\r\n        this.cleanCache();\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        scrollBehaviorX.setMovingDirection(0 /* Default */);\r\n        scrollBehaviorY.setMovingDirection(0 /* Default */);\r\n        scrollBehaviorX.setDirection(0 /* Default */);\r\n        scrollBehaviorY.setDirection(0 /* Default */);\r\n        this.scroll.trigger(this.scroll.eventTypes.alterOptions, this.mouseWheelOpt);\r\n        this.scroll.trigger(this.scroll.eventTypes.mousewheelStart);\r\n    };\r\n    MouseWheel.prototype.cleanCache = function () {\r\n        this.deltaCache = [];\r\n    };\r\n    MouseWheel.prototype.wheelMoveHandler = function (delta) {\r\n        var _this = this;\r\n        var _a = this.mouseWheelOpt, throttleTime = _a.throttleTime, dampingFactor = _a.dampingFactor;\r\n        if (throttleTime && this.wheelMoveTimer) {\r\n            this.deltaCache.push(delta);\r\n        }\r\n        else {\r\n            var cachedDelta = this.deltaCache.reduce(function (prev, current) {\r\n                return {\r\n                    x: prev.x + current.x,\r\n                    y: prev.y + current.y,\r\n                };\r\n            }, { x: 0, y: 0 });\r\n            this.cleanCache();\r\n            var _b = this.scroll.scroller, scrollBehaviorX = _b.scrollBehaviorX, scrollBehaviorY = _b.scrollBehaviorY;\r\n            scrollBehaviorX.setMovingDirection(-delta.directionX);\r\n            scrollBehaviorY.setMovingDirection(-delta.directionY);\r\n            scrollBehaviorX.setDirection(delta.x);\r\n            scrollBehaviorY.setDirection(delta.y);\r\n            // when out of boundary, perform a damping scroll\r\n            var newX = scrollBehaviorX.performDampingAlgorithm(Math.round(delta.x) + cachedDelta.x, dampingFactor);\r\n            var newY = scrollBehaviorY.performDampingAlgorithm(Math.round(delta.y) + cachedDelta.x, dampingFactor);\r\n            if (!this.scroll.trigger(this.scroll.eventTypes.mousewheelMove, {\r\n                x: newX,\r\n                y: newY,\r\n            })) {\r\n                var easeTime = this.getEaseTime();\r\n                if (newX !== this.scroll.x || newY !== this.scroll.y) {\r\n                    this.scroll.scrollTo(newX, newY, easeTime);\r\n                }\r\n            }\r\n            if (throttleTime) {\r\n                this.wheelMoveTimer = window.setTimeout(function () {\r\n                    _this.wheelMoveTimer = 0;\r\n                }, throttleTime);\r\n            }\r\n        }\r\n    };\r\n    MouseWheel.prototype.wheelEndDetector = function (delta) {\r\n        var _this = this;\r\n        window.clearTimeout(this.wheelEndTimer);\r\n        this.wheelEndTimer = window.setTimeout(function () {\r\n            _this.wheelStart = false;\r\n            window.clearTimeout(_this.wheelMoveTimer);\r\n            _this.wheelMoveTimer = 0;\r\n            _this.scroll.trigger(_this.scroll.eventTypes.mousewheelEnd, delta);\r\n        }, this.mouseWheelOpt.discreteTime);\r\n    };\r\n    MouseWheel.prototype.getWheelDelta = function (e) {\r\n        var _a = this.mouseWheelOpt, speed = _a.speed, invert = _a.invert;\r\n        var wheelDeltaX = 0;\r\n        var wheelDeltaY = 0;\r\n        var direction = invert ? -1 /* Negative */ : 1 /* Positive */;\r\n        switch (true) {\r\n            case 'deltaX' in e:\r\n                if (e.deltaMode === 1) {\r\n                    wheelDeltaX = -e.deltaX * speed;\r\n                    wheelDeltaY = -e.deltaY * speed;\r\n                }\r\n                else {\r\n                    wheelDeltaX = -e.deltaX;\r\n                    wheelDeltaY = -e.deltaY;\r\n                }\r\n                break;\r\n            case 'wheelDeltaX' in e:\r\n                wheelDeltaX = (e.wheelDeltaX / 120) * speed;\r\n                wheelDeltaY = (e.wheelDeltaY / 120) * speed;\r\n                break;\r\n            case 'wheelDelta' in e:\r\n                wheelDeltaX = wheelDeltaY = (e.wheelDelta / 120) * speed;\r\n                break;\r\n            case 'detail' in e:\r\n                wheelDeltaX = wheelDeltaY = (-e.detail / 3) * speed;\r\n                break;\r\n        }\r\n        wheelDeltaX *= direction;\r\n        wheelDeltaY *= direction;\r\n        if (!this.scroll.hasVerticalScroll) {\r\n            if (Math.abs(wheelDeltaY) > Math.abs(wheelDeltaX)) {\r\n                wheelDeltaX = wheelDeltaY;\r\n            }\r\n            wheelDeltaY = 0;\r\n        }\r\n        if (!this.scroll.hasHorizontalScroll) {\r\n            wheelDeltaX = 0;\r\n        }\r\n        var directionX = wheelDeltaX > 0\r\n            ? -1 /* Negative */\r\n            : wheelDeltaX < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        var directionY = wheelDeltaY > 0\r\n            ? -1 /* Negative */\r\n            : wheelDeltaY < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        return {\r\n            x: wheelDeltaX,\r\n            y: wheelDeltaY,\r\n            directionX: directionX,\r\n            directionY: directionY,\r\n        };\r\n    };\r\n    MouseWheel.prototype.beforeHandler = function (e) {\r\n        var _a = this.scroll.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        if (preventDefault &&\r\n            !preventDefaultExceptionFn(e.target, preventDefaultException)) {\r\n            maybePrevent(e);\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    MouseWheel.prototype.getEaseTime = function () {\r\n        var SAFE_EASETIME = 100;\r\n        var easeTime = this.mouseWheelOpt.easeTime;\r\n        // scrollEnd event will be triggered in every calling of scrollTo when easeTime is too small\r\n        // easeTime needs to be greater than 100\r\n        if (easeTime < SAFE_EASETIME) {\r\n            warn(\"easeTime should be greater than 100.\" +\r\n                \"If mouseWheel easeTime is too small,\" +\r\n                \"scrollEnd will be triggered many times.\");\r\n        }\r\n        return Math.max(easeTime, SAFE_EASETIME);\r\n    };\r\n    MouseWheel.prototype.destroy = function () {\r\n        this.eventRegister.destroy();\r\n        window.clearTimeout(this.wheelEndTimer);\r\n        window.clearTimeout(this.wheelMoveTimer);\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n    };\r\n    MouseWheel.pluginName = 'mouseWheel';\r\n    MouseWheel.applyOrder = \"pre\" /* Pre */;\r\n    return MouseWheel;\r\n}());\n\nexport { MouseWheel as default };\n","/*!\n * better-scroll / scroll-bar\n * (c) 2016-2023 ustbhuangyi\n * Released under the MIT License.\n */\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\nfunction warn(msg) {\r\n    console.error(\"[BScroll warn]: \" + msg);\r\n}\n\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\n!!(ua && /wechatdevtools/.test(ua));\r\nua && ua.indexOf('android') > 0;\r\n/* istanbul ignore next */\r\n((function () {\r\n    if (typeof ua === 'string') {\r\n        var regex = /os (\\d\\d?_\\d(_\\d)?)/;\r\n        var matches = regex.exec(ua);\r\n        if (!matches)\r\n            return false;\r\n        var parts = matches[1].split('_').map(function (item) {\r\n            return parseInt(item, 10);\r\n        });\r\n        // ios version >= 13.4 issue 982\r\n        return !!(parts[0] === 13 && parts[1] >= 4);\r\n    }\r\n    return false;\r\n}))();\r\n/* istanbul ignore next */\r\nvar supportsPassive = false;\r\n/* istanbul ignore next */\r\nif (inBrowser) {\r\n    var EventName = 'test-passive';\r\n    try {\r\n        var opts = {};\r\n        Object.defineProperty(opts, 'passive', {\r\n            get: function () {\r\n                supportsPassive = true;\r\n            },\r\n        }); // https://github.com/facebook/flow/issues/285\r\n        window.addEventListener(EventName, function () { }, opts);\r\n    }\r\n    catch (e) { }\r\n}\n\nfunction getNow() {\r\n    return window.performance &&\r\n        window.performance.now &&\r\n        window.performance.timing\r\n        ? window.performance.now() + window.performance.timing.navigationStart\r\n        : +new Date();\r\n}\r\nvar extend = function (target, source) {\r\n    for (var key in source) {\r\n        target[key] = source[key];\r\n    }\r\n    return target;\r\n};\r\nfunction between(x, min, max) {\r\n    if (x < min) {\r\n        return min;\r\n    }\r\n    if (x > max) {\r\n        return max;\r\n    }\r\n    return x;\r\n}\n\nvar elementStyle = (inBrowser &&\r\n    document.createElement('div').style);\r\nvar vendor = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return false;\r\n    }\r\n    var transformNames = [\r\n        {\r\n            key: 'standard',\r\n            value: 'transform',\r\n        },\r\n        {\r\n            key: 'webkit',\r\n            value: 'webkitTransform',\r\n        },\r\n        {\r\n            key: 'Moz',\r\n            value: 'MozTransform',\r\n        },\r\n        {\r\n            key: 'O',\r\n            value: 'OTransform',\r\n        },\r\n        {\r\n            key: 'ms',\r\n            value: 'msTransform',\r\n        },\r\n    ];\r\n    for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\r\n        var obj = transformNames_1[_i];\r\n        if (elementStyle[obj.value] !== undefined) {\r\n            return obj.key;\r\n        }\r\n    }\r\n    /* istanbul ignore next  */\r\n    return false;\r\n})();\r\n/* istanbul ignore next  */\r\nfunction prefixStyle(style) {\r\n    if (vendor === false) {\r\n        return style;\r\n    }\r\n    if (vendor === 'standard') {\r\n        if (style === 'transitionEnd') {\r\n            return 'transitionend';\r\n        }\r\n        return style;\r\n    }\r\n    return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nfunction addEvent(el, type, fn, capture) {\r\n    var useCapture = supportsPassive\r\n        ? {\r\n            passive: false,\r\n            capture: !!capture,\r\n        }\r\n        : !!capture;\r\n    el.addEventListener(type, fn, useCapture);\r\n}\r\nfunction removeEvent(el, type, fn, capture) {\r\n    el.removeEventListener(type, fn, {\r\n        capture: !!capture,\r\n    });\r\n}\r\nfunction maybePrevent(e) {\r\n    if (e.cancelable) {\r\n        e.preventDefault();\r\n    }\r\n}\r\nvendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\ninBrowser && prefixStyle('perspective') in elementStyle;\r\nvar style = {\r\n    transform: transform,\r\n    transition: transition,\r\n    transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n    transitionDuration: prefixStyle('transitionDuration'),\r\n    transitionDelay: prefixStyle('transitionDelay'),\r\n    transformOrigin: prefixStyle('transformOrigin'),\r\n    transitionEnd: prefixStyle('transitionEnd'),\r\n    transitionProperty: prefixStyle('transitionProperty'),\r\n};\n\nvar EventEmitter = /** @class */ (function () {\r\n    function EventEmitter(names) {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n        this.registerType(names);\r\n    }\r\n    EventEmitter.prototype.on = function (type, fn, context) {\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        if (!this.events[type]) {\r\n            this.events[type] = [];\r\n        }\r\n        this.events[type].push([fn, context]);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.once = function (type, fn, context) {\r\n        var _this = this;\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        var magic = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            _this.off(type, magic);\r\n            var ret = fn.apply(context, args);\r\n            if (ret === true) {\r\n                return ret;\r\n            }\r\n        };\r\n        magic.fn = fn;\r\n        this.on(type, magic);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.off = function (type, fn) {\r\n        if (!type && !fn) {\r\n            this.events = {};\r\n            return this;\r\n        }\r\n        if (type) {\r\n            this.hasType(type);\r\n            if (!fn) {\r\n                this.events[type] = [];\r\n                return this;\r\n            }\r\n            var events = this.events[type];\r\n            if (!events) {\r\n                return this;\r\n            }\r\n            var count = events.length;\r\n            while (count--) {\r\n                if (events[count][0] === fn ||\r\n                    (events[count][0] && events[count][0].fn === fn)) {\r\n                    events.splice(count, 1);\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    EventEmitter.prototype.trigger = function (type) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        this.hasType(type);\r\n        var events = this.events[type];\r\n        if (!events) {\r\n            return;\r\n        }\r\n        var len = events.length;\r\n        var eventsCopy = __spreadArrays(events);\r\n        var ret;\r\n        for (var i = 0; i < len; i++) {\r\n            var event_1 = eventsCopy[i];\r\n            var fn = event_1[0], context = event_1[1];\r\n            if (fn) {\r\n                ret = fn.apply(context, args);\r\n                if (ret === true) {\r\n                    return ret;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    EventEmitter.prototype.registerType = function (names) {\r\n        var _this = this;\r\n        names.forEach(function (type) {\r\n            _this.eventTypes[type] = type;\r\n        });\r\n    };\r\n    EventEmitter.prototype.destroy = function () {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n    };\r\n    EventEmitter.prototype.hasType = function (type) {\r\n        var types = this.eventTypes;\r\n        var isType = types[type] === type;\r\n        if (!isType) {\r\n            warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" +\r\n                (\"\" + Object.keys(types).map(function (_) { return JSON.stringify(_); })) +\r\n                \"]\");\r\n        }\r\n    };\r\n    return EventEmitter;\r\n}());\r\nvar EventRegister = /** @class */ (function () {\r\n    function EventRegister(wrapper, events) {\r\n        this.wrapper = wrapper;\r\n        this.events = events;\r\n        this.addDOMEvents();\r\n    }\r\n    EventRegister.prototype.destroy = function () {\r\n        this.removeDOMEvents();\r\n        this.events = [];\r\n    };\r\n    EventRegister.prototype.addDOMEvents = function () {\r\n        this.handleDOMEvents(addEvent);\r\n    };\r\n    EventRegister.prototype.removeDOMEvents = function () {\r\n        this.handleDOMEvents(removeEvent);\r\n    };\r\n    EventRegister.prototype.handleDOMEvents = function (eventOperation) {\r\n        var _this = this;\r\n        var wrapper = this.wrapper;\r\n        this.events.forEach(function (event) {\r\n            eventOperation(wrapper, event.name, _this, !!event.capture);\r\n        });\r\n    };\r\n    EventRegister.prototype.handleEvent = function (e) {\r\n        var eventType = e.type;\r\n        this.events.some(function (event) {\r\n            if (event.name === eventType) {\r\n                event.handler(e);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    };\r\n    return EventRegister;\r\n}());\n\nvar EventHandler = /** @class */ (function () {\r\n    function EventHandler(indicator, options) {\r\n        this.indicator = indicator;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter(['touchStart', 'touchMove', 'touchEnd']);\r\n        this.registerEvents();\r\n    }\r\n    EventHandler.prototype.registerEvents = function () {\r\n        var _a = this.options, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch;\r\n        var startEvents = [];\r\n        var moveEvents = [];\r\n        var endEvents = [];\r\n        if (!disableMouse) {\r\n            startEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (!disableTouch) {\r\n            startEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.startEventRegister = new EventRegister(this.indicator.indicatorEl, startEvents);\r\n        this.moveEventRegister = new EventRegister(window, moveEvents);\r\n        this.endEventRegister = new EventRegister(window, endEvents);\r\n    };\r\n    EventHandler.prototype.BScrollIsDisabled = function () {\r\n        return !this.indicator.scroll.enabled;\r\n    };\r\n    EventHandler.prototype.start = function (e) {\r\n        if (this.BScrollIsDisabled()) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        maybePrevent(e);\r\n        e.stopPropagation();\r\n        this.initiated = true;\r\n        this.lastPoint = point[this.indicator.keysMap.point];\r\n        this.hooks.trigger(this.hooks.eventTypes.touchStart);\r\n    };\r\n    EventHandler.prototype.move = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var pointPos = point[this.indicator.keysMap.point];\r\n        maybePrevent(e);\r\n        e.stopPropagation();\r\n        var delta = pointPos - this.lastPoint;\r\n        this.lastPoint = pointPos;\r\n        this.hooks.trigger(this.hooks.eventTypes.touchMove, delta);\r\n    };\r\n    EventHandler.prototype.end = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        this.initiated = false;\r\n        maybePrevent(e);\r\n        e.stopPropagation();\r\n        this.hooks.trigger(this.hooks.eventTypes.touchEnd);\r\n    };\r\n    EventHandler.prototype.destroy = function () {\r\n        this.startEventRegister.destroy();\r\n        this.moveEventRegister.destroy();\r\n        this.endEventRegister.destroy();\r\n    };\r\n    return EventHandler;\r\n}());\n\nvar Indicator = /** @class */ (function () {\r\n    function Indicator(scroll, options) {\r\n        this.scroll = scroll;\r\n        this.options = options;\r\n        this.hooksFn = [];\r\n        this.wrapper = options.wrapper;\r\n        this.direction = options.direction;\r\n        this.indicatorEl = this.wrapper.children[0];\r\n        this.keysMap = this.getKeysMap();\r\n        this.handleFade();\r\n        this.handleHooks();\r\n    }\r\n    Indicator.prototype.handleFade = function () {\r\n        if (this.options.fade) {\r\n            this.wrapper.style.opacity = '0';\r\n        }\r\n    };\r\n    Indicator.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var _a = this.options, fade = _a.fade, interactive = _a.interactive, scrollbarTrackClickable = _a.scrollbarTrackClickable;\r\n        var scroll = this.scroll;\r\n        var scrollHooks = scroll.hooks;\r\n        var translaterHooks = scroll.scroller.translater.hooks;\r\n        var animaterHooks = scroll.scroller.animater.hooks;\r\n        this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refresh);\r\n        this.registerHooks(translaterHooks, translaterHooks.eventTypes.translate, function (pos) {\r\n            var hasScrollKey = _this.keysMap.hasScroll;\r\n            if (_this.scroll[hasScrollKey]) {\r\n                _this.updatePosition(pos);\r\n            }\r\n        });\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.time, this.transitionTime);\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.timeFunction, this.transitionTimingFunction);\r\n        if (fade) {\r\n            this.registerHooks(scroll, scroll.eventTypes.scrollEnd, function () {\r\n                _this.fade();\r\n            });\r\n            this.registerHooks(scroll, scroll.eventTypes.scrollStart, function () {\r\n                _this.fade(true);\r\n            });\r\n            // for mousewheel event\r\n            if (scroll.eventTypes.mousewheelStart &&\r\n                scroll.eventTypes.mousewheelEnd) {\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelStart, function () {\r\n                    _this.fade(true);\r\n                });\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelMove, function () {\r\n                    _this.fade(true);\r\n                });\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelEnd, function () {\r\n                    _this.fade();\r\n                });\r\n            }\r\n        }\r\n        if (interactive) {\r\n            var _b = this.scroll.options, disableMouse = _b.disableMouse, disableTouch = _b.disableTouch;\r\n            this.eventHandler = new EventHandler(this, {\r\n                disableMouse: disableMouse,\r\n                disableTouch: disableTouch,\r\n            });\r\n            var eventHandlerHooks = this.eventHandler.hooks;\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchStart, this.startHandler);\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchMove, this.moveHandler);\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchEnd, this.endHandler);\r\n        }\r\n        if (scrollbarTrackClickable) {\r\n            this.bindClick();\r\n        }\r\n    };\r\n    Indicator.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Indicator.prototype.bindClick = function () {\r\n        var wrapper = this.wrapper;\r\n        this.clickEventRegister = new EventRegister(wrapper, [\r\n            {\r\n                name: 'click',\r\n                handler: this.handleClick.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    Indicator.prototype.handleClick = function (e) {\r\n        var newPos = this.calculateclickOffsetPos(e);\r\n        var _a = this.scroll, x = _a.x, y = _a.y;\r\n        x = this.direction === \"horizontal\" /* Horizontal */ ? newPos : x;\r\n        y = this.direction === \"vertical\" /* Vertical */ ? newPos : y;\r\n        this.scroll.scrollTo(x, y, this.options.scrollbarTrackOffsetTime);\r\n    };\r\n    Indicator.prototype.calculateclickOffsetPos = function (e) {\r\n        var _a = this.keysMap, poinKey = _a.point, domRectKey = _a.domRect;\r\n        var scrollbarTrackOffsetType = this.options.scrollbarTrackOffsetType;\r\n        var clickPointOffset = e[poinKey] - this.wrapperRect[domRectKey];\r\n        var scrollToWhere = clickPointOffset < this.currentPos ? -1 /* Up */ : 1 /* Down */;\r\n        var delta = 0;\r\n        var currentPos = this.currentPos;\r\n        if (scrollbarTrackOffsetType === \"step\" /* Step */) {\r\n            delta = this.scrollInfo.baseSize * scrollToWhere;\r\n        }\r\n        else {\r\n            delta = 0;\r\n            currentPos = clickPointOffset;\r\n        }\r\n        return this.newPos(currentPos, delta, this.scrollInfo);\r\n    };\r\n    Indicator.prototype.getKeysMap = function () {\r\n        if (this.direction === \"vertical\" /* Vertical */) {\r\n            return {\r\n                hasScroll: 'hasVerticalScroll',\r\n                size: 'height',\r\n                wrapperSize: 'clientHeight',\r\n                scrollerSize: 'scrollerHeight',\r\n                maxScrollPos: 'maxScrollY',\r\n                pos: 'y',\r\n                point: 'pageY',\r\n                translateProperty: 'translateY',\r\n                domRect: 'top',\r\n            };\r\n        }\r\n        return {\r\n            hasScroll: 'hasHorizontalScroll',\r\n            size: 'width',\r\n            wrapperSize: 'clientWidth',\r\n            scrollerSize: 'scrollerWidth',\r\n            maxScrollPos: 'maxScrollX',\r\n            pos: 'x',\r\n            point: 'pageX',\r\n            translateProperty: 'translateX',\r\n            domRect: 'left',\r\n        };\r\n    };\r\n    Indicator.prototype.fade = function (visible) {\r\n        var _a = this.options, fadeInTime = _a.fadeInTime, fadeOutTime = _a.fadeOutTime;\r\n        var time = visible ? fadeInTime : fadeOutTime;\r\n        var wrapper = this.wrapper;\r\n        wrapper.style[style.transitionDuration] = time + 'ms';\r\n        wrapper.style.opacity = visible ? '1' : '0';\r\n    };\r\n    Indicator.prototype.refresh = function () {\r\n        var hasScrollKey = this.keysMap.hasScroll;\r\n        var scroll = this.scroll;\r\n        var x = scroll.x, y = scroll.y;\r\n        this.wrapperRect = this.wrapper.getBoundingClientRect();\r\n        if (this.canScroll(scroll[hasScrollKey])) {\r\n            var _a = this.keysMap, wrapperSizeKey = _a.wrapperSize, scrollerSizeKey = _a.scrollerSize, maxScrollPosKey = _a.maxScrollPos;\r\n            this.scrollInfo = this.refreshScrollInfo(this.wrapper[wrapperSizeKey], scroll[scrollerSizeKey], scroll[maxScrollPosKey], this.indicatorEl[wrapperSizeKey]);\r\n            this.updatePosition({\r\n                x: x,\r\n                y: y,\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.indicatorEl.style[style.transitionDuration] = time + 'ms';\r\n    };\r\n    Indicator.prototype.transitionTimingFunction = function (easing) {\r\n        this.indicatorEl.style[style.transitionTimingFunction] = easing;\r\n    };\r\n    Indicator.prototype.canScroll = function (hasScroll) {\r\n        this.wrapper.style.display = hasScroll ? 'block' : 'none';\r\n        return hasScroll;\r\n    };\r\n    Indicator.prototype.refreshScrollInfo = function (wrapperSize, scrollerSize, maxScrollPos, indicatorElSize) {\r\n        var baseSize = Math.max(Math.round((wrapperSize * wrapperSize) / (scrollerSize || wrapperSize || 1)), this.options.minSize);\r\n        if (this.options.isCustom) {\r\n            baseSize = indicatorElSize;\r\n        }\r\n        var maxIndicatorScrollPos = wrapperSize - baseSize;\r\n        // sizeRatio is negative\r\n        var sizeRatio = maxIndicatorScrollPos / maxScrollPos;\r\n        return {\r\n            baseSize: baseSize,\r\n            maxScrollPos: maxIndicatorScrollPos,\r\n            minScrollPos: 0,\r\n            sizeRatio: sizeRatio,\r\n        };\r\n    };\r\n    Indicator.prototype.updatePosition = function (point) {\r\n        var _a = this.caculatePosAndSize(point, this.scrollInfo), pos = _a.pos, size = _a.size;\r\n        this.refreshStyle(size, pos);\r\n        this.currentPos = pos;\r\n    };\r\n    Indicator.prototype.caculatePosAndSize = function (point, scrollInfo) {\r\n        var posKey = this.keysMap.pos;\r\n        var sizeRatio = scrollInfo.sizeRatio, baseSize = scrollInfo.baseSize, maxScrollPos = scrollInfo.maxScrollPos, minScrollPos = scrollInfo.minScrollPos;\r\n        var minSize = this.options.minSize;\r\n        var pos = Math.round(sizeRatio * point[posKey]);\r\n        var size;\r\n        // when out of boundary, slow down size reduction\r\n        if (pos < minScrollPos) {\r\n            size = Math.max(baseSize + pos * 3, minSize);\r\n            pos = minScrollPos;\r\n        }\r\n        else if (pos > maxScrollPos) {\r\n            size = Math.max(baseSize - (pos - maxScrollPos) * 3, minSize);\r\n            pos = maxScrollPos + baseSize - size;\r\n        }\r\n        else {\r\n            size = baseSize;\r\n        }\r\n        return {\r\n            pos: pos,\r\n            size: size,\r\n        };\r\n    };\r\n    Indicator.prototype.refreshStyle = function (size, pos) {\r\n        var _a = this.keysMap, translatePropertyKey = _a.translateProperty, sizeKey = _a.size;\r\n        var translateZ = this.scroll.options.translateZ;\r\n        this.indicatorEl.style[sizeKey] = size + \"px\";\r\n        this.indicatorEl.style[style.transform] = translatePropertyKey + \"(\" + pos + \"px)\" + translateZ;\r\n    };\r\n    Indicator.prototype.startHandler = function () {\r\n        this.moved = false;\r\n        this.startTime = getNow();\r\n        this.transitionTime();\r\n        this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.beforeScrollStart);\r\n    };\r\n    Indicator.prototype.moveHandler = function (delta) {\r\n        if (!this.moved && !this.indicatorNotMoved(delta)) {\r\n            this.moved = true;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.moved) {\r\n            var newPos = this.newPos(this.currentPos, delta, this.scrollInfo);\r\n            this.syncBScroll(newPos);\r\n        }\r\n    };\r\n    Indicator.prototype.endHandler = function () {\r\n        if (this.moved) {\r\n            var _a = this.scroll, x = _a.x, y = _a.y;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollEnd, {\r\n                x: x,\r\n                y: y,\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.indicatorNotMoved = function (delta) {\r\n        var currentPos = this.currentPos;\r\n        var _a = this.scrollInfo, maxScrollPos = _a.maxScrollPos, minScrollPos = _a.minScrollPos;\r\n        var notMoved = (currentPos === minScrollPos && delta <= 0) ||\r\n            (currentPos === maxScrollPos && delta >= 0);\r\n        return notMoved;\r\n    };\r\n    Indicator.prototype.syncBScroll = function (newPos) {\r\n        var timestamp = getNow();\r\n        var _a = this.scroll, x = _a.x, y = _a.y, options = _a.options, scroller = _a.scroller, maxScrollY = _a.maxScrollY, minScrollY = _a.minScrollY, maxScrollX = _a.maxScrollX, minScrollX = _a.minScrollX;\r\n        var probeType = options.probeType, momentumLimitTime = options.momentumLimitTime;\r\n        var position = { x: x, y: y };\r\n        if (this.direction === \"vertical\" /* Vertical */) {\r\n            position.y = between(newPos, maxScrollY, minScrollY);\r\n        }\r\n        else {\r\n            position.x = between(newPos, maxScrollX, minScrollX);\r\n        }\r\n        scroller.translater.translate(position);\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > momentumLimitTime) {\r\n            this.startTime = timestamp;\r\n            if (probeType === 1 /* Throttle */) {\r\n                scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (probeType > 1 /* Throttle */) {\r\n            scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\r\n        }\r\n    };\r\n    Indicator.prototype.newPos = function (currentPos, delta, scrollInfo) {\r\n        var maxScrollPos = scrollInfo.maxScrollPos, sizeRatio = scrollInfo.sizeRatio, minScrollPos = scrollInfo.minScrollPos;\r\n        var newPos = currentPos + delta;\r\n        newPos = between(newPos, minScrollPos, maxScrollPos);\r\n        return Math.round(newPos / sizeRatio);\r\n    };\r\n    Indicator.prototype.destroy = function () {\r\n        var _a = this.options, interactive = _a.interactive, scrollbarTrackClickable = _a.scrollbarTrackClickable, isCustom = _a.isCustom;\r\n        if (interactive) {\r\n            this.eventHandler.destroy();\r\n        }\r\n        if (scrollbarTrackClickable) {\r\n            this.clickEventRegister.destroy();\r\n        }\r\n        if (!isCustom) {\r\n            this.wrapper.parentNode.removeChild(this.wrapper);\r\n        }\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    return Indicator;\r\n}());\n\nvar ScrollBar = /** @class */ (function () {\r\n    function ScrollBar(scroll) {\r\n        this.scroll = scroll;\r\n        this.handleOptions();\r\n        this.createIndicators();\r\n        this.handleHooks();\r\n    }\r\n    ScrollBar.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scroll = this.scroll;\r\n        scroll.hooks.on(scroll.hooks.eventTypes.destroy, function () {\r\n            for (var _i = 0, _a = _this.indicators; _i < _a.length; _i++) {\r\n                var indicator = _a[_i];\r\n                indicator.destroy();\r\n            }\r\n        });\r\n    };\r\n    ScrollBar.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.scrollbar === true\r\n            ? {}\r\n            : this.scroll.options.scrollbar);\r\n        var defaultOptions = {\r\n            fade: true,\r\n            fadeInTime: 250,\r\n            fadeOutTime: 500,\r\n            interactive: false,\r\n            customElements: [],\r\n            minSize: 8,\r\n            scrollbarTrackClickable: false,\r\n            scrollbarTrackOffsetType: \"step\" /* Step */,\r\n            scrollbarTrackOffsetTime: 300,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n    };\r\n    ScrollBar.prototype.createIndicators = function () {\r\n        var indicatorOptions;\r\n        var scroll = this.scroll;\r\n        var indicators = [];\r\n        var scrollDirectionConfigKeys = ['scrollX', 'scrollY'];\r\n        var indicatorDirections = [\r\n            \"horizontal\" /* Horizontal */,\r\n            \"vertical\" /* Vertical */,\r\n        ];\r\n        var customScrollbarEls = this.options.customElements;\r\n        for (var i = 0; i < scrollDirectionConfigKeys.length; i++) {\r\n            var key = scrollDirectionConfigKeys[i];\r\n            // wanna scroll in specified direction\r\n            if (scroll.options[key]) {\r\n                var customElement = customScrollbarEls.shift();\r\n                var direction = indicatorDirections[i];\r\n                var isCustom = false;\r\n                var scrollbarWrapper = customElement\r\n                    ? customElement\r\n                    : this.createScrollbarElement(direction);\r\n                // internal scrollbar\r\n                if (scrollbarWrapper !== customElement) {\r\n                    scroll.wrapper.appendChild(scrollbarWrapper);\r\n                }\r\n                else {\r\n                    // custom scrollbar passed by users\r\n                    isCustom = true;\r\n                }\r\n                indicatorOptions = __assign(__assign({ wrapper: scrollbarWrapper, direction: direction }, this.options), { isCustom: isCustom });\r\n                indicators.push(new Indicator(scroll, indicatorOptions));\r\n            }\r\n        }\r\n        this.indicators = indicators;\r\n    };\r\n    ScrollBar.prototype.createScrollbarElement = function (direction, scrollbarTrackClickable) {\r\n        if (scrollbarTrackClickable === void 0) { scrollbarTrackClickable = this.options.scrollbarTrackClickable; }\r\n        var scrollbarWrapperEl = document.createElement('div');\r\n        var scrollbarIndicatorEl = document.createElement('div');\r\n        scrollbarWrapperEl.style.cssText =\r\n            'position:absolute;z-index:9999;overflow:hidden;';\r\n        scrollbarIndicatorEl.style.cssText =\r\n            'box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px;';\r\n        scrollbarIndicatorEl.className = 'bscroll-indicator';\r\n        if (direction === \"horizontal\" /* Horizontal */) {\r\n            scrollbarWrapperEl.style.cssText +=\r\n                'height:7px;left:2px;right:2px;bottom:0;';\r\n            scrollbarIndicatorEl.style.height = '100%';\r\n            scrollbarWrapperEl.className = 'bscroll-horizontal-scrollbar';\r\n        }\r\n        else {\r\n            scrollbarWrapperEl.style.cssText +=\r\n                'width:7px;bottom:2px;top:2px;right:1px;';\r\n            scrollbarIndicatorEl.style.width = '100%';\r\n            scrollbarWrapperEl.className = 'bscroll-vertical-scrollbar';\r\n        }\r\n        if (!scrollbarTrackClickable) {\r\n            scrollbarWrapperEl.style.cssText += 'pointer-events:none;';\r\n        }\r\n        scrollbarWrapperEl.appendChild(scrollbarIndicatorEl);\r\n        return scrollbarWrapperEl;\r\n    };\r\n    ScrollBar.pluginName = 'scrollbar';\r\n    return ScrollBar;\r\n}());\n\nexport { ScrollBar as default };\n","/*!\r\n * better-scroll / nested-scroll\r\n * (c) 2016-2020 ustbhuangyi\r\n * Released under the MIT License.\r\n */\r\n\r\n// Slightly modified to for Noodl to fix a problem:\r\n// - click bug. Click could be disabled and never enabled again when scrolling\r\n// - click bug 2. Click option didn't support the scroller being moved around in the dom tree\r\n//                It assumed the nested scroll relationships always stay the same\r\n//                (so doesn't work with delta updates)\r\n\r\nvar compatibleFeatures = {\r\n  duplicateClick: function (_a) {\r\n    var parentScroll = _a[0],\r\n      childScroll = _a[1];\r\n    // no need to make childScroll's click true\r\n    if (parentScroll.options.click && childScroll.options.click) {\r\n      childScroll.options.click = false;\r\n    }\r\n  },\r\n  nestedScroll: function (scrollsPair) {\r\n    var parentScroll = scrollsPair[0],\r\n      childScroll = scrollsPair[1];\r\n    var parentScrollX = parentScroll.options.scrollX;\r\n    var parentScrollY = parentScroll.options.scrollY;\r\n    var childScrollX = childScroll.options.scrollX;\r\n    var childScrollY = childScroll.options.scrollY;\r\n    // vertical nested in vertical scroll and horizontal nested in horizontal\r\n    // otherwise, no need to handle.\r\n    if (parentScrollX === childScrollX || parentScrollY === childScrollY) {\r\n      scrollsPair.forEach(function (scroll, index) {\r\n        var oppositeScroll = scrollsPair[(index + 1) % 2];\r\n        scroll.on('scrollStart', function () {\r\n          if (oppositeScroll.pending) {\r\n            oppositeScroll.stop();\r\n            oppositeScroll.resetPosition();\r\n          }\r\n          setupData(oppositeScroll);\r\n          oppositeScroll.disable();\r\n        });\r\n        scroll.on('touchEnd', function () {\r\n          oppositeScroll.enable();\r\n        });\r\n      });\r\n      childScroll.on('scrollStart', function () {\r\n        if (checkBeyondBoundary(childScroll)) {\r\n          childScroll.disable();\r\n          parentScroll.enable();\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\nvar NestedScroll = /** @class */ (function () {\r\n  function NestedScroll(scroll) {\r\n    var singleton = NestedScroll.nestedScroll;\r\n    if (!(singleton instanceof NestedScroll)) {\r\n      singleton = NestedScroll.nestedScroll = this;\r\n      singleton.stores = [];\r\n    }\r\n    singleton.setup(scroll);\r\n    singleton.addHooks(scroll);\r\n    return singleton;\r\n  }\r\n  NestedScroll.prototype.setup = function (scroll) {\r\n    this.appendBScroll(scroll);\r\n    this.handleContainRelationship();\r\n    this.handleCompatible();\r\n  };\r\n  NestedScroll.prototype.addHooks = function (scroll) {\r\n    var _this = this;\r\n    scroll.on('destroy', function () {\r\n      _this.teardown(scroll);\r\n    });\r\n  };\r\n  NestedScroll.prototype.teardown = function (scroll) {\r\n    this.removeBScroll(scroll);\r\n    this.handleContainRelationship();\r\n    this.handleCompatible();\r\n  };\r\n  NestedScroll.prototype.appendBScroll = function (scroll) {\r\n    this.stores.push(scroll);\r\n  };\r\n  NestedScroll.prototype.removeBScroll = function (scroll) {\r\n    var index = this.stores.indexOf(scroll);\r\n    if (index === -1) return;\r\n    scroll.wrapper.isBScrollContainer = undefined;\r\n    this.stores.splice(index, 1);\r\n  };\r\n  NestedScroll.prototype.handleContainRelationship = function () {\r\n    // bs's length <= 1\r\n    var stores = this.stores;\r\n    if (stores.length <= 1) {\r\n      // there is only a childBScroll left.\r\n      if (stores[0] && stores[0].__parentInfo) {\r\n        stores[0].__parentInfo = undefined;\r\n      }\r\n      return;\r\n    }\r\n    var outerBS;\r\n    var outerBSWrapper;\r\n    var innerBS;\r\n    var innerBSWrapper;\r\n    // Need two layers of \"For loop\" to calculate parent-child relationship\r\n    for (var i = 0; i < stores.length; i++) {\r\n      outerBS = stores[i];\r\n      outerBSWrapper = outerBS.wrapper;\r\n      for (var j = 0; j < stores.length; j++) {\r\n        innerBS = stores[j];\r\n        innerBSWrapper = innerBS.wrapper;\r\n        // same bs\r\n        if (outerBS === innerBS) continue;\r\n        // now start calculating\r\n        if (!innerBSWrapper.contains(outerBSWrapper)) continue;\r\n        // now innerBS contains outerBS\r\n        // no parentInfo yet\r\n        if (!outerBS.__parentInfo) {\r\n          outerBS.__parentInfo = {\r\n            parent: innerBS,\r\n            depth: calculateDepths(outerBSWrapper, innerBSWrapper)\r\n          };\r\n        } else {\r\n          // has parentInfo already!\r\n          // just judge the \"true\" parent by depth\r\n          // we regard the latest node as parent, not the furthest\r\n          var currentDepths = calculateDepths(outerBSWrapper, innerBSWrapper);\r\n          var prevDepths = outerBS.__parentInfo.depth;\r\n          // refresh currentBS as parentScroll\r\n          if (prevDepths > currentDepths) {\r\n            outerBS.__parentInfo = {\r\n              parent: innerBS,\r\n              depth: currentDepths\r\n            };\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n  NestedScroll.prototype.handleCompatible = function () {\r\n    var pairs = this.availableBScrolls();\r\n    var keys = ['duplicateClick', 'nestedScroll'];\r\n    pairs.forEach(function (pair) {\r\n      keys.forEach(function (key) {\r\n        compatibleFeatures[key](pair);\r\n      });\r\n    });\r\n  };\r\n  NestedScroll.prototype.availableBScrolls = function () {\r\n    var ret = [];\r\n    ret = this.stores\r\n      .filter(function (bs) {\r\n        return !!bs.__parentInfo;\r\n      })\r\n      .map(function (bs) {\r\n        return [bs.__parentInfo.parent, bs];\r\n      });\r\n    return ret;\r\n  };\r\n  NestedScroll.pluginName = 'nestedScroll';\r\n  return NestedScroll;\r\n})();\r\nfunction calculateDepths(childNode, parentNode) {\r\n  var depth = 0;\r\n  var parent = childNode.parentNode;\r\n  while (parent && parent !== parentNode) {\r\n    depth++;\r\n    parent = parent.parentNode;\r\n  }\r\n  return depth;\r\n}\r\nfunction checkBeyondBoundary(scroll) {\r\n  var _a = hasScroll(scroll),\r\n    hasHorizontalScroll = _a.hasHorizontalScroll,\r\n    hasVerticalScroll = _a.hasVerticalScroll;\r\n  var _b = scroll.scroller,\r\n    scrollBehaviorX = _b.scrollBehaviorX,\r\n    scrollBehaviorY = _b.scrollBehaviorY;\r\n  var hasReachLeft = scroll.x >= scroll.minScrollX && scrollBehaviorX.movingDirection === -1;\r\n  var hasReachRight = scroll.x <= scroll.maxScrollX && scrollBehaviorX.movingDirection === 1;\r\n  var hasReachTop = scroll.y >= scroll.minScrollY && scrollBehaviorY.movingDirection === -1;\r\n  var hasReachBottom = scroll.y <= scroll.maxScrollY && scrollBehaviorY.movingDirection === 1;\r\n  if (hasVerticalScroll) {\r\n    return hasReachTop || hasReachBottom;\r\n  } else if (hasHorizontalScroll) {\r\n    return hasReachLeft || hasReachRight;\r\n  }\r\n  return false;\r\n}\r\nfunction setupData(scroll) {\r\n  var _a = hasScroll(scroll),\r\n    hasHorizontalScroll = _a.hasHorizontalScroll,\r\n    hasVerticalScroll = _a.hasVerticalScroll;\r\n  var _b = scroll.scroller,\r\n    actions = _b.actions,\r\n    scrollBehaviorX = _b.scrollBehaviorX,\r\n    scrollBehaviorY = _b.scrollBehaviorY;\r\n  actions.startTime = +new Date();\r\n  if (hasVerticalScroll) {\r\n    scrollBehaviorY.startPos = scrollBehaviorY.currentPos;\r\n  } else if (hasHorizontalScroll) {\r\n    scrollBehaviorX.startPos = scrollBehaviorX.currentPos;\r\n  }\r\n}\r\nfunction hasScroll(scroll) {\r\n  return {\r\n    hasHorizontalScroll: scroll.scroller.scrollBehaviorX.hasScroll,\r\n    hasVerticalScroll: scroll.scroller.scrollBehaviorY.hasScroll\r\n  };\r\n}\r\n\r\nexport default NestedScroll;\r\n","/*!\r\n * better-scroll / slide\r\n * (c) 2016-2020 ustbhuangyi\r\n * Released under the MIT License.\r\n */\r\n\r\n//adapted to Noodl's more dynamic delta update environment:\r\n// - A scroll refresh doesn't reset the current slide page position\r\n// - Horizontal slider doesn't break when there are no children\r\n\r\nfunction warn(msg) {\r\n  console.error('[BScroll warn]: ' + msg);\r\n}\r\n\r\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\nvar isWeChatDevTools = ua && /wechatdevtools/.test(ua);\r\nvar isAndroid = ua && ua.indexOf('android') > 0;\r\n\r\nfunction extend(target) {\r\n  var rest = [];\r\n  for (var _i = 1; _i < arguments.length; _i++) {\r\n    rest[_i - 1] = arguments[_i];\r\n  }\r\n  for (var i = 0; i < rest.length; i++) {\r\n    var source = rest[i];\r\n    for (var key in source) {\r\n      target[key] = source[key];\r\n    }\r\n  }\r\n  return target;\r\n}\r\nfunction fixInboundValue(x, min, max) {\r\n  if (x < min) {\r\n    return min;\r\n  }\r\n  if (x > max) {\r\n    return max;\r\n  }\r\n  return x;\r\n}\r\n\r\nvar elementStyle = inBrowser && document.createElement('div').style;\r\nvar vendor = (function () {\r\n  if (!inBrowser) {\r\n    return false;\r\n  }\r\n  var transformNames = {\r\n    webkit: 'webkitTransform',\r\n    Moz: 'MozTransform',\r\n    O: 'OTransform',\r\n    ms: 'msTransform',\r\n    standard: 'transform'\r\n  };\r\n  for (var key in transformNames) {\r\n    if (elementStyle[transformNames[key]] !== undefined) {\r\n      return key;\r\n    }\r\n  }\r\n  return false;\r\n})();\r\nfunction prefixStyle(style) {\r\n  if (vendor === false) {\r\n    return style;\r\n  }\r\n  if (vendor === 'standard') {\r\n    if (style === 'transitionEnd') {\r\n      return 'transitionend';\r\n    }\r\n    return style;\r\n  }\r\n  return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nvar cssVendor = vendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle;\r\nvar style = {\r\n  transform: transform,\r\n  transition: transition,\r\n  transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n  transitionDuration: prefixStyle('transitionDuration'),\r\n  transitionDelay: prefixStyle('transitionDelay'),\r\n  transformOrigin: prefixStyle('transformOrigin'),\r\n  transitionEnd: prefixStyle('transitionEnd')\r\n};\r\nfunction getRect(el) {\r\n  if (el instanceof window.SVGElement) {\r\n    var rect = el.getBoundingClientRect();\r\n    return {\r\n      top: rect.top,\r\n      left: rect.left,\r\n      width: rect.width,\r\n      height: rect.height\r\n    };\r\n  } else {\r\n    return {\r\n      top: el.offsetTop,\r\n      left: el.offsetLeft,\r\n      width: el.offsetWidth,\r\n      height: el.offsetHeight\r\n    };\r\n  }\r\n}\r\nfunction prepend(el, target) {\r\n  var firstChild = target.firstChild;\r\n  if (firstChild) {\r\n    before(el, firstChild);\r\n  } else {\r\n    target.appendChild(el);\r\n  }\r\n}\r\nfunction before(el, target) {\r\n  target.parentNode.insertBefore(el, target);\r\n}\r\nfunction removeChild(el, child) {\r\n  el.removeChild(child);\r\n}\r\n\r\nvar ease = {\r\n  // easeOutQuint\r\n  swipe: {\r\n    style: 'cubic-bezier(0.23, 1, 0.32, 1)',\r\n    fn: function (t) {\r\n      return 1 + --t * t * t * t * t;\r\n    }\r\n  },\r\n  // easeOutQuard\r\n  swipeBounce: {\r\n    style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n    fn: function (t) {\r\n      return t * (2 - t);\r\n    }\r\n  },\r\n  // easeOutQuart\r\n  bounce: {\r\n    style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\r\n    fn: function (t) {\r\n      return 1 - --t * t * t * t;\r\n    }\r\n  }\r\n};\r\n\r\nvar DEFAULT_INTERVAL = 100 / 60;\r\nvar windowCompat = inBrowser && window;\r\nfunction noop() {}\r\nvar requestAnimationFrame = (function () {\r\n  if (!inBrowser) {\r\n    /* istanbul ignore if */\r\n    return noop;\r\n  }\r\n  return (\r\n    windowCompat.requestAnimationFrame ||\r\n    windowCompat.webkitRequestAnimationFrame ||\r\n    windowCompat.mozRequestAnimationFrame ||\r\n    windowCompat.oRequestAnimationFrame ||\r\n    // if all else fails, use setTimeout\r\n    function (callback) {\r\n      return window.setTimeout(callback, (callback.interval || DEFAULT_INTERVAL) / 2); // make interval as precise as possible.\r\n    }\r\n  );\r\n})();\r\nvar cancelAnimationFrame = (function () {\r\n  if (!inBrowser) {\r\n    /* istanbul ignore if */\r\n    return noop;\r\n  }\r\n  return (\r\n    windowCompat.cancelAnimationFrame ||\r\n    windowCompat.webkitCancelAnimationFrame ||\r\n    windowCompat.mozCancelAnimationFrame ||\r\n    windowCompat.oCancelAnimationFrame ||\r\n    function (id) {\r\n      window.clearTimeout(id);\r\n    }\r\n  );\r\n})();\r\n\r\nvar PagesPos = /** @class */ (function () {\r\n  function PagesPos(scroll, slideOpt) {\r\n    this.scroll = scroll;\r\n    this.slideOpt = slideOpt;\r\n    this.slideEl = null;\r\n    this.init();\r\n  }\r\n  PagesPos.prototype.init = function () {\r\n    var scrollerIns = this.scroll.scroller;\r\n    var scrollBehaviorX = scrollerIns.scrollBehaviorX;\r\n    var scrollBehaviorY = scrollerIns.scrollBehaviorY;\r\n    var wrapper = getRect(scrollerIns.wrapper);\r\n    var scroller = getRect(scrollerIns.content);\r\n    this.wrapperWidth = wrapper.width;\r\n    this.wrapperHeight = wrapper.height;\r\n    this.scrollerHeight = scrollBehaviorY.hasScroll ? scroller.height : wrapper.height;\r\n    this.scrollerWidth = scrollBehaviorX.hasScroll ? scroller.width : wrapper.width;\r\n    var stepX = this.slideOpt.stepX || this.wrapperWidth;\r\n    var stepY = this.slideOpt.stepY || this.wrapperHeight;\r\n    var slideEls = scrollerIns.content;\r\n    var el = this.slideOpt.el;\r\n    if (typeof el === 'string') {\r\n      this.slideEl = slideEls.querySelectorAll(el);\r\n    }\r\n    this.pages = this.slideEl ? this.computePagePosInfoByEl(this.slideEl) : this.computePagePosInfo(stepX, stepY);\r\n    this.xLen = this.pages ? this.pages.length : 0;\r\n    this.yLen = this.pages && this.pages[0] ? this.pages[0].length : 0;\r\n  };\r\n  PagesPos.prototype.hasInfo = function () {\r\n    if (!this.pages || !this.pages.length) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  PagesPos.prototype.getPos = function (x, y) {\r\n    return this.pages[x] ? this.pages[x][y] : null;\r\n  };\r\n  PagesPos.prototype.getNearestPage = function (x, y) {\r\n    if (!this.hasInfo()) {\r\n      return;\r\n    }\r\n    var pageX = 0;\r\n    var pageY = 0;\r\n    var l = this.pages.length;\r\n    for (; pageX < l - 1; pageX++) {\r\n      if (x >= this.pages[pageX][0].cx) {\r\n        break;\r\n      }\r\n    }\r\n    l = this.pages[pageX].length;\r\n    for (; pageY < l - 1; pageY++) {\r\n      if (y >= this.pages[0][pageY].cy) {\r\n        break;\r\n      }\r\n    }\r\n    return {\r\n      pageX: pageX,\r\n      pageY: pageY\r\n    };\r\n  };\r\n  PagesPos.prototype.computePagePosInfo = function (stepX, stepY) {\r\n    var pages = [];\r\n    var x = 0;\r\n    var y;\r\n    var cx;\r\n    var cy;\r\n    var i = 0;\r\n    var l;\r\n    var maxScrollPosX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\r\n    var maxScrollPosY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\r\n    cx = Math.round(stepX / 2);\r\n    cy = Math.round(stepY / 2);\r\n    while (x > -this.scrollerWidth) {\r\n      pages[i] = [];\r\n      l = 0;\r\n      y = 0;\r\n      while (y > -this.scrollerHeight) {\r\n        pages[i][l] = {\r\n          x: Math.max(x, maxScrollPosX),\r\n          y: Math.max(y, maxScrollPosY),\r\n          width: stepX,\r\n          height: stepY,\r\n          cx: x - cx,\r\n          cy: y - cy\r\n        };\r\n        y -= stepY;\r\n        l++;\r\n      }\r\n      x -= stepX;\r\n      i++;\r\n    }\r\n    return pages;\r\n  };\r\n  PagesPos.prototype.computePagePosInfoByEl = function (el) {\r\n    var pages = [];\r\n    var x = 0;\r\n    var y = 0;\r\n    var cx;\r\n    var cy;\r\n    var i = 0;\r\n    var l = el.length;\r\n    var m = 0;\r\n    var n = -1;\r\n    var rect;\r\n    var maxScrollX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\r\n    var maxScrollY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\r\n    for (; i < l; i++) {\r\n      rect = getRect(el[i]);\r\n      if (i === 0 || rect.left <= getRect(el[i - 1]).left) {\r\n        m = 0;\r\n        n++;\r\n      }\r\n      if (!pages[m]) {\r\n        pages[m] = [];\r\n      }\r\n      x = Math.max(-rect.left, maxScrollX);\r\n      y = Math.max(-rect.top, maxScrollY);\r\n      cx = x - Math.round(rect.width / 2);\r\n      cy = y - Math.round(rect.height / 2);\r\n      pages[m][n] = {\r\n        x: x,\r\n        y: y,\r\n        width: rect.width,\r\n        height: rect.height,\r\n        cx: cx,\r\n        cy: cy\r\n      };\r\n      if (x > maxScrollX) {\r\n        m++;\r\n      }\r\n    }\r\n    return pages;\r\n  };\r\n  return PagesPos;\r\n})();\r\n\r\nvar PageInfo = /** @class */ (function () {\r\n  function PageInfo(scroll, slideOpt) {\r\n    this.scroll = scroll;\r\n    this.slideOpt = slideOpt;\r\n  }\r\n  PageInfo.prototype.init = function () {\r\n    this.currentPage = {\r\n      x: 0,\r\n      y: 0,\r\n      pageX: 0,\r\n      pageY: 0\r\n    };\r\n    this.pagesPos = new PagesPos(this.scroll, this.slideOpt);\r\n    this.checkSlideLoop();\r\n  };\r\n  PageInfo.prototype.changeCurrentPage = function (newPage) {\r\n    this.currentPage = newPage;\r\n  };\r\n  PageInfo.prototype.change2safePage = function (pageX, pageY) {\r\n    if (!this.pagesPos.hasInfo()) {\r\n      return;\r\n    }\r\n    if (pageX >= this.pagesPos.xLen) {\r\n      pageX = this.pagesPos.xLen - 1;\r\n    } else if (pageX < 0) {\r\n      pageX = 0;\r\n    }\r\n    if (pageY >= this.pagesPos.yLen) {\r\n      pageY = this.pagesPos.yLen - 1;\r\n    } else if (pageY < 0) {\r\n      pageY = 0;\r\n    }\r\n    var _a = this.pagesPos.getPos(pageX, pageY);\r\n    return {\r\n      pageX: pageX,\r\n      pageY: pageY,\r\n      x: _a ? _a.x : 0,\r\n      y: _a ? _a.y : 0\r\n    };\r\n  };\r\n  PageInfo.prototype.getInitPage = function () {\r\n    var initPageX = this.loopX ? 1 : 0;\r\n    var initPageY = this.loopY ? 1 : 0;\r\n    return {\r\n      pageX: initPageX,\r\n      pageY: initPageY\r\n    };\r\n  };\r\n  PageInfo.prototype.getRealPage = function (page) {\r\n    var fixedPage = function (page, realPageLen) {\r\n      var pageIndex = [];\r\n      for (var i = 0; i < realPageLen; i++) {\r\n        pageIndex.push(i);\r\n      }\r\n      pageIndex.unshift(realPageLen - 1);\r\n      pageIndex.push(0);\r\n      return pageIndex[page];\r\n    };\r\n    var currentPage = page ? extend({}, page) : extend({}, this.currentPage);\r\n    if (this.loopX) {\r\n      currentPage.pageX = fixedPage(currentPage.pageX, this.pagesPos.xLen - 2);\r\n    }\r\n    if (this.loopY) {\r\n      currentPage.pageY = fixedPage(currentPage.pageY, this.pagesPos.yLen - 2);\r\n    }\r\n    return {\r\n      pageX: currentPage.pageX,\r\n      pageY: currentPage.pageY\r\n    };\r\n  };\r\n  PageInfo.prototype.getPageSize = function () {\r\n    return this.pagesPos.getPos(this.currentPage.pageX, this.currentPage.pageY);\r\n  };\r\n  PageInfo.prototype.realPage2Page = function (x, y) {\r\n    if (!this.pagesPos.hasInfo()) {\r\n      return;\r\n    }\r\n    var lastX = this.pagesPos.xLen - 1;\r\n    var lastY = this.pagesPos.yLen - 1;\r\n    var firstX = 0;\r\n    var firstY = 0;\r\n    if (this.loopX) {\r\n      x += 1;\r\n      firstX = firstX + 1;\r\n      lastX = lastX - 1;\r\n    }\r\n    if (this.loopY) {\r\n      y += 1;\r\n      firstY = firstY + 1;\r\n      lastY = lastY - 1;\r\n    }\r\n    x = fixInboundValue(x, firstX, lastX);\r\n    y = fixInboundValue(y, firstY, lastY);\r\n    return {\r\n      realX: x,\r\n      realY: y\r\n    };\r\n  };\r\n  PageInfo.prototype.nextPage = function () {\r\n    return this.changedPageNum('positive' /* Positive */);\r\n  };\r\n  PageInfo.prototype.prevPage = function () {\r\n    return this.changedPageNum('negative' /* Negative */);\r\n  };\r\n  PageInfo.prototype.nearestPage = function (x, y, directionX, directionY) {\r\n    var pageInfo = this.pagesPos.getNearestPage(x, y);\r\n    if (!pageInfo) {\r\n      return {\r\n        x: 0,\r\n        y: 0,\r\n        pageX: 0,\r\n        pageY: 0\r\n      };\r\n    }\r\n    var pageX = pageInfo.pageX;\r\n    var pageY = pageInfo.pageY;\r\n    var newX;\r\n    var newY;\r\n    if (pageX === this.currentPage.pageX) {\r\n      pageX += directionX;\r\n      pageX = fixInboundValue(pageX, 0, this.pagesPos.xLen - 1);\r\n    }\r\n    if (pageY === this.currentPage.pageY) {\r\n      pageY += directionY;\r\n      pageY = fixInboundValue(pageInfo.pageY, 0, this.pagesPos.yLen - 1);\r\n    }\r\n    newX = this.pagesPos.getPos(pageX, 0).x;\r\n    newY = this.pagesPos.getPos(0, pageY).y;\r\n    return {\r\n      x: newX,\r\n      y: newY,\r\n      pageX: pageX,\r\n      pageY: pageY\r\n    };\r\n  };\r\n  PageInfo.prototype.getLoopStage = function () {\r\n    if (!this.needLoop) {\r\n      return 'middle' /* Middle */;\r\n    }\r\n    if (this.loopX) {\r\n      if (this.currentPage.pageX === 0) {\r\n        return 'head' /* Head */;\r\n      }\r\n      if (this.currentPage.pageX === this.pagesPos.xLen - 1) {\r\n        return 'tail' /* Tail */;\r\n      }\r\n    }\r\n    if (this.loopY) {\r\n      if (this.currentPage.pageY === 0) {\r\n        return 'head' /* Head */;\r\n      }\r\n      if (this.currentPage.pageY === this.pagesPos.yLen - 1) {\r\n        return 'tail' /* Tail */;\r\n      }\r\n    }\r\n    return 'middle' /* Middle */;\r\n  };\r\n  PageInfo.prototype.resetLoopPage = function () {\r\n    if (this.loopX) {\r\n      if (this.currentPage.pageX === 0) {\r\n        return {\r\n          pageX: this.pagesPos.xLen - 2,\r\n          pageY: this.currentPage.pageY\r\n        };\r\n      }\r\n      if (this.currentPage.pageX === this.pagesPos.xLen - 1) {\r\n        return {\r\n          pageX: 1,\r\n          pageY: this.currentPage.pageY\r\n        };\r\n      }\r\n    }\r\n    if (this.loopY) {\r\n      if (this.currentPage.pageY === 0) {\r\n        return {\r\n          pageX: this.currentPage.pageX,\r\n          pageY: this.pagesPos.yLen - 2\r\n        };\r\n      }\r\n      if (this.currentPage.pageY === this.pagesPos.yLen - 1) {\r\n        return {\r\n          pageX: this.currentPage.pageX,\r\n          pageY: 1\r\n        };\r\n      }\r\n    }\r\n  };\r\n  PageInfo.prototype.isSameWithCurrent = function (page) {\r\n    if (page.pageX !== this.currentPage.pageX || page.pageY !== this.currentPage.pageY) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  PageInfo.prototype.changedPageNum = function (direction) {\r\n    var x = this.currentPage.pageX;\r\n    var y = this.currentPage.pageY;\r\n    if (this.slideX) {\r\n      x = direction === 'negative' /* Negative */ ? x - 1 : x + 1;\r\n    }\r\n    if (this.slideY) {\r\n      y = direction === 'negative' /* Negative */ ? y - 1 : y + 1;\r\n    }\r\n    return {\r\n      pageX: x,\r\n      pageY: y\r\n    };\r\n  };\r\n  PageInfo.prototype.checkSlideLoop = function () {\r\n    this.needLoop = this.slideOpt.loop;\r\n    if (this.pagesPos.xLen > 1) {\r\n      this.slideX = true;\r\n    }\r\n    if (this.pagesPos.pages[0] && this.pagesPos.yLen > 1) {\r\n      this.slideY = true;\r\n    }\r\n    this.loopX = this.needLoop && this.slideX;\r\n    this.loopY = this.needLoop && this.slideY;\r\n    if (this.slideX && this.slideY) {\r\n      warn('slide does not support two direction at the same time.');\r\n    }\r\n  };\r\n  return PageInfo;\r\n})();\r\n\r\nvar sourcePrefix = 'plugins.slide';\r\nvar propertiesMap = [\r\n  {\r\n    key: 'next',\r\n    name: 'next'\r\n  },\r\n  {\r\n    key: 'prev',\r\n    name: 'prev'\r\n  },\r\n  {\r\n    key: 'goToPage',\r\n    name: 'goToPage'\r\n  },\r\n  {\r\n    key: 'getCurrentPage',\r\n    name: 'getCurrentPage'\r\n  }\r\n];\r\nvar propertiesConfig = propertiesMap.map(function (item) {\r\n  return {\r\n    key: item.key,\r\n    sourceKey: sourcePrefix + '.' + item.name\r\n  };\r\n});\r\n\r\nvar Slide = /** @class */ (function () {\r\n  function Slide(scroll) {\r\n    this.scroll = scroll;\r\n    this.resetLooping = false;\r\n    this.isTouching = false;\r\n    this.scroll.proxy(propertiesConfig);\r\n    this.scroll.registerType(['slideWillChange']);\r\n    this.slideOpt = this.scroll.options.slide;\r\n    this.page = new PageInfo(scroll, this.slideOpt);\r\n    this.hooksFn = [];\r\n    this.willChangeToPage = {\r\n      pageX: 0,\r\n      pageY: 0\r\n    };\r\n    this.init();\r\n  }\r\n  Slide.prototype.init = function () {\r\n    var _this = this;\r\n    var slide = this.slideOpt;\r\n    var slideEls = this.scroll.scroller.content;\r\n    var lazyInitByRefresh = false;\r\n    if (slide.loop) {\r\n      var children = slideEls.children;\r\n      if (children.length > 1) {\r\n        this.cloneSlideEleForLoop(slideEls);\r\n        lazyInitByRefresh = true;\r\n      } else {\r\n        // Loop does not make any sense if there is only one child.\r\n        slide.loop = false;\r\n      }\r\n    }\r\n    var shouldRefreshByWidth = this.setSlideWidth(slideEls);\r\n    var shouldRefreshByHeight = this.setSlideHeight(this.scroll.scroller.wrapper, slideEls);\r\n    var shouldRefresh = shouldRefreshByWidth || shouldRefreshByHeight;\r\n    var scrollHooks = this.scroll.hooks;\r\n    var scrollerHooks = this.scroll.scroller.hooks;\r\n    this.registorHooks(scrollHooks, 'refresh', this.initSlideState);\r\n    this.registorHooks(scrollHooks, 'destroy', this.destroy);\r\n    this.registorHooks(scrollerHooks, 'momentum', this.modifyScrollMetaHandler);\r\n    // scrollEnd handler should be called before customized handlers\r\n    this.registorHooks(this.scroll, 'scrollEnd', this.amendCurrentPage);\r\n    this.registorHooks(scrollerHooks, 'beforeStart', this.setTouchFlag);\r\n    this.registorHooks(scrollerHooks, 'scroll', this.scrollMoving);\r\n    this.registorHooks(scrollerHooks, 'resize', this.resize);\r\n    // for mousewheel event\r\n    if (this.scroll.eventTypes.mousewheelMove && this.scroll.eventTypes.mousewheelEnd) {\r\n      this.registorHooks(this.scroll, 'mousewheelMove', function () {\r\n        // prevent default action of mousewheelMove\r\n        return true;\r\n      });\r\n      this.registorHooks(this.scroll, 'mousewheelEnd', function (delta) {\r\n        if (delta.directionX === 1 /* Positive */ || delta.directionY === 1 /* Positive */) {\r\n          _this.next();\r\n        }\r\n        if (delta.directionX === -1 /* Negative */ || delta.directionY === -1 /* Negative */) {\r\n          _this.prev();\r\n        }\r\n      });\r\n    }\r\n    if (slide.listenFlick !== false) {\r\n      this.registorHooks(scrollerHooks, 'flick', this.flickHandler);\r\n    }\r\n    if (!lazyInitByRefresh && !shouldRefresh) {\r\n      this.initSlideState();\r\n    } else {\r\n      this.scroll.refresh();\r\n    }\r\n  };\r\n  Slide.prototype.resize = function () {\r\n    var _this = this;\r\n    var slideEls = this.scroll.scroller.content;\r\n    var slideWrapper = this.scroll.scroller.wrapper;\r\n    clearTimeout(this.resizeTimeout);\r\n    this.resizeTimeout = window.setTimeout(function () {\r\n      _this.clearSlideWidth(slideEls);\r\n      _this.clearSlideHeight(slideEls);\r\n      _this.setSlideWidth(slideEls);\r\n      _this.setSlideHeight(slideWrapper, slideEls);\r\n      _this.scroll.refresh();\r\n    }, this.scroll.options.resizePolling);\r\n    return true;\r\n  };\r\n  Slide.prototype.next = function (time, easing) {\r\n    var _a = this.page.nextPage(),\r\n      pageX = _a.pageX,\r\n      pageY = _a.pageY;\r\n    this.goTo(pageX, pageY, time, easing);\r\n  };\r\n  Slide.prototype.prev = function (time, easing) {\r\n    var _a = this.page.prevPage(),\r\n      pageX = _a.pageX,\r\n      pageY = _a.pageY;\r\n    this.goTo(pageX, pageY, time, easing);\r\n  };\r\n  Slide.prototype.goToPage = function (x, y, time, easing) {\r\n    var pageInfo = this.page.realPage2Page(x, y);\r\n    if (!pageInfo) {\r\n      return;\r\n    }\r\n    this.goTo(pageInfo.realX, pageInfo.realY, time, easing);\r\n  };\r\n  Slide.prototype.getCurrentPage = function () {\r\n    return this.page.getRealPage();\r\n  };\r\n  Slide.prototype.nearestPage = function (x, y) {\r\n    var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\r\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n    var triggerThreshold = true;\r\n    if (\r\n      Math.abs(x - scrollBehaviorX.absStartPos) <= this.thresholdX &&\r\n      Math.abs(y - scrollBehaviorY.absStartPos) <= this.thresholdY\r\n    ) {\r\n      triggerThreshold = false;\r\n    }\r\n    if (!triggerThreshold) {\r\n      return this.page.currentPage;\r\n    }\r\n    return this.page.nearestPage(\r\n      fixInboundValue(x, scrollBehaviorX.maxScrollPos, scrollBehaviorX.minScrollPos),\r\n      fixInboundValue(y, scrollBehaviorY.maxScrollPos, scrollBehaviorY.minScrollPos),\r\n      scrollBehaviorX.direction,\r\n      scrollBehaviorY.direction\r\n    );\r\n  };\r\n  Slide.prototype.destroy = function () {\r\n    var slideEls = this.scroll.scroller.content;\r\n    if (this.slideOpt.loop) {\r\n      var children = slideEls.children;\r\n      if (children.length > 2) {\r\n        removeChild(slideEls, children[children.length - 1]);\r\n        removeChild(slideEls, children[0]);\r\n      }\r\n    }\r\n    this.hooksFn.forEach(function (item) {\r\n      var hooks = item[0];\r\n      var hooksName = item[1];\r\n      var handlerFn = item[2];\r\n      if (hooks.eventTypes[hooksName]) {\r\n        hooks.off(hooksName, handlerFn);\r\n      }\r\n    });\r\n    this.hooksFn.length = 0;\r\n  };\r\n  Slide.prototype.initSlideState = function () {\r\n    const prevPage = this.page.currentPage;\r\n    this.page.init();\r\n    if (prevPage) {\r\n      this.page.currentPage = prevPage;\r\n    } else {\r\n      var initPage = this.page.getInitPage();\r\n      this.goTo(initPage.pageX, initPage.pageY, 0);\r\n    }\r\n\r\n    this.initThreshold();\r\n  };\r\n  Slide.prototype.initThreshold = function () {\r\n    var slideThreshold = this.slideOpt.threshold || 0.1;\r\n    if (slideThreshold % 1 === 0) {\r\n      this.thresholdX = slideThreshold;\r\n      this.thresholdY = slideThreshold;\r\n    } else {\r\n      var pageSize = this.page.getPageSize();\r\n      if (pageSize) {\r\n        this.thresholdX = Math.round(pageSize.width * slideThreshold);\r\n        this.thresholdY = Math.round(pageSize.height * slideThreshold);\r\n      }\r\n    }\r\n  };\r\n  Slide.prototype.cloneSlideEleForLoop = function (slideEls) {\r\n    var children = slideEls.children;\r\n    prepend(children[children.length - 1].cloneNode(true), slideEls);\r\n    slideEls.appendChild(children[1].cloneNode(true));\r\n  };\r\n  Slide.prototype.amendCurrentPage = function () {\r\n    this.isTouching = false;\r\n    if (!this.slideOpt.loop) {\r\n      return;\r\n    }\r\n    // triggered by resetLoop\r\n    if (this.resetLooping) {\r\n      this.resetLooping = false;\r\n      return;\r\n    }\r\n    // fix bug: scroll two page or even more page at once and fetch the boundary.\r\n    // In this case, momentum won't be trigger, so the pageIndex will be wrong and won't be trigger reset.\r\n    var isScrollToBoundary = false;\r\n    if (\r\n      this.page.loopX &&\r\n      (this.scroll.x === this.scroll.scroller.scrollBehaviorX.minScrollPos ||\r\n        this.scroll.x === this.scroll.scroller.scrollBehaviorX.maxScrollPos)\r\n    ) {\r\n      isScrollToBoundary = true;\r\n    }\r\n    if (\r\n      this.page.loopY &&\r\n      (this.scroll.y === this.scroll.scroller.scrollBehaviorY.minScrollPos ||\r\n        this.scroll.y === this.scroll.scroller.scrollBehaviorY.maxScrollPos)\r\n    ) {\r\n      isScrollToBoundary = true;\r\n    }\r\n    if (isScrollToBoundary) {\r\n      var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\r\n      var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n      var newPos = this.page.nearestPage(\r\n        fixInboundValue(this.scroll.x, scrollBehaviorX.maxScrollPos, scrollBehaviorX.minScrollPos),\r\n        fixInboundValue(this.scroll.y, scrollBehaviorY.maxScrollPos, scrollBehaviorY.minScrollPos),\r\n        0,\r\n        0\r\n      );\r\n      var newPage = {\r\n        x: newPos.x,\r\n        y: newPos.y,\r\n        pageX: newPos.pageX,\r\n        pageY: newPos.pageY\r\n      };\r\n      if (!this.page.isSameWithCurrent(newPage)) {\r\n        this.page.changeCurrentPage(newPage);\r\n      }\r\n    }\r\n    var changePage = this.page.resetLoopPage();\r\n    if (changePage) {\r\n      this.resetLooping = true;\r\n      this.goTo(changePage.pageX, changePage.pageY, 0);\r\n      return true; // stop trigger chain\r\n    }\r\n    // amend willChangeToPage, because willChangeToPage maybe wrong when sliding quickly\r\n    this.pageWillChangeTo(this.page.currentPage);\r\n  };\r\n  Slide.prototype.shouldSetWidthHeight = function (checkType) {\r\n    var checkMap = {\r\n      width: ['scrollX', 'disableSetWidth'],\r\n      height: ['scrollY', 'disableSetHeight']\r\n    };\r\n    var checkOption = checkMap[checkType];\r\n    if (!this.scroll.options[checkOption[0]]) {\r\n      return false;\r\n    }\r\n    if (this.slideOpt[checkOption[1]]) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  Slide.prototype.clearSlideWidth = function (slideEls) {\r\n    if (!this.shouldSetWidthHeight('width')) {\r\n      return;\r\n    }\r\n    var children = slideEls.children;\r\n    for (var i = 0; i < children.length; i++) {\r\n      var slideItemDom = children[i];\r\n      slideItemDom.removeAttribute('style');\r\n    }\r\n    slideEls.removeAttribute('style');\r\n  };\r\n  Slide.prototype.setSlideWidth = function (slideEls) {\r\n    if (!this.shouldSetWidthHeight('width')) {\r\n      return false;\r\n    }\r\n    var children = slideEls.children;\r\n    var slideItemWidth = children[0].clientWidth;\r\n    for (var i = 0; i < children.length; i++) {\r\n      var slideItemDom = children[i];\r\n      slideItemDom.style.width = slideItemWidth + 'px';\r\n    }\r\n    slideEls.style.width = slideItemWidth * children.length + 'px';\r\n    return true;\r\n  };\r\n  Slide.prototype.clearSlideHeight = function (slideEls) {\r\n    if (!this.shouldSetWidthHeight('height')) {\r\n      return;\r\n    }\r\n    var children = slideEls.children;\r\n    for (var i = 0; i < children.length; i++) {\r\n      var slideItemDom = children[i];\r\n      slideItemDom.removeAttribute('style');\r\n    }\r\n    slideEls.removeAttribute('style');\r\n  };\r\n  // height change will not effect minScrollY & maxScrollY\r\n  Slide.prototype.setSlideHeight = function (slideWrapper, slideEls) {\r\n    if (!this.shouldSetWidthHeight('height')) {\r\n      return false;\r\n    }\r\n    var wrapperHeight = slideWrapper.clientHeight;\r\n    var children = slideEls.children;\r\n    for (var i = 0; i < children.length; i++) {\r\n      var slideItemDom = children[i];\r\n      slideItemDom.style.height = wrapperHeight + 'px';\r\n    }\r\n    slideEls.style.height = wrapperHeight * children.length + 'px';\r\n    return true;\r\n  };\r\n  Slide.prototype.goTo = function (pageX, pageY, time, easing) {\r\n    if (pageY === void 0) {\r\n      pageY = 0;\r\n    }\r\n    var newPageInfo = this.page.change2safePage(pageX, pageY);\r\n    if (!newPageInfo) {\r\n      return;\r\n    }\r\n    var scrollEasing = easing || this.slideOpt.easing || ease.bounce;\r\n    var posX = newPageInfo.x;\r\n    var posY = newPageInfo.y;\r\n    var deltaX = posX - this.scroll.scroller.scrollBehaviorX.currentPos;\r\n    var deltaY = posY - this.scroll.scroller.scrollBehaviorY.currentPos;\r\n    if (!deltaX && !deltaY) {\r\n      return;\r\n    }\r\n    time = time === undefined ? this.getAnimateTime(deltaX, deltaY) : time;\r\n    this.page.changeCurrentPage({\r\n      x: posX,\r\n      y: posY,\r\n      pageX: newPageInfo.pageX,\r\n      pageY: newPageInfo.pageY\r\n    });\r\n    this.pageWillChangeTo(this.page.currentPage);\r\n    this.scroll.scroller.scrollTo(posX, posY, time, scrollEasing);\r\n  };\r\n  Slide.prototype.flickHandler = function () {\r\n    var scrollBehaviorX = this.scroll.scroller.scrollBehaviorX;\r\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n    var deltaX = scrollBehaviorX.currentPos - scrollBehaviorX.startPos;\r\n    var deltaY = scrollBehaviorY.currentPos - scrollBehaviorY.startPos;\r\n    var time = this.getAnimateTime(deltaX, deltaY);\r\n    this.goTo(\r\n      this.page.currentPage.pageX + scrollBehaviorX.direction,\r\n      this.page.currentPage.pageY + scrollBehaviorY.direction,\r\n      time\r\n    );\r\n  };\r\n  Slide.prototype.getAnimateTime = function (deltaX, deltaY) {\r\n    if (this.slideOpt.speed) {\r\n      return this.slideOpt.speed;\r\n    }\r\n    return Math.max(Math.max(Math.min(Math.abs(deltaX), 1000), Math.min(Math.abs(deltaY), 1000)), 300);\r\n  };\r\n  Slide.prototype.modifyScrollMetaHandler = function (scrollMeta) {\r\n    var newPos = this.nearestPage(scrollMeta.newX, scrollMeta.newY);\r\n    scrollMeta.time = this.getAnimateTime(scrollMeta.newX - newPos.x, scrollMeta.newY - newPos.y);\r\n    scrollMeta.newX = newPos.x;\r\n    scrollMeta.newY = newPos.y;\r\n    scrollMeta.easing = this.slideOpt.easing || ease.bounce;\r\n    this.page.changeCurrentPage({\r\n      x: scrollMeta.newX,\r\n      y: scrollMeta.newY,\r\n      pageX: newPos.pageX,\r\n      pageY: newPos.pageY\r\n    });\r\n    this.pageWillChangeTo(this.page.currentPage);\r\n  };\r\n  Slide.prototype.scrollMoving = function (point) {\r\n    if (this.isTouching) {\r\n      var newPos = this.nearestPage(point.x, point.y);\r\n      this.pageWillChangeTo(newPos);\r\n    }\r\n  };\r\n  Slide.prototype.pageWillChangeTo = function (newPage) {\r\n    var changeToPage = this.page.getRealPage(newPage);\r\n    if (changeToPage.pageX === this.willChangeToPage.pageX && changeToPage.pageY === this.willChangeToPage.pageY) {\r\n      return;\r\n    }\r\n    this.willChangeToPage = changeToPage;\r\n    this.scroll.trigger('slideWillChange', this.willChangeToPage);\r\n  };\r\n  Slide.prototype.setTouchFlag = function () {\r\n    this.isTouching = true;\r\n  };\r\n  Slide.prototype.registorHooks = function (hooks, name, handler) {\r\n    hooks.on(name, handler, this);\r\n    this.hooksFn.push([hooks, name, handler]);\r\n  };\r\n  Slide.pluginName = 'slide';\r\n  return Slide;\r\n})();\r\n\r\nexport default Slide;\r\n","import React, { JSX } from \"react\";\r\nimport BScroll from \"@better-scroll/core\";\r\nimport MouseWheel from \"@better-scroll/mouse-wheel\";\r\nimport ScrollBar from \"@better-scroll/scroll-bar\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport Layout from \"../../../layout\";\r\nimport PointerListeners from \"../../../pointerlisteners\";\r\nimport { Noodl } from \"../../../types\";\r\nimport NestedScroll from \"./scroll-plugins/nested-scroll-plugin\";\r\nimport patchedMomentum from \"./scroll-plugins/patched-momentum-scroll\";\r\nimport Slide from \"./scroll-plugins/slide-scroll-plugin\";\r\n\r\nBScroll.use(ScrollBar);\r\nBScroll.use(NestedScroll);\r\nBScroll.use(MouseWheel);\r\nBScroll.use(Slide);\r\n\r\nexport interface GroupProps extends Noodl.ReactProps {\r\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<unknown>;\r\n  children?: React.ReactNode;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  scrollSnapEnabled: boolean;\r\n  showScrollbar: boolean;\r\n  scrollEnabled: boolean;\r\n  nativeScroll: boolean;\r\n  scrollSnapToEveryItem: boolean;\r\n  flexWrap: \"nowrap\" | \"wrap\" | \"wrap-reverse\";\r\n  scrollBounceEnabled: boolean;\r\n  clip: boolean;\r\n\r\n  layout: \"none\" | \"row\" | \"column\";\r\n  dom;\r\n\r\n  onScrollPositionChanged?: (value: number) => void;\r\n  onScrollStart?: () => void;\r\n  onScrollEnd?: () => void;\r\n}\r\n\r\ntype ScrollRef = HTMLDivElement & { noodlNode?: Noodl.ReactProps[\"noodlNode\"] };\r\n\r\nexport class Group extends React.Component<GroupProps> {\r\n  scrollNeedsToInit: boolean;\r\n  scrollRef: React.RefObject<ScrollRef>;\r\n  iScroll?: BScroll;\r\n\r\n  constructor(props: GroupProps) {\r\n    super(props);\r\n    this.scrollNeedsToInit = false;\r\n    this.scrollRef = React.createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (this.props.scrollEnabled && this.props.nativeScroll !== true) {\r\n      this.setupIScroll();\r\n    }\r\n\r\n    // Plumbing for the focused signals\r\n    if (this.scrollRef.current) {\r\n      this.scrollRef.current.noodlNode = this.props.noodlNode;\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.iScroll) {\r\n      this.iScroll.destroy();\r\n      this.iScroll = undefined;\r\n    }\r\n\r\n    this.props.noodlNode.context.setNodeFocused(this.props.noodlNode, false);\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    if (this.scrollNeedsToInit) {\r\n      this.setupIScroll();\r\n      this.scrollNeedsToInit = false;\r\n    }\r\n\r\n    if (this.iScroll) {\r\n      setTimeout(() => {\r\n        this.iScroll && this.iScroll.refresh();\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n  scrollToIndex(index, duration) {\r\n    if (this.iScroll) {\r\n      const child = this.scrollRef.current?.children[0].children[\r\n        index\r\n      ] as HTMLElement;\r\n      if (child) {\r\n        this.iScroll.scrollToElement(child, duration, 0, 0);\r\n      }\r\n    } else {\r\n      const child = this.scrollRef.current?.children[index];\r\n      child &&\r\n        child.scrollIntoView({\r\n          behavior: \"smooth\",\r\n        });\r\n    }\r\n  }\r\n\r\n  scrollToElement(noodlChild, duration) {\r\n    if (!noodlChild) return;\r\n    // eslint-disable-next-line react/no-find-dom-node\r\n    const element = ReactDOM.findDOMNode(noodlChild.getRef()) as HTMLElement;\r\n    if (element && element.scrollIntoView) {\r\n      if (this.iScroll) {\r\n        this.iScroll.scrollToElement(element, duration, 0, 0);\r\n      } else {\r\n        element.scrollIntoView({\r\n          behavior: \"smooth\",\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  setupIScroll() {\r\n    const { scrollSnapEnabled } = this.props;\r\n    const scrollDirection = this.getScrollDirection();\r\n\r\n    const snapOptions = {\r\n      disableSetWidth: true,\r\n      disableSetHeight: true,\r\n      loop: false,\r\n    };\r\n\r\n    const domElement = this.scrollRef.current;\r\n    this.iScroll = new BScroll(domElement!, {\r\n      bounceTime: 500,\r\n      swipeBounceTime: 300,\r\n      scrollbar: this.props.showScrollbar ? {} : undefined,\r\n      momentum: scrollSnapEnabled ? !this.props.scrollSnapToEveryItem : true,\r\n      bounce:\r\n        this.props.scrollBounceEnabled &&\r\n        !(scrollSnapEnabled && snapOptions.loop),\r\n      scrollX: scrollDirection === \"x\" || scrollDirection === \"both\",\r\n      scrollY: scrollDirection === \"y\" || scrollDirection === \"both\",\r\n      slide: scrollSnapEnabled ? snapOptions : undefined,\r\n      probeType: this.props.onScrollPositionChanged ? 3 : 1,\r\n      click: true,\r\n      nestedScroll: true,\r\n      //disable CSS animation, they can cause a flicker on iOS,\r\n      //and cause problems with probing the scroll position during an animation\r\n      useTransition: false,\r\n    });\r\n\r\n    //the scroll behavior when doing a momentum scroll that reaches outside the bounds\r\n    //does a slow and unpleasant animation. Let's patch it to make it behave more like iScroll.\r\n    const scroller = this.iScroll.scroller;\r\n    scroller.scrollBehaviorX &&\r\n      // @ts-expect-error momentum does exist\r\n      (scroller.scrollBehaviorX.momentum = patchedMomentum.bind(\r\n        scroller.scrollBehaviorX\r\n      ));\r\n    scroller.scrollBehaviorY &&\r\n      // @ts-expect-error momentum does exist\r\n      (scroller.scrollBehaviorY.momentum = patchedMomentum.bind(\r\n        scroller.scrollBehaviorY\r\n      ));\r\n\r\n    //refresh the scroll view in case a child has changed height, e.g. an image loaded\r\n    //seem to be very performant, no observed problem so far\r\n    this.iScroll.on(\"beforeScrollStart\", () => {\r\n      this.iScroll!.refresh();\r\n    });\r\n\r\n    this.iScroll.on(\"scrollStart\", () => {\r\n      this.props.onScrollStart && this.props.onScrollStart();\r\n    });\r\n\r\n    this.iScroll.on(\"scrollEnd\", () => {\r\n      this.props.onScrollEnd && this.props.onScrollEnd();\r\n    });\r\n\r\n    if (this.props.onScrollPositionChanged) {\r\n      this.iScroll.on(\"scroll\", () => {\r\n        // @ts-expect-error\r\n        this.props.onScrollPositionChanged(\r\n          // @ts-expect-error\r\n          scrollDirection === \"x\" ? -this.iScroll.x : -this.iScroll.y\r\n        );\r\n      });\r\n    }\r\n  }\r\n\r\n  UNSAFE_componentWillReceiveProps(nextProps: GroupProps) {\r\n    const scrollHasUpdated =\r\n      this.props.scrollSnapEnabled !== nextProps.scrollSnapEnabled ||\r\n      this.props.onScrollPositionChanged !==\r\n        nextProps.onScrollPositionChanged ||\r\n      this.props.onScrollStart !== nextProps.onScrollStart ||\r\n      this.props.onScrollEnd !== nextProps.onScrollEnd ||\r\n      this.props.showScrollbar !== nextProps.showScrollbar ||\r\n      this.props.scrollEnabled !== nextProps.scrollEnabled ||\r\n      this.props.nativeScroll !== nextProps.nativeScroll ||\r\n      this.props.scrollSnapToEveryItem !== nextProps.scrollSnapToEveryItem ||\r\n      this.props.layout !== nextProps.layout ||\r\n      this.props.flexWrap !== nextProps.flexWrap ||\r\n      this.props.scrollBounceEnabled !== nextProps.scrollBounceEnabled;\r\n\r\n    if (scrollHasUpdated) {\r\n      if (this.iScroll) {\r\n        this.iScroll.destroy();\r\n        this.iScroll = undefined;\r\n      }\r\n\r\n      this.scrollNeedsToInit =\r\n        nextProps.scrollEnabled && !nextProps.nativeScroll;\r\n    }\r\n  }\r\n\r\n  renderIScroll() {\r\n    const { flexDirection, flexWrap } = this.props.style;\r\n\r\n    const childStyle: React.CSSProperties = {\r\n      display: \"inline-flex\",\r\n      flexShrink: 0,\r\n      flexDirection,\r\n      flexWrap,\r\n      touchAction: \"none\",\r\n      // pointerEvents: this.state.isScrolling ? 'none' : undefined\r\n    };\r\n\r\n    if (flexDirection === \"row\") {\r\n      if (flexWrap === \"wrap\") {\r\n        childStyle.width = \"100%\";\r\n      } else {\r\n        childStyle.height = \"100%\";\r\n      }\r\n    } else {\r\n      if (flexWrap === \"wrap\") {\r\n        childStyle.height = \"100%\";\r\n      } else {\r\n        childStyle.width = \"100%\";\r\n      }\r\n    }\r\n\r\n    return (\r\n      <div className=\"scroll-wrapper-internal\" style={childStyle}>\r\n        {this.props.children}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getScrollDirection(): \"x\" | \"y\" | \"both\" {\r\n    // TODO: This never returns both, why?\r\n\r\n    if (\r\n      this.props.flexWrap === \"wrap\" ||\r\n      this.props.flexWrap === \"wrap-reverse\"\r\n    ) {\r\n      return this.props.layout === \"row\" ? \"y\" : \"x\";\r\n    }\r\n\r\n    return this.props.layout === \"row\" ? \"x\" : \"y\";\r\n  }\r\n\r\n  render() {\r\n    const { as: Component = \"div\", ...props } = this.props;\r\n\r\n    const children =\r\n      props.scrollEnabled && !props.nativeScroll\r\n        ? this.renderIScroll()\r\n        : props.children;\r\n\r\n    const style = { ...props.style };\r\n    Layout.size(style, props);\r\n    Layout.align(style, props);\r\n\r\n    if (props.clip) {\r\n      style.overflowX = \"hidden\";\r\n      style.overflowY = \"hidden\";\r\n    }\r\n\r\n    if (props.scrollEnabled && props.nativeScroll) {\r\n      const scrollDirection = this.getScrollDirection();\r\n      if (scrollDirection === \"y\") {\r\n        style.overflowY = \"auto\";\r\n      } else if (scrollDirection === \"x\") {\r\n        style.overflowX = \"auto\";\r\n      } else if (scrollDirection === \"both\") {\r\n        style.overflowX = \"auto\";\r\n        style.overflowY = \"auto\";\r\n      }\r\n    }\r\n\r\n    if (style.opacity === 0) {\r\n      style.pointerEvents = \"none\";\r\n    }\r\n\r\n    return (\r\n      <Component\r\n        // @ts-ignore\r\n        className={props.className}\r\n        {...props.attrs}\r\n        {...props.dom}\r\n        {...PointerListeners(props)}\r\n        style={style}\r\n        ref={this.scrollRef}\r\n      >\r\n        {children}\r\n      </Component>\r\n    );\r\n  }\r\n}\r\n","import { Group } from '../../components/visual/Group';\r\nimport { flexDirectionValues } from '../../constants/flex';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport { createTooltip } from '../../tooltips';\r\n\r\nconst GroupNode = {\r\n  name: 'Group',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/group',\r\n  connectionPanel: {\r\n    groupPriority: ['General', 'Style', 'Events', 'Mounted', 'Hover Events', 'Pointer Events', 'Focus', 'Scroll']\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n    this._internal = {\r\n      scrollElementDuration: 500,\r\n      scrollIndexDuration: 500,\r\n      scrollIndex: 0\r\n    };\r\n    this.props.layout = 'column';\r\n  },\r\n  getReactComponent() {\r\n    return Group;\r\n  },\r\n  noodlNodeAsProp: true,\r\n  visualStates: [\r\n    { name: 'neutral', label: 'Neutral' },\r\n    { name: 'hover', label: 'Hover' }\r\n  ],\r\n  defaultCss: {\r\n    display: 'flex',\r\n    position: 'relative',\r\n    flexDirection: 'column'\r\n  },\r\n  inputs: {\r\n    flexDirection: {\r\n      //don't rename for backwards compat\r\n      index: 12,\r\n      displayName: 'Layout',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'None', value: 'none' },\r\n          { label: 'Vertical', value: 'column' },\r\n          { label: 'Horizontal', value: 'row' }\r\n        ]\r\n      },\r\n      default: 'column',\r\n      set(value) {\r\n        this.props.layout = value;\r\n\r\n        if (value !== 'none') {\r\n          this.setStyle({ flexDirection: value });\r\n        } else {\r\n          this.removeStyle(['flexDirection']);\r\n        }\r\n\r\n        if (this.context.editorConnection) {\r\n          // Send warning if the value is wrong\r\n          if (value !== 'none' && !flexDirectionValues.includes(value)) {\r\n            this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name, this.id, 'layout-warning', {\r\n              message: 'Invalid Layout value has to be a valid flex-direction value.'\r\n            });\r\n          } else {\r\n            this.context.editorConnection.clearWarning(this.nodeScope.componentOwner.name, this.id, 'layout-warning');\r\n          }\r\n        }\r\n\r\n        this.forceUpdate();\r\n      }\r\n    },\r\n    'scrollToIndex.do': {\r\n      displayName: 'Scroll To Index - Do',\r\n      group: 'Scroll To Index',\r\n      type: 'signal',\r\n      index: 505,\r\n      valueChangedToTrue() {\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          if (!this.innerReactComponentRef) return;\r\n          const childIndex = this._internal.scrollIndex;\r\n          const duration = this._internal.scrollIndexDuration;\r\n          this.innerReactComponentRef.scrollToIndex(childIndex, duration);\r\n        });\r\n      }\r\n    },\r\n    'scrollToElement.do': {\r\n      displayName: 'Scroll To Element - Do',\r\n      group: 'Scroll To Element',\r\n      type: 'signal',\r\n      index: 500,\r\n      valueChangedToTrue() {\r\n        if (!this.innerReactComponentRef) return;\r\n        this.scheduleAfterInputsHaveUpdated(() => {\r\n          const element = this._internal.scrollElement;\r\n          const duration = this._internal.scrollElementDuration;\r\n          this.innerReactComponentRef.scrollToElement(element, duration);\r\n        });\r\n      }\r\n    },\r\n    'scrollToElement.element': {\r\n      displayName: 'Scroll To Element - Element',\r\n      group: 'Scroll To Element',\r\n      type: 'reference',\r\n      index: 501,\r\n      set(value) {\r\n        this._internal.scrollElement = value;\r\n      }\r\n    },\r\n    'scrollToElement.duration': {\r\n      displayName: 'Scroll To Element - Duration',\r\n      group: 'Scroll To Element',\r\n      type: 'number',\r\n      default: 500,\r\n      index: 502,\r\n      set(value) {\r\n        this._internal.scrollElementDuration = value;\r\n      }\r\n    },\r\n    'scrollToIndex.index': {\r\n      displayName: 'Scroll To Index - Index',\r\n      group: 'Scroll To Index',\r\n      type: 'number',\r\n      default: 0,\r\n      index: 506,\r\n      set(value) {\r\n        this._internal.scrollIndex = value;\r\n      }\r\n    },\r\n    'scrollToIndex.duration': {\r\n      displayName: 'Scroll To Index - Duration',\r\n      group: 'Scroll To Index',\r\n      type: 'number',\r\n      default: 500,\r\n      index: 507,\r\n      set(value) {\r\n        this._internal.scrollIndexDuration = value;\r\n      }\r\n    },\r\n    focus: {\r\n      displayName: 'Focus',\r\n      type: 'signal',\r\n      group: 'Focus',\r\n      valueChangedToTrue() {\r\n        this.context.setNodeFocused(this, true);\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  },\r\n  inputProps: {\r\n    clip: {\r\n      index: 19,\r\n      displayName: 'Clip Content',\r\n      type: 'boolean',\r\n      group: 'Layout',\r\n      default: false\r\n    },\r\n    scrollEnabled: {\r\n      index: 54,\r\n      group: 'Scroll',\r\n      displayName: 'Enable Scroll',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    scrollSnapEnabled: {\r\n      index: 55,\r\n      displayName: 'Snap',\r\n      group: 'Scroll',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    scrollSnapToEveryItem: {\r\n      index: 56,\r\n      displayName: 'Snap To Every Item',\r\n      group: 'Scroll',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    showScrollbar: {\r\n      index: 57,\r\n      displayName: 'Show Scrollbar',\r\n      group: 'Scroll',\r\n      type: 'boolean',\r\n      default: false\r\n    },\r\n    scrollBounceEnabled: {\r\n      index: 58,\r\n      displayName: 'Bounce at boundaries',\r\n      group: 'Scroll',\r\n      type: 'boolean',\r\n      default: true\r\n    },\r\n    nativeScroll: {\r\n      index: 60,\r\n      group: 'Scroll',\r\n      displayName: 'Native platform scroll',\r\n      type: 'boolean',\r\n      default: true\r\n    },\r\n    as: {\r\n      index: 100000,\r\n      group: 'Advanced HTML',\r\n      displayName: 'Tag',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: '<div>', value: 'div' },\r\n          { label: '<section>', value: 'section' },\r\n          { label: '<article>', value: 'article' },\r\n          { label: '<aside>', value: 'aside' },\r\n          { label: '<nav>', value: 'nav' },\r\n          { label: '<header>', value: 'header' },\r\n          { label: '<footer>', value: 'footer' },\r\n          { label: '<main>', value: 'main' },\r\n          { label: '<span>', value: 'span' }\r\n        ]\r\n      },\r\n      default: 'div'\r\n    }\r\n  },\r\n  inputCss: {\r\n    alignItems: {\r\n      index: 13,\r\n      group: 'Align and justify content',\r\n      displayName: 'Align Items',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Start', value: 'flex-start' },\r\n          { label: 'End', value: 'flex-end' },\r\n          { label: 'Center', value: 'center' }\r\n        ],\r\n        alignComp: 'align-items'\r\n      },\r\n      default: 'flex-start'\r\n    },\r\n    justifyContent: {\r\n      index: 14,\r\n      group: 'Align and justify content',\r\n      displayName: 'Justify Content',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Start', value: 'flex-start' },\r\n          { label: 'End', value: 'flex-end' },\r\n          { label: 'Center', value: 'center' },\r\n          { label: 'Space Between', value: 'space-between' },\r\n          { label: 'Space Around', value: 'space-around' },\r\n          { label: 'Space Evenly', value: 'space-evenly' }\r\n        ],\r\n        alignComp: 'justify-content'\r\n      },\r\n      default: 'flex-start',\r\n      applyDefault: false\r\n    },\r\n    flexWrap: {\r\n      index: 15,\r\n      displayName: 'Multi Line Wrap',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Off', value: 'nowrap' },\r\n          { label: 'On', value: 'wrap' },\r\n          { label: 'On Reverse', value: 'wrap-reverse' }\r\n        ]\r\n      },\r\n      default: 'nowrap',\r\n      onChange(value) {\r\n        this.props.flexWrap = value;\r\n        this.forceUpdate(); //scroll direction needs to be recomputed\r\n      },\r\n      applyDefault: false\r\n    },\r\n    alignContent: {\r\n      index: 16,\r\n      group: 'Layout',\r\n      displayName: 'Align Content',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Start', value: 'flex-start' },\r\n          { label: 'End', value: 'flex-end' },\r\n          { label: 'Center', value: 'center' },\r\n          { label: 'Space Between', value: 'space-between' },\r\n          { label: 'Space Around', value: 'space-around' },\r\n          { label: 'Space Evenly', value: 'space-evenly' }\r\n        ],\r\n        alignComp: 'align-content'\r\n      }\r\n      // default: 'flex-start'\r\n    },\r\n    rowGap: {\r\n      index: 17,\r\n      displayName: 'Vertical Gap',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', '%', 'em'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 0,\r\n      applyDefault: false\r\n    },\r\n    columnGap: {\r\n      index: 18,\r\n      displayName: 'Horizontal Gap',\r\n      group: 'Layout',\r\n      type: {\r\n        name: 'number',\r\n        units: ['px', '%', 'em'],\r\n        defaultUnit: 'px'\r\n      },\r\n      default: 0,\r\n      applyDefault: false\r\n    },\r\n    backgroundColor: {\r\n      index: 201,\r\n      displayName: 'Background Color',\r\n      group: 'Style',\r\n      type: 'color',\r\n      default: 'transparent',\r\n      applyDefault: false,\r\n      allowVisualStates: true\r\n    }\r\n  },\r\n  outputProps: {\r\n    onScrollPositionChanged: {\r\n      displayName: 'Scroll Position',\r\n      type: 'number',\r\n      group: 'Scroll'\r\n    },\r\n    onScrollStart: {\r\n      displayName: 'Scroll Start',\r\n      type: 'signal',\r\n      group: 'Scroll'\r\n    },\r\n    onScrollEnd: {\r\n      displayName: 'Scroll End',\r\n      type: 'signal',\r\n      group: 'Scroll'\r\n    }\r\n  },\r\n  outputs: {\r\n    focused: {\r\n      displayName: 'Focused',\r\n      type: 'signal',\r\n      group: 'Focus'\r\n    },\r\n    focusLost: {\r\n      displayName: 'Focus Lost',\r\n      type: 'signal',\r\n      group: 'Focus'\r\n    }\r\n  },\r\n  dynamicports: [\r\n    {\r\n      condition: 'flexDirection != none',\r\n      inputs: ['scrollEnabled']\r\n    },\r\n    {\r\n      condition: 'flexDirection != none AND scrollEnabled = true',\r\n      inputs: ['nativeScroll']\r\n    },\r\n    {\r\n      condition: 'flexDirection != none AND scrollEnabled = true AND nativeScroll = false',\r\n      inputs: [\r\n        'scrollBounceEnabled',\r\n        'scrollSnapEnabled',\r\n        'showScrollbar',\r\n        'scrollToElement.do',\r\n        'scrollToElement.element',\r\n        'scrollToElement.duration',\r\n        'scrollToIndex.do',\r\n        'scrollToIndex.index',\r\n        'scrollToIndex.duration'\r\n      ]\r\n    },\r\n    {\r\n      condition: 'flexDirection != none AND scrollEnabled = true AND scrollSnapEnabled = true',\r\n      inputs: ['scrollSnapToEveryItem']\r\n    },\r\n    {\r\n      condition: 'flexDirection != none',\r\n      inputs: ['flexWrap']\r\n    },\r\n    {\r\n      condition: 'flexWrap = wrap OR flexWrap = wrap-reverse',\r\n      inputs: ['alignContent']\r\n    },\r\n    {\r\n      condition: 'flexDirection = row OR flexWrap = wrap OR flexWrap = wrap-reverse',\r\n      inputs: ['columnGap']\r\n    },\r\n    {\r\n      condition: 'flexDirection = column OR flexWrap = wrap OR flexWrap = wrap-reverse',\r\n      inputs: ['rowGap']\r\n    }\r\n  ],\r\n  methods: {\r\n    _focus() {\r\n      this.sendSignalOnOutput('focused');\r\n    },\r\n    _blur() {\r\n      this.sendSignalOnOutput('focusLost');\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(GroupNode);\r\nNodeSharedPortDefinitions.addTransformInputs(GroupNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(GroupNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(GroupNode);\r\nNodeSharedPortDefinitions.addMarginInputs(GroupNode);\r\nNodeSharedPortDefinitions.addAlignInputs(GroupNode);\r\nNodeSharedPortDefinitions.addPointerEventOutputs(GroupNode);\r\nNodeSharedPortDefinitions.addBorderInputs(GroupNode);\r\nNodeSharedPortDefinitions.addShadowInputs(GroupNode);\r\n\r\nfunction defineTooltips(node) {\r\n  node.inputProps.clip.tooltip = createTooltip({\r\n    title: 'Clip content',\r\n    body: 'Controls if elements that are too big to fit will be clipped',\r\n    images: [\r\n      { src: 'clip-enabled.svg', label: 'Enabled' },\r\n      { src: 'clip-disabled.svg', label: 'Disabled' }\r\n    ]\r\n  });\r\n\r\n  node.inputCss.flexWrap.tooltip = createTooltip({\r\n    title: 'Multiline wrap',\r\n    body: \"Elements will wrap to the next line when there's not enough space\",\r\n    images: [\r\n      { src: 'multiline-h.svg', body: 'Using a horizontal layout' },\r\n      { src: 'multiline-v.svg', body: 'Using a vertical layout' }\r\n    ]\r\n  });\r\n}\r\n\r\n// eslint-disable-next-line no-undef\r\nif (!Noodl.runDeployed) {\r\n  defineTooltips(GroupNode);\r\n}\r\n\r\nexport default createNodeFromReactComponent(GroupNode);\r\n","import React from \"react\";\r\n\r\nimport Layout from \"../../../layout\";\r\nimport { Noodl } from \"../../../types\";\r\n\r\nexport interface IconProps extends Noodl.ReactProps {\r\n  iconSourceType: \"image\" | \"icon\";\r\n  iconImageSource: Noodl.Image;\r\n  iconIconSource: Noodl.Icon;\r\n  iconSize: string;\r\n  iconColor: Noodl.Color;\r\n}\r\n\r\nexport function Icon(props: IconProps) {\r\n  const style: React.CSSProperties = { userSelect: \"none\", ...props.style };\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  function _renderIcon() {\r\n    const style: React.CSSProperties = {};\r\n    if (\r\n      props.iconSourceType === \"image\" &&\r\n      props.iconImageSource !== undefined\r\n    ) {\r\n      style.width = props.iconSize;\r\n      style.height = props.iconSize;\r\n      return <img alt=\"\" src={props.iconImageSource} style={style} />;\r\n    } else if (\r\n      props.iconSourceType === \"icon\" &&\r\n      props.iconIconSource !== undefined\r\n    ) {\r\n      style.fontSize = props.iconSize;\r\n      style.color = props.iconColor;\r\n      style.lineHeight = 1;\r\n      return (\r\n        <div style={{ lineHeight: 0 }}>\r\n          {props.iconIconSource.codeAsClass === true ? (\r\n            <span\r\n              className={[\r\n                props.iconIconSource.class,\r\n                props.iconIconSource.code,\r\n              ].join(\" \")}\r\n              style={style}\r\n            ></span>\r\n          ) : (\r\n            <span className={props.iconIconSource.class} style={style}>\r\n              {props.iconIconSource.code}\r\n            </span>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  let className = \"ndl-visual-icon\";\r\n  if (props.className) className = className + \" \" + props.className;\r\n\r\n  return (\r\n    <div className={className} style={style}>\r\n      {_renderIcon()}\r\n    </div>\r\n  );\r\n}\r\n","import { Icon } from '../../components/visual/Icon';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\n\r\nconst IconNode = {\r\n  name: 'net.noodl.visual.icon',\r\n  displayName: 'Icon',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/icon',\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      'General',\r\n      'Style',\r\n      'Actions',\r\n      'Events',\r\n      'States',\r\n      'Mounted',\r\n      'Hover Events',\r\n      'Pointer Events',\r\n      'Focus Events'\r\n    ]\r\n  },\r\n  getReactComponent() {\r\n    return Icon;\r\n  }\r\n};\r\nNodeSharedPortDefinitions.addAlignInputs(IconNode);\r\nNodeSharedPortDefinitions.addTransformInputs(IconNode);\r\nNodeSharedPortDefinitions.addPaddingInputs(IconNode, {\r\n  defaults: {\r\n    paddingTop: 5,\r\n    paddingRight: 5,\r\n    paddingBottom: 5,\r\n    paddingLeft: 5\r\n  }\r\n});\r\nNodeSharedPortDefinitions.addMarginInputs(IconNode);\r\nNodeSharedPortDefinitions.addIconInputs(IconNode, {\r\n  hideEnableIconInput: true,\r\n  defaults: { useIcon: true }\r\n});\r\nNodeSharedPortDefinitions.addSharedVisualInputs(IconNode);\r\n\r\nexport default createNodeFromReactComponent(IconNode);\r\n","import React from \"react\";\r\n\r\nimport Layout from \"../../../layout\";\r\nimport PointerListeners from \"../../../pointerlisteners\";\r\nimport { Noodl } from \"../../../types\";\r\n\r\nexport interface ImageProps extends Noodl.ReactProps {\r\n  dom: {\r\n    alt?: string;\r\n    src: string;\r\n    onLoad?: () => void;\r\n  };\r\n  attrs: React.Attributes;\r\n}\r\n\r\nexport function Image(props: ImageProps) {\r\n  const style = { ...props.style };\r\n\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  if (style.opacity === 0) {\r\n    style.pointerEvents = \"none\";\r\n  }\r\n\r\n  if (props.dom?.src?.startsWith(\"/\")) {\r\n    // @ts-expect-error missing Noodl typings\r\n    const baseUrl = Noodl.Env[\"BaseUrl\"];\r\n    if (baseUrl) {\r\n      props.dom.src = baseUrl + props.dom.src.substring(1);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <img\r\n      {...props.attrs}\r\n      className={props.className}\r\n      {...props.dom}\r\n      {...PointerListeners(props)}\r\n      style={style}\r\n    />\r\n  );\r\n}\r\n","import { getAbsoluteUrl } from \"@fluxscape/runtime\";\r\n\r\nimport { Image } from \"../../components/visual/Image\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\n\r\nconst ImageNode = {\r\n  name: \"Image\",\r\n  docs: \"https://docs.noodl.net/nodes/basic-elements/image\",\r\n  noodlNodeAsProp: true,\r\n  visualStates: [\r\n    { name: \"neutral\", label: \"Neutral\" },\r\n    { name: \"hover\", label: \"Hover\" },\r\n  ],\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      \"General\",\r\n      \"Image\",\r\n      \"Style\",\r\n      \"Actions\",\r\n      \"Events\",\r\n      \"Mounted\",\r\n      \"Pointer Events\",\r\n      \"Hover Events\",\r\n      \"Dimensions\",\r\n      \"Margin and padding\",\r\n    ],\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n    this.props.default = \"\";\r\n  },\r\n  getReactComponent() {\r\n    return Image;\r\n  },\r\n  getInspectInfo() {\r\n    if (this.props.dom.srcSet) {\r\n      return this.props.dom.srcSet;\r\n    } else if (this.props.dom.src) {\r\n      const src = this.props.dom.src.toString();\r\n      return [\r\n        { type: \"text\", value: src },\r\n        { type: \"image\", value: src },\r\n      ];\r\n    }\r\n  },\r\n  allowChildren: false,\r\n  defaultCss: {\r\n    display: \"block\",\r\n    flexShrink: 0,\r\n  },\r\n  inputCss: {\r\n    objectFit: {\r\n      displayName: \"Image Fit\",\r\n      group: \"Dimensions\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          { label: \"Fill\", value: \"fill\" },\r\n          { label: \"Contain\", value: \"contain\" },\r\n          { label: \"Cover\", value: \"cover\" },\r\n          { label: \"None\", value: \"none\" },\r\n          { label: \"Scale Down\", value: \"scale-down\" },\r\n        ],\r\n      },\r\n      default: \"contain\",\r\n      allowVisualStates: true,\r\n    },\r\n  },\r\n  dynamicports: [\r\n    {\r\n      condition: \"sizeMode = explicit\",\r\n      inputs: [\"objectFit\"],\r\n    },\r\n  ],\r\n  inputs: {\r\n    src: {\r\n      displayName: \"Source\",\r\n      group: \"Image\",\r\n      propPath: \"dom\",\r\n      type: {\r\n        name: \"image\",\r\n      },\r\n      index: 30,\r\n      allowVisualStates: true,\r\n      set(url) {\r\n        this.props.dom.src = getAbsoluteUrl(url);\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: \"Test ID Attribute\",\r\n      group: \"Advanced HTML\",\r\n      type: \"string\",\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n  },\r\n  inputProps: {\r\n    srcSet: {\r\n      displayName: \"Source Set\",\r\n      group: \"Image\",\r\n      propPath: \"dom\",\r\n      type: {\r\n        name: \"string\",\r\n      },\r\n      index: 31,\r\n      allowVisualStates: true,\r\n    },\r\n    alt: {\r\n      displayName: \"Alternate text\",\r\n      tooltip:\r\n        \"The alt text is used by screen readers, or if the image can't be downloaded or displayed\",\r\n      type: \"string\",\r\n      propPath: \"dom\",\r\n      index: 1000,\r\n      default: \"\",\r\n    },\r\n  },\r\n  outputProps: {\r\n    onLoad: {\r\n      displayName: \"On Load\",\r\n      propPath: \"dom\",\r\n      type: \"signal\",\r\n      group: \"Events\",\r\n    },\r\n    onError: {\r\n      displayName: \"On Error\",\r\n      propPath: \"dom\",\r\n      type: \"signal\",\r\n      group: \"Events\",\r\n    },\r\n  },\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(ImageNode, {\r\n  defaultSizeMode: \"contentSize\",\r\n  contentLabel: \"Image\",\r\n});\r\nNodeSharedPortDefinitions.addTransformInputs(ImageNode);\r\nNodeSharedPortDefinitions.addMarginInputs(ImageNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(ImageNode);\r\nNodeSharedPortDefinitions.addAlignInputs(ImageNode);\r\nNodeSharedPortDefinitions.addPointerEventOutputs(ImageNode);\r\nNodeSharedPortDefinitions.addBorderInputs(ImageNode);\r\nNodeSharedPortDefinitions.addShadowInputs(ImageNode);\r\n\r\nexport default createNodeFromReactComponent(ImageNode);\r\n","import React, { JSX } from \"react\";\r\n\r\nimport Layout from \"../../../layout\";\r\nimport PointerListeners from \"../../../pointerlisteners\";\r\nimport { Noodl } from \"../../../types\";\r\n\r\nexport interface TextProps extends Noodl.ReactProps {\r\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\r\n\r\n  attrs: React.Attributes;\r\n\r\n  textStyle: Noodl.TextStyle;\r\n  text: string;\r\n\r\n  sizeMode?: Noodl.SizeMode;\r\n  width?: string;\r\n  height?: string;\r\n  fixedWidth?: boolean;\r\n  fixedHeight?: boolean;\r\n\r\n  // Extra Attributes\r\n  dom: Record<string, unknown>;\r\n}\r\n\r\nexport function Text(props: TextProps) {\r\n  const { as: Component = \"div\" } = props;\r\n\r\n  const style = {\r\n    ...props.textStyle,\r\n    ...props.style,\r\n  };\r\n\r\n  Layout.size(style, props);\r\n  Layout.align(style, props);\r\n\r\n  style.color = props.noodlNode.context.styles.resolveColor(style.color);\r\n\r\n  // Respect '\\n' in the string\r\n  if (props.sizeMode === \"contentSize\" || props.sizeMode === \"contentWidth\") {\r\n    style.whiteSpace = \"pre\";\r\n  } else {\r\n    style.whiteSpace = \"pre-wrap\";\r\n    style.overflowWrap = \"anywhere\";\r\n  }\r\n\r\n  if (style.opacity === 0) {\r\n    style.pointerEvents = \"none\";\r\n  }\r\n\r\n  return (\r\n    <Component\r\n      className={[\"ndl-visual-text\", props.className].join(\" \")}\r\n      {...props.attrs}\r\n      {...props.dom}\r\n      {...PointerListeners(props)}\r\n      style={style}\r\n    >\r\n      {String(props.text)}\r\n    </Component>\r\n  );\r\n}\r\n","import { Text } from '../../components/visual/Text';\r\nimport NodeSharedPortDefinitions from '../../node-shared-port-definitions';\r\nimport { createNodeFromReactComponent } from '../../react-component-node';\r\nimport { createTooltip } from '../../tooltips';\r\n\r\nconst TextNode = {\r\n  name: 'Text',\r\n  docs: 'https://docs.noodl.net/nodes/basic-elements/text',\r\n  visualStates: [\r\n    { name: 'neutral', label: 'Neutral' },\r\n    { name: 'hover', label: 'Hover' }\r\n  ],\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  usePortAsLabel: 'text',\r\n  portLabelTruncationMode: 'length',\r\n  connectionPanel: {\r\n    groupPriority: ['General', 'Text', 'Text Style', 'Style', 'Events', 'Mounted', 'Hover Events', 'Pointer Events']\r\n  },\r\n  nodeDoubleClickAction: {\r\n    focusPort: 'text'\r\n  },\r\n  initialize() {\r\n    this.props.attrs = {};\r\n  },\r\n  getReactComponent() {\r\n    return Text;\r\n  },\r\n  getInspectInfo() {\r\n    return this.props.text;\r\n  },\r\n  defaultCss: {\r\n    position: 'relative',\r\n    display: 'flex'\r\n  },\r\n  inputProps: {\r\n    text: {\r\n      index: 19,\r\n      group: 'Text',\r\n      displayName: 'Text',\r\n      default: 'Text',\r\n      type: {\r\n        name: 'string',\r\n        multiline: true\r\n      }\r\n    },\r\n    as: {\r\n      index: 100000,\r\n      group: 'Advanced HTML',\r\n      displayName: 'Tag',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: '<div>', value: 'div' },\r\n          { label: '<h1>', value: 'h1' },\r\n          { label: '<h2>', value: 'h2' },\r\n          { label: '<h3>', value: 'h3' },\r\n          { label: '<h4>', value: 'h4' },\r\n          { label: '<h5>', value: 'h5' },\r\n          { label: '<h6>', value: 'h6' },\r\n          { label: '<p>', value: 'p' },\r\n          { label: '<span>', value: 'span' }\r\n          // { label: '<a>', value: 'a' },\r\n        ]\r\n      },\r\n      default: 'div'\r\n    }\r\n  },\r\n  inputCss: {\r\n    wordBreak: {\r\n      index: 27,\r\n      group: 'Text',\r\n      displayName: 'Word Break',\r\n      applyDefault: false,\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Normal', value: 'normal' },\r\n          { label: 'Break All', value: 'break-all' }\r\n        ]\r\n      },\r\n      default: 'normal'\r\n    }\r\n  },\r\n  inputs: {\r\n    textAlignX: {\r\n      group: 'Text Alignment',\r\n      index: 13,\r\n      displayName: 'Text Horizontal Align',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'left', value: 'left' },\r\n          { label: 'center', value: 'center' },\r\n          { label: 'right', value: 'right' }\r\n        ],\r\n        alignComp: 'justify'\r\n      },\r\n      default: 'left',\r\n      set(value) {\r\n        switch (value) {\r\n          case 'left':\r\n            this.setStyle({ textAlign: 'left', justifyContent: 'flex-start' });\r\n            break;\r\n          case 'center':\r\n            this.setStyle({ textAlign: 'center', justifyContent: 'center' });\r\n            break;\r\n          case 'right':\r\n            this.setStyle({ textAlign: 'right', justifyContent: 'flex-end' });\r\n            break;\r\n        }\r\n      }\r\n    },\r\n    textAlignY: {\r\n      group: 'Text Alignment',\r\n      index: 14,\r\n      displayName: 'Text Vertical Align',\r\n      type: {\r\n        name: 'enum',\r\n        enums: [\r\n          { label: 'Top', value: 'top' },\r\n          { label: 'Center', value: 'center' },\r\n          { label: 'Bottom', value: 'bottom' }\r\n        ],\r\n        alignComp: 'vertical'\r\n      },\r\n      default: 'top',\r\n      set(value) {\r\n        switch (value) {\r\n          case 'top':\r\n            this.setStyle({ alignItems: 'flex-start' });\r\n            break;\r\n          case 'center':\r\n            this.setStyle({ alignItems: 'center' });\r\n            break;\r\n          case 'bottom':\r\n            this.setStyle({ alignItems: 'flex-end' });\r\n            break;\r\n        }\r\n      }\r\n    },\r\n    testId: {\r\n      index: 100009,\r\n      displayName: 'Test ID Attribute',\r\n      group: 'Advanced HTML',\r\n      type: 'string',\r\n      set(value) {\r\n        this.props.attrs[\"data-testid\"] = value;\r\n        this.forceUpdate();\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(TextNode, {\r\n  defaultSizeMode: 'contentHeight',\r\n  contentLabel: 'Text'\r\n});\r\nNodeSharedPortDefinitions.addTextStyleInputs(TextNode);\r\nNodeSharedPortDefinitions.addAlignInputs(TextNode);\r\nNodeSharedPortDefinitions.addTransformInputs(TextNode);\r\nNodeSharedPortDefinitions.addMarginInputs(TextNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(TextNode);\r\nNodeSharedPortDefinitions.addPointerEventOutputs(TextNode);\r\n\r\nfunction defineTooltips(node) {\r\n  node.inputCss.wordBreak.tooltip = createTooltip({\r\n    title: 'Word break',\r\n    body: [\r\n      'Control where line breaks are allowed',\r\n      '- Normal: Break on spaces and other whitespace characters',\r\n      '- Break All: Allow line breaks between any two characters, including inside words'\r\n    ]\r\n  });\r\n}\r\n\r\n// eslint-disable-next-line no-undef\r\nif (!Noodl.runDeployed) {\r\n  defineTooltips(TextNode);\r\n}\r\n\r\nexport default createNodeFromReactComponent(TextNode);\r\n","import React from \"react\";\r\n\r\nimport Layout from \"../../../layout\";\r\nimport PointerListeners from \"../../../pointerlisteners\";\r\nimport { Noodl } from \"../../../types\";\r\n\r\nexport interface VideoProps extends Noodl.ReactProps {\r\n  objectPositionX: string;\r\n  objectPositionY: string;\r\n\r\n  dom: Exclude<CachedVideoProps, \"innerRef\" | \"onCanPlay\">;\r\n\r\n  onCanPlay?: () => void;\r\n  videoWidth?: (value: number) => void;\r\n  videoHeight?: (value: number) => void;\r\n  onVideoElementCreated?: (video) => void;\r\n}\r\n\r\nexport interface CachedVideoProps {\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n\r\n  muted?: boolean;\r\n  loop?: boolean;\r\n  volume?: number;\r\n  autoplay?: boolean;\r\n  controls?: boolean;\r\n  src: string;\r\n\r\n  innerRef: (video: HTMLVideoElement) => void;\r\n  onCanPlay: () => void;\r\n}\r\n\r\nclass CachedVideo extends React.PureComponent<CachedVideoProps> {\r\n  video: HTMLVideoElement | null = null;\r\n\r\n  componentDidUpdate() {\r\n    if (this.video) {\r\n      this.video.muted = this.props.muted ?? false;\r\n      this.video.loop = this.props.loop ?? false;\r\n      this.video.volume = this.props.volume ?? 1;\r\n      this.video.autoplay = this.props.autoplay ?? false;\r\n      this.video.controls = this.props.controls ?? false;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let src = this.props.src ? this.props.src.toString() : undefined;\r\n\r\n    if (src) {\r\n      if (src.indexOf(\"#t=\") === -1) {\r\n        src += \"#t=0.01\"; //force Android to render the first frame\r\n      }\r\n      if (src.startsWith(\"/\")) {\r\n        // @ts-expect-error missing Noodl typings\r\n        const baseUrl = Noodl.Env[\"BaseUrl\"];\r\n        if (baseUrl) {\r\n          src = baseUrl + src.substring(1);\r\n        }\r\n      }\r\n    }\r\n\r\n    return (\r\n      <video\r\n        {...this.props}\r\n        playsInline={true}\r\n        src={src}\r\n        {...PointerListeners(this.props)}\r\n        ref={(video) => {\r\n          this.video = video;\r\n          this.props.innerRef(video!);\r\n        }}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport class Video extends React.Component<VideoProps> {\r\n  wantToPlay: boolean;\r\n  canPlay: boolean;\r\n  video: HTMLVideoElement | null = null;\r\n\r\n  constructor(props: VideoProps) {\r\n    super(props);\r\n\r\n    this.wantToPlay = false;\r\n    this.canPlay = false;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.canPlay = false;\r\n  }\r\n\r\n  setSourceObject(src) {\r\n    if (this.video && this.video.srcObject !== src) {\r\n      this.video.srcObject = src;\r\n      this.canPlay = false; //wait for can play event\r\n    }\r\n  }\r\n\r\n  play() {\r\n    this.wantToPlay = true;\r\n    if (this.video && this.canPlay) {\r\n      this.video.play();\r\n    }\r\n  }\r\n\r\n  restart() {\r\n    this.wantToPlay = true;\r\n    if (this.video && this.canPlay) {\r\n      this.video.currentTime = 0;\r\n      this.video.play();\r\n    }\r\n  }\r\n\r\n  pause() {\r\n    this.wantToPlay = false;\r\n    this.video && this.video.pause();\r\n  }\r\n\r\n  reset() {\r\n    this.wantToPlay = false;\r\n    if (this.video) {\r\n      this.video.currentTime = 0;\r\n      this.video.pause();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const props = this.props;\r\n    const style = {\r\n      ...props.style,\r\n    };\r\n\r\n    Layout.size(style, props);\r\n    Layout.align(style, props);\r\n\r\n    if (style.opacity === 0) {\r\n      style.pointerEvents = \"none\";\r\n    }\r\n\r\n    style.objectPosition = `${props.objectPositionX} ${props.objectPositionY}`;\r\n\r\n    return (\r\n      <CachedVideo\r\n        {...props.dom}\r\n        className={props.className}\r\n        style={style}\r\n        innerRef={(video) => {\r\n          this.video = video;\r\n          this.props.onVideoElementCreated &&\r\n            this.props.onVideoElementCreated(video);\r\n        }}\r\n        onCanPlay={() => {\r\n          this.canPlay = true;\r\n          if (this.wantToPlay) {\r\n            this.video!.play();\r\n          }\r\n          this.props.onCanPlay && this.props.onCanPlay();\r\n          this.props.videoWidth &&\r\n            this.props.videoWidth(this.video!.videoWidth);\r\n          this.props.videoHeight &&\r\n            this.props.videoHeight(this.video!.videoHeight);\r\n        }}\r\n      />\r\n    );\r\n  }\r\n}\r\n","import { getAbsoluteUrl } from \"@fluxscape/runtime\";\r\n\r\nimport { Video } from \"../../components/visual/Video\";\r\nimport NodeSharedPortDefinitions from \"../../node-shared-port-definitions\";\r\nimport { createNodeFromReactComponent } from \"../../react-component-node\";\r\n\r\nconst VideoNode = {\r\n  name: \"Video\",\r\n  docs: \"https://docs.noodl.net/nodes/basic-elements/video\",\r\n  connectionPanel: {\r\n    groupPriority: [\r\n      \"General\",\r\n      \"Video\",\r\n      \"Video Actions\",\r\n      \"Style\",\r\n      \"Actions\",\r\n      \"Events\",\r\n      \"Mounted\",\r\n      \"Playback\",\r\n      \"Pointer Events\",\r\n      \"Hover Events\",\r\n      \"Dimensions\",\r\n      \"Margin and padding\",\r\n    ],\r\n  },\r\n  getReactComponent() {\r\n    return Video;\r\n  },\r\n  allowChildren: false,\r\n  noodlNodeAsProp: true,\r\n  defaultCss: {\r\n    display: \"block\",\r\n  },\r\n  inputs: {\r\n    srcObject: {\r\n      displayName: \"Source Object\",\r\n      group: \"Video\",\r\n      type: \"mediastream\",\r\n      default: null,\r\n      set(value) {\r\n        this.innerReactComponentRef &&\r\n          this.innerReactComponentRef.setSourceObject(value);\r\n      },\r\n    },\r\n    play: {\r\n      type: \"signal\",\r\n      group: \"Video Actions\",\r\n      displayName: \"Play\",\r\n      tooltip: {\r\n        standard: \"Play the video\",\r\n      },\r\n      valueChangedToTrue() {\r\n        this.innerReactComponentRef && this.innerReactComponentRef.play();\r\n      },\r\n    },\r\n    restart: {\r\n      type: \"signal\",\r\n      group: \"Video Actions\",\r\n      displayName: \"Restart\",\r\n      tooltip: {\r\n        standard: \"Restart the video from the beginning\",\r\n      },\r\n      valueChangedToTrue() {\r\n        this.innerReactComponentRef && this.innerReactComponentRef.restart();\r\n      },\r\n    },\r\n    pause: {\r\n      type: \"boolean\",\r\n      group: \"Video Actions\",\r\n      displayName: \"Pause\",\r\n      valueChangedToTrue() {\r\n        this.innerReactComponentRef && this.innerReactComponentRef.pause();\r\n      },\r\n    },\r\n    reset: {\r\n      type: \"boolean\",\r\n      group: \"Video Actions\",\r\n      displayName: \"Reset\",\r\n      valueChangedToTrue() {\r\n        this.innerReactComponentRef && this.innerReactComponentRef.reset();\r\n      },\r\n    },\r\n    src: {\r\n      displayName: \"Source\",\r\n      group: \"Video\",\r\n      type: \"string\",\r\n      set(src) {\r\n        this.props.dom.src = getAbsoluteUrl(src);\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n    poster: {\r\n      displayName: \"Poster\",\r\n      group: \"Video\",\r\n      type: \"image\",\r\n      set(src) {\r\n        this.props.dom.poster = getAbsoluteUrl(src);\r\n        this.forceUpdate();\r\n      },\r\n    },\r\n  },\r\n  inputProps: {\r\n    autoplay: {\r\n      displayName: \"Autoplay\",\r\n      propPath: \"dom\",\r\n      group: \"Video\",\r\n      type: \"boolean\",\r\n    },\r\n    controls: {\r\n      displayName: \"Controls\",\r\n      propPath: \"dom\",\r\n      group: \"Video\",\r\n      type: \"boolean\",\r\n    },\r\n    volume: {\r\n      displayName: \"Volume\",\r\n      propPath: \"dom\",\r\n      group: \"Video\",\r\n      type: \"number\",\r\n      default: 1,\r\n    },\r\n    muted: {\r\n      displayName: \"Muted\",\r\n      propPath: \"dom\",\r\n      group: \"Video\",\r\n      type: \"boolean\",\r\n    },\r\n    loop: {\r\n      displayName: \"Loop\",\r\n      propPath: \"dom\",\r\n      group: \"Video\",\r\n      type: \"boolean\",\r\n    },\r\n    objectPositionX: {\r\n      displayName: \"Video Position X\",\r\n      group: \"Video Layout\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"%\", \"px\"],\r\n        defaultUnit: \"%\",\r\n      },\r\n      default: 50,\r\n    },\r\n    objectPositionY: {\r\n      displayName: \"Video Position Y\",\r\n      group: \"Video Layout\",\r\n      type: {\r\n        name: \"number\",\r\n        units: [\"%\", \"px\"],\r\n        defaultUnit: \"%\",\r\n      },\r\n      default: 50,\r\n    },\r\n  },\r\n  inputCss: {\r\n    objectFit: {\r\n      displayName: \"Object Fit\",\r\n      group: \"Video Layout\",\r\n      type: {\r\n        name: \"enum\",\r\n        enums: [\r\n          {\r\n            label: \"Contain\",\r\n            value: \"contain\",\r\n          },\r\n          {\r\n            label: \"Cover\",\r\n            value: \"cover\",\r\n          },\r\n          {\r\n            label: \"Fill\",\r\n            value: \"fill\",\r\n          },\r\n          {\r\n            label: \"None\",\r\n            value: \"none\",\r\n          },\r\n        ],\r\n      },\r\n      default: \"contain\",\r\n    },\r\n  },\r\n  outputProps: {\r\n    onCanPlay: {\r\n      type: \"signal\",\r\n      group: \"Events\",\r\n      displayName: \"On Can Play\",\r\n    },\r\n    onTimeUpdate: {\r\n      group: \"Playback\",\r\n      displayName: \"Playback Position\",\r\n      type: \"number\",\r\n      propPath: \"dom\",\r\n      getValue(event) {\r\n        return event.target.currentTime;\r\n      },\r\n    },\r\n    onPlay: {\r\n      group: \"Events\",\r\n      displayName: \"On Play\",\r\n      type: \"signal\",\r\n      propPath: \"dom\",\r\n    },\r\n    onPause: {\r\n      group: \"Events\",\r\n      displayName: \"On Pause\",\r\n      type: \"signal\",\r\n      propPath: \"dom\",\r\n    },\r\n    onVideoElementCreated: {\r\n      type: \"domelement\",\r\n      displayName: \"DOM Element\",\r\n    },\r\n    videoWidth: {\r\n      group: \"Playback\",\r\n      type: \"number\",\r\n      displayName: \"Video Width\",\r\n    },\r\n    videoHeight: {\r\n      group: \"Playback\",\r\n      type: \"number\",\r\n      displayName: \"Video Height\",\r\n    },\r\n  },\r\n};\r\n\r\nNodeSharedPortDefinitions.addDimensions(VideoNode, {\r\n  defaultSizeMode: \"contentSize\",\r\n  contentLabel: \"Video\",\r\n});\r\nNodeSharedPortDefinitions.addTransformInputs(VideoNode);\r\nNodeSharedPortDefinitions.addMarginInputs(VideoNode);\r\nNodeSharedPortDefinitions.addSharedVisualInputs(VideoNode);\r\nNodeSharedPortDefinitions.addAlignInputs(VideoNode);\r\nNodeSharedPortDefinitions.addPointerEventOutputs(VideoNode);\r\nNodeSharedPortDefinitions.addBorderInputs(VideoNode);\r\n\r\nexport default createNodeFromReactComponent(VideoNode);\r\n","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./style.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import { NodeScope } from \"@fluxscape/runtime\";\r\nimport type { NodeRegister, GraphModel, TSFixme } from \"../typings/global\";\r\nimport { FontLoader } from \"./fontloader\";\r\n\r\nfunction getInputsWithType(nodeScope: NodeScope, inputType) {\r\n  const result = [];\r\n\r\n  const nodes = nodeScope.getAllNodesRecursive();\r\n  nodes.forEach((node) => {\r\n    const inputs = [];\r\n\r\n    for (const inputName in node._inputs) {\r\n      const input = node._inputs[inputName];\r\n      if (input.type === inputType) {\r\n        // @ts-expect-error\r\n        inputs.push(inputName);\r\n      }\r\n    }\r\n\r\n    if (inputs.length) {\r\n      // @ts-expect-error\r\n      result.push({ node, inputs });\r\n    }\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\ntype TextStyleData = {\r\n  letterSpacing: string;\r\n  lineHeight: { value: string; unit: string };\r\n  textTransform: string;\r\n  fontSize: { value: string; unit: string };\r\n  fontFamily: string;\r\n  color: string;\r\n};\r\n\r\ntype StylesData = {\r\n  text?: Record<string, TextStyleData>;\r\n  colors?: Record<string, string>;\r\n};\r\n\r\nexport default class Styles {\r\n  getNodeScope: () => TSFixme;\r\n  graphModel: GraphModel;\r\n  nodeRegister: NodeRegister;\r\n  // @ts-expect-error\r\n  styles: StylesData;\r\n\r\n  constructor({ graphModel, nodeRegister, getNodeScope }) {\r\n    this.getNodeScope = getNodeScope;\r\n    this.graphModel = graphModel;\r\n    this.nodeRegister = nodeRegister;\r\n\r\n    this.setStyles(graphModel.getMetaData(\"styles\") || {});\r\n    graphModel.on(\"metadataChanged.styles\", (styles) => this.setStyles(styles));\r\n  }\r\n\r\n  setStyles(styles: StylesData) {\r\n    // Brute force update all styles, no delta check\r\n    this.styles = styles;\r\n\r\n    // Process text styles\r\n    const textStyles = styles.text || {};\r\n\r\n    // Format font family\r\n    Object.values(textStyles)\r\n      .filter((style) => style.fontFamily)\r\n      .forEach((textStyle) => {\r\n        let family = textStyle.fontFamily;\r\n\r\n        // Load files and create font css\r\n        if (family.split(\".\").length > 1) {\r\n          FontLoader.instance.loadFont(family);\r\n          family = family.replace(/\\.[^/.]+$/, \"\");\r\n          // @ts-expect-error\r\n          family = family.split(\"/\").pop();\r\n\r\n          // Update the style to the font css instead of the file name\r\n          textStyle.fontFamily = family;\r\n        }\r\n      });\r\n\r\n    // Format values with units (to css strings)\r\n    for (const name in textStyles) {\r\n      const style = textStyles[name];\r\n      for (const prop in style) {\r\n        const value = style[prop];\r\n        if (typeof value === \"object\") {\r\n          style[prop] = value.value + value.unit;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Remove colors with empty strings\r\n    for (const name in textStyles) {\r\n      const style = textStyles[name];\r\n      if (style.hasOwnProperty(\"color\") && !style.color) {\r\n        // @ts-expect-error\r\n        delete style.color;\r\n      }\r\n    }\r\n\r\n    const nodeScope = this.getNodeScope && this.getNodeScope();\r\n    if (!nodeScope) return;\r\n\r\n    const variants = this.graphModel.getVariants();\r\n    for (const variant of variants) {\r\n      if (this._variantHasInputsWithTypes(variant, [\"color\", \"textStyle\"])) {\r\n        const nodes = nodeScope.getAllNodesWithVariantRecursive(variant);\r\n        nodes.forEach((node) => node.setVariant(variant));\r\n      }\r\n    }\r\n\r\n    //set all inputs with types using styles\r\n    //just re-apply the previous value to trigger a new style resolve\r\n    [\"color\", \"textStyle\"].forEach((inputType) => {\r\n      getInputsWithType(nodeScope, inputType).forEach(({ node, inputs }) => {\r\n        // @ts-expect-error\r\n        inputs.forEach((inputName) => {\r\n          // @ts-expect-error\r\n          if (node.getInputValue(inputName)) {\r\n            // @ts-expect-error\r\n            node.setInputValue(inputName, node.getInputValue(inputName));\r\n          }\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  resolveColor(color: string) {\r\n    if (!this.styles.colors) return color;\r\n\r\n    const resolvedColor = this.styles.colors[color];\r\n    return resolvedColor ? resolvedColor : color;\r\n  }\r\n\r\n  getTextStyle(styleName: string) {\r\n    if (!this.styles.text) return {};\r\n    return this.styles.text[styleName] || {};\r\n  }\r\n\r\n  //checks if a variant includes inputs with the specified types\r\n  _variantHasInputsWithTypes(variant, types) {\r\n    if (!this.nodeRegister.hasNode(variant.typename)) return;\r\n\r\n    //get the metadata for the node this variant is used by\r\n    const metadata = this.nodeRegister.getNodeMetadata(variant.typename);\r\n\r\n    //get all the inputs this variant affects...\r\n    const parameterNames = new Set(Object.keys(variant.parameters));\r\n    for (const state in variant.stateParameters) {\r\n      Object.keys(variant.stateParameters[state]).forEach((param) =>\r\n        parameterNames.add(param)\r\n      );\r\n    }\r\n\r\n    //...and check if the inputs are of the supplied types\r\n    for (const param of Array.from(parameterNames)) {\r\n      const inputType = metadata.inputs[param] && metadata.inputs[param].type;\r\n      if (types.includes(inputType)) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n}\r\n","import React from \"react\";\r\n\r\nimport { NoHomeError } from \"./components/common/NoHomeError\";\r\nimport GraphWarnings from \"./graph-warnings\";\r\nimport { Highlighter } from \"./highlighter\";\r\nimport { Inspector } from \"./inspector\";\r\nimport NoodlJSAPI from \"./noodl-js-api\";\r\nimport projectSettings from \"./project-settings\";\r\nimport { createNodeFromReactComponent } from \"./react-component-node\";\r\nimport registerNodes from \"./register-nodes\";\r\nimport Styles from \"./styles\";\r\n\r\nif (typeof window !== \"undefined\" && window.NoodlEditor) {\r\n  window.NoodlEditorInspectorAPI = {\r\n    enabled: false,\r\n    inspector: null,\r\n    setInspector(inspector) {\r\n      this.inspector = inspector;\r\n      this.enabled ? this.inspector.enable() : this.inspector.disable();\r\n    },\r\n    setEnabled(enabled) {\r\n      this.enabled = enabled;\r\n      if (this.inspector) {\r\n        this.enabled ? this.inspector.enable() : this.inspector.disable();\r\n      }\r\n\r\n      if (window.NoodlEditorHighlightAPI.highlighter) {\r\n        window.NoodlEditorHighlightAPI.highlighter.setWindowSelected(enabled);\r\n      }\r\n    },\r\n  };\r\n\r\n  window.NoodlEditorHighlightAPI = {\r\n    highlighter: null,\r\n    setHighlighter(highlighter) {\r\n      this.highlighter = highlighter;\r\n\r\n      this.highlighter.setWindowSelected(\r\n        window.NoodlEditorInspectorAPI.enabled\r\n      );\r\n    },\r\n    selectNode(nodeId) {\r\n      this.highlighter.deselectNodes();\r\n\r\n      if (nodeId && nodeId !== \"null\") {\r\n        this.highlighter.selectNodesWithId(nodeId);\r\n      } else if (window.NoodlEditorInspectorAPI.enabled) {\r\n        this.highlighter.setWindowSelected(true);\r\n      }\r\n    },\r\n  };\r\n}\r\n\r\nexport function ssrSetupRuntime(noodlRuntime, noodlModules, projectData) {\r\n  registerNodes(noodlRuntime);\r\n\r\n  // Noodl static API\r\n  NoodlJSAPI(noodlRuntime);\r\n\r\n  noodlRuntime.setProjectSettings(projectSettings);\r\n\r\n  // Register module nodes\r\n  if (noodlModules) {\r\n    for (const module of noodlModules) {\r\n      if (module.reactNodes) {\r\n        const reactNodes = [];\r\n        for (const nodeDefinition of module.reactNodes) {\r\n          reactNodes.push(createNodeFromReactComponent(nodeDefinition));\r\n        }\r\n        const nodes = module.nodes || [];\r\n        module.nodes = nodes.concat(reactNodes);\r\n      }\r\n      noodlRuntime.registerModule(module);\r\n    }\r\n  }\r\n\r\n  const styles = new Styles({\r\n    graphModel: noodlRuntime.graphModel,\r\n    getNodeScope: () =>\r\n      noodlRuntime.context.rootComponent &&\r\n      noodlRuntime.context.rootComponent.nodeScope,\r\n    nodeRegister: noodlRuntime.context.nodeRegister,\r\n  });\r\n\r\n  //make the styles available to all nodes via `this.context.styles`\r\n  noodlRuntime.context.styles = styles;\r\n\r\n  noodlRuntime.setData(projectData);\r\n  noodlRuntime._disableLoad = true;\r\n}\r\n\r\nexport default class Viewer extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      popups: [],\r\n    };\r\n\r\n    const { noodlRuntime } = props;\r\n    this.runningDeployed = this.props.projectData !== undefined;\r\n    this.focusedNoodlNodes = [];\r\n\r\n    noodlRuntime.context.setNodeFocused = this.setNodeFocused.bind(this);\r\n\r\n    const enableDebugInspectors =\r\n      (typeof document !== \"undefined\" &&\r\n        document.location.href.indexOf(\"forceDebugger=true\") !== -1) ||\r\n      Noodl.enableDebugInspectors;\r\n    noodlRuntime.setDebugInspectorsEnabled(enableDebugInspectors);\r\n\r\n    noodlRuntime.context.setPopupCallbacks({\r\n      onShow: (popup) => {\r\n        const newPopupArray = this.state.popups.concat([popup]);\r\n\r\n        const bodyScroll = noodlRuntime.getProjectSettings().bodyScroll;\r\n\r\n        //Disable body scroll when showing a popup\r\n        if (bodyScroll && newPopupArray.length === 1) {\r\n          document.body.style.width = document.body.clientWidth + \"px\";\r\n          document.body.style.top = `-${window.scrollY}px`;\r\n          document.body.style.position = \"fixed\";\r\n        }\r\n\r\n        this.setState({\r\n          popups: newPopupArray,\r\n        });\r\n      },\r\n      onClose: (popup) => {\r\n        const newPopupArray = this.state.popups.filter((p) => p !== popup);\r\n\r\n        this.setState({\r\n          popups: newPopupArray,\r\n        });\r\n\r\n        const bodyScroll = noodlRuntime.getProjectSettings().bodyScroll;\r\n\r\n        //Enable body scroll when hiding all popups\r\n        if (bodyScroll && newPopupArray.length === 0) {\r\n          const scrollY = document.body.style.top;\r\n          document.body.style.position = \"\";\r\n          document.body.style.top = \"\";\r\n          document.body.style.width = \"100%\";\r\n          window.scrollTo(0, parseInt(scrollY || \"0\") * -1);\r\n        }\r\n      },\r\n    });\r\n\r\n    registerNodes(noodlRuntime);\r\n\r\n    // Noodl static API\r\n    NoodlJSAPI(noodlRuntime);\r\n\r\n    noodlRuntime.setProjectSettings(projectSettings);\r\n\r\n    // Register module nodes\r\n    if (this.props.noodlModules) {\r\n      for (const module of this.props.noodlModules) {\r\n        if (module.reactNodes) {\r\n          const reactNodes = [];\r\n          for (const nodeDefinition of module.reactNodes) {\r\n            reactNodes.push(createNodeFromReactComponent(nodeDefinition));\r\n          }\r\n          const nodes = module.nodes || [];\r\n          module.nodes = nodes.concat(reactNodes);\r\n        }\r\n        noodlRuntime.registerModule(module);\r\n      }\r\n    }\r\n\r\n    noodlRuntime.eventEmitter.on(\"rootComponentUpdated\", () => {\r\n      //wait until next frame to trigger a react update, so inputs etc have a chance to settle\r\n      //(forceUpdate is synchronous)\r\n      requestAnimationFrame(() => this.forceUpdate());\r\n    });\r\n\r\n    noodlRuntime.graphModel.on(\"projectSettingsChanged\", (settings) => {\r\n      // Suppport SSR\r\n      if (typeof document === \"undefined\") return;\r\n\r\n      if (settings.bodyScroll) {\r\n        document.body.classList.add(\"body-scroll\");\r\n      } else {\r\n        document.body.classList.remove(\"body-scroll\");\r\n      }\r\n    });\r\n\r\n    this.styles = new Styles({\r\n      graphModel: noodlRuntime.graphModel,\r\n      getNodeScope: () =>\r\n        noodlRuntime.context.rootComponent &&\r\n        noodlRuntime.context.rootComponent.nodeScope,\r\n      nodeRegister: noodlRuntime.context.nodeRegister,\r\n    });\r\n\r\n    //make the styles available to all nodes via `this.context.styles`\r\n    noodlRuntime.context.styles = this.styles;\r\n\r\n    this.state.waitingForExport = !this.runningDeployed;\r\n\r\n    if (this.runningDeployed) {\r\n      this.props.noodlRuntime.setData(this.props.projectData);\r\n\r\n      //start pre-fetching the rest of the bundles after a while, if there arent too many of them\r\n      const allBundles = Object.keys(this.props.projectData.componentIndex);\r\n      if (allBundles.length < 30) {\r\n        setTimeout(() => {\r\n          this.props.noodlRuntime.prefetchBundles(allBundles, 3);\r\n        }, 10000);\r\n      }\r\n    } else {\r\n      noodlRuntime.graphModel.on(\"editorImportComplete\", () => {\r\n        this.setState({ waitingForExport: false });\r\n      });\r\n      this.connectToEditor();\r\n    }\r\n\r\n    this.focusedNoodlNodes = [];\r\n  }\r\n\r\n  connectToEditor() {\r\n    const { noodlRuntime } = this.props;\r\n\r\n    // Remove hash if it is in location href\r\n    var href =\r\n      (Noodl.host || location.protocol + \"//\" + location.host) +\r\n      location.pathname +\r\n      (location.search ? location.search : \"\");\r\n\r\n    const address = href.replace(\"http\", \"ws\");\r\n    noodlRuntime.connectToEditor(address);\r\n\r\n    this.highlightedNodes = new Map();\r\n    this.isUpdatingHighlights = false;\r\n\r\n    if (typeof window !== \"undefined\" && window.NoodlEditor) {\r\n      this.highlighter = new Highlighter(noodlRuntime);\r\n      NoodlEditorHighlightAPI.setHighlighter(this.highlighter);\r\n\r\n      noodlRuntime.editorConnection.on(\"hoverStart\", (id) => {\r\n        this.highlighter.highlightNodesWithId(id);\r\n      });\r\n      noodlRuntime.editorConnection.on(\"hoverEnd\", (id) => {\r\n        this.highlighter.disableHighlight();\r\n      });\r\n\r\n      this.inspector = new Inspector({\r\n        onDisableHighlight: () => this.highlighter.disableHighlight(),\r\n        onHighlight: (id) => this.highlighter.highlightNodesWithId(id),\r\n        onInspect: (ids) => {\r\n          NoodlEditor.inspectNodes(ids);\r\n        },\r\n      });\r\n      NoodlEditorInspectorAPI.setInspector(this.inspector);\r\n    }\r\n\r\n    noodlRuntime.editorConnection.on(\"debuggingEnabledChanged\", (enabled) => {\r\n      noodlRuntime.setDebugInspectorsEnabled(enabled);\r\n    });\r\n\r\n    this.graphWarnings = new GraphWarnings(\r\n      noodlRuntime.graphModel,\r\n      noodlRuntime.editorConnection\r\n    );\r\n  }\r\n\r\n  setNodeFocused(node, focused) {\r\n    if (focused && this.focusedNoodlNodes.indexOf(node) === -1) {\r\n      //blur nodes that don't contain this new node\r\n      this.focusedNoodlNodes\r\n        .filter((focusedNode) => !focusedNode.contains(node))\r\n        .forEach((blurredNode) => {\r\n          blurredNode._blur();\r\n        });\r\n\r\n      node._focus();\r\n      this.focusedNoodlNodes.push(node);\r\n    } else if (!focused) {\r\n      const index = this.focusedNoodlNodes.indexOf(node);\r\n      if (index !== -1) {\r\n        return;\r\n      }\r\n\r\n      node._blur();\r\n\r\n      //also blur nodes that contain this node\r\n      this.focusedNoodlNodes\r\n        .filter((focusedNode) => focusedNode.contains(node))\r\n        .forEach((blurredNode) => {\r\n          blurredNode._blur();\r\n        });\r\n\r\n      this.focusedNoodlNodes.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  onClickCapture(e) {\r\n    const focusedNoodlNodes = [];\r\n\r\n    //walk up the dom tree and collect all noodl nodes\r\n    let elem = e.target;\r\n    while (elem) {\r\n      if (elem.noodlNode && elem.noodlNode._focus)\r\n        focusedNoodlNodes.push(elem.noodlNode);\r\n      elem = elem.parentNode;\r\n    }\r\n\r\n    //blur nodes that weren't part of this click\r\n    this.focusedNoodlNodes\r\n      .filter((node) => focusedNoodlNodes.indexOf(node) === -1)\r\n      .forEach((node) => node._blur());\r\n\r\n    //focus all new focused nodes\r\n    focusedNoodlNodes\r\n      .filter((node) => this.focusedNoodlNodes.indexOf(node) === -1)\r\n      .forEach((node) => node._focus());\r\n\r\n    this.focusedNoodlNodes = focusedNoodlNodes;\r\n  }\r\n\r\n  render() {\r\n    const rootComponent = this.props.noodlRuntime.rootComponent;\r\n    if (this.state.waitingForExport) return null;\r\n\r\n    if (!rootComponent) {\r\n      if (this.runningDeployed) {\r\n        return null;\r\n      } else {\r\n        return NoHomeError();\r\n      }\r\n    }\r\n\r\n    const bodyScroll = this.props.noodlRuntime.getProjectSettings().bodyScroll;\r\n\r\n    if (bodyScroll) {\r\n      const style = {\r\n        margin: 0,\r\n        padding: 0,\r\n        minHeight: \"100vh\",\r\n        alignSelf: \"stretch\",\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n      };\r\n      return (\r\n        <div style={style} onClickCapture={(e) => this.onClickCapture(e)}>\r\n          <div style={{ ...style, isolation: \"isolate\" }}>\r\n            {rootComponent.render()}\r\n          </div>\r\n          {this.state.popups.length ? (\r\n            <div style={{ ...style, isolation: \"isolate\" }}>\r\n              {this.state.popups.map((p) => p.render())}\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <div\r\n          style={{\r\n            margin: 0,\r\n            padding: 0,\r\n            overflow: \"hidden\",\r\n            width: \"100%\",\r\n            height: \"100%\",\r\n          }}\r\n          onClickCapture={(e) => this.onClickCapture(e)}\r\n        >\r\n          {rootComponent.render()}\r\n          {this.state.popups.map((p) => p.render())}\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n","// Controls\r\nimport Button from \"./nodes/controls/button\";\r\nimport CheckBox from \"./nodes/controls/checkbox\";\r\nimport Options from \"./nodes/controls/options\";\r\nimport RadioButton from \"./nodes/controls/radiobutton\";\r\nimport RadioButtonGroup from \"./nodes/controls/radiobuttongroup\";\r\nimport Range from \"./nodes/controls/slider\";\r\nimport TextInput from \"./nodes/controls/text-input\";\r\nimport NavigationStack from \"./nodes/navigation/navigation-stack\";\r\nimport Page from \"./nodes/navigation/page\";\r\nimport Router from \"./nodes/navigation/router\";\r\nimport * as ExternalLink from \"./nodes/std-library/externallink\";\r\nimport Circle from \"./nodes/visual/circle\";\r\nimport Columns from \"./nodes/visual/columns.js\";\r\nimport CSSDefinition from \"./nodes/visual/css-definition.js\";\r\nimport DragNode from \"./nodes/visual/drag.js\";\r\nimport Group from \"./nodes/visual/group.js\";\r\nimport Icon from \"./nodes/visual/icon.js\";\r\nimport Image from \"./nodes/visual/image.js\";\r\nimport TextNode from \"./nodes/visual/text.js\";\r\nimport Video from \"./nodes/visual/video.js\";\r\nimport \"./assets/style.css\";\r\nimport NoodlRuntime from \"@fluxscape/runtime\";\r\n\r\nexport default function registerNodes(noodlRuntime: NoodlRuntime) {\r\n  [\r\n    // require('./nodes/std-library/counter'), // moved to runtime\r\n    //  require('./nodes/std-library/expression'), // moved to runtime\r\n    //require('./nodes/std-library/condition'),\r\n    //require('./nodes/std-library/and'),\r\n    //require('./nodes/std-library/or'),\r\n    require(\"./nodes/std-library/switch\"),\r\n    //require('./nodes/std-library/booleantostring'), // moved to runtime\r\n    //require('./nodes/std-library/datetostring'),\r\n    //require('./nodes/std-library/stringmapper'),\r\n    //require('./nodes/std-library/inverter'),\r\n    require(\"./nodes/std-library/timer\"),\r\n    require(\"./nodes/std-library/variables/color\"),\r\n    //require('./nodes/std-library/substring'), // moved to runtime\r\n    require(\"./nodes/std-library/eventsender\"),\r\n    require(\"./nodes/std-library/eventreceiver\"),\r\n    require(\"./nodes/std-library/screenresolution\"),\r\n    require(\"./nodes/std-library/javascript\"),\r\n    //require('./nodes/std-library/simplejavascript'), // moved to runtime\r\n    require(\"./nodes/std-library/numberremapper\"),\r\n    require(\"./nodes/std-library/valuechanged\"),\r\n    require(\"./nodes/std-library/states\"),\r\n    //require('./nodes/std-library/stringformat'), // moved to runtime\r\n    require(\"./nodes/std-library/data/foreach\"),\r\n    require(\"./nodes/std-library/data/foreachactions\"),\r\n    require(\"./nodes/std-library/colorblend\"),\r\n    require(\"./nodes/std-library/animate-to-value\"),\r\n\r\n    //require('./nodes/std-library/variables/number'), // moved to runtime\r\n    //require('./nodes/std-library/variables/string'),\r\n    //require('./nodes/std-library/variables/boolean'),\r\n    require(\"./nodes/std-library/variables/color\"),\r\n\r\n    // Component Object\r\n    require(\"./nodes/std-library/componentutils/componentobject\"),\r\n    require(\"./nodes/std-library/componentutils/parentcomponentobject\"),\r\n    require(\"./nodes/std-library/componentutils/setcomponentobjectproperties\"),\r\n    require(\"./nodes/std-library/componentutils/setparentcomponentobjectproperties\"),\r\n\r\n    // Variable\r\n    require(\"./nodes/std-library/data/variablenode2\"),\r\n    require(\"./nodes/std-library/data/setvariablenode\"),\r\n\r\n    // New object\r\n    // require('./nodes/std-library/data/modelnode2'), // moved to runtime\r\n    // require('./nodes/std-library/data/setmodelpropertiesnode'),\r\n    // require('./nodes/std-library/data/newmodelnode'),\r\n\r\n    // New record\r\n    //require('./nodes/std-library/data/dbmodelnode2'), // moved to runtime\r\n    //require('./nodes/std-library/data/dbcollectionnode2'), // moved to runtime\r\n    // require('./nodes/std-library/data/setdbmodelpropertiesnode'),\r\n    // require('./nodes/std-library/data/deletedbmodelpropertiesnode'),\r\n    // require('./nodes/std-library/data/newdbmodelpropertiesnode'),\r\n    // require('./nodes/std-library/data/dbmodelnode-addrelation'),\r\n    // require('./nodes/std-library/data/dbmodelnode-removerelation'),\r\n    // require('./nodes/std-library/data/filterdbmodelsnode'),\r\n\r\n    // New array\r\n    require(\"./nodes/std-library/data/collectionnode2\"),\r\n    require(\"./nodes/std-library/data/collectionnode-insert\"),\r\n    require(\"./nodes/std-library/data/collectionnode-remove\"),\r\n    require(\"./nodes/std-library/data/collectionnode-clear\"),\r\n    require(\"./nodes/std-library/data/collectionnode-new\"),\r\n    require(\"./nodes/std-library/data/filtercollectionnode\"),\r\n\r\n    require(\"./nodes/std-library/data/staticdata\"),\r\n\r\n    require(\"./nodes/std-library/data/mapcollectionnode\"),\r\n    //require('./nodes/std-library/data/restnode'), // moved to runtime\r\n    require(\"./nodes/std-library/data/cloudfunction2\"),\r\n    //require('./nodes/std-library/uniqueid'), // moved to runtime\r\n\r\n    // Files\r\n    require(\"./nodes/std-library/openfilepicker\"),\r\n    require(\"./nodes/std-library/uploadfile\"),\r\n    //require('./nodes/std-library/data/cloudfilenode'), // moved to runtime\r\n\r\n    // Navigation\r\n    require(\"./nodes/navigation/navigate-back\"),\r\n    require(\"./nodes/navigation/navigate-to-path\"),\r\n    require(\"./nodes/navigation/navigate\"),\r\n    require(\"./nodes/navigation/showpopup\"),\r\n    require(\"./nodes/navigation/closepopup\"),\r\n\r\n    require(\"./nodes/navigation/page-inputs\"),\r\n    require(\"./nodes/navigation/router-navigate\"),\r\n\r\n    // User\r\n    require(\"./nodes/std-library/user/login\"),\r\n    require(\"./nodes/std-library/user/logout\"),\r\n    require(\"./nodes/std-library/user/signup\"),\r\n  ].forEach(function (nodeDefinition) {\r\n    noodlRuntime.registerNode(nodeDefinition);\r\n  });\r\n\r\n  noodlRuntime.registerNode(CSSDefinition);\r\n  noodlRuntime.registerNode(Group);\r\n  noodlRuntime.registerNode(TextNode);\r\n  noodlRuntime.registerNode(Image);\r\n  noodlRuntime.registerNode(Icon);\r\n  noodlRuntime.registerNode(Circle);\r\n  noodlRuntime.registerNode(Video);\r\n  noodlRuntime.registerNode(DragNode);\r\n  noodlRuntime.registerNode(ExternalLink);\r\n  noodlRuntime.registerNode(Columns);\r\n\r\n  // UI Controls\r\n  noodlRuntime.registerNode(Button);\r\n  noodlRuntime.registerNode(CheckBox);\r\n  noodlRuntime.registerNode(RadioButtonGroup);\r\n  noodlRuntime.registerNode(RadioButton);\r\n  noodlRuntime.registerNode(Options);\r\n  noodlRuntime.registerNode(Range);\r\n  noodlRuntime.registerNode(TextInput);\r\n\r\n  // Navigation\r\n  noodlRuntime.registerNode(NavigationStack);\r\n  noodlRuntime.registerNode(Page);\r\n  noodlRuntime.registerNode(Router);\r\n}\r\n","import { SeoApi } from \"./api/seo\";\r\n\r\nimport { Model, Collection, createRecordsAPI } from \"@fluxscape/runtime\";\r\nimport { default as users } from \"./api/users\";\r\nimport { default as cloudfunctions } from \"./api/cloudfunctions\";\r\nimport { default as navigation } from \"./api/navigation\";\r\nimport { default as files } from \"./api/files\";\r\n\r\nexport default function createNoodlAPI(noodlRuntime: any): void {\r\n  // Support SSR\r\n  const global: any = typeof window !== \"undefined\" ? window : globalThis;\r\n\r\n  global.Noodl.getProjectSettings =\r\n    noodlRuntime.getProjectSettings.bind(noodlRuntime);\r\n  global.Noodl.getMetaData = noodlRuntime.getMetaData.bind(noodlRuntime);\r\n  global.Noodl.Collection = global.Noodl.Array = Collection;\r\n  global.Noodl.Model = global.Noodl.Object = Model;\r\n  global.Noodl.Variables = global.Noodl.Object.get(\"--ndl--global-variables\");\r\n  global.Noodl.Events = global.Noodl.eventEmitter =\r\n    noodlRuntime.context.eventSenderEmitter;\r\n  global.Noodl.Records = createRecordsAPI();\r\n  global.Noodl.Users = users;\r\n  global.Noodl.CloudFunctions = cloudfunctions;\r\n  global.Noodl.Navigation = navigation;\r\n  global.Noodl.Navigation._noodlRuntime = noodlRuntime;\r\n  global.Noodl.Files = files;\r\n  global.Noodl.SEO = new SeoApi();\r\n  if (!global.Noodl.Env) {\r\n    global.Noodl.Env = {};\r\n  }\r\n\r\n  global.Noodl.Arrays = new Proxy(global.Noodl.Array, {\r\n    get(target: any, prop: string | symbol, receiver: any) {\r\n      // @ts-expect-error\r\n      return Noodl.Array.get(prop);\r\n    },\r\n    set(obj: any, prop: string | symbol, value: any) {\r\n      if (!Array.isArray(value)) {\r\n        throw new Error(\r\n          // @ts-expect-error\r\n          \"Cannot assign non array value to array with id \" + prop\r\n        );\r\n      }\r\n      // @ts-expect-error\r\n      Noodl.Array.get(prop).set(value);\r\n      return true; // Indicate success\r\n    },\r\n  });\r\n\r\n  global.Noodl.Objects = new Proxy(global.Noodl.Object, {\r\n    get(target: any, prop: string | symbol, receiver: any) {\r\n      // @ts-expect-error\r\n      return Noodl.Object.get(prop);\r\n    },\r\n    set(obj: any, prop: string | symbol, value: any) {\r\n      // @ts-expect-error\r\n      Noodl.Object.get(prop).setAll(value);\r\n      return true; // Indicate success\r\n    },\r\n  });\r\n}\r\n","import React from \"react\";\r\n\r\nexport function NoHomeError() {\r\n  return (\r\n    <div\r\n      style={{\r\n        overflowY: \"auto\",\r\n        padding: \"24px\",\r\n        fontFamily: \"Open Sans\",\r\n        fontSize: \"16px\",\r\n        width: \"100vw\",\r\n        height: \"100vh\",\r\n        backgroundColor: \"#F57569\",\r\n      }}\r\n    >\r\n      <div\r\n        style={{\r\n          marginBottom: \"50px\",\r\n          fontWeight: \"bold\",\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n        }}\r\n      >\r\n        <span>ERROR</span>\r\n        <img\r\n          src=\"ndl_assets/noodl-logo-black.svg\"\r\n          style={{ marginLeft: \"auto\" }}\r\n        />\r\n      </div>\r\n      <div\r\n        style={{\r\n          margin: \"0 auto\",\r\n          alignItems: \"center\",\r\n          display: \"flex\",\r\n          flexDirection: \"column\",\r\n        }}\r\n      >\r\n        <div\r\n          style={{\r\n            fontSize: \"24px\",\r\n            textAlign: \"center\",\r\n            marginBottom: \"50px\",\r\n          }}\r\n        >\r\n          No{\" \"}\r\n          <img src=\"ndl_assets/home-icon.svg\" style={{ marginRight: \"-6px\" }} />{\" \"}\r\n          <span style={{ fontWeight: \"bold\" }}>HOME</span> component selected\r\n        </div>\r\n\r\n        <div style={{ textAlign: \"center\" }}>\r\n          Click <span style={{ fontWeight: \"bold\" }}>Make home</span> as shown\r\n          below.\r\n        </div>\r\n\r\n        <img\r\n          style={{ marginTop: \"24px\" }}\r\n          srcSet=\"ndl_assets/make-home-instructions@2x.png 2x\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { default as NoodlRuntime } from \"@fluxscape/runtime\";\r\n\r\nimport registerPolyfills from \"./src/polyfills\";\r\nimport Viewer, { ssrSetupRuntime } from \"./src/viewer.jsx\";\r\n\r\nregisterPolyfills();\r\n\r\nfunction createArgs() {\r\n  // Support SSR\r\n  if (typeof window === \"undefined\") {\r\n    return {\r\n      type: \"browser\",\r\n      platform: {\r\n        requestUpdate: (callback) => setImmediate(callback),\r\n        getCurrentTime: () => 0,\r\n        objectToString: (o) => JSON.stringify(o, null, 2),\r\n      },\r\n      componentFilter: (c) => !c.name.startsWith(\"/#__cloud__/\"),\r\n    };\r\n  }\r\n\r\n  return {\r\n    type: \"browser\",\r\n    platform: {\r\n      requestUpdate: (callback) => window.requestAnimationFrame(callback),\r\n      getCurrentTime: () => window.performance.now(),\r\n      objectToString: (o) => JSON.stringify(o, null, 2),\r\n    },\r\n    componentFilter: (c) => !c.name.startsWith(\"/#__cloud__/\"),\r\n  };\r\n}\r\n\r\nexport { ssrSetupRuntime };\r\n\r\nexport default {\r\n  render(element, noodlModules, { isLocal = false }) {\r\n    const runtimeArgs = createArgs();\r\n\r\n    if (isLocal) {\r\n      runtimeArgs.platform.isRunningLocally = () => true;\r\n    }\r\n\r\n    const noodlRuntime = new NoodlRuntime(runtimeArgs);\r\n\r\n    ReactDOM.render(\r\n      React.createElement(Viewer, { noodlRuntime, noodlModules }, null),\r\n      element\r\n    );\r\n  },\r\n  renderDeployed(element, noodlModules, projectData) {\r\n    // React SSR adds a 'data-reactroot' attribute on the root element to be able to hydrate the app.\r\n    if (\r\n      element.children.length > 0 &&\r\n      !!element.children[0].hasAttribute(\"data-reactroot\")\r\n    ) {\r\n      ReactDOM.hydrate(this.createElement(noodlModules, projectData), element);\r\n    } else {\r\n      ReactDOM.render(this.createElement(noodlModules, projectData), element);\r\n    }\r\n  },\r\n  /** This can be called for server side rendering too. */\r\n  createElement(noodlModules, projectData) {\r\n    const noodlRuntime = new NoodlRuntime({\r\n      ...createArgs(),\r\n      runDeployed: true,\r\n    });\r\n\r\n    return React.createElement(\r\n      Viewer,\r\n      { noodlRuntime, noodlModules, projectData },\r\n      null\r\n    );\r\n  },\r\n};\r\n","export default function registerPolyfills(): void {\r\n  if (!String.prototype.matchAll) {\r\n    // old iPads and browsers (~2018 or earlier)\r\n    // @ts-ignore\r\n    String.prototype.matchAll = function matchAll(\r\n      this: string,\r\n      pattern: string | RegExp\r\n    ): RegExpMatchArray[] {\r\n      const regex = new RegExp(pattern as string, \"g\");\r\n      const matches: RegExpMatchArray[] = [];\r\n\r\n      const match_result = this.match(regex);\r\n\r\n      if (match_result) {\r\n        for (let index in match_result) {\r\n          const item = match_result[index];\r\n          matches[index] = item.match(new RegExp(pattern as string))!;\r\n        }\r\n      }\r\n      return matches;\r\n    };\r\n  }\r\n}\r\n","import NoodlViewerReact from './noodl-viewer-react';\r\n\r\nwindow.Noodl._viewerReact = NoodlViewerReact;\r\n"],"names":["NodeRegister","constructor","e","this","_constructors","context","register","t","metadata","name","createNode","n","hasOwnProperty","Error","getNodeMetadata","hasNode","getInputType","o","inputs","type","Timer","_hasCalledOnStart","_wasStopped","_start","_durationLeft","duration","_isRunning","scheduler","repeatCount","delay","start","stop","scheduleTimer","stopTimer","isRunning","durationLeft","TimerScheduler","requestFrame","runningTimers","newTimers","createTimer","indexOf","push","splice","onStop","runTimers","i","s","r","a","length","d","onStart","Math","floor","onRunning","onFinish","call","hasPendingTimers","Variants","graphModel","getNodeScope","on","onVariantUpdated","getVariant","getNodesWithTypeRecursive","typename","filter","variant","model","setVariant","OutputProperty","valuesSendThisIteration","owner","getter","connections","_owner","_name","onFirstConnectionAdded","onLastConnectionRemoved","value","id","_id","registerConnection","node","inputPortName","deregisterConnection","flagDependeesDirty","flagDirty","sendValue","_lastUpdateIteration","_updatedAtIteration","_cyclicLoop","_setValueFromConnection","hasConnections","Node$1","updateOnDirtyFlagging","children","_internal","_dirty","_inputs","_inputValues","_outputs","_inputConnections","_outputList","_isUpdating","_inputValuesQueue","_afterInputsHaveUpdatedCallbacks","_signalsSentThisUpdate","_deleted","_deleteListeners","_isFirstUpdate","_valuesFromConnections","_updateIteration","getInputValue","registerInput","hasInput","defaultUnit","units","default","deregisterInput","registerInputs","getInput","console","log","registerInputIfNeeded","setInputValue","_a","_b","_c","_d","_e","input","JSON","parse","set","styles","resolveColor","eval","editorConnection","clearWarning","nodeScope","componentOwner","sendWarning","showGlobally","message","toString","hasOutput","registerOutput","get","deregisterOutput","registerOutputs","registerOutputIfNeeded","getOutput","connectInput","connectionSentValue","removeInputConnection","isInputConnected","some","update","updateIteration","_updateDependencies","Object","keys","shift","scheduleNextFrame","nodeIsDirty","_cyclicWarningSent","isWarningTypeEnabled","component","_performDirtyUpdate","flagOutputDirty","flagAllOutputsDirty","sendSignalOnOutput","scheduleAfterInputsHaveUpdated","connectionSentSignal","queueInput","_hasInputBeenSetFromAConnection","unit","setNodeModel","_onNodeModelParameterUpdated","_onNodeModelVariantUpdated","addDeleteListener","_onNodeDeleted","removeListenersWithRef","state","_getVisualStates","stateParameters","parameters","getDefaultValueForInput","_resetReactVirtualDOM","getAbsoluteUrl","window","Noodl","baseUrl","String","includes","startsWith","logJavaScriptNodeError","getPrototypeOf","stack","guid","random","substring","randomString","NodeScope","nodes","componentInstanceChildren","verifyData","forEach","addConnection","getNodeWithId","sourceId","targetId","targetPort","sourcePort","error","setNodeParameters","variants","nodeRegister","sort","inputPriority","createNodeFromModel","parent","setChildRoot","insertNodeInTree","addChild","hasNodeWithId","createPrimitiveNode","createComponentInstanceNode","getNodesWithIdRecursive","ComponentInstanceNode","getNodesWithType","map","concat","getAllNodesRecursive","values","getAllNodesWithVariantRecursive","onNodeModelRemoved","removeChild","removeConnection","setComponentModel","componentModel","getAllNodes","getAllConnections","nodeScopeDidInitialize","reset","deleteNode","getChildren","parentNodeScope","getConnectionsFrom","getConnectionsTo","sendEventFromThisScope","getChannelName","handleEvent","hasComponentModelWithName","componentIdCounter","super","childRoot","componentOutputValues","componentOutputs","componentInputs","inputValues","roots","instanceId","modelScope","getInputPorts","registerComponentInputPort","bind","getOutputPorts","registerComponentOutputPort","forceUpdate","findIndex","newName","setOutputFromComponentOutput","creatorCallbacks","onOutputChanged","isChild","getChildRootIndex","getChildRoot","getRoots","triggerDidMount","render","setChildIndex","contains","getRef","cachedChildren","getInstanceId","NodeContext","isUpdating","runningInEditor","_dirtyNodes","callbacksAfterUpdate","platform","eventEmitter","eventSenderEmitter","globalValues","globalsEventEmitter","currentFrameTime","frameNumber","timerScheduler","scheduleUpdate","componentModels","debugInspectorsEnabled","connectionsToPulse","connectionsToPulseChanged","debugInspectors","connectionPulsingCallbackScheduled","rootComponent","_outputHistory","_signalHistory","warningTypes","bundleFetchesInFlight","Map","onDebugInspectorsUpdated","clientId","connectionId","sendConnectionValue","setRootComponent","getCurrentTime","connection","fromId","fromProperty","nodeId","sendDebugInspectorValues","updateDirtyNodes","emit","removeAllListeners","clearDebugInspectors","scheduleAfterUpdate","once","setGlobalValue","getGlobalValue","registerComponentModel","oldName","deregisterComponentModel","fetchComponentBundle","async","Env","BaseUrl","fetch","status","json","hasComponentWithName","importComponentFromEditorData","has","getComponentModel","getBundleContainingComponent","getBundleDependencies","_formatConnectionValue","HTMLElement","tagName","Number","isNaN","isConnected","timestamp","setTimeout","clearOldConnectionPulsing","count","sendPulsingConnections","_getDebugInspectorValueForNode","getInspectInfo","setDebugInspectorsEnabled","sendGlobalEventFromEventSender","setPopupCallbacks","onShowPopup","onShow","onClosePopup","onClose","showPopup","popupParent","senderNode","getSettings","bodyScroll","_setCloseCallback","requestAnimationFrame","setWarningTypes","assign","EventSender","listeners","listenersWithRefs","delete","Promise","resolve","ActiveWarnings","currentWarnings","setWarning","clearWarnings","EditorConnection","dynamicPortsHash","serviceRequests","runtimeType","Date","now","ws","webSocketClass","WebSocket","wsOptions","webSocketOptions","reconnectOnClose","enableDebugger","lastSendTimestamp","sendQueue","sendTimer","activeWarnings","isRunningLocally","document","location","hostname","connect","socket","addEventListener","send","stringify","cmd","reconnect","code","reason","data","text","content","target","inspectors","enabled","readyState","OPEN","getCircularReplacer","WeakSet","add","slice","sendInspectId","sendSelectComponent","componentName","_detectRename","before","after","sendDynamicPorts","detectRenamed","Array","isArray","prefix","plug","patterns","renamed","nodeid","ports","options","key","warning","sendPatches","requestFullExport","requestNoodlModules","sendServiceRequest","token","close","sendNodeLibrary","sendComponentMetadata","sendProjectMetadata","formatDynamicPorts","dynamicports","template","port","channelPort","outputs","formatPort","condition","group","displayName","description","editorName","index","tooltip","tab","popout","allowVisualStates","generateNodeLibrary","typecasts","from","to","colors","base","baseHighlighted","header","headerHighlighted","outline","outlineHighlighted","visual","javascript","signal","normal","highlighted","pulsing","nodetypes","shortDesc","docs","color","allowAsChild","category","haveComponentChildren","searchTags","version","displayNodeName","nodeDoubleClickAction","module","deprecated","haveComponentPorts","allowAsExportRoot","allowChildren","allowChildrenWithCategory","singleton","shortDocs","replace","panels","usePortAsLabel","portLabelTruncationMode","exportDynamicPorts","visualStates","useVariants","connectionPanel","exportToEditor","nodeIndex","coreNodes","subCategories","items","moduleNodes","addModuleSettings","settings","generateProjectSettings","NodeModel","inputPorts","outputPorts","setParameter","setParameters","setStateParameters","setStateTransitions","stateTransitions","setStateTransitionParamter","setDefaultStateTransition","defaultStateTransitions","addInputPort","getInputPort","removeInputPortWithName","updateInputPortTypes","addOutputPort","getOutputPort","removeOutputPortWithName","updateOutputPortTypes","createFromExportData","ComponentModel","addNode","getConnectionsFromPort","getConnectionsToPort","addRootId","removeRootId","removeNodeWithId","warn","setNodeParent","renameInputPortOnNodeWithId","renameOutputPortOnNodeWithId","importEditorNodeData","rename","setMetadata","getMetadata","GraphModel","componentToBundleMap","components","addComponent","getBundlesContainingSheet","Set","componentIndex","dependencies","importEditorData","routerIndex","setSettings","setAllMetaData","setRootComponentName","getComponentWithName","getAllComponents","_addComponentPorts","_onNodeAdded","_onNodeRemoved","_onNodeWasRemoved","removeComponentWithName","renameComponent","isEmpty","setMetaData","getMetaData","getVariants","find","updateVariant","updateVariantParameter","updateVariantDefaultStateTransition","updateVariantStateTransition","variantTypeName","variantName","parameterName","curve","deleteVariant","difference","l","u","c","nodeAdded","parentId","childIndex","nodeRemoved","connectionAdded","connectionRemoved","parameterChanged","oldParameters","parameterValue","nodeAttached","nodeDetached","componentAdded","componentRemoved","rootAdded","portAdded","portRemoved","nodePortRenamed","componentPortsUpdated","instancePortsChanged","componentRenamed","settingsChanged","metadataChanged","componentMetadataChanged","variantParametersChanged","getParameter","variantDeleted","variantChanged","variantRenamed","oldVariantName","defaultStateTransitionChanged","stateTransitionsChanged","variantDefaultStateTransitionChanged","variantStateTransitionsChanged","routerIndexChanged","Services","createSetter","valueChangedToTrue","asyncPool","then","race","all","setUnitType","allowConnectionsOnly","registerNumberedInputs","registerNumberedInput","registerOutputsMetadata","initializeDefaultValues","defineNode","prototypeExtensions","methods","initialize","defineProperties","prototype","defineProperty","create","numberedInputs","registerSetupFunctionForNumberedInputs","setupNumberedInputDynamicPorts","max","displayPrefix","flat","extend","events","node$y","title","canArrangeInGroups","hidden","componentinputs","freeze","__proto__","node$x","componentoutputs","Model","models","proxies","Proxy","_modelProxyHandler","exists","instanceOf","off","notify","setAll","old","fill","split","forceChange","silent","getId","toJSON","_models","Reflect","_class","ownKeys","getOwnPropertyDescriptor","ModelScope","_cloudStore","sendSignalOnInput","node$w","queuedOperations","maxRunningTasks","activeTasks","stopOnFailure","taskTemplate","run","scheduleRun","abort","scheduleAbort","success","failure","done","aborted","hasScheduledRun","_queueOperation","hasScheduledAbort","createTaskComponent","_forEachModel","_forEachNode","itemOutputSignalTriggered","startTask","runningTasks","numTasks","failedTasks","completedTasks","queuedTasks","min","_runQueueOperations","runningOperations","_deleteAllTasks","clear","Node","runtasks","defaultRequestScript","defaultResponseScript","node$v","outputValues","outputValuesProxy","self","inspectData","resource","method","enums","label","requestScript","allowEditOnly","codeeditor","requestFunc","Function","responseScript","responseFunc","scheduleFetch","cancel","cancelFetch","canceled","getScriptOutputValue","setScriptInputValue","hasScheduledFetch","doFetch","doResponse","apply","request","doExternalFetch","encodeURIComponent","join","_noodl_cloud_runtime_version","XMLHttpRequest","_xhr","open","headers","setRequestHeader","onreadystatechange","getResponseHeader","response","toLowerCase","onerror","onabort","body","catch","parseScriptForErrors","match","setup$a","restnode","setup","node$u","focusPort","scope","hasScheduledEvaluation","cachedValue","currentExpression","compiledFunction","inputNames","expression","functionPreamble","parsePorts","_scheduleEvaluateExpression","result","isTrue","isFalse","isTrueEv","isFalseEv","_calculateExpression","_compileFunction","compiledFunctionsCache","construct","portsToIgnore","matchAll","updatePorts$7","editAsType","evalCompileWarnings","setup$9","userFunctionsCache","JavascriptNodeParser","_initializeAPIs","getCodePrefix","define","script","apis","getComponentScopeForNode","_afterSourced","change","destroy","definedObject","_scriptExtend","Inputs","Outputs","Signals","Setters","setOutputs","OnInit","OnDestroy","OnInputsChanged","getPorts","parseAndAddPortsFromScript","createFromCode","createFromURL","DONE","skipInputs","inputType","inputGroup","inputPrefix","skipOutputs","skipOutputSignals","outputPrefix","skipRegularOutputs","createNoodlAPI","_componentScopes","_findParentComponentStateModelId","ParentObject","RepeaterObject","_findForEachModel","_oldInputs","changed","signals","getVisualParentNode","node$t","inputTypes","outputTypes","_this","scriptInputs","scriptOutputs","functionScript","func","parseScript","runScheduled","runScript","_isSignalType","setScriptInputType","setScriptOutputType","_parseScriptForErrorsAndPorts","inputTypeEnums","setup$8","parentItemId","simplejavascript","enumerable","writable","removeAtIndex","remove","addAtIndex","_listeners","item","collection","Collection","_collections","CloudFile","url","getUrl","getName","_protectedFields","_common","_User","_removeProtectedFields","CloudStore","instance","_instance","collections","NoodlRuntime$1","_initCloudServices","_fromJSON","_deserializeJSON","_serializeObject","appId","endpoint","dbVersionMajor","_makeRequest","responseText","_noodl_cloudservices","masterKey","localStorage","sessionToken","onUploadProgress","upload","onprogress","File","query","_method","where","limit","skip","include","select","order","results","aggregate","avg","$avg","sum","$sum","$max","$min","distinct","$addToSet","objectId","property","excludeKeys","object","ACL","acl","increment","properties","__op","amount","save","createdAt","updatedAt","addRelation","objects","__type","targetObjectId","className","targetClass","removeRelation","uploadFile","file","contentType","deleteFile","forScope","invalidateCollections","schema","iso","toISOString","_toJSON","latitude","longitude","_isArrayOfObjects","convertVisualFilter","queryParameters","combinator","rules","operator","$relatedTo","relatedTo","relationProperty","$exists","collectionName","$gt","$gte","$lt","$lte","$eq","$ne","$regex","$options","matchesQuery","$and","$or","$in","$nin","RegExp","test","compareObjects","convertVisualSorting","_value","convertFilterOp","and","or","idEqualTo","idContainedIn","equalTo","notEqualTo","lessThan","greaterThan","lessThanOrEqualTo","greaterThanOrEqualTo","containedIn","notContainedIn","pointsTo","matchesRegex","search","$text","$search","$term","$caseSensitive","term","$language","language","caseSensitive","$diacriticSensitive","diacriticSensitive","nearSphere","$nearSphere","$maxDistanceInMiles","maxDistanceInMiles","$maxDistanceInKilometers","maxDistanceInKilometers","$maxDistanceInRadians","maxDistanceInRadians","withinBox","$within","$box","withinPolygon","$geoWithin","$polygon","node$s","collectionChangedCallback","cloudStoreEvents","currentQuery","size","storageSettings","firstItemId","fetched","setCollectionName","setCollection","bindCollection","unbindCurrentCollection","setError","err","fetchScheduled","getStorageFilter","getStorageLimit","getStorageSkip","getStorageFetchTotalCount","storageTotalCount","storageFilterType","visualFilter","visualSorting","filterFunc","storageJSONFilter","filterVariables","storageEnableLimit","storageLimit","storageSkip","storageEnableCount","setVisualFilter","setVisualSorting","setQueryParameter","storageFetch","visualSort","_defaultJSONQuery","updatePorts$6","_findRelations","_collectInputs$1","setup$7","relations","dbcollectionnode2","node$r","relationModelIds","onModelChangedCallback","modelId","idSource","setModel","setModelID","setCollectionID","collectionId","scheduleOnce","scheduleStore","userOutputGetter$1","userInputSetter$1","updatePorts$5","Boolean","setup$6","dbmodelnode2","_addBaseInfo$1","includeInputProperties","includeRelations","checkWarningsBeforeCloudOp","_additionalDynamicPorts","_addModelId$1","includeInputs","includeOutputs","identifierOf","identifierDisplayName","_addInputProperties$1","_setInputValue","_addRelationProperty","targetModelId","setRelationProperty","_getCurrentUser","UserId","_addAccessControl","accessControl","autoName","accessControlRules","setAccessControl","_getACL","read","write","userid","role","SetDbModelPropertiedNodeDefinition","store","storeType","scheduleSave","storeProperties","stored","hasScheduledStore","node$q","setdbmodelpropertiesnode","DeleteDbModelPropertiedNodeDefinition","storageDelete","deleted","node$p","deletedbmodelpropertiesnode","NewDbModelPropertiedNodeDefinition","storageInsert","sourceObjectId","created","node$o","newdbmodelpropertiesnode","AddDbModelRelationNodeDefinition$1","scheduleAddRelation","relationAdded","validateInputs","node$n","dbmodelnodeAddrelation","AddDbModelRelationNodeDefinition","scheduleRemoveRelation","relationRemoved","node$m","dbmodelnodeRemoverelation","node$l","scheduleFilter","filterSettings","filterParameters","filteredCollection","modified","getLimit","filterEnableLimit","filterLimit","getSkip","filterSkip","collectionChangedScheduled","setFilterParameter","updatePorts$4","Pointer","_collectInputs","setup$5","filterdbmodelsnode","node$k","dirtyValues","scheduleSetModel","hasScheduledSetModel","userOutputGetter","userInputSetter","updatePorts$3","setup$4","modelnode2","_addBaseInfo","_addModelId","_addInputProperties","def","_def","_methods","_pushInputValues","internal","_defaultValueForType","boolean","string","number","date","_allKeys","validProperties","keysToSet","_setInputType","SetModelPropertiedNodeDefinition","node$j","setmodelpropertiesnode","NewModelNodeDefinition","new","scheduleNew","hasScheduledNew","node$i","newmodelnode","node$h","cloudFile","cloudfilenode","ConfigService","cacheDuration","_getConfig","params","getConfig","configCachePending","configCache","ttl","clearCache","ConfigNodeDefinition","config","getValue","useDevValue","devValue","configKey","setInternal","node$g","setup$3","g","masterKeyOnly","dbconfig","createDefinition","currentValue","startValue","latestValue","setValueTo","saveValue","savedValue","cast","onChanged","node$f","StringNode","node$e","node$d","node$c","scheduleEvaluate","ontrue","onfalse","isfalse","node$b","and$1","node$a","node$9","currentSelectedIndex","indexChanged","trueString","falseString","currentInput","inputChanged","booleantostring","node$8","formatString","_format","dateString","onError","getDate","getMonth","Intl","DateTimeFormat","month","format","getFullYear","getHours","getMinutes","getSeconds","datetostring","node$7","mappings","mappedString","scheduleMapping","output","inputString","currentInputString","defaultMapping","doMapping","stringmapper","invert","node$6","inverter","node$5","startIndex","endIndex","cachedResult","resultDirty","end","substr","node$4","formatValue","multiline","scheduleFormat","formatted","formatScheduled","updatePorts$2","setup$2","stringformat","node$3","startValueSet","limitsEnabled","limitsMin","limitsMax","increase","decrease","currentCount","countChanged","counter","node$2","uniqueid","node$1","userProperties","email","username","storeScheduled","NoodlRuntime","UserService","setUserProperties","setUserProperty","updatePorts$1","setup$1","setuserproperties","setUserModel","current","authenticated","fetchCurrentUser","getUserProperty","updatePorts","user","registerNodes","registerNode","noodlModules","updateScheduled","_currentLoadedData","isWaitingForExport","errorHandlers","dontCreateRootComponent","componentFilter","runDeployed","requestUpdate","objectToString","_setupEditorCommunication","registerGraphModelListeners","prefetchBundles","every","setData","reload","onModelUpdateReceived","onMetaDataUpdateReceived","registerModule","_setRootComponent","_disableLoad","_doUpdate","setProjectSettings","projectSettings","getNodeLibrary","projectsettings","lastSentNodeLibrary","connectToEditor","addErrorHandler","reportError","getProjectSettings","createRecordsAPI","reject","recordId","record","targetRecordId","targetRecord","targetClassName","NodeDefinition","EdgeTriggeredInput","Events","EE","fn","addListener","emitter","event","TypeError","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","eventNames","names","getOwnPropertySymbols","handlers","ee","listenerCount","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","j","prefixed","exports","HASH_UNDEFINED","reIsHostCtor","freeGlobal","freeSelf","root","arrayIncludes","array","predicate","fromIndex","baseFindIndex","baseIsNaN","baseIndexOf","arrayIncludesWith","comparator","arrayPush","offset","cacheHas","cache","uid","arrayProto","funcProto","objectProto","coreJsData","maskSrcKey","exec","IE_PROTO","funcToString","reIsNative","Symbol","propertyIsEnumerable","spreadableSymbol","isConcatSpreadable","nativeMax","getNative","nativeCreate","Hash","entries","entry","ListCache","MapCache","SetCache","__data__","assocIndexOf","other","baseFlatten","depth","isStrict","isFlattenable","getMapData","isObject","pattern","isFunction","isHostObject","toSource","baseIsNative","isArrayLikeObject","isArguments","pop","iteratee","isCommon","valuesLength","arrayMap","outer","computed","valuesIndex","baseDifference","otherArgs","thisArg","isObjectLike","isLength","isArrayLike","tag","kSampleStepSize","float32ArraySupported","Float32Array","A","aA1","aA2","B","C","calcBezier","aT","getSlope","BezierEasing","points","b","isFinite","_str","_css","_p","_mSampleValues","_precomputed","x","mX1","mY1","mX2","mY2","_precompute","_getTForX","getPoints","toCSS","_calcSampleValues","aX","mSampleValues","intervalStart","currentSample","kSplineTableSize","guessForT","initialSlope","aGuessT","currentSlope","newtonRaphsonIterate","aA","aB","currentX","currentT","abs","binarySubdivide","css","ease","linear","easeIn","easeOut","easeInOut","f","clsx","___CSS_LOADER_EXPORT___","cssWithMappingToString","list","modules","mediaQuery","dedupe","alreadyImportedModules","_i","_arrayLikeToArray","arr","arr2","_item","_arrayWithHoles","iterator","_s","_arr","_n","next","_iterableToArrayLimit","minLen","_unsupportedIterableToArray","_nonIterableRest","_slicedToArray","cssMapping","btoa","base64","unescape","sourceMapping","sourceURLs","sources","source","sourceRoot","ReflectOwnKeys","R","ReflectApply","receiver","getOwnPropertyNames","NumberIsNaN","init","errorListener","resolver","eventTargetAgnosticAddListener","handler","addErrorHandlerIfEventEmitter","_maxListeners","defaultMaxListeners","checkListener","_getMaxListeners","that","_addListener","prepend","m","existing","newListener","unshift","warned","w","onceWrapper","fired","wrapFn","_onceWrap","wrapped","unwrap","evlistener","ret","unwrapListeners","arrayClone","copy","flags","wrapListener","arg","removeEventListener","RangeError","setMaxListeners","getMaxListeners","doError","er","prependListener","prependOnceListener","position","originalListener","spliceOne","rawListeners","ReactPropTypesSecret","emptyFunction","emptyFunctionWithReset","resetWarningCache","shim","props","propName","propFullName","secret","getShim","isRequired","ReactPropTypes","bigint","bool","symbol","any","arrayOf","element","elementType","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","_DraggableCore","React","obj","nodeInterop","__esModule","_getRequireWildcardCache","newObj","hasPropertyDescriptor","desc","_interopRequireWildcard","_propTypes","_interopRequireDefault","_reactDom","_clsx","_domFns","_positionFns","_shims","_log","WeakMap","cacheBabelInterop","cacheNodeInterop","_extends","_defineProperty","prim","toPrimitive","res","hint","_toPrimitive","_toPropertyKey","configurable","Draggable","Component","getDerivedStateFromProps","_ref","_ref2","prevPropsPosition","y","coreData","createDraggableData","setState","dragging","dragged","uiData","newState","slackX","slackY","bounds","newStateX","newStateY","getBoundPosition","deltaX","deltaY","onDrag","defaultPosition","isElementSVG","componentDidMount","SVGElement","findDOMNode","componentWillUnmount","_this$props$nodeRef$c","_this$props","nodeRef","axis","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","positionOffset","scale","draggableCoreProps","style","svgTransform","draggable","validPosition","transformOpts","canDragX","canDragY","createSVGTransform","createCSSTransform","createElement","onDragStart","onDragStop","cloneElement","Children","only","transform","propTypes","left","right","top","bottom","dontSetMe","defaultProps","eventsFor","move","dragEventFor","DraggableCore","NaN","onMouseDown","allowAnyClick","button","thisNode","ownerDocument","disabled","defaultView","handle","matchesSelectorAndParentsTo","preventDefault","touchIdentifier","getTouchIdentifier","getControlPosition","coreEvent","createCoreData","mounted","enableUserSelectHack","addUserSelectStyles","lastX","lastY","addEvent","handleDrag","handleDragStop","grid","snapToGrid","MouseEvent","createEvent","initMouseEvent","removeUserSelectStyles","removeEvent","handleDragStart","onTouchStart","passive","_this$props2","onMouseUp","onTouchEnd","offsetParent","nodeType","addClassName","el","inputOptions","capture","attachEvent","doc","styleEl","getElementById","innerHTML","getElementsByTagName","appendChild","controlPos","translation","getTranslation","_getPrefix","browserPrefixToKey","getTouch","identifier","targetTouches","findInArray","changedTouches","innerHeight","height","clientHeight","computedStyle","getComputedStyle","int","paddingTop","paddingBottom","innerWidth","width","clientWidth","paddingLeft","paddingRight","matchesSelector","selector","baseNode","parentNode","offsetXYFromParent","offsetParentRect","getBoundingClientRect","clientX","scrollLeft","clientY","scrollTop","outerHeight","borderTopWidth","borderBottomWidth","outerWidth","borderLeftWidth","borderRightWidth","removeClassName","detachEvent","selection","empty","getSelection","removeAllRanges","matchesSelectorFunc","unitSuffix","defaultX","defaultY","classList","browserPrefixToStyle","prop","getPrefix","prefixes","_window$document","documentElement","str","out","shouldCapitalize","toUpperCase","kebabToTitleCase","isStart","isNum","cloneBounds","ownerWindow","boundNode","querySelector","boundNodeEl","nodeStyle","boundNodeStyle","offsetLeft","marginLeft","offsetTop","marginTop","marginRight","marginBottom","draggableCore","touchObj","pendingX","pendingY","round","callback","parseInt","num","memo","getTarget","styleTarget","HTMLIFrameElement","contentDocument","head","stylesInDom","getIndexByIdentifier","modulesToDom","idCountMap","identifiers","media","sourceMap","references","updater","addStyle","insertStyleElement","attributes","nonce","setAttribute","insert","textStore","replaceText","replacement","applyToSingletonTag","styleSheet","cssText","cssNode","createTextNode","childNodes","insertBefore","applyToTag","removeAttribute","firstChild","singletonCounter","styleIndex","removeStyleElement","atob","lastIdentifiers","newList","newLastIdentifiers","_index","_data","cloudServices","path","xhr","_cu","currentUser","pe","grouping","k","_g","_obj","_content","_type","src","keyIndex","bItems","aItems","aKeys","bKeys","idx","modelData","temp","v","oldValue","parsedValue","newOutput","inputName","sourceNode","sourcePortName","outputValue","sourceNodeId","inputsToPort","hasMoreInputs","queue","afterInputCallbacks","connectedPorts","outputName","queueValue","callbackFn","nodeModel","deleteListener","defaultValue","opts","_includeInputs","_includeOutputs","_updatePorts","_types","p","nodeDefinition","requestFrameCallback","timer","currentTime","remainingTimers","finishedTimers","timersThisFrame","localT","nodesWithVariant","requiredKeys","connectionData","targetNode","inputA","inputB","parentInstance","nodeInstance","extraProps","findNodesWithIdRec","componentId","findNodesWithTypeRec","getAllNodesRec","connectionModel","conn","child","connectionFrom","connectionTo","eventName","propagation","sendEventInThisScope","eventReceivers","eventReceiver","removeNodesWithId","componentInput","prevChildRoot","newChildRoot","componentOutput","inspector","loop","iterations","dirtyNodes","callbacks","fetchBundle","bundleUrl","promise","bundleName","bundleDep","con","info","valuesToSend","inspectorValue","channelName","popupComponent","popupNode","inputKey","closePopupNodes","action","inputMetadata","ref","warningKeys","address","seen","dt","trySend","msg","chunk","connectionMap","hash","patches","nodelibrary","portName","portData","plugType","parameter","stateTransition","nodeData","targetPortName","rootId","childModel","newParentModel","componentData","sheetName","bundles","isOnDefaultSheet","recurse","bundle","dep","exportData","componentNames","transition","array1","array2","valueSet","applyPortDelta","newPorts","existingInputs","inputPortsToRemove","inputPortsToAdd","setInputValueOnNodeInstancesWithModel","existingOutputs","outputPortsToRemove","outputPortsToAdd","eventHandlers","targetNodeModel","allParams","param","componentInstance","oldRegisterInputIfNeeded","NodeConstructor","defaultValues","inputsMetadata","portNames","numPorts","collectPorts","itemNode","_isInputConnected","task","taskComponent","checkDone","op","sentResponse","statusCode","responseType","rawResponse","responseData","raw","scriptWithoutComments","unique","managePortsForNode","newInputs","inputsToAdd","inputsToRemove","lastValue","inputValue","F","addPort","userCode","userObject","_userObjectExtended","_extended","states","changedFunction","_Node","changedInputs","inputPort","_addPortsFromMatch","componentObject","parentComponentObjectId","getParentComponent","parentComponentObject","_sendSignal","AsyncFunction","_managePortsForNode","_outputTypeEnums","_res","_op","cond","q","sorting","relationKey","opAndValue","_v","gp","_addModelAtCorrectIndex","cloudstore","firstItem","filterCode","_filter","_sort","_filterCb","_sortCb","filterFuncArgs","dynamicSignals","dynamicSetters","dbCollections","systemCollections","uniqueInputs","variables","cb","_typeMap","_includeInputProperties","_includeRelations","_super","ac","_rule","rule","currentUserId","cu","userId","_parts","initValues","_warning","_key","filtered","_supportedTypes","propArray","newModel","configSchema","valueType","isCloud","obj1","obj2","oldInit","boolValue","monthShort","year","yearShort","hours","minutes","seconds","stringValue","matches","_ignoreKeys","userService","noodlRuntime","bundleNames","numParallelFetches","poolLimit","iteratorFn","executing","objectEquals","allBundles","definedNode","rootComponentName","graphData","nodeLibrary","nodeTypes","nodeMetadata","nodeObj","dp","dynamicPortGroup","selectorNames","conditionalPortNames","exportOutput","eh","_url","s4","chars","easeCurves","easeOutQuartic","easeInQuartic","easeInOutQuartic","easeOutCubic","easeInCubic","easeInOutCubic","easeOutQuadratic","easeInQuadratic","easeInOutQuadratic","resultValues","closeActions","scheduleClose","setResultValue","closeCallback","hasScheduledClose","closeAction","closeActionTriggered","resultsArray","closeActionsArray","navigate","scheduleNavigate","backActions","hasScheduledNavigate","_setBackCallback","backCallback","backAction","backActionTriggered","openInNewTab","queryNames","formattedPath","urlPath","hashPath","navigationPathType","compiledUrl","history","pushState","dispatchEvent","PopStateEvent","setParam","setQuery","uniquePorts","transitionParams","pageParams","backResults","mode","navigationMode","navigated","hasNavigated","setTransitionParam","setPageParam","getBackResult","setTargetPageId","pageId","setTransition","pageStack","ps","pages","targetPageId","targetComponentName","backNode","_trackTargetComponent","targetComponent","_trackPageStack","ev","NavigationHandler","_pageStacks","_navigationQueue","_performNavigation","registerPageStack","hasReset","deregisterPageStack","pathParams","queryParams","_setPageParams","getPageParam","uniqueNames","RouterHandler","_routers","routerNames","router","registerRouter","deregisterRouter","getPagesForRouter","routers","matchingRouters","pageComponents","routes","getPageInfoForComponent","onNavigated","routerName","page","setTargetPage","setRouter","popupParams","closeResults","show","scheduleShow","Closed","setPopupParam","getCloseResult","hasScheduledShow","Transition","transitionForward","startTime","timing","dur","_frame","frame","back","performance","_t","forward","Transitions","None","Push","distance","direction","crossfade","darkOverlay","darkoverlay","darkOverlayAmount","darkoverlayamount","zoom","setStyle","opacity","dist","targets","Up","Down","Left","Right","Popup","fadein","currentNumber","numberInitialized","animationStarted","setCurrentNumberEnabled","overrideValue","_animation","endValue","targetValue","easingCurve","atTargetValue","setRGB","hex","componentToHex","rgb0","rgb1","rgb2","resultColor","blendValue","updateColor","getColor","clampedBlendValue","rgb","paramsValues","resultsValues","lastCallResult","scheduleCall","getResultsValue","setParamsValue","setFunctionName","functionName","hasScheduledCall","doCall","deployVersion","modifyId","sourceCollection","sourceCollectionChangedCallback","scheduleCopyItems","pendingSourceCollection","setSourceCollection","scheduleSetCollection","_copySourceItems","hasScheduledSetCollection","hasScheduledCopyItems","sorter","getFilter","filters","option","getSort","applyFilter","filterOps","ForEachComponent","didMount","willUnmount","useEffect","_typeName","itemNodes","itemOutputSignals","itemOutputs","mountedOperations","baseIndex","addItem","removeItem","onItemsCollectionChanged","repeaterDisabledWhenUnmounted","isMounted","_deleteAllItemNodes","templateType","scheduleRefresh","templateScript","templateFunction","refresh","itemActionItemId","updateTarget","newParent","hasScheduledRefresh","getTemplateForModel","pathParts","_mapInputs","inputMapFunc","_forEachModelChangeListener","forEachActions","signalAdded","_forEachRemoveInProgress","findChild","tryRemove","_deleteItem","repeaterCreateComponentsAsync","runOps","getItemActionParameter","itemActionParameters","itemActionSignal","hasScheduledTriggerItemOutputSignal","_output","getItemOutput","setInputMappingScript","inputMappingScript","_collectPortsInTemplateComponent","templateComponentName","defaultMappings","_trackComponentOutputs","removeCompleted","removeCompletedCallback","added","itemId","getItemId","itemActionTriggered","signalItemAction","actionParameters","setItemActionParameter","scheduleMap","mapScript","mapCode","mapFunc","mappedCollection","mappedModels","SetVariableNodeDefinition","variablesModel","setWith","do","setValue","csv","scheduleParseData","hasScheduledParseData","parseData","strData","strDelimiter","objPattern","arrData","arrMatches","prevLastIndex","lastIndex","strMatchedDelimiter","strMatchedValue","CSVToArray","fields","row","setVariableName","outputNames","eventReceived","_isEnabled","consume","onEventReceivedCallback","registerListenersForChannel","eventData","onEventReceived","onEventReceiver","_collectPayloadPorts","matching","portKeys","payload","_trackEventSender","sendEvent","_channelName","outputProperties","setupScheduled","runNextFrameScheduled","isWaitingForExternalFileToLoad","useExternalFile","runFunction","destroyFunction","setupFunction","hasParsedCode","signalScheduled","killed","inputQueue","userFunctionScope","createComponent","deleteComponent","runNextFrame","onFrameStart","_callDestroyFunction","parser","_onCodeParsed","externalFile","scheduleSetup","isSignal","_typename","_callRunFunction","_callSignalFunction","_callSetupFunction","scheduleSignal","_inputTypeEnums","onCodeParsed","_parseAndSourceJavascript","_ports","_currentInputValue","_remappedValue","_minInputValue","_maxInputValue","_minOutputValue","_maxOutputValue","_clampOutput","allowConnectionOnly","_calculateNewOutputValue","minInputValue","maxInputValue","minOutputValue","maxOutputValue","clamp","remappedValue","normalizedValue","inputElement","accept","acceptedFileTypes","onchange","files","click","sizeInBytes","_viewportSizeChanged","aspectRatio","previousStates","previousValues","setRGBA","numComponents","rgbaToHex","rgba","useTransitions","currentValues","stateParameterTypes","startValues","bezierEaseCurves","transitionFuncs","valuesAreInitialised","animation","stateValues","valueTypes","targetValues","transitionCurves","ms","rgba2","rgba0","rgba1","scheduleGoToState","startState","toggle","nextIdx","currentState","stateChanged","parts","valueName","setCurrentState","jumpToState","updateAtStatePorts","goToState","hasScheduledGoToState","parameterType","transitionCurve","detectRename","valueArray","stateArray","stateRenamed","valueRenamed","initialized","emitSignals","flip","onFromStart","switched","switchedToOn","switchedToOff","restart","startDelay","timerStarted","timerFinished","progressTotal","total","progressLoaded","loaded","errorStatus","progressChanged","progressTotalBytes","progressLoadedBytes","progressLoadedPercent","login","scheduleLogIn","password","logInScheduled","logIn","scheduleLogOut","logOutScheduled","logOut","signUpScheduled","signup","scheduleSignUp","signUp","_parameters","_event","_modelScope","getUserFromLocalStorage","getUserModel","_iid","additionalUserProps","getCurrentUser","propsToSave","emailVerified","verifyEmail","sendEmailVerification","resetPassword","new_password","newPassword","requestPasswordReset","changeCount","valueChanged","aa","ba","ca","da","FontFace","lastChild","z","rel","href","onload","D","E","G","I","J","H","ga","ha","h","classes","L","K","ja","M","N","O","P","Q","fonts","load","fa","clearTimeout","S","T","navigator","userAgent","la","U","offsetWidth","serif","V","ma","W","X","na","oa","qa","xa","vendor","ra","sa","ta","ua","timeout","ia","ka","pa","fontfamily","fontStyle","fontWeight","projectId","api","urls","families","testStrings","ya","za","latin","cyrillic","greek","khmer","Hanuman","Aa","thin","extralight","ultralight","light","regular","book","medium","semibold","demibold","bold","extrabold","ultrabold","black","heavy","Ba","italic","Ca","Ea","Fa","Arimo","Cousine","Tinos","Ga","Ha","va","Da","wa","Typekit","__webfontfontdeckmodule__","weight","ea","Y","custom","fontdeck","monotype","typekit","google","Z","cloudfunctions","users","_currentUser","Properties","_user","time","lowerMargin","upperMargin","wrapperSize","speed","deceleration","momentumData","swipeBounceTime","destination","swipeTime","rate","hooks","trigger","eventTypes","momentum","extendSetComponentObjectProperties","getComponentObjectId","propertyName","ComponentObject","graphEventEmitter","ParentComponentObject","onComponentStateNodesChanged","findParentComponentStateModelId","setModelId","updateComponentState","modelInfo","parentComponentName","Base","_refCount","CSSDefinition","styleId","getStyleRefId","removeStyleDeclaration","updateStyle","styleRefId","styleObj","ReactDOM","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","globalThis","toStringTag","nc","_bindComponentModel","_evaluateWarnings","level","dispose","highlightedNodes","selectedNodes","isUpdatingHighlights","div","overflow","zIndex","pointerEvents","highlightRootDiv","windowBorderDiv","createHighlightDiv","boxShadow","setWindowSelected","updateHighlights","domNode","rect","highlight","highlightNodesWithId","disableHighlight","selectNodesWithId","deselectNodes","onInspect","onHighlight","onDisableHighlight","onMouseMove","noodlNode","findNoodlNode","cursor","stopPropagation","onClick","activeElement","blur","onContextMenu","nodeIds","elementsFromPoint","dom","onMouseOut","blockEvent","setComponent","enable","disable","domFiber","parentElement","GetCompFiber","fiber","parentFiber","return","compFiber","stateNode","_title","_meta","setTitle","meta","clearMeta","metaTag","getMeta","setMeta","newMetaTag","_noodlRuntime","componentPath","targetPageName","navigateToPath","onProgress","ignoreInExport","pollDelay","numBoundingBoxObservers","addObserver","_startObserver","removeObserver","_stopObserver","setTarget","boundingRect","observer","bb","startMargin","endMargin","parentLayout","sizeMode","flexShrink","fixedWidth","flexGrow","fixedHeight","align","alignX","alignY","parentFlexDirection","alignSelf","loadedFontFamilies","fontCssFamiliesAdded","fontCallbacks","fontFamily","removeFileEnding","loadFont","fontURL","family","newStyle","fontactive","loadedFamily","callWhenFontIsActive","images","html","imgHtml","inputCss","defaultCss","attribute","addInputProps","addInputs","addDynamicInputPorts","addInputCss","addSharedVisualInputs","mixBlendMode","applyDefault","visible","removeStyle","visibility","addMarginInputs","marginPaddingComp","addPaddingInputs","defaults","styleTag","addTransformInputs","transformX","transforms","updateTransform","transformY","transformRotation","rotation","transformScale","transformOriginX","updateTransformOrigin","transformOriginY","transformOrigin","addAlignInputs","alignComp","addPointerEventOutputs","pointerEventsMode","pointerEventsEnabled","blockTouch","propPath","pointerDown","pointerUp","onTouchCancel","pointerEnter","onMouseEnter","hoverStart","onMouseOver","setVisualStates","hoverEnd","onMouseLeave","addDimensions","defaultSizeMode","contentLabel","useDimensionConstraints","widthCondition","heightCondition","sizeComp","onChange","isFixed","deployed","inputProps","explicit","standard","extended","contentWidth","contentHeight","contentSize","unitsBodyText","fixedTooltip","dimension","fixed","minWidth","maxWidth","minHeight","maxHeight","_addCornerRadius","defineCornerTab","suffix","tabName","indexOffset","radiusName","borderRadius","_updateCornerRadii","setCorner","corner","addBorderInputs","defineBorderTab","styleName","widthName","colorName","orNotSet","borderStyle","nameWithTab","borders","_updateBorders","borderWidth","borderColor","setBorder","borderTopStyle","borderRightStyle","borderBottomStyle","addShadowInputs","boxShadowEnabled","_updateBoxShadow","boxShadowOffsetX","boxShadowOffsetY","boxShadowBlurRadius","boxShadowSpreadRadius","boxShadowInset","boxShadowColor","addIconInputs","useIcon","iconColor","useIconCondition","useIconPorts","enableIconPlacement","hideEnableIconInput","iconSourceType","iconIconSource","iconImageSource","iconSpacing","iconPlacement","iconSize","addLabelInputs","useLabel","textStylePortPrefix","enableSpacing","labelSpacing","addTextStyleInputs","parentGroup","portPrefix","textStyleInputName","portIndex","prettyName","childPorts","childPortPrefix","getTextStyle","parentPort","targetStyleProperty","fontFamilyPort","_transitions","propCallbacks","prevCb","outputPropValues","currentVisualStates","statesToRemove","vs","otherProps","finalStyle","innerReactComponentRef","noodlNodeAsProp","layout","renderedAtFrame","useFrame","textStyle","reactComponent","renderChildren","rootElement","getAttribute","dimensions","margins","padding","outputProps","startStyle","startStyles","hasDefault","boundingBoxObserverCallback","clientBoundingRect","ReactComponentNode","reactKey","hasChildCountOutput","childrenCount","runningInCanvas","boundingBoxObserver","wantsToBeMounted","reactComponentRef","getReactComponent","cssClassName","styleCss","updateAdvancedStyle","screenPositionX","screenPositionY","boundingWidth","boundingHeight","customCssStyles","errorMessage","rawCss","nextComment","endComment","trim","nameParts","updateChildIndices","updateChildrenCount","scheduleUpdateChildCountAndIndicies","updateChildIndiciesScheduled","forceUpdateScheduled","didCallTriggerDidMount","newStyles","styleObject","domElement","getDOMElement","flexDirection","marginsChanged","clip","forceUpdateAttributes","getStyle","_stopStateTransitions","getParametersForStates","parametersToSet","_getNewState","prevStates","newStates","addedStates","_getDefaultTransition","_getStateTransition","transitions","val","prevStateParams","newStateParams","newValues","defaultTransition","mountedInput","styleTargetName","newProps","pointer","_styleTemplate","o1","o2","checked","_updateVisualState","hoverState","pressedState","focusState","onFocus","onBlur","_renderIcon","iconStyle","alt","fontSize","codeAsClass","class","attrs","buttonType","groupPriority","testId","backgroundColor","setChecked","useState","checkbox","inputWrapperStyle","display","alignItems","justifyContent","checkedChanged","labelStyle","labeltextStyle","htmlFor","check","uncheck","selectedIndex","Value","otherStyles","inset","textTransform","inputWrapper","heightInPercent","Disabled","Label","placeholder","placeholderOpacity","selected","outerWrapperStyle","_itemsChanged","newValue","radioButtonGroup","useContext","radio","fillStyle","fillSpacing","radioButton","wrapperStyle","fillColor","setSelected","Provider","thumbWidth","radius","tl","tr","br","bl","spread","onValueChanged","updateOutputValue","instanceClassId","_nodeId","step","thumbHeight","trackHeight","divStyle","valueFactor","trackStyle","background","trackActiveColor","trackColor","thumbStyle","thumbColor","parseFloat","_updateOutputValuePercent","valuePercent","valuePercentChanged","prefixLabel","propPrefix","groupName","setText","onTextChanged","otherStylesTmp","focus","userSelect","inputContent","inputStyles","maxLength","onKeyDown","resize","inputWithWrapper","which","onEnter","hasFocus","controlId","placeHolderOpacity","setNodeFocused","textAlignX","textAlign","textChanged","_focus","_blur","workingOnPromise","enqueue","dequeue","topPageName","stackDepth","pageInfo","asyncQueue","onScheduleReset","scheduleReset","_registerPageStack","_deregisterPageStack","_findPage","flex","useRoutes","pageIdOrLabel","pageRef","setPageOutputs","hasScheduledReset","createPageContainer","resetAsync","startPageId","pageFromUrl","matchPageFromUrl","startPage","getRelativeURL","pageItem","paramsInPath","getNavigationAbsoluteURL","parentUrl","thisUrl","endsWith","_getLocationPath","pathname","_getSearchParams","pl","decode","decodeURIComponent","urlParams","getNavigationRemainingPath","remainingNavigationPath","urlQuery","_matchPathParts","remainingPathParts","pagePattern","_updateUrlWithTopPage","replaceAsync","isTransitioning","navigateAsync","navigateBackNodes","newTop","setPageComponent","setPagePath","setStartPage","isProperty","metatags","SEO","sitemapIncluded","sitemapChangefreq","sitemapPriority","reduce","getUrlPath","getTitle","setUrlPath","titleParts","defaultUrlPath","_registerRouter","_deregisterRouter","currentUrl","currentPageTitle","currentPage","currentPageComponent","scrollToTop","scrollIntoView","matchFromUrl","object1","object2","keys1","keys2","currentParams","_updatePageInputs","pageNodes","pageInputNode","targetPage","haveForwardSlash","decodeURI","pathnameLength","URL","matchedPage","bestMatchLength","pagePatternParts","_getCompleteUrlToPage","newPage","_navigateInCurrentWindow","pageInputNodes","link","centerX","centerY","angleInDegrees","angleInRadians","PI","cos","sin","startAngle","endAngle","arcSweep","stroke","fillEnabled","strokeEnabled","strokeColor","strokeWidth","strokeLineCap","strokeLinecap","xmlns","minWidths","containerWidth","marginX","first","second","totalFractions","fractionSize","rowWidth","acc","curr","expected","newLayout","newTotalFractions","columnAmount","columnLayout","containerRef","useRef","setContainerWidth","container","ResizeObserver","observe","disconnect","layoutString","targetLayout","forEachComponent","marginY","flexWrap","boxSizing","positionX","positionY","snapToPosition","propCallback","inputPositionX","inputPositionY","UNSAFE_componentWillReceiveProps","nextProps","snapToPositionX","snapToPositionXTimer","snapToPositionY","snapToPositionYTimer","useParentBounds","toArray","snapPositionX","snapPositionY","snapDurationX","snapDurationY","setPrototypeOf","__","il","jl","sourceKey","navigationStart","transformNames_1","charAt","useCapture","cancelable","transitionTimingFunction","transitionDuration","transitionDelay","transitionEnd","transitionProperty","touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseup","offsetHeight","exceptions","eventSource","posSrc","screenX","screenY","bubbles","pressedKeysMap","ctrlKey","shiftKey","altKey","metaKey","initEvent","forwardedTouchEvent","_constructed","swipe","swipeBounce","bounce","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","interval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","registerType","hasType","magic","eventsCopy","event_1","types","_","EventRegister","wrapper","addDOMEvents","removeDOMEvents","handleDOMEvents","eventOperation","eventType","OptionsConstructor","startX","startY","scrollX","scrollY","freeScroll","directionLockThreshold","eventPassthrough","dblclick","tap","bounceTime","momentumLimitTime","momentumLimitDistance","flickLimitTime","flickLimitDistance","resizePolling","probeType","preventDefaultException","tagException","HWCompositing","useTransition","bindToWrapper","bindToTarget","disableMouse","disableTouch","autoBlur","autoEndDistance","outOfBoundaryDampingFactor","specifiedIndexAsContent","quadrant","merge","resolveBounce","process","translateZ","bounceOptions","DEFAULT_BOUNCE","ActionsHandler","wrapperEvents","targetEvents","shouldRegisterTouch","shouldRegisterMouse","wrapperEventRegister","targetEventRegister","beforeHandler","setInitiated","initiated","_eventType","beforeStart","point","touches","pointX","pageX","pointY","pageY","pageXOffset","pageYOffset","pX","pY","setContent","rebindDOMEvents","Translater","getComputedPosition","matrix","translate","transformStyle","transformFnName","transformFnArgUnit","transformFnArg","beforeTranslate","translater","endPoint","setPending","pending","setForceStopped","forceStopped","setCallStop","called","callStopWhenPending","clearTimer","startProbe","startPoint","prePos","probe","pos","currentPos","computeDirection","delta","directionX","directionY","transitionTime","easing","timeFunction","easingFn","isRealtimeProbeType","_reflow","doStop","forceStop","callStop","Animation","animate","destTime","newPoint","Behavior","setMovingDirection","setDirection","hasScroll","performDampingAlgorithm","movingDirection","dampingFactor","newPos","minScrollPos","maxScrollPos","bounces","momentumInfo","absDist","startPos","updateDirection","absStartPos","isWrapperStatic","wrapperRect","contentRect","relativeOffset","computeBoundary","resetState","resetStartPos","beforeComputeBoundary","boundary","scrollable","updatePosition","getCurrentPos","checkInBoundary","adjustPosition","inBoundary","ignoreHasScroll","updateStartPos","updateAbsStartPos","getAbsDist","DirectionLockAction","directionLocked","checkMovingDirection","absDistX","absDistY","computeDirectionLock","handleEventPassthrough","adjustDelta","handleMap","ScrollerActions","scrollBehaviorX","scrollBehaviorY","actionsHandler","animater","directionLockAction","bindActionsHandler","handleStart","transformateDeltaData","coordinateTransformation","handleMove","handleEnd","handleClick","fingerMoved","contentMoved","beforeMove","checkMomentum","prevX","newX","prevY","newY","detectMovingDirection","positionChanged","contentNotMoved","scrollStart","dispatchScroll","scroll","endTime","beforeEnd","ensureIntegerPos","scrollEnd","ensuringInteger","minScrollPosX","maxScrollPosX","minScrollPosY","maxScrollPosY","ceil","bsOptions","extraProp","prev","cur","sourceEvent","targetEvent","Scroller","resizeTimeout","animaterOptions","actions","resizeHandler","resizeRegister","registerTransitionEnd","bindTranslater","bindAnimater","bindActions","togglePointerEvents","transitionEndRegister","prevPos","updatePositions","resetPosition","beforeScrollStart","touchEnd","scrollCancel","checkClick","checkFlick","flick","swiper","momentumX","momentumY","scrollTo","_dblclick","dblclickTrigged","lastClickTime","isBScrollContainer","contentChanged","beforeRefresh","wrapperOffset","scrollBy","extraTransform","keys_1","minDistanceScroll","scrollToElement","offsetX","offsetY","targetEle","getOffset","getPos","wrapperPos","scrollBehavior","xInBoundary","yInBoundary","reflow","BScrollConstructor","plugins","valid","use","ctor","pluginName","plugin","pluginsMap","applyOrder","scroller","eventBubbling","handleAutoBlur","proxy","applyPlugins","refreshWithoutReset","beforeInitialScrollTo","applyOrderMap","propertiesConfig","lastKey","eventRegister","MouseWheel","wheelEndTimer","wheelMoveTimer","wheelStart","handleBScroll","handleOptions","handleHooks","registerEvent","userOptions","mouseWheel","mouseWheelOpt","easeTime","discreteTime","throttleTime","hooksFn","registerHooks","wheelHandler","wheelStartHandler","getWheelDelta","wheelMoveHandler","wheelEndDetector","cleanCache","alterOptions","mousewheelStart","deltaCache","cachedDelta","mousewheelMove","getEaseTime","mousewheelEnd","wheelDeltaX","wheelDeltaY","deltaMode","wheelDelta","detail","hasVerticalScroll","hasHorizontalScroll","hooksName","handlerFn","EventHandler","indicator","registerEvents","startEvents","moveEvents","endEvents","startEventRegister","indicatorEl","moveEventRegister","endEventRegister","BScrollIsDisabled","lastPoint","keysMap","touchStart","pointPos","touchMove","Indicator","getKeysMap","handleFade","fade","interactive","scrollbarTrackClickable","scrollHooks","translaterHooks","animaterHooks","hasScrollKey","eventHandler","eventHandlerHooks","startHandler","moveHandler","endHandler","bindClick","clickEventRegister","calculateclickOffsetPos","scrollbarTrackOffsetTime","poinKey","domRectKey","domRect","scrollbarTrackOffsetType","clickPointOffset","scrollToWhere","scrollInfo","baseSize","scrollerSize","translateProperty","fadeInTime","fadeOutTime","canScroll","wrapperSizeKey","scrollerSizeKey","maxScrollPosKey","refreshScrollInfo","indicatorElSize","minSize","isCustom","maxIndicatorScrollPos","sizeRatio","caculatePosAndSize","refreshStyle","posKey","translatePropertyKey","sizeKey","moved","indicatorNotMoved","syncBScroll","maxScrollY","minScrollY","maxScrollX","minScrollX","ScrollBar","createIndicators","indicators","scrollbar","customElements","indicatorOptions","scrollDirectionConfigKeys","indicatorDirections","customScrollbarEls","customElement","scrollbarWrapper","createScrollbarElement","scrollbarWrapperEl","scrollbarIndicatorEl","duplicateClick","parentScroll","childScroll","nestedScroll","scrollsPair","parentScrollX","parentScrollY","childScrollX","childScrollY","oppositeScroll","hasReachLeft","hasReachRight","hasReachTop","hasReachBottom","childNode","NestedScroll","stores","addHooks","appendBScroll","handleContainRelationship","handleCompatible","teardown","removeBScroll","__parentInfo","outerBS","outerBSWrapper","innerBS","innerBSWrapper","currentDepths","pairs","availableBScrolls","pair","bs","transformNames","webkit","Moz","PagesPos","slideOpt","slideEl","scrollerIns","wrapperWidth","wrapperHeight","scrollerHeight","scrollerWidth","stepX","stepY","slideEls","querySelectorAll","computePagePosInfoByEl","computePagePosInfo","xLen","yLen","hasInfo","getNearestPage","cx","cy","PageInfo","pagesPos","checkSlideLoop","changeCurrentPage","change2safePage","getInitPage","loopX","loopY","getRealPage","fixedPage","realPageLen","pageIndex","rest","getPageSize","realPage2Page","firstX","firstY","realX","realY","nextPage","changedPageNum","prevPage","nearestPage","getLoopStage","needLoop","resetLoopPage","isSameWithCurrent","slideX","slideY","Slide","resetLooping","isTouching","slide","willChangeToPage","lazyInitByRefresh","cloneSlideEleForLoop","shouldRefreshByWidth","setSlideWidth","shouldRefreshByHeight","setSlideHeight","shouldRefresh","scrollerHooks","registorHooks","initSlideState","modifyScrollMetaHandler","amendCurrentPage","setTouchFlag","scrollMoving","listenFlick","flickHandler","slideWrapper","clearSlideWidth","clearSlideHeight","goTo","goToPage","getCurrentPage","triggerThreshold","thresholdX","thresholdY","initPage","initThreshold","slideThreshold","threshold","pageSize","cloneNode","isScrollToBoundary","changePage","pageWillChangeTo","shouldSetWidthHeight","checkType","checkOption","slideItemWidth","newPageInfo","scrollEasing","posX","posY","getAnimateTime","scrollMeta","changeToPage","scrollNeedsToInit","scrollRef","scrollEnabled","nativeScroll","setupIScroll","iScroll","componentDidUpdate","scrollToIndex","behavior","noodlChild","scrollSnapEnabled","scrollDirection","getScrollDirection","snapOptions","disableSetWidth","disableSetHeight","showScrollbar","scrollSnapToEveryItem","scrollBounceEnabled","onScrollPositionChanged","onScrollStart","onScrollEnd","renderIScroll","childStyle","touchAction","as","overflowX","overflowY","scrollElementDuration","scrollIndexDuration","scrollIndex","scrollElement","alignContent","rowGap","columnGap","focused","focusLost","lineHeight","srcSet","objectFit","onLoad","whiteSpace","overflowWrap","wordBreak","textAlignY","video","muted","volume","autoplay","controls","playsInline","innerRef","wantToPlay","canPlay","setSourceObject","srcObject","play","pause","objectPosition","objectPositionX","objectPositionY","onVideoElementCreated","onCanPlay","videoWidth","videoHeight","poster","onTimeUpdate","onPlay","onPause","locals","setStyles","textStyles","_variantHasInputsWithTypes","parameterNames","NoodlEditor","NoodlEditorInspectorAPI","setInspector","setEnabled","NoodlEditorHighlightAPI","highlighter","setHighlighter","selectNode","Viewer","popups","runningDeployed","projectData","focusedNoodlNodes","enableDebugInspectors","popup","newPopupArray","global","Variables","Records","Users","CloudFunctions","Navigation","Files","Arrays","Objects","NoodlJSAPI","reactNodes","createNodeFromReactComponent","Styles","waitingForExport","host","protocol","Highlighter","Inspector","ids","inspectNodes","graphWarnings","GraphWarnings","focusedNode","blurredNode","onClickCapture","elem","margin","isolation","setImmediate","regex","match_result","isLocal","runtimeArgs","renderDeployed","hasAttribute","_viewerReact"],"sourceRoot":""}